<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="author" content="Jakarta EE MVC Team, https://projects.eclipse.org/projects/ee4j.mvc">
<title>Jakarta MVC Specification</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book">
<div id="header">
<h1>Jakarta MVC Specification</h1>
<div class="details">
<span id="author" class="author">Jakarta EE MVC Team, https://projects.eclipse.org/projects/ee4j.mvc</span><br>
<span id="email" class="email"><a href="https://dev.eclipse.org/mailman/listinfo/mvc-dev" class="bare">https://dev.eclipse.org/mailman/listinfo/mvc-dev</a></span><br>
<span id="revnumber"> 3.0,</span>
<span id="revdate">April 15, 2025</span>
<br><span id="revremark">Final Release</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_license">License</a></li>
<li><a href="#Copyright">Copyright</a>
<ul class="sectlevel2">
<li><a href="#efsl">Eclipse Foundation Specification License - v1.1</a>
<ul class="sectlevel3">
<li><a href="#Disclaimers">Disclaimers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#goals">1.1. Goals</a></li>
<li><a href="#non_goals">1.2. Non-Goals</a></li>
<li><a href="#additional_information">1.3. Additional Information</a></li>
<li><a href="#terminology">1.4. Terminology</a></li>
<li><a href="#conventions">1.5. Conventions</a></li>
<li><a href="#acks20">1.6. Acknowledgements for version 2.0</a></li>
<li><a href="#acks11">1.7. Acknowledgements for version 1.1</a></li>
<li><a href="#acks10">1.8. Acknowledgements for version 1.0</a>
<ul class="sectlevel3">
<li><a href="#spec_leads">1.8.1. Specification Leads</a></li>
<li><a href="#expert_group">1.8.2. Expert Group Members</a></li>
<li><a href="#contributors">1.8.3. Contributors</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#mvc">2. Models, Views and Controllers</a>
<ul class="sectlevel2">
<li><a href="#controllers">2.1. Controllers</a>
<ul class="sectlevel3">
<li><a href="#controller_instances">2.1.1. Controller Instances</a></li>
<li><a href="#response">2.1.2. Response</a></li>
<li><a href="#redirect">2.1.3. Redirect and @RedirectScoped</a></li>
</ul>
</li>
<li><a href="#models">2.2. Models</a></li>
<li><a href="#views">2.3. Views</a>
<ul class="sectlevel3">
<li><a href="#mvc_uri">2.3.1. Building URIs in a View</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#data_binding">3. Data Binding</a>
<ul class="sectlevel2">
<li><a href="#data_binding_intro">3.1. Introduction</a></li>
<li><a href="#mvc_binding_annotation">3.2. @MvcBinding annotation</a></li>
<li><a href="#error_handling_bindingresult">3.3. Error handling with BindingResult</a></li>
<li><a href="#converting_parameters">3.4. Converting to Java types</a>
<ul class="sectlevel3">
<li><a href="#numeric_types">3.4.1. Numeric types</a></li>
<li><a href="#boolean_type">3.4.2. Boolean type</a></li>
<li><a href="#other_types">3.4.3. Other types</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#security">4. Security</a>
<ul class="sectlevel2">
<li><a href="#security_introduction">4.1. Introduction</a></li>
<li><a href="#cross-site-request-forgery">4.2. Cross-site Request Forgery</a></li>
<li><a href="#cross-site-scripting">4.3. Cross-site Scripting</a></li>
</ul>
</li>
<li><a href="#events">5. Events</a>
<ul class="sectlevel2">
<li><a href="#observers">5.1. Observers</a></li>
</ul>
</li>
<li><a href="#applications">6. Applications</a>
<ul class="sectlevel2">
<li><a href="#mvc_applications">6.1. MVC Applications</a></li>
<li><a href="#mvc_context">6.2. MVC Context</a></li>
<li><a href="#providers_in_mvc">6.3. Providers in MVC</a></li>
<li><a href="#annotation_inheritance">6.4. Annotation Inheritance</a></li>
<li><a href="#configuration_in_mvc">6.5. Configuration in MVC</a></li>
</ul>
</li>
<li><a href="#view_engines">7. View Engines</a>
<ul class="sectlevel2">
<li><a href="#view_engines_introduction">7.1. Introduction</a></li>
<li><a href="#selection_algorithm">7.2. Selection Algorithm</a></li>
</ul>
</li>
<li><a href="#i18n">8. Internationalization</a>
<ul class="sectlevel2">
<li><a href="#i18n_introduction">8.1. Introduction</a></li>
<li><a href="#i18n_resolving_algorithm">8.2. Resolving Algorithm</a></li>
<li><a href="#i18n_default_resolver">8.3. Default Locale Resolver</a></li>
</ul>
</li>
<li><a href="#form_method_overwrite">9. Form method override</a>
<ul class="sectlevel2">
<li><a href="#form_method_overwrite_introduction">9.1. Introduction</a></li>
<li><a href="#form_method_overwrite_resolving_algorithm">9.2. Resolving Algorithm</a></li>
</ul>
</li>
<li><a href="#annotation_table">Appendix A: Summary of Annotations</a></li>
<li><a href="#revision_history">Appendix B: Revision History</a></li>
<li><a href="#bibliography">Bibliography</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_license"><a class="anchor" href="#_license"></a>License</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre>Specification: Jakarta MVC Specification

Version: 3.0

Status: Final Release

Release: April 15, 2025</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Copyright"><a class="anchor" href="#Copyright"></a>Copyright</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copyright (c) 2018, 2025 Eclipse Foundation AISBL.</p>
</div>
<div class="sect2">
<h3 id="efsl"><a class="anchor" href="#efsl"></a>Eclipse Foundation Specification License - v1.1</h3>
<div class="paragraph">
<p>By using and/or copying this document, or the Eclipse Foundation document from which this statement is linked or incorporated by reference, you (the licensee) agree that you have read, understood, and will comply with the following terms and conditions:</p>
</div>
<div class="paragraph">
<p>Permission to copy, and distribute the contents of this document, or the Eclipse Foundation document from which this statement is linked, in any medium for any purpose and without fee or royalty is hereby granted, provided that you include the following on ALL copies of the document, or portions thereof, that you use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>link or URL to the original Eclipse Foundation document.</p>
</li>
<li>
<p>All existing copyright notices, or if one does not exist, a notice (hypertext is preferred, but a textual representation is permitted) of the form: "Copyright (c) [$date-of-document] Eclipse Foundation AISBL &lt;&lt;url to this license&gt;&gt; "</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Inclusion of the full text of this NOTICE must be provided. We request that authorship attribution be provided in any software, documents, or other items or products that you create pursuant to the implementation of the contents of this document, or any portion thereof.</p>
</div>
<div class="paragraph">
<p>No right to create modifications or derivatives of Eclipse Foundation documents is granted pursuant to this license, except anyone may prepare and distribute derivative works and portions of this document in software that implements the specification, in supporting materials accompanying such software, and in documentation of such software, PROVIDED that all such works include the notice below. HOWEVER, the publication of derivative works of this document for use as a technical specification is expressly prohibited.</p>
</div>
<div class="paragraph">
<p>The notice is:</p>
</div>
<div class="paragraph">
<p>"Copyright (c) [$date-of-document] Eclipse Foundation AISBL. This software or document includes material copied from or derived from [title and URI of the Eclipse Foundation specification document]."</p>
</div>
<div class="sect3">
<h4 id="Disclaimers"><a class="anchor" href="#Disclaimers"></a>Disclaimers</h4>
<div class="paragraph">
<p>THIS DOCUMENT IS PROVIDED "AS IS," AND TO THE EXTENT PERMITTED BY APPLICABLE LAW THE COPYRIGHT HOLDERS AND THE ECLIPSE FOUNDATION AISBL MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NON-INFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THE DOCUMENT ARE SUITABLE FOR ANY PURPOSE; NOR THAT THE IMPLEMENTATION OF SUCH CONTENTS WILL NOT INFRINGE ANY THIRD PARTY PATENTS, COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS.</p>
</div>
<div class="paragraph">
<p>TO THE EXTENT PERMITTED BY APPLICABLE LAW THE COPYRIGHT HOLDERS AND THE ECLIPSE FOUNDATION AISBL WILL NOT BE LIABLE FOR ANY DIRECT, INDIRECT, SPECIAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF ANY USE OF THE DOCUMENT OR THE PERFORMANCE OR IMPLEMENTATION OF THE CONTENTS THEREOF.</p>
</div>
<div class="paragraph">
<p>The name and trademarks of the copyright holders or the Eclipse Foundation AISBL may NOT be used in advertising or publicity pertaining to this document or its contents without specific, written prior permission. Title to copyright in this document will at all times remain with copyright holders.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Model-View-Controller, or <em>MVC</em> for short, is a common pattern in Web frameworks where it is used predominantly to build HTML applications.
The <em>model</em> refers to the application’s data, the <em>view</em> to the application’s data presentation and the <em>controller</em> to the part of the
system responsible for managing input, updating models and producing output.</p>
</div>
<div class="paragraph">
<p>Web UI frameworks can be categorized as <em>action-based</em> or <em>component-based</em>. In an action-based framework, HTTP requests are
routed to controllers where they are turned into actions by application code; in a component-based framework, HTTP requests are grouped and
typically handled by framework components with little or no interaction from application code. In other words, in a component-based framework,
the majority of the controller logic is provided by the framework instead of the application.</p>
</div>
<div class="paragraph">
<p>The API defined by this specification falls into the action-based category and is, therefore, not intended to be a replacement for
component-based frameworks such as Jakarta Server Faces [<a href="#jsf23">1</a>], but simply a different approach to building Web applications on the Jakarta EE platform.</p>
</div>
<div class="sect2">
<h3 id="goals"><a class="anchor" href="#goals"></a>1.1. Goals</h3>
<div class="paragraph">
<p>The following are goals of the API:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Goal 1
</td>
<td class="hdlist2">
<p>Leverage existing Jakarta EE technologies like Jakarta Contexs and Dependency Injecttion [<a href="#cdi20">2</a>] and Jakarta Bean Validation [<a href="#bv20">3</a>].</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Goal 2
</td>
<td class="hdlist2">
<p>Define a solid core to build MVC applications without necessarily supporting all the features in its first version.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Goal 3
</td>
<td class="hdlist2">
<p>Build on top of Jakarta RESTful Web Services for the purpose of re-using its matching and binding layers.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Goal 4
</td>
<td class="hdlist2">
<p>Provide built-in support for Jakarta Server Pages view languages.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="non_goals"><a class="anchor" href="#non_goals"></a>1.2. Non-Goals</h3>
<div class="paragraph">
<p>The following are non-goals of the API:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Non-Goal 1
</td>
<td class="hdlist2">
<p>Define a new view (template) language and processor.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Non-Goal 2
</td>
<td class="hdlist2">
<p>Support standalone implementations of MVC running outside of Jakarta EE.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Non-Goal 3
</td>
<td class="hdlist2">
<p>Support REST services not based on Jakarta RESTful Web Services.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Non-Goal 4
</td>
<td class="hdlist2">
<p>Provide built-in support for view languages that are not part of Jakarta EE.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is worth noting that, even though a standalone implementation of MVC that runs outside of Jakarta EE is a non-goal,
this specification shall not intentionally prevent implementations to run in other environments,
provided that those environments include support for all the Jakarta EE technologies required by MVC.</p>
</div>
</div>
<div class="sect2">
<h3 id="additional_information"><a class="anchor" href="#additional_information"></a>1.3. Additional Information</h3>
<div class="paragraph">
<p>The issue tracking system for this specification can be found at:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/eclipse-ee4j/mvc-api/issues" class="bare">https://github.com/eclipse-ee4j/mvc-api/issues</a></p>
</div>
<div class="paragraph">
<p>The corresponding Javadocs can be found online at:</p>
</div>
<div class="paragraph">
<p><a href="https://jakarta.ee/specifications/mvc/1.1/apidocs/" class="bare">https://jakarta.ee/specifications/mvc/1.1/apidocs/</a></p>
</div>
<div class="paragraph">
<p>A compatible implementation can be obtained from:</p>
</div>
<div class="paragraph">
<p><a href="https://projects.eclipse.org/projects/ee4j.krazo" class="bare">https://projects.eclipse.org/projects/ee4j.krazo</a></p>
</div>
<div class="paragraph">
<p>The project team seeks feedback from the community on any aspect of this specification, please send comments to:</p>
</div>
<div class="paragraph">
<p><a href="https://accounts.eclipse.org/mailing-list/mvc-dev" class="bare">https://accounts.eclipse.org/mailing-list/mvc-dev</a></p>
</div>
</div>
<div class="sect2">
<h3 id="terminology"><a class="anchor" href="#terminology"></a>1.4. Terminology</h3>
<div class="paragraph">
<p>Most of the terminology used in this specification is borrowed from other specifications such as Jakarta RESTful Web Services and Jakarta Contexts and Dependency Injection. We use the terms <em>per-request</em>
and <em>request-scoped</em> as well as <em>per-application</em> and <em>application-scoped</em> interchangeably.</p>
</div>
</div>
<div class="sect2">
<h3 id="conventions"><a class="anchor" href="#conventions"></a>1.5. Conventions</h3>
<div class="paragraph">
<p>The keywords `MUST', `MUST NOT', `REQUIRED', `SHALL', `SHALL NOT', `SHOULD', `SHOULD NOT', `RECOMMENDED', `MAY', and `OPTIONAL'
in this document are to be interpreted as described in RFC 2119 [<a href="#rfc2119">4</a>].</p>
</div>
<div class="paragraph">
<p>Java code and sample data fragments are formatted as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre><span class="keyword">package</span> <span class="namespace">com.example.hello</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Hello</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span> args<span class="type">[]</span>){
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>);
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>URIs of the general form <a href="http://example.org/">http://example.org/&#8230;&#8203;</a> and <a href="http://example.com/">http://example.com/&#8230;&#8203;</a> represent application or context-dependent URIs.</p>
</div>
<div class="paragraph">
<p>All parts of this specification are normative, with the exception of examples, notes and sections explicitly marked as `Non-Normative'.
Non-normative notes are formatted as shown below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
This is a note.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="acks20"><a class="anchor" href="#acks20"></a>1.6. Acknowledgements for version 2.0</h3>
<div class="paragraph">
<p>The Jakarta MVC 2.0 specification was created by the Jakarta MVC Specification Project with
guidance provided by the Jakarta EE Working Group (<a href="https://jakarta.ee/" class="bare">https://jakarta.ee/</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="acks11"><a class="anchor" href="#acks11"></a>1.7. Acknowledgements for version 1.1</h3>
<div class="paragraph">
<p>The Jakarta MVC 1.1 specification was created by the Jakarta MVC Specification Project with
guidance provided by the Jakarta EE Working Group (<a href="https://jakarta.ee/" class="bare">https://jakarta.ee/</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="acks10"><a class="anchor" href="#acks10"></a>1.8. Acknowledgements for version 1.0</h3>
<div class="paragraph">
<p>Version 1.0 was developed as part of <a href="https://jcp.org/en/jsr/detail?id=371">JSR 371</a> under the Java Community Process.</p>
</div>
<div class="sect3">
<h4 id="spec_leads"><a class="anchor" href="#spec_leads"></a>1.8.1. Specification Leads</h4>
<div class="paragraph">
<p>The following table lists the specification leads of the JSR:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ivar Grimstad (Individual Member)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Jan 2017 - present)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Christian Kaltepoth (ingenit GmbH &amp; Co. KG)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(May 2017 - present)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Santiago Pericas-Geertsen (Oracle)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Aug 2014 - Jan 2017)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manfred Riem (Oracle)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Aug 2014 - Jan 2017)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="expert_group"><a class="anchor" href="#expert_group"></a>1.8.2. Expert Group Members</h4>
<div class="paragraph">
<p>The following were the expert group members:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ivar Grimstad (Individual Member)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neil Griffin (Liferay, Inc)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joshua Wilson (RedHat)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rodrigo Turini (Caelum)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stefan Tilkov (innoQ Deutschland GmbH)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frank Caputo (Individual Member)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Christian Kaltepoth (ingenit GmbH &amp; Co. KG)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Woong-ki Lee (TmaxSoft, Inc.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paul Nicolucci (IBM)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kito D. Mann (Individual Member)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rahman Usta (Individual Member)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Florian Hirsch (adorsys GmbH &amp; Co KG)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Santiago Pericas-Geertsen (Oracle)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manfred Riem (Oracle)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following were former members of the expert group:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Guilherme de Azevedo Silveira (Individual Member)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="contributors"><a class="anchor" href="#contributors"></a>1.8.3. Contributors</h4>
<div class="paragraph">
<p>The following were the contributors of the specification:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daniel Dias dos Santos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Phillip Krüger</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Andreas Badelt</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>During the course of this JSR we received many excellent suggestions. Special thanks to Marek Potociar, Dhiru Pandey and Ed Burns, all from Oracle.
In addition, to everyone in the user’s alias that followed the expert discussions and provided feedback, including Peter Pilgrim, Ivar Grimstad, Jozef Hartinger, Florian Hirsch, Frans Tamura, Rahman Usta, Romain Manni-Bucau, Alberto Souza, among many others.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mvc"><a class="anchor" href="#mvc"></a>2. Models, Views and Controllers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter introduces the three components that comprise the
 architectural pattern: models, views and controllers.</p>
</div>
<div class="sect2">
<h3 id="controllers"><a class="anchor" href="#controllers"></a>2.1. Controllers</h3>
<div class="paragraph">
<p><span class="tck-testable tck-id-ctrl-method">A <em>Jakarta MVC controller</em> is a Jakarta RESTful Web Services [<a href="#jaxrs21">5</a>] resource method decorated by <code>@Controller</code></span>.
<span class="tck-testable tck-id-ctrl-class">If this annotation is applied to a class, then all resource methods in it are regarded as controllers</span>.
<span class="tck-testable tck-id-ctrl-hybrid">Using the <code>@Controller</code> annotation on a subset of methods defines a hybrid class in which certain methods are controllers and others are traditional Jakarta RESTful Web Services resource methods.</span></p>
</div>
<div class="paragraph">
<p>A simple hello-world controller can be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloController</span> {

    <span class="annotation">@GET</span>
    <span class="annotation">@Controller</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> hello(){
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello.jsp</span><span class="delimiter">&quot;</span></span>;
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>hello</code> is a controller method that returns a path to a Jakarta Server Page.
The semantics of controller methods differ slightly from Jakarta RESTful Web Services resource methods;
<span class="tck-testable tck-id-return-string">in particular, a return type of <code>String</code> is interpreted as a view path rather than text content</span>.
<span class="tck-testable tck-id-default-mediatype">Moreover, the default media type for a response is assumed to be <code>text/html</code>, but otherwise can be declared using <code>@Produces</code> just like in Jakarta RESTful Web Services</span>.</p>
</div>
<div class="paragraph">
<p>A controller’s method return type determines how its result is processed:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">void</dt>
<dd>
<p><span class="tck-testable tck-id-return-void">A controller method that returns void is REQUIRED to be decorated by <code>@View</code></span>.</p>
</dd>
<dt class="hdlist1">String</dt>
<dd>
<p><span class="tck-testable tck-id-return-string2">A string returned is interpreted as a view path</span>.</p>
</dd>
<dt class="hdlist1">Response</dt>
<dd>
<p><span class="tck-testable tck-id-return-response">A Jakarta RESTful Web Services <code>Response</code> whose entity’s type is one of the above</span>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following class defines equivalent controller methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td>
  <td class="code"><pre><span class="annotation">@Controller</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloController</span> {

    <span class="annotation">@GET</span> <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">void</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@View</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello.jsp</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> helloVoid() {
    }

    <span class="annotation">@GET</span> <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">string</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> helloString() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello.jsp</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@GET</span> <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">response</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Response helloResponse() {
        <span class="keyword">return</span> Response.status(Response.Status.OK)
            .entity(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello.jsp</span><span class="delimiter">&quot;</span></span>)
            .build();
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Controller methods that return a non-void type may also be decorated with <code>@View</code> as a way to specify a <em>default</em> view for the controller.
<span class="tck-testable tck-id-non-null-viewable">The default view MUST be used only when such a non-void controller method returns a <code>null</code> value</span>.</p>
</div>
<div class="paragraph">
<p>Note that, even though controller methods return types are restricted as explained above, Jakarta MVC does not impose any restrictions on parameter types available to controller methods:
i.e.,
<span class="tck-testable tck-id-inject-param-types">all parameter types injectable in Jakarta RESTful Web Services resources are also available in controllers</span>.
<span class="tck-testable tck-id-inject-field-props">Likewise, injection of fields and properties is unrestricted and fully compatible with Jakarta RESTful Web Services</span>.
Note the restrictions explained in Section <a href="#controller_instances">Controller Instances</a>.</p>
</div>
<div class="paragraph">
<p>Controller methods handle a HTTP request directly. Sub-resource locators as described in the Jakarta RESTful Web Services Specification [<a href="#jaxrs21">5</a>] are not supported by Jakarta MVC.</p>
</div>
<div class="sect3">
<h4 id="controller_instances"><a class="anchor" href="#controller_instances"></a>2.1.1. Controller Instances</h4>
<div class="paragraph">
<p>Unlike in Jakarta RESTful Web Services where resource classes can be native (created and managed by Jakarta RESTful Web Services), Jakarta Contexts and Dependency Injection (CDI) beans, managed beans or EJBs,
<span class="tck-testable tck-id-ctrl-cdi">Jakarta MVC classes are REQUIRED to be CDI-managed beans only</span>.
<span class="tck-testable tck-id-ctrl-cdi-hybrid">It follows that a hybrid class that contains a mix of Jakarta RESTful Web Services resource methods and Jakarta MVC controllers must also be CDI managed</span>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-request-scope-default">Like in Jakarta RESTful Web Services, the default resource class instance lifecycle is <em>per-request</em></span>.
Implementations MAY support other lifecycles via CDI; the same caveats that apply to Jakarta RESTful Web Services classes in other lifecycles applied to Jakarta MVC classes.
<span class="tck-testable tck-id-scope-proxy">In particular, CDI may need to create proxies when, for example, a per-request instance is as a member of a per-application instance</span>.
See [<a href="#jaxrs21">5</a>] for more information on lifecycles and their caveats.</p>
</div>
</div>
<div class="sect3">
<h4 id="response"><a class="anchor" href="#response"></a>2.1.2. Response</h4>
<div class="paragraph">
<p><span class="tck-testable tck-id-response-header">Returning a <code>Response</code> object gives applications full access to all the parts in a response, including the headers</span>.
For example, an instance of <code>Response</code> can modify the HTTP status code upon encountering an error condition;
Jakarta RESTful Web Services provides a fluent API to build responses as shown next.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td>
  <td class="code"><pre><span class="annotation">@GET</span>
<span class="annotation">@Controller</span>
<span class="directive">public</span> Response getById(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id) {
    <span class="keyword">if</span> (id.length() == <span class="integer">0</span>) {
        <span class="keyword">return</span> Response.status(Response.Status.BAD_REQUEST)
            .entity(<span class="string"><span class="delimiter">&quot;</span><span class="content">error.jsp</span><span class="delimiter">&quot;</span></span>)
            .build();
    }
    <span class="comment">//...</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Direct access to <code>Response</code> enables applications to override content types, set character encodings, set cache control policies, trigger an HTTP redirect, etc.
For more information, the reader is referred to the Javadoc for the <code>Response</code> class.</p>
</div>
</div>
<div class="sect3">
<h4 id="redirect"><a class="anchor" href="#redirect"></a>2.1.3. Redirect and @RedirectScoped</h4>
<div class="paragraph">
<p>As stated in the previous section, <span class="tck-testable tck-id-redirect-response">controllers can redirect clients by returning a <code>Response</code> instance using the Jakarta RESTful Web Services API</span>.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre><span class="annotation">@GET</span>
<span class="annotation">@Controller</span>
<span class="directive">public</span> Response redirect() {
    <span class="keyword">return</span> Response.seeOther(<span class="predefined-type">URI</span>.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">see/here</span><span class="delimiter">&quot;</span></span>)).build();
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Given the popularity of the POST-redirect-GET pattern,
<span class="tck-testable tck-id-redirect-prefix">Jakarta MVC implementations are REQUIRED to support view paths prefixed by <code>redirect:</code> as a more concise way to trigger a client redirect</span>.
Using this prefix, the controller shown above can be re-written as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre><span class="annotation">@GET</span>
<span class="annotation">@Controller</span>
<span class="directive">public</span> <span class="predefined-type">String</span> redirect() {
    <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">redirect:see/here</span><span class="delimiter">&quot;</span></span>;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-redirect-relative">In either case, relative paths are resolved relative to the Jakarta RESTful Web Services application path</span> - for more information please refer to the Javadoc for the <code>seeOther</code> method.
It is worth noting that redirects require client cooperation (all browsers support it, but certain CLI clients may not) and result in a completely new request-response cycle in order to access the intended controller.
If a controller returns a <code>redirect:</code> view path, <span class="tck-testable tck-id-redirect-303-302">Jakarta MVC implementations SHOULD use the 303 (See other) status code for the redirect, but MAY prefer 302 (Found) if HTTP 1.0 compatibility is required.</span></p>
</div>
<div class="paragraph">
<p>Jakarta MVC applications can leverage CDI by defining beans in scopes such as request and session.
<span class="tck-testable tck-id-scope-request">A bean in request scope is available only during the processing of a single request</span>,
<span class="tck-testable tck-id-scope-session">while a bean in session scope is available throughout an entire web session which can potentially span tens or even hundreds of requests</span>.</p>
</div>
<div class="paragraph">
<p>Sometimes it is necessary to share data between the request that returns a redirect instruction and the new request that is triggered as a result.
That is, a scope that spans at most two requests and thus fits between a request and a session scope.
For this purpose, the Jakarta MVC API defines a new CDI scope identified by the annotation <code>@RedirectScoped</code>.
<span class="tck-testable tck-id-scope-redirect">CDI beans in this scope are automatically created and destroyed by correlating a redirect and the request that follows</span>.
The exact mechanism by which requests are correlated is implementation dependent, but popular techniques include URL rewrites and cookies.</p>
</div>
<div class="paragraph">
<p>Let us assume that <code>MyBean</code> is annotated by <code>@RedirectScoped</code> and given the name <code>mybean</code>, and consider the following controller:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
  <td class="code"><pre><span class="annotation">@Controller</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">submit</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyController</span> {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> MyBean myBean;

    <span class="annotation">@POST</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> post() {
        myBean.setValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">Redirect about to happen</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">redirect:/submit</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">mybean.jsp</span><span class="delimiter">&quot;</span></span>; <span class="comment">// mybean.value accessed in Jakarta Server Page</span>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The bean <code>myBean</code> is injected in the controller and available not only during the first <code>POST</code>, but also during the subsequent <code>GET</code> request,
enabling <em>communication</em> between the two interactions; the creation and destruction of the bean is under control of CDI,
and thus completely transparent to the application just like any other built-in scope.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="models"><a class="anchor" href="#models"></a>2.2. Models</h3>
<div class="paragraph">
<p>Jakarta MVC controllers are responsible for combining data models and views (templates) to produce web application pages.
This specification supports two kinds of models: the first is based on CDI <code>@Named</code> beans,
and the second on the <code>Models</code> interface which defines a map between names and objects.
<span class="tck-testable tck-id-builtin-both-models">Jakarta MVC provides a view engine for Jakarta Server Pages out of the box, which support both types</span>.
For all other view engines supporting the <code>Models</code> interface is mandatory,
support for CDI <code>@Named</code> beans is OPTIONAL but highly RECOMMENDED.</p>
</div>
<div class="paragraph">
<p>Let us now revisit our hello-world example, this time also showing how to update a model. Since we intend to show the two ways in which models
can be used, we define the model as a CDI <code>@Named</code> bean in request scope even though this is only necessary for the CDI case:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span class="annotation">@Named</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">greeting</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RequestScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Greeting</span> {

    <span class="directive">private</span> <span class="predefined-type">String</span> message;

    <span class="directive">public</span> <span class="predefined-type">String</span> getMessage() {
        <span class="keyword">return</span> message;
    }

    <span class="directive">public</span> <span class="type">void</span> setMessage(<span class="predefined-type">String</span> message) {
        <span class="local-variable">this</span>.message = message;
    }
    <span class="comment">//...</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-cdi-model-inject">Given that the view engine for Jakarta Server Pages supports <code>@Named</code> beans, all the controller needs to do is fill out the model and return the view</span>.
Access to the model is straightforward using CDI injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
  <td class="code"><pre><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloController</span> {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> Greeting greeting;

    <span class="annotation">@GET</span>
    <span class="annotation">@Controller</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> hello() {
        greeting.setMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello there!</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello.jsp</span><span class="delimiter">&quot;</span></span>;
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-cdi-model-el">This will allow the view to access the greeting using the EL expression</span> <code>${hello.greeting}</code>.</p>
</div>
<div class="paragraph">
<p>Instead of using CDI beans annotated with <code>@Named</code>, <span class="tck-testable tck-id-models-inject">controllers can also use the <code>Models</code> map to pass data to the view</span>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
  <td class="code"><pre><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloController</span> {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> Models models;

    <span class="annotation">@GET</span>
    <span class="annotation">@Controller</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> hello() {
        models.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">greeting</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> Greeting(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello there!</span><span class="delimiter">&quot;</span></span>));
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello.jsp</span><span class="delimiter">&quot;</span></span>;
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the model is given the same name as that in the <code>@Named</code> annotation above, but using the injectable <code>Models</code> map instead.</p>
</div>
<div class="paragraph">
<p>For more information about view engines see the <a href="#view_engines">View Engines</a> section.</p>
</div>
</div>
<div class="sect2">
<h3 id="views"><a class="anchor" href="#views"></a>2.3. Views</h3>
<div class="paragraph">
<p>A <em>view</em>, sometimes also referred to as a template, defines the structure of the output page and can refer to one or more models.
It is the responsibility of a <em>view engine</em> to process (render) a view by extracting the information in the models and producing the output page.</p>
</div>
<div class="paragraph">
<p>Here is the Jakarta Server Pages page for the hello-world example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html&gt;</span>
    <span class="tag">&lt;head&gt;</span>
        <span class="tag">&lt;title&gt;</span>Hello<span class="tag">&lt;/title&gt;</span>
    <span class="tag">&lt;/head&gt;</span>
    <span class="tag">&lt;body&gt;</span>
        <span class="tag">&lt;h1&gt;</span>${greeting.message}<span class="tag">&lt;/h1&gt;</span>
    <span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-jsp-el">In Jakarta Server Pages, model properties are accessible via EL</span> [<a href="#el30">6</a>]. In the example above, the property <code>message</code> is read from the <code>greeting</code> model
whose name was either specified in a <code>@Named</code> annotation or used as a key in the <code>Models</code> map, depending on which controller from the <a href="#models">Models</a> section triggered this view&#8217;s processing.</p>
</div>
<div class="sect3">
<h4 id="mvc_uri"><a class="anchor" href="#mvc_uri"></a>2.3.1. Building URIs in a View</h4>
<div class="paragraph">
<p>A typical application requires to build URIs for the view, which often refer to controller methods within the same application.
Typical examples for such URIs include HTML links and form actions.
As building URIs manually is difficult and duplicating path patterns between the controller class and the view is error prone,
Jakarta MVC provides a simple way to generate URIs using the <code>MvcContext</code> class.</p>
</div>
<div class="paragraph">
<p>See the following controller as an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre><span class="annotation">@Controller</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">books</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">BookController</span> {

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> list() {
      <span class="comment">// ...</span>
    }

    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> detail( <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">long</span> id ) {
      <span class="comment">// ...</span>
    }

}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the application is deployed with the context path <code>/myapp</code> and is using the application path <code>/mvc</code>,
<span class="tck-testable tck-id-el-access">URIs for these controller methods can be created with an EL expression</span> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="comment">&lt;!-- /myapp/mvc/books --&gt;</span>
${mvc.uri('BookController#list')}

<span class="comment">&lt;!-- /myapp/mvc/books/1234 --&gt;</span>
${mvc.uri('BookController#detail', { 'isbn': 1234 })}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-class-method-name">The controller method is referenced using the simple name of the controller class and the corresponding method name separated by <code>#</code></span>.
<span class="tck-testable tck-id-param-map">If the URI contains path, query or matrix parameters, concrete values can be supplied using a map</span>.
Please note that the keys of this map must match the parameter name used in the <code>@PathParam</code>, <code>@QueryParam</code> or <code>@MatrixParam</code> annotation.
<span class="tck-testable tck-id-uri-encoding">Jakarta MVC implementations MUST apply the corresponding URI encoding rules depending on whether the value is used in a query, path or matrix parameter</span>.</p>
</div>
<div class="paragraph">
<p>The syntax used above to reference the controller method works well in most cases.
However, because of the simple nature of this reference style, it will require controller class names to be unique.
Also, the references may break if the controller class or method name changes as part of a refactoring.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-uri-ref">Therefore, applications can use the <code>@UriRef</code> annotation to define a stable and unique name for a controller method</span>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
  <td class="code"><pre><span class="annotation">@Controller</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">books</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">BookController</span> {

    <span class="annotation">@GET</span>
    <span class="annotation">@UriRef</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book-list</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> list() {
      <span class="comment">// ...</span>
    }

    <span class="comment">// ...</span>

}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Given such a controller class, the view can generate a matching URI by referencing the controller method using this reference.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="comment">&lt;!-- /myapp/mvc/books --&gt;</span>
${mvc.uri('book-list')}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that this feature will work with Jakarta Server Pages and all view engines which support invoking methods on CDI model objects.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data_binding"><a class="anchor" href="#data_binding"></a>3. Data Binding</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter discusses data binding in the Jakarta MVC API.
Data binding is based on the underlying mechanism provided by Jakarta RESTful Web Services,
but with additional support for i18n requirements and for handling data binding errors within the controller.</p>
</div>
<div class="sect2">
<h3 id="data_binding_intro"><a class="anchor" href="#data_binding_intro"></a>3.1. Introduction</h3>
<div class="paragraph">
<p>Jakarta RESTful Web Services provides support for binding request parameters (like form/query parameters) to resource fields or resource method parameters.
With Jakarta RESTful Web Services, developers can also specify validation constraints using Bean Validation annotations.
In this case submitted values are automatically validated against the given constraints and rejected if validation fails.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at the following resource for an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
  <td class="code"><pre><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">FormResource</span> {

    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Min</span>(<span class="integer">18</span>)
    <span class="directive">private</span> <span class="type">int</span> age;

    <span class="annotation">@POST</span>
    <span class="directive">public</span> Response handlePost() {
        <span class="comment">// ...</span>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This resource uses a <code>@FormParam</code> annotation to bind the value of the <code>age</code> form parameter to a resource field.
It also uses the Bean Validation annotation <code>@Min</code> to specify a constraint on the value.</p>
</div>
<div class="paragraph">
<p>When Jakarta RESTful Web Services binds the submitted data to the field, two types of errors are possible:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Binding Error
</td>
<td class="hdlist2">
<p>This type occurs if Jakarta RESTful Web Services is unable to convert the submitted value into the desired target Java type.
For the resource shown above, such an error will be thrown if the user submits some arbitrary string like <code>foobar</code> which cannot be converted into an integer.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Validation Error
</td>
<td class="hdlist2">
<p>If the submitted value can be converted into the target type, Jakarta RESTful Web Services will validate the data according to the Bean Validation constraints.
In our example submitting the value 16 would be considered invalid and therefore result in a constraint violation.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unfortunately the Jakarta RESTful Web Services data binding mechanism doesn&#8217;t work well for web applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Both binding and validation errors will cause Jakarta RESTful Web Services to throw an exception which can only be handled by an <code>ExceptionMapper</code>.
Especially Jakarta RESTful Web Services won&#8217;t execute the resource method if errors were detected.
This is problematic, because typically web applications will want to display the submitted form again and include a message explaining why the submission failed.
Implementing such a requirement using an <code>ExceptionMapper</code> is not feasible.</p>
</li>
<li>
<p>The Jakarta RESTful Web Services data binding is not locale-aware.
This is a problem especially for numeric data types containing fraction digits (like <code>double</code>, <code>float</code>, <code>BigDecimal</code>, etc).
By default, Jakarta RESTful Web Services will always assume the US number format.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mvc_binding_annotation"><a class="anchor" href="#mvc_binding_annotation"></a>3.2. @MvcBinding annotation</h3>
<div class="paragraph">
<p>Jakarta MVC addresses the shortcomings of the standard Jakarta RESTful Web Services data binding by providing a special data binding mode optimized for web applications.
<span class="tck-testable tck-id-mvc-binding">You can enable the Jakarta MVC specific data binding by adding a <code>@MvcBinding</code> annotation to the corresponding controller field or method parameter</span>.</p>
</div>
<div class="paragraph">
<p>The following example shows a controller which uses a Jakarta MVC binding on a controller field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td>
  <td class="code"><pre><span class="annotation">@Controller</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">FormController</span> {

    <span class="annotation">@MvcBinding</span>
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Min</span>(<span class="integer">18</span>)
    <span class="directive">private</span> <span class="type">int</span> age;

    <span class="annotation">@POST</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> processForm() {
        <span class="comment">// ...</span>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that usually <code>@MvcBinding</code> will be used with <code>@FormParam</code> and <code>@QueryParam</code> bindings, as they are very common in web application.
However, depending on the specific use case, it may also be useful to use it with other parameter binding types.
<span class="tck-testable tck-id-all-binding-annotations">Therefore, Jakarta MVC implementations MUST support <code>@MvcBinding</code> with all Jakarta RESTful Web Services binding annotations</span>.</p>
</div>
<div class="paragraph">
<p>The following sections will describe the differences from traditional Jakarta RESTful Web Services data binding in detail.</p>
</div>
</div>
<div class="sect2">
<h3 id="error_handling_bindingresult"><a class="anchor" href="#error_handling_bindingresult"></a>3.3. Error handling with BindingResult</h3>
<div class="paragraph">
<p>As mentioned in the first section, Jakarta RESTful Web Services data binding aborts request processing for any binding or validation error.
This means, that a resource method will only be invoked if all bindings were successful.</p>
</div>
<div class="paragraph">
<p>Jakarta MVC bindings handle such errors in a different way.
<span class="tck-testable tck-id-invoke-controller">A Jakarta MVC implementation is required to invoke the matched controller method even if binding or validation errors occurred</span>.
<span class="tck-testable tck-id-inject-binding-result">Controllers can inject a request-scoped instance of <code>BindingResult</code> to access details about potential data binding errors</span>.
This allows controllers to handle such errors themselves, which typically means that human-readable error messages are presented to the user when the next view is rendered.</p>
</div>
<div class="paragraph">
<p>The following example shows a controller which uses <code>BindingResult</code> to handle data binding errors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td>
  <td class="code"><pre><span class="annotation">@Controller</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">FormController</span> {

    <span class="annotation">@MvcBinding</span>
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Min</span>(<span class="integer">18</span>)
    <span class="directive">private</span> <span class="type">int</span> age;

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> BindingResult bindingResult;

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> Models models;

    <span class="annotation">@POST</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> processForm() {

        <span class="keyword">if</span>( bindingResult.isFailed() ) {
            models.put( <span class="string"><span class="delimiter">&quot;</span><span class="content">errors</span><span class="delimiter">&quot;</span></span>, bindingResult.getAllMessages() );
            <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">form.jsp</span><span class="delimiter">&quot;</span></span>;
        }

        <span class="comment">// process the form request</span>

    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that it is very important for a controller to actually check the <code>BindingResult</code> for errors if it uses Jakarta MVC bindings.
If a binding failed and the controller processes the value without checking for errors, the bound value may be empty or contain an invalid value.</p>
</div>
<div class="paragraph">
<p>Jakarta MVC implementations SHOULD log a warning if a request created data binding errors but the controller didn&#8217;t invoke any method on <code>BindingResult</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="converting_parameters"><a class="anchor" href="#converting_parameters"></a>3.4. Converting to Java types</h3>
<div class="paragraph">
<p>The standard Jakarta RESTful Web Services data binding doesn&#8217;t work very well for web application,
because it isn&#8217;t locale-aware and some standard HTML form elements submit data which cannot easily be bound to matching Java types
(e.g. checkboxes are submitting <code>on</code> if checked and Jakarta RESTful Web Services is expecting <code>true</code> for boolean values).</p>
</div>
<div class="paragraph">
<p>Jakarta MVC implementations are required to apply the following data conversion rules if a binding is annotated with <code>@MvcBinding</code>.</p>
</div>
<div class="sect3">
<h4 id="numeric_types"><a class="anchor" href="#numeric_types"></a>3.4.1. Numeric types</h4>
<div class="paragraph">
<p>Implementations MUST support <code>int</code>, <code>long</code>, <code>float</code>, <code>double</code>, <code>BigDecimal</code>, <code>BigInteger</code> and corresponding wrapper types for Jakarta MVC bindings.
Support for other numeric types is optional.
<span class="tck-testable tck-id-convert-numeric">When converting values to these numeric Java types, Jakarta MVC implementations MUST use the current <em>request locale</em> for parsing non-empty strings</span>.
Typically, an implementation will use a <code>NumberFormat</code> instance initialized with the corresponding locale for converting the data.
<span class="tck-testable tck-id-convert-empty-numeric">Empty strings are either converted to <code>null</code> or to the default value of the corresponding primitive data type</span>.
Please refer to the <a href="#i18n">Internationalization</a> section for details about the Jakarta MVC request locale.</p>
</div>
</div>
<div class="sect3">
<h4 id="boolean_type"><a class="anchor" href="#boolean_type"></a>3.4.2. Boolean type</h4>
<div class="paragraph">
<p><span class="tck-testable tck-id-convert-boolean">When a Jakarta MVC implementation converts a non-empty string to a <code>boolean</code> primitive type or the <code>java.lang.Boolean</code> wrapper type, it MUST convert both <code>true</code> and <code>on</code> to the boolean <code>true</code> and all others strings to <code>false</code></span>.
<span class="tck-testable tck-id-convert-empty-boolean">Empty strings are converted to <code>false</code> in case of the primitive <code>boolean</code> type and to <code>null</code> for the wrapper type</span>.</p>
</div>
</div>
<div class="sect3">
<h4 id="other_types"><a class="anchor" href="#other_types"></a>3.4.3. Other types</h4>
<div class="paragraph">
<p>The conversion rules for all other Java types are implementation-specific.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security"><a class="anchor" href="#security"></a>4. Security</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="security_introduction"><a class="anchor" href="#security_introduction"></a>4.1. Introduction</h3>
<div class="paragraph">
<p>Guarding against malicious attacks is a great concern for web application developers. In particular, Jakarta MVC applications that accept
input from a browser are often targetted by attackers. Two of the most common forms of attacks are cross-site request forgery (CSRF)
and cross-site scripting (XSS). This chapter explores techniques to prevent these type of attacks with the aid of the Jakarta MVC API.</p>
</div>
</div>
<div class="sect2">
<h3 id="cross-site-request-forgery"><a class="anchor" href="#cross-site-request-forgery"></a>4.2. Cross-site Request Forgery</h3>
<div class="paragraph">
<p>Cross-site Request Forgery (CSRF) is a type of attack in which a user, who has a trust relationship with a certain site, is mislead into
executing some commands that exploit the existence of such a trust relationship. The canonical example for this attack is that of a user
unintentionally carrying out a bank transfer while visiting another site.</p>
</div>
<div class="paragraph">
<p>The attack is based on the inclusion of a link or script in a page that accesses a site to which the user is known or assumed to have been
authenticated (trusted). Trust relationships are often stored in the form of cookies that may be active while the user is visiting other
sites. For example, such a malicious site could include the following HTML snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;img</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://yourbank.com/transfer?from=yours</span><span class="content">&amp;</span><span class="content">to=mine</span><span class="content">&amp;</span><span class="content">sum=1000000</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will result in the browser executing a bank transfer in an attempt to load an image.</p>
</div>
<div class="paragraph">
<p>In practice, most sites require the use of form posts to submit requests such as bank transfers. The common way to prevent CSRF attacks is by
embedding additional, difficult-to-guess data fields in requests that contain sensible commands. This additional data, known as a token, is
obtained from the trusted site but unlike cookies it is never stored in the browser.</p>
</div>
<div class="paragraph">
<p>Jakarta MVC implementations provide CSRF protection using the <code>Csrf</code> object and the <code>@CsrfProtected</code> annotation.
<span class="tck-testable tck-id-csrf-obj">The <code>Csrf</code> object is available to applications via the injectable <code>MvcContext</code> type or in Jakarta Expression Language as <code>mvc.csrf</code></span>.
For more information about <code>MvcContext</code>, please refer to the <a href="#mvc_context">MVC Context</a> section.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-csrf-hidden-field">Applications may use the <code>Csrf</code> object to inject a hidden field in a form that can be validated upon submission</span>.
Consider the following JSP:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
  <td class="code"><pre><span class="tag">&lt;html&gt;</span>
    <span class="tag">&lt;head&gt;</span>
        <span class="tag">&lt;title&gt;</span>CSRF Protected Form<span class="tag">&lt;/title&gt;</span>
    <span class="tag">&lt;/head&gt;</span>
    <span class="tag">&lt;body&gt;</span>
        <span class="tag">&lt;form</span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">csrf</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">method</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">accept-charset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">utf-8</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">submit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Click here</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hidden</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mvc.csrf.name}</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mvc.csrf.token}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/form&gt;</span>
    <span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The hidden field will be submitted with the form, giving the Jakarta MVC implementation the opportunity to verify the token and ensure the
validity of the post request.</p>
</div>
<div class="paragraph">
<p>Another way to convey this information to and from the client is via an HTTP header.
<span class="tck-testable tck-id-csrf-verify">Jakarta MVC implementations are REQUIRED to support CSRF tokens both as form fields (with the help of the application developer as shown above) and as HTTP headers</span>.</p>
</div>
<div class="paragraph">
<p>The application-level property <code>jakarta.mvc.security.CsrfProtection</code> enables CSRF protection when set to one of the possible values defined in <code>jakarta.mvc.security.Csrf.CsrfOptions</code>.
<span class="tck-testable tck-id-csrf-opt-default">The default value of this property is <code>CsrfOptions.IMPLICIT</code></span>.
<span class="tck-testable tck-id-csrf-inject-header">Any other value than <code>CsrfOptions.OFF</code> will automatically inject a CSRF token as an HTTP header</span>.
<span class="tck-testable tck-id-csrf-custom-header-name">The actual name of the header can be configured via the <code>Csrf.CSRF_HEADER_NAME</code> configuration property</span>.
<span class="tck-testable tck-id-csrf-default-header-name">The default name of the header is <code>Csrf.DEFAULT_CSRF_HEADER_NAME</code></span>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-csrf-implicit">Automatic validation is enabled by setting this property to <code>CsrfOptions.IMPLICIT</code>, in which case all post requests must include either an HTTP header or a hidden field with the correct token</span>.
<span class="tck-testable tck-id-csrf-explict">Finally, if the property is set to <code>CsrfOptions.EXPLICIT</code> then application developers must annotate controllers using <code>@CsrfProtected</code> to manually enable validation as shown in the following example</span>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">csrf</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Controller</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">CsrfController</span> {

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getForm() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">csrf.jsp</span><span class="delimiter">&quot;</span></span>; <span class="comment">// Injects CSRF token</span>
    }

    <span class="annotation">@POST</span>
    <span class="annotation">@CsrfProtected</span> <span class="comment">// Required for CsrfOptions.EXPLICIT</span>
    <span class="directive">public</span> <span class="type">void</span> postForm(<span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">greeting</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> greeting) {
        <span class="comment">// Process greeting</span>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-csrf-mediatype">Jakarta MVC implementations are required to support CSRF validation of tokens for controllers annotated with <code>@POST</code> and consuming the media type <code>x-www-form-urlencoded</code></span>;
other media types and scenarios may also be supported but are OPTIONAL.</p>
</div>
<div class="paragraph">
<p>If CSRF protection is enabled for a controller method and the CSRF validation fails (because the token is either missing or invalid),
<span class="tck-testable tck-id-csrf-exception">the Jakarta MVC implementation MUST throw a <code>jakarta.mvc.security.CsrfValidationException</code></span>.
<span class="tck-testable tck-id-csrf-default-mapper">The implementation MUST provide a default exception mapper for this exception which handles it by responding with a 403 (Forbidden) status code</span>.
<span class="tck-testable tck-id-csrf-custom-mapper">Applications MAY provide a custom exception mapper for <code>CsrfValidationException</code> to change this default behavior</span>.</p>
</div>
</div>
<div class="sect2">
<h3 id="cross-site-scripting"><a class="anchor" href="#cross-site-scripting"></a>4.3. Cross-site Scripting</h3>
<div class="paragraph">
<p>Cross-site scripting (XSS) is a type of attack in which snippets of scripting code are injected and later executed when returned back from a
server. The typical scenario is that of a website with a search field that does not validate its input, and returns an error message that
includes the value that was submitted. If the value includes a snippet of the form <code>&lt;script&gt;&#8230;&#8203;&lt;/script&gt;</code> then it will be executed by the browser when
the page containing the error is rendered.</p>
</div>
<div class="paragraph">
<p>There are lots of different variations of this the XSS attack, but most can be prevented by ensuring that the data submitted by clients is
properly <em>sanitized</em> before it is manipulated, stored in a database, returned to the client, etc. Data escaping/encoding is the recommended
way to deal with untrusted data and prevent XSS attacks.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-xss-encoders-obj">Jakarta MVC applications can gain access to encoders through the <code>MvcContext</code> object</span>;
<span class="tck-testable tck-id-xss-escaping">the methods defined by <code>jakarta.mvc.security.Encoders</code> can be used by applications to contextually encode data in an attempt to prevent XSS attacks</span>.
The reader is referred to the Javadoc for this type for further information.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="events"><a class="anchor" href="#events"></a>5. Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter introduces a mechanism by which Jakarta MVC applications can be informed of important events that occur while processing a request.
This mechanism is based on Jakarta Contexts and Dependency Injection events that can be fired by implementations and observed by applications.</p>
</div>
<div class="sect2">
<h3 id="observers"><a class="anchor" href="#observers"></a>5.1. Observers</h3>
<div class="paragraph">
<p>The package <code>jakarta.mvc.event</code> defines a number of event types that MUST be fired by implementations during the processing of a request.
Implementations MAY extend this set and also provide additional information on any of the events defined by this specification.
The reader is referred to the implementation’s documentation for more information on event support.</p>
</div>
<div class="paragraph">
<p>Observing events can be useful for applications to learn about the lifecycle of a request, perform logging, monitor performance, etc.
<span class="tck-testable tck-id-before-after-controller">The events <code>BeforeControllerEvent</code> and <code>AfterControllerEvent</code> are fired around the invocation of a controller</span>.
<span class="tck-testable tck-id-after-controller-exception">Please note that <code>AfterControllerEvent</code> is always fired, even if the controller fails with an exception</span>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td>
  <td class="code"><pre>
<span class="comment">/**
 * &lt;p&gt;Event fired before a controller is called but after it has been matched.&lt;/p&gt;
 *
 * &lt;p&gt;For example:
 * &lt;pre&gt;&lt;code&gt;    public class EventObserver {
 *         public void beforeControllerEvent(&amp;#64;Observes BeforeControllerEvent e) {
 *            ...
 *        }
 *    }&lt;/code&gt;&lt;/pre&gt;
 *
 * @author Santiago Pericas-Geertsen
 * @author Ivar Grimstad
 * @see jakarta.enterprise.event.Observes
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BeforeControllerEvent</span> <span class="directive">extends</span> MvcEvent {

    <span class="comment">/**
     * Access to the current request URI information.
     *
     * @return URI info.
     * @see jakarta.ws.rs.core.UriInfo
     */</span>
    UriInfo getUriInfo();

    <span class="comment">/**
     * Access to the current request controller information.
     *
     * @return resources info.
     * @see jakarta.ws.rs.container.ResourceInfo
     */</span>
    ResourceInfo getResourceInfo();
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td>
  <td class="code"><pre>
<span class="comment">/**
 * &lt;p&gt;Event fired after a controller method returns. This event is always fired,
 * even if the controller methods fails with an exception. Must be fired after 
 * {@link jakarta.mvc.event.BeforeControllerEvent}.&lt;/p&gt;
 *
 * &lt;p&gt;For example:
 * &lt;pre&gt;&lt;code&gt;    public class EventObserver {
 *         public void afterControllerEvent(&amp;#64;Observes AfterControllerEvent e) {
 *            ...
 *        }
 *    }&lt;/code&gt;&lt;/pre&gt;
 *
 * @author Santiago Pericas-Geertsen
 * @author Christian Kaltepoth
 * @author Ivar Grimstad
 * @see jakarta.enterprise.event.Observes
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AfterControllerEvent</span> <span class="directive">extends</span> MvcEvent {

    <span class="comment">/**
     * Access to the current request URI information.
     *
     * @return URI info.
     * @see jakarta.ws.rs.core.UriInfo
     */</span>
    UriInfo getUriInfo();

    <span class="comment">/**
     * Access to the current request controller information.
     *
     * @return resources info.
     * @see jakarta.ws.rs.container.ResourceInfo
     */</span>
    ResourceInfo getResourceInfo();
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Applications can monitor these events using an observer as shown next.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
  <td class="code"><pre><span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EventObserver</span> {

    <span class="directive">public</span> <span class="type">void</span> onBeforeController(<span class="annotation">@Observes</span> BeforeControllerEvent e) {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">URI: </span><span class="delimiter">&quot;</span></span> + e.getUriInfo().getRequestUri());
    }

    <span class="directive">public</span> <span class="type">void</span> onAfterController(<span class="annotation">@Observes</span> AfterControllerEvent e) {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Controller: </span><span class="delimiter">&quot;</span></span> +
        e.getResourceInfo().getResourceMethod());
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Observer methods in Jakarta Contexts and Dependency Injection are defined using the <code>@Observes</code> annotation on a parameter position.
The class <code>EventObserver</code> is a Jakarta Contexts and Dependency Injection bean in application scope whose methods <code>onBeforeController</code> and <code>onAfterController</code> are called before and after a controller is called.</p>
</div>
<div class="paragraph">
<p>Each event includes additional information that is specific to the event;
for example, the events shown in the example above allow applications to get information about the request URI and the resource (controller) selected.</p>
</div>
<div class="paragraph">
<p>The <a href="#view_engines">View Engines</a> section describes the algorithm used by implementations to select a specific view engine for processing; after a view engine is selected, the method <code>processView</code> is called.
<span class="tck-testable tck-id-before-after-view">The events <code>BeforeProcessViewEvent</code> and <code>AfterProcessViewEvent</code> are fired around this call</span>.
<span class="tck-testable tck-id-after-view-exception">Please note that <code>AfterProcessViewEvent</code> is always fired, even if the view engine fails with an exception</span>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td>
  <td class="code"><pre>
<span class="comment">/**
 * &lt;p&gt;Event fired after a view engine has been selected but before its
 * {@link jakarta.mvc.engine.ViewEngine#processView(jakarta.mvc.engine.ViewEngineContext)}
 * method is called. Must be fired after {@link jakarta.mvc.event.ControllerRedirectEvent},
 * or if that event is not fired, after {@link jakarta.mvc.event.AfterControllerEvent}.&lt;/p&gt;
 *
 * &lt;p&gt;For example:
 * &lt;pre&gt;&lt;code&gt;    public class EventObserver {
 *         public void beforeProcessView(&amp;#64;Observes BeforeProcessViewEvent e) {
 *            ...
 *        }
 *    }&lt;/code&gt;&lt;/pre&gt;
 *
 * @author Santiago Pericas-Geertsen
 * @author Ivar Grimstad
 * @see jakarta.enterprise.event.Observes
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BeforeProcessViewEvent</span> <span class="directive">extends</span> MvcEvent {

    <span class="comment">/**
     * Returns the view being processed.
     *
     * @return the view.
     */</span>
    <span class="predefined-type">String</span> getView();

    <span class="comment">/**
    * Returns the {@link jakarta.mvc.engine.ViewEngine} selected by the implementation.
            *
            * @return the view engine selected.
            */</span>
    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> ViewEngine&gt; getEngine();
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td>
  <td class="code"><pre>
<span class="comment">/**
 * &lt;p&gt;Event fired after the view engine method
 * {@link jakarta.mvc.engine.ViewEngine#processView(jakarta.mvc.engine.ViewEngineContext)}
 * returns. This event is always fired, even if the view engine fails with an exception. 
 * Must be fired after {@link jakarta.mvc.event.BeforeProcessViewEvent}.&lt;/p&gt;
 *
 * &lt;p&gt;For example:
 * &lt;pre&gt;&lt;code&gt;    public class EventObserver {
 *         public void afterProcessView(&amp;#64;Observes AfterProcessViewEvent e) {
 *            ...
 *        }
 *    }&lt;/code&gt;&lt;/pre&gt;
 *
 * @author Santiago Pericas-Geertsen
 * @author Christian Kaltepoth
 * @author Ivar Grimstad
 * @see jakarta.enterprise.event.Observes
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AfterProcessViewEvent</span> <span class="directive">extends</span> MvcEvent {

    <span class="comment">/**
     * Returns the view being processed.
     *
     * @return the view.
     */</span>
    <span class="predefined-type">String</span> getView();

    <span class="comment">/**
     * Returns the {@link jakarta.mvc.engine.ViewEngine} selected by the implementation.
     *
     * @return the view engine selected.
     */</span>
    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> ViewEngine&gt; getEngine();
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>These events can be observed in a similar manner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td>
  <td class="code"><pre><span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EventObserver</span> {

    <span class="directive">public</span> <span class="type">void</span> onBeforeProcessView(<span class="annotation">@Observes</span> BeforeProcessViewEvent e) {
        <span class="comment">// ...</span>
    }

    <span class="directive">public</span> <span class="type">void</span> onAfterProcessView(<span class="annotation">@Observes</span> AfterProcessViewEvent e) {
        <span class="comment">// ...</span>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>To complete the example, let us assume that the information about the selected view engine needs to be conveyed to the client.
To ensure that this information is available to a view returned to the client,
the <code>EventObserver</code> class can inject and update the same request-scope bean accessed by such a view:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
  <td class="code"><pre><span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EventObserver</span> {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> EventBean eventBean;

    <span class="directive">public</span> <span class="type">void</span> onBeforeProcessView(<span class="annotation">@Observes</span> BeforeProcessViewEvent e) {
        eventBean.setView(e.getView());
        eventBean.setEngine(e.getEngine());
    }
    <span class="comment">// ...</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about the interaction between views and models, the reader is referred to the <a href="#models">Models</a> section.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-redirect-event">The last event supported by Jakarta MVC is <code>ControllerRedirectEvent</code>, which is fired just before the Jakarta MVC implementation returns a redirect status code</span>.
<span class="tck-testable tck-id-redirect-after-controller-event">Please note that this event MUST be fired after <code>AfterControllerEvent</code></span>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td>
  <td class="code"><pre>
<span class="comment">/**
 * &lt;p&gt;Event fired when a controller triggers a redirect. Only the
 * status codes 301 (moved permanently), 302 (found), 303 (see other) and
 * 307 (temporary redirect) are REQUIRED to be reported. Note that the
 * JAX-RS methods
 * {@link jakarta.ws.rs.core.Response#seeOther(java.net.URI)}} and
 * {@link jakarta.ws.rs.core.Response#temporaryRedirect(java.net.URI)}}
 * use the status codes to 303 and 307, respectively. Must be
 * fired after {@link jakarta.mvc.event.AfterControllerEvent}.&lt;/p&gt;
 *
 * &lt;p&gt;For example:
 * &lt;pre&gt;&lt;code&gt;    public class EventObserver {
 *         public void onControllerRedirect(&amp;#64;Observes ControllerRedirectEvent e) {
 *            ...
 *        }
 *    }&lt;/code&gt;&lt;/pre&gt;
 *
 * @author Santiago Pericas-Geertsen
 * @author Ivar Grimstad
 * @see jakarta.enterprise.event.Observes
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ControllerRedirectEvent</span> <span class="directive">extends</span> MvcEvent {

    <span class="comment">/**
     * Access to the current request URI information.
     *
     * @return URI info.
     * @see jakarta.ws.rs.core.UriInfo
     */</span>
    UriInfo getUriInfo();

    <span class="comment">/**
     * Access to the current request controller information.
     *
     * @return resources info.
     * @see jakarta.ws.rs.container.ResourceInfo
     */</span>
    ResourceInfo getResourceInfo();

    <span class="comment">/**
     * The target of the redirection.
     *
     * @return URI of redirection.
     */</span>
    <span class="predefined-type">URI</span> getLocation();
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Jakarta Contexts and Dependency Injection events fired by implementations are <em>synchronous</em>, so it is recommended that applications carry out only simple tasks in their observer methods,
avoiding long-running computations as well as blocking calls.
For a complete list of events, the reader is referred to the Javadoc for the <code>jakarta.mvc.event</code> package.</p>
</div>
<div class="paragraph">
<p>Event reporting requires the Jakarta MVC implementations to create event objects before firing.
In high-throughput systems without any observers the number of unnecessary objects created may not be insignificant.
For this reason, it is RECOMMENDED for implementations to consider smart firing strategies when no observers are present.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="applications"><a class="anchor" href="#applications"></a>6. Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter introduces the notion of a Jakarta MVC application and explains how it relates to a Jakarta RESTful Web Services application.</p>
</div>
<div class="sect2">
<h3 id="mvc_applications"><a class="anchor" href="#mvc_applications"></a>6.1. MVC Applications</h3>
<div class="paragraph">
<p>A Jakarta MVC application consists of one or more Jakarta RESTful Web Services resources that are annotated with <code>@Controller</code> and, just like Jakarta RESTful Web Services applications, zero or more providers.
If no resources are annotated with <code>@Controller</code>, then the resulting application is a Jakarta RESTful Web Services application instead.
In general, everything that applies to a Jakarta RESTful Web Services application also applies to a Jakarta MVC application.
Some Jakarta MVC applications may be <em>hybrid</em> and include a mix of Jakarta MVC controllers and Jakarta RESTful Web Services resource methods.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-application-class">The controllers and providers that make up an application are configured via an application-supplied subclass of <code>Application</code> from Jakarta RESTful Web Services</span>.
An implementation MAY provide alternate mechanisms for locating controllers, but as in Jakarta RESTful Web Services, the use of an <code>Application</code> subclass is the only way to guarantee portability.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-url-space">The path in the application&#8217;s URL space in which Jakarta MVC controllers live must be specified either using the <code>@ApplicationPath</code> annotation on the application subclass or in the web.xml as part of the <code>url-pattern</code> element</span>.
Jakarta MVC applications SHOULD use a non-empty path or pattern: i.e., <em>"/"</em> or <em>"/*"</em> should be avoided whenever possible.
The reason for this is that Jakarta MVC implementations often forward requests to the Servlet container,
and the use of the aforementioned values may result in the unwanted processing of the forwarded request by the Jakarta RESTful Web Services servlet once again.</p>
</div>
</div>
<div class="sect2">
<h3 id="mvc_context"><a class="anchor" href="#mvc_context"></a>6.2. MVC Context</h3>
<div class="paragraph">
<p><span class="tck-testable tck-id-injection">MVC applications can inject an instance of <code>MvcContext</code> to access configuration, security and path-related information</span>.
<span class="tck-testable tck-id-request-scope">Instances of <code>MvcContext</code> are provided by implementations and are always in request scope</span>.
<span class="tck-testable tck-id-el-access">For convenience, the <code>MvcContext</code> instance is also available using the name <code>mvc</code> in EL</span>.</p>
</div>
<div class="paragraph">
<p>As an example, a view can refer to a controller by using the base path available in the <code>MvcContext</code> object as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;a</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mvc.basePath}/books</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Click here<span class="tag">&lt;/a&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on security see the Chapter on <a href="#security">Security</a>; for more information about the <code>MvcContext</code> in general, refer to the Javadoc for the type.</p>
</div>
</div>
<div class="sect2">
<h3 id="providers_in_mvc"><a class="anchor" href="#providers_in_mvc"></a>6.3. Providers in MVC</h3>
<div class="paragraph">
<p>Implementations are free to use their own providers in order to modify the standard Jakarta RESTful Web Services pipeline for the purpose of implementing the MVC semantics.
Whenever mixing implementation and application providers, care should be taken to ensure the correct execution order using priorities.</p>
</div>
</div>
<div class="sect2">
<h3 id="annotation_inheritance"><a class="anchor" href="#annotation_inheritance"></a>6.4. Annotation Inheritance</h3>
<div class="paragraph">
<p>Jakarta MVC applications MUST follow the annotation inheritance rules defined by Jakarta RESTful Web Services.
Namely, Jakarta MVC annotations may be used on methods of a super-class or an implemented interface.
<span class="tck-testable tck-id-inheritance">Such annotations are inherited by a corresponding sub-class or implementation class method provided that the method does not have any Jakarta MVC or Jakarta RESTful Web Services annotations of its own</span>:
i.e., if a subclass or implementation method has any Jakarta MVC or Jakarta RESTful Web Services annotations then all of the annotations on the superclass or interface method are ignored.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-class-vs-iface">Annotations on a super-class take precedence over those on an implemented interface</span>.
The precedence over conflicting annotations defined in multiple implemented interfaces is implementation dependent.
Note that, in accordance to the Jakarta RESTful Web Services rules, inheritance of class or interface annotations is not supported.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuration_in_mvc"><a class="anchor" href="#configuration_in_mvc"></a>6.5. Configuration in MVC</h3>
<div class="paragraph">
<p>Implementations MUST support configuration via the native Jakarta RESTful Web Services configuration mechanism but MAY support other configuration sources.</p>
</div>
<div class="paragraph">
<p>There are concrete configurations, that all Jakarta MVC the implementations are <code>REQUIRED</code> the support such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ViewEngine.VIEW_FOLDER</code></p>
</li>
<li>
<p><code>Csrf.CSRF_PROTECTION</code></p>
</li>
<li>
<p><code>Csrf.CSRF_HEADER_NAME</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here&#8217;s a simple example of how you can configure a custom location for the view folder other than the <code>/WEB-INF/views</code>, simply by overwriting the <code>getProperties</code> method of the subclass <code>Application</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td>
  <td class="code"><pre><span class="annotation">@ApplicationPath</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">resources</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyApplication</span> <span class="directive">extends</span> Application {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getProperties() {
        <span class="directive">final</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; map = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
        map.put(ViewEngine.VIEW_FOLDER, <span class="string"><span class="delimiter">&quot;</span><span class="content">/jsp/</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> map;
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="view_engines"><a class="anchor" href="#view_engines"></a>7. View Engines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter introduces the notion of a view engine as the mechanism by which views are processed in Jakarta MVC.
The set of available view engines is extensible via Jakarta Contexts and Dependency Injection, enabling applications as well as other frameworks to provide support for additional view languages.</p>
</div>
<div class="sect2">
<h3 id="view_engines_introduction"><a class="anchor" href="#view_engines_introduction"></a>7.1. Introduction</h3>
<div class="paragraph">
<p>A <em>view engine</em> is responsible for processing views. In this context, processing entails (i) locating and loading a view (ii) preparing any
required models and (iii) rendering the view and writing the result back to the client.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-jsp">Implementations MUST provide built-in support for Jakarta Server Pages</span>.
Additional engines may be supported via an extension mechanism based on Jakarta Contexts and Dependency Injection.
<span class="tck-testable tck-id-cdi-discovery">Namely, any Jakarta Contexts and Dependency Injection bean that implements the <code>jakarta.mvc.engine.ViewEngine</code> interface MUST be considered as a possible target for processing by calling its <code>supports</code> method, discarding the engine if this method returns <code>false</code></span>.</p>
</div>
<div class="paragraph">
<p>This is the interface that must be implemented by all Jakarta MVC view engines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
</pre></td>
  <td class="code"><pre>
<span class="comment">/**
 * &lt;p&gt;View engines are responsible for processing views and are discovered
 * using Jakarta Contexts and Dependency Injection. Implementations must look up all instances of this interface,
 * and process a view as follows:
 * &lt;ol&gt;
 *     &lt;li&gt;Gather the set of candidate view engines by calling {@link #supports(String)}
 *     and discarding engines that return &lt;code&gt;false&lt;/code&gt;.&lt;/li&gt;
 *     &lt;li&gt;Sort the resulting set of candidates using priorities. View engines
 *     can be decorated with {@link jakarta.annotation.Priority} to indicate
 *     their priority; otherwise the priority is assumed to be {@link ViewEngine#PRIORITY_APPLICATION}.&lt;/li&gt;
 *     &lt;li&gt;If more than one candidate is available, choose one in an
 *     implementation-defined manner.&lt;/li&gt;
 *     &lt;li&gt;Fire a {@link jakarta.mvc.event.BeforeProcessViewEvent} event.&lt;/li&gt;
 *     &lt;li&gt;Call method {@link #processView(ViewEngineContext)} to process view.&lt;/li&gt;
 *     &lt;li&gt;Fire a {@link jakarta.mvc.event.AfterProcessViewEvent} event.&lt;/li&gt;
 * &lt;/ol&gt;
 * &lt;p&gt;The default view engine for Jakarta Server Pages uses file extensions to determine
 * support. Namely, the default Jakarta Server Pages view engine supports views with extensions &lt;code&gt;jsp&lt;/code&gt;
 * and &lt;code&gt;jspx&lt;/code&gt;.&lt;/p&gt;
 *
 * @author Santiago Pericas-Geertsen
 * @author Ivar Grimstad
 * @see jakarta.annotation.Priority
 * @see jakarta.mvc.event.BeforeProcessViewEvent
 * @since 1.0
 */</span>
<span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unused</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ViewEngine</span> {

    <span class="comment">/**
     * Name of property that can be set to override the root location for views in an archive.
     *
     * @see jakarta.ws.rs.core.Application#getProperties()
     */</span>
    <span class="predefined-type">String</span> VIEW_FOLDER = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.mvc.engine.ViewEngine.viewFolder</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * The default view file extension that is used to fetch templates. For example, if this setting is set to &lt;code&gt;.jsp&lt;/code&gt;,
     * instead of returning &lt;code&gt;index.jsp&lt;/code&gt; only &lt;code&gt;index&lt;/code&gt; is required.
     *
     * @see jakarta.ws.rs.core.Application#getProperties()
     */</span>
    <span class="predefined-type">String</span> VIEW_EXTENSION = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.mvc.engine.ViewEngine.defaultViewFileExtension</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * Default value for property {@link #VIEW_FOLDER}.
     */</span>
    <span class="predefined-type">String</span> DEFAULT_VIEW_FOLDER = <span class="string"><span class="delimiter">&quot;</span><span class="content">/WEB-INF/views/</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * Priority for all built-in view engines.
     */</span>
    <span class="type">int</span> PRIORITY_BUILTIN = <span class="integer">1000</span>;

    <span class="comment">/**
     * Recommended priority for all view engines provided by frameworks built
     * on top of MVC implementations.
     */</span>
    <span class="type">int</span> PRIORITY_FRAMEWORK = <span class="integer">2000</span>;

    <span class="comment">/**
     * Recommended priority for all application-provided view engines (default).
     */</span>
    <span class="type">int</span> PRIORITY_APPLICATION = <span class="integer">3000</span>;

    <span class="comment">/**
     * Returns &lt;code&gt;true&lt;/code&gt; if this engine can process the view or &lt;code&gt;false&lt;/code&gt;
     * otherwise.
     *
     * @param view the view.
     * @return outcome of supports test.
     */</span>
    <span class="type">boolean</span> supports(<span class="predefined-type">String</span> view);

    <span class="comment">/**
     * &lt;p&gt;Process a view given a {@link jakarta.mvc.engine.ViewEngineContext}. Processing
     * a view involves &lt;i&gt;merging&lt;/i&gt; the model and template data and writing
     * the result to an output stream.&lt;/p&gt;
     *
     * &lt;p&gt;Following the Jakarta EE threading model, the underlying view engine implementation
     * must support this method being called by different threads. Any resources allocated
     * during view processing must be released before the method returns.&lt;/p&gt;
     *
     * @param context the context needed for processing.
     * @throws ViewEngineException if an error occurs during processing.
     */</span>
    <span class="type">void</span> processView(ViewEngineContext context) <span class="directive">throws</span> ViewEngineException;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="selection_algorithm"><a class="anchor" href="#selection_algorithm"></a>7.2. Selection Algorithm</h3>
<div class="paragraph">
<p><span class="tck-testable tck-id-selection-algo">Implementations should perform the following steps while trying to find a suitable view engine for a view</span>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Lookup all instances of <code>jakarta.mvc.engine.ViewEngine</code> available via Jakarta Contexts and Dependency Injection.</p>
</li>
<li>
<p>Call <code>supports</code> on every view engine found in the previous step, discarding those that return <code>false</code>.</p>
</li>
<li>
<p>If the resulting set is empty, return <code>null</code>.</p>
</li>
<li>
<p>Otherwise, sort the resulting set in descending order of priority using the integer value from the <code>@Priority</code> annotation decorating the view engine class or the default value <code>ViewEngine.PRIORITY_APPLICATION</code> if the annotation is not present.</p>
</li>
<li>
<p>Return the first element in the resulting sorted set, that is, the view engine with the highest priority that supports the given view.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If a view engine that can process a view is not found, implementations SHOULD throw a corresponding exception and stop to process the request.</p>
</div>
<div class="paragraph">
<p>The <code>processView</code> method has all the information necessary for processing in the <code>ViewEngineContext</code>, including the view, a reference to <code>Models</code>, as well as the underlying <code>OutputStream</code> that can be used to send the result to the client.</p>
</div>
<div class="paragraph">
<p>Prior to the view render phase, all entries available in <code>Models</code> MUST be bound in such a way that they become available to the view being processed.
The exact mechanism for this depends on the actual view engine implementation.
<span class="tck-testable tck-id-models-binding">In the case of the built-in view engines for JSPs, entries in <code>Models</code> must be bound by calling <code>HttpServletRequest.setAttribute(String, Object)</code></span>.
Calling this method ensures access to the named models from EL expressions.</p>
</div>
<div class="paragraph">
<p>A view returned by a controller method represents a path within an application archive.
<span class="tck-testable tck-id-path-relative">If the path is relative, does not start with <code>/</code>, implementations MUST resolve view paths relative to the view folder, which defaults to <code>/WEB-INF/views/</code></span>.
<span class="tck-testable tck-id-path-absolute">If the path is absolute, no further processing is required</span>.
It is recommended to use relative paths and a location under <code>WEB-INF</code> to prevent direct access to views as static resources.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="i18n"><a class="anchor" href="#i18n"></a>8. Internationalization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter introduces the notion of a <em>request locale</em> and describes how Jakarta MVC handles internationalization and localization.</p>
</div>
<div class="sect2">
<h3 id="i18n_introduction"><a class="anchor" href="#i18n_introduction"></a>8.1. Introduction</h3>
<div class="paragraph">
<p>Internationalization and localization are very important concepts for any web application framework.
Therefore Jakarta MVC has been designed to make supporting multiple languages and regional differences in applications very easy.</p>
</div>
<div class="paragraph">
<p>Jakarta MVC defines the term <em>request locale</em> as the locale which is used for any locale-dependent operation within the lifecycle of a request.
The request locale MUST be resolved exactly once for each request using the resolving algorithm described in the <a href="#i18n_resolving_algorithm">Resolving Algorithm</a> section.</p>
</div>
<div class="paragraph">
<p>These locale-dependent operations include, but are not limited to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Data type conversion as part of the data binding mechanism.</p>
</li>
<li>
<p>Formatting of data when rendering it to the view.</p>
</li>
<li>
<p>Generating binding and validation error messages in the specific language.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-mvc-context-locale">The request locale is available from <code>MvcContext</code> and can be used by controllers, view engines and other components</span> to perform operations which depend on the current locale.
The example below shows a controller that uses the request locale to create a <code>NumberFormat</code> instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
  <td class="code"><pre><span class="annotation">@Controller</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/foobar</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyController</span> {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> MvcContext mvc;

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get() {
        <span class="predefined-type">Locale</span> locale = mvc.getLocale();
        <span class="predefined-type">NumberFormat</span> format = <span class="predefined-type">NumberFormat</span>.getInstance(locale);
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following sections will explain the locale resolving algorithm and the default resolver provided by the Jakarta MVC implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="i18n_resolving_algorithm"><a class="anchor" href="#i18n_resolving_algorithm"></a>8.2. Resolving Algorithm</h3>
<div class="paragraph">
<p>The <em>locale resolver</em> is responsible to detect the request locale for each request processed by the Jakarta MVC runtime.
A locale resolver MUST implement the <code>jakarta.mvc.locale.LocaleResolver</code> interface which is defined like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td>
  <td class="code"><pre>
<span class="comment">/**
 * &lt;p&gt;Locale resolvers are used to determine the locale of the current request and are discovered
 * using Jakarta Contexts and Dependency Injection.&lt;/p&gt;
 *
 * &lt;p&gt;The Jakarta MVC implementation is required to resolve the locale for each request following this
 * algorithm:&lt;/p&gt;
 *
 * &lt;ol&gt;
 * &lt;li&gt;Gather the set of all implementations of this interface available for injection via
 * CDI.&lt;/li&gt;
 * &lt;li&gt;Sort the set of implementations using priorities in descending order. Locale resolvers
 * can be decorated with {@link jakarta.annotation.Priority} to indicate their priority. If no
 * priority is explicitly defined, the priority is assumed to be &lt;code&gt;1000&lt;/code&gt;.&lt;/li&gt;
 * &lt;li&gt;Call the method {@link #resolveLocale(LocaleResolverContext)}. If the resolver returns
 * a valid locale, use this locale as the request locale. If the resolver returns
 * &lt;code&gt;null&lt;/code&gt;, proceed with the next resolver in the ordered set.&lt;/li&gt;
 * &lt;/ol&gt;
 *
 * &lt;p&gt;Controllers, view engines and other components can access the resolved locale by calling
 * {@link MvcContext#getLocale()}.&lt;/p&gt;
 *
 * &lt;p&gt;The MVC implementation is required to provide a default locale resolver with a priority
 * of &lt;code&gt;0&lt;/code&gt; which uses the &lt;code&gt;Accept-Language&lt;/code&gt; request header to obtain the
 * locale. If resolving the locale this way isn't possible, the default resolver must return
 * {@link Locale#getDefault()}.&lt;/p&gt;
 *
 * @author Christian Kaltepoth
 * @author Ivar Grimstad
 * @see jakarta.mvc.locale.LocaleResolverContext
 * @see MvcContext#getLocale()
 * @see java.util.Locale
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">LocaleResolver</span> {

    <span class="comment">/**
     * &lt;p&gt;Resolve the locale of the current request given a {@link LocaleResolverContext}.&lt;/p&gt;
     *
     * &lt;p&gt;If the implementation is able to resolve the locale for the request, the corresponding
     * locale must be returned. If the implementation cannot resolve the locale, it must return
     * &lt;code&gt;null&lt;/code&gt;. In this case the resolving process will continue with the next
     * resolver.&lt;/p&gt;
     *
     * @param context the context needed for processing.
     * @return The resolved locale or &lt;code&gt;null&lt;/code&gt;.
     */</span>
    <span class="predefined-type">Locale</span> resolveLocale(LocaleResolverContext context);

}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>There may be more than one locale resolver for a Jakarta MVC application. Locale resolvers are discovered using Jakarta Contexts and Dependency Injection.
<span class="tck-testable tck-id-resolver-discovery">Every Jakarta Contexts and Dependency Injection bean implementing the <code>LocaleResolver</code> interface and visible to the application participates in the locale resolving algorithm</span>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-resolve-algorithm">Implementations MUST use the following algorithm to resolve the request locale for each request</span>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Obtain a list of all Jakarta Contexts and Dependency Injection beans implementing the <code>LocaleResolver</code> interface visible to the application’s <code>BeanManager</code>.</p>
</li>
<li>
<p>Sort the list of locale resolvers in descending order of priority using the integer value from the <code>@Priority</code> annotation decorating the resolver class.<br>
If no <code>@Priority</code> annotation is present, assume a default priority of <code>1000</code>.</p>
</li>
<li>
<p>Call <code>resolveLocale()</code> on the first resolver in the list. If the resolver returns <code>null</code>, continue with the next resolver in the list.<br>
If a resolver returns a non-null result, stop the algorithm and use the returned locale as the request locale.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Applications can either rely on the default locale resolver which is described in the <a href="#i18n_default_resolver">Default Locale Resolver</a> section
or provide a custom resolver which implements some other strategy for resolving the request locale.
A custom strategy could for example track the locale using the session, a query parameter or the server’s hostname.</p>
</div>
</div>
<div class="sect2">
<h3 id="i18n_default_resolver"><a class="anchor" href="#i18n_default_resolver"></a>8.3. Default Locale Resolver</h3>
<div class="paragraph">
<p><span class="tck-testable tck-id-default-locale-resolver">Every Jakarta MVC implementation MUST provide a default locale resolver with a priority of <code>0</code> which resolves the request locale according to the following algorithm</span>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First check whether the client provided an <code>Accept-Language</code> request header. If this is the case, the locale with the highest quality factor is returned as the result.</p>
</li>
<li>
<p>If the previous step was not successful, return the system default locale of the server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Please note that applications can customize the locale resolving process by providing a custom locale resolver with a priority higher than <code>0</code>.
See the <a href="#i18n_resolving_algorithm">Resolving Algorithm</a> section for details.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="form_method_overwrite"><a class="anchor" href="#form_method_overwrite"></a>9. Form method override</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter introduces the notion of <em>form method overwrite</em> and describes how Jakarta MVC supports HTTP methods besides <code>GET</code> and <code>POST</code> when using HTML forms.</p>
</div>
<div class="sect2">
<h3 id="form_method_overwrite_introduction"><a class="anchor" href="#form_method_overwrite_introduction"></a>9.1. Introduction</h3>
<div class="paragraph">
<p>The HTML <code>&lt;form&gt;</code> is per default only capable of handling the HTTP <code>GET</code> and <code>POST</code> verbs. Anyway, more complex applications maybe want to use Jakarta MVC to support HTML as one type of resource representation and need the power of other HTTP verbs like <code>PATCH</code> or <code>DELETE</code> too. Therefore Jakarta MVC supports overwriting the HTTP method by providing an easy to use and configurable mechanism.</p>
</div>
<div class="paragraph">
<p>Jakarta MVC defines the term <em>form method overwrite</em> as the mechanism being responsible for changing the HTTP request&#8217;s method to something different than <code>GET</code> or <code>POST</code>.</p>
</div>
<div class="paragraph">
<p>The <em>form method overwrite</em> MUST happen exactly once per request as described in <a href="#form_method_overwrite_resolving_algorithm">Resolving Algorithm</a> before the controller is resolved.</p>
</div>
<div class="paragraph">
<p>To have control over the form method handling, Jakarta MVC provides two properties with constants for easier usage in the class <code>jakarta.mvc.form.FormMethodOverwriter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td>
  <td class="code"><pre><span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">FormMethodOverwriter</span> {
    
    <span class="comment">/**
     * Property that can be used to enable the Form method overwrite mechanism for an application.
     * Values of this property must be of type {@link FormMethodOverwriter.Options}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> FORM_METHOD_OVERWRITE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.mvc.form.FormMethodOverwrite</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * Property that can be used to configure the name of the hidden form input to get the targeted HTTP method.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> HIDDEN_FIELD_NAME = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.mvc.form.HiddenFieldName</span><span class="delimiter">&quot;</span></span>;
    
    <span class="comment">/**
     * The default name of the hidden form field used to overwrite the HTTP method.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> DEFAULT_HIDDEN_FIELD_NAME = <span class="string"><span class="delimiter">&quot;</span><span class="content">_method</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * Options for property {@link FormMethodOverwriter#FORM_METHOD_OVERWRITE}.
     */</span>
    <span class="directive">public</span> <span class="type">enum</span> Options {
        <span class="comment">/**
         * Form method overwrite is not enabled.
         */</span>
        DISABLED,

        <span class="comment">/**
         * Form method overwrite is enabled. Each request will be checked for potential overwrites.
         */</span>
        ENABLED
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jakarta.mvc.form.FormMethodOverwrite</code> which can be either <code>ENABLED</code> or <code>DISABLED</code>. The legal options for this property are defined in <code>jakarta.mvc.form.FormMethodOverwriter.Options</code>. Its default value is <code>ENABLED</code>.</p>
</li>
<li>
<p><code>jakarta.mvc.form.HiddenFieldName</code> which defines the name of the hidden input field containing the HTTP method which shall be used instead of the original one.
The default value <code>_method</code> is defined in <code>jakarta.mvc.form.FormMethodOverwriter#HIDDEN_FIELD_NAME_DEFAULT</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections will explain the form method overwrite resolving algorithm provided by the Jakarta MVC implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="form_method_overwrite_resolving_algorithm"><a class="anchor" href="#form_method_overwrite_resolving_algorithm"></a>9.2. Resolving Algorithm</h3>
<div class="paragraph">
<p>The <em>form method overwriter</em> is responsible to detect if the HTTP method shall be overwritten and perform the overwrite if necessary. The specification won&#8217;t provide an interface for this task, as there are a lot of possibilities provided by the specifications MVC is based on, like <code>HttpServletFilter</code> from Jakarta Servlet or Jakarta RESTful&#8217;s <code>ContainerRequestFilter</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable tck-id-form-overwriter-algorithm">Implementations MUST use the following algorithm to overwrite the HTTP method for each request</span>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check if the following preconditions are <code>true</code>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The configuration property <code>jakarta.mvc.form.FormMethodOverwrite</code> is set to <code>FormMethodOverwriter.Options#ENABLED</code></p>
</li>
<li>
<p>The request is a <code>POST</code> request.</p>
</li>
<li>
<p>A form field with the name like it&#8217;s configured in <code>jakarta.mvc.form.HiddenFieldName</code> is available</p>
</li>
</ol>
</div>
</li>
<li>
<p>If all conditions are resolved to true:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Overwrite the HTTP method to the value provided by the hidden form field.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If any of these preconditions evaluates to <code>false</code>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>End the procedure without changing the request&#8217;s HTTP method</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Applications can either rely on the form method overwriter algorithm which is described in this section or provide a custom form method overwriter which implements some other strategy.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="annotation_table"><a class="anchor" href="#annotation_table"></a>Appendix A: Summary of Annotations</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Annotation</th>
<th class="tableblock halign-left valign-top">Target</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Controller</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type or method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a resource method as a Jakarta MVC controller. If
specified at the type level, it defines all methods in a class
as controllers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>View</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type or method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares a view for a controller method that returns void.
If specified at the type level, it applies to all controller
methods that return void in a class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CsrfValid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">States that a CSRF token must be validated before
invoking the controller. Failure to validate the CSRF
token results in a <code>ForbiddenException</code> thrown.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RedirectScoped</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type, method or field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies that a certain bean is in redirect scope.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UriRef</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a symbolic name for a controller method.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MvcBinding</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Field, method or parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares that constraint violations will be handled by a
controller through <code>BindingResult</code> instead of triggering
a <code>ConstraintViolationException</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="revision_history"><a class="anchor" href="#revision_history"></a>Appendix B: Revision History</h2>
<div class="sectionbody">
<div class="paragraph">
<p>3.0</p>
</div>
<div id="version_three_zero" class="paragraph">
<p><sub>~</sub></p>
</div>
<div class="paragraph">
<p>Remove requirement for Facelets support</p>
</div>
<div class="paragraph">
<p>2.1</p>
</div>
<div id="version_two_one" class="paragraph">
<p><sub>~</sub></p>
</div>
<div class="paragraph">
<p>Specified <code>FormMethodOverwrite</code> for extended HTTP method support</p>
</div>
<div class="paragraph">
<p>2.0</p>
</div>
<div id="version_two_zero" class="paragraph">
<p><sub>~</sub></p>
</div>
<div class="paragraph">
<p>Changed namespace from <code>javax.mvc</code> to <code>jakarta.mvc</code>.</p>
</div>
<div class="paragraph">
<p>1.1</p>
</div>
<div id="version_one_one" class="paragraph">
<p><sub>~</sub></p>
</div>
<div class="paragraph">
<p>No API changes since 1.0.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bibliography"><a class="anchor" href="#bibliography"></a>Bibliography</h2>
<div class="sectionbody">
<div id="jsf23" class="dlist">
<dl>
<dt class="hdlist1">[1]</dt>
<dd>
<p>Jakarta Server Faces 2.3, August 2019<br>
<a href="https://jakarta.ee/specifications/faces/2.3/" class="bare">https://jakarta.ee/specifications/faces/2.3/</a></p>
</dd>
</dl>
</div>
<div id="cdi20" class="dlist">
<dl>
<dt class="hdlist1">[2]</dt>
<dd>
<p>Jakarta Context Dependency Injection 2.0, August 2019<br>
<a href="https://jakarta.ee/specifications/cdi/2.0/" class="bare">https://jakarta.ee/specifications/cdi/2.0/</a></p>
</dd>
</dl>
</div>
<div id="bv20" class="dlist">
<dl>
<dt class="hdlist1">[3]</dt>
<dd>
<p>Jakarta Bean Validation 2.0, August 2019<br>
<a href="https://jakarta.ee/specifications/bean-validation/2.0/" class="bare">https://jakarta.ee/specifications/bean-validation/2.0/</a></p>
</dd>
</dl>
</div>
<div id="rfc2119" class="dlist">
<dl>
<dt class="hdlist1">[4]</dt>
<dd>
<p>S. Bradner. RFC 2119: Keywords for use in RFCs to Indicate Requirement Levels. RFC, IETF, March 1997<br>
<a href="http://www.ietf.org/rfc/rfc2119.txt" class="bare">http://www.ietf.org/rfc/rfc2119.txt</a></p>
</dd>
</dl>
</div>
<div id="jaxrs21" class="dlist">
<dl>
<dt class="hdlist1">[5]</dt>
<dd>
<p>Jakarta RESTful Web Services 2.1, August 2019<br>
<a href="https://jakarta.ee/specifications/restful-ws/2.1/" class="bare">https://jakarta.ee/specifications/restful-ws/2.1/</a></p>
</dd>
</dl>
</div>
<div id="el30" class="dlist">
<dl>
<dt class="hdlist1">[6]</dt>
<dd>
<p>Jakarta Expression Language 3.0, August 2019<br>
<a href="https://jakarta.ee/specifications/expression-language/3.0/" class="bare">https://jakarta.ee/specifications/expression-language/3.0/</a></p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
 3.0<br>
</div>
</div>
</body>
</html>