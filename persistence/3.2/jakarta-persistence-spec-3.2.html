<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="Jakarta Persistence Team, https://projects.eclipse.org/projects/ee4j.jpa">
<title>Jakarta Persistence</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Jakarta Persistence</h1>
<div class="details">
<span id="author" class="author">Jakarta Persistence Team, https://projects.eclipse.org/projects/ee4j.jpa</span><br>
<span id="email" class="email"><a href="https://dev.eclipse.org/mailman/listinfo/jpa-dev" class="bare">https://dev.eclipse.org/mailman/listinfo/jpa-dev</a></span><br>
<span id="revnumber"> 3.2,</span>
<span id="revdate">March 28, 2024</span>
<br><span id="revremark"></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#eclipse-foundation-specification-license-v1-1">Eclipse Foundation Specification License - v1.1</a>
<ul class="sectlevel2">
<li><a href="#disclaimers">Disclaimers</a></li>
</ul>
</li>
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#authorship">1.1. Authorship</a></li>
<li><a href="#document-conventions">1.2. Document Conventions</a></li>
</ul>
</li>
<li><a href="#entities">2. Entities</a>
<ul class="sectlevel2">
<li><a href="#a18">2.1. The Entity Class</a></li>
<li><a href="#a19">2.2. Persistent Fields and Properties</a>
<ul class="sectlevel3">
<li><a href="#persistent-attribute-type">2.2.1. Persistent Attribute Type</a></li>
<li><a href="#property-access">2.2.2. Property Access</a></li>
</ul>
</li>
<li><a href="#a113">2.3. Access Type</a>
<ul class="sectlevel3">
<li><a href="#default-access-type">2.3.1. Default Access Type</a></li>
<li><a href="#a122">2.3.2. Explicit Access Type</a></li>
<li><a href="#access-type-of-an-embeddable-class">2.3.3. Access Type of an Embeddable Class</a></li>
<li><a href="#defaulted-access-types-of-embeddable-classes-and-mapped-superclasses">2.3.4. Defaulted Access Types of Embeddable Classes and Mapped Superclasses</a></li>
</ul>
</li>
<li><a href="#a132">2.4. Primary Keys and Entity Identity</a>
<ul class="sectlevel3">
<li><a href="#composite-primary-keys">2.4.1. Composite primary keys</a></li>
<li><a href="#a149">2.4.2. Primary Keys Corresponding to Derived Identities</a>
<ul class="sectlevel4">
<li><a href="#a155">2.4.2.1. Specification of Derived Identities</a></li>
<li><a href="#mapping-of-derived-identities">2.4.2.2. Mapping of Derived Identities</a></li>
<li><a href="#examples-of-derived-identities">2.4.2.3. Examples of Derived Identities</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a2060">2.5. Entity Versions</a></li>
<li><a href="#a486">2.6. Basic Types</a></li>
<li><a href="#a487">2.7. Embeddable Classes</a></li>
<li><a href="#a494">2.8. Collections of Embeddable Classes and Basic Types</a></li>
<li><a href="#map-collections">2.9. Map Collections</a>
<ul class="sectlevel3">
<li><a href="#map-keys">2.9.1. Map Keys</a></li>
<li><a href="#map-values">2.9.2. Map Values</a></li>
</ul>
</li>
<li><a href="#a511">2.10. Mapping Defaults for Non-Relationship Fields or Properties</a></li>
<li><a href="#a516">2.11. Entity Relationships</a></li>
<li><a href="#a538">2.12. Relationship Mapping Defaults</a>
<ul class="sectlevel3">
<li><a href="#bidirectional-onetoone-relationships">2.12.1. Bidirectional OneToOne Relationships</a></li>
<li><a href="#bidirectional-manytoone-onetomany-relationships">2.12.2. Bidirectional ManyToOne / OneToMany Relationships</a></li>
<li><a href="#unidirectional-single-valued-relationships">2.12.3. Unidirectional Single-Valued Relationships</a>
<ul class="sectlevel4">
<li><a href="#a640">2.12.3.1. Unidirectional OneToOne Relationships</a></li>
<li><a href="#unidirectional-manytoone-relationships">2.12.3.2. Unidirectional ManyToOne Relationships</a></li>
</ul>
</li>
<li><a href="#a708">2.12.4. Bidirectional ManyToMany Relationships</a></li>
<li><a href="#a758">2.12.5. Unidirectional Multi-Valued Relationships</a>
<ul class="sectlevel4">
<li><a href="#a764">2.12.5.1. Unidirectional OneToMany Relationships</a></li>
<li><a href="#a800">2.12.5.2. Unidirectional ManyToMany Relationships</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a765">2.13. Inheritance</a>
<ul class="sectlevel3">
<li><a href="#abstract-entity-classes">2.13.1. Abstract Entity Classes</a></li>
<li><a href="#mapped-superclasses">2.13.2. Mapped Superclasses</a></li>
<li><a href="#non-entity-classes-in-the-entity-inheritance-hierarchy">2.13.3. Non-Entity Classes in the Entity Inheritance Hierarchy</a></li>
</ul>
</li>
<li><a href="#a966">2.14. Inheritance Mapping Strategies</a>
<ul class="sectlevel3">
<li><a href="#single-table-per-class-hierarchy-strategy">2.14.1. Single Table per Class Hierarchy Strategy</a></li>
<li><a href="#joined-subclass-strategy">2.14.2. Joined Subclass Strategy</a></li>
<li><a href="#table-per-concrete-class-strategy">2.14.3. Table per Concrete Class Strategy</a></li>
</ul>
</li>
<li><a href="#a988">2.15. Naming of Database Objects</a></li>
</ul>
</li>
<li><a href="#a1060">3. Entity Operations</a>
<ul class="sectlevel2">
<li><a href="#overview">3.1. Overview</a></li>
<li><a href="#a1066">3.2. EntityManager Interface</a></li>
<li><a href="#a1929">3.3. Entity Instance&#8217;s Life Cycle</a>
<ul class="sectlevel3">
<li><a href="#entity-instance-creation">3.3.1. Entity Instance Creation</a></li>
<li><a href="#persisting-an-entity-instance">3.3.2. Persisting an Entity Instance</a></li>
<li><a href="#a1946">3.3.3. Removal</a></li>
<li><a href="#a1955">3.3.4. Synchronization to the Database</a></li>
<li><a href="#refreshing-an-entity-instance">3.3.5. Refreshing an Entity Instance</a></li>
<li><a href="#evicting-an-entity-instance-from-the-persistence-context">3.3.6. Evicting an Entity Instance from the Persistence Context</a></li>
<li><a href="#a1982">3.3.7. Detached Entities</a>
<ul class="sectlevel4">
<li><a href="#a1983">3.3.7.1. Merging Detached Entity State</a></li>
<li><a href="#detached-entities-and-lazy-loading">3.3.7.2. Detached Entities and Lazy Loading</a></li>
</ul>
</li>
<li><a href="#managed-instances">3.3.8. Managed Instances</a></li>
<li><a href="#a2019">3.3.9. Load State</a></li>
</ul>
</li>
<li><a href="#a2027">3.4. Persistence Context Lifetime and Synchronization Type</a>
<ul class="sectlevel3">
<li><a href="#synchronization-with-the-current-transaction">3.4.1. Synchronization with the Current Transaction</a></li>
<li><a href="#transaction-commit">3.4.2. Transaction Commit</a></li>
<li><a href="#a2049">3.4.3. Transaction Rollback</a></li>
</ul>
</li>
<li><a href="#a2052">3.5. Locking and Concurrency</a>
<ul class="sectlevel3">
<li><a href="#a2056">3.5.1. Optimistic Locking</a></li>
<li><a href="#a2059">3.5.2. Entity Versions and Optimistic Locking</a></li>
<li><a href="#a2066">3.5.3. Pessimistic Locking</a></li>
<li><a href="#a2084">3.5.4. Lock Modes</a>
<ul class="sectlevel4">
<li><a href="#a2100">3.5.4.1. OPTIMISTIC, OPTIMISTIC_FORCE_INCREMENT</a></li>
<li><a href="#a2113">3.5.4.2. PESSIMISTIC_READ, PESSIMISTIC_WRITE, PESSIMISTIC_FORCE_INCREMENT</a></li>
<li><a href="#a2132">3.5.4.3. Lock Mode Properties and Uses</a></li>
</ul>
</li>
<li><a href="#optimisticlockexception">3.5.5. OptimisticLockException</a></li>
</ul>
</li>
<li><a href="#a2153">3.6. Entity Listeners and Callback Methods</a>
<ul class="sectlevel3">
<li><a href="#entity-listeners">3.6.1. Entity Listeners</a></li>
<li><a href="#lifecycle-callback-methods">3.6.2. Lifecycle Callback Methods</a></li>
<li><a href="#a2202">3.6.3. Semantics of the Life Cycle Callback Methods for Entities</a></li>
<li><a href="#a2251">3.6.4. Multiple Lifecycle Callback Methods for an Entity Lifecycle Event</a></li>
<li><a href="#exceptions">3.6.5. Exceptions</a></li>
<li><a href="#specification-of-callback-listener-classes-and-lifecycle-methods-in-the-xml-descriptor">3.6.6. Specification of Callback Listener Classes and Lifecycle Methods in the XML Descriptor</a>
<ul class="sectlevel4">
<li><a href="#specification-of-callback-listeners">3.6.6.1. Specification of Callback Listeners</a></li>
<li><a href="#specification-of-the-binding-of-entity-listener-classes-to-entities">3.6.6.2. Specification of the Binding of Entity Listener Classes to Entities</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a2366">3.7. Bean Validation</a>
<ul class="sectlevel3">
<li><a href="#automatic-validation-upon-lifecycle-events">3.7.1. Automatic Validation Upon Lifecycle Events</a>
<ul class="sectlevel4">
<li><a href="#a2374">3.7.1.1. Enabling Automatic Validation</a></li>
<li><a href="#a2380">3.7.1.2. Requirements for Automatic Validation upon Lifecycle Events</a></li>
</ul>
</li>
<li><a href="#a2394">3.7.2. Providing the ValidatorFactory</a></li>
</ul>
</li>
<li><a href="#a2397">3.8. Entity Graphs</a>
<ul class="sectlevel3">
<li><a href="#a2814">3.8.1. Use of Entity Graphs in find and query operations</a>
<ul class="sectlevel4">
<li><a href="#fetch-graph-semantics">3.8.1.1. Fetch Graph Semantics</a></li>
<li><a href="#load-graph-semantics">3.8.1.2. Load Graph Semantics</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a2999">3.9. Type Conversion of Basic Attributes</a></li>
<li><a href="#a3061">3.10. Second-Level Cache</a>
<ul class="sectlevel3">
<li><a href="#a3065">3.10.1. The Shared Cache Mode and Cacheable Annotation</a></li>
<li><a href="#cache-modes">3.10.2. Cache Modes</a></li>
<li><a href="#a12124">3.10.3. Cache Interface</a></li>
</ul>
</li>
<li><a href="#a3125">3.11. Query APIs</a>
<ul class="sectlevel3">
<li><a href="#query-execution">3.11.1. Query Execution</a></li>
<li><a href="#a4374">3.11.2. Queries and Flush Mode</a></li>
<li><a href="#a4385">3.11.3. Queries and Lock Mode</a></li>
<li><a href="#a4391">3.11.4. Query Hints</a></li>
<li><a href="#a4397">3.11.5. Parameter Objects</a></li>
<li><a href="#a4401">3.11.6. Named Parameters</a></li>
<li><a href="#a4405">3.11.7. Positional Parameters</a></li>
<li><a href="#arguments-to-query-parameters">3.11.8. Arguments to query parameters</a></li>
<li><a href="#named-queries">3.11.9. Named Queries</a></li>
<li><a href="#polymorphic-queries">3.11.10. Polymorphic Queries</a></li>
<li><a href="#a4427">3.11.11. SQL Queries</a>
<ul class="sectlevel4">
<li><a href="#returning-managed-entities-from-native-queries">3.11.11.1. Returning Managed Entities from Native Queries</a></li>
<li><a href="#returning-unmanaged-instances">3.11.11.2. Returning Unmanaged Instances</a></li>
<li><a href="#combinations-of-result-types">3.11.11.3. Combinations of Result Types</a></li>
<li><a href="#restrictions">3.11.11.4. Restrictions</a></li>
</ul>
</li>
<li><a href="#stored-procedures">3.11.12. Stored Procedures</a>
<ul class="sectlevel4">
<li><a href="#named-stored-procedure-queries">3.11.12.1. Named Stored Procedure Queries</a></li>
<li><a href="#dynamically-specified-stored-procedure-queries">3.11.12.2. Dynamically-specified Stored Procedure Queries</a></li>
<li><a href="#a4625">3.11.12.3. Stored Procedure Query Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a4639">3.12. Summary of Exceptions</a></li>
</ul>
</li>
<li><a href="#a4665">4. Query Language</a>
<ul class="sectlevel2">
<li><a href="#overview-2">4.1. Overview</a></li>
<li><a href="#statement-types">4.2. Statement Types</a>
<ul class="sectlevel3">
<li><a href="#select-statements">4.2.1. Select Statements</a>
<ul class="sectlevel4">
<li><a href="#set-operators-in-select-statements">4.2.1.1. Set Operators in Select Statements</a></li>
</ul>
</li>
<li><a href="#update-and-delete-statements">4.2.2. Update and Delete Statements</a></li>
</ul>
</li>
<li><a href="#abstract-schema-types-and-query-domains">4.3. Abstract Schema Types and Query Domains</a>
<ul class="sectlevel3">
<li><a href="#naming">4.3.1. Naming</a></li>
<li><a href="#a4713">4.3.2. Example</a></li>
</ul>
</li>
<li><a href="#the-from-clause-and-navigational-declarations">4.4. The FROM Clause and Navigational Declarations</a>
<ul class="sectlevel3">
<li><a href="#a4760">4.4.1. Identifiers</a></li>
<li><a href="#a4765">4.4.2. Identification Variables</a></li>
<li><a href="#a4766">4.4.3. Range Variable Declarations</a></li>
<li><a href="#a4792">4.4.4. Path Expressions</a>
<ul class="sectlevel4">
<li><a href="#path-expression-syntax">4.4.4.1. Path Expression Syntax</a></li>
</ul>
</li>
<li><a href="#joins">4.4.5. Joins</a>
<ul class="sectlevel4">
<li><a href="#a4884">4.4.5.1. Inner Joins</a></li>
<li><a href="#a4898">4.4.5.2. Outer Joins</a></li>
<li><a href="#a4931">4.4.5.3. Fetch Joins</a></li>
</ul>
</li>
<li><a href="#collection-member-declarations">4.4.6. Collection Member Declarations</a></li>
<li><a href="#a4957">4.4.7. FROM Clause and SQL</a></li>
<li><a href="#polymorphism">4.4.8. Polymorphism</a></li>
<li><a href="#a4965">4.4.9. Downcasting</a></li>
</ul>
</li>
<li><a href="#a4985">4.5. WHERE Clause</a></li>
<li><a href="#a4994">4.6. Conditional Expressions</a>
<ul class="sectlevel3">
<li><a href="#conditional-expression-composition">4.6.1. Conditional Expression Composition</a></li>
<li><a href="#operators-and-operator-precedence">4.6.2. Operators and Operator Precedence</a></li>
<li><a href="#a5066">4.6.3. Comparison Expressions</a></li>
<li><a href="#between-expressions">4.6.4. Between Expressions</a></li>
<li><a href="#a5107">4.6.5. In Expressions</a></li>
<li><a href="#like-expressions">4.6.6. Like Expressions</a></li>
<li><a href="#null-comparison-expressions">4.6.7. Null Comparison Expressions</a></li>
<li><a href="#a5139">4.6.8. Empty Collection Comparison Expressions</a></li>
<li><a href="#a5150">4.6.9. Collection Member Expressions</a></li>
<li><a href="#exists-expressions">4.6.10. Exists Expressions</a></li>
<li><a href="#all-or-any-expressions">4.6.11. All or Any Expressions</a></li>
<li><a href="#a5196">4.6.12. Subqueries</a></li>
<li><a href="#a5676">4.6.13. Null Values</a></li>
<li><a href="#a5735">4.6.14. Equality and Comparison Semantics</a>
<ul class="sectlevel4">
<li><a href="#queries-using-input-parameters">4.6.14.1. Queries Using Input Parameters</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a5243">4.7. Scalar Expressions</a>
<ul class="sectlevel3">
<li><a href="#literals">4.7.1. Literals</a></li>
<li><a href="#identification-variables">4.7.2. Identification Variables</a></li>
<li><a href="#path-expressions">4.7.3. Path Expressions</a></li>
<li><a href="#a5065">4.7.4. Input Parameters</a>
<ul class="sectlevel4">
<li><a href="#positional-parameters">4.7.4.1. Positional Parameters</a></li>
<li><a href="#named-parameters">4.7.4.2. Named Parameters</a></li>
</ul>
</li>
<li><a href="#arithmetic-expressions">4.7.5. Arithmetic Expressions</a></li>
<li><a href="#string-concatenation-operator">4.7.6. String concatenation operator</a></li>
<li><a href="#built-in-string-arithmetic-and-datetime-functional-expressions">4.7.7. Built-in String, Arithmetic, and Datetime Functional Expressions</a>
<ul class="sectlevel4">
<li><a href="#a5264">4.7.7.1. String Functions</a></li>
<li><a href="#a5284">4.7.7.2. Arithmetic Functions</a></li>
<li><a href="#a5304">4.7.7.3. Datetime Functions</a></li>
</ul>
</li>
<li><a href="#typecasts">4.7.8. Typecasts</a></li>
<li><a href="#a5311">4.7.9. Invocation of Predefined and User-defined Database Functions</a></li>
<li><a href="#case-expressions">4.7.10. Case Expressions</a></li>
<li><a href="#identifier-and-version-functions">4.7.11. Identifier and Version Functions</a></li>
<li><a href="#a5381">4.7.12. Entity Type Expressions and Literal Entity Types</a></li>
<li><a href="#a5574">4.7.13. Numeric Expressions and Type Promotion</a></li>
</ul>
</li>
<li><a href="#a5410">4.8. GROUP BY, HAVING</a></li>
<li><a href="#a5438">4.9. SELECT Clause</a>
<ul class="sectlevel3">
<li><a href="#a5439">4.9.1. Result Type of the SELECT Clause</a></li>
<li><a href="#a5500">4.9.2. Constructor Expressions in the SELECT Clause</a></li>
<li><a href="#null-values-in-the-query-result">4.9.3. Null Values in the Query Result</a></li>
<li><a href="#a5511">4.9.4. Embeddables in the Query Result</a></li>
<li><a href="#a5538">4.9.5. Aggregate Functions in the SELECT Clause</a></li>
</ul>
</li>
<li><a href="#a5587">4.10. ORDER BY Clause</a></li>
<li><a href="#a5636">4.11. Bulk Update and Delete Operations</a></li>
<li><a href="#bnf">4.12. BNF</a></li>
</ul>
</li>
<li><a href="#a6072">5. Metamodel API</a>
<ul class="sectlevel2">
<li><a href="#a6933">5.1. Static Metamodel Classes</a>
<ul class="sectlevel3">
<li><a href="#canonical-metamodel">5.1.1. Canonical Metamodel</a>
<ul class="sectlevel4">
<li><a href="#a6961">5.1.1.1. Example Canonical Metamodel</a></li>
</ul>
</li>
<li><a href="#bootstrapping-the-static-metamodel">5.1.2. Bootstrapping the Static Metamodel</a></li>
</ul>
</li>
<li><a href="#runtime-access-to-metamodel">5.2. Runtime Access to Metamodel</a></li>
</ul>
</li>
<li><a href="#a6925">6. Criteria API</a>
<ul class="sectlevel2">
<li><a href="#overview-3">6.1. Overview</a></li>
<li><a href="#a10608">6.2. Criteria Query API Usage</a></li>
<li><a href="#a10614">6.3. Constructing Criteria Queries</a>
<ul class="sectlevel3">
<li><a href="#a10621">6.3.1. CriteriaQuery Creation</a></li>
<li><a href="#query-roots">6.3.2. Query Roots</a></li>
<li><a href="#a10643">6.3.3. Joins</a></li>
<li><a href="#fetch-joins">6.3.4. Fetch Joins</a></li>
<li><a href="#a16277">6.3.5. Path Navigation</a></li>
<li><a href="#restricting-the-query-result">6.3.6. Restricting the Query Result</a></li>
<li><a href="#downcasting">6.3.7. Downcasting</a></li>
<li><a href="#expressions">6.3.8. Expressions</a>
<ul class="sectlevel4">
<li><a href="#result-types-of-expressions">6.3.8.1. Result Types of Expressions</a></li>
</ul>
</li>
<li><a href="#literals-2">6.3.9. Literals</a></li>
<li><a href="#parameter-expressions">6.3.10. Parameter Expressions</a></li>
<li><a href="#a10945">6.3.11. Specifying the Select List</a>
<ul class="sectlevel4">
<li><a href="#assigning-aliases-to-selection-items">6.3.11.1. Assigning Aliases to Selection Items</a></li>
</ul>
</li>
<li><a href="#subqueries">6.3.12. Subqueries</a></li>
<li><a href="#groupby-and-having">6.3.13. GroupBy and Having</a></li>
<li><a href="#ordering-the-query-results">6.3.14. Ordering the Query Results</a></li>
<li><a href="#a11239">6.3.15. Bulk Update and Delete Operations</a></li>
</ul>
</li>
<li><a href="#a11305">6.4. Constructing Strongly-typed Queries using the jakarta.persistence.metamodel Interfaces</a></li>
<li><a href="#a11349">6.5. Use of the Criteria API with Strings to Reference Attributes</a></li>
<li><a href="#a11413">6.6. Query Modification</a></li>
<li><a href="#a11427">6.7. Query Execution</a></li>
</ul>
</li>
<li><a href="#a11431">7. Entity Managers and Persistence Contexts</a>
<ul class="sectlevel2">
<li><a href="#a11432">7.1. Persistence Contexts</a></li>
<li><a href="#obtaining-an-entitymanager">7.2. Obtaining an EntityManager</a>
<ul class="sectlevel3">
<li><a href="#obtaining-an-entity-manager-in-the-jakarta-ee-environment">7.2.1. Obtaining an Entity Manager in the Jakarta EE Environment</a></li>
<li><a href="#a11465">7.2.2. Obtaining an Application-managed Entity Manager</a></li>
</ul>
</li>
<li><a href="#obtaining-an-entity-manager-factory">7.3. Obtaining an Entity Manager Factory</a>
<ul class="sectlevel3">
<li><a href="#obtaining-an-entity-manager-factory-in-a-jakarta-ee-container">7.3.1. Obtaining an Entity Manager Factory in a Jakarta EE Container</a></li>
<li><a href="#obtaining-an-entity-manager-factory-in-a-java-se-environment">7.3.2. Obtaining an Entity Manager Factory in a Java SE Environment</a></li>
<li><a href="#obtaining-an-entity-manager-factory-for-a-programmatically-defined-persistence-unit">7.3.3. Obtaining an Entity Manager Factory for a programmatically-defined persistence unit</a></li>
</ul>
</li>
<li><a href="#entitymanagerfactory-interface">7.4. EntityManagerFactory Interface</a></li>
<li><a href="#controlling-transactions">7.5. Controlling Transactions</a>
<ul class="sectlevel3">
<li><a href="#jta-entitymanagers">7.5.1. JTA EntityManagers</a></li>
<li><a href="#resource-local-entitymanagers">7.5.2. Resource-local EntityManagers</a></li>
<li><a href="#the-entitytransaction-interface">7.5.3. The EntityTransaction Interface</a></li>
</ul>
</li>
<li><a href="#the-runintransaction-and-callintransaction-methods">7.6. The runInTransaction and callInTransaction methods</a></li>
<li><a href="#a11791">7.7. Container-managed Persistence Contexts</a>
<ul class="sectlevel3">
<li><a href="#a11797">7.7.1. Persistence Context Synchronization Type</a></li>
<li><a href="#a11805">7.7.2. Container-managed Transaction-scoped Persistence Context</a></li>
<li><a href="#a11810">7.7.3. Container-managed Extended Persistence Context</a>
<ul class="sectlevel4">
<li><a href="#inheritance-of-extended-persistence-context">7.7.3.1. Inheritance of Extended Persistence Context</a></li>
</ul>
</li>
<li><a href="#a11816">7.7.4. Persistence Context Propagation</a>
<ul class="sectlevel4">
<li><a href="#a11820">7.7.4.1. Requirements for Persistence Context Propagation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a11894">7.8. Application-managed Persistence Contexts</a></li>
<li><a href="#requirements-on-the-container">7.9. Requirements on the Container</a>
<ul class="sectlevel3">
<li><a href="#application-managed-persistence-contexts">7.9.1. Application-managed Persistence Contexts</a></li>
<li><a href="#container-managed-persistence-contexts">7.9.2. Container Managed Persistence Contexts</a></li>
</ul>
</li>
<li><a href="#a12100">7.10. Runtime Contracts between the Container and Persistence Provider</a>
<ul class="sectlevel3">
<li><a href="#container-responsibilities">7.10.1. Container Responsibilities</a></li>
<li><a href="#provider-responsibilities">7.10.2. Provider Responsibilities</a></li>
</ul>
</li>
<li><a href="#a12177">7.11. PersistenceUnitUtil Interface</a></li>
<li><a href="#a12178">7.12. SchemaManager Interface</a></li>
</ul>
</li>
<li><a href="#a12229">8. Entity Packaging</a>
<ul class="sectlevel2">
<li><a href="#a12235">8.1. Persistence Unit</a></li>
<li><a href="#a12236">8.2. Persistence Unit Packaging</a>
<ul class="sectlevel3">
<li><a href="#a12237">8.2.1. persistence.xml file</a>
<ul class="sectlevel4">
<li><a href="#name">8.2.1.1. name</a></li>
<li><a href="#a12296">8.2.1.2. transaction-type</a></li>
<li><a href="#description">8.2.1.3. description</a></li>
<li><a href="#a12300">8.2.1.4. provider</a></li>
<li><a href="#a12310">8.2.1.5. qualifier</a></li>
<li><a href="#a12311">8.2.1.6. scope</a></li>
<li><a href="#a12302">8.2.1.7. jta-data-source, non-jta-data-source</a></li>
<li><a href="#a12305">8.2.1.8. mapping-file, jar-file, class, exclude-unlisted-classes</a></li>
<li><a href="#a12380">8.2.1.9. shared-cache-mode</a></li>
<li><a href="#a12382">8.2.1.10. validation-mode</a></li>
<li><a href="#a12384">8.2.1.11. properties</a></li>
</ul>
</li>
<li><a href="#a12459">8.2.2. Persistence Unit Scope</a></li>
</ul>
</li>
<li><a href="#persistence-xml-schema">8.3. persistence.xml Schema</a></li>
</ul>
</li>
<li><a href="#container-and-provider-contracts-for-deployment-and-bootstrapping">9. Container and Provider Contracts for Deployment and Bootstrapping</a>
<ul class="sectlevel2">
<li><a href="#a12802">9.1. Jakarta EE Deployment</a></li>
<li><a href="#bootstrapping-in-java-se-environments">9.2. Bootstrapping in Java SE Environments</a>
<ul class="sectlevel3">
<li><a href="#a12803">9.2.1. Schema Generation</a></li>
</ul>
</li>
<li><a href="#a12837">9.3. Determining the Available Persistence Providers</a></li>
<li><a href="#a12917">9.4. Schema Generation</a>
<ul class="sectlevel3">
<li><a href="#data-loading">9.4.1. Data Loading</a></li>
</ul>
</li>
<li><a href="#responsibilities-of-the-persistence-provider">9.5. Responsibilities of the Persistence Provider</a>
<ul class="sectlevel3">
<li><a href="#jakarta-persistence-spi-persistenceprovider">9.5.1. jakarta.persistence.spi.PersistenceProvider</a></li>
<li><a href="#jakarta-persistence-spi-providerutil">9.5.2. jakarta.persistence.spi.ProviderUtil</a></li>
</ul>
</li>
<li><a href="#a13160">9.6. jakarta.persistence.spi.PersistenceUnitInfo Interface</a>
<ul class="sectlevel3">
<li><a href="#jakarta-persistence-spi-classtransformer-interface">9.6.1. jakarta.persistence.spi.ClassTransformer Interface</a></li>
</ul>
</li>
<li><a href="#a13443">9.7. jakarta.persistence.Persistence Class</a></li>
<li><a href="#a13444">9.8. jakarta.persistence.PersistenceConfiguration Class</a></li>
<li><a href="#persistenceutil-interface">9.9. PersistenceUtil Interface</a>
<ul class="sectlevel3">
<li><a href="#a13592">9.9.1. Contracts for Determining the Load State of an Entity or Entity Attribute</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#metadata-annotations">10. Metadata Annotations</a>
<ul class="sectlevel2">
<li><a href="#entity">10.1. Entity</a></li>
<li><a href="#callback-annotations">10.2. Callback Annotations</a></li>
<li><a href="#a13662">10.3. EntityGraph Annotations</a>
<ul class="sectlevel3">
<li><a href="#namedentitygraph-and-namedentitygraphs-annotations">10.3.1. NamedEntityGraph and NamedEntityGraphs Annotations</a></li>
<li><a href="#namedattributenode-annotation">10.3.2. NamedAttributeNode Annotation</a></li>
<li><a href="#namedsubgraph-annotation">10.3.3. NamedSubgraph Annotation</a></li>
</ul>
</li>
<li><a href="#a13710">10.4. Annotations for Queries</a>
<ul class="sectlevel3">
<li><a href="#a13711">10.4.1. NamedQuery Annotation</a></li>
<li><a href="#namednativequery-annotation">10.4.2. NamedNativeQuery Annotation</a></li>
<li><a href="#a13759">10.4.3. NamedStoredProcedureQuery Annotation</a></li>
<li><a href="#a13797">10.4.4. Annotations for SQL Result Set Mappings</a></li>
</ul>
</li>
<li><a href="#references-to-entitymanager-and-entitymanagerfactory">10.5. References to EntityManager and EntityManagerFactory</a>
<ul class="sectlevel3">
<li><a href="#persistencecontext-annotation">10.5.1. PersistenceContext Annotation</a></li>
<li><a href="#a13887">10.5.2. PersistenceUnit Annotation</a></li>
</ul>
</li>
<li><a href="#a13903">10.6. Annotations for Attribute Converter Classes</a></li>
</ul>
</li>
<li><a href="#a13915">11. Metadata for Object/Relational Mapping</a>
<ul class="sectlevel2">
<li><a href="#annotations-for-objectrelational-mapping">11.1. Annotations for Object/Relational Mapping</a>
<ul class="sectlevel3">
<li><a href="#a13941">11.1.1. Access Annotation</a></li>
<li><a href="#a13942">11.1.2. AssociationOverride Annotation</a></li>
<li><a href="#associationoverrides-annotation">11.1.3. AssociationOverrides Annotation</a></li>
<li><a href="#a14084">11.1.4. AttributeOverride Annotation</a></li>
<li><a href="#a14178">11.1.5. AttributeOverrides Annotation</a></li>
<li><a href="#a14205">11.1.6. Basic Annotation</a></li>
<li><a href="#cacheable-annotation">11.1.7. Cacheable Annotation</a></li>
<li><a href="#a14250">11.1.8. CollectionTable Annotation</a></li>
<li><a href="#a14330">11.1.9. Column Annotation</a></li>
<li><a href="#a14398">11.1.10. Convert Annotation</a></li>
<li><a href="#converts-annotation">11.1.11. Converts Annotation</a></li>
<li><a href="#a14530">11.1.12. DiscriminatorColumn Annotation</a></li>
<li><a href="#discriminatorvalue-annotation">11.1.13. DiscriminatorValue Annotation</a></li>
<li><a href="#elementcollection-annotation">11.1.14. ElementCollection Annotation</a></li>
<li><a href="#a14634">11.1.15. Embeddable Annotation</a></li>
<li><a href="#a14672">11.1.16. Embedded Annotation</a></li>
<li><a href="#a14687">11.1.17. EmbeddedId Annotation</a></li>
<li><a href="#a14719">11.1.18. Enumerated Annotation</a></li>
<li><a href="#a14720">11.1.19. EnumeratedValue Annotation</a></li>
<li><a href="#a14754">11.1.20. ForeignKey Annotation</a></li>
<li><a href="#a14790">11.1.21. GeneratedValue Annotation</a></li>
<li><a href="#a14827">11.1.22. Id Annotation</a></li>
<li><a href="#a14836">11.1.23. IdClass Annotation</a></li>
<li><a href="#a14862">11.1.24. Index Annotation</a></li>
<li><a href="#a14891">11.1.25. Inheritance Annotation</a></li>
<li><a href="#a14922">11.1.26. JoinColumn Annotation</a></li>
<li><a href="#joincolumns-annotation">11.1.27. JoinColumns Annotation</a></li>
<li><a href="#a15022">11.1.28. JoinTable Annotation</a></li>
<li><a href="#a15087">11.1.29. Lob Annotation</a></li>
<li><a href="#a15100">11.1.30. ManyToMany Annotation</a></li>
<li><a href="#manytoone-annotation">11.1.31. ManyToOne Annotation</a></li>
<li><a href="#mapkey-annotation">11.1.32. MapKey Annotation</a></li>
<li><a href="#mapkeyclass-annotation">11.1.33. MapKeyClass Annotation</a></li>
<li><a href="#a15367">11.1.34. MapKeyColumn Annotation</a></li>
<li><a href="#a15433">11.1.35. MapKeyEnumerated Annotation</a></li>
<li><a href="#a15450">11.1.36. MapKeyJoinColumn Annotation</a></li>
<li><a href="#mapkeyjoincolumns-annotation">11.1.37. MapKeyJoinColumns Annotation</a></li>
<li><a href="#a15583">11.1.38. MapKeyTemporal Annotation</a></li>
<li><a href="#mappedsuperclass-annotation">11.1.39. MappedSuperclass Annotation</a></li>
<li><a href="#mapsid-annotation">11.1.40. MapsId Annotation</a></li>
<li><a href="#onetomany-annotation">11.1.41. OneToMany Annotation</a></li>
<li><a href="#onetoone-annotation">11.1.42. OneToOne Annotation</a></li>
<li><a href="#orderby-annotation">11.1.43. OrderBy Annotation</a></li>
<li><a href="#a15873">11.1.44. OrderColumn Annotation</a></li>
<li><a href="#a15947">11.1.45. PrimaryKeyJoinColumn Annotation</a></li>
<li><a href="#primarykeyjoincolumns-annotation">11.1.46. PrimaryKeyJoinColumns Annotation</a></li>
<li><a href="#a16062">11.1.47. SecondaryTable Annotation</a></li>
<li><a href="#secondarytables-annotation">11.1.48. SecondaryTables Annotation</a></li>
<li><a href="#a16164">11.1.49. SequenceGenerator Annotation</a></li>
<li><a href="#a16205">11.1.50. SequenceGenerators Annotation</a></li>
<li><a href="#table-annotation">11.1.51. Table Annotation</a></li>
<li><a href="#a16256">11.1.52. TableGenerator Annotation</a></li>
<li><a href="#tablegenerators-annotation">11.1.53. TableGenerators Annotation</a></li>
<li><a href="#a16361">11.1.54. Temporal Annotation</a></li>
<li><a href="#transient-annotation">11.1.55. Transient Annotation</a></li>
<li><a href="#a16403">11.1.56. UniqueConstraint Annotation</a></li>
<li><a href="#a16432">11.1.57. Version Annotation</a></li>
</ul>
</li>
<li><a href="#a16444">11.2. Object/Relational Metadata Used in Schema Generation</a>
<ul class="sectlevel3">
<li><a href="#table-level-elements">11.2.1. Table-level elements</a>
<ul class="sectlevel4">
<li><a href="#table">11.2.1.1. Table</a></li>
<li><a href="#inheritance">11.2.1.2. Inheritance</a></li>
<li><a href="#secondarytable">11.2.1.3. SecondaryTable</a></li>
<li><a href="#collectiontable">11.2.1.4. CollectionTable</a></li>
<li><a href="#jointable">11.2.1.5. JoinTable</a></li>
<li><a href="#tablegenerator">11.2.1.6. TableGenerator</a></li>
</ul>
</li>
<li><a href="#column-level-elements">11.2.2. Column-level elements</a>
<ul class="sectlevel4">
<li><a href="#column">11.2.2.1. Column</a></li>
<li><a href="#mapkeycolumn">11.2.2.2. MapKeyColumn</a></li>
<li><a href="#enumerated-mapkeyenumerated">11.2.2.3. Enumerated, MapKeyEnumerated</a></li>
<li><a href="#temporal-mapkeytemporal">11.2.2.4. Temporal, MapKeyTemporal</a></li>
<li><a href="#lob">11.2.2.5. Lob</a></li>
<li><a href="#ordercolumn">11.2.2.6. OrderColumn</a></li>
<li><a href="#discriminatorcolumn">11.2.2.7. DiscriminatorColumn</a></li>
<li><a href="#version">11.2.2.8. Version</a></li>
</ul>
</li>
<li><a href="#primary-key-mappings">11.2.3. Primary Key mappings</a>
<ul class="sectlevel4">
<li><a href="#id">11.2.3.1. Id</a></li>
<li><a href="#embeddedid">11.2.3.2. EmbeddedId</a></li>
<li><a href="#generatedvalue">11.2.3.3. GeneratedValue</a></li>
</ul>
</li>
<li><a href="#foreign-key-column-mappings">11.2.4. Foreign Key Column Mappings</a>
<ul class="sectlevel4">
<li><a href="#joincolumn">11.2.4.1. JoinColumn</a></li>
<li><a href="#mapkeyjoincolumn">11.2.4.2. MapKeyJoinColumn</a></li>
<li><a href="#a16567">11.2.4.3. PrimaryKeyJoinColumn</a></li>
<li><a href="#foreignkey">11.2.4.4. ForeignKey</a></li>
</ul>
</li>
<li><a href="#other-elements">11.2.5. Other Elements</a>
<ul class="sectlevel4">
<li><a href="#sequencegenerator">11.2.5.1. SequenceGenerator</a></li>
<li><a href="#index">11.2.5.2. Index</a></li>
<li><a href="#uniqueconstraint">11.2.5.3. UniqueConstraint</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#examples-of-the-application-of-annotations-for-objectrelational-mapping">11.3. Examples of the Application of Annotations for Object/Relational Mapping</a></li>
</ul>
</li>
<li><a href="#a16944">12. XML Object/Relational Mapping Descriptor</a>
<ul class="sectlevel2">
<li><a href="#use-of-the-xml-descriptor">12.1. Use of the XML Descriptor</a></li>
<li><a href="#a16953">12.2. XML Overriding Rules</a>
<ul class="sectlevel3">
<li><a href="#persistence-unit-defaults-subelements">12.2.1. persistence-unit-defaults Subelements</a>
<ul class="sectlevel4">
<li><a href="#schema">12.2.1.1. schema</a></li>
<li><a href="#catalog">12.2.1.2. catalog</a></li>
<li><a href="#delimited-identifiers">12.2.1.3. delimited-identifiers</a></li>
<li><a href="#access">12.2.1.4. access</a></li>
<li><a href="#cascade-persist">12.2.1.5. cascade-persist</a></li>
<li><a href="#entity-listeners-2">12.2.1.6. entity-listeners</a></li>
</ul>
</li>
<li><a href="#other-subelements-of-the-entity-mappings-element">12.2.2. Other Subelements of the entity-mappings element</a>
<ul class="sectlevel4">
<li><a href="#package">12.2.2.1. package</a></li>
<li><a href="#schema-2">12.2.2.2. schema</a></li>
<li><a href="#catalog-2">12.2.2.3. catalog</a></li>
<li><a href="#access-2">12.2.2.4. access</a></li>
<li><a href="#sequence-generator">12.2.2.5. sequence-generator</a></li>
<li><a href="#table-generator">12.2.2.6. table-generator</a></li>
<li><a href="#named-query">12.2.2.7. named-query</a></li>
<li><a href="#named-native-query">12.2.2.8. named-native-query</a></li>
<li><a href="#named-stored-procedure-query">12.2.2.9. named-stored-procedure-query</a></li>
<li><a href="#sql-result-set-mapping">12.2.2.10. sql-result-set-mapping</a></li>
<li><a href="#entity-2">12.2.2.11. entity</a></li>
<li><a href="#mapped-superclass">12.2.2.12. mapped-superclass</a></li>
<li><a href="#embeddable">12.2.2.13. embeddable</a></li>
<li><a href="#converter">12.2.2.14. converter</a></li>
</ul>
</li>
<li><a href="#a17017">12.2.3. entity Subelements and Attributes</a>
<ul class="sectlevel4">
<li><a href="#metadata-complete">12.2.3.1. metadata-complete</a></li>
<li><a href="#access-3">12.2.3.2. access</a></li>
<li><a href="#cacheable">12.2.3.3. cacheable</a></li>
<li><a href="#name-2">12.2.3.4. name</a></li>
<li><a href="#table-2">12.2.3.5. table</a></li>
<li><a href="#secondary-table">12.2.3.6. secondary-table</a></li>
<li><a href="#primary-key-join-column">12.2.3.7. primary-key-join-column</a></li>
<li><a href="#id-class">12.2.3.8. id-class</a></li>
<li><a href="#inheritance-2">12.2.3.9. inheritance</a></li>
<li><a href="#discriminator-value">12.2.3.10. discriminator-value</a></li>
<li><a href="#discriminator-column">12.2.3.11. discriminator-column</a></li>
<li><a href="#sequence-generator-2">12.2.3.12. sequence-generator</a></li>
<li><a href="#table-generator-2">12.2.3.13. table-generator</a></li>
<li><a href="#attribute-override">12.2.3.14. attribute-override</a></li>
<li><a href="#association-override">12.2.3.15. association-override</a></li>
<li><a href="#convert">12.2.3.16. convert</a></li>
<li><a href="#named-entity-graph">12.2.3.17. named-entity-graph</a></li>
<li><a href="#named-query-2">12.2.3.18. named-query</a></li>
<li><a href="#named-native-query-2">12.2.3.19. named-native-query</a></li>
<li><a href="#named-stored-procedure-query-2">12.2.3.20. named-stored-procedure-query</a></li>
<li><a href="#sql-result-set-mapping-2">12.2.3.21. sql-result-set-mapping</a></li>
<li><a href="#exclude-default-listeners">12.2.3.22. exclude-default-listeners</a></li>
<li><a href="#exclude-superclass-listeners">12.2.3.23. exclude-superclass-listeners</a></li>
<li><a href="#entity-listeners-3">12.2.3.24. entity-listeners</a></li>
<li><a href="#pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load">12.2.3.25. pre-persist, post-persist, pre-remove, post-remove, pre-update, post-update, post-load</a></li>
<li><a href="#a17082">12.2.3.26. attributes</a></li>
</ul>
</li>
<li><a href="#a17106">12.2.4. mapped-superclass Subelements and Attributes</a>
<ul class="sectlevel4">
<li><a href="#metadata-complete-2">12.2.4.1. metadata-complete</a></li>
<li><a href="#access-4">12.2.4.2. access</a></li>
<li><a href="#id-class-2">12.2.4.3. id-class</a></li>
<li><a href="#exclude-default-listeners-2">12.2.4.4. exclude-default-listeners</a></li>
<li><a href="#exclude-superclass-listeners-2">12.2.4.5. exclude-superclass-listeners</a></li>
<li><a href="#entity-listeners-4">12.2.4.6. entity-listeners</a></li>
<li><a href="#pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load-2">12.2.4.7. pre-persist, post-persist, pre-remove, post-remove, pre-update, post-update, post-load</a></li>
<li><a href="#a17126">12.2.4.8. attributes</a></li>
</ul>
</li>
<li><a href="#a17150">12.2.5. embeddable Subelements and Attributes</a>
<ul class="sectlevel4">
<li><a href="#metadata-complete-3">12.2.5.1. metadata-complete</a></li>
<li><a href="#access-5">12.2.5.2. access</a></li>
<li><a href="#a17157">12.2.5.3. attributes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a17175">12.3. XML Schema</a></li>
</ul>
</li>
<li><a href="#related-documents">Related Documents</a></li>
<li><a href="#revision-history">Appendix A: Revision History</a>
<ul class="sectlevel2">
<li><a href="#jakarta-persistence-3-2">A.1. Jakarta Persistence 3.2</a>
<ul class="sectlevel3">
<li><a href="#deprecations">A.1.1. Deprecations</a></li>
<li><a href="#deprecations-for-removal">A.1.2. Deprecations for removal</a></li>
</ul>
</li>
<li><a href="#jakarta-persistence-3-1">A.2. Jakarta Persistence 3.1</a></li>
<li><a href="#jakarta-persistence-3-0">A.3. Jakarta Persistence 3.0</a></li>
<li><a href="#java-persistence-2-2-maintenance-release-draft">A.4. Java Persistence 2.2 (Maintenance Release Draft)</a></li>
</ul>
</li>
<li><a href="#persistence-api">Appendix B: Persistence API Interfaces</a>
<ul class="sectlevel2">
<li><a href="#_entitymanager_">B.1. <code>EntityManager</code></a></li>
<li><a href="#_entitytransaction_">B.2. <code>EntityTransaction</code></a></li>
<li><a href="#_entitymanagerfactory_">B.3. <code>EntityManagerFactory</code></a></li>
<li><a href="#_lockmodetype_">B.4. <code>LockModeType</code></a></li>
<li><a href="#_cache_">B.5. <code>Cache</code></a></li>
<li><a href="#_query_">B.6. <code>Query</code></a></li>
<li><a href="#typedquery">B.7. <code>TypedQuery</code></a></li>
<li><a href="#storedprocedurequery">B.8. <code>StoredProcedureQuery</code></a></li>
<li><a href="#_tuple_">B.9. <code>Tuple</code></a></li>
<li><a href="#_tupleelement_">B.10. <code>TupleElement</code></a></li>
<li><a href="#parameter">B.11. <code>Parameter</code></a></li>
<li><a href="#graph">B.12. <code>Graph</code></a></li>
<li><a href="#entitygraph">B.13. <code>EntityGraph</code></a></li>
<li><a href="#subgraph">B.14. <code>Subgraph</code></a></li>
<li><a href="#attributenode">B.15. <code>AttributeNode</code></a></li>
<li><a href="#_schemamanager_">B.16. <code>SchemaManager</code></a></li>
<li><a href="#_persistence_">B.17. <code>Persistence</code></a></li>
<li><a href="#_persistenceconfiguration_">B.18. <code>PersistenceConfiguration</code></a></li>
<li><a href="#_persistenceutil_">B.19. <code>PersistenceUtil</code></a></li>
<li><a href="#_persistenceunitutil_">B.20. <code>PersistenceUnitUtil</code></a></li>
</ul>
</li>
<li><a href="#criteria-api">Appendix C: Criteria API Interfaces</a>
<ul class="sectlevel2">
<li><a href="#_criteriabuilder_">C.1. <code>CriteriaBuilder</code></a></li>
<li><a href="#criteriadelete">C.2. <code>CriteriaDelete</code></a></li>
<li><a href="#_criteriaquery_">C.3. <code>CriteriaQuery</code></a></li>
<li><a href="#criteriaselect">C.4. <code>CriteriaSelect</code></a></li>
<li><a href="#criteriaupdate">C.5. <code>CriteriaUpdate</code></a></li>
<li><a href="#abstractquery">C.6. <code>AbstractQuery</code></a></li>
<li><a href="#collectionjoin">C.7. <code>CollectionJoin</code></a></li>
<li><a href="#commonabstractcriteria">C.8. <code>CommonAbstractCriteria</code></a></li>
<li><a href="#compoundselection">C.9. <code>CompoundSelection</code></a></li>
<li><a href="#expression">C.10. <code>Expression</code></a></li>
<li><a href="#fetch">C.11. <code>Fetch</code></a></li>
<li><a href="#fetchparent">C.12. <code>FetchParent</code></a></li>
<li><a href="#abstractquery-2">C.13. <code>AbstractQuery</code></a></li>
<li><a href="#join">C.14. <code>Join</code></a></li>
<li><a href="#jointype">C.15. <code>JoinType</code></a></li>
<li><a href="#listjoin">C.16. <code>ListJoin</code></a></li>
<li><a href="#localdatefield">C.17. <code>LocalDateField</code></a></li>
<li><a href="#localdatetimefield">C.18. <code>LocalDateTimeField</code></a></li>
<li><a href="#localtimefield">C.19. <code>LocalTimeField</code></a></li>
<li><a href="#mapjoin">C.20. <code>MapJoin</code></a></li>
<li><a href="#nulls">C.21. <code>Nulls</code></a></li>
<li><a href="#order">C.22. <code>Order</code></a></li>
<li><a href="#parameterexpression">C.23. <code>ParameterExpression</code></a></li>
<li><a href="#path">C.24. <code>Path</code></a></li>
<li><a href="#pluraljoin">C.25. <code>PluralJoin</code></a></li>
<li><a href="#predicate">C.26. <code>Predicate</code></a></li>
<li><a href="#root">C.27. <code>Root</code></a></li>
<li><a href="#selection">C.28. <code>Selection</code></a></li>
<li><a href="#setjoin">C.29. <code>SetJoin</code></a></li>
<li><a href="#subquery">C.30. <code>Subquery</code></a></li>
<li><a href="#temporalfield">C.31. <code>TemporalField</code></a></li>
</ul>
</li>
<li><a href="#metamodel-api">Appendix D: Metamodel API Interfaces</a>
<ul class="sectlevel2">
<li><a href="#_metamodel_">D.1. <code>Metamodel</code></a></li>
<li><a href="#_staticmetamodel_">D.2. <code>StaticMetamodel</code></a></li>
<li><a href="#attribute">D.3. <code>Attribute</code></a></li>
<li><a href="#basictype">D.4. <code>BasicType</code></a></li>
<li><a href="#bindable">D.5. <code>Bindable</code></a></li>
<li><a href="#collectionattribute">D.6. <code>CollectionAttribute</code></a></li>
<li><a href="#embeddabletype">D.7. <code>EmbeddableType</code></a></li>
<li><a href="#entitytype">D.8. <code>EntityType</code></a></li>
<li><a href="#identifiabletype">D.9. <code>IdentifiableType</code></a></li>
<li><a href="#listattribute">D.10. <code>ListAttribute</code></a></li>
<li><a href="#managedtype">D.11. <code>ManagedType</code></a></li>
<li><a href="#mapattribute">D.12. <code>MapAttribute</code></a></li>
<li><a href="#mappedsuperclasstype">D.13. <code>MappedSuperclassType</code></a></li>
<li><a href="#pluralattribute">D.14. <code>PluralAttribute</code></a></li>
<li><a href="#setattribute">D.15. <code>SetAttribute</code></a></li>
<li><a href="#singularattribute">D.16. <code>SingularAttribute</code></a></li>
<li><a href="#type">D.17. <code>Type</code></a></li>
</ul>
</li>
<li><a href="#persistence-spi">Appendix E: Persistence SPI Interfaces</a>
<ul class="sectlevel2">
<li><a href="#_classtransformer_">E.1. <code>ClassTransformer</code></a></li>
<li><a href="#loadstate">E.2. <code>LoadState</code></a></li>
<li><a href="#_persistenceprovider_">E.3. <code>PersistenceProvider</code></a></li>
<li><a href="#persistenceproviderresolver">E.4. <code>PersistenceProviderResolver</code></a></li>
<li><a href="#persistenceproviderresolverholder">E.5. <code>PersistenceProviderResolverHolder</code></a></li>
<li><a href="#_persistenceunitinfo_">E.6. <code>PersistenceUnitInfo</code></a></li>
<li><a href="#_providerutil_">E.7. <code>ProviderUtil</code></a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre>Specification: Jakarta Persistence

Version: 3.2

Status: Final Release

Release: March 28, 2024</pre>
</div>
</div>
<div class="paragraph">
<p>Copyright (c) 2019, 2024 Eclipse Foundation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="eclipse-foundation-specification-license-v1-1"><a class="anchor" href="#eclipse-foundation-specification-license-v1-1"></a>Eclipse Foundation Specification License - v1.1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By using and/or copying this document, or the Eclipse document from which this statement is linked
or incorporated by reference, you (the licensee) agree that you have read, understood,
and will comply with the following terms and conditions:</p>
</div>
<div class="paragraph">
<p>Permission to copy, and distribute the contents of this document, or
the Eclipse Foundation document from which this statement is linked, in
any medium for any purpose and without fee or royalty is hereby
granted, provided that you include the following on ALL copies of the
document, or portions thereof, that you use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>link or URL to the original Eclipse Foundation document.</p>
</li>
<li>
<p>All existing copyright notices, or if one does not exist, a notice
(hypertext is preferred, but a textual representation is permitted)
of the form: "Copyright (c) [$date-of-document] Eclipse Foundation AISBL <a href="#url to this license">[url to this license]</a> "</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Inclusion of the full text of this NOTICE must be provided. We
request that authorship attribution be provided in any software,
documents, or other items or products that you create pursuant to the
implementation of the contents of this document, or any portion
thereof.</p>
</div>
<div class="paragraph">
<p>No right to create modifications or derivatives of Eclipse Foundation
documents is granted pursuant to this license, except anyone may
prepare and distribute derivative works and portions of this document
in software that implements the specification, in supporting materials
accompanying such software, and in documentation of such software,
PROVIDED that all such works include the notice below. HOWEVER, the
publication of derivative works of this document for use as a technical
specification is expressly prohibited.</p>
</div>
<div class="paragraph">
<p>The notice is:</p>
</div>
<div class="paragraph">
<p>"Copyright (c) [$date-of-document] Eclipse Foundation AISBL. This software or document
includes material copied from or derived from [title and URI of the Eclipse Foundation specification document]."</p>
</div>
<div class="sect2">
<h3 id="disclaimers"><a class="anchor" href="#disclaimers"></a>Disclaimers</h3>
<div class="paragraph">
<p>THIS DOCUMENT IS PROVIDED "AS IS," AND TO THE EXTENT PERMITTED BY APPLICABLE LAW THE COPYRIGHT
HOLDERS AND THE ECLIPSE FOUNDATION AISBL MAKE NO REPRESENTATIONS OR
WARRANTIES, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
NON-INFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THE DOCUMENT ARE
SUITABLE FOR ANY PURPOSE; NOR THAT THE IMPLEMENTATION OF SUCH CONTENTS
WILL NOT INFRINGE ANY THIRD PARTY PATENTS, COPYRIGHTS, TRADEMARKS OR
OTHER RIGHTS.</p>
</div>
<div class="paragraph">
<p>TO THE EXTENT PERMITTED BY APPLICABLE LAW THE COPYRIGHT HOLDERS AND THE ECLIPSE FOUNDATION AISBL WILL NOT BE LIABLE
FOR ANY DIRECT, INDIRECT, SPECIAL OR CONSEQUENTIAL DAMAGES ARISING OUT
OF ANY USE OF THE DOCUMENT OR THE PERFORMANCE OR IMPLEMENTATION OF THE
CONTENTS THEREOF.</p>
</div>
<div class="paragraph">
<p>The name and trademarks of the copyright holders or the Eclipse Foundation AISBL
may NOT be used in advertising or publicity pertaining to
this document or its contents without specific, written prior
permission. Title to copyright in this document will at all times
remain with copyright holders.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document is the specification of the Jakarta API for the management
of persistence and object/relational mapping in the Jakarta EE and Java SE
platforms. The technical objective of this work is to provide a standard
object/relational mapping facility for the Java application developer using
a Java domain model to manage data held in a relational database.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Jakarta Persistence 3.1 specification is the first release with new
features and enhancements after the specification was moved to the Eclipse
Foundation.</p>
</li>
<li>
<p>The Jakarta Persistence 3.0 specification was the first release after moving
the project to Eclipse Foundation. All APIs were moved from the package
<code>javax.*</code> to the package <code>jakarta.*</code>. Every property name
containing <code>javax</code> was renamed so that <code>javax</code> is replaced with <code>jakarta</code>.</p>
</li>
<li>
<p>The Java Persistence 2.2 specification enhanced the API with support for
repeating annotations; injection into attribute converters; support for
mapping the <code>LocalDate</code>, <code>LocalTime</code>, <code>LocalDateTime</code>, <code>OffsetTime</code>, and
<code>OffsetDateTime</code> types from <code>java.time</code>; and methods to retrieve the results
of <code>Query</code> and <code>TypedQuery</code> as streams.</p>
</li>
<li>
<p>The Java Persistence 2.1 specification added support for schema generation,
type conversion methods, use of entity graphs in queries and find operations,
unsynchronized persistence contexts, stored procedure invocation, and injection
into entity listener classes. It also included enhancements to the query language,
the Criteria API, and to the mapping of native queries.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="authorship"><a class="anchor" href="#authorship"></a>1.1. Authorship</h3>
<div class="paragraph">
<p>The Jakarta Persistence Specification incorporates work done over two decades
by the EJB 3.0 expert group, the Java Persistence 2.0, 2.1, and 2.2 expert
groups, under the aegis of the Java Community Process, and by the Jakarta
Persistence project at the Eclipse Foundation.</p>
</div>
</div>
<div class="sect2">
<h3 id="document-conventions"><a class="anchor" href="#document-conventions"></a>1.2. Document Conventions</h3>
<div class="paragraph">
<p>Regular serif font is used for information that is prescriptive under this
specification.</p>
</div>
<div class="paragraph">
<p><em>Italic serif font</em> is used for paragraphs that contain descriptive information,
such as notes describing typical use, or notes clarifying the text with
prescriptive specification.</p>
</div>
<div class="paragraph">
<p><code>Monospaced font</code> is used for code examples and to specify the BNF of the
Jakarta Persistence query language.</p>
</div>
<div class="paragraph">
<p>This document defines the semantics of a set of Java language annotations.
An XML descriptor (as specified in <a href="#a16944">Chapter 12</a>) may be used as an alternative
to annotations or to augment or override annotations. The elements of this
descriptor mirror the annotations and have identical semantics to the
corresponding annotations. When semantic requirements are written in terms
of annotations, it should be understood that the same semantics apply to the
corresponding elements of the XML descriptor.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entities"><a class="anchor" href="#entities"></a>2. Entities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An entity is a lightweight persistent domain object.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> Entities support
inheritance, polymorphic associations, and polymorphic queries.</p>
</div>
<div class="paragraph">
<p>The primary programming artifact is the <em>entity class</em>. An entity class
may make use of auxiliary classes that serve as helper classes or that
are used to represent the state of the entity.</p>
</div>
<div class="paragraph">
<p>This chapter describes requirements on entity classes and instances.</p>
</div>
<div class="sect2">
<h3 id="a18"><a class="anchor" href="#a18"></a>2.1. The Entity Class</h3>
<div class="paragraph">
<p>The entity class must be annotated with the <code>Entity</code> annotation or
declared as an entity in the XML descriptor.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The entity class must be a top-level class or a static inner class.
An enum, record, or interface may not be designated as an entity.</p>
</li>
<li>
<p>The entity class must have a public or protected constructor with no
parameters, which is called by the persistence provider runtime to
instantiate the entity.<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> The entity class may have additional constructors for use by
the application.</p>
</li>
<li>
<p>The entity class must be non-final. Every method and persistent
instance variable of the entity class must be non-final.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An entity might be an abstract class, or it might be a concrete class.
An entity may extend a non-entity class, or it may extend another entity
class. A non-entity class may extend an entity class.</p>
</div>
<div class="paragraph">
<p>The persistent state of an entity is represented by instance variables,
which may correspond to JavaBeans properties. An instance variable may
be directly accessed only within the methods of the entity, by the
entity instance itself. An instance variable of an entity must <em>not</em> be
directly accessed by a client of the entity. The state of the entity is
available to clients only through the methods of the entitythat is,
via accessor (getter/setter) methods, or via other business methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="a19"><a class="anchor" href="#a19"></a>2.2. Persistent Fields and Properties</h3>
<div class="paragraph">
<p>The persistent state of an entity is accessed by the persistence provider
runtime via either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>property access</em> using JavaBeans-style property accessors, or</p>
</li>
<li>
<p><em>field access</em>, that is, direct access to instance variables.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The instance variables of a class must have private, protected, or package
visibility, independent of whether field access or property access is used.
When property access is used, the property accessor methods must be public
or protected.</p>
</div>
<div class="paragraph">
<p>The type of a persistent field or property of an entity class may be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any basic type listed below in <a href="#a486">Section 2.6</a>, including any Java <code>enum</code> type,</p>
</li>
<li>
<p>an entity type or a collection of some entity type, as specified in <a href="#a516">Section 2.11</a>,</p>
</li>
<li>
<p>an embeddable class, as defined in <a href="#a487">Section 2.7</a>, or</p>
</li>
<li>
<p>a collection of a basic type or embeddable type, as specified in <a href="#a494">Section 2.8</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Object/relational mapping metadata may be specified to customize the
object/relational mapping and the loading and storing of the entity state
and relationships, as specified in <a href="#a13915">Chapter 11</a>.</p>
</div>
<div class="paragraph">
<p>The placement of object/relational mapping annotations depends on whether
property access or field access is used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When field access is used, mapping annotations must be placed on instance
variables, and the persistence provider runtime accesses instance variables
directly. Every non-<code>transient</code> instance variable not annotated with the
<code>Transient</code> annotation is persistent.</p>
</li>
<li>
<p>When property-based access is used, mapping annotations must be placed on
getter methods<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup>, and the persistence provider runtime accesses persistent state
via the property accessor methods. Every property not annotated with the
<code>Transient</code> annotation is persistent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Mapping annotations must not be applied to fields or properties marked
<code>transient</code> or <code>Transient</code>, since those fields and properties are not
persistent.</p>
</div>
<div class="paragraph">
<p>Whether property access, field access, or a mix of the two options is used
by the provider to access the state of a given entity class or entity hierarchy
is determined by the rules defined in <a href="#a113">Section 2.3</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Terminology Note: The persistent fields and properties of an entity class
are generically referred to in this document as attributes of the class.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Collection-valued persistent fields and properties must be defined in
terms of one of the following collection-valued interfaces, regardless
of whether the entity class otherwise adheres to the JavaBeans method
conventions noted below, and of whether field or property access is used:
<code>java.util.Collection</code>, <code>java.util.Set</code>, <code>java.util.List</code> <sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup>,
<code>java.util.Map</code>.</p>
</div>
<div class="paragraph">
<p>Use of the generic variants of these collection types is strongly encouraged,
for example, <code>Set&lt;Order&gt;</code> is preferred to the raw type <code>Set</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Terminology Note: The terms collection and collection-valued are used
in this specification to denote any of the above types, unless further
qualified. In cases where a <code>java.util.Collection</code> type (or one of its
subtypes) is to be distinguished, the type is identified as such. The
terms map and map collection are used to denote to a collection of
type <code>java.util.Map</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A collection implementation type such as <code>HashSet</code> or <code>ArrayList</code> may be
used by the application to initialize a collection-valued field or property
before the entity is made persistent. Once the entity becomes managed
(or detached), subsequent access to the collection must be through the
interface type.</p>
</div>
<div class="sect3">
<h4 id="persistent-attribute-type"><a class="anchor" href="#persistent-attribute-type"></a>2.2.1. Persistent Attribute Type</h4>
<div class="paragraph">
<p>The enumeration <code>jakarta.persistence.metamodel.Attribute.PersistentAttributeType</code>
defines a classification of persistent entity attributes: <code>BASIC</code> for
basic attributes, <code>EMBEDDED</code> for embedded attributes, <code>ELEMENT_COLLECTION</code>
for element collections, and <code>MANY_TO_ONE</code>, <code>ONE_TO_ONE</code>, <code>ONE_TO_MANY</code>,
and <code>MANY_TO_MANY</code> for associations of the indicated multiplicity.
Each persistent attribute of an entity belongs to exactly one of the
listed types.</p>
</div>
<div class="paragraph">
<p>It is an error for an attribute of an entity to be annotated with
mapping annotations indicating conflicting persistent attribute types.
For example, an field may not be annotated <code>@Basic @Embedded</code>,
<code>@ManyToOne @ElementCollection</code>, or <code>@OneToOne @ManyToMany</code>. The
persistence provider must detect such contradictory combinations of
mapping annotations and report the error.<sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup></p>
</div>
</div>
<div class="sect3">
<h4 id="property-access"><a class="anchor" href="#property-access"></a>2.2.2. Property Access</h4>
<div class="paragraph">
<p>When property access is used, persistent properties of the entity class
must follow the method signature conventions for JavaBeans read/write
properties, as defined by the JavaBeans <code>Introspector</code> class. For every
persistent property <code>property</code> of type <code>T</code> of the entity, there must be
a getter method, <code>getProperty</code>, and setter method <code>setProperty</code>. For
boolean properties, <code>isProperty</code> may be used as an alternative name for
the getter method.<sup class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup></p>
</div>
<div class="paragraph">
<p>For single-valued persistent properties, these method signatures are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">T getProperty()

<span class="type">void</span> setProperty(T t)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For collection-valued persistent properties, the type <code>T</code> in the method
signatures above must be one of the collection interface types listed
above in <a href="#a19">Section 2.2</a>.</p>
</div>
<div class="paragraph">
<p>In addition to returning and setting the persistent state of the entity
instance, a property accessor method may contain additional logic, for
example, logic to perform validation. The persistence provider runtime
triggers execution of this logic when property-based access is used.</p>
</div>
<div class="paragraph">
<p>Therefore, caution should be exercised in adding business logic to
accessor methods when property access is used. The order in which the
persistence provider runtime calls these methods when loading or storing
persistent state is not defined. Logic contained in such methods should
therefore not rely on any specific invocation order.</p>
</div>
<div class="paragraph">
<p>If property access is used and lazy fetching is specified, portable
applications should not directly access the entity state underlying the
property methods of managed instances until after it has been fetched by
the persistence provider.<sup class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup></p>
</div>
<div class="paragraph">
<p>If a persistence context is joined to a transaction, runtime exceptions
thrown by property accessor methods cause the current transaction to be
marked for rollback; any exception thrown by such methods when called by
the persistence runtime to load or store persistent state causes the
persistence runtime to mark the current transaction for rollback and to
throw a <code>PersistenceException</code> wrapping the application exception.</p>
</div>
<div class="paragraph">
<p>An entity subclass may override a property accessor method inherited
from a superclass. However, portable applications must not override
the object/relational mapping metadata applied to the persistent fields
and properties of entity superclasses.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="directive">private</span> Address address;
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Order&gt; orders = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();
    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;PhoneNumber&gt; phones = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="comment">// No-arg constructor</span>
    <span class="directive">public</span> Customer() {}

    <span class="annotation">@Id</span> <span class="comment">// property access is used</span>
    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> Address getAddress() {
        <span class="keyword">return</span> address;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) {
        <span class="local-variable">this</span>.address = address;
    }

    <span class="annotation">@OneToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Order&gt; getOrders() {
        <span class="keyword">return</span> orders;
    }

    <span class="directive">public</span> <span class="type">void</span> setOrders(<span class="predefined-type">Collection</span>&lt;Order&gt; orders) {
        <span class="local-variable">this</span>.orders = orders;
    }

    <span class="annotation">@ManyToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;PhoneNumber&gt; getPhones() {
        <span class="keyword">return</span> phones;
    }

    <span class="directive">public</span> <span class="type">void</span> setPhones(<span class="predefined-type">Set</span>&lt;PhoneNumber&gt; phones) {
        <span class="local-variable">this</span>.phones = phones;
    }

    <span class="comment">// Business method to add a phone number to the customer</span>
    <span class="directive">public</span> <span class="type">void</span> addPhone(PhoneNumber phone) {
        <span class="local-variable">this</span>.getPhones().add(phone);

        <span class="comment">// Update the phone entity instance to refer to this customer</span>
        phone.addCustomer(<span class="local-variable">this</span>);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a113"><a class="anchor" href="#a113"></a>2.3. Access Type</h3>
<div class="paragraph">
<p>An <em>access type</em> determines how the persistence provider runtime reads
and writes the persistent state of an entity from and to an instance of
the entity class, as specified above in <a href="#a19">Section 2.2</a>.
<code>AccessType</code> enumerates the two possibilities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> AccessType {
    FIELD,
    PROPERTY
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The access type for a persistent attribute depends on the placement of
object/relational mapping annotations in the entity class, and may be
explicitly overridden via use of the <code>Access</code> annotation defined in
<a href="#a13941">Section 11.1.1</a>.</p>
</div>
<div class="sect3">
<h4 id="default-access-type"><a class="anchor" href="#default-access-type"></a>2.3.1. Default Access Type</h4>
<div class="paragraph">
<p>By default, a single access type (<code>FIELD</code> or <code>PROPERTY</code>) is inferred for
an entity hierarchy. The <em>default access type</em> of an entity hierarchy is
determined by the placement of mapping annotations on the attributes of
the entity classes and mapped superclasses of the entity hierarchy which
do not explicitly specify an access type.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If mapping annotations are placed on instance variables, <code>FIELD</code> access
is inferred.</p>
</li>
<li>
<p>If mapping annotations are placed on getter methods, <code>PROPERTY</code> access
is inferred.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An access type may be explicitly specified by means of the <code>Access</code>
annotation<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnotedef_8" title="View footnote.">8</a>]</sup>, as described
below in <a href="#a122">Section 2.3.2</a>.</p>
</div>
<div class="paragraph">
<p>Every class in an entity hierarchy whose access type is defaulted in this
way must be consistent in its placement of mapping annotations on either
fields or properties, such that a single, consistent default access type
applies within the hierarchy. Any embeddable class used by an entity within
the hierarchy has the same access type as the default access type of the
hierarchy unless the <code>Access</code> annotation is specified, as defined below.</p>
</div>
<div class="paragraph">
<p>It is an error if a default access type cannot be determined and an access
type is not explicitly specified by a class-level <code>Access</code> annotation or
the XML descriptor. The behavior of applications which mix the placement
of mapping annotations on fields and properties within an entity hierarchy
without explicitly specifying the class-level <code>Access</code> annotation is
undefined.<sup class="footnote">[<a id="_footnoteref_9" class="footnote" href="#_footnotedef_9" title="View footnote.">9</a>]</sup></p>
</div>
</div>
<div class="sect3">
<h4 id="a122"><a class="anchor" href="#a122"></a>2.3.2. Explicit Access Type</h4>
<div class="paragraph">
<p>The access type of an individual entity class, mapped superclass, or
embeddable class may be specified for that class, independent of the
default for the entity hierarchy to which it belongs, by annotating the
class with the <code>Access</code> annotation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When <code>Access(FIELD)</code> is applied to an entity class, mapped superclass,
or embeddable class, mapping annotations may be placed on the instance
variables of that class, and the persistence provider runtime accesses
persistent state via direct access to the instance variables declared
by the class. Every non-<code>transient</code> instance variable not annotated
with the <code>Transient</code> annotation is persistent.</p>
</li>
<li>
<p>When <code>Access(PROPERTY)</code> is applied to an entity class, mapped superclass,
or embeddable class, mapping annotations may be placed on the properties
of that class, and the persistence provider runtime accesses persistent
state via the properties declared by that class. Every property not
annotated with the <code>Transient</code> annotation is persistent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The explicit access type may be overridden at the attribute level. That
is, a class which explicitly specifies an access type using the <code>Access</code>
annotation may also have fields or properties annotated <code>Access</code>, and so
the class may have a mix of access types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When <code>Access(FIELD)</code> is specified at the class level, an individual
attribute within the class may be selectively designated for property
access by annotating a property getter <code>Access(PROPERTY)</code>. Mapping
annotations for this attribute must be placed on the getter. If a
mapping annotation is placed on a property getter which is not
annotated <code>Access(PROPERTY)</code>, the behavior is undefined.</p>
</li>
<li>
<p>When <code>Access(PROPERTY)</code> is specified at the class level, an individual
attribute within the class may be selectively designated for field
access by annotating an instance variable <code>Access(FIELD)</code>. Mapping
annotations for this attribute must be placed on the field. If a mapping
annotation is placed on a field which is not annotated <code>Access(FIELD)</code>,
the behavior is undefined.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is permitted (but redundant) to place <code>Access(FIELD)</code> on a field whose
class has field access or <code>Access(PROPERTY)</code> on a property whose class has
property access. On the other hand, the behavior is undefined if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Access(PROPERTY)</code> annotates a field,</p>
</li>
<li>
<p><code>Access(FIELD)</code> annotates a property getter, or</p>
</li>
<li>
<p>the <code>Access</code> annotation occurs on a property setter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Portable application should avoid such misplaced <code>@Access</code> annotations.</p>
</div>
<div class="paragraph">
<p>When access types are combined within a class, the <code>Transient</code> annotation
should be used to avoid duplicate persistent mappings. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span> <span class="annotation">@Access</span>(PROPERTY)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;

    <span class="annotation">@Access</span>(FIELD) <span class="comment">// use field access for name</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Transient</span> <span class="comment">// suppress duplicated name attribute</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Access</code> annotation does not affect the access type of other entity
classes or mapped superclasses in the entity hierarchy. In particular,
persistent state inherited from a superclass is always accessed according
to the access type of that superclass.</p>
</div>
</div>
<div class="sect3">
<h4 id="access-type-of-an-embeddable-class"><a class="anchor" href="#access-type-of-an-embeddable-class"></a>2.3.3. Access Type of an Embeddable Class</h4>
<div class="paragraph">
<p>The access type of an embeddable class is determined by the access type of
the entity class, mapped superclass, or embeddable class in which it is
embedded (including as a member of an element collection) independent of
whether the access type of the containing class is explicitly specified or
defaulted. A different access type for an embeddable class can be specified
for that embeddable class by means of the <code>Access</code> annotation as described
above in <a href="#a122">Section 2.3.2</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="defaulted-access-types-of-embeddable-classes-and-mapped-superclasses"><a class="anchor" href="#defaulted-access-types-of-embeddable-classes-and-mapped-superclasses"></a>2.3.4. Defaulted Access Types of Embeddable Classes and Mapped Superclasses</h4>
<div class="paragraph">
<p>Care must be taken when implementing an embeddable class or mapped superclass
which is used both in a context of field access and in a context of property
access, and whose access type is not explicitly specified by means of the
<code>Access</code> annotation or XML mapping file.</p>
</div>
<div class="paragraph">
<p>Such a class should be implemented so that the number, names, and types of
its persistent attributes are independent of the access type in use. The
behavior of an embeddable class or mapped superclass whose attributes are
<em>not</em> independent of access type is undefined with regard to use with the
metamodel API if the class occurs in contexts of differing access types
within the same persistence unit.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a132"><a class="anchor" href="#a132"></a>2.4. Primary Keys and Entity Identity</h3>
<div class="paragraph">
<p>Every entity must have a primary key. The value of its primary key uniquely
identifies an entity instance within a persistence context and to operations
of the <code>EntityManager</code>, as described in <a href="#a1060">Chapter 3</a>.</p>
</div>
<div class="paragraph">
<p>The primary key must be declared by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the entity class that is the root of the entity hierarchy, or</p>
</li>
<li>
<p>a mapped superclass that is a (direct or indirect) superclass of all
entity classes in the entity hierarchy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A primary key must be defined exactly once in each entity hierarchy.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A primary key comprises one or more fields or properties (attributes)
of the entity class.</p>
</li>
<li>
<p>A <em>simple primary key</em> is a single persistent field or property of the
entity class whose type is one of the legal simple primary key types
listed below. The <code>Id</code> annotation defined in <a href="#a14827">Section 11.1.22</a> or <code>id</code> XML
element must be used to identify the simple primary key.</p>
</li>
<li>
<p>A <em>composite primary key</em> must correspond to either a single persistent
field or property, or to a set of fields or properties, as described
below.<sup class="footnote">[<a id="_footnoteref_10" class="footnote" href="#_footnotedef_10" title="View footnote.">10</a>]</sup> A <em>primary key
class</em> must be defined to represent the composite primary key.</p>
<div class="ulist">
<ul>
<li>
<p>If the composite primary key corresponds to a single field or property
of the entity, the <code>EmbeddedId</code> annotation defined by <a href="#a14687">Section 11.1.17</a>
identifies the primary key, and the type of the annotated field or
property is the primary key class.</p>
</li>
<li>
<p>Otherwise, when the composite primary key corresponds to multiple
fields or properties, the <code>Id</code> annotation defined by <a href="#a14827">Section 11.1.22</a>
identifies the fields and properties which comprise the composite key,
and the <code>IdClass</code> annotation defined by <a href="#a14836">Section 11.1.23</a> must specify the
primary key class.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>A simple primary key or field or property belonging to a composite primary
key should have one of the following basic types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any Java primitive type, or <code>java.lang</code> wrapper for a primitive type,
<sup class="footnote">[<a id="_footnoteref_11" class="footnote" href="#_footnotedef_11" title="View footnote.">11</a>]</sup></p>
</li>
<li>
<p><code>java.lang.String</code>,</p>
</li>
<li>
<p><code>java.util.UUID</code>,</p>
</li>
<li>
<p><code>java.time.LocalDate</code>, <code>java.util.Date</code>, or <code>java.sql.Date</code>,</p>
</li>
<li>
<p><code>BigDecimal</code> or <code>BigInteger</code> from <code>java.math</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a primary key field or property has type <code>java.util.Date</code>, the temporal
type must be explicitly specified as <code>DATE</code> using the <code>Temporal</code> annotation
defined by <a href="#a16361">Section 11.1.54</a>, or by equivalent XML.</p>
</div>
<div class="paragraph">
<p>If the primary key is a composite primary key derived from the primary
key of another entity, the primary key may contain an attribute whose
type is that of the primary key of the referenced entity, as specified
below in <a href="#a149">Section 2.4.2</a>.</p>
</div>
<div class="paragraph">
<p>An entity with a primary key involving any type other than the types
listed above is not portable. If the primary key is generated by the
persistence provider, as defined by <a href="#a14790">Section 11.1.21</a>, and its type is not
<code>long</code>, <code>int</code>, <code>java.util.UUID</code>, <code>java.lang.String</code>, <code>java.lang.Long</code>,
or <code>java.lang.Integer</code>, the entity is not portable.</p>
</div>
<div class="paragraph">
<p>The application must not change the value of the primary key of an entity
instance after the instance is made persistent<sup class="footnote">[<a id="_footnoteref_12" class="footnote" href="#_footnotedef_12" title="View footnote.">12</a>]</sup>. If the application does change the value of a
primary key of an entity instance after the entity instance is made
persistent, the behavior is undefined.<sup class="footnote">[<a id="_footnoteref_13" class="footnote" href="#_footnotedef_13" title="View footnote.">13</a>]</sup></p>
</div>
<div class="sect3">
<h4 id="composite-primary-keys"><a class="anchor" href="#composite-primary-keys"></a>2.4.1. Composite primary keys</h4>
<div class="paragraph">
<p>The following rules apply to composite primary keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The primary key class may be a non-abstract regular Java class with a
public or protected constructor with no parameters. Alternatively, the
primary key class may be any Java record type, in which case it need not
have a constructor with no parameters.</p>
</li>
<li>
<p>The access type (<code>FIELD</code> or <code>PROPERTY</code>) of a primary key class is
determined by the access type of the entity for which it is the primary
key, unless the primary key is an embedded id and an explicit access type
is specified using the <code>Access</code> annotation, as defined in <a href="#a122">Section 2.3.2</a>.</p>
</li>
<li>
<p>If property-based access is used, the properties of the primary key class
must be public or protected.</p>
</li>
<li>
<p>The primary key class must define <code>equals</code> and <code>hashCode</code> methods. The
semantics of value equality for these methods must be consistent with the
database equality for the database types to which the key is mapped.</p>
</li>
<li>
<p>A composite primary key must either be represented and mapped as an
embeddable class (see <a href="#a14687">Section 11.1.17</a>) or it must be represented as an id
class and mapped to multiple fields or properties of the entity class
(see <a href="#a14836">Section 11.1.23</a>).</p>
</li>
<li>
<p>If the composite primary key class is represented as an id class, the
names of primary key fields or properties of the primary key class and
those of the entity class to which the id class is mapped must correspond
and their types must be the same.</p>
</li>
<li>
<p>A primary key which corresponds to a derived identity must conform to the
rules specified below in <a href="#a149">Section 2.4.2</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a149"><a class="anchor" href="#a149"></a>2.4.2. Primary Keys Corresponding to Derived Identities</h4>
<div class="paragraph">
<p>The identity of an entity is said to be partially <em>derived</em> from the
identity of a second entity when the <em>child</em> or <em>dependent</em> first entity
is the owner of a many-to-one or one-to-one relationship which targets
the <em>parent</em> second entity and the foreign key referencing the parent
entity forms part of the primary key of the dependent entity.</p>
</div>
<div class="paragraph">
<p>A derived identity might be represented as a simple primary key or as a
composite primary key, as described in <a href="#a155">Section 2.4.2.1</a> below. The dependent
entity class has a composite primary key if</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it declares one or more primary key attributes in addition to those
corresponding to the primary key of the parent, or</p>
</li>
<li>
<p>the parent itself has a composite primary key</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and then an embedded id or id class must be used to represent the primary
key of the dependent entity. In the case that the parent has a composite
key, it is <em>not</em> required that parent entity and dependent entity both use
embedded ids, nor that both use id classes.</p>
</div>
<div class="paragraph">
<p>A <code>ManyToOne</code> or <code>OneToOne</code> relationship which maps a primary key column
or columns may be declared using either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>Id</code> annotation, when no other <code>Id</code> or <code>EmbeddedId</code> attribute maps
the same primary key column or columns, or</p>
</li>
<li>
<p>the <code>MapsId</code> annotation, if some other attribute or attributes annotated
<code>Id</code> or <code>EmbeddedId</code> also map the primary key column or columns.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a <code>ManyToOne</code> or <code>OneToOne</code> relationship declared by a dependent
entity is annotated <code>Id</code> or <code>MapsId</code>, an instance of the entity cannot be
made persistent until the relationship has been assigned a reference to an
instance of the parent entity, since the identity of the dependent entity
declaring the relationship is derived from the referenced parent entity.
<sup class="footnote">[<a id="_footnoteref_14" class="footnote" href="#_footnotedef_14" title="View footnote.">14</a>]</sup></p>
</div>
<div class="paragraph">
<p>A dependent entity may have more than one parent entity.</p>
</div>
<div class="sect4">
<h5 id="a155"><a class="anchor" href="#a155"></a>2.4.2.1. Specification of Derived Identities</h5>
<div class="paragraph">
<p>If a dependent entity uses an id class to represent its primary key,
one of the two following rules must be observed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The names and types of the attributes of the id class and the <code>Id</code>
attributes of the dependent entity class must correspond as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>Id</code> attribute of the dependent entity class and the corresponding
attribute in the id class must have the same name.</p>
</li>
<li>
<p>If an <code>Id</code> attribute of the dependent entity class is of basic type,
the corresponding attribute in the id class must have the same type.</p>
</li>
<li>
<p>If an <code>Id</code> attribute of the entity is a <code>ManyToOne</code> or <code>OneToOne</code>
relationship to the parent entity, the corresponding attribute in the
id class must be of the same Java type as the id class or embedded id
of the parent entity (if the parent entity has a composite primary key)
or the type of the <code>Id</code> attribute of the parent entity (if the parent
entity has a simple primary key).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Alternatively, if the dependent entity declares a single primary key
attribute, that is, a <code>OneToOne</code> relationship attribute annotated <code>Id</code>,
then the id class specified by the dependent entity must be the same as
the primary key class of the parent entity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a dependent entity uses an embedded id to represent its primary key,
the relationship attribute which targets the parent entity must be annotated
<code>MapsId</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the embedded id of the dependent entity is of the same Java type as
the primary key of the parent entity, then the relationship attribute maps
both the relationship to the parent and the primary key of the dependent
entity, the relationship attribute must be a <code>OneToOne</code> association, and
the <code>MapsId</code> annotation must leave the <code>value</code> element unspecified.
<sup class="footnote">[<a id="_footnoteref_15" class="footnote" href="#_footnotedef_15" title="View footnote.">15</a>]</sup></p>
</li>
<li>
<p>Otherwise, the <code>value</code> element of the <code>MapsId</code> annotation must specify
the name of the attribute within the embedded id to which the relationship
attribute corresponds and this attribute of the embedded id must be of the
same type as the primary key of the parent entity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An attribute of an embedded id which corresponds to a relationship targeting
a parent entity is treated by the provider as read onlythat is, any direct
mutation of the attribute is not propagated to the database.</p>
</div>
<div class="paragraph">
<p>If a dependent entity has a single primary key attribute annotated <code>Id</code>,
and the primary key of the parent entity is a simple primary key, then
the primary key of the dependent entity is a simple primary key of the
same Java type as that of the parent entity, the relationship attribute
must be a <code>OneToOne</code> association targeting the parent entity, and either:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the primary key attribute annotated <code>Id</code> is the relationship attribute
itself, or</p>
</li>
<li>
<p>the primary key attribute annotated <code>Id</code> has the same type as the simple
primary key of the parent entity, the relationship attribute is annotated
<code>MapsId</code>, and the <code>value</code> element of the <code>MapsId</code> annotation is left
unspecified.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Neither <code>EmbeddedId</code> nor <code>IdClass</code> is specified for the dependent entity.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapping-of-derived-identities"><a class="anchor" href="#mapping-of-derived-identities"></a>2.4.2.2. Mapping of Derived Identities</h5>
<div class="paragraph">
<p>A dependent entity has derived primary key attributes, and might also have
additional primary key attributes which are not derived from any parent
entity.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any primary key attribute of a dependent entity which is derived from the
identity of a parent entity is mapped by annotations of the corresponding
<code>ManyToOne</code> or <code>OneToOne</code> relationship attribute. The default mapping for
this relationship is specified in <a href="#a538">Section 2.12</a>. The default mapping may be
overridden by annotating the relationship attribute with the <code>JoinColumn</code>
or <code>JoinColumns</code> annotation.</p>
</li>
<li>
<p>If the dependent entity uses an id class, the <code>Column</code> annotation may be
used to override the default mapping of <code>Id</code> attributes which are <code>not</code>
derived from any parent entity.</p>
</li>
<li>
<p>If the dependent entity uses an embedded id to represent its primary key,
the <code>AttributeOverride</code> annotation applied to the <code>EmbeddedId</code> attribute
may be used to override the default mapping of embedded id attributes which
are <em>not</em> derived from any parent entity.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="examples-of-derived-identities"><a class="anchor" href="#examples-of-derived-identities"></a>2.4.2.3. Examples of Derived Identities</h5>
<div class="paragraph">
<p>The following examples illustrate the rules specified above.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity has a simple primary key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span> <span class="type">long</span> empId;
    <span class="predefined-type">String</span> empName;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity uses <code>IdClass</code> to represent a composite key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name; <span class="comment">// matches name of @Id attribute</span>
    <span class="type">long</span> emp; <span class="comment">// matches name of @Id attribute and type of Employee PK</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(DependentId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@Id</span> <span class="predefined-type">String</span> name;

    <span class="comment">// id attribute mapped by join column default</span>
    <span class="annotation">@Id</span> <span class="annotation">@ManyToOne</span>
    Employee emp;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.emp.empName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case(b):</strong> The dependent entity uses <code>EmbeddedId</code> to represent a composite key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    <span class="type">long</span> empPK; <span class="comment">// corresponds to PK type of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@EmbeddedId</span> DependentId id;

    <span class="comment">// id attribute mapped by join column default</span>
    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empPK</span><span class="delimiter">&quot;</span></span>) <span class="comment">// maps empPK attribute of embedded id</span>
    <span class="annotation">@ManyToOne</span>
    Employee emp;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.emp.empName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity uses <code>IdClass</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeId</span> {
    <span class="predefined-type">String</span> firstName;
    <span class="predefined-type">String</span> lastName;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(EmployeeId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span> <span class="predefined-type">String</span> firstName
    <span class="annotation">@Id</span> <span class="predefined-type">String</span> lastName

   <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity uses <code>IdClass</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name; <span class="comment">// matches name of attribute</span>
    EmployeeId emp; <span class="comment">//matches name of attribute and type of Employee PK</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(DependentId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> name;

    <span class="annotation">@Id</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@ManyToOne</span>
    Employee emp;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.emp.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent entity uses
<code>EmbeddedId</code>. The type of the <code>empPK</code> attribute is the same as that of
the primary key of <code>Employee</code>. The <code>EmployeeId</code> class needs to be
annotated <code>Embeddable</code> or denoted as an embeddable class in the XML
descriptor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    EmployeeId empPK;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@EmbeddedId</span>
    DependentId id;

    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empPK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@ManyToOne</span>
    Employee emp;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.emp.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the following alternative query
will yield the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.id.empPK.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity uses <code>EmbeddedId</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeId</span> {
    <span class="predefined-type">String</span> firstName;
    <span class="predefined-type">String</span> lastName;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@EmbeddedId</span>
    EmployeeId empId;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity uses <code>IdClass</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name; <span class="comment">// matches name of @Id attribute</span>
    EmployeeId emp; <span class="comment">// matches name of @Id attribute and type of embedded id of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(DependentId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dep_name</span><span class="delimiter">&quot;</span></span>) <span class="comment">// default column name is overridden</span>
    <span class="predefined-type">String</span> name;

    <span class="annotation">@Id</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@ManyToOne</span> Employee
    emp;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">and</span> d.emp.empId.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent entity uses <code>EmbeddedId</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    EmployeeId empPK; <span class="comment">// corresponds to PK type of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="comment">// default column name for &quot;name&quot; attribute is overridden</span>
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dep_name</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@EmbeddedId</span> DependentId id;

    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empPK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })
    <span class="annotation">@ManyToOne</span>
    Employee emp;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">and</span> d.emp.empId.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the following alternative query will yield the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.id.empPK.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity has a simple primary key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> ssn;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity has a
single primary key attribute which is mapped by the relationship
attribute. The primary key of <code>MedicalHistory</code> is of type <code>String</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="comment">// default join column name is overridden</span>
    <span class="annotation">@Id</span>
    <span class="annotation">@OneToOne</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK</span><span class="delimiter">&quot;</span></span>)
    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m
<span class="keyword">WHERE</span> m.patient.ssn = <span class="string"><span class="delimiter">'</span><span class="content">123-45-6789</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent entity has
a single primary key attribute corresponding to the relationship
attribute. The primary key attribute is of the same basic type as the
primary key of the parent entity. The <code>MapsId</code> annotation applied to the
relationship attribute indicates that the primary key is mapped by the
relationship attribute.<sup class="footnote">[<a id="_footnoteref_16" class="footnote" href="#_footnotedef_16" title="View footnote.">16</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> id; <span class="comment">// overriding not allowed</span>

    <span class="comment">// ...</span>

    <span class="comment">// default join column name is overridden</span>
    <span class="annotation">@MapsId</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@OneToOne</span>
    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m <span class="keyword">WHERE</span> m.patient.ssn = <span class="string"><span class="delimiter">'</span><span class="content">123-45-6789</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity uses <code>IdClass</code>. The
dependent&#8217;s primary key class is of same type as that of the parent
entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">PersonId</span> {
    <span class="predefined-type">String</span> firstName;
    <span class="predefined-type">String</span> lastName;
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(PersonId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> firstName;

    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> lastName;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity uses <code>IdClass</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(PersonId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@OneToOne</span>
    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m
<span class="keyword">WHERE</span> m.patient.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Charles</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent entity uses the
<code>EmbeddedId</code> and <code>MapsId</code> annotations. The <code>PersonId</code> class needs to be
annotated <code>Embeddable</code> or denoted as an embeddable class in the XML
descriptor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="comment">// all attributes map to relationship:</span>
    AttributeOverride not allowed

    <span class="annotation">@EmbeddedId</span>
    PersonId id;

    <span class="comment">// ...</span>

    <span class="annotation">@MapsId</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@OneToOne</span> Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m
<span class="keyword">WHERE</span> m.patient.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Charles</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the following alternative query
will yield the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m
<span class="keyword">WHERE</span> m.id.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Charles</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity uses <code>EmbeddedId</code>. The
dependent&#8217;s primary key is of the same type as that of the parent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PersonId</span> {
    <span class="predefined-type">String</span> firstName;
    <span class="predefined-type">String</span> lastName;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@EmbeddedId</span> PersonId id;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent class uses <code>IdClass</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(PersonId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@OneToOne</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent class uses <code>EmbeddedId</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="comment">// All attributes are mapped by the relationship</span>
    <span class="comment">// AttributeOverride is not allowed</span>
    <span class="annotation">@EmbeddedId</span> PersonId id;

    <span class="comment">// ...</span>

    <span class="annotation">@MapsId</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })
    <span class="annotation">@OneToOne</span>
    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2060"><a class="anchor" href="#a2060"></a>2.5. Entity Versions</h3>
<div class="paragraph">
<p>An entity might have a <em>version</em>, a persistent field or property used by
the persistence provider to perform optimistic locking, as specified in
<a href="#a2059">Section 3.5.2</a>. The version field or property holds a version number or
timestamp identifying the revision of the entity data held by an entity
class instance. In the course of performing lifecycle operations involving
the entity instance, the persistence provider gets and sets the version
field or property of the entity instance to determine or modify its version
number or timestamp. The <code>Version</code> annotation defined in <a href="#a16432">Section 11.1.57</a> or
<code>version</code> XML element must be used to explicitly identify the version field
or property of an entity.</p>
</div>
<div class="paragraph">
<p>An entity class may access the state of its version field or property or
export a method which allows other user-written code to access the version,
but user-written code must not directly modify the value of the version
field or property of an entity instance after the entity is made persistent.
<sup class="footnote">[<a id="_footnoteref_17" class="footnote" href="#_footnotedef_17" title="View footnote.">17</a>]</sup> With the exception noted in <a href="#a5636">Section 4.11</a>, only
the persistence provider is permitted to set or update the entity version.
If the application does directly modify the value of the version field or
property of an entity instance after it is made persistent, the behavior is
undefined.</p>
</div>
<div class="paragraph">
<p>The version must be of one of the following basic types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>int</code>, <code>Integer</code>, <code>short</code>, <code>Short</code>, <code>long</code>, <code>Long</code>, or</p>
</li>
<li>
<p><code>java.time.LocalDateTime</code>, <code>java.time.Instant</code>, or <code>java.sql.Timestamp</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A portable application must not declare a version field or property with any
other type.</p>
</div>
<div class="paragraph">
<p>An entity class should have at most one version. A portable application
must not define an entity class having more than one version field or
property.</p>
</div>
<div class="paragraph">
<p>The version should be declared by the root entity class in an entity class
hierarchy, or by one of its mapped superclasses. A portable application
must not declare a version field or property in a subclass of the root
class of an entity class hierarchy.</p>
</div>
</div>
<div class="sect2">
<h3 id="a486"><a class="anchor" href="#a486"></a>2.6. Basic Types</h3>
<div class="paragraph">
<p>The following Java types are considered <em>basic types</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any Java primitive type, or <code>java.lang</code> wrapper class for a primitive type,</p>
</li>
<li>
<p><code>java.lang.String</code>,</p>
</li>
<li>
<p><code>java.util.UUID</code>,</p>
</li>
<li>
<p><code>BigInteger</code> or <code>BigDecimal</code> from <code>java.math</code>,</p>
</li>
<li>
<p><code>LocalDate</code>, <code>LocalTime</code>, <code>LocalDateTime</code>,
<code>OffsetTime</code>, <code>OffsetDateTime</code>,
<code>Instant</code>, or <code>Year</code> from <code>java.time</code>,</p>
</li>
<li>
<p><code>Date</code> or <code>Calendar</code> <sup class="footnote">[<a id="_footnoteref_18" class="footnote" href="#_footnotedef_18" title="View footnote.">18</a>]</sup> from <code>java.util</code> <sup class="footnote">[<a id="_footnoteref_19" class="footnote" href="#_footnotedef_19" title="View footnote.">19</a>]</sup>,</p>
</li>
<li>
<p><code>Date</code>, <code>Time</code>, or <code>Timestamp</code> from <code>java.sql</code> <sup class="footnote">[<a id="_footnoteref_20" class="footnote" href="#_footnotedef_20" title="View footnote.">20</a>]</sup>,</p>
</li>
<li>
<p><code>byte[]</code> or <code>Byte[]</code>, <code>char[]</code> or <code>Character[]</code> <sup class="footnote">[<a id="_footnoteref_21" class="footnote" href="#_footnotedef_21" title="View footnote.">21</a>]</sup>,</p>
</li>
<li>
<p>any Java <code>enum</code> type,</p>
</li>
<li>
<p>any other type which implements <code>java.io.Serializable</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Persistence for basic types is defined in <a href="#a14205">Section 11.1.6</a> and <a href="#a14719">Section 11.1.18</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a487"><a class="anchor" href="#a487"></a>2.7. Embeddable Classes</h3>
<div class="paragraph">
<p>An entity may use other fine-grained classes
to represent entity state. Instances of these classes, unlike entity
instances, do not have persistent identity of their own. Instead, they
exist only as part of the state of the entity to which they belong. An
entity may have collections of embeddables as well as single-valued
embeddable attributes. Embeddables may also be used as map keys and map
values. Embedded objects belong strictly to their owning entity, and are
not sharable across persistent entities. Attempting to share an embedded
object across entities has undefined semantics.</p>
</div>
<div class="paragraph">
<p>Embeddable classes must be annotated as
<code>Embeddable</code> or denoted in the XML descriptor as such. The access type
for an embedded object is determined as described in <a href="#a113">Section 2.3</a>.</p>
</div>
<div class="paragraph">
<p>An embeddable class may be a regular Java class which adheres to the
requirements specified in <a href="#a18">Section 2.1</a> for entities, with the exception that
an embeddable class is not annotated as <code>Entity</code>, and an embeddable
class may not be abstract.</p>
</div>
<div class="paragraph">
<p>Alternatively, an embeddable class may be any Java record type.</p>
</div>
<div class="paragraph">
<p>An embeddable class may be used to represent
the state of another embeddable class.</p>
</div>
<div class="paragraph">
<p>An embeddable class (including an
embeddable class within another embeddable class) may contain a
collection of a basic type or other embeddable
class.<sup class="footnote">[<a id="_footnoteref_22" class="footnote" href="#_footnotedef_22" title="View footnote.">22</a>]</sup></p>
</div>
<div class="paragraph">
<p>An embeddable class may contain a
relationship to an entity or collection of entities. Since instances of
embeddable classes themselves have no persistent identity, the
relationship <em>from</em> the referenced entity is to the <em>entity</em> that
contains the embeddable instance(s) and not to the embeddable
itself.<sup class="footnote">[<a id="_footnoteref_23" class="footnote" href="#_footnotedef_23" title="View footnote.">23</a>]</sup> An embeddable class that is used as an
embedded id or as a map key must not contain such a relationship.</p>
</div>
<div class="paragraph">
<p>Additional requirements and restrictions on
embeddable classes are described in <a href="#a494">Section 2.8</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a494"><a class="anchor" href="#a494"></a>2.8. Collections of Embeddable Classes and Basic Types</h3>
<div class="paragraph">
<p>A persistent field or property of an entity
or embeddable class may correspond to a collection of a basic type or
embeddable class (element collection). Such a collection, when
specified as such by the <code>ElementCollection</code> annotation, is mapped by
means of a collection table, as defined in <a href="#a14250">Section 11.1.8</a>. If the
<code>ElementCollection</code> annotation (or XML equivalent) is not specified for
the collection-valued field or property, the rules of <a href="#a511">Section 2.10</a> apply.</p>
</div>
<div class="paragraph">
<p>An embeddable class (including an embeddable
class within another embeddable class) that is contained within an
element collection must not contain an element collection, nor may it
contain a relationship to an entity other than a many-to-one or
one-to-one relationship. The embeddable class must be on the owning side
of such a relationship and the relationship must be mapped by a foreign
key mapping. (See <a href="#a516">Section 2.11</a>)</p>
</div>
</div>
<div class="sect2">
<h3 id="map-collections"><a class="anchor" href="#map-collections"></a>2.9. Map Collections</h3>
<div class="paragraph">
<p>Collections of elements and entity
relationships can be represented as <code>java.util.Map</code> collections.</p>
</div>
<div class="paragraph">
<p>The map key and the map value independently
can each be a basic type, an embeddable class, or an entity.</p>
</div>
<div class="paragraph">
<p>The <code>ElementCollection</code>, <code>OneToMany</code>, and
<code>ManyToMany</code> annotations are used to specify the map as an element
collection or entity relationship as follows: when the map value is a
basic type or embeddable class, the <code>ElementCollection</code> annotation is
used; when the map value is an entity, the <code>OneToMany</code> or <code>ManyToMany</code>
annotation is used.</p>
</div>
<div class="paragraph">
<p>Bidirectional relationships represented as
<code>java.util.Map</code> collections support the use of the <code>Map</code> datatype on one
side of the relationship only.</p>
</div>
<div class="sect3">
<h4 id="map-keys"><a class="anchor" href="#map-keys"></a>2.9.1. Map Keys</h4>
<div class="paragraph">
<p>If the map key type is a basic type, the
<code>MapKeyColumn</code> annotation can be used to specify the column mapping for
the map key. If the <code>MapKeyColumn</code> annotation is not specified, the
default values of the <code>MapKeyColumn</code> annotation apply as described in <a href="#a15367">Section 11.1.34</a>.</p>
</div>
<div class="paragraph">
<p>If the map key type is an embeddable class,
the mappings for the map key columns are defaulted according to the
default column mappings for the embeddable class. (See <a href="#a14330">Section 11.1.9</a>). The
<code>AttributeOverride</code> and <code>AttributeOverrides</code> annotations can be used to
override these mappings, as described in <a href="#a14084">Section 11.1.4</a> and <a href="#a14178">Section 11.1.5</a>. If an
embeddable class is used as a map key, the embeddable class must
implement the <code>hashCode</code> and <code>equals</code> methods consistently with the
database columns to which the embeddable is
mapped<sup class="footnote">[<a id="_footnoteref_24" class="footnote" href="#_footnotedef_24" title="View footnote.">24</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>If the map key type is an entity, the
<code>MapKeyJoinColumn</code> and <code>MapKeyJoinColumns</code> annotations are used to
specify the column mappings for the map key. If the primary key of the
referenced entity is a simple primary key and the <code>MapKeyJoinColumn</code>
annotation is not specified, the default values of the
<code>MapKeyJoinColumn</code> annotation apply as described in <a href="#a15450">Section 11.1.36</a>.</p>
</div>
<div class="paragraph">
<p>If Java generic types are not used in the
declaration of a relationship attribute of type <code>java.util.Map</code>, the
<code>MapKeyClass</code> annotation must be used to specify the type of the key of
the map.</p>
</div>
<div class="paragraph">
<p>The <code>MapKey</code> annotation is used to specify
the special case where the map key is itself the primary key or a
persistent field or property of the entity that is the value of the map.
The <code>MapKeyClass</code> annotation is not used when <code>MapKey</code> is specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="map-values"><a class="anchor" href="#map-values"></a>2.9.2. Map Values</h4>
<div class="paragraph">
<p>When the value type of the map is a basic
type or an embeddable class, a collection table is used to map the map.
If Java generic types are not used, the <code>targetClass</code> element of the
<code>ElementCollection</code> annotation must be used to specify the value type
for the map. The default column mappings for the map value are derived
according to the default mapping rules for the <code>CollectionTable</code>
annotation defined in <a href="#a14250">Section 11.1.8</a>. The <code>Column</code> annotation is used to override
these defaults for a map value of basic type. The <code>AttributeOverride(s)</code> and <code>AssociationOverride(s)</code> annotations are used to override
the mappings for a map value that is an embeddable class.</p>
</div>
<div class="paragraph">
<p>When the value type of the map is an entity,
a join table is used to map the map for a many-to-many relationship or,
by default, for a one-to-many unidirectional relationship. If the
relationship is a bidirectional one-to-many/many-to-one relationship, by
default the map is mapped in the table of the entity that is the value
of the map. If Java generic types are not used, the <code>targetEntity</code>
element of the <code>OneToMany</code> or <code>ManyToMany</code> annotation must be used to
specify the value type for the map. Default mappings are described in
<a href="#a538">Section 2.12</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a511"><a class="anchor" href="#a511"></a>2.10. Mapping Defaults for Non-Relationship Fields or Properties</h3>
<div class="paragraph">
<p>If a persistent field or property other than a relationship property is
<em>not</em> annotated with one of the mapping annotations defined in <a href="#a13915">Chapter 11</a>
(and no equivalent mapping information is specified in any XML descriptor),
the following default mapping rules are applied in order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the type of the field or property is a class annotated with the
<code>Embeddable</code> annotation, the field or property is mapped as if it were
annotated with the <code>Embedded</code> annotation. See <a href="#a14634">Section 11.1.15</a> and <a href="#a14672">Section 11.1.16</a>.</p>
</li>
<li>
<p>Otherwise, if the type of the field or property is one of the one of
the basic types listed in <a href="#a486">Section 2.6</a>, it is mapped in the same way as if
it were annotated as <code>Basic</code>. See <a href="#a14205">Section 11.1.6</a>, <a href="#a14719">Section 11.1.18</a>, <a href="#a15087">Section 11.1.29</a>,
and <a href="#a16361">Section 11.1.54</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is an error if no annotation is present and neither of the above rules
apply.</p>
</div>
</div>
<div class="sect2">
<h3 id="a516"><a class="anchor" href="#a516"></a>2.11. Entity Relationships</h3>
<div class="paragraph">
<p>Relationships among entities may be
one-to-one, one-to-many, many-to-one, or many-to-many. Relationships are
polymorphic.</p>
</div>
<div class="paragraph">
<p>If there is an association between two
entities, one of the following relationship modeling annotations must be
applied to the corresponding persistent property or field of the
referencing entity: <code>OneToOne</code>, <code>OneToMany</code>, <code>ManyToOne</code>,
<code>ManyToMany</code>. For associations that do not specify the target type
(e.g., where Java generic types are not used for collections), it is
necessary to specify the entity that is the target of the
relationship.<sup class="footnote">[<a id="_footnoteref_25" class="footnote" href="#_footnotedef_25" title="View footnote.">25</a>]</sup> Equivalent XML elements may be used
as an alternative to these mapping annotations.</p>
</div>
<div class="paragraph">
<p><em>These annotations mirror common practice in
relational database schema modeling. The use of the relationship
modeling annotations allows the object/relationship mapping of
associations to the relational database schema to be fully defaulted, to
provide an ease-of-development facility. This is described in <a href="#a538">Section 2.12</a>.</em></p>
</div>
<div class="paragraph">
<p>Relationships may be bidirectional or
unidirectional. A bidirectional relationship has both an owning side and
an inverse (non-owning) side. A unidirectional relationship has only an
owning side. The owning side of a relationship determines the updates to
the relationship in the database, as described in <a href="#a1955">Section 3.3.4</a>.</p>
</div>
<div class="paragraph">
<p>The following rules apply to bidirectional
relationships:</p>
</div>
<div class="paragraph">
<p>The inverse side of a bidirectional
relationship must refer to its owning side by use of the <code>mappedBy</code>
element of the <code>OneToOne</code>, <code>OneToMany</code>, or <code>ManyToMany</code> annotation.
The <code>mappedBy</code> element designates the property or field in the entity
that is the owner of the relationship.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The many side of one-to-many / many-to-one
bidirectional relationships must be the owning side, hence the
<code>mappedBy</code> element cannot be specified on the <code>ManyToOne</code> annotation.</p>
</li>
<li>
<p>For one-to-one bidirectional relationships,
the owning side corresponds to the side that contains the corresponding
foreign key.</p>
</li>
<li>
<p>For many-to-many bidirectional relationships
either side may be the owning side.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The relationship modeling annotation
constrains the use of the <code>cascade=REMOVE</code> specification. The
<code>cascade=REMOVE</code> specification should only be applied to associations
that are specified as <code>OneToOne</code> or <code>OneToMany</code>. Applications that
apply <code>cascade=REMOVE</code> to other associations are not portable.</p>
</div>
<div class="paragraph">
<p>Associations that are specified as <code>OneToOne</code>
or <code>OneToMany</code> support use of the <code>orphanRemoval</code> option. The following
behaviors apply when <code>orphanRemoval</code> is in effect:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If an entity that is the target of the
relationship is removed from the relationship (by setting the
relationship to null or removing the entity from the relationship
collection), the remove operation will be applied to the entity being
orphaned. The remove operation is applied at the time of the flush
operation. The <code>orphanRemoval</code> functionality is intended for entities
that are privately owned by their parent entity. Portable applications
must otherwise not depend upon a specific order of removal, and must not
reassign an entity that has been orphaned to another relationship or
otherwise attempt to persist it. If the entity being orphaned is a
detached, new, or removed entity, the semantics of <code>orphanRemoval</code> do
not apply.</p>
</li>
<li>
<p>If the remove operation is applied to a
managed source entity, the remove operation will be cascaded to the
relationship target in accordance with the rules of <a href="#a1946">Section 3.3.3</a>,
(and hence it is not necessary to specify <code>cascade=REMOVE</code> for the
relationship)<sup class="footnote">[<a id="_footnoteref_26" class="footnote" href="#_footnotedef_26" title="View footnote.">26</a>]</sup>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#a538">Section 2.12</a>, defines relationship mapping defaults
for entity relationships. Additional mapping annotations (e.g., column
and table mapping annotations) may be specified to override or further
refine the default mappings and mapping strategies described in <a href="#a538">Section 2.12</a>.</p>
</div>
<div class="paragraph">
<p>In addition, this specification also requires
support for the following alternative mapping strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The mapping of unidirectional one-to-many
relationships by means of foreign key mappings. The <code>JoinColumn</code>
annotation or corresponding XML element must be used to specify such
non-default mappings. See <a href="#a14922">Section 11.1.26</a>.</p>
</li>
<li>
<p>The mapping of unidirectional and
bidirectional one-to-one relationships, bidirectional
many-to-one/one-to-many relationships, and unidirectional many-to-one
relationships by means of join table mappings. The <code>JoinTable</code>
annotation or corresponding XML element must be used to specify such
non-default mappings. See <a href="#a15022">Section 11.1.28</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such mapping annotations must be specified on
the owning side of the relationship. Any overriding of mapping defaults
must be consistent with the relationship modeling annotation that is
specified. For example, if a many-to-one relationship mapping is
specified, it is not permitted to specify a unique key constraint on the
foreign key for the relationship.</p>
</div>
<div class="paragraph">
<p>The persistence provider handles the
object/relational mapping of the relationships, including their loading
and storing to the database as specified in the metadata of the entity
class, and the referential integrity of the relationships as specified
in the database (e.g., by foreign key constraints).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that it is the application that bears
responsibility for maintaining the consistency of runtime
relationshipsfor example, for insuring that the one and the many
sides of a bidirectional relationship are consistent with one another
when the application updates the relationship at runtime.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If there are no associated entities for a
multi-valued relationship of an entity fetched from the database, the
persistence provider is responsible for returning an empty collection as
the value of the relationship.</p>
</div>
</div>
<div class="sect2">
<h3 id="a538"><a class="anchor" href="#a538"></a>2.12. Relationship Mapping Defaults</h3>
<div class="paragraph">
<p>This section defines the mapping defaults
that apply to the use of the <code>OneToOne</code>, <code>OneToMany</code>, <code>ManyToOne</code>,
and <code>ManyToMany</code> relationship modeling annotations. The same mapping
defaults apply when the XML descriptor is used to denote the
relationship cardinalities.</p>
</div>
<div class="sect3">
<h4 id="bidirectional-onetoone-relationships"><a class="anchor" href="#bidirectional-onetoone-relationships"></a>2.12.1. Bidirectional OneToOne Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a single instance of Entity B.</p>
</li>
<li>
<p>Entity B references a single instance of Entity A.</p>
</li>
<li>
<p>Entity A is specified as the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <code>A</code>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <code>B</code>.</p>
</li>
<li>
<p>Table <code>A</code> contains a foreign key to table <code>B</code>.
The foreign key column name is formed as the concatenation of the
following: the name of the relationship property or field of entity A; "
<code>_</code> "; the name of the primary key column in table <code>B</code>. The foreign key
column has the same type as the primary key of table <code>B</code> and there is a
unique key constraint on it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> Cubicle assignedCubicle;

    <span class="annotation">@OneToOne</span>
    <span class="directive">public</span> Cubicle getAssignedCubicle() {
        <span class="keyword">return</span> assignedCubicle;
    }

    <span class="directive">public</span> <span class="type">void</span> setAssignedCubicle(Cubicle cubicle) {
        <span class="local-variable">this</span>.assignedCubicle = cubicle;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Cubicle</span> {
    <span class="directive">private</span> Employee residentEmployee;

    <span class="annotation">@OneToOne</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">assignedCubicle</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Employee getResidentEmployee() {
        <span class="keyword">return</span> residentEmployee;
    }

    <span class="directive">public</span> <span class="type">void</span> setResidentEmployee(Employee employee) {
        <span class="local-variable">this</span>.residentEmployee = employee;
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> references a single instance of Entity <code>Cubicle</code>.</p>
</li>
<li>
<p>Entity <code>Cubicle</code> references a single instance of Entity <code>Employee</code>.</p>
</li>
<li>
<p>Entity <code>Employee</code> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> is mapped to a table named <code>EMPLOYEE</code>.</p>
</li>
<li>
<p>Entity <code>Cubicle</code> is mapped to a table named <code>CUBICLE</code>.</p>
</li>
<li>
<p>Table <code>EMPLOYEE</code> contains a foreign key to table <code>CUBICLE</code>.
The foreign key column is named <code>ASSIGNEDCUBICLE_&lt;PK of CUBICLE&gt;</code>,
where <code>&lt;PK of CUBICLE&gt;</code> denotes the name of the primary key column
of table <code>CUBICLE</code>. The foreign key column has the same type as the
primary key of <code>CUBICLE</code>, and there is a unique key constraint on it.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="bidirectional-manytoone-onetomany-relationships"><a class="anchor" href="#bidirectional-manytoone-onetomany-relationships"></a>2.12.2. Bidirectional ManyToOne / OneToMany Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a single instance of Entity B.</p>
</li>
<li>
<p>Entity B references a collection of Entity A<sup class="footnote">[<a id="_footnoteref_27" class="footnote" href="#_footnotedef_27" title="View footnote.">27</a>]</sup>.</p>
</li>
<li>
<p>Entity A must be the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <code>A</code>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <code>B</code>.</p>
</li>
<li>
<p>Table <code>A</code> contains a foreign key to table <code>B</code>.
The foreign key column name is formed as the concatenation of the
following: the name of the relationship property or field of entity A; "
<code>_</code> "; the name of the primary key column in table <code>B</code>. The foreign key
column has the same type as the primary key of table <code>B</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> Department department;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">public</span> Department getDepartment() {
        <span class="keyword">return</span> department;
    }

    <span class="directive">public</span> <span class="type">void</span> setDepartment(Department department) {
        <span class="local-variable">this</span>.department = department;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Employee&gt; employees = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="annotation">@OneToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">department</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Collection</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> references a single instance of Entity <code>Department</code>.</p>
</li>
<li>
<p>Entity <code>Department</code> references a collection of Entity <code>Employee</code>.</p>
</li>
<li>
<p>Entity <code>Employee</code> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> is mapped to a table named <code>EMPLOYEE</code>.</p>
</li>
<li>
<p>Entity <code>Department</code> is mapped to a table named <code>DEPARTMENT</code>.</p>
</li>
<li>
<p>Table <code>EMPLOYEE</code> contains a foreign key to table <code>DEPARTMENT</code>.
The foreign key column is named <code>DEPARTMENT_&lt;PK of DEPARTMENT&gt;</code>,
where <code>&lt;PK of DEPARTMENT&gt;</code> denotes the name of the primary key
column of table <code>DEPARTMENT</code>. The foreign key column has the same
type as the primary key of <code>DEPARTMENT</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="unidirectional-single-valued-relationships"><a class="anchor" href="#unidirectional-single-valued-relationships"></a>2.12.3. Unidirectional Single-Valued Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a single instance of Entity B.</p>
</li>
<li>
<p>Entity B does not reference Entity A.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A unidirectional relationship has only an owning side, which in this case must be Entity A.</p>
</div>
<div class="paragraph">
<p>The unidirectional single-valued relationship
modeling case can be specified as either a unidirectional <code>OneToOne</code> or
as a unidirectional <code>ManyToOne</code> relationship.</p>
</div>
<div class="sect4">
<h5 id="a640"><a class="anchor" href="#a640"></a>2.12.3.1. Unidirectional OneToOne Relationships</h5>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <code>A</code>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <code>B</code>.</p>
</li>
<li>
<p>Table <code>A</code> contains a foreign key to table <code>B</code>.
The foreign key column name is formed as the concatenation of the
following: the name of the relationship property or field of entity A; "
<code>_</code> "; the name of the primary key column in table <code>B</code>. The foreign key
column has the same type as the primary key of table <code>B</code> and there is a
unique key constraint on it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> TravelProfile profile;

    <span class="annotation">@OneToOne</span>
    <span class="directive">public</span> TravelProfile getProfile() {
        <span class="keyword">return</span> profile;
    }

    <span class="directive">public</span> <span class="type">void</span> setProfile(TravelProfile profile) {
        <span class="local-variable">this</span>.profile = profile;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TravelProfile</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> references a single instance of Entity <code>TravelProfile</code>.</p>
</li>
<li>
<p>Entity <code>TravelProfile</code> does not reference Entity <code>Employee</code>.</p>
</li>
<li>
<p>Entity <code>Employee</code> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> is mapped to a table named <code>EMPLOYEE</code>.</p>
</li>
<li>
<p>Entity <code>TravelProfile</code> is mapped to a table named <code>TRAVELPROFILE</code>.</p>
</li>
<li>
<p>Table <code>EMPLOYEE</code> contains a foreign key to table <code>TRAVELPROFILE</code>.
The foreign key column is named <code>PROFILE_&lt;PK of TRAVELPROFILE&gt;</code>,
where <code>&lt;PK of TRAVELPROFILE&gt;</code> denotes the name of the primary key
column of table <code>TRAVELPROFILE</code>. The foreign key column has the
same type as the primary key of <code>TRAVELPROFILE</code>, and there is a
unique key constraint on it.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="unidirectional-manytoone-relationships"><a class="anchor" href="#unidirectional-manytoone-relationships"></a>2.12.3.2. Unidirectional ManyToOne Relationships</h5>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <code>A</code>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <code>B</code>.</p>
</li>
<li>
<p>Table <code>A</code> contains a foreign key to table <code>B</code>. The foreign key column name is formed as the concatenation of the following: the name of the relationship property or field of entity A; "_"; the name of the primary key column in table <code>B</code>. The foreign key column has the same type as the primary key of table <code>B</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> Address address;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">public</span> Address getAddress() {
        <span class="keyword">return</span> address;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) {
        <span class="local-variable">this</span>.address = address;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> references a single instance of Entity <code>Address</code>.</p>
</li>
<li>
<p>Entity <code>Address</code> does not reference Entity <code>Employee</code>.</p>
</li>
<li>
<p>Entity <code>Employee</code> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> is mapped to a table named <code>EMPLOYEE</code>.</p>
</li>
<li>
<p>Entity <code>Address</code> is mapped to a table named <code>ADDRESS</code>.</p>
</li>
<li>
<p>Table <code>EMPLOYEE</code> contains a foreign key to table <code>ADDRESS</code>.
The foreign key column is named <code>ADDRESS_&lt;PK of ADDRESS&gt;</code>,
where <code>&lt;PK of ADDRESS&gt;</code> denotes the name of the primary key
column of table <code>ADDRESS</code>. The foreign key column has the same
type as the primary key of <code>ADDRESS</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a708"><a class="anchor" href="#a708"></a>2.12.4. Bidirectional ManyToMany Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a collection of Entity B.</p>
</li>
<li>
<p>Entity B references a collection of Entity A.</p>
</li>
<li>
<p>Entity A is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <code>A</code>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <code>B</code>.</p>
</li>
<li>
<p>There is a join table that is named <code>A_B</code>
(owner name first). This join table has two foreign key columns. One
foreign key column refers to table <code>A</code> and has the same type as the
primary key of table <code>A</code>. The name of this foreign key column is formed
as the concatenation of the following: the name of the relationship
property or field of entity B; " <code>_</code> "; the name of the primary key
column in table <code>A</code>. The other foreign key column refers to table <code>B</code>
and has the same type as the primary key of table <code>B</code>. The name of this
foreign key column is formed as the concatenation of the following: the
name of the relationship property or field of entity A; " <code>_</code> "; the
name of the primary key column in table <code>B</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Project</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Employee&gt; employees;

    <span class="annotation">@ManyToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Collection</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Project&gt; projects;

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">employees</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Project&gt; getProjects() {
        <span class="keyword">return</span> projects;
    }

    <span class="directive">public</span> <span class="type">void</span> setProjects(<span class="predefined-type">Collection</span>&lt;Project&gt; projects) {
        <span class="local-variable">this</span>.projects = projects;
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Project</code> references a collection of Entity <code>Employee</code>.</p>
</li>
<li>
<p>Entity <code>Employee</code> references a collection of Entity <code>Project</code>.</p>
</li>
<li>
<p>Entity <code>Project</code> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Project</code> is mapped to a table named <code>PROJECT</code>.</p>
</li>
<li>
<p>Entity <code>Employee</code> is mapped to a table named <code>EMPLOYEE</code>.</p>
</li>
<li>
<p>There is a join table that is named
<code>PROJECT_EMPLOYEE</code> (owner name first). This join table has two foreign
key columns. One foreign key column refers to table <code>PROJECT</code> and has
the same type as the primary key of <code>PROJECT</code>. The name of this foreign
key column is <code>PROJECTS_&lt;PK of PROJECT&gt;</code>, where <code>&lt;PK of PROJECT&gt;</code> denotes
the name of the primary key column of table <code>PROJECT</code>. The other
foreign key column refers to table <code>EMPLOYEE</code> and has the same type as
the primary key of <code>EMPLOYEE</code>. The name of this foreign key column is
<code>EMPLOYEES_&lt;PK of EMPLOYEE&gt;</code>, where <code>&lt;PK of EMPLOYEE&gt;</code> denotes the name
of the primary key column of table <code>EMPLOYEE</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a758"><a class="anchor" href="#a758"></a>2.12.5. Unidirectional Multi-Valued Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a collection of Entity B.</p>
</li>
<li>
<p>Entity B does not reference Entity A.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A unidirectional relationship has only an owning side, which in this case must be Entity A.</p>
</div>
<div class="paragraph">
<p>The unidirectional multi-valued relationship
modeling case can be specified as either a unidirectional <code>OneToMany</code> or
as a unidirectional <code>ManyToMany</code> relationship.</p>
</div>
<div class="sect4">
<h5 id="a764"><a class="anchor" href="#a764"></a>2.12.5.1. Unidirectional OneToMany Relationships</h5>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <code>A</code>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <code>B</code>.</p>
</li>
<li>
<p>There is a join table that is named <code>A_B</code>
(owner name first). This join table has two foreign key columns. One
foreign key column refers to table <code>A</code> and has the same type as the
primary key of table <code>A</code>. The name of this foreign key column is formed
as the concatenation of the following: the name of entity A; " <code>_</code> ";
the name of the primary key column in table <code>A</code>. The other foreign key
column refers to table <code>B</code> and has the same type as the primary key of
table <code>B</code> and there is a unique key constraint on it. The name of this
foreign key column is formed as the concatenation of the following: the
name of the relationship property or field of entity A; " <code>_</code> "; the
name of the primary key column in table <code>B</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;AnnualReview&gt; annualReviews;

    <span class="annotation">@OneToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;AnnualReview&gt; getAnnualReviews() {
        <span class="keyword">return</span> annualReviews;
    }

    <span class="directive">public</span> <span class="type">void</span> setAnnualReviews(<span class="predefined-type">Collection</span>&lt;AnnualReview&gt; annualReviews) {
        <span class="local-variable">this</span>.annualReviews = annualReviews;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">AnnualReview</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> references a collection of Entity <code>AnnualReview</code>.</p>
</li>
<li>
<p>Entity <code>AnnualReview</code> does not reference Entity <code>Employee</code>.</p>
</li>
<li>
<p>Entity <code>Employee</code> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> is mapped to a table named <code>EMPLOYEE</code>.</p>
</li>
<li>
<p>Entity <code>AnnualReview</code> is mapped to a table named <code>ANNUALREVIEW</code>.</p>
</li>
<li>
<p>There is a join table that is named
<code>EMPLOYEE_ANNUALREVIEW</code> (owner name first). This join table has two
foreign key columns. One foreign key column refers to table <code>EMPLOYEE</code>
and has the same type as the primary key of <code>EMPLOYEE</code>. This foreign
key column is named <code>EMPLOYEE_&lt;PK of EMPLOYEE&gt;</code>, where <code>&lt;PK of EMPLOYEE&gt;</code>
denotes the name of the primary key column of table <code>EMPLOYEE</code>. The
other foreign key column refers to table <code>ANNUALREVIEW</code> and has the same
type as the primary key of <code>ANNUALREVIEW</code>. This foreign key column is
named <code>ANNUALREVIEWS_&lt;PK of ANNUALREVIEW&gt;</code>, where <code>&lt;PK of ANNUALREVIEW&gt;</code>
denotes the name of the primary key column of table <code>ANNUALREVIEW</code>.
There is a unique key constraint on the foreign key that refers to table
<code>ANNUALREVIEW</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="a800"><a class="anchor" href="#a800"></a>2.12.5.2. Unidirectional ManyToMany Relationships</h5>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>A</code> is mapped to a table named <code>A</code>.</p>
</li>
<li>
<p>Entity <code>B</code> is mapped to a table named <code>B</code>.</p>
</li>
<li>
<p>There is a join table that is named <code>A_B</code>
(owner name first). This join table has two foreign key columns. One
foreign key column refers to table <code>A</code> and has the same type as the
primary key of table A. The name of this foreign key column is formed as
the concatenation of the following: the name of entity <code>A</code>; " <code>_</code> ";
the name of the primary key column in table <code>A</code>. The other foreign key
column refers to table <code>B</code> and has the same type as the primary key of
table <code>B</code>. The name of this foreign key column is formed as the
concatenation of the following: the name of the relationship property or
field of entity <code>A</code>; " <code>_</code> "; the name of the primary key column in
table <code>B</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Patent&gt; patents;

    <span class="annotation">@ManyToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Patent&gt; getPatents() {
        <span class="keyword">return</span> patents;
    }

    <span class="directive">public</span> <span class="type">void</span> setPatents(<span class="predefined-type">Collection</span>&lt;Patent&gt; patents) {
        <span class="local-variable">this</span>.patents = patents;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Patent</span> {
    <span class="comment">//...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> references a collection of Entity <code>Patent</code>.</p>
</li>
<li>
<p>Entity <code>Patent</code> does not reference Entity <code>Employee</code>.</p>
</li>
<li>
<p>Entity <code>Employee</code> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <code>Employee</code> is mapped to a table named <code>EMPLOYEE</code>.</p>
</li>
<li>
<p>Entity <code>Patent</code> is mapped to a table named <code>PATENT</code>.</p>
</li>
<li>
<p>There is a join table that is named
<code>EMPLOYEE_PATENT</code> (owner name first). This join table has two foreign
key columns. One foreign key column refers to table <code>EMPLOYEE</code> and has
the same type as the primary key of <code>EMPLOYEE</code>. This foreign key column
is named <code>EMPLOYEE_&lt;PK of EMPLOYEE&gt;</code>, where <code>&lt;PK of EMPLOYEE&gt;</code> denotes
the name of the primary key column of table <code>EMPLOYEE</code>. The other
foreign key column refers to table <code>PATENT</code> and has the same type as the
primary key of <code>PATENT</code>. This foreign key column is named
<code>PATENTS_&lt;PK of PATENT&gt;</code>, where <code>&lt;PK of PATENT&gt;</code> denotes the name of the
primary key column of table <code>PATENT</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a765"><a class="anchor" href="#a765"></a>2.13. Inheritance</h3>
<div class="paragraph">
<p>An entity may inherit from another entity
class. Entities support inheritance, polymorphic associations, and
polymorphic queries.</p>
</div>
<div class="paragraph">
<p>Both abstract and concrete classes can be
entities. Both abstract and concrete classes can be annotated with the
<code>Entity</code> annotation, mapped as entities, and queried for as entities.</p>
</div>
<div class="paragraph">
<p>Entities can extend non-entity classes and
non-entity classes can extend entity classes.</p>
</div>
<div class="paragraph">
<p>These concepts are described further in the
following sections.</p>
</div>
<div class="sect3">
<h4 id="abstract-entity-classes"><a class="anchor" href="#abstract-entity-classes"></a>2.13.1. Abstract Entity Classes</h4>
<div class="paragraph">
<p>An abstract class can be specified as an
entity. An abstract entity differs from a concrete entity only in that
it cannot be directly instantiated. An abstract entity is mapped as an
entity and can be the target of queries (which will operate over and/or
retrieve instances of its concrete subclasses).</p>
</div>
<div class="paragraph">
<p>An abstract entity class is annotated with
the <code>Entity</code> annotation or denoted in the XML descriptor as an entity.</p>
</div>
<div class="paragraph">
<p>The following example shows the use of an
abstract entity class in the entity inheritance hierarchy.</p>
</div>
<div class="paragraph">
<p><strong>Example: Abstract class as an Entity</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Inheritance</span>(strategy=JOINED)
<span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> empId;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">protected</span> Address address;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FT_EMP</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">FT</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FT_EMPID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">FullTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// Inherit empId, but mapped in this class to FT_EMP.FT_EMPID</span>
    <span class="comment">// Inherit version mapped to EMP.VERSION</span>
    <span class="comment">// Inherit address mapped to EMP.ADDRESS fk</span>

    <span class="comment">// Defaults to FT_EMP.SALARY</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> salary;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PT_EMP</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">PT</span><span class="delimiter">&quot;</span></span>)
<span class="comment">// PK column is PT_EMP.EMPID due to `PrimaryKeyJoinColumn` default</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PartTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="directive">protected</span> <span class="predefined-type">Float</span> hourlyWage;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapped-superclasses"><a class="anchor" href="#mapped-superclasses"></a>2.13.2. Mapped Superclasses</h4>
<div class="paragraph">
<p>An entity may inherit from a superclass that
provides persistent entity state and mapping information, but which is
not itself an entity. Typically, the purpose of such a mapped superclass
is to define state and mapping information that is common to multiple
entity classes.</p>
</div>
<div class="paragraph">
<p>A mapped superclass, unlike an entity, is not
queryable and must not be passed as an argument to <code>EntityManager</code> or
<code>Query</code> operations. Persistent relationships defined by a mapped
superclass must be unidirectional.</p>
</div>
<div class="paragraph">
<p>Both abstract and concrete classes may be
specified as mapped superclasses. The <code>MappedSuperclass</code> annotation (or
<code>mapped-superclass</code> XML descriptor element) is used to designate a
mapped superclass.</p>
</div>
<div class="paragraph">
<p>A class designated as a mapped superclass has
no separate table defined for it. Its mapping information is applied to
the entities that inherit from it.</p>
</div>
<div class="paragraph">
<p>The persistent attributes of a mapped superclass may be mapped in the same
way as the attributes of an entity class. Such mappings apply only to the
entity subclasses of the mapped superclass, since no table exists for the
mapped superclass itself. When applied to a subclass, the inherited mappings
are interpreted in the context of the tables mapped by subclass. Mapping
information inherited from a mapped superclass can be overridden in such
subclasses using the <code>AttributeOverride</code> and <code>AssociationOverride</code>
annotations or corresponding XML elements.</p>
</div>
<div class="paragraph">
<p>All other entity mapping defaults apply
equally to a class designated as a mapped superclass.</p>
</div>
<div class="paragraph">
<p>The following example illustrates the
definition of a concrete class as a mapped superclass.</p>
</div>
<div class="paragraph">
<p><strong>Example: Concrete class as a mapped superclass</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MappedSuperclass</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> empId;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="annotation">@ManyToOne</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">protected</span> Address address;

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getEmpId() { ... }

    <span class="directive">public</span> <span class="type">void</span> setEmpId(<span class="predefined-type">Integer</span> id) { ... }

    <span class="directive">public</span> Address getAddress() { ... }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address addr) { ... }
}

<span class="comment">// Default table is FTEMPLOYEE table</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">FTEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// Inherited empId field mapped to FTEMPLOYEE.EMPID</span>
    <span class="comment">// Inherited version field mapped to FTEMPLOYEE.VERSION</span>
    <span class="comment">// Inherited address field mapped to FTEMPLOYEE.ADDR fk</span>

    <span class="comment">// Defaults to FTEMPLOYEE.SALARY</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> salary;

    <span class="directive">public</span> FTEmployee() {}

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getSalary() { ... }

    <span class="directive">public</span> <span class="type">void</span> setSalary(<span class="predefined-type">Integer</span> salary) { ... }
}

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PT_EMP</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, joincolumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">PartTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// Inherited empId field mapped to PT_EMP.EMPID</span>
    <span class="comment">// Inherited version field mapped to PT_EMP.VERSION</span>
    <span class="comment">// address field mapping overridden to PT_EMP.ADDR_ID fk</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WAGE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">protected</span> <span class="predefined-type">Float</span> hourlyWage;

    <span class="directive">public</span> PartTimeEmployee() {}

    <span class="directive">public</span> <span class="predefined-type">Float</span> getHourlyWage() { ... }

    <span class="directive">public</span> <span class="type">void</span> setHourlyWage(<span class="predefined-type">Float</span> wage) { ... }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="non-entity-classes-in-the-entity-inheritance-hierarchy"><a class="anchor" href="#non-entity-classes-in-the-entity-inheritance-hierarchy"></a>2.13.3. Non-Entity Classes in the Entity Inheritance Hierarchy</h4>
<div class="paragraph">
<p>An entity can have a non-entity
superclass, which may be either a concrete or abstract
class.<sup class="footnote">[<a id="_footnoteref_28" class="footnote" href="#_footnotedef_28" title="View footnote.">28</a>]</sup></p>
</div>
<div class="paragraph">
<p>The non-entity superclass serves for
inheritance of behavior only. The state of a non-entity superclass is
not persistent. Any state inherited from non-entity superclasses is
non-persistent in an inheriting entity class. This non-persistent state
is not managed by the entity manager<sup class="footnote">[<a id="_footnoteref_29" class="footnote" href="#_footnotedef_29" title="View footnote.">29</a>]</sup>. Any
annotations on such superclasses are ignored.</p>
</div>
<div class="paragraph">
<p>Non-entity classes cannot be passed as
arguments to methods of the <code>EntityManager</code> or <code>Query</code>
interfaces<sup class="footnote">[<a id="_footnoteref_30" class="footnote" href="#_footnotedef_30" title="View footnote.">30</a>]</sup> and cannot bear mapping information.</p>
</div>
<div class="paragraph">
<p>The following example illustrates the use of
a non-entity class as a superclass of an entity.</p>
</div>
<div class="paragraph">
<p><strong>Example: Non-entity superclass</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Cart</span> {
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> operationCount; <span class="comment">// transient state</span>

    <span class="directive">public</span> Cart() {
        operationCount = <span class="integer">0</span>;
    }

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getOperationCount() {
        <span class="keyword">return</span> operationCount;
    }

    <span class="directive">public</span> <span class="type">void</span> incrementOperationCount() {
        operationCount++;
    }
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCart</span> <span class="directive">extends</span> Cart {
    <span class="predefined-type">Collection</span>&lt;Item&gt; items = <span class="keyword">new</span> <span class="predefined-type">Vector</span>&lt;Item&gt;();

    <span class="directive">public</span> ShoppingCart() {
        <span class="local-variable">super</span>();
    }

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Item&gt; getItems() {
        <span class="keyword">return</span> items;
    }

    <span class="directive">public</span> <span class="type">void</span> addItem(Item item) {
        items.add(item);
        incrementOperationCount();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a966"><a class="anchor" href="#a966"></a>2.14. Inheritance Mapping Strategies</h3>
<div class="paragraph">
<p>The mapping of class hierarchies is specified through metadata.</p>
</div>
<div class="paragraph">
<p>There are three basic strategies that are
used when mapping a class or class hierarchy to a relational database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a single table per class hierarchy</p>
</li>
<li>
<p>a joined subclass strategy, in which fields
that are specific to a subclass are mapped to a separate table than the
fields that are common to the parent class, and a join is performed to
instantiate the subclass.</p>
</li>
<li>
<p>a table per concrete entity class</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An implementation is required to support the
single table per class hierarchy inheritance mapping strategy and the
joined subclass strategy.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Support for the table per concrete class
inheritance mapping strategy is optional in this release. Applications
that use this mapping strategy will not be portable.</p>
</div>
<div class="paragraph">
<p>Support for the combination of inheritance
strategies within a single entity inheritance hierarchy is not required
by this specification.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="single-table-per-class-hierarchy-strategy"><a class="anchor" href="#single-table-per-class-hierarchy-strategy"></a>2.14.1. Single Table per Class Hierarchy Strategy</h4>
<div class="paragraph">
<p>In this strategy, all the classes in a
hierarchy are mapped to a single table. The table has a column that
serves as a discriminator column, that is, a column whose value
identifies the specific subclass to which the instance that is
represented by the row belongs.</p>
</div>
<div class="paragraph">
<p>This mapping strategy provides good support
for polymorphic relationships between entities and for queries that
range over the class hierarchy.</p>
</div>
<div class="paragraph">
<p>It has the drawback, however, that it
requires that the columns that correspond to state specific to the
subclasses be nullable.</p>
</div>
</div>
<div class="sect3">
<h4 id="joined-subclass-strategy"><a class="anchor" href="#joined-subclass-strategy"></a>2.14.2. Joined Subclass Strategy</h4>
<div class="paragraph">
<p>In the joined subclass strategy, the root of
the class hierarchy is represented by a single table. Each subclass is
represented by a separate table that contains those fields that are
specific to the subclass (not inherited from its superclass), as well as
the column(s) that represent its primary key. The primary key column(s)
of the subclass table serves as a foreign key to the primary key of the
superclass table.</p>
</div>
<div class="paragraph">
<p>This strategy provides support for
polymorphic relationships between entities.</p>
</div>
<div class="paragraph">
<p>It has the drawback that it requires that one
or more join operations be performed to instantiate instances of a
subclass. In deep class hierarchies, this may lead to unacceptable
performance. Queries that range over the class hierarchy likewise
require joins.</p>
</div>
</div>
<div class="sect3">
<h4 id="table-per-concrete-class-strategy"><a class="anchor" href="#table-per-concrete-class-strategy"></a>2.14.3. Table per Concrete Class Strategy</h4>
<div class="paragraph">
<p>In this mapping strategy, each class is
mapped to a separate table. All properties of the class, including
inherited properties, are mapped to columns of the table for the class.</p>
</div>
<div class="paragraph">
<p>This strategy has the following drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It provides poor support for polymorphic relationships.</p>
</li>
<li>
<p>It typically requires that SQL UNION queries
(or a separate SQL query per subclass) be issued for queries that are
intended to range over the class hierarchy.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a988"><a class="anchor" href="#a988"></a>2.15. Naming of Database Objects</h3>
<div class="paragraph">
<p>Many annotations and annotation elements
contain names of database objects or assume default names for database
objects.</p>
</div>
<div class="paragraph">
<p>This specification requires the following
with regard to the interpretation of the names referencing database
objects. These names include the names of tables, columns, and other
database elements. Such names also include names that result from
defaulting (e.g., a table name that is defaulted from an entity name or
a column name that is defaulted from a field or property name).</p>
</div>
<div class="paragraph">
<p>By default, the names of database objects
must be treated as undelimited identifiers and passed to the database as
such.</p>
</div>
<div class="paragraph">
<p>For example, assuming the use of an English
locale, the following must be passed to the database as undelimited
identifers so that they will be treated as equivalent for all databases
that comply with the SQL Standard&#8217;s requirements for the treatment of
regular identifiers (undelimited identifiers) and delimited
identifiers <a href="#a19494">[2]</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">Customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">cUsTomer</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, the following must be treated as equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ManyToOne</span> Customer customer;

<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ManyToOne</span> Customer customer;

<span class="annotation">@ManyToOne</span> Customer customer;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To specify delimited identifiers, one of the
following approaches must be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is possible to specify that all database
identifiers in use for a persistence unit be treated as delimited
identifiers by specifying the <em>&lt;delimited-identifiers/&gt;</em> element within
the <code>persistence-unit-defaults</code> element of the object/relational xml
mapping file. If the <em>&lt;delimited-identifiers/&gt;</em> element is specified, it
cannot be overridden.</p>
</li>
<li>
<p>It is possible to specify on a per-name basis
that a name for a database object is to be interpreted as a delimited
identifier as follows:</p>
<div class="ulist">
<ul>
<li>
<p>Using annotations, a name is specified as a
delimited identifier by enclosing the name within double quotes, whereby
the inner quotes are escaped, e.g., <code>@Table(name="\"customer\"")</code>.</p>
</li>
<li>
<p>When using XML, a name is specified as
a delimited identifier by use of double quotes, e.g., <code>&lt;table name="&amp;quot;customer&amp;quot;"/&gt;</code> <sup class="footnote">[<a id="_footnoteref_31" class="footnote" href="#_footnotedef_31" title="View footnote.">31</a>]</sup></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following annotations contain elements
whose values correspond to names of database identifiers and for which
the above rules apply, including when their use is nested within that of
other annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EntityResult(discriminatorColumn <strong>element</strong>)</code></p>
</li>
<li>
<p><code>FieldResult(column <strong>element</strong>)</code></p>
</li>
<li>
<p><code>ColumnResult(name <strong>element</strong>)</code></p>
</li>
<li>
<p><code>CollectionTable(name, catalog, schema <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>Column(name, columnDefinition, table <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>DiscriminatorColumn(name, columnDefinition <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>ForeignKey(name, foreignKeyDefinition <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>Index(name, columnList <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>JoinColumn(name, referencedColumnName, columnDefinition, table <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>JoinTable(name, catalog, schema <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>MapKeyColumn(name, columnDefinition, table <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>MapKeyJoinColumn(name, referencedColumnName, columnDefinition, table <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>NamedStoredProcedureQuery(procedureName <strong>element</strong>)</code></p>
</li>
<li>
<p><code>OrderColumn(name, columnDefinition <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>PrimaryKeyJoinColumn(name, referencedColumnName, columnDefinition <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>SecondaryTable(name, catalog, schema <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>SequenceGenerator(sequenceName, catalog, schema <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>StoredProcedureParameter(name <strong>element</strong>)</code></p>
</li>
<li>
<p><code>Table(name, catalog, schema <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>TableGenerator(table, catalog, schema, pkColumnName, valueColumnName <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>UniqueConstraint(name, columnNames <strong>elements</strong>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following XML elements and types contain
elements or attributes whose values correspond to names of database
identifiers and for which the above rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>entity-mappings(schema, catalog <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>persistence-unit-defaults(schema, catalog <strong>elements</strong>)</code></p>
</li>
<li>
<p><code>collection-table(name, catalog, schema <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>column(name, table, column-definition <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>column-result(name <strong>attribute</strong>)</code></p>
</li>
<li>
<p><code>discriminator-column(name, column-definition <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>entity-result(discriminator-column <strong>attribute</strong>)</code></p>
</li>
<li>
<p><code>field-result(column <strong>attribute</strong>)</code></p>
</li>
<li>
<p><code>foreign-key(name, foreign-key-definition <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>index(name <strong>attribute</strong>, column-list <strong>element</strong>)</code></p>
</li>
<li>
<p><code>join-column(name, referenced-column-name, column-definition, table <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>join-table(name, catalog, schema <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>map-key-column(name, column-definition, table <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>map-key-join-column(name, referenced-column-name, column-definition, table <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>named-stored-procedure-query(procedure-name <strong>attribute</strong>)</code></p>
</li>
<li>
<p><code>order-column(name, column-definition <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>primary-key-join-column(name, referenced-column-name, column-definition <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>secondary-table(name, catalog, schema <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>sequence-generator(sequence-name, catalog, schema <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>stored-procedure-parameter(name <strong>attribute</strong>)</code></p>
</li>
<li>
<p><code>table(name, catalog, schema <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>table-generator(table, catalog, schema, pk-column-name, value-column-name <strong>attributes</strong>)</code></p>
</li>
<li>
<p><code>unique-constraint(name <strong>attribute</strong>, column-name <strong>element</strong>)</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a1060"><a class="anchor" href="#a1060"></a>3. Entity Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the use of the <code>EntityManager</code> and <code>Query</code> APIs to retrieve instances of
entity classes representing persistent state held in the database, and
of <code>EntityGraph</code> to control the limits of the object graph returned by
such operations,</p>
</li>
<li>
<p>the use of the <code>EntityManager</code> API to manage the lifecycle of entity
instances associated with a persistence context, and to control the
synchronization of state held in the persistence context with the
database,</p>
</li>
<li>
<p>the use of the second-level cache, and</p>
</li>
<li>
<p>entity listeners and lifeycle callbacks, attribute converters,
and integration with Bean Validation.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="overview"><a class="anchor" href="#overview"></a>3.1. Overview</h3>
<div class="paragraph">
<p>Every instance of <code>EntityManager</code> has an associated <em>persistence context</em>.
A persistence context is a set of entity instances in which for any given
persistent entity identity there is a unique entity instance. Within the
persistence context, the entity instances and their lifecycle are managed.
The entity instance lifecycle is defined in <a href="#a1929">Section 3.3</a>. The relationship
between entity managers and persistence contexts is described in <a href="#a2027">Section 3.4</a>,
and again in further detail in <a href="#a11431">Chapter 7</a>.</p>
</div>
<div class="paragraph">
<p>The <code>EntityManager</code> interface defines the methods used to interact with
its persistence context. The <code>EntityManager</code> API is used to create and
remove persistent entity instances, to find persistent entities by primary
key, and to query over persistent entity types. <a href="#a1066">Section 3.2</a> describes the
<code>EntityManager</code> interface. <a href="#a2052">Section 3.5</a> describes mechanisms for concurrency
control and locking. <a href="#a4639">Section 3.12</a> provides a summary of exceptions.</p>
</div>
<div class="paragraph">
<p>The <code>EntityManager</code> acts as a factory for instances of <code>Query</code>, which are
used to control query execution. <code>Query</code>, <code>TypedQuery</code>, <code>StoredProcedureQuery</code>,
and related interfaces are described in <a href="#a3125">Section 3.11</a>. The Jakarta Persistence
query language is defined in <a href="#a4665">Chapter 4</a> and APIs for the construction of
Criteria queries in <a href="#a6925">Chapter 6</a>. <a href="#a2397">Section 3.8</a> describes the use of entity graphs
to control and limit the data fetched during find and query operations.</p>
</div>
<div class="paragraph">
<p>Each <code>EntityManager</code> belongs to an <code>EntityManagerFactory</code> with an associated
<em>persistence unit</em>. A persistence unit defines a set of related entities which
map to a single database. Entities belonging to the same persistence unit may
participate in associations. An <code>EntityManager</code> may only manage instances of
entities belonging to its persistence unit. The definition of persistence
units is described in <a href="#a12229">Chapter 8</a>. An <code>EntityManagerFactory</code> might have an
associated second-level cache. <a href="#a3061">Section 3.10</a> describes mechanisms for portable
configuration of the second-level cache.</p>
</div>
<div class="paragraph">
<p>Jakarta Persistence features several mechanisms allowing user-written code
to react to events occurring within the persistence context. <a href="#a2153">Section 3.6</a>
describes entity listeners and lifecycle callback methods for entities.
<a href="#a2366">Section 3.7</a> describes support for automatic use of Bean Validation. <a href="#a2397">Section 3.8</a>
describes mechanisms for defining conversions between entity and database
representations for attributes of basic types.</p>
</div>
</div>
<div class="sect2">
<h3 id="a1066"><a class="anchor" href="#a1066"></a>3.2. EntityManager Interface</h3>
<div class="paragraph">
<p>The <code>EntityManager</code> interface may be found in <a href="#_entitymanager_">Section B.1</a>.</p>
</div>
<div class="paragraph">
<p>The <code>persist</code>, <code>merge</code>, <code>remove</code>, and
<code>refresh</code> methods must be invoked within a transaction context when an
entity manager with a transaction-scoped persistence context is used. If
there is no transaction context, the
<code>jakarta.persistence.TransactionRequiredException</code> is thrown.</p>
</div>
<div class="paragraph">
<p>Methods that specify a lock mode other than
<code>LockModeType.NONE</code> must be invoked within a transaction. If there is no
transaction or if the entity manager has not been joined to the
transaction, the <code>jakarta.persistence.TransactionRequiredException</code> is
thrown.</p>
</div>
<div class="paragraph">
<p>The <code>find</code> method (provided it is invoked
without a lock or invoked with <code>LockModeType.NONE</code>) and the
<code>getReference</code> method are not required to be invoked within a
transaction. If an entity manager with transaction-scoped persistence
context is in use, the resulting entities will be detached; if an entity
manager with an extended persistence context is used, they will be
managed. See <a href="#a2027">Section 3.4</a> for entity manager use outside a
transaction.</p>
</div>
<div class="paragraph">
<p>The <code>Query</code>, <code>TypedQuery</code>,
<code>StoredProcedureQuery</code>, <code>CriteriaBuilder</code>, <code>Metamodel</code>, and
<code>EntityTransaction</code> objects obtained from an entity manager are valid
while that entity manager is open.</p>
</div>
<div class="paragraph">
<p>If the argument to the <code>createQuery</code> method
is not a valid Jakarta Persistence query string or a valid <code>CriteriaQuery</code>
object, the <code>IllegalArgumentException</code> may be thrown or the query
execution will fail and a <code>PersistenceException</code> will be thrown. If the
result class specification of a Jakarta Persistence query language query is
incompatible with the result of the query, the
<code>IllegalArgumentException</code> may be thrown when the <code>createQuery</code> method
is invoked or the query execution will fail and a <code>PersistenceException</code>
will be thrown when the query is executed. If a native query is not a
valid query for the database in use or if the result set specification
is incompatible with the result of the query, the query execution will
fail and a <code>PersistenceException</code> will be thrown when the query is
executed. The <code>PersistenceException</code> should wrap the underlying database
exception when possible.</p>
</div>
<div class="paragraph">
<p>Runtime exceptions thrown by the methods of
the <code>EntityManager</code> interface other than the <code>LockTimeoutException</code> will
cause the current transaction to be marked for rollback if the
persistence context is joined to that transaction.</p>
</div>
<div class="paragraph">
<p>The methods <code>close</code>, <code>isOpen</code>,
<code>joinTransaction</code>, and <code>getTransaction</code> are used to manage
application-managed entity managers and their lifecycle. See <a href="#a11465">Section 7.2.2</a>.</p>
</div>
<div class="paragraph">
<p>The <code>EntityManager</code> interface and other
interfaces defined by this specification contain methods that take
properties and/or hints as arguments. This specification distinguishes
between <code>properties</code> and <code>hints</code> as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A property defined by this specification must
be observed by the provider unless otherwise explicitly stated.</p>
</li>
<li>
<p>A hint specifies a preference on the part of
the application. While a hint defined by this specification should be
observed by the provider if possible, a hint may or may not always be
observed. A portable application must not depend on the observance of a
hint.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">OrderEntryBean</span> <span class="directive">implements</span> OrderEntry {
    <span class="annotation">@PersistenceContext</span>
    EntityManager em;

    <span class="directive">public</span> <span class="type">void</span> enterOrder(<span class="type">int</span> custID, Order newOrder) {
        Customer cust = em.find(Customer.class, custID);
        cust.getOrders().add(newOrder);
        newOrder.setCustomer(cust);
        em.persist(newOrder);
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The semantics of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>public &lt;T&gt; TypedQuery&lt;T&gt; createQuery(String qlString, Class&lt;T&gt; resultClass)</pre>
</div>
</div>
<div class="paragraph">
<p>method may be extended in a future release of this specification to
support other result types. Applications that specify other result types
(e.g., Tuple.class) will not be portable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The semantics</p>
</div>
<div class="literalblock">
<div class="content">
<pre>public &lt;T&gt; TypedQuery&lt;T&gt; createNamedQuery(String name, Class&lt;T&gt; resultClass)</pre>
</div>
</div>
<div class="paragraph">
<p>method may be extended in a future release of this specification to
support other result types. Applications that specify other result types
(e.g., Tuple.class) will not be portable.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="a1929"><a class="anchor" href="#a1929"></a>3.3. Entity Instance&#8217;s Life Cycle</h3>
<div class="paragraph">
<p>This section describes the <code>EntityManager</code>
operations for managing an entity instance&#8217;s lifecycle. An entity
instance can be characterized as being new, managed, detached, or
removed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A new entity instance has no persistent
identity, and is not yet associated with a persistence context.</p>
</li>
<li>
<p>A managed entity instance is an instance with
a persistent identity that is currently associated with a persistence
context.</p>
</li>
<li>
<p>A detached entity instance is an instance
with a persistent identity that is not (or no longer) associated with a
persistence context.</p>
</li>
<li>
<p>A removed entity instance is an instance with
a persistent identity, associated with a persistence context, that will
be removed from the database upon transaction commit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following subsections describe the effect
of lifecycle operations upon entities. Use of the <code>cascade</code> annotation
element may be used to propagate the effect of an operation to
associated entities. The cascade functionality is most typically used in
parent-child relationships.</p>
</div>
<div class="sect3">
<h4 id="entity-instance-creation"><a class="anchor" href="#entity-instance-creation"></a>3.3.1. Entity Instance Creation</h4>
<div class="paragraph">
<p>Entity instances are created by means of the
<code>new</code> operation. An entity instance, when first created by <code>new</code> is not
yet persistent. An instance becomes persistent by means of the
<code>EntityManager</code> API.</p>
</div>
</div>
<div class="sect3">
<h4 id="persisting-an-entity-instance"><a class="anchor" href="#persisting-an-entity-instance"></a>3.3.2. Persisting an Entity Instance</h4>
<div class="paragraph">
<p>A new entity instance becomes both managed
and persistent by invoking the <code>persist</code> method on it or by cascading
the persist operation.</p>
</div>
<div class="paragraph">
<p>The semantics of the persist operation,
applied to an entity <code>X</code> are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a new entity, it becomes managed. The
entity X will be entered into the database at or before transaction
commit or as a result of the flush operation.</p>
</li>
<li>
<p>If X is a preexisting managed entity, it is
ignored by the persist operation. However, the persist operation is
cascaded to entities referenced by X, if the relationships from X to
these other entities are annotated with the <code>cascade=PERSIST</code> or
<code>cascade=ALL</code> annotation element value or specified with the equivalent
XML descriptor element.</p>
</li>
<li>
<p>If X is a removed entity, it becomes managed.</p>
</li>
<li>
<p>If X is a detached object, the
<code>EntityExistsException</code> may be thrown when the persist operation is
invoked, or the <code>EntityExistsException</code> or another
<code>PersistenceException</code> <code>may</code> be thrown at flush or commit time.</p>
</li>
<li>
<p>For all entities Y referenced by a
relationship from X, if the relationship to Y has been annotated with
the <code>cascade</code> element value <code>cascade=PERSIST</code> or <code>cascade=ALL</code>, the
persist operation is applied to Y.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a1946"><a class="anchor" href="#a1946"></a>3.3.3. Removal</h4>
<div class="paragraph">
<p>A managed entity instance becomes removed by
invoking the <code>remove</code> method on it or by cascading the remove operation.</p>
</div>
<div class="paragraph">
<p>The semantics of the remove operation,
applied to an entity X are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a new entity, it is ignored by the
remove operation. However, the remove operation is cascaded to entities
referenced by X, if the relationship from X to these other entities is
annotated with the <code>cascade=REMOVE</code> or <code>cascade=ALL</code> annotation element
value.</p>
</li>
<li>
<p>If X is a managed entity, the remove
operation causes it to become removed. The remove operation is cascaded
to entities referenced by X, if the relationships from X to these other
entities is annotated with the <code>cascade=REMOVE</code> or <code>cascade=ALL</code>
annotation element value.</p>
</li>
<li>
<p>If X is a detached entity, an
<code>IllegalArgumentException</code> will be thrown by the remove operation (or
the transaction commit will fail).</p>
</li>
<li>
<p>If X is a removed entity, it is ignored by the remove operation.</p>
</li>
<li>
<p>A removed entity X will be removed from the
database at or before transaction commit or as a result of the flush
operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After an entity has been removed, its state
(except for generated state) will be that of the entity at the point at
which the remove operation was called.</p>
</div>
</div>
<div class="sect3">
<h4 id="a1955"><a class="anchor" href="#a1955"></a>3.3.4. Synchronization to the Database</h4>
<div class="paragraph">
<p>In general, a persistence context will be
synchronized to the database as described below. However, a persistence
context of type <code>SynchronizationType.UNSYNCHRONIZED</code> or an
application-managed persistence context that has been created outside
the scope of the current transaction will only be synchronized to the
database if it has been joined to the current transaction by the
application&#8217;s use of the <code>EntityManager</code> <code>joinTransaction</code> method.</p>
</div>
<div class="paragraph">
<p>The state of persistent entities is
synchronized to the database at transaction commit. This synchronization
involves writing to the database any updates to persistent entities and
their relationships as specified above.</p>
</div>
<div class="paragraph">
<p>An update to the state of an entity includes
both the assignment of a new value to a persistent property or field of
the entity as well as the modification of a mutable value of a
persistent property or field<sup class="footnote">[<a id="_footnoteref_32" class="footnote" href="#_footnotedef_32" title="View footnote.">32</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>Synchronization to the database does not
involve a refresh of any managed entities unless the <code>refresh</code> operation
is explicitly invoked on those entities or cascaded to them as a result
of the specification of the <code>cascade=REFRESH</code> or <code>cascade=ALL</code>
annotation element value.</p>
</div>
<div class="paragraph">
<p>Bidirectional relationships between
managed entities will be persisted based on references held by the
owning side of the relationship. It is the developer&#8217;s responsibility to
keep the in-memory references held on the owning side and those held on
the inverse side consistent with each other when they change. In the
case of unidirectional one-to-one and one-to-many relationships, it is
the developer&#8217;s responsibility to insure that the semantics of the
relationships are adhered to.<sup class="footnote">[<a id="_footnoteref_33" class="footnote" href="#_footnotedef_33" title="View footnote.">33</a>]</sup></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is particularly important to ensure that
changes to the inverse side of a relationship result in appropriate
updates on the owning side, so as to ensure the changes are not lost
when they are synchronized to the database.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The persistence provider runtime is permitted
to perform synchronization to the database at other times as well when a
transaction is active and the persistence context is joined to the
transaction. The <code>flush</code> method can be used by the application to force
synchronization. It applies to entities associated with the persistence
context. The <code>setFlushMode</code> methods of the <code>EntityManager</code>, <code>Query</code>,
<code>TypedQuery</code>, and <code>StoredProcedureQuery</code> interfaces can be used to
control synchronization semantics. The effect of <code>FlushModeType.AUTO</code> is
defined in <a href="#a4374">Section 3.11.2</a>. If <code>FlushModeType.COMMIT</code> is specified, flushing will occur at
transaction commit; the persistence provider is permitted, but not
required, to perform to flush at other times. If there is no transaction
active or if the persistence context has not been joined to the current
transaction, the persistence provider must not flush to the database.</p>
</div>
<div class="paragraph">
<p>The semantics of the flush operation, applied
to an entity <code>X</code> are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a managed entity, it is synchronized
to the database.</p>
<div class="ulist">
<ul>
<li>
<p>For all entities Y referenced by a
relationship from X, if the relationship to Y has been annotated with
the <code>cascade</code> element value <code>cascade=PERSIST</code> or <code>cascade=ALL</code>, the
persist operation is applied to Y.</p>
</li>
<li>
<p>For any entity Y referenced by a relationship
from X, where the relationship to Y has not been annotated with the
<code>cascade</code> element value <code>cascade=PERSIST</code> or <code>cascade=ALL</code>:</p>
<div class="ulist">
<ul>
<li>
<p>If Y is new or removed, an
<code>IllegalStateException</code> will be thrown by the flush operation (and the
transaction marked for rollback) or the transaction commit will fail.</p>
</li>
<li>
<p>If Y is detached, the semantics depend upon
the ownership of the relationship. If X owns the relationship, any
changes to the relationship are synchronized with the database;
otherwise, if Y owns the relationships, the behavior is undefined.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>If X is a removed entity, it is removed from
the database. No cascade options are relevant.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="refreshing-an-entity-instance"><a class="anchor" href="#refreshing-an-entity-instance"></a>3.3.5. Refreshing an Entity Instance</h4>
<div class="paragraph">
<p>The state of a managed entity instance is
refreshed from the database by invoking the <code>refresh</code> method on it or by
cascading the refresh operation.</p>
</div>
<div class="paragraph">
<p>The semantics of the refresh operation,
applied to an entity X are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a managed entity, the state of X is
refreshed from the database, overwriting changes made to the entity, if
any. The refresh operation is cascaded to entities referenced by X if
the relationship from X to these other entities is annotated with the
<code>cascade=REFRESH</code> or <code>cascade=ALL</code> annotation element value.</p>
</li>
<li>
<p>If X is a new, detached, or removed entity,
the <code>IllegalArgumentException</code> is thrown.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="evicting-an-entity-instance-from-the-persistence-context"><a class="anchor" href="#evicting-an-entity-instance-from-the-persistence-context"></a>3.3.6. Evicting an Entity Instance from the Persistence Context</h4>
<div class="paragraph">
<p>An entity instance is removed from the
persistence context by invoking the <code>detach</code> method on it or cascading
the detach operation. Changes made to the entity, if any (including
removal of the entity), will not be synchronized to the database after
such eviction has taken place.</p>
</div>
<div class="paragraph">
<p>Applications must use the <code>flush</code> method
prior to the <code>detach</code> method to ensure portable semantics if changes
have been made to the entity (including removal of the entity). Because
the persistence provider may write to the database at times other than
the explicit invocation of the <code>flush</code> method, portable applications
must not assume that changes have not been written to the database if
the <code>flush</code> method has not been called prior to detach.</p>
</div>
<div class="paragraph">
<p>The semantics of the detach operation,
applied to an entity X are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a managed entity, the detach
operation causes it to become detached. The detach operation is cascaded
to entities referenced by X if the relationships from X to these other
entities is annotated with the <code>cascade=DETACH</code> or <code>cascade=ALL</code>
annotation element value. Entities which previously referenced X will
continue to reference X.</p>
</li>
<li>
<p>If X is a new or detached entity, it is
ignored by the detach operation.</p>
</li>
<li>
<p>If X is a removed entity, the detach
operation causes it to become detached. The detach operation is cascaded
to entities referenced by X if the relationships from X to these other
entities is annotated with the <code>cascade=DETACH</code> or <code>cascade=ALL</code>
annotation element value. Entities which previously referenced X will
continue to reference X. Portable applications should not pass removed
entities that have been detached from the persistence context to further
EntityManager operations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a1982"><a class="anchor" href="#a1982"></a>3.3.7. Detached Entities</h4>
<div class="paragraph">
<p>A detached entity results from transaction
commit if a transaction-scoped persistence context is used (see <a href="#a2027">Section 3.4</a>);
from transaction rollback (see <a href="#a2049">Section 3.4.3</a>); from detaching
the entity from the persistence context; from clearing the persistence
context; from closing an entity manager; or from serializing an entity
or otherwise passing an entity by valuee.g., to a separate application
tier, through a remote interface, etc.</p>
</div>
<div class="paragraph">
<p>Detached entity instances continue to live
outside of the persistence context in which they were persisted or
retrieved. Their state is no longer guaranteed to be synchronized with
the database state.</p>
</div>
<div class="paragraph">
<p>The application may access the available
state of available detached entity instances after the persistence
context ends. The available state includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any persistent field or property not marked <code>fetch=LAZY</code></p>
</li>
<li>
<p>Any persistent field or property that was
accessed by the application or fetched by means of an entity graph</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the persistent field or property is an
association, the available state of an associated instance may only be
safely accessed if the associated instance is available. The available
instances include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any entity instance retrieved using <code>find()</code>.</p>
</li>
<li>
<p>Any entity instances retrieved using a query or explicitly requested in a fetch join.</p>
</li>
<li>
<p>Any entity instance for which an instance
variable holding non-primary-key persistent state was accessed by the
application.</p>
</li>
<li>
<p>Any entity instance that can be reached from
another available instance by navigating associations marked <code>fetch=EAGER</code>.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="a1983"><a class="anchor" href="#a1983"></a>3.3.7.1. Merging Detached Entity State</h5>
<div class="paragraph">
<p>The merge operation allows for the
propagation of state from detached entities onto persistent entities
managed by the entity manager.</p>
</div>
<div class="paragraph">
<p>The semantics of the merge operation applied
to an entity X are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a detached entity, the state of X is
copied onto a pre-existing managed entity instance X' of the same
identity or a new managed copy X' of X is created.</p>
</li>
<li>
<p>If X is a new entity instance, a new managed
entity instance X' is created and the state of X is <code>copied</code> into the
new managed entity instance X'.</p>
</li>
<li>
<p>If X is a removed entity instance, an
<code>IllegalArgumentException</code> will be thrown by the merge operation (or the
transaction commit will fail).</p>
</li>
<li>
<p>If X is a managed entity, it is ignored by
the merge operation, however, the merge operation is cascaded to
entities referenced by relationships from X if these relationships have
been annotated with the <code>cascade</code> element value <code>cascade=MERGE</code> or
<code>cascade=ALL</code> annotation.</p>
</li>
<li>
<p>For all entities Y referenced by
relationships from X having the <code>cascade</code> element value <code>cascade=MERGE</code>
or <code>cascade=ALL</code>, Y is merged recursively as Y'. For all such Y
referenced by X, X' is set to reference Y'. (Note that if X is managed
then X is the same object as X'.)</p>
</li>
<li>
<p>If X is an entity merged to X', with a
reference to another entity Y, where <code>cascade=MERGE</code> or <code>cascade=ALL</code> is
not specified, then navigation of the same association from X' yields a
reference to a managed object Y' with the same persistent identity as Y.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The persistence provider must not merge
fields marked LAZY that have not been fetched: it must ignore such
fields when merging.</p>
</div>
<div class="paragraph">
<p>Any <code>Version</code> columns used by the entity must
be checked by the persistence runtime implementation during the merge
operation and/or at flush or commit time. In the absence of <code>Version</code>
columns there is no additional version checking done by the persistence
provider runtime during the merge operation.</p>
</div>
</div>
<div class="sect4">
<h5 id="detached-entities-and-lazy-loading"><a class="anchor" href="#detached-entities-and-lazy-loading"></a>3.3.7.2. Detached Entities and Lazy Loading</h5>
<div class="paragraph">
<p>Serializing entities and merging those
entities back into a persistence context may not be interoperable across
vendors when lazy properties or fields and/or relationships are used.</p>
</div>
<div class="paragraph">
<p>A vendor is required to support the
serialization and subsequent deserialization and merging of detached
entity instances (which may contain lazy properties or fields and/or
relationships that have not been fetched) back into a separate JVM
instance of that vendor&#8217;s runtime, where both runtime instances have
access to the entity classes and any required vendor persistence
implementation classes.</p>
</div>
<div class="paragraph">
<p>When interoperability across vendors is
required, the application must not use lazy loading.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managed-instances"><a class="anchor" href="#managed-instances"></a>3.3.8. Managed Instances</h4>
<div class="paragraph">
<p>It is the responsibility of the application
to insure that an instance is managed in only a single persistence
context. The behavior is undefined if the same Java instance is made
managed in more than one persistence context.</p>
</div>
<div class="paragraph">
<p>The <code>contains()</code> method can be used to
determine whether an entity instance is managed in the current
persistence context.</p>
</div>
<div class="paragraph">
<p>The <code>contains</code> method returns true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the entity has been retrieved from the
database or has been returned by <code>getReference</code>, and has not been
removed or detached.</p>
</li>
<li>
<p>If the entity instance is new, and the
<code>persist</code> method has been called on the entity or the persist operation
has been cascaded to it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>contains</code> method returns false:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the instance is detached.</p>
</li>
<li>
<p>If the <code>remove</code> method has been called on the
entity, or the remove operation has been cascaded to it.</p>
</li>
<li>
<p>If the instance is new, and the <code>persist</code>
method has not been called on the entity or the persist operation has
not been cascaded to it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the effect of the cascading of
persist, merge, remove, or detach is immediately visible to the
<code>contains</code> method, whereas the actual insertion, modification, or
deletion of the database representation for the entity may be deferred
until the end of the transaction.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2019"><a class="anchor" href="#a2019"></a>3.3.9. Load State</h4>
<div class="paragraph">
<p>An entity is considered to be loaded if all
attributes with <code>FetchType.EAGER</code> whether explictly specified or by
default(including relationship and other collection-valued attributes)
have been loaded from the database or assigned by the application.
Attributes with <code>FetchType.LAZY</code> may or may not have been loaded. The
available state of the entity instance and associated instances is as
described in <a href="#a1982">Section 3.3.7</a>.</p>
</div>
<div class="paragraph">
<p>An attribute that is an embeddable is
considered to be loaded if the embeddable attribute was loaded from the
database or assigned by the application, and, if the attribute
references an embeddable instance (i.e., is not null), the embeddable
instance state is known to be loaded (i.e., all attributes of the
embeddable with <code>FetchType.EAGER</code> have been loaded from the database or
assigned by the application).</p>
</div>
<div class="paragraph">
<p>A collection-valued attribute is considered
to be loaded if the collection was loaded from the database or the value
of the attribute was assigned by the application, and, if the attribute
references a collection instance (i.e., is not null), each element of
the collection (e.g. entity or embeddable) is considered to be loaded.</p>
</div>
<div class="paragraph">
<p>A single-valued relationship attribute is
considered to be loaded if the relationship attribute was loaded from
the database or assigned by the application, and, if the attribute
references an entity instance (i.e., is not null), the entity instance
state is known to be loaded.</p>
</div>
<div class="paragraph">
<p>A basic attribute is considered to be loaded
if its state has been loaded from the database or assigned by the
application.</p>
</div>
<div class="paragraph">
<p>The <code>PersistenceUtil.isLoaded</code> methods can be
used to determine the load state of an entity and its attributes
regardless of the persistence unit with which the entity is associated.
The <code>PersistenceUtil.isLoaded</code> methods return true if the above
conditions hold, and false otherwise. If the persistence unit is known,
the <code>PersistenceUnitUtil.isLoaded</code> methods can be used instead. See <a href="#a12177">Section 7.11</a>.</p>
</div>
<div class="paragraph">
<p>Persistence provider contracts for
determining the load state of an entity or entity attribute are
described in <a href="#a13592">Section 9.9.1</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2027"><a class="anchor" href="#a2027"></a>3.4. Persistence Context Lifetime and Synchronization Type</h3>
<div class="paragraph">
<p>The lifetime of a container-managed
persistence context can either be scoped to a transaction
(transaction-scoped persistence context), or have a lifetime scope that
extends beyond that of a single transaction (extended persistence
context). The enum <code>PersistenceContextType</code> is used to define the
persistence context lifetime scope for container-managed entity
managers. The persistence context lifetime scope is defined when the
EntityManager instance is created (whether explicitly, or in conjunction
with injection or JNDI lookup). See <a href="#a11791">Section 7.7</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Specifies whether a transaction-scoped or extended persistence
 * context is to be used in {@link PersistenceContext}. If not
 * specified, a transaction-scoped persistence context is used.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> PersistenceContextType {

    <span class="comment">/** Transaction-scoped persistence context */</span>
    TRANSACTION,

    <span class="comment">/** Extended persistence context */</span>
    EXTENDED
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the lifetime of the persistence
context of a container-managed entity manager corresponds to the scope
of a transaction (i.e., it is of type
<code>PersistenceContextType.TRANSACTION</code>).</p>
</div>
<div class="paragraph">
<p>When an extended persistence context is used,
the extended persistence context exists from the time the EntityManager
instance is created until it is closed. This persistence context might
span multiple transactions and non-transactional invocations of the
EntityManager.</p>
</div>
<div class="paragraph">
<p>An EntityManager with an extended persistence
context maintains its references to the entity objects after a
transaction has committed. Those objects remain managed by the
EntityManager, and they can be updated as managed objects between
transactions.<sup class="footnote">[<a id="_footnoteref_34" class="footnote" href="#_footnotedef_34" title="View footnote.">34</a>]</sup> Navigation from a managed object in
an extended persistence context results in one or more other managed
objects regardless of whether a transaction is active.</p>
</div>
<div class="paragraph">
<p>When an EntityManager with an extended
persistence context is used, the persist, remove, merge, and refresh
operations can be called regardless of whether a transaction is active.
The effects of these operations will be committed to the database when
the extended persistence context is enlisted in a transaction and the
transaction commits.</p>
</div>
<div class="paragraph">
<p>The scope of the persistence context of an
application-managed entity manager is extended. It is the responsibility
of the application to manage the lifecycle of the persistence context.</p>
</div>
<div class="paragraph">
<p>Container-managed persistence contexts are
described further in <a href="#a11791">Section 7.7</a>. Persistence contexts managed by
the application are described further in <a href="#a11894">Section 7.8</a>.</p>
</div>
<div class="sect3">
<h4 id="synchronization-with-the-current-transaction"><a class="anchor" href="#synchronization-with-the-current-transaction"></a>3.4.1. Synchronization with the Current Transaction</h4>
<div class="paragraph">
<p>By default, a container-managed persistence
context is of <code>SynchronizationType.SYNCHRONIZED</code> and is automatically
joined to the current transaction. A persistence context of
<code>SynchronizationType.UNSYNCHRONIZED</code> will not be enlisted in the current
transaction, unless the <code>EntityManager</code> <code>joinTransaction</code> method is
invoked.</p>
</div>
<div class="paragraph">
<p>By default, an application-managed
persistence context that is associated with a JTA entity manager and
that is created within the scope of an active transaction is
automatically joined to that transaction. An application-managed JTA
persistence context that is created outside the scope of a transaction
or an application-managed persistence context of type
<code>SynchronizationType.UNSYNCHRONIZED</code> will not be joined to that
transaction unless the <code>EntityManager</code> <code>joinTransaction</code> method is
invoked.</p>
</div>
<div class="paragraph">
<p>An application-managed persistence context
associated with a resource-local entity manager is always automatically
joined to any resource-local transaction that is begun for that entity
manager.</p>
</div>
<div class="paragraph">
<p>Persistence context synchronization type is
described further in <a href="#a11797">Section 7.7.1</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="transaction-commit"><a class="anchor" href="#transaction-commit"></a>3.4.2. Transaction Commit</h4>
<div class="paragraph">
<p>The managed entities of a transaction-scoped
persistence context become detached when the transaction commits; the
managed entities of an extended persistence context remain managed.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2049"><a class="anchor" href="#a2049"></a>3.4.3. Transaction Rollback</h4>
<div class="paragraph">
<p>For both transaction-scoped
persistence contexts and for extended persistence contexts that are
joined to the current transaction, transaction rollback causes all
<em>pre-existing</em> managed instances and removed
instances<sup class="footnote">[<a id="_footnoteref_35" class="footnote" href="#_footnotedef_35" title="View footnote.">35</a>]</sup> to become detached. The instances'
state will be the state of the instances at the point at which the
transaction was rolled back. Transaction rollback typically causes the
persistence context to be in an inconsistent state at the point of
rollback. In particular, the state of version attributes and generated
state (e.g., generated primary keys) may be inconsistent. Instances that
were formerly managed by the persistence context (including new
instances that were made persistent in that transaction) may therefore
not be reusable in the same manner as other detached objectsfor
example, they may fail when passed to the merge
operation.<sup class="footnote">[<a id="_footnoteref_36" class="footnote" href="#_footnotedef_36" title="View footnote.">36</a>]</sup></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because a transaction-scoped
persistence context&#8217;s lifetime is scoped to a transaction regardless of
whether it is joined to that transaction, the container closes the
persistence context upon transaction rollback. However, an extended
persistence context that is not joined to a transaction is unaffected by
transaction rollback.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2052"><a class="anchor" href="#a2052"></a>3.5. Locking and Concurrency</h3>
<div class="paragraph">
<p>This specification assumes the use of
optimistic concurrency control. It assumes that the databases to which
persistence units are mapped will be accessed by the implementation
using read-committed isolation (or a vendor equivalent in which
long-term read locks are not held), and that writes to the database will
typically occur only when the <code>flush</code> method has been invokedwhether
explicitly by the application, or by the persistence provider runtime in
accordance with the flush mode setting.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a transaction is active and the
persistence context is joined to the transaction, a compliant
implementation of this specification is permitted to write to the
database immediately (i.e., whenever a managed entity is updated,
created, and/or removed), however, the configuration of an
implementation to require such non-deferred database writes is outside
the scope of this specification.<sup class="footnote">[<a id="_footnoteref_37" class="footnote" href="#_footnotedef_37" title="View footnote.">37</a>]</sup></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In addition, both pessimistic and optimistic
locking are supported for selected entities by means of specified lock
modes. Optimistic locking is described in <a href="#a2056">Section 3.5.1</a> and <a href="#a2059">Section 3.5.2</a>; pessimistic locking
in <a href="#a2066">Section 3.5.3</a>. <a href="#a2084">Section 3.5.4</a> describes the setting of
optimistic and pessimistic lock modes. The configuration of the setting
of optimistic lock modes is described in <a href="#a2100">Section 3.5.4.1</a>,
and the configuration of the setting of pessimistic lock modes is
described in <a href="#a2113">Section 3.5.4.2</a>.</p>
</div>
<div class="sect3">
<h4 id="a2056"><a class="anchor" href="#a2056"></a>3.5.1. Optimistic Locking</h4>
<div class="paragraph">
<p><em>Optimistic locking</em> is a system of concurrency control where each
revision of an item of data is assigned a version number or timestamp.
When the data is read and then updated within a given unit of work,
the version or timestamp is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>read from the database when the data itself is read, and</p>
</li>
<li>
<p>verified and then updated in the database when the data is updated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Similarly, when the data is read and then deleted within a given unit
of work, the version or timestamp is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>read from the database when the data itself is read, and</p>
</li>
<li>
<p>verified when the data is deleted.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An <em>optimistic lock failure</em> occurs when verification fails, that is,
if the version or timestamp held in the database changes between
reading the data (step 1), and attempting to update or delete the data
(step 2).</p>
</div>
<div class="paragraph">
<p>Thus, the unit of work is prevented from updating the data and creating
a new revision, or from deleting the data, unless the revision it
previously obtained is still the current revision. Optimistic lock
verification ensures that an update of a given item is successful only
when no intervening transaction has already updated the item, preventing
the loss of updates made by such intervening transactions.</p>
</div>
<div class="paragraph">
<p>The persistence provider is required to perform optimistic locking
automatically for every entity with a version, as defined in <a href="#a2060">Section 2.5</a>.
A portable application which wishes to take advantage of automatic
optimistic locking must specify a version field or property for each
optimistically-locked entity using the <code>@Version</code> annotation defined in
<a href="#a16432">Section 11.1.57</a> or equivalent XML element.</p>
</div>
<div class="paragraph">
<p>When an optimistic lock failure is detected, the persistence provider
must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>throw an <code>OptimisticLockException</code> and</p>
</li>
<li>
<p>mark the current transaction for rollback.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A persistence provider might offer alternative implementations of
optimistic locking, which do not depend on the entity having a version,
but such functionality is not portable between providers.<sup class="footnote">[<a id="_footnoteref_38" class="footnote" href="#_footnotedef_38" title="View footnote.">38</a>]</sup></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Applications are strongly encouraged to enable optimistic locking for
every entity which may be concurrently accessed or which may be merged
from a detached state. Failure to make use of optimistic locking often
leads to inconsistent entity state, lost updates, and other anomalies.
If an entity does not have a version, the application itself must bear
the burden of maintaining data consistency during optimistic units of
work.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the purposes of versioning and optimistic locking, the state of a
given entity is considered to include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>every persistent field or property which is not a relationship to
another entity, and</p>
</li>
<li>
<p>every relationship owned by the entity, as defined by <a href="#a516">Section 2.11</a>.
<sup class="footnote">[<a id="_footnoteref_39" class="footnote" href="#_footnotedef_39" title="View footnote.">39</a>]</sup></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unowned relationships are not considered part of the state of the entity.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2059"><a class="anchor" href="#a2059"></a>3.5.2. Entity Versions and Optimistic Locking</h4>
<div class="paragraph">
<p>The entity version must be updated by the persistence provider each
time the state of an entity instance is written to the database.
<sup class="footnote">[<a id="_footnoteref_40" class="footnote" href="#_footnotedef_40" title="View footnote.">40</a>]</sup>
Furthermore, if the current persistence context contains a revision
of the entity instance when the instance is written to the database,
the persistence provider must verify that the revision held in the
persistence context is identical to the revision held in the database
by comparing the versions held in memory and in the database.
<sup class="footnote">[<a id="_footnoteref_41" class="footnote" href="#_footnotedef_41" title="View footnote.">41</a>]</sup> If the versions do not match, the persistence
provider must thow an <code>OptimisticLockException</code>.</p>
</div>
<div class="paragraph">
<p>The persistence provider must examine the version field or property of
a detached entity instance when it is merged, as defined in <a href="#a1983">Section 3.3.7.1</a>,
and throw an <code>OptimisticLockException</code> if the instance being merged
holds a stale revision of the state of the entity&#8212;&#8203;that is, if the
entity was updated since the entity instance became detached. The
timing of this version check is provider-dependent:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the version check might occur synchronously with the call to <code>merge()</code>,
or</p>
</li>
<li>
<p>a provider might choose to delay the version check until a flush
operation occurs, as defined in <a href="#a1955">Section 3.3.4</a>, or until the transaction
commits.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If an update or merge operation involves entities with versions, and
entities without versions, the persistence provider runtime is only
required to perform optimistic lock verification for those entities
which do have a version, and the consistency of the whole object graph
is not guaranteed. The absence a version for some entity involved in
the update or merge operation does not impede completion of the
operation.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2066"><a class="anchor" href="#a2066"></a>3.5.3. Pessimistic Locking</h4>
<div class="paragraph">
<p>While optimistic locking is typically
appropriate in dealing with moderate contention among concurrent
transactions, in some applications it may be useful to immediately
obtain long-term database locks for selected entities because of the
often late failure of optimistic transactions. Such immediately obtained
long-term database locks are referred to here as pessimistic
locks.<sup class="footnote">[<a id="_footnoteref_42" class="footnote" href="#_footnotedef_42" title="View footnote.">42</a>]</sup></p>
</div>
<div class="paragraph">
<p>Pessimistic locking guarantees that once a
transaction has obtained a pessimistic lock on an entity instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>no other transaction (whether a transaction
of an application using the Jakarta Persistence API or any other
transaction using the underlying resource) may successfully modify or
delete that instance until the transaction holding the lock has ended.</p>
</li>
<li>
<p>if the pessimistic lock is an exclusive
lock<sup class="footnote">[<a id="_footnoteref_43" class="footnote" href="#_footnotedef_43" title="View footnote.">43</a>]</sup>,
that same transaction may modify or delete
that entity instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When an entity instance is locked using
pessimistic locking, the persistence provider must lock the database
row(s) that correspond to the non-collection-valued persistent state of
that instance. If a joined inheritance strategy is used, or if the
entity is otherwise mapped to a secondary table, this entails locking
the row(s) for the entity instance in the additional table(s). Entity
relationships for which the locked entity contains the foreign key will
also be locked, but not the state of the referenced entities (unless
those entities are explicitly locked). Element collections and
relationships for which the entity does not contain the foreign key
(such as relationships that are mapped to join tables or unidirectional
one-to-many relationships for which the target entity contains the
foreign key) will not be locked by default.</p>
</div>
<div class="paragraph">
<p>Element collections and relationships owned
by the entity that are contained in join tables will be locked if the
<code>jakarta.persistence.lock.scope</code> property is specified with a value of
<code>PessimisticLockScope.EXTENDED</code>. The state of entities referenced by
such relationships will not be locked (unless those entities are
explicitly locked). This property may be passed as an argument to the
methods of the <code>EntityManager</code>, <code>Query</code>, and <code>TypedQuery</code> interfaces
that allow lock modes to be specified or used with the <code>NamedQuery</code>
annotation.</p>
</div>
<div class="paragraph">
<p>Locking such a relationship or element
collection generally locks only the rows in the join table or collection
table for that relationship or collection. This means that phantoms will
be possible.</p>
</div>
<div class="paragraph">
<p>The values of the
<code>jakarta.persistence.lock.scope</code> property are defined by the
<code>PessimisticLockScope</code> enum.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 *
 * Defines the values of the {@code jakarta.persistence.lock.scope}
 * property for pessimistic locking.  This property may be passed as an
 * argument to the methods of the {@link EntityManager}, {@link Query},
 * and {@link TypedQuery} interfaces that allow lock modes to be specified
 * or used with the {@link NamedQuery} annotation.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> PessimisticLockScope <span class="directive">implements</span> FindOption, RefreshOption, LockOption {

    <span class="comment">/**
     * This value defines the default behavior for pessimistic locking.
     *
     * &lt;p&gt;The persistence provider must lock the database row(s) that
     * correspond to the non-collection-valued persistent state of
     * that instance. If a joined inheritance strategy is used, or if
     * the entity is otherwise mapped to a secondary table, this
     * entails locking the row(s) for the entity instance in the
     * additional table(s). Entity relationships for which the locked
     * entity contains the foreign key will also be locked, but not
     * the state of the referenced entities (unless those entities are
     * explicitly locked). Element collections and relationships for
     * which the entity does not contain the foreign key (such as
     * relationships that are mapped to join tables or unidirectional
     * one-to-many relationships for which the target entity contains
     * the foreign key) will not be locked by default.
     */</span>
    NORMAL,

    <span class="comment">/**
     * In addition to the locking behavior specified for {@link #NORMAL},
     * element collections and relationships owned by the entity that
     * are contained in join tables are locked if the property
     * {@code jakarta.persistence.lock.scope} is specified with a value
     * of {@code PessimisticLockScope#EXTENDED}. The state of entities
     * referenced by such relationships is not locked (unless those
     * entities are explicitly locked). Locking such a relationship or
     * element collection generally locks only the rows in the join table
     * or collection table for that relationship or collection. This means
     * that phantoms are possible.
     */</span>
    EXTENDED
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This specification does not define the
mechanisms a persistence provider uses to obtain database locks, and a
portable application should not rely on how pessimistic locking is
achieved on the database.<sup class="footnote">[<a id="_footnoteref_44" class="footnote" href="#_footnotedef_44" title="View footnote.">44</a>]</sup> In particular, a
persistence provider or the underlying database management system may
lock more rows than the ones selected by the application.</p>
</div>
<div class="paragraph">
<p>Whenever a pessimistically locked entity
containing a version attribute is updated on the database, the
persistence provider must also update (increment) the entity&#8217;s version
column to enable correct interaction with applications using optimistic
locking. See <a href="#a2059">Section 3.5.2</a> and <a href="#a2084">Section 3.5.4</a>.</p>
</div>
<div class="paragraph">
<p>Pessimistic locking may be applied to
entities that do not contain version attributes. However, in this case
correct interaction with applications using optimistic locking cannot be
ensured.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2084"><a class="anchor" href="#a2084"></a>3.5.4. Lock Modes</h4>
<div class="paragraph">
<p>Lock modes are intended to provide a facility
that enables the effect of repeatable read semantics for the items
read, whether optimistically (as described in <a href="#a2100">Section 3.5.4.1</a>)
or pessimistically (as described in <a href="#a2113">Section 3.5.4.2</a>).</p>
</div>
<div class="paragraph">
<p>A lock mode may be explicitly specified as an argument to the
<code>lock()</code> method of <code>EntityManager</code> or to any other method of
<code>EntityManager</code>, <code>Query</code>, and <code>TypedQuery</code> which accepts a lock
mode, or via the <code>NamedQuery</code> annotation.</p>
</div>
<div class="paragraph">
<p>Lock mode values are defined by the <code>LockModeType</code> enum which may
be found in <a href="#_lockmodetype_">Section B.4</a>. Six distinct lock modes are defined.
<sup class="footnote">[<a id="_footnoteref_45" class="footnote" href="#_footnotedef_45" title="View footnote.">45</a>]</sup>
The lock mode type values <code>READ</code> and <code>WRITE</code> are synonyms for
<code>OPTIMISTIC</code> and <code>OPTIMISTIC_FORCE_INCREMENT</code> respectively.
The latter are to be preferred for new applications.</p>
</div>
<div class="sect4">
<h5 id="a2100"><a class="anchor" href="#a2100"></a>3.5.4.1. OPTIMISTIC, OPTIMISTIC_FORCE_INCREMENT</h5>
<div class="paragraph">
<p>The lock modes <code>OPTIMISTIC</code> and
<code>OPTIMISTIC_FORCE_INCREMENT</code> are used for optimistic locking. The lock
mode type values <code>READ</code> and <code>WRITE</code> are synonymous with <code>OPTIMISTIC</code> and
<code>OPTIMISTIC_FORCE_INCREMENT</code> respectively.</p>
</div>
<div class="paragraph">
<p>The semantics of requesting locks of type
<code>LockModeType.OPTIMISTIC</code> and <code>LockModeType.OPTIMISTIC_FORCE_INCREMENT</code>
are the following.</p>
</div>
<div class="paragraph">
<p>If transaction T1 calls <code>lock(entity, LockModeType.OPTIMISTIC)</code> on a
versioned object, the entity manager
must ensure that neither of the following phenomena can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>P1 (Dirty read): Transaction T1 modifies a
row. Another transaction T2 then reads that row and obtains the modified
value, before T1 has committed or rolled back. Transaction T2 eventually
commits successfully; it does not matter whether T1 commits or rolls
back and whether it does so before or after T2 commits.</p>
</li>
<li>
<p>P2 (Non-repeatable read): Transaction T1
reads a row. Another transaction T2 then modifies or deletes that row,
before T1 has committed. Both transactions eventually commit
successfully.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This will generally be achieved by the entity
manager acquiring a lock on the underlying database row. While with
optimistic concurrency concurrency, long-term database read locks are
typically not obtained immediately, a compliant implementation is
permitted to obtain an immediate lock (so long as it is retained until
commit completes). If the lock is deferred until commit time, it must be
retained until the commit completes. Any implementation that supports
repeatable reads in a way that prevents the above phenomena is
permissible.</p>
</div>
<div class="paragraph">
<p>The persistence implementation is not
required to support calling <code>lock(entity, LockModeType.OPTIMISTIC)</code> on
a non-versioned object. When it cannot support such a lock call, it must
throw the <code>PersistenceException</code>. When supported, whether for versioned
or non-versioned objects, <code>LockModeType.OPTIMISTIC</code> must always prevent
the phenomena P1 and P2. Applications that call
<code>lock(entity, LockModeType.OPTIMISTIC)</code> on non-versioned objects are not
portable.</p>
</div>
<div class="paragraph">
<p>If transaction T1 calls <code>lock(entity, LockModeType.OPTIMISTIC_FORCE_INCREMENT)</code>
on a versioned object, the entity manager must avoid the phenomena P1 and P2
(as with <code>LockModeType.OPTIMISTIC</code>) and must also force an update (increment) to
the entity&#8217;s version column. A forced version update may be performed
immediately, or may be deferred until a flush or commit. If an entity is
removed before a deferred version update was to have been applied, the
forced version update is omitted.</p>
</div>
<div class="paragraph">
<p>The persistence implementation is not required to support calling
<code>lock(entity, LockModeType.OPTIMISTIC_FORCE_INCREMENT)</code> on a non-versioned
object. When it cannot support such a lock call, it must throw the
<code>PersistenceException</code>. When supported, whether for versioned or
non-versioned objects, <code>LockModeType.OPTIMISTIC_FORCE_INCREMENT</code> must
always prevent the phenomena P1 and P2. For non-versioned objects,
whether or not <code>LockModeType.OPTIMISTIC_FORCE_INCREMENT</code> has any
additional behavior is vendor-specific. Applications that call
`lock(entity, LockModeType.OPTIMISTIC_FORCE_INCREMENT)_ on non-versioned
objects will not be portable.</p>
</div>
<div class="paragraph">
<p>For versioned objects, it is permissible for
an implementation to use <code>LockModeType.OPTIMISTIC_FORCE_INCREMENT</code> where
<code>LockModeType.OPTIMISTIC</code> was requested, but not vice versa.</p>
</div>
<div class="paragraph">
<p>If a versioned object is otherwise updated or
removed, then the implementation must ensure that the requirements of
<code>LockModeType.OPTIMISTIC_FORCE_INCREMENT</code> are met, even if no explicit
call to <code>EntityManager.lock</code> was made.</p>
</div>
<div class="paragraph">
<p>For portability, an application should not
depend on vendor-specific hints or configuration to ensure repeatable
read for objects that are not updated or removed via any mechanism other
than the use of version attributes and the EntityManager <code>lock</code> method.
However, it should be noted that if an implementation has acquired
up-front pessimistic locks on some database rows, then it is free to
ignore <code>lock(entity, LockModeType.OPTIMISTIC)</code> calls on the entity
objects representing those rows.</p>
</div>
</div>
<div class="sect4">
<h5 id="a2113"><a class="anchor" href="#a2113"></a>3.5.4.2. PESSIMISTIC_READ, PESSIMISTIC_WRITE, PESSIMISTIC_FORCE_INCREMENT</h5>
<div class="paragraph">
<p>The lock modes <code>PESSIMISTIC_READ</code>,
<code>PESSIMISTIC_WRITE</code>, and <code>PESSIMISTIC_FORCE_INCREMENT</code> are used to
immediately obtain long-term database locks.<sup class="footnote">[<a id="_footnoteref_46" class="footnote" href="#_footnotedef_46" title="View footnote.">46</a>]</sup></p>
</div>
<div class="paragraph">
<p>The semantics of requesting locks of type
<code>LockModeType.PESSIMISTIC_READ</code>, <code>LockModeType.PESSIMISTIC_WRITE</code>, and
<code>LockModeType.PESSIMISTIC_FORCE_INCREMENT</code> are the following.</p>
</div>
<div class="paragraph">
<p>If transaction T1 calls <code>lock(entity, LockModeType.PESSIMISTIC_READ)</code> or
<code>lock(entity, LockModeType.PESSIMISTIC_WRITE)</code> on an object, the entity
manager must ensure that neither of the following phenomena can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>P1 (Dirty read): Transaction T1 modifies a
row. Another transaction T2 then reads that row and obtains the modified
value, before T1 has committed or rolled back.</p>
</li>
<li>
<p>P2 (Non-repeatable read): Transaction T1
reads a row. Another transaction T2 then modifies or deletes that row,
before T1 has committed or rolled back.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any such lock must be obtained immediately
and retained until transaction T1 completes (commits or rolls back).</p>
</div>
<div class="paragraph">
<p>Avoidance of phenomena P1 and P2 is generally
achieved by the entity manager acquiring a long-term lock on the
underlying database row(s). Any implementation that supports pessimistic
repeatable reads as described above is permissible.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A lock with <code>LockModeType.PESSIMISTIC_WRITE</code>
can be obtained on an entity instance to force serialization among
transactions attempting to update the entity data. A lock with
<code>LockModeType.PESSIMISTIC_READ</code> can be used to query data using
repeatable-read semantics without the need to reread the data at the end
of the transaction to obtain a lock, and without blocking other
transactions reading the data. A lock with
<code>LockModeType.PESSIMISTIC_WRITE</code> can be used when querying data and
there is a high likelihood of deadlock or update failure among
concurrent updating transactions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The persistence implementation must support
calling <code>lock(entity, LockModeType.PESSIMISTIC_READ)</code> and <code>lock(entity,
LockModeType.PESSIMISTIC_WRITE)</code> on a non-versioned entity as well as on
a versioned entity.</p>
</div>
<div class="paragraph">
<p>It is permissible for an implementation to
use <code>LockModeType.PESSIMISTIC_WRITE</code> where
<code>LockModeType.PESSIMISTIC_READ</code> was requested, but not vice versa.</p>
</div>
<div class="paragraph">
<p>When the lock cannot be obtained, and the
database locking failure results in transaction-level rollback, the
provider must throw the <code>PessimisticLockException</code> and ensure that the
JTA transaction or EntityTransaction has been marked for rollback.</p>
</div>
<div class="paragraph">
<p>When the lock cannot be obtained, and the
database locking failure results in only statement-level rollback, the
provider must throw the <code>LockTimeoutException</code> (and must not mark the
transaction for rollback).</p>
</div>
<div class="paragraph">
<p>When an application locks an entity with
<code>LockModeType.PESSIMISTIC_READ</code> and later updates that entity, the lock
must be converted to an exclusive lock when the entity is flushed to the
database.<sup class="footnote">[<a id="_footnoteref_47" class="footnote" href="#_footnotedef_47" title="View footnote.">47</a>]</sup> If the lock conversion fails, and the
database locking failure results in transaction-level rollback, the
provider must throw the <code>PessimisticLockException</code> and ensure that the
JTA transaction or EntityTransaction has been marked for rollback. When
the lock conversion fails, and the database locking failure results in
only statement-level rollback, the provider must throw the
<code>LockTimeoutException</code> (and must not mark the transaction for
rollback).</p>
</div>
<div class="paragraph">
<p>When <code>lock(entity, LockModeType.PESSIMISTIC_READ)</code>,
<code>lock(entity, LockModeType.PESSIMISTIC_WRITE)</code>, or
<code>lock(entity, LockModeType.PESSIMISTIC_FORCE_INCREMENT)</code>
is invoked on a versioned
entity that is already in the persistence context, the provider must
also perform optimistic version checks when obtaining the lock. An
<code>OptimisticLockException</code> must be thrown if the version checks fail.
Depending on the implementation strategy used by the provider, it is
possible that this exception may not be thrown until flush is called or
commit time, whichever occurs first.</p>
</div>
<div class="paragraph">
<p>If transaction T1 calls
<code>lock(entity, LockModeType.PESSIMISTIC_FORCE_INCREMENT)</code> on a versioned
object, the entity manager must avoid the phenomenon P1 and P2 (as with
<code>LockModeType.PESSIMISTIC_READ</code> and <code>LockModeType.PESSIMISTIC_WRITE</code>)
and must also force an update (increment) to the entity&#8217;s version
column.</p>
</div>
<div class="paragraph">
<p>The persistence implementation is not required to support calling
<code>lock(entity, LockModeType.PESSIMISTIC_FORCE_INCREMENT)</code> on a non-versioned
object. When it cannot support such a lock call, it must throw the
<code>PersistenceException</code>. When supported, whether for versioned or
non-versioned objects, <code>LockModeType.PESSIMISTIC_FORCE_INCREMENT</code> must
always prevent the phenomena P1 and P2. For non-versioned objects,
whether or not <code>LockModeType.PESSIMISTIC_FORCE_INCREMENT</code> has any
additional behavior is vendor-specific. Applications that call
<code>lock(entity, LockModeType.PESSIMISTIC_FORCE_INCREMENT)</code> on
non-versioned objects will not be portable.</p>
</div>
<div class="paragraph">
<p>For versioned objects, it is permissible for
an implementation to use <code>LockModeType.PESSIMISTIC_FORCE_INCREMENT</code>
where <code>LockModeType.PESSIMISTIC_READ</code> or
<code>LockModeType.PESSIMISTIC_WRITE</code> was requested, but not vice versa.</p>
</div>
<div class="paragraph">
<p>If a versioned object locked with
<code>LockModeType.PESSIMISTIC_READ</code> or <code>LockModeType.PESSIMISTIC_WRITE</code> is
updated, then the implementation must ensure that the requirements of
<code>LockModeType.PESSIMISTIC_FORCE_INCREMENT</code> are met.</p>
</div>
</div>
<div class="sect4">
<h5 id="a2132"><a class="anchor" href="#a2132"></a>3.5.4.3. Lock Mode Properties and Uses</h5>
<div class="paragraph">
<p>The following property is defined by this
specification for use in pessimistic locking, as described in <a href="#a2066">Section 3.5.3</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jakarta.persistence.lock.scope</code></pre>
</div>
</div>
<div class="paragraph">
<p>This property may be used with the methods of
the <code>EntityManager</code> interface that allow lock modes to be specified, the
<code>Query</code> and <code>TypedQuery</code> <code>setLockMode</code> methods, and the <code>NamedQuery</code>
annotation. When specified, this property must be observed. The provider
is permitted to lock more (but not fewer) rows than requested.</p>
</div>
<div class="paragraph">
<p>The following hint is defined by this
specification for use in pessimistic locking.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jakarta.persistence.lock.timeout <span class="comment">// time in milliseconds</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This hint may be used with the methods of the
<code>EntityManager</code> interface that allow lock modes to be specified, the
<code>Query.setLockMode</code> method and the <code>NamedQuery</code> annotation. It may also
be passed as a property to the <code>Persistence.createEntityManagerFactory</code>
method and used in the <code>properties</code> element of the <code>persistence.xml</code>
file. See <a href="#a1066">Section 3.2</a>, <a href="#a4385">Section 3.11.3</a>, <a href="#a12384">Section 8.2.1.11</a>, <a href="#a13443">Section 9.7</a>,
and <a href="#a13711">Section 10.4.1</a>. When used in
the <code>createEntityManagerFactory</code> method, the <code>persistence.xml</code> file, and
the <code>NamedQuery</code> annotation, the timeout hint serves as a default value
which can be selectively overridden by use in the methods of the
<code>EntityManager</code>, <code>Query</code>, and <code>TypedQuery</code> interfaces as specified
above. When this hint is not specified, database timeout values are
assumed to apply.</p>
</div>
<div class="paragraph">
<p>A timeout value of <code>0</code> is used to specify no wait locking.</p>
</div>
<div class="paragraph">
<p>Portable applications should not rely on this
hint. Depending on the database in use and the locking mechanisms used
by the persistence provider, the hint may or may not be observed.</p>
</div>
<div class="paragraph">
<p>Vendors are permitted to support the use of
additional, vendor-specific locking hints. Vendor-specific hints must
not use the <code>jakarta.persistence</code> namespace. Vendor-specific hints must be
ignored if they are not understood.</p>
</div>
<div class="paragraph">
<p>If the same property or hint is specified
more than once, the following order of overriding applies, in order of
decreasing precedence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>argument to method of <code>EntityManager</code>, <code>Query</code>, or <code>TypedQuery</code> interface</p>
</li>
<li>
<p>specification to <code>NamedQuery</code> (annotation or XML)</p>
</li>
<li>
<p>argument to <code>createEntityManagerFactory</code> method</p>
</li>
<li>
<p>specification in <code>persistence.xml</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="optimisticlockexception"><a class="anchor" href="#optimisticlockexception"></a>3.5.5. OptimisticLockException</h4>
<div class="paragraph">
<p>Provider implementations may defer writing to
the database until the end of the transaction, when consistent with the
lock mode and flush mode settings in effect. In this case, an optimistic
lock check may not occur until commit time, and the
<code>OptimisticLockException</code> may be thrown in the before completion phase
of the commit. If the <code>OptimisticLockException</code> must be caught or
handled by the application, the <code>flush</code> method should be used by the
application to force the database writes to occur. This will allow the
application to catch and handle optimistic lock exceptions.</p>
</div>
<div class="paragraph">
<p>The <code>OptimisticLockException</code> provides an API
to return the object that caused the exception to be thrown. The object
reference is not guaranteed to be present every time the exception is
thrown but should be provided whenever the persistence provider can
supply it. Applications cannot rely upon this object being available.</p>
</div>
<div class="paragraph">
<p>In some cases an <code>OptimisticLockException</code>
will be thrown and wrapped by another exception, such as a
<code>RemoteException</code>, when VM boundaries are crossed. Entities that may be
referenced in wrapped exceptions should implement <code>Serializable</code> so that
marshalling will not fail.</p>
</div>
<div class="paragraph">
<p>An <code>OptimisticLockException</code> always causes
the transaction to be marked for rollback.</p>
</div>
<div class="paragraph">
<p>Refreshing objects or reloading objects in a
new transaction context and then retrying the transaction is a potential
response to an <code>OptimisticLockException</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2153"><a class="anchor" href="#a2153"></a>3.6. Entity Listeners and Callback Methods</h3>
<div class="paragraph">
<p>A method may be designated as a lifecycle
callback method to receive notification of entity lifecycle events. A
lifecycle callback method can be defined on an entity class, a mapped
superclass, or an entity listener class associated with an entity or
mapped superclass. An entity listener class is a class whose methods are
invoked in response to lifecycle events on an entity. Any number of
entity listener classes can be defined for an entity class or mapped
superclass.</p>
</div>
<div class="paragraph">
<p>Default entity listenersentity listener
classes whose callback methods apply to all entities in the persistence
unitcan be specified by means of the XML descriptor.</p>
</div>
<div class="paragraph">
<p>Lifecycle callback methods and entity
listener classes are defined by means of metadata annotations or the XML
descriptor. When annotations are used, one or more entity listener
classes are denoted using the <code>EntityListeners</code> annotation on the entity
class or mapped superclass. If multiple entity listeners are defined,
the order in which they are invoked is determined by the order in which
they are specified in the <code>EntityListeners</code> annotation. The XML
descriptor may be used as an alternative to specify the invocation order
of entity listeners or to override the order specified in metadata
annotations.</p>
</div>
<div class="paragraph">
<p>Any subset or combination of annotations may
be specified on an entity class, mapped superclass, or listener class. A
single class must not have more than one lifecycle callback method for
the same lifecycle event. The same method may be used for multiple
callback events.</p>
</div>
<div class="paragraph">
<p>Multiple entity classes and mapped
superclasses in an inheritance hierarchy may define listener classes
and/or lifecycle callback methods directly on the class. <a href="#a2251">Section 3.6.4</a>
describes the rules that apply to method invocation order in this case.</p>
</div>
<div class="sect3">
<h4 id="entity-listeners"><a class="anchor" href="#entity-listeners"></a>3.6.1. Entity Listeners</h4>
<div class="paragraph">
<p>The entity listener class must have a public no-arg constructor.</p>
</div>
<div class="paragraph">
<p>Entity listener classes in Jakarta EE
environments support dependency injection through the Contexts and
Dependency Injection API (CDI) <a href="#a19500">[7]</a> when CDI is
enabled<sup class="footnote">[<a id="_footnoteref_48" class="footnote" href="#_footnotedef_48" title="View footnote.">48</a>]</sup>. An entity listener class that makes use
of CDI injection may also define lifecycle callback methods annotated
with the <code>PostConstruct</code> and <code>PreDestroy</code> annotations. These methods
will be invoked after injection has taken place and before the entity
listener instance is destroyed respectively.</p>
</div>
<div class="paragraph">
<p>The persistence provider is responsible for
using the CDI SPI to create instances of the entity listener class; to
perform injection upon such instances; to invoke their <code>PostConstruct</code>
and <code>PreDestroy</code> methods, if any; and to dispose of the entity listener
instances.</p>
</div>
<div class="paragraph">
<p>The persistence provider is only required to
support CDI injection into entity listeners in Jakarta EE container
environments<sup class="footnote">[<a id="_footnoteref_49" class="footnote" href="#_footnotedef_49" title="View footnote.">49</a>]</sup>. If the CDI is not enabled, the
persistence provider must not invoke entity listeners that depend upon
CDI injection.</p>
</div>
<div class="paragraph">
<p>An entity listener is a noncontextual object.
In supporting injection into entity listeners, the persistence provider
must behave as if it carries out the following steps involving the use
of the CDI SPI. (See <a href="#a19500">[7]</a>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain a <code>BeanManager</code> instance. (See <a href="#a12802">Section 9.1</a>)</p>
</li>
<li>
<p>Create an <code>AnnotatedType</code> instance for the entity listener class.</p>
</li>
<li>
<p>Create an <code>InjectionTarget</code> instance for the annotated type.</p>
</li>
<li>
<p>Create a <code>CreationalContext</code>.</p>
</li>
<li>
<p>Instantiate the listener by calling the <code>InjectionTarget</code> <code>produce</code> method.</p>
</li>
<li>
<p>Inject the listener instance by calling the
<code>InjectionTarget</code> <code>inject</code> method on the instance.</p>
</li>
<li>
<p>Invoke the <code>PostConstruct</code> callback, if any,
by calling the <code>InjectionTarget</code> <code>postConstruct</code> method on the instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the listener instance is to be
destroyed, the persistence provider must behave as if it carries out the
following steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Call the <code>InjectionTarget</code> <code>preDestroy</code> method on the instance.</p>
</li>
<li>
<p>Call the <code>InjectionTarget</code> <code>dispose</code> method on the instance</p>
</li>
<li>
<p>Call the <code>CreationalContext</code> <code>release</code> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Persistence providers may optimize the steps
above, e.g. by avoiding calls to the actual CDI SPI and relying on
container-specific interfaces instead, as long as the outcome is the
same.</p>
</div>
<div class="paragraph">
<p>Entity listeners that do not make use of CDI
injection are stateless. The lifecycle of such entity listeners is
unspecified.</p>
</div>
<div class="paragraph">
<p>When invoked from within a Jakarta EE
environment, the callback listeners for an entity share the enterprise
naming context of the invoking component, and the entity callback
methods are invoked in the transaction and security contexts of the
calling component at the time at which the callback method is invoked.
<sup class="footnote">[<a id="_footnoteref_50" class="footnote" href="#_footnotedef_50" title="View footnote.">50</a>]</sup></p>
</div>
</div>
<div class="sect3">
<h4 id="lifecycle-callback-methods"><a class="anchor" href="#lifecycle-callback-methods"></a>3.6.2. Lifecycle Callback Methods</h4>
<div class="paragraph">
<p>Entity lifecycle callback methods can be defined on an entity listener
class and/or directly on an entity class or mapped superclass.</p>
</div>
<div class="paragraph">
<p>A lifecycle callback method must be either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>annotated with annotations designating the callback events for which
it is invoked, or</p>
</li>
<li>
<p>mapped to a callback event type using the XML descriptor.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The same annotations (and XML elements) are used to declare:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>callback methods of an entity class or mapped superclass, and</p>
</li>
<li>
<p>callback methods of an entity listener class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The signatures of the callback methods differ between these two cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a callback method defined by an entity class or mapped superclass has
the signature:</p>
<div class="literalblock">
<div class="content">
<pre>void &lt;METHOD&gt;()</pre>
</div>
</div>
</li>
<li>
<p>a callback method defined by an entity listener class has the signature:</p>
<div class="literalblock">
<div class="content">
<pre>void &lt;METHOD&gt;(S)</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>S</code> is any supertype of the entity class or mapped superclass to
which the entity listener is applied. At runtime, the argument to the
entity listener callback method is the entity instance for which the
callback method is being invoked.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Callback methods can have public, private, protected, or package level
access, but must not be <code>static</code> or <code>final</code>.</p>
</div>
<div class="paragraph">
<p>The following annotations designate lifecycle event callback methods of
the corresponding types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PrePersist</code></p>
</li>
<li>
<p><code>PostPersist</code></p>
</li>
<li>
<p><code>PreRemove</code></p>
</li>
<li>
<p><code>PostRemove</code></p>
</li>
<li>
<p><code>PreUpdate</code></p>
</li>
<li>
<p><code>PostUpdate</code></p>
</li>
<li>
<p><code>PostLoad</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following rules apply to lifecycle callback methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lifecycle callback methods may throw unchecked/runtime exceptions.
A runtime exception thrown by a callback method that executes within
a transaction causes that transaction to be marked for rollback if
the persistence context is joined to the transaction.</p>
</li>
<li>
<p>Lifecycle callbacks can invoke JNDI, JDBC, JMS, and enterprise beans.</p>
</li>
<li>
<p>A lifecycle callback method may modify the non-relationship state of
the entity on which it is invoked.</p>
</li>
<li>
<p>In general, the lifecycle method of a portable application should not
invoke <code>EntityManager</code> or query operations, access other entity
instances, or modify relationships within the same persistence
context<sup class="footnote">[<a id="_footnoteref_51" class="footnote" href="#_footnotedef_51" title="View footnote.">51</a>]</sup>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a2202"><a class="anchor" href="#a2202"></a>3.6.3. Semantics of the Life Cycle Callback Methods for Entities</h4>
<div class="paragraph">
<p>The <code>PrePersist</code> and <code>PreRemove</code> callback
methods are invoked for a given entity before the respective
EntityManager persist and remove operations for that entity are
executed. For entities to which the merge operation has been applied and
causes the creation of newly managed instances, the <code>PrePersist</code>
callback methods will be invoked for the managed instance after the
entity state has been copied to it. These <code>PrePersist</code> and <code>PreRemove</code>
callbacks will also be invoked on all entities to which these operations
are cascaded. The <code>PrePersist</code> and <code>PreRemove</code> methods will always be
invoked as part of the synchronous persist, merge, and remove operations.
Primary key values generated using the <code>SEQUENCE</code>, <code>TABLE</code>, or <code>UUID</code>
strategy are available in the <code>PrePersist</code> method. Primary key values
generated using the <code>IDENTITY</code> strategy are not available in the
<code>PrePersist</code> method.</p>
</div>
<div class="paragraph">
<p>The <code>PostPersist</code> and <code>PostRemove</code> callback
methods are invoked for an entity after the entity has been made
persistent or removed. These callbacks will also be invoked on all
entities to which these operations are cascaded. The <code>PostPersist</code> and
<code>PostRemove</code> methods will be invoked after the database insert and
delete operations respectively. These database operations may occur
directly after the persist, merge, or remove operations have been
invoked or they may occur directly after a flush operation has occurred
(which may be at the end of the transaction). Generated primary key
values are always available in the <code>PostPersist</code> method.</p>
</div>
<div class="paragraph">
<p>The <code>PreUpdate</code> and <code>PostUpdate</code> callbacks
occur before and after the database update operations to entity data
respectively. These database operations may occur at the time the entity
state is updated or they may occur at the time state is flushed to the
database (which may be at the end of the transaction).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that it is implementation-dependent as
to whether <code>PreUpdate</code> and <code>PostUpdate</code> callbacks occur when an entity
is persisted and subsequently modified in a single transaction or when
an entity is modified and subsequently removed within a single
transaction. Portable applications should not rely on such behavior.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>PostLoad</code> method for an entity is
invoked after the entity has been loaded into the current persistence
context from the database or after the refresh operation has been
applied to it. The <code>PostLoad</code> method is invoked before a query result is
returned or accessed or before an association is traversed.</p>
</div>
<div class="paragraph">
<p>It is implementation-dependent as to whether
callback methods are invoked before or after the cascading of the
lifecycle events to related entities. Applications should not depend on
this ordering.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@EntityListeners</span>(com.acme.AlertMonitor.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Account</span> {
    <span class="predefined-type">Long</span> accountId;
    <span class="predefined-type">Integer</span> balance;
    <span class="type">boolean</span> preferred;

    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">Long</span> getAccountId() { ... }

    <span class="comment">// ...</span>

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getBalance() { ... }

    <span class="comment">// ...</span>

    <span class="annotation">@Transient</span> <span class="comment">// because status depends upon non-persistent context</span>
    <span class="directive">public</span> <span class="type">boolean</span> isPreferred() { ... }

    <span class="comment">// ...</span>

    <span class="directive">public</span> <span class="type">void</span> deposit(<span class="predefined-type">Integer</span> amount) { ... }

    <span class="directive">public</span> <span class="predefined-type">Integer</span> withdraw(<span class="predefined-type">Integer</span> amount) <span class="directive">throws</span> NSFException { ... }

    <span class="annotation">@PrePersist</span>
    <span class="directive">protected</span> <span class="type">void</span> validateCreate() {
        <span class="keyword">if</span> (getBalance() &lt; MIN_REQUIRED_BALANCE)
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">AccountException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Insufficient balance to open an account</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@PostLoad</span>
    <span class="directive">protected</span> <span class="type">void</span> adjustPreferredStatus() {
        preferred = (getBalance() &gt;= AccountManager.getPreferredStatusLevel());
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">AlertMonitor</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">public</span> <span class="type">void</span> newAccountAlert(Account acct) {
        Alerts.sendMarketingInfo(acct.getAccountId(), acct.getBalance());
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a2251"><a class="anchor" href="#a2251"></a>3.6.4. Multiple Lifecycle Callback Methods for an Entity Lifecycle Event</h4>
<div class="paragraph">
<p>If multiple callback methods are defined for
an entity lifecycle event, the ordering of the invocation of these
methods is as follows.</p>
</div>
<div class="paragraph">
<p>Default listeners, if any, are invoked first,
in the order specified in the XML descriptor. Default listeners apply to
all entities in the persistence unit, unless explicitly excluded by
means of the <code>ExcludeDefaultListeners</code> annotation or
<code>exclude-default-listeners</code> XML element.</p>
</div>
<div class="paragraph">
<p>The lifecycle callback methods defined on the
entity listener classes for an entity class or mapped superclass are
invoked in the same order as the specification of the entity listener
classes in the <code>EntityListeners</code> annotation.</p>
</div>
<div class="paragraph">
<p>If multiple classes in an inheritance
hierarchyentity classes and/or mapped superclassesdefine entity
listeners, the listeners defined for a superclass are invoked before the
listeners defined for its subclasses in this order. The
<code>ExcludeSuperclassListeners</code> annotation or
<code>exclude-superclass-listeners</code> XML element may be applied to an entity
class or mapped superclass to exclude the invocation of the listeners
defined by the entity listener classes for the superclasses of the
entity or mapped superclass. The excluded listeners are excluded from
the class to which the <code>ExcludeSuperclassListeners</code> annotation or
element has been specified and its subclasses<sup class="footnote">[<a id="_footnoteref_52" class="footnote" href="#_footnotedef_52" title="View footnote.">52</a>]</sup>.
The <code>ExcludeSuperclassListeners</code> annotation (or
<code>exclude-superclass-listeners</code> XML element) does not cause default
entity listeners to be excluded from invocation.</p>
</div>
<div class="paragraph">
<p>If a lifecycle callback method for the
same lifecycle event is also specified on the entity class and/or one or
more of its entity or mapped superclasses, the callback methods on the
entity class and/or superclasses are invoked after the other lifecycle
callback methods, most general superclass first. A class is permitted to
override an inherited callback method of the same callback type, and in
this case, the overridden method is not invoked<sup class="footnote">[<a id="_footnoteref_53" class="footnote" href="#_footnotedef_53" title="View footnote.">53</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>Callback methods are invoked by the
persistence provider runtime in the order specified. If the callback
method execution terminates normally, the persistence provider runtime
then invokes the next callback method, if any.</p>
</div>
<div class="paragraph">
<p>The XML descriptor may be used to override
the lifecycle callback method invocation order specified in annotations.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="paragraph">
<p>There are several entity classes and listeners for animals:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Animal</span> {

    <span class="comment">// ...</span>

    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistAnimal() {
        <span class="comment">// ...</span>
    }
}

<span class="annotation">@Entity</span>
<span class="annotation">@EntityListeners</span>(PetListener.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Pet</span> <span class="directive">extends</span> Animal {
    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@EntityListeners</span>({CatListener.class, CatListener2.class})
<span class="directive">public</span> <span class="type">class</span> <span class="class">Cat</span> <span class="directive">extends</span> Pet {
    <span class="comment">// ...</span>
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">PetListener</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistPetListenerMethod(<span class="predefined-type">Object</span> pet) {
        <span class="comment">// ...</span>
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">CatListener</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistCatListenerMethod(<span class="predefined-type">Object</span> cat) {
        <span class="comment">// ...</span>
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">CatListener2</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistCatListener2Method(<span class="predefined-type">Object</span> cat) {
        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <code>PostPersist</code> event occurs on an
instance of <code>Cat</code>, the following methods are called in order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>postPersistPetListenerMethod</p>
</li>
<li>
<p>postPersistCatListenerMethod</p>
</li>
<li>
<p>postPersistCatListener2Method</p>
</li>
<li>
<p>postPersistAnimal</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Assume that <code>SiameseCat</code> is defined as a
subclass of <code>Cat</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EntityListeners</span>(SiameseCatListener.class)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SiameseCat</span> <span class="directive">extends</span> Cat {
    <span class="comment">// ...</span>

    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistSiameseCat() {
        <span class="comment">// ...</span>
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">SiameseCatListener</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistSiameseCatListenerMethod(<span class="predefined-type">Object</span> cat) {
        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <code>PostPersist</code> event occurs on an
instance of <code>SiameseCat</code>, the following methods are called in order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>postPersistPetListenerMethod</p>
</li>
<li>
<p>postPersistCatListenerMethod</p>
</li>
<li>
<p>postPersistCatListener2Method</p>
</li>
<li>
<p>postPersistSiameseCatListenerMethod</p>
</li>
<li>
<p>postPersistAnimal</p>
</li>
<li>
<p>postPersistSiameseCat</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Assume the definition of <code>SiameseCat</code> were instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EntityListeners</span>(SiameseCatListener.class)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SiameseCat</span> <span class="directive">extends</span> Cat {
    <span class="comment">// ...</span>

    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistAnimal() {
        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the following methods would be
called in order, where <code>postPersistAnimal</code> is the <code>PostPersist</code> method
defined in the <code>SiameseCat</code> class:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>postPersistPetListenerMethod</p>
</li>
<li>
<p>postPersistCatListenerMethod</p>
</li>
<li>
<p>postPersistCatListener2Method</p>
</li>
<li>
<p>postPersistSiameseCatListenerMethod</p>
</li>
<li>
<p>postPersistAnimal</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="exceptions"><a class="anchor" href="#exceptions"></a>3.6.5. Exceptions</h4>
<div class="paragraph">
<p>Lifecycle callback methods may throw runtime
exceptions. A runtime exception thrown by a callback method that
executes within a transaction causes that transaction to be marked for
rollback if the persistence context is joined to the transaction. No
further lifecycle callback methods will be invoked after a runtime
exception is thrown.</p>
</div>
</div>
<div class="sect3">
<h4 id="specification-of-callback-listener-classes-and-lifecycle-methods-in-the-xml-descriptor"><a class="anchor" href="#specification-of-callback-listener-classes-and-lifecycle-methods-in-the-xml-descriptor"></a>3.6.6. Specification of Callback Listener Classes and Lifecycle Methods in the XML Descriptor</h4>
<div class="paragraph">
<p>The XML descriptor can be used as an
alternative to metadata annotations to specify entity listener classes
and their binding to entities or to override the invocation order of
lifecycle callback methods as specified in annotations.</p>
</div>
<div class="sect4">
<h5 id="specification-of-callback-listeners"><a class="anchor" href="#specification-of-callback-listeners"></a>3.6.6.1. Specification of Callback Listeners</h5>
<div class="paragraph">
<p>The <code>entity-listener</code> XML descriptor element
is used to specify the lifecycle listener methods of an entity listener
class. The lifecycle listener methods are specified by using the
<code>pre-persist</code>, <code>post-persist</code>, <code>pre-remove</code>, <code>post-remove</code>,
<code>pre-update</code>, <code>post-update</code>, and/or <code>post-load</code> elements.</p>
</div>
<div class="paragraph">
<p>An entity listener class can define multiple
callback methods. However, at most one method of an entity listener
class can be designated as a pre-persist method, post-persist method,
pre-remove method, post-remove method, pre-update method, post-update
method, and/or post-load method, regardless of whether the XML
descriptor is used to define entity listeners or whether some
combination of annotations and XML descriptor elements is used.</p>
</div>
</div>
<div class="sect4">
<h5 id="specification-of-the-binding-of-entity-listener-classes-to-entities"><a class="anchor" href="#specification-of-the-binding-of-entity-listener-classes-to-entities"></a>3.6.6.2. Specification of the Binding of Entity Listener Classes to Entities</h5>
<div class="paragraph">
<p>The <code>entity-listeners</code> subelement of the
<code>persistence-unit-defaults</code> element is used to specify the default
entity listeners for the persistence unit.</p>
</div>
<div class="paragraph">
<p>The <code>entity-listeners</code> subelement of the
<code>entity</code> or <code>mapped-superclass</code> element is used to specify the entity
listener classes for the respective entity or mapped superclass and its
subclasses.</p>
</div>
<div class="paragraph">
<p>The binding of entity listeners to entity
classes is additive. The entity listener classes bound to the
superclasses of an entity or mapped superclass are applied to it as
well.</p>
</div>
<div class="paragraph">
<p>The <code>exclude-superclass-listeners</code> element
specifies that the listener methods for superclasses are not to be
invoked for an entity class (or mapped superclass) and its subclasses.</p>
</div>
<div class="paragraph">
<p>The <code>exclude-default-listeners</code> element
specifies that default entity listeners are not to be invoked for an
entity class (or mapped superclass) and its subclasses.</p>
</div>
<div class="paragraph">
<p>Explicitly listing an excluded default or
superclass listener for a given entity class or mapped superclass causes
it to be applied to that entity or mapped superclass and its subclasses.</p>
</div>
<div class="paragraph">
<p>In the case of multiple callback methods for
a single lifecycle event, the invocation order rules described in <a href="#a2251">Section 3.6.4</a> apply.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2366"><a class="anchor" href="#a2366"></a>3.7. Bean Validation</h3>
<div class="paragraph">
<p>This specification defines support for use of
Bean Validation <a href="#a19498">[5]</a> within Jakarta Persistence
applications.</p>
</div>
<div class="paragraph">
<p>Managed classes (entities, mapped
superclasses, and embeddable classes) may be configured to include Bean
Validation constraints.</p>
</div>
<div class="paragraph">
<p>Automatic validation using these constraints
is achieved by specifying that Jakarta Persistence delegate validation to
the Bean Validation implementation upon the pre-persist, pre-update, and
pre-remove entity lifecycle events described in <a href="#a2202">Section 3.6.3</a>.</p>
</div>
<div class="paragraph">
<p>Validation can also be achieved by the
application calling the <code>validate</code> method of a <code>Validator</code> instance upon
an instance of a managed class, as described in the Bean Validation
specification <a href="#a19498">[5]</a>.</p>
</div>
<div class="sect3">
<h4 id="automatic-validation-upon-lifecycle-events"><a class="anchor" href="#automatic-validation-upon-lifecycle-events"></a>3.7.1. Automatic Validation Upon Lifecycle Events</h4>
<div class="paragraph">
<p>This specification supports the use of bean
validation for the automatic validation of entities upon the
pre-persist, pre-update, and pre-remove lifecycle validation events.
These lifecycle validation events occur immediately after the point at
which all the <code>PrePersist</code>, <code>PreUpdate</code>, and <code>PreRemove</code> lifecycle
callback method invocations respectively have been completed, or
immediately after the point at which such lifecycle callback methods
would have been completed (in the event that such callback methods are
not present).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the case where an entity is persisted and
subsequently modified in a single transaction or when an entity is
modified and subsequently removed in a single transaction, it is
implementation dependent as to whether the pre-update validation event
occurs. Portable applications should not rely on this behavior.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="a2374"><a class="anchor" href="#a2374"></a>3.7.1.1. Enabling Automatic Validation</h5>
<div class="paragraph">
<p>The <code>validation-mode</code> element of the
<code>persistence.xml</code> file determines whether the automatic lifecycle event
validation is in effect. The values of the <code>validation-mode</code> element are
<code>AUTO</code>, <code>CALLBACK</code>, <code>NONE</code>. The default validation mode is <code>AUTO</code>.</p>
</div>
<div class="paragraph">
<p>If the application creates the entity manager
factory using the <code>Persistence.createEntityManagerFactory</code> method, the
validation mode can be specified using the
<code>jakarta.persistence.validation.mode</code> map key, which will override the
value specified (or defaulted) in the <code>persistence.xml</code> file. The map
values for this key are <em>"auto"</em>, <em>"callback"</em>, <em>"none"</em>.</p>
</div>
<div class="paragraph">
<p>If the auto validation mode is specified by
the <code>validation-mode</code> element or the <code>jakarta.persistence.validation.mode</code>
property, or if neither the <code>validation-mode</code> element nor the
<code>jakarta.persistence.validation.mode</code> property is specified, and a Bean
Validation provider is present in the environment, the persistence
provider must perform the automatic validation of entities as described
in <a href="#a2380">Section 3.7.1.2</a>. If no Bean Validation provider is
present in the environment, no lifecycle event validation takes place.</p>
</div>
<div class="paragraph">
<p>If the callback validation mode is specified
by the <code>validation-mode</code> element or the
<code>jakarta.persistence.validation.mode</code> property, the persistence provider
must perform the lifecycle event validation as described in <a href="#a2380">Section 3.7.1.2</a>.
It is an error if there is no Bean Validation
provider present in the environment, and the provider must throw the
<code>PersistenceException</code> if the <code>jakarta.persistence.validation.mode</code>
property value <em>"callback"</em> has been passed to the
<code>Persistence.createEntityManagerFactory</code> method.</p>
</div>
<div class="paragraph">
<p>If the none validation mode is specified by
the <code>validation-mode</code> element or the <code>jakarta.persistence.validation.mode</code>
property, the persistence provider must not perform lifecycle event
validation.</p>
</div>
</div>
<div class="sect4">
<h5 id="a2380"><a class="anchor" href="#a2380"></a>3.7.1.2. Requirements for Automatic Validation upon Lifecycle Events</h5>
<div class="paragraph">
<p>For each event type, a list of groups is
targeted for validation. By default, the default Bean Validation group
(the group <code>Default</code>) will be validated upon the pre-persist and
pre-update lifecycle validation events, and no group will be validated
upon the pre-remove event.</p>
</div>
<div class="paragraph">
<p>This default validation behavior can be
overridden by specifying the target groups using the following
validation properties in the <code>persistence.xml</code> file or by passing these
properties in the configuration of the entity manager factory through
the <code>createEntityManagerFactory</code> method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jakarta.persistence.validation.group.pre-persist</code></p>
</li>
<li>
<p><code>jakarta.persistence.validation.group.pre-update</code></p>
</li>
<li>
<p><code>jakarta.persistence.validation.group.pre-remove</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The value of a validation property must be a
list of the targeted groups. A targeted group must be specified by its
fully qualified class name. Names must be separated by a comma.</p>
</div>
<div class="paragraph">
<p>When one of the above events occurs for an
entity, the persistence provider must validate that entity by obtaining
a <code>Validator</code> instance from the validator factory in use (see <a href="#a2394">Section 3.7.2</a>) and
invoking its <code>validate</code> method with the targeted groups. If the list of
targeted groups is empty, no validation is performed. If the set of
<code>ConstraintViolation</code> objects returned by the <code>validate</code> method is not
empty, the persistence provider must throw the
<code>jakarta.validation.ConstraintViolationException</code> containing a reference
to the returned set of <code>ConstraintViolation</code> objects, and must mark the
transaction for rollback if the persistence context is joined to the
transaction.</p>
</div>
<div class="paragraph">
<p>The validator instance that is used for
automatic validation upon lifecycle events must use a
<code>TraversableResolver</code> that has the following behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Attributes that have not been loaded must not
be loaded.</p>
</li>
<li>
<p>Validation cascade (<code>@Valid</code>) must not
occur for entity associations (single- or multi-valued).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These requirements guarantee that no unloaded
attribute or association will be loaded by side effect and that no
entity will be validated more than once during a given flush cycle.</p>
</div>
<div class="paragraph">
<p>Embeddable attributes must be validated only
if the <code>Valid</code> annotation has been specified on them.</p>
</div>
<div class="paragraph">
<p>It is the responsibility of the persistence
provider to pass an instance implementing the
<code>jakarta.validation.TraversableResolver</code> interface to the Bean Validation
provider by calling
<code>ValidatorFactory.usingContext().traversableResolver(tr).getValidator()</code> where <code>tr</code> is the resolver having the behavior described above.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a2394"><a class="anchor" href="#a2394"></a>3.7.2. Providing the ValidatorFactory</h4>
<div class="paragraph">
<p>In Jakarta EE environments, a <code>ValidatorFactory</code>
instance is made available by the Jakarta EE container. The container is
responsible for passing this validator factory to the persistence
provider via the map that is passed as an argument to the
<code>createContainerEntityManagerFactory</code> call. The map key used by the
container must be the standard property name
<code>jakarta.persistence.validation.factory</code>.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, the application can
pass the <code>ValidatorFactory</code> instance via the map that is passed as an
argument to the <code>Persistence.createEntityManagerFactory</code> call. The map
key used must be the standard property name
<code>jakarta.persistence.validation.factory</code>. If no <code>ValidatorFactory</code>
instance is provided by the application, and if a Bean Validation
provider is present in the classpath, the persistence provider must
instantiate the <code>ValidatorFactory</code> using the default bootstrapping
approach defined by the Bean Validation specification
<a href="#a19498">[5]</a>, namely <code>Validation.buildDefaultValidatorFactory()</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2397"><a class="anchor" href="#a2397"></a>3.8. Entity Graphs</h3>
<div class="paragraph">
<p>An entity graph is a template that captures
the path and boundaries for an operation or query. It is defined in the
form of metadata or an object created by the dynamic <code>EntityGraph</code> API.</p>
</div>
<div class="paragraph">
<p>Entity graphs are used in the specification
of fetch plans for query or <code>find</code> operations.</p>
</div>
<div class="paragraph">
<p>The <code>EntityGraph</code>, <code>AttributeNode</code>, and <code>Subgraph</code> interfaces found in
<a href="#persistence-api">Appendix B</a> are used to dynamically construct entity graphs.</p>
</div>
<div class="paragraph">
<p>The annotations <code>NamedEntityGraph</code>, <code>NamedAttributeNode</code>, and
<code>NamedSubgraph</code> described in <a href="#a13662">Section 10.3</a> are used to statically define
entity graphs. The <code>named-entity-graph</code> XML element and its subelements
may be used to override these annotations or to define additional named
entity graphs.</p>
</div>
<div class="paragraph">
<p>The semantics of entity graphs with regard to
find and query operations are described in <a href="#a2814">Section 3.8.1</a>.</p>
</div>
<div class="sect3">
<h4 id="a2814"><a class="anchor" href="#a2814"></a>3.8.1. Use of Entity Graphs in find and query operations</h4>
<div class="paragraph">
<p>An entity graph can be used with the <code>find</code>
method or as a query hint to override or augment <code>FetchType</code> semantics.</p>
</div>
<div class="paragraph">
<p>The standard properties
<code>jakarta.persistence.fetchgraph</code> and <code>jakarta.persistence.loadgraph</code> are
used to specify such graphs to queries and <code>find</code> operations.</p>
</div>
<div class="paragraph">
<p>The default fetch graph for an entity or
embeddable is defined to consist of the transitive closure of all of its
attributes that are specified as <code>FetchType.EAGER</code> (or defaulted as
such).</p>
</div>
<div class="paragraph">
<p>The persistence provider is permitted to
fetch additional entity state beyond that specified by a fetch graph or
load graph. It is required, however, that the persistence provider fetch
all state specified by the fetch or load graph.</p>
</div>
<div class="sect4">
<h5 id="fetch-graph-semantics"><a class="anchor" href="#fetch-graph-semantics"></a>3.8.1.1. Fetch Graph Semantics</h5>
<div class="paragraph">
<p>When the <code>jakarta.persistence.fetchgraph</code>
property is used to specify an entity graph, attributes that are
specified by attribute nodes of the entity graph are treated as
<code>FetchType.EAGER</code> and attributes that are not specified are treated as
<code>FetchType.LAZY</code>.</p>
</div>
<div class="paragraph">
<p>The following rules apply, depending on
attribute type. The rules of this section are applied recursively.</p>
</div>
<div class="paragraph">
<p>A primary key or version attribute never
needs to be specified in an attribute node of a fetch graph. (This
applies to composite primary keys as well, including embedded id primary
keys.) When an entity is fetched, its primary key and version attributes
are always fetched. It is not incorrect, however, to specify primary key
attributes or version attributes.</p>
</div>
<div class="paragraph">
<p>Attributes other than primary key and version
attributes are assumed not to be fetched unless the attribute is
specified. The following rules apply to the specification of attributes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the attribute is an embedded attribute,
and the attribute is specified in an attribute node, but a subgraph is
not specified for the attribute, the default fetch graph for the
embeddable is fetched. If a subgraph is specified for the attribute, the
attributes of the embeddable are fetched according to their
specification in the corresponding subgraph.</p>
</li>
<li>
<p>If the attribute is an element collection of
basic type, and the attribute is specified in an attribute node, the
element collection together with its basic elements is fetched.</p>
</li>
<li>
<p>If the attribute is an element collection of
embeddables, and the attribute is specified in an attribute node, but a
subgraph is not specified for the attribute, the element collection
together with the default fetch graph of its embeddable elements is
fetched. If a subgraph is specified for the attribute, the attributes of
the embeddable elements are fetched according to the corresponding
subgraph specification.</p>
</li>
<li>
<p>If the attribute is a one-to-one or
many-to-one relationship, and the attribute is specified in an attribute
node, but a subgraph is not specified for the attribute, the default
fetch graph of the target entity is fetched. If a subgraph is specified
for the attribute, the attributes of the target entity are fetched
according to the corresponding subgraph specification.</p>
</li>
<li>
<p>If the attribute is a one-to-many or
many-to-many relationship, and the attribute is specified in an
attribute node, but a subgraph is not specified, the collection is
fetched and the default fetch graphs of the referenced entities are
fetched. If a subgraph is specified for the attribute, the entities in
the collection are fetched according to the corresponding subgraph
specification.</p>
</li>
<li>
<p>If the key of a map which has been specified
in an attribute node is a basic type, it is fetched. If the key of a map
which has been specified in an attribute node is an embedded type, the
default fetch graph is fetched for the embeddable. Otherwise, if the key
of the map is an entity, and a map key subgraph is not specified for the
attribute node, the map key is fetched according to its default fetch
graph. If a key subgraph is specified for the map key attribute, the map
key attribute is fetched according to the map key subgraph
specification.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedEntityGraph</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Phonenumber</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> number;

    <span class="directive">protected</span> PhoneTypeEnum type;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, only the <code>number</code> attribute would be eagerly fetched.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedEntityGraph</span>(
    attributeNodes={<span class="annotation">@NamedAttributeNode</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">projects</span><span class="delimiter">&quot;</span></span>)}
)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="annotation">@Basic</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@Basic</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> employeeNumber;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Dependents&gt; dependents;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Project&gt; projects;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;PhoneNumber&gt; phoneNumbers;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@Inheritance</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Project</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="predefined-type">String</span> name;

    <span class="annotation">@OneToOne</span>(fetch=FetchType.EAGER)
    <span class="directive">protected</span> Requirements doc;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LargeProject</span> <span class="directive">extends</span> Project {
    <span class="annotation">@OneToOne</span>(fetch=FetchType.LAZY)
    <span class="directive">protected</span> Employee approver;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Requirements</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="annotation">@Lob</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> description;

    <span class="annotation">@OneToOne</span>(fetch=FetchType.LAZY)
    <span class="directive">protected</span> Approval approval

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the <code>Employee</code> entity&#8217;s
primary key will be fetched as well as the related <code>Project</code> instances,
whose default fetch graph (<code>id</code>, <code>name</code>, and <code>doc</code> attributes) will
be fetched. The related <code>Requirements</code> object will be fetched according
to its default fetch graph.</p>
</div>
<div class="paragraph">
<p>If the <code>approver</code> attribute of <code>LargeProject</code>
were <code>FetchType.EAGER</code>, and if any of the projects were instances of
<code>LargeProject</code>, their <code>approver</code> attributes would also be fetched.
Since the type of the <code>approver</code> attribute is <code>Employee</code>, the
approver&#8217;s default fetch graph (<code>id</code>, <code>name</code>, and <code>employeeNumber</code>
attributes) would also be fetched.</p>
</div>
</div>
<div class="sect4">
<h5 id="load-graph-semantics"><a class="anchor" href="#load-graph-semantics"></a>3.8.1.2. Load Graph Semantics</h5>
<div class="paragraph">
<p>When the <code>jakarta.persistence.loadgraph</code>
property is used to specify an entity graph, attributes that are
specified by attribute nodes of the entity graph are treated as
<code>FetchType.EAGER</code> and attributes that are not specified are treated
according to their specified or default FetchType.</p>
</div>
<div class="paragraph">
<p>The following rules apply. The rules of this
section are applied recursively.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A primary key or version attribute never
needs to be specified in an attribute node of a load graph. (This
applies to composite primary keys as well, including embedded id primary
keys.) When an entity is fetched, its primary key and version attributes
are always fetched. It is not incorrect, however, to specify primary key
attributes or version attributes.</p>
</li>
<li>
<p>If the attribute is an embedded attribute,
and the attribute is specified in an attribute node, but a subgraph is
not specified for the attribute, the default fetch graph for the
embeddable is fetched. If a subgraph is specified for the attribute,
attributes that are specified by the subgraph are also fetched.</p>
</li>
<li>
<p>If the attribute is an element collection of
basic type, and the attribute is specified in an attribute node, the
element collection together with its basic elements is fetched.</p>
</li>
<li>
<p>If the attribute is an element collection of
embeddables, and the attribute is specified in an attribute node, the
element collection together with the default fetch graph of its
embeddable elements is fetched. If a subgraph is specified for the
attribute, attributes that are specified by the subgraph are also
fetched.</p>
</li>
<li>
<p>If the attribute is a one-to-one or
many-to-one relationship, and the attribute is specified in an attribute
node, the default fetch graph of the target entity is fetched. If a
subgraph is specified for the attribute, attributes that are specified
by the subgraph are also fetched.</p>
</li>
<li>
<p>If the attribute is a one-to-many or
many-to-many relationship, and the attribute is specified in an
attribute node, the collection is fetched and the default fetch graphs
of the referenced entities are fetched. If a subgraph is specified for
the attribute, attributes that are specified by the subgraph are also
fetched.</p>
</li>
<li>
<p>If the key of a map which has been specified
in an attribute node is a basic type, it is fetched. If the key of a map
which has been specified in an attribute node is an embedded type, the
default fetch graph is fetched for the embeddable. Otherwise, if the key
of the map is an entity, the map key is fetched according to its default
fetch graph. If a key subgraph is specified for the map key attribute,
additional attributes are fetched as specified in the key subgraph.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedEntityGraph</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Phonenumber</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> number;

    <span class="directive">protected</span> PhoneTypeEnum type;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the <code>number</code> and <code>type</code> attributes are fetched.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedEntityGraph</span>(
    attributeNodes={<span class="annotation">@NamedAttributeNode</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">projects</span><span class="delimiter">&quot;</span></span>)}
)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="annotation">@Basic</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@Basic</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> employeeNumber;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Dependents&gt; dependents;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Project&gt; projects;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;PhoneNumber&gt; phoneNumbers;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@Inheritance</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Project</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="predefined-type">String</span> name;

    <span class="annotation">@OneToOne</span>(fetch=FetchType.EAGER)
    <span class="directive">protected</span> Requirements doc;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LargeProject</span> <span class="directive">extends</span> Project {
    <span class="annotation">@OneToOne</span>(fetch=FetchType.LAZY)
    <span class="directive">protected</span> Employee approver;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Requirements</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="annotation">@Lob</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> description;

    <span class="annotation">@OneToOne</span>(fetch=FetchType.LAZY)
    <span class="directive">protected</span> Approval approval

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the default fetch graph
(<code>id</code>, <code>name</code>, <code>employeeNumber</code> attributes) of <code>Employee</code> is fetched.
The default fetch graphs of the related <code>Project</code> instances (<code>id</code>,
<code>name</code>, and <code>doc</code> attributes) and their <code>Requirements</code> instances (<code>id</code>
and <code>description</code> attributes) are also fetched.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2999"><a class="anchor" href="#a2999"></a>3.9. Type Conversion of Basic Attributes</h3>
<div class="paragraph">
<p>The attribute conversion facility allows the developer to define custom
attribute converters. A <code>converter</code> is a class whose methods convert
between:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <em>target type</em> of the converter, an arbitrary Java type which may be
used as the type of a persistent field or property, and</p>
</li>
<li>
<p>a basic type (see <a href="#a486">Section 2.6</a>) used as an intermediate step in mapping to
the database representation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A converter can be used to convert attributes defined by entity classes,
mapped superclasses, or embeddable classes.<sup class="footnote">[<a id="_footnoteref_54" class="footnote" href="#_footnotedef_54" title="View footnote.">54</a>]</sup> A converted attribute is considered a basic attribute,
since, with the aid of the converter, its values can be represented as
instances of a basic type.</p>
</div>
<div class="paragraph">
<p>Every attribute converter class must implement the interface
<code>jakarta.persistence.AttributeConverter</code> and must be annotated with the
<code>Converter</code> annotation or declared as a converter in the XML descriptor.
If the value of the <code>autoApply</code> element of the <code>Converter</code> annotation is
<code>true</code>, the converter is automatically applied to all attributes of the
target type, including to basic attribute values that are contained within
other, more complex attribute types. See <a href="#a13903">Section 10.6</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Interface implemented by custom attribute &lt;em&gt;converters&lt;/em&gt;. A
 * converter is a class whose methods convert between:
 * &lt;ul&gt;
 * &lt;li&gt;the &lt;em&gt;target type&lt;/em&gt; of the converter, an arbitrary Java
 *     type which may be used as the type of a persistent field or
 *     property, and
 * &lt;li&gt;a {@linkplain Basic basic type} used as an intermediate step
 *     in mapping to the database representation.
 * &lt;/ul&gt;
 *
 * &lt;p&gt;A converted field or property is considered {@link Basic}, since,
 * with the aid of the converter, its values can be represented as
 * instances of a basic type.
 *
 * &lt;p&gt;A converter class must be annotated {@link Converter} or declared
 * as a converter in the object/relational mapping descriptor. The value
 * of {@link Converter#autoApply autoApply} determines if the converter
 * is automatically applied to persistent fields and properties of the
 * target type. The {@link Convert} annotation may be used to apply a
 * converter which is declared {@code autoApply=false}, to explicitly
 * {@linkplain Convert#disableConversion disable conversion}, or to
 * resolve ambiguities when multiple converters would otherwise apply.
 *
 * &lt;p&gt;Note that the target type {@code X} and the converted basic type
 * {@code Y} may be the same Java type.
 *
 * @param &lt;X&gt; the target type, that is, the type of the entity attribute
 * @param &lt;Y&gt; a basic type representing the type of the database column
 *
 * @see Converter
 * @see Convert#converter
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AttributeConverter</span>&lt;X,Y&gt; {

    <span class="comment">/**
     * Converts the value stored in the entity attribute into the 
     * data representation to be stored in the database.
     *
     * @param attribute  the entity attribute value to be converted
     * @return  the converted data to be stored in the database column
     */</span>
    Y convertToDatabaseColumn(X attribute);

    <span class="comment">/**
     * Converts the data stored in the database column into the value
     * to be stored in the entity attribute.
     *
     * &lt;p&gt;Note that it is the responsibility of the converter writer
     * to specify the correct {@code dbData} type for the corresponding
     * column for use by the JDBC driver: i.e., persistence providers
     * are not expected to do such type conversion.
     *
     * @param dbData  the data from the database column to be converted
     * @return  the converted value to be stored in the entity attribute
     */</span>
    X convertToEntityAttribute(Y dbData);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attribute converter classes in Jakarta EE
environments support dependency injection through the Contexts and
Dependency Injection API (CDI) <a href="#a19500">[7]</a> when CDI is
enabled<sup class="footnote">[<a id="_footnoteref_55" class="footnote" href="#_footnotedef_55" title="View footnote.">55</a>]</sup>. An attribute converter class that makes
use of CDI injection may also define lifecycle callback methods
annotated with the <code>PostConstruct</code> and <code>PreDestroy</code> annotations. These
methods will be invoked after injection has taken place and before the
attribute converter instance is destroyed respectively.</p>
</div>
<div class="paragraph">
<p>The persistence provider is responsible for
using the CDI SPI to create instances of the attribute converter class;
to perform injection upon such instances; to invoke their
<code>PostConstruct</code> and <code>PreDestroy</code> methods, if any; and to dispose of the
attribute converter instances.</p>
</div>
<div class="paragraph">
<p>The persistence provider is only required to
support CDI injection into attribute converters in Jakarta EE container
environments<sup class="footnote">[<a id="_footnoteref_56" class="footnote" href="#_footnotedef_56" title="View footnote.">56</a>]</sup>. If CDI is not enabled, the
persistence provider must not invoke attribute converters that depend
upon CDI injection.</p>
</div>
<div class="paragraph">
<p>An attribute converter is a noncontextual
object. In supporting injection into attribute converters, the
persistence provider must behave as if it carries out the following
steps involving the use of the CDI SPI. (See
<a href="#a19500">[7]</a>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain a <code>BeanManager</code> instance. (See <a href="#a12802">Section 9.1</a>.)</p>
</li>
<li>
<p>Create an <code>AnnotatedType</code> instance for the attribute converter class.</p>
</li>
<li>
<p>Create an <code>InjectionTarget</code> instance for the annotated type.</p>
</li>
<li>
<p>Create a <code>CreationalContext</code>.</p>
</li>
<li>
<p>Instantiate the listener by calling the <code>InjectionTarget</code> <code>produce</code> method.</p>
</li>
<li>
<p>Inject the listener instance by calling the <code>InjectionTarget</code> <code>inject</code> method on the instance.</p>
</li>
<li>
<p>Invoke the <code>PostConstruct</code> callback, if any,
by calling the <code>InjectionTarget</code> <code>postConstruct</code> method on the instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the listener instance is to be
destroyed, the persistence provider must behave as if it carries out the
following steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Call the <code>InjectionTarget</code> <code>preDestroy</code> method on the instance.</p>
</li>
<li>
<p>Call the <code>InjectionTarget</code> <code>dispose</code> method on the instance.</p>
</li>
<li>
<p>Call the <code>CreationalContext</code> <code>release</code> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Persistence providers may optimize the steps
above, e.g. by avoiding calls to the actual CDI SPI and relying on
container-specific interfaces instead, as long as the outcome is the
same.</p>
</div>
<div class="paragraph">
<p>Attribute converters that do not make use of
CDI injection are stateless. The lifecycle of such attribute converters
is unspecified.</p>
</div>
<div class="paragraph">
<p>The conversion of all basic types is
supported except for the following: Id attributes (including the
attributes of embedded ids and derived identities), version attributes,
relationship attributes, and attributes explicitly annotated as
<code>Enumerated</code> or <code>Temporal</code> or designated as such in the XML descriptor.
Auto-apply converters will not be applied to such attributes, and
applications that apply converters to such attributes through use of the
<code>Convert</code> annotation will not be portable.</p>
</div>
<div class="paragraph">
<p>Type conversion may be specified at the level
of individual attributes by means of the <code>Convert</code> annotation. The
<code>Convert</code> annotation may also be used to override or disable an
auto-apply conversion. See <a href="#a14398">Section 11.1.10</a>.</p>
</div>
<div class="paragraph">
<p>The <code>Convert</code> annotation may be applied
directly to an attribute of an entity, mapped superclass, or embeddable
class to specify conversion of the attribute or to override the use of a
converter that has been specified as <code>autoApply=true</code>. When persistent
properties are used, the <code>Convert</code> annotation is applied to the getter
method.</p>
</div>
<div class="paragraph">
<p>The <code>Convert</code> annotation may be applied to an
entity that extends a mapped superclass to specify or override the
conversion mapping for an inherited basic or embedded attribute.</p>
</div>
<div class="paragraph">
<p>The persistence provider runtime is
responsible for invoking the specified conversion methods for the target
attribute type when loading the entity attribute from the database and
before storing the entity attribute state to the database. The
persistence provider must apply any conversion methods to instances of
attribute values in path expressions used within Jakarta Persistence query
language queries or criteria queries (such as in comparisons, bulk
updates, etc.) before sending them to the database for the query
execution. When such converted attributes are used in comparison
operations with literals or parameters, the value of the literal or
parameter to which they are compared must also be converted. If the
result of a Jakarta Persistence query language query or criteria query
includes one or more entity attributes for which conversion mappings
have been specified, the persistence provider must apply the specified
conversions to the corresponding values in the query result before
returning them to the application. The use of functions, including
aggregates, on converted attributes is undefined. If an exception is
thrown from a conversion method, the persistence provider must wrap the
exception in a PersistenceException and, if the persistence context is
joined to a transaction, mark the transaction for rollback.</p>
</div>
</div>
<div class="sect2">
<h3 id="a3061"><a class="anchor" href="#a3061"></a>3.10. Second-Level Cache</h3>
<div class="paragraph">
<p>A persistence provider may support the use of a <em>second-level cache</em>,
that is, it might have a way to store data read in one persistence context
for use in subsequent persistence contexts. A second-level cache might
enhance performance, but tends to undermine the semantics of transaction
processing, possibly exposing the application to stale data or similar
anomalies.</p>
</div>
<div class="paragraph">
<p>Access to the second-level cache, if enabled, is mediated via the
persistence context, and is largely transparent to the application.
As an exception, the <code>Cache</code> interface described below in <a href="#a12124">Section 3.10.3</a>
allows the application to directly evict data from the second-level cache.</p>
</div>
<div class="paragraph">
<p>The persistence provider is not required to support use of a second-level
cache.</p>
</div>
<div class="sect3">
<h4 id="a3065"><a class="anchor" href="#a3065"></a>3.10.1. The Shared Cache Mode and Cacheable Annotation</h4>
<div class="paragraph">
<p>Whether a given entity is eligible for storage in the second level cache
is determined by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the annotations of the entity class, and</p>
</li>
<li>
<p>the value specified for the <code>shared-cache-mode</code> element of the
<code>persistence.xml</code> file or by the configuration property
<code>jakarta.persistence.sharedCache.mode</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The value of the property <code>jakarta.persistence.sharedCache.mode</code> takes
precedence over the value of the <code>shared-cache-mode</code> element.</p>
</div>
<div class="paragraph">
<p>The <code>shared-cache-mode</code> element takes one of five possible values,
which are enumerated by <code>jakarta.persistence.SharedCacheMode</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ALL</code> specifies that every entity and all its state may be cached.</p>
</li>
<li>
<p><code>NONE</code> specifies that caching is disabled for the persistence unit,
and that the persistence provider must not cache any entity data.</p>
</li>
<li>
<p><code>ENABLE_SELECTIVE</code> specifies that an entity may be cached if the
entity class is explicitly annotated <code>@Cacheable</code> or <code>@Cacheable(true)</code>,
or if the equivalent setting is specified in XML.</p>
</li>
<li>
<p><code>DISABLE_SELECTIVE</code> specifies that an entity may be cached unless
the entity class is explicitly annotated <code>@Cacheable(false)</code>, or
unless the equivalent setting is specified in XML.</p>
</li>
<li>
<p><code>UNSPECIFIED</code> selects the provider-specific default behavior.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If neither the <code>shared-cache-mode</code> element nor the property
<code>jakarta.persistence.sharedCache.mode</code> is specified, or if the specified
value is <code>UNSPECIFIED</code>, the behavior is not defined, and provider-specific
defaults may apply. In particular, the semantics of the <code>Cacheable</code>
annotation (and XML equivalent) is undefined.</p>
</div>
<div class="paragraph">
<p>If the persistence provider does not support use of a second-level cache,
or if a second-level cache is not installed or not enabled, this setting
may be ignored and no caching will occur.</p>
</div>
<div class="paragraph">
<p>A persistence provider may support additional vendor-specific mechanisms
for configuring the cache and marking entities eligible (or not) for
storage in the second-level cache. However, if a second-level cache is
supported, and enabled, the provider must respect the configuration options
defined in this section, if specified by the application.</p>
</div>
</div>
<div class="sect3">
<h4 id="cache-modes"><a class="anchor" href="#cache-modes"></a>3.10.2. Cache Modes</h4>
<div class="paragraph">
<p>The <em>cache retrieve mode</em> and <em>cache store mode</em> control how a given
persistence context by interacts with the second-level cache.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The cache retrieve mode may be set by calling <code>setCacheRetrieveMode()</code>
on <code>EntityManager</code> or <code>Query</code>.</p>
</li>
<li>
<p>The cache store mode may be set by calling <code>setCacheStoreMode()</code> on
<code>EntityManager</code> or <code>Query</code>.</p>
</li>
<li>
<p>A cache store mode or cache retrieve mode, or both, may be passed to
the <code>find()</code> method of <code>EntityManager</code> as a <code>FindOption</code>.</p>
</li>
<li>
<p>A cache store mode may be passed to the <code>refresh()</code> method of
<code>EntityManager</code> as a <code>RefreshOption</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A cache mode specified for a given <code>Query</code> instance applies only to
executions of that query, but takes precedence over the current cache
mode of the <code>EntityManager</code> to which the <code>Query</code> belongs. A cache mode
passed to <code>find()</code> or <code>refresh()</code> applies only to the method invocation,
and takes precedence over the current cache mode of the <code>EntityManager</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, a cache mode may be specified using the property name
<code>jakarta.persistence.cache.retrieveMode</code> or
<code>jakarta.persistence.cache.storeMode</code> by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>calling the <code>setProperty()</code> method of <code>EntityManager</code>,</p>
</li>
<li>
<p>calling the <code>setHint()</code> method of <code>Query</code>, or</p>
</li>
<li>
<p>passing a map containing one of these properties to <code>find()</code> or <code>refresh()</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If second-level caching is not enabled (for example, if the
<code>shared-cache-mode</code> element is set to <code>NONE</code>), cache modes must be
ignored. Similarly, if a given entity is not eligible for storage in
the second-level cache (for example, if the <code>shared-cache-mode</code> element
is set to <code>ENABLE_SELECTIVE</code>, and the entity is not annotated <code>@Cacheable</code>),
cache modes are ignored for operations applying to that entity.</p>
</div>
<div class="paragraph">
<p>Cache modes must be respected when caching is enabled, regardless of
whether caching is enabled via the configuration options defined by this
specification or via provider-specific mechanisms.</p>
</div>
<div class="paragraph">
<p>Applications which depend on the cache retrieve mode or cache store mode
but which do not specify the <code>shared-cache-mode</code> element are not portable.</p>
</div>
<div class="paragraph">
<p><code>CacheRetrieveMode</code> enumerates the cache retrieve modes recognized by this
specification. The semantics of each mode is defined by its Javadoc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Specifies how the {@link EntityManager} interacts with the
 * second-level cache when data is read from the database via
 * the {@link EntityManager#find} methods and execution of
 * queries.
 * &lt;ul&gt;
 * &lt;li&gt;{@link #USE} indicates that data may be read from the
 *     second-level cache.
 * &lt;li&gt;{@link #BYPASS} indicates that data may not be read
 *     from the second-level cache.
 * &lt;/ul&gt;
 *
 * &lt;p&gt;Enumerates legal values of the property
 * {@code jakarta.persistence.cache.retrieveMode}.
 *
 * @see EntityManager#setCacheRetrieveMode(CacheRetrieveMode)
 * @see Query#setCacheRetrieveMode(CacheRetrieveMode)
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> CacheRetrieveMode <span class="directive">implements</span> FindOption {

    <span class="comment">/**
     * Read entity data from the cache: this is the default
     * behavior.
     */</span>
    USE,

    <span class="comment">/**
     * Bypass the cache: get data directly from the database.
     */</span>
    BYPASS  
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>CacheStoreMode</code> enumerates the cache store modes recognized by this
specification. The semantics of each mode is defined by its Javadoc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Specifies how the {@link EntityManager} interacts with the
 * second-level cache when data is read from the database and
 * when data is written to the database.
 * &lt;ul&gt;
 * &lt;li&gt;{@link #USE} indicates that data may be written to the
 *     second-level cache.
 * &lt;li&gt;{@link #BYPASS} indicates that data may not be written
 *     to the second-level cache.
 * &lt;li&gt;{@link #REFRESH} indicates that data must be written
 *     to the second-level cache, even when the data is already
 *     cached.
 * &lt;/ul&gt;
 *
 * &lt;p&gt;Enumerates legal values of the property
 * {@code jakarta.persistence.cache.storeMode}.
 *
 * @see EntityManager#setCacheStoreMode(CacheStoreMode)
 * @see Query#setCacheStoreMode(CacheStoreMode)
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> CacheStoreMode <span class="directive">implements</span> FindOption, RefreshOption {

    <span class="comment">/**
     * Insert entity data into cache when read from database and
     * insert/update entity data when written to the database:
     * this is the default behavior. Does not force refresh of
     * already cached items when reading from database.
     */</span>
    USE,

    <span class="comment">/**
     * Don't insert into cache. 
     */</span>
    BYPASS,

    <span class="comment">/**
     * Insert/update entity data held in the cache when read from
     * the database and when written to the database. Force refresh
     * of cache for items read from database.
     */</span>
    REFRESH
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a12124"><a class="anchor" href="#a12124"></a>3.10.3. Cache Interface</h4>
<div class="paragraph">
<p>The <code>Cache</code> interface found in <a href="#_cache_">Section B.5</a> allows the application to
request eviction of entity data from the second-level cache directly
and immediately, outside the scope of any persistence context.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a3125"><a class="anchor" href="#a3125"></a>3.11. Query APIs</h3>
<div class="paragraph">
<p>The <code>Query</code> and <code>TypedQuery</code> APIs are used
for the execution of both static queries and dynamic queries. These APIs
also support parameter binding and pagination control. The
<code>StoredProcedureQuery</code> API is used for the execution of queries that
invoke stored procedures defined in the database.</p>
</div>
<div class="paragraph">
<p>These interfaces may be found in <a href="#persistence-api">Appendix B</a>.</p>
</div>
<div class="sect3">
<h4 id="query-execution"><a class="anchor" href="#query-execution"></a>3.11.1. Query Execution</h4>
<div class="paragraph">
<p>Jakarta Persistence query language, Criteria API, and native SQL
select queries are executed using the methods <code>getResultList</code>,
<code>getSingleResult</code>, and <code>getSingleResultOrNull</code>.
Update and delete operations (update and delete queries) are
executed using the <code>executeUpdate</code> method.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>TypedQuery</code> instances, the query result
type is determined in the case of criteria queries by the type of the
query specified when the <code>CriteriaQuery</code> object is created, as described
in <a href="#a10621">Section 6.3.1</a>. In the case of Jakarta Persistence query language queries, the type of the
result is determined by the <code>resultClass</code> argument to the <code>createQuery</code>
or <code>createNamedQuery</code> method, and the select list of the query must
contain only a single item which must be assignable to the specified
type.</p>
</li>
<li>
<p>For <code>Query</code> instances, the elements of a
query result whose select list consists of more than one select
expression are of type <code>Object[]</code>. If the select list consists of only
one select expression, the elements of the query result are of type
<code>Object</code>. When native SQL queries are used, the SQL result set mapping
(see <a href="#a4427">Section 3.11.11</a>), determines
how many items (entities, scalar values, etc.) are returned. If multiple
items are returned, the elements of the query result are of type
<code>Object[]</code>. If only a single item is returned as a result of the SQL
result set mapping or if a result class is specified, the elements of
the query result are of type <code>Object</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Stored procedure queries can be executed using the <code>getResultList</code>,
<code>getSingleResult</code>, <code>getSingleResultOrNull</code>, and <code>execute</code> methods.
Stored procedures that perform only updates or deletes can be executed
using the <code>executeUpdate</code> method. Stored procedure query execution is
described in detail in <a href="#a4625">Section 3.11.12.3</a>.</p>
</div>
<div class="paragraph">
<p>An <code>IllegalArgumentException</code> is thrown if a
parameter instance is specified that does not correspond to a parameter
of the query, if a parameter name is specified that does not correspond
to a named parameter of the query, if a positional value is specified
that does not correspond to a positional parameter of the query, or if
the type of the parameter is not valid for the query. This exception may
be thrown when the parameter is bound, or the execution of the query may
fail. See <a href="#a4397">Section 3.11.5</a>, <a href="#a4401">Section 3.11.6</a>, and <a href="#a4405">Section 3.11.7</a> for supported
parameter usage.</p>
</div>
<div class="paragraph">
<p>The effect of applying <code>setMaxResults</code> or
<code>setFirstResult</code> to a query involving fetch joins over collections is
undefined. The use of <code>setMaxResults</code> and <code>setFirstResult</code> is not
supported for stored procedure queries.</p>
</div>
<div class="paragraph">
<p><code>Query</code> and <code>TypedQuery</code> methods other than
the <code>executeUpdate</code> method are not required to be invoked within a
transaction context, unless a lock mode other than <code>LockModeType.NONE</code>
has been specified for the query. In particular, the <code>getResultList</code>,
<code>getSingleResult</code>, and <code>getSingleResultOrNull</code> methods are not required
to be invoked within a transaction context unless such a lock mode has
been specified for the query<sup class="footnote">[<a id="_footnoteref_57" class="footnote" href="#_footnotedef_57" title="View footnote.">57</a>]</sup>. If an entity manager with
transaction-scoped persistence context is in use, the resulting entities
will be detached; if an entity manager with an extended persistence
context is used, they will be managed. See <a href="#a11431">Chapter 7</a> for further
discussion of entity manager use outside a transaction and persistence context types.</p>
</div>
<div class="paragraph">
<p>Whether a <code>StoredProcedureQuery</code> should be
invoked in a transaction context should be determined by the
transactional semantics and/or requirements of the stored procedure
implementation and the database in use. In particular, problems may
occur if the stored procedure initiates a transaction and a transaction
is already in effect. The state of any entities returned by the stored
procedure query invocation is determined as decribed above.</p>
</div>
<div class="paragraph">
<p>Runtime exceptions other than the
<code>NoResultException</code>, <code>NonUniqueResultException</code>,
<code>QueryTimeoutException</code>, and <code>LockTimeoutException</code> thrown by the
methods of the <code>Query</code>, <code>TypedQuery</code>, and <code>StoredProcedureQuery</code>
interfaces other than those methods specified below cause the current
transaction to be marked for rollback if the persistence context is
joined to the transaction. On database platforms on which a query
timeout causes transaction rollback, the persistence provider must throw
the <code>PersistenceException</code> instead of the <code>QueryTimeoutException</code>.</p>
</div>
<div class="paragraph">
<p>Runtime exceptions thrown by the following
methods of the <code>Query</code>, <code>TypedQuery</code>, and <code>StoredProcedureQuery</code>
interfaces do not cause the current transaction to be marked for
rollback: <code>getParameters</code>, <code>getParameter</code>, <code>getParameterValue</code>,
<code>getOutputParameterValue</code>, <code>getLockMode</code>.</p>
</div>
<div class="paragraph">
<p>Runtime exceptions thrown by the methods of
the <code>Tuple</code>, <code>TupleElement</code>, and <code>Parameter</code> interfaces do not cause
the current transaction to be marked for rollback.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span> findWithName(<span class="predefined-type">String</span> name) {
    <span class="keyword">return</span> em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT c FROM Customer c WHERE c.name LIKE :custName</span><span class="delimiter">&quot;</span></span>)
        .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">custName</span><span class="delimiter">&quot;</span></span>, name)
        .setMaxResults(<span class="integer">10</span>)
        .getResultList();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a4374"><a class="anchor" href="#a4374"></a>3.11.2. Queries and Flush Mode</h4>
<div class="paragraph">
<p>The flush mode setting affects the result of
a query as follows.</p>
</div>
<div class="paragraph">
<p>When queries are executed within a
transaction, if <code>FlushModeType.AUTO</code> is set on the <code>Query</code>,
<code>TypedQuery</code>, or <code>StoredProcedureQuery</code> object, or if the flush mode
setting for the persistence context is <code>AUTO</code> (the default) and a flush
mode setting has not been specified for the query object, the
persistence provider is responsible for ensuring that all updates to the
state of all entities in the persistence context which could potentially
affect the result of the query are visible to the processing of the
query. The persistence provider implementation may achieve this by
flushing those entities to the database or by some other means. If
<code>FlushModeType.COMMIT</code> is set, the effect of updates made to entities in
the persistence context upon queries is unspecified.</p>
</div>
<div class="paragraph">
<p>If the persistence context has not been
joined to the current transaction, the persistence provider must not
flush to the database regardless of the flush mode setting.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Enumerates flush modes recognized by the {@link EntityManager}.
 *
 * &lt;p&gt;When queries are executed within a transaction, if {@link #AUTO}
 * is set on the {@link Query Query} or {@link TypedQuery} object, or
 * if the flush mode setting for the persistence context is {@code AUTO}
 * (the default) and a flush mode setting has not been specified for the
 * {@code Query} or {@code TypedQuery} object, the persistence provider
 * is responsible for ensuring that all updates to the state of all
 * entities in the persistence context which could potentially affect
 * the result of the query are visible to the processing of the query.
 * The persistence provider implementation may achieve this by flushing
 * updates to those entities to the database or by some other means.
 *
 * &lt;p&gt;On the other hand, if {@link #COMMIT} is set, the effect of updates
 * made to entities in the persistence context on queries is unspecified.
 *
 * &lt;p&gt;If there is no transaction active or the persistence context is
 * not joined to the current transaction, the persistence provider must
 * not flush to the database.
 *
 * @see EntityManager#setFlushMode(FlushModeType)
 * @see Query#setFlushMode(FlushModeType)
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> FlushModeType {

    <span class="comment">/**
     * Flushing to occur at transaction commit. The provider may flush
     * at other times, but is not required to.
     */</span>
   COMMIT,

    <span class="comment">/**
     * (Default) Flushing to occur at query execution.
     */</span>
   AUTO
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If there is no transaction active, the
persistence provider must not flush to the database.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4385"><a class="anchor" href="#a4385"></a>3.11.3. Queries and Lock Mode</h4>
<div class="paragraph">
<p>The <code>setLockMode</code> method of the
<code>Query</code> or <code>TypedQuery</code> interface or the <code>lockMode</code> element of the
<code>NamedQuery</code> annotation may be used to lock the results of a query. A
lock is obtained for each entity specified in the query result
(including entities passed to constructors in the query SELECT
clause).<sup class="footnote">[<a id="_footnoteref_58" class="footnote" href="#_footnotedef_58" title="View footnote.">58</a>]</sup></p>
</div>
<div class="paragraph">
<p>If the lock mode type is <code>PESSIMISTIC_READ</code>,
<code>PESSIMISTIC_WRITE</code>, or <code>PESSIMISTIC_FORCE_INCREMENT</code>, and the query
returns scalar data (e.g., the values of entity field or properties,
including scalar data passed to constructors in the query SELECT
clause), the underlying database rows will be
locked<sup class="footnote">[<a id="_footnoteref_59" class="footnote" href="#_footnotedef_59" title="View footnote.">59</a>]</sup>, but the version columns (if any) for any
entities corresponding to such scalar data will not be updated unless
the entities themselves are also otherwise retrieved and updated.</p>
</div>
<div class="paragraph">
<p>If the lock mode type is <code>OPTIMISTIC</code> or
<code>OPTIMISTIC_FORCE_INCREMENT</code>, and the query returns scalar data, any
entities returned by the query will be locked, but no locking will occur
for scalar data that does not correspond to the state of any entity
instance in the query result.</p>
</div>
<div class="paragraph">
<p>If a lock mode other than <code>NONE</code> is specified
for a query, the query must be executed within a transaction (and the
persistence context must be joined to the transaction) or the
<code>TransactionRequiredException</code> will be thrown.</p>
</div>
<div class="paragraph">
<p>Locking is supported for Jakarta Persistence
query language queries and criteria queries only. If the <code>setLockMode</code>
or <code>getLockMode</code> method is invoked on a query that is not a Jakarta
Persistence query language select query or a criteria query, the
<code>IllegalStateException</code> may be thrown or the query execution will fail.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4391"><a class="anchor" href="#a4391"></a>3.11.4. Query Hints</h4>
<div class="paragraph">
<p>The following hint is defined by this specification for use in query configuration.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jakarta.persistence.query.timeout // time in milliseconds</pre>
</div>
</div>
<div class="paragraph">
<p>This hint may:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>be passed to the <code>setHint()</code> method of the <code>Query</code>, <code>TypedQuery</code>,
and <code>StoredProcedureQuery</code> interfaces found in <a href="#persistence-api">Appendix B</a>,</p>
</li>
<li>
<p>used with the <code>NamedQuery</code>, <code>NamedNativeQuery</code>, and
<code>NamedStoredProcedureQuery</code> annotations specified in <a href="#a13710">Section 10.4</a>,</p>
</li>
<li>
<p>passed as a property to the <code>createEntityManagerFactory()</code> method
of the <code>Persistence</code> class, as defined in <a href="#a13443">Section 9.7</a>, or</p>
</li>
<li>
<p>used in the <code>properties</code> element of the <code>persistence.xml</code> file, as
defined in <a href="#a12384">Section 8.2.1.11</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The timeout specified by calling the <code>createEntityManagerFactory()</code>
method, via the <code>persistence.xml</code> file, or in annotations, serves as
a default value which can be selectively overridden by calling the
<code>setHint()</code> method.</p>
</div>
<div class="paragraph">
<p>Portable applications should not rely on this
hint. Depending on the persistence provider and database in use, the
hint may or may not be observed.</p>
</div>
<div class="paragraph">
<p>Vendors are permitted to support the use of
additional, vendor-specific hints. Vendor-specific hints must not use
the <code>jakarta.persistence</code> namespace. Vendor-specific hints must be ignored
if they are not understood.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4397"><a class="anchor" href="#a4397"></a>3.11.5. Parameter Objects</h4>
<div class="paragraph">
<p><code>Parameter</code> objects can be used for criteria
queries and for Jakarta Persistence query language queries.</p>
</div>
<div class="paragraph">
<p>Implementations may support the use of
<code>Parameter</code> objects for native queries, however support for <code>Parameter</code>
objects with native queries is not required by this specification. The
use of <code>Parameter</code> objects for native queries will not be portable. The
mixing of parameter objects with named or positional parameters is invalid.</p>
</div>
<div class="paragraph">
<p>Portable applications should not attempt to
reuse a <code>Parameter</code> object obtained from a <code>Query</code> or <code>TypedQuery</code>
instance in the context of a different <code>Query</code> or <code>TypedQuery</code> instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4401"><a class="anchor" href="#a4401"></a>3.11.6. Named Parameters</h4>
<div class="paragraph">
<p>Named parameters can be used for Jakarta
Persistence query language queries, for criteria queries (although use
of <code>Parameter</code> objects is to be preferred), and for stored procedure
queries that support named parameters.</p>
</div>
<div class="paragraph">
<p>Named parameters follow the rules for
identifiers defined in <a href="#a4760">Section 4.4.1</a>.
Named parameters are case-sensitive. The mixing of named and positional
parameters is invalid.</p>
</div>
<div class="paragraph">
<p>A named parameter of a Jakarta Persistence query
language query is an identifier that is prefixed by the " <em>:</em> " symbol.
The parameter names passed to the <code>setParameter</code> methods of the <code>Query</code>
and <code>TypedQuery</code> interfaces do not include this " <em>:</em> " prefix.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4405"><a class="anchor" href="#a4405"></a>3.11.7. Positional Parameters</h4>
<div class="paragraph">
<p>Only positional parameter binding and
positional access to result items may be portably used for native
queries, except for stored procedure queries for which named parameters
have been defined. When binding the values of positional parameters, the
numbering starts as  <code>1</code> . It is assumed that for native queries the
parameters themselves use the SQL syntax (i.e.,  <em>?</em> , rather than 
<em>?1</em> ).</p>
</div>
<div class="paragraph">
<p>The use of positional parameters is not supported for criteria queries.</p>
</div>
</div>
<div class="sect3">
<h4 id="arguments-to-query-parameters"><a class="anchor" href="#arguments-to-query-parameters"></a>3.11.8. Arguments to query parameters</h4>
<div class="paragraph">
<p>Arguments are assigned to query parameters by calling <code>Query.setParameter()</code>.
The first parameter of <code>setParameter()</code> identifies the named or positional
parameter of the query.</p>
</div>
<div class="paragraph">
<p>An argument may be assigned to a single-valued parameter of a JPQL or
native SQL query by passing the argument to the second parameter of
<code>setParameter()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">query.setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)</code></pre>
</div>
</div>
<div class="paragraph">
<p>A list of arguments may be assigned to a collection-valued parameter
of a JPQL query by packaging the arguments in a non-null instance of
<code>java.util.List</code> and passing the list as an argument to the second
parameter of <code>setParameter()</code>. The list should contain at least one
element. If the list is empty the behavior is undefined. Portable
applications should not pass an empty list to a collection-valued
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">query.setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">names</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">List</span>.of(name1, name2, name3))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="named-queries"><a class="anchor" href="#named-queries"></a>3.11.9. Named Queries</h4>
<div class="paragraph">
<p>Named queries are static queries expressed in
metadata or queries registered by means of the EntityManagerFactory
<code>addNamedQuery</code> method. Named queries can be defined in the Jakarta
Persistence query language or in SQL. Query names are scoped to the
persistence unit.</p>
</div>
<div class="paragraph">
<p>The following is an example of the definition
of a named query defined in metadata:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedQuery</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">findAllCustomersWithName</span><span class="delimiter">&quot;</span></span>,
    query=<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT c FROM Customer c WHERE c.name LIKE :custName</span><span class="delimiter">&quot;</span></span>
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is an example of the use of a named query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PersistenceContext</span>
<span class="directive">public</span> EntityManager em;
    <span class="comment">// ...</span>

    customers = em.createNamedQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">findAllCustomersWithName</span><span class="delimiter">&quot;</span></span>)
        .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">custName</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>)
        .getResultList();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="polymorphic-queries"><a class="anchor" href="#polymorphic-queries"></a>3.11.10. Polymorphic Queries</h4>
<div class="paragraph">
<p>By default, all queries are polymorphic. That
is, the FROM clause of a query designates not only instances of the
specific entity class(es) to which it explicitly refers, but subclasses
as well. The instances returned by a query include instances of the
subclasses that satisfy the query conditions.</p>
</div>
<div class="paragraph">
<p>For example, the following query returns the
average salary of all employees, including subtypes of <code>Employee</code>, such
as <code>Manager</code> and <code>Exempt</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">select</span> <span class="predefined">avg</span>(e.salary) <span class="keyword">from</span> Employee e <span class="keyword">where</span> e.salary &gt; <span class="integer">80000</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Entity type expressions, described in <a href="#a5381">Section 4.7.12</a>, as well as the
use of downcasting, described in <a href="#a4965">Section 4.4.9</a>, can be used to restrict query polymorphism.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4427"><a class="anchor" href="#a4427"></a>3.11.11. SQL Queries</h4>
<div class="paragraph">
<p>Queries may be expressed in native SQL. The
result of a native SQL query may consist of entities, unmanaged
instances created via constructors, scalar values, or some combination
of these.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The SQL query facility is intended to provide
support for those cases where it is necessary to use the native SQL of
the target database in use (and/or where the Jakarta Persistence query
language cannot be used). Native SQL queries are not expected to be
portable across databases.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="returning-managed-entities-from-native-queries"><a class="anchor" href="#returning-managed-entities-from-native-queries"></a>3.11.11.1. Returning Managed Entities from Native Queries</h5>
<div class="paragraph">
<p>The persistence provider is responsible for
performing the mapping between the values returned by the SQL query and
entity attributes in accordance with the object/relational mapping
metadata for the entity or entities. In particular, the names of the
columns in the SQL result are used to map to the entity attributes as
defined by this metadata. This mapping includes the mapping of the
attributes of any embeddable classes that are part of the
non-collection-valued entity state and attributes corresponding to
foreign keys contained as part of the entity
state<sup class="footnote">[<a id="_footnoteref_60" class="footnote" href="#_footnotedef_60" title="View footnote.">60</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>When an entity is to be returned from a
native query, the SQL statement should select all of the columns that
are mapped to the entity object. This should include foreign key columns
to related entities. The results obtained when insufficient data is
available are undefined.</p>
</div>
<div class="paragraph">
<p>In the simplest casei.e., when the results
of the query are limited to entities of a single entity class and the
mapping information can be derived from the columns of the SQL result
and the object/relational mapping metadatait is sufficient to specify
only the expected class of the entity result.</p>
</div>
<div class="paragraph">
<p>The following example illustrates the case
where a native SQL query is created dynamically using the
<code>createNativeQuery</code> method and the entity class that specifies the type
of the result is passed in as an argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id, o.quantity, o.item </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (o.item = i.id) AND (i.name = 'widget')</span><span class="delimiter">&quot;</span></span>,
    com.acme.Order.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When executed, this query will return a
collection of all <code>Order</code> entities for items named widget.</p>
</div>
<div class="paragraph">
<p>The <code>SqlResultSetMapping</code> metadata
annotationwhich is designed to handle more complex casescan be used as
an alternative here. See <a href="#a13797">Section 10.4.4</a> for the definition of the
<code>SqlResultSetMapping</code> metadata annotation and related annotations.</p>
</div>
<div class="paragraph">
<p>For the query shown above, the
<code>SqlResultSetMapping</code> metadata for the query result type might be
specified as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlResultSetMapping</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WidgetOrderResults</span><span class="delimiter">&quot;</span></span>,
    entities=<span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same results as produced by the query
above can then obtained by the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id, o.quantity, o.item </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (o.item = i.id) AND (i.name = 'widget')</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">WidgetOrderResults</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When multiple entities are returned by a SQL
query or when the column names of the SQL result do not correspond to
those of the object/relational mapping metadata, a <code>SqlResultSetMapping</code>
metadata definition must be provided to specify the entity mapping.</p>
</div>
<div class="paragraph">
<p>The following query and <code>SqlResultSetMapping</code>
metadata illustrates the return of multiple entity types. It assumes
default metadata and column name defaults.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id, o.quantity, o.item, i.id, i.name, i.description </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (o.quantity &gt; 25) AND (o.item = i.id)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class),
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Item.class)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the column names of the SQL result do
not correspond to those of the object/relational mapping metadata
or introduce a conflict in mapping column defaults as in the example code above,
more explicit SQL result mapping metadata must be provided to enable the
persistence provider runtime to map the JDBC results into the expected
objects. This might arise, for example, when column aliases must be used
in the SQL SELECT clause when the SQL result would otherwise contain
multiple columns of the same name or when columns in the SQL result are
the results of operators or functions. The <code>FieldResult</code> annotation
element within the <code>EntityResult</code> annotation is used to specify the
mapping of such columns to entity attributes.</p>
</div>
<div class="paragraph">
<p>The following example combining multiple
entity types includes aliases in the SQL statement. This requires that
the column names be explicitly mapped to the entity fields corresponding
to those columns. The <code>FieldResult</code> annotation is used for this purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id AS order_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.quantity AS order_quantity, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item AS order_item, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.id, i.name, i.description </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (order_quantity &gt; 25) AND (order_item = i.id)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class, fields={
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_quantity</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item</span><span class="delimiter">&quot;</span></span>)}),
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Item.class)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the returned entity type contains an
embeddable class, the <code>FieldResult</code> element must use a dot ( <code>.</code> )
notation to indicate which column maps to which field or property of the
contained embeddable.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT c.id AS customer_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">c.street AS customer_street, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">c.city AS customer_city, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">c.state AS customer_state, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">c.status AS customer_status </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Customer c </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE c.status = 'GOLD' </span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">CustomerResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="error"></span>CustomerResults<span class="error"></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Customer.class, fields={
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address.street</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_street</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address.city</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_city</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address.state</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_state</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_status</span><span class="delimiter">&quot;</span></span>)
    })
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the returned entity type is the owner of
a single-valued relationship and the foreign key is a composite foreign
key (composed of multiple columns), a <code>FieldResult</code> element should be
used for each of the foreign key columns. The <code>FieldResult</code> element must
use the dot ( <code>.</code> ) notation form to indicate the column that maps to
each property or field of the target entity primary key.</p>
</div>
<div class="paragraph">
<p>If the target entity has a primary key of
type <code>IdClass</code>, this specification takes the form of the name of the
field or property for the relationship, followed by a dot ( <code>.</code> ),
followed by the name of the field or property of the primary key in the
target entity. The latter will be annotated with <code>Id</code>, as specified in
<a href="#a14836">Section 11.1.23</a>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id AS order_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.quantity AS order_quantity, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item_id AS order_item_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item_name AS order_item_name, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.id, i.name, i.description </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (order_quantity &gt; 25) AND (order_item_id = i.id) </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">AND (order_item_name = i.name)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class, fields={
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_quantity</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item.id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item_id</span><span class="delimiter">&quot;</span></span>)}),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item.name</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item_name</span><span class="delimiter">&quot;</span></span>)}),
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Item.class)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the target entity has a primary key of
type <code>EmbeddedId</code>, this specification is composed of the name of the
field or property for the relationship, followed by a dot ( <code>.</code> ),
followed by the name or the field or property of the primary key (i.e.,
the name of the field or property annotated as <code>EmbeddedId</code>), followed
by the name of the corresponding field or property of the embedded
primary key class.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id AS order_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.quantity AS order_quantity, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item_id AS order_item_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item_name AS order_item_name, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.id, i.name, i.description </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (order_quantity &gt; 25) AND (order_item_id = i.id) AND (order_item_name = i.name)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class, fields={
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_quantity</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item.itemPk.id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item_id</span><span class="delimiter">&quot;</span></span>)}),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item.itemPk.name</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item_name</span><span class="delimiter">&quot;</span></span>)}),
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Item.class)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>FieldResult</code> elements for the composite
foreign key are combined to form the primary key <code>EmbeddedId</code> class for
the target entity. This may then be used to subsequently retrieve the
entity if the relationship is to be eagerly loaded.</p>
</div>
<div class="paragraph">
<p>The dot-notation form is not required to be
supported for any usage other than for embeddables, composite foreign
keys, or composite primary keys.</p>
</div>
</div>
<div class="sect4">
<h5 id="returning-unmanaged-instances"><a class="anchor" href="#returning-unmanaged-instances"></a>3.11.11.2. Returning Unmanaged Instances</h5>
<div class="paragraph">
<p>Instances of other classes (including
non-managed entity instances) as well as scalar results can be returned
by a native query. These can be used singly, or in combination,
including with entity results.</p>
</div>
<div class="sect5">
<h6 id="scalar-results"><a class="anchor" href="#scalar-results"></a>Scalar Results</h6>
<div class="paragraph">
<p>Scalar results can be included in the query
result by specifying the <code>ColumnResult</code> annotation element of the
<code>SqlResultSetMapping</code> annotation. The intended type of the result can be
specified using the <code>type</code> element of the <code>ColumnResult</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id AS order_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.quantity AS order_quantity, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item AS order_item, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.name AS item_name, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.availabilityDate AS item_shipdate </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (order_quantity &gt; 25) AND (order_item = i.id)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderResults</span><span class="delimiter">&quot;</span></span>,
    entities={
        <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class, fields={
            <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_id</span><span class="delimiter">&quot;</span></span>),
            <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_quantity</span><span class="delimiter">&quot;</span></span>),
            <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item</span><span class="delimiter">&quot;</span></span>)}
        )},
    columns={
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item_name</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item_shipdate</span><span class="delimiter">&quot;</span></span>, type=java.util.Date.class)
    })</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="constructor-results"><a class="anchor" href="#constructor-results"></a>Constructor Results</h6>
<div class="paragraph">
<p>The mapping to constructors is specified
using the <code>ConstructorResult</code> annotation element of the
<code>SqlResultSetMapping</code> annotation. The <code>targetClass</code> element of the
<code>ConstructorResult</code> annotation specifies the class whose constructor
corresponds to the specified columns. All columns corresponding to
arguments of the intended constructor must be specified using the
<code>columns</code> element of the <code>ConstructorResult</code> annotation in the same
order as that of the argument list of the constructor. Any entities
returned as constructor results will be in either the new or the
detached state, depending on whether a primary key is retrieved for the
constructed object.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT c.id, c.name, COUNT(o) as orderCount, AVG(o.price) AS avgOrder </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Customer c, Orders o </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE o.cid = c.id </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">GROUP BY c.id, c.name</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">CustomerDetailsResult</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CustomerDetailsResult</span><span class="delimiter">&quot;</span></span>, classes={
    <span class="annotation">@ConstructorResult</span>(targetClass=com.acme.CustomerDetails.class, columns={
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">orderCount</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">avgOrder</span><span class="delimiter">&quot;</span></span>, type=<span class="predefined-type">Double</span>.class)})
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="combinations-of-result-types"><a class="anchor" href="#combinations-of-result-types"></a>3.11.11.3. Combinations of Result Types</h5>
<div class="paragraph">
<p>When a <code>SqlResultSetMapping</code> specifies more
than one mapping type (i.e., more than one of <code>EntityResult</code>,
<code>ConstructorResult</code>, <code>ColumnResult</code>), then for each row in the SQL
result, the query execution will result in an <code>Object[]</code> instance whose
elements are as follows, in order: any entity results (in the order in
which they are defined in the <code>entities</code> element); any instances of
classes corresponding to constructor results (in the order defined in
the <code>classes</code> element); and any instances corresponding to column
results (in the order defined in the <code>columns</code> element). If there are
any columns whose result mappings have not been specified, they are
ignored.</p>
</div>
</div>
<div class="sect4">
<h5 id="restrictions"><a class="anchor" href="#restrictions"></a>3.11.11.4. Restrictions</h5>
<div class="paragraph">
<p>When an entity is being returned, the SQL
statement should select all of the columns that are mapped to the entity
object. This should include foreign key columns to related entities. The
results obtained when insufficient data is available are undefined. A
SQL result set mapping must not be used to map results to the
non-persistent state of an entity.</p>
</div>
<div class="paragraph">
<p>The use of named parameters is not defined
for native SQL queries. Only positional parameter binding for SQL
queries may be used by portable applications.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="stored-procedures"><a class="anchor" href="#stored-procedures"></a>3.11.12. Stored Procedures</h4>
<div class="paragraph">
<p>The <code>StoredProcedureQuery</code> interface supports
the use of database stored procedures.</p>
</div>
<div class="paragraph">
<p>Stored procedures can be specified either by
means of the <code>NamedStoredProcedureQuery</code> annotation or dynamically.
Annotations for the specification of stored procedures are described in
<a href="#a13759">Section 10.4.3</a>.</p>
</div>
<div class="sect4">
<h5 id="named-stored-procedure-queries"><a class="anchor" href="#named-stored-procedure-queries"></a>3.11.12.1. Named Stored Procedure Queries</h5>
<div class="paragraph">
<p>Unlike in the case of a named native query,
the <code>NamedStoredProcedureQuery</code> annotation names a stored procedure that
exists in the database rather than providing a stored procedure
definition. The <code>NamedStoredProcedureQuery</code> annotation specifies the
types of all parameters to the stored procedure, their corresponding
parameter modes (IN, OUT, INOUT, REF_CURSOR<sup class="footnote">[<a id="_footnoteref_61" class="footnote" href="#_footnotedef_61" title="View footnote.">61</a>]</sup>), and
how result sets, if any, are to be mapped. The name that is assigned to
the stored procedure in the <code>NamedStoredProcedureQuery</code> annotation is
passed as an argument to the <code>createNamedStoredProcedureQuery</code> method to
create an executable <code>StoredProcedureQuery</code> object.</p>
</div>
<div class="paragraph">
<p>A stored procedure may return more than one
result set. As with native queries, the mapping of result sets can be
specified either in terms of a <code>resultClasses</code> or as a
<code>resultSetMappings</code> annotation element. If there are multiple result
sets, it is assumed that they will be mapped using the same mechanism 
e.g., all via a set of result class mappings or all via a set of result
set mappings. The order of the specification of these mappings must be
the same as the order in which the result sets will be returned by the
stored procedure invocation. If the stored procedure returns one or more
result sets and no <code>resultClasses</code> or <code>resultSetMappings</code> element has
been specified, any result set will be returned as a list of type
<code>Object[]</code>. The combining of different strategies for the mapping of
stored procedure result sets is undefined.</p>
</div>
<div class="paragraph">
<p><code>StoredProcedureParameter</code> metadata needs to
be provided for all parameters. Parameters must be specified in the
order in which they occur in the parameter list of the stored procedure.
If parameter names are used, the parameter name is used to bind the
parameter value and to extract the output value (if the parameter is an
INOUT or OUT parameter). If parameter names are not specified, it is
assumed that positional parameters are used. The mixing of named and
positional parameters is invalid.</p>
</div>
</div>
<div class="sect4">
<h5 id="dynamically-specified-stored-procedure-queries"><a class="anchor" href="#dynamically-specified-stored-procedure-queries"></a>3.11.12.2. Dynamically-specified Stored Procedure Queries</h5>
<div class="paragraph">
<p>If the stored procedure is not defined using
metadata, parameter and result set information must be provided
dynamically.</p>
</div>
<div class="paragraph">
<p>All parameters of a dynamically-specified
stored procedure query must be registered using the
<code>registerStoredProcedureParameter</code> method of the <code>StoredProcedureQuery</code>
interface.</p>
</div>
<div class="paragraph">
<p>Result set mapping information can be
provided by means of the <code>createStoredProcedureQuery</code> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="a4625"><a class="anchor" href="#a4625"></a>3.11.12.3. Stored Procedure Query Execution</h5>
<div class="paragraph">
<p>Stored procedure query execution can be
controlled as described below.</p>
</div>
<div class="paragraph">
<p>The <code>setParameter</code> methods are used to set
the values of all required IN and INOUT parameters. It is not required
to set the values of stored procedure parameters for which default
values have been defined by the stored procedure.</p>
</div>
<div class="paragraph">
<p>When <code>getResultList</code>, <code>getSingleResult</code>, and <code>getSingleResultOrNull</code>
are called on a <code>StoredProcedureQuery</code> object, the persistence provider
will call <code>execute</code> on an unexecuted stored procedure query before
processing <code>getResultList</code>, <code>getSingleResult</code> or <code>getSingleResultOrNull</code>.</p>
</div>
<div class="paragraph">
<p>When <code>executeUpdate</code> is called on a
<code>StoredProcedureQuery</code> object, the persistence provider will call
<code>execute</code> on an unexecuted stored procedure query followed by
<code>getUpdateCount</code>. The results of <code>executeUpdate</code> will be those of
<code>getUpdateCount</code>.</p>
</div>
<div class="paragraph">
<p>The <code>execute</code> method supports both the simple
case where scalar results are passed back only via INOUT and OUT
parameters as well as the most general case (multiple result sets and/or
update counts, possibly also in combination with output parameter
values).</p>
</div>
<div class="paragraph">
<p>The <code>execute</code> method returns <code>true</code> if the
first result is a result set, and <code>false</code> if it is an update count or
there are no results other than through INOUT and OUT parameters, if
any.</p>
</div>
<div class="paragraph">
<p>If the <code>execute</code> method returns <code>true</code>, the pending result set can be
obtained by calling <code>getResultList</code>, <code>getSingleResult</code>, or
<code>getSingleResultOrNull</code>. The <code>hasMoreResults</code> method can then be used to
test for further results.</p>
</div>
<div class="paragraph">
<p>If <code>execute</code> or <code>hasMoreResults</code> returns
<code>false</code>, the <code>getUpdateCount</code> method can be called to obtain the
pending result if it is an update count. The <code>getUpdateCount</code> method
will return either the update count (zero or greater) or -1 if there is
no update count (i.e., either the next result is a result set or there
is no next update count).</p>
</div>
<div class="paragraph">
<p>For portability, results that correspond to
JDBC result sets and update counts need to be processed before the
values of any INOUT or OUT parameters are extracted.</p>
</div>
<div class="paragraph">
<p>After results returned through
<code>getResultList</code> and <code>getUpdateCount</code> have been exhausted, results
returned through INOUT and OUT parameters can be retrieved.</p>
</div>
<div class="paragraph">
<p>The <code>getOutputParameterValue</code> methods are
used to retrieve the values passed back from the procedure through INOUT
and OUT parameters.</p>
</div>
<div class="paragraph">
<p>When using <code>REF_CURSOR</code> parameters for result
sets, the update counts should be exhausted before calling
<code>getResultList</code> to retrieve the result set. Alternatively, the
<code>REF_CURSOR</code> result set can be retrieved through
<code>getOutputParameterValue</code>. Result set mappings will be applied to
results corresponding to <code>REF_CURSOR</code> parameters in the order the
<code>REF_CURSOR</code> parameters were registered with the query.</p>
</div>
<div class="paragraph">
<p>In the simplest case, where results are
returned only via INOUT and OUT parameters, <code>execute</code> can be followed
immediately by calls to <code>getOutputParameterValue</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a4639"><a class="anchor" href="#a4639"></a>3.12. Summary of Exceptions</h3>
<div class="paragraph">
<p>The following is a summary of the exceptions defined by this specification:</p>
</div>
<div class="paragraph">
<p><strong>PersistenceException</strong></p>
</div>
<div class="paragraph">
<p>The <code>PersistenceException</code> is thrown by the
persistence provider when a problem occurs. It may be thrown to report
that the invoked operation could not complete because of an unexpected
error (e.g., failure of the persistence provider to open a database
connection).</p>
</div>
<div class="paragraph">
<p>All other exceptions defined by this
specification are subclasses of the <code>PersistenceException</code>. All
instances of <code>PersistenceException</code> except for instances of
<code>NoResultException</code>, <code>NonUniqueResultException</code>, <code>LockTimeoutException</code>
, and <code>QueryTimeoutException</code> will cause the current transaction, if one
is active and the persistence context has been joined to it, to be
marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>TransactionRequiredException</strong></p>
</div>
<div class="paragraph">
<p>The <code>TransactionRequiredException</code> is thrown
by the persistence provider when a transaction is required but is not
active.</p>
</div>
<div class="paragraph">
<p><strong>OptimisticLockException</strong></p>
</div>
<div class="paragraph">
<p>The <code>OptimisticLockException</code> is thrown by
the persistence provider when an optimistic locking conflict occurs.
This exception may be thrown as part of an API call, at flush, or at
commit time. The current transaction, if one is active, will be marked
for rollback.</p>
</div>
<div class="paragraph">
<p><strong>PessimisticLockException</strong></p>
</div>
<div class="paragraph">
<p>The <code>PessimisticLockException</code> is thrown by
the persistence provider when a pessimistic locking conflict occurs. The
current transaction will be marked for rollback. Typically the
<code>PessimisticLockException</code> occurs because the database transaction has
been rolled back due to deadlock or because the database uses
transaction-level rollback when a pessimistic lock cannot be granted.</p>
</div>
<div class="paragraph">
<p><strong>LockTimeoutException</strong></p>
</div>
<div class="paragraph">
<p>The <code>LockTimeoutException</code> is thrown by the
persistence provider when a pessimistic locking conflict occurs that
does not result in transaction rollback. Typically this occurs because
the database uses statement-level rollback when a pessimistic lock
cannot be granted (and there is no deadlock). The <code>LockTimeoutException</code>
does not cause the current transaction to be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>RollbackException</strong></p>
</div>
<div class="paragraph">
<p>The <code>RollbackException</code> is thrown by the
persistence provider when <code>EntityTransaction.commit</code> fails.</p>
</div>
<div class="paragraph">
<p><strong>EntityExistsException</strong></p>
</div>
<div class="paragraph">
<p>The <code>EntityExistsException</code> may thrown by the
persistence provider when the <code>persist</code> operation is invoked and the
entity already exists. The <code>EntityExistsException</code> may be thrown when
the persist operation is invoked, or the <code>EntityExistsException</code> or
another <code>PersistenceException</code> may be thrown at commit time. The current
transaction, if one is active and the persistence context has been
joined to it, will be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>EntityNotFoundException</strong></p>
</div>
<div class="paragraph">
<p>The <code>EntityNotFoundException</code> is thrown by
the persistence provider when an entity reference obtained by
<code>getReference</code> is accessed but the entity does not exist. It is thrown
by the <code>refresh</code> operation when the entity no longer exists in the
database. It is also thrown by the <code>lock</code> operation when pessimistic
locking is used and the entity no longer exists in the database. The
current transaction, if one is active and the persistence context has
been joined to it, will be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>NoResultException</strong></p>
</div>
<div class="paragraph">
<p>The <code>NoResultException</code> is thrown by the persistence provider when
<code>Query.getSingleResult</code> is invoked and there is no result to return.
This exception will not cause the current transaction, if one is
active, to be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>NonUniqueResultException</strong></p>
</div>
<div class="paragraph">
<p>The <code>NonUniqueResultException</code> is thrown by the persistence provider
when <code>Query.getSingleResult</code> or <code>Query.getSingleResultOrNull</code> is
invoked and there is more than one result from the query. This
exception will not cause the current transaction, if one is active,
to be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>QueryTimeoutException</strong></p>
</div>
<div class="paragraph">
<p>The <code>QueryTimeoutException</code> is thrown by the
persistence provider when a query times out and only the statement is
rolled back. The <code>QueryTimeoutException</code> does not cause the current
transaction, if one is active, to be marked for rollback.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a4665"><a class="anchor" href="#a4665"></a>4. Query Language</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Jakarta Persistence query language is a
string-based query language used to define queries over entities and
their persistent state. It enables the application developer to specify
the semantics of queries in a portable way, independent of the
particular database schema in use in an enterprise environment. The full
range of the language may be used in both static and dynamic queries.</p>
</div>
<div class="paragraph">
<p>This chapter provides the full definition of
the Jakarta Persistence query language.</p>
</div>
<div class="sect2">
<h3 id="overview-2"><a class="anchor" href="#overview-2"></a>4.1. Overview</h3>
<div class="paragraph">
<p>The Jakarta Persistence query language is a
query specification language for string-based dynamic queries and static
queries expressed through metadata. It is used to define queries over
the persistent entities defined by this specification and their
persistent state and relationships.</p>
</div>
<div class="paragraph">
<p>The Jakarta Persistence query language can be
compiled to a target language, such as SQL, of a database or other
persistent store. This allows the execution of queries to be shifted to
the native language facilities provided by the database, instead of
requiring queries to be executed on the runtime representation of the
entity state. As a result, query methods can be optimizable as well as
portable.</p>
</div>
<div class="paragraph">
<p>The query language uses the abstract
persistence schema of entities, including their embedded objects and
relationships, for its data model, and it defines operators and
expressions based on this data model. It uses a SQL-like syntax to
select objects or values based on abstract schema types and
relationships. It is possible to parse and validate queries before
entities are deployed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The term abstract persistence schema refers
to the persistent schema abstraction (persistent entities, their state,
and their relationships) over which Jakarta Persistence queries operate.
Queries over this persistent schema abstraction are translated into
queries that are executed over the database schema to which entities are
mapped.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Queries may be defined in metadata
annotations or the XML descriptor. The abstract schema types of a set of
entities can be used in a query if the entities are defined in the same
persistence unit as the query. Path expressions allow for navigation
over relationships defined in the persistence unit.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A persistence unit defines the set of all
classes that are related or grouped by the application and which must be
colocated in their mapping to a single database.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="statement-types"><a class="anchor" href="#statement-types"></a>4.2. Statement Types</h3>
<div class="paragraph">
<p>A Jakarta Persistence query language statement
may be either a select statement, an update statement, or a delete
statement.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This chapter refers to all such statements as
queries. Where it is important to distinguish among statement types,
the specific statement type is referenced.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In BNF syntax, a query language statement is
defined as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>QL_statement ::= select_statement | update_statement | delete_statement</pre>
</div>
</div>
<div class="paragraph">
<p>Any Jakarta Persistence query language statement
may be constructed dynamically or may be statically defined in a
metadata annotation or XML descriptor element.</p>
</div>
<div class="paragraph">
<p>All statement types may have parameters.</p>
</div>
<div class="sect3">
<h4 id="select-statements"><a class="anchor" href="#select-statements"></a>4.2.1. Select Statements</h4>
<div class="paragraph">
<p>A select query is a string with the following clauses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a SELECT clause, which determines the type of
the objects or values to be selected.</p>
</li>
<li>
<p>a FROM clause, which provides declarations
that designate the domain to which the expressions specified in the
other clauses of the query apply.</p>
</li>
<li>
<p>an optional WHERE clause, which may be used
to restrict the results that are returned by the query.</p>
</li>
<li>
<p>an optional GROUP BY clause, which allows
query results to be aggregated in terms of groups.</p>
</li>
<li>
<p>an optional HAVING clause, which allows
filtering over aggregated groups.</p>
</li>
<li>
<p>an optional ORDER BY clause, which may be
used to order the results that are returned by the query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In BNF syntax, a select query is defined by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>select_query ::= [select_clause]? from_clause [where_clause] [groupby_clause] [having_clause] [orderby_clause]</pre>
</div>
</div>
<div class="paragraph">
<p>Every select statement has a FROM clause. The square brackets <code>[]</code> in the
BNF indicate that the other clauses are optional.</p>
</div>
<div class="sect4">
<h5 id="set-operators-in-select-statements"><a class="anchor" href="#set-operators-in-select-statements"></a>4.2.1.1. Set Operators in Select Statements</h5>
<div class="paragraph">
<p>A select statement may be a single select query, or it may combine
multiple select queries using the binary left-associative operators
<code>UNION</code>, <code>UNION ALL</code>, <code>INTERSECT</code>, <code>INTERSECT ALL</code>, <code>EXCEPT</code>, and
<code>EXCEPT ALL</code>. The semantics of these operators are identical to SQL.
<sup class="footnote">[<a id="_footnoteref_62" class="footnote" href="#_footnotedef_62" title="View footnote.">62</a>]</sup></p>
</div>
<div class="paragraph">
<p>The full syntax for a select statement is defined by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>select_statement ::= union
union ::= intersection | union {UNION [ALL] | EXCEPT [ALL]} intersection
intersection ::= query_expression | intersection INTERSECT [ALL] query_expression
query_expression ::= select_query | (union)</pre>
</div>
</div>
<div class="paragraph">
<p>A provider is only required to support select statements where every
constituent select query has the same number of items in the select
clause, and where corresponding items in the select clauses of the
constituent select queries either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>have exactly the same type, as defined by <a href="#a5439">Section 4.9.1</a>, or</p>
</li>
<li>
<p>are entity types which inherit a common entity type, as defined
by <a href="#a765">Section 2.13</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="update-and-delete-statements"><a class="anchor" href="#update-and-delete-statements"></a>4.2.2. Update and Delete Statements</h4>
<div class="paragraph">
<p>Update and delete statements provide bulk
operations over sets of entities.</p>
</div>
<div class="paragraph">
<p>In BNF syntax, these operations are defined by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>update_statement ::= update_clause [where_clause]
delete_statement ::= delete_clause [where_clause]</pre>
</div>
</div>
<div class="paragraph">
<p>The update and delete clauses determine the
type of the entities to be updated or deleted. The WHERE clause may be
used to restrict the scope of the update or delete operation.</p>
</div>
<div class="paragraph">
<p>Update and delete statements are described
further in <a href="#a5636">Section 4.11</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="abstract-schema-types-and-query-domains"><a class="anchor" href="#abstract-schema-types-and-query-domains"></a>4.3. Abstract Schema Types and Query Domains</h3>
<div class="paragraph">
<p>The Jakarta Persistence query language is a
typed language, and every expression has a type. The type of an
expression is derived from the structure of the expression, the abstract
schema types of the identification variable declarations, the types to
which the persistent attributes evaluate, and the types of literals.</p>
</div>
<div class="paragraph">
<p>The abstract schema type of an entity or
embeddable is derived from its class and the metadata information
provided by Java language annotations or in the XML descriptor.</p>
</div>
<div class="paragraph">
<p>Informally, the abstract schema type of an
entity or embeddable can be characterized as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For every non-relationship persistent field
or get accessor method (for a persistent property) of the class, there
is a field (state field) whose abstract schema type corresponds to
that of the field or the result type of the accessor method.</p>
</li>
<li>
<p>For every persistent relationship field or
get accessor method (for a persistent relationship property) of the
class, there is a field (association field) whose type is the abstract
schema type of the related entity (or, if the relationship is a
one-to-many or many-to-many, a collection of such).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Abstract schema types are specific to the
query language data model. The persistence provider is not required to
implement or otherwise materialize an abstract schema type.</p>
</div>
<div class="paragraph">
<p>The domain of a query consists of the
abstract schema types of all entities and embeddables that are defined
in the same persistence unit.</p>
</div>
<div class="paragraph">
<p>The domain of a query may be restricted by
the <code>navigability</code> of the relationships of the entity and associated
embeddable classes on which it is based. The association fields of an
entity&#8217;s or embeddable&#8217;s abstract schema type determine navigability.
Using the association fields and their values, a query can select
related entities and use their abstract schema types in the query.</p>
</div>
<div class="sect3">
<h4 id="naming"><a class="anchor" href="#naming"></a>4.3.1. Naming</h4>
<div class="paragraph">
<p>Entities are designated in query strings by
their entity names. The entity name is defined by the <code>name</code> element of
the <code>Entity</code> annotation (or the <code>entity-name</code> XML descriptor element),
and defaults to the unqualified name of the entity class. Entity names
are scoped within the persistence unit and must be unique within the
persistence unit.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4713"><a class="anchor" href="#a4713"></a>4.3.2. Example</h4>
<div class="paragraph">
<p>This example assumes that the application
developer provides several entity classes, representing orders,
products, and line items, and an embeddable address class representing
shipping addresses and billing addresses. The abstract schema types for
the entities are <code>Order</code>, <code>Product</code>, and <code>LineItem</code> respectively.
There is a one-to-many relationship between <code>Order</code> and <code>LineItem</code>. The
entity <code>LineItem</code> is related to <code>Product</code> in a many-to-one relationship.
The classes are logically in the same persistence unit, as shown in
<a href="#a4724">Figure 1</a>.</p>
</div>
<div class="paragraph">
<p>Queries to select orders can be defined by
navigating over the association fields and state fields defined by
<code>Order</code> and <code>LineItem</code>. A query to find all orders with pending line
items might be written as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> o <span class="keyword">JOIN</span> o.lineItems <span class="keyword">AS</span> l
<span class="keyword">WHERE</span> l.shipped = <span class="predefined-constant">FALSE</span></code></pre>
</div>
</div>
<div id="a4724" class="imageblock">
<div class="content">
<img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4wLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLVNWRy0yMDAxMDkwNC9EVEQvc3ZnMTAuZHRkIj4KPCEtLSBHZW5lcmF0byBkYSBNaWNyb3NvZnQgVmlzaW8gMTEuMCwgU1ZHIEV4cG9ydCwgdjEuMCBQZXItNi5zdmcgUGFnaW5hIDEgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp2PSJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3Zpc2lvLzIwMDMvU1ZHRXh0ZW5zaW9ucy8iIHdpZHRoPSI1LjA2aW4iCgkJaGVpZ2h0PSIyLjM4MjgzaW4iIHZpZXdCb3g9IjAgMCAzNjQuMzIgMTcxLjU2NCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIiBjbGFzcz0ic3Q4Ij4KCTx2OmRvY3VtZW50UHJvcGVydGllcyB2OmxhbmdJRD0iMTA0MCIgdjptZXRyaWM9InRydWUiIHY6dmlld01hcmt1cD0iZmFsc2UiPgoJCTx2OnVzZXJEZWZzPgoJCQk8djp1ZCB2Om5hbWVVPSJNQlNBQWRkaW5PdXRsaW5lVmlzaWJsZSIgdjpwcm9tcHQ9IiIgdjp2YWw9IlZUMCgxKToyNiIvPgoJCTwvdjp1c2VyRGVmcz4KCTwvdjpkb2N1bWVudFByb3BlcnRpZXM+CgoJPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCTwhW0NEQVRBWwoJCS5zdDEge2ZpbGw6I2ZmZmZmZjtzdHJva2U6bm9uZTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLXdpZHRoOjIuMTZ9CgkJLnN0MiB7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6Mi4xNn0KCQkuc3QzIHtzdHJva2U6IzAwMDAwMDtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLXdpZHRoOjIuMTZ9CgkJLnN0NCB7ZmlsbDpub25lO3N0cm9rZTpub25lO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6Mi4xNn0KCQkuc3Q1IHtmaWxsOiMwMDAwMDA7Zm9udC1mYW1pbHk6QXJpYWw7Zm9udC1zaXplOjAuNjY2NjY0ZW07Zm9udC13ZWlnaHQ6Ym9sZH0KCQkuc3Q2IHtmaWxsOiNmZmZmZmY7ZmlsbC1vcGFjaXR5OjA7c3Ryb2tlOiM4YzhjOGM7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS13aWR0aDoyLjE2fQoJCS5zdDcge2ZvbnQtc2l6ZToxZW19CgkJLnN0OCB7ZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO2ZvbnQtc2l6ZToxMjtvdmVyZmxvdzp2aXNpYmxlO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbWl0ZXJsaW1pdDozfQoJXV0+Cgk8L3N0eWxlPgoKCTxnIHY6bUlEPSIwIiB2OmluZGV4PSIxIiB2Omdyb3VwQ29udGV4dD0iZm9yZWdyb3VuZFBhZ2UiPgoJCTx0aXRsZT5QYWdpbmEgMTwvdGl0bGU+CgkJPHY6cGFnZVByb3BlcnRpZXMgdjpkcmF3aW5nU2NhbGU9IjAuMDM5MzcwMSIgdjpwYWdlU2NhbGU9IjAuMDM5MzcwMSIgdjpkcmF3aW5nVW5pdHM9IjI0IiB2OnNoYWRvd09mZnNldFg9IjguNTAzOTQiCgkJCQl2OnNoYWRvd09mZnNldFk9Ii04LjUwMzk0Ii8+CgkJPGcgaWQ9InNoYXBlMTM5LTEiIHY6bUlEPSIxMzkiIHY6Z3JvdXBDb250ZXh0PSJzaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi4xNiwtMi4xNikiPgoJCQk8dGl0bGU+Rm9nbGlvLjEzOTwvdGl0bGU+CgkJCTxyZWN0IHg9IjAiIHk9IjQuMzIiIHdpZHRoPSIzNjAiIGhlaWdodD0iMTY3LjI0NCIgY2xhc3M9InN0MSIvPgoJCTwvZz4KCQk8ZyBpZD0ic2hhcGUxNDktMyIgdjptSUQ9IjE0OSIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NS44MDE3LC0xMjEuMjE1KSI+CgkJCTx0aXRsZT5Gb2dsaW8uMTQ5PC90aXRsZT4KCQkJPGVsbGlwc2UgY3g9IjQzLjkzNyIgY3k9IjE1NC41NTYiIHJ4PSI0My45MzciIHJ5PSIxNy4wMDc5IiBjbGFzcz0ic3QyIi8+CgkJPC9nPgoJCTxnIGlkPSJzaGFwZTE0OC01IiB2Om1JRD0iMTQ4IiB2Omdyb3VwQ29udGV4dD0ic2hhcGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyNy41OTksOTcuMTE1Nikgcm90YXRlKDEwNi45ODgpIj4KCQkJPHRpdGxlPkZvZ2xpby4xNDg8L3RpdGxlPgoJCQk8cGF0aCBkPSJNMCAxNzEuNTYgTDczLjI3IDE3MS41NiIgY2xhc3M9InN0MyIvPgoJCTwvZz4KCQk8ZyBpZD0ic2hhcGUxNTAtOCIgdjptSUQ9IjE1MCIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MS42ODc2LC0xMzEuMjY5KSI+CgkJCTx0aXRsZT5Gb2dsaW8uMTUwPC90aXRsZT4KCQkJPGRlc2M+T3JkZXI8L2Rlc2M+CgkJCTx2OnRleHRCbG9jayB2Om1hcmdpbnM9InJlY3QoNCw0LDQsNCkiIHY6dGFiU3BhY2U9IjQyLjUxOTciLz4KCQkJPHY6dGV4dFJlY3QgY3g9IjE5LjU0NzIiIGN5PSIxNjQuNjEiIHdpZHRoPSIzOS4xIiBoZWlnaHQ9IjEzLjkwNzUiLz4KCQkJPHJlY3QgeD0iMCIgeT0iMTU3LjY1NyIgd2lkdGg9IjM5LjA5NDUiIGhlaWdodD0iMTMuOTA3NSIgY2xhc3M9InN0NCIvPgoJCQk8dGV4dCB4PSI4LjY1IiB5PSIxNjcuMDEiIGNsYXNzPSJzdDUiIHY6bGFuZ0lEPSIxMDQwIj48djpwYXJhZ3JhcGggdjpob3JpekFsaWduPSIxIi8+PHY6dGFiTGlzdC8+T3JkZXI8L3RleHQ+CQk8L2c+CgkJPGcgaWQ9InNoYXBlMTUxLTExIiB2Om1JRD0iMTUxIiB2Omdyb3VwQ29udGV4dD0ic2hhcGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuODM1MzIsLTcuOTk0MSkiPgoJCQk8dGl0bGU+Rm9nbGlvLjE1MTwvdGl0bGU+CgkJCTxyZWN0IHg9IjAiIHk9IjE0LjA0MzUiIHdpZHRoPSIzNTAuNjQ5IiBoZWlnaHQ9IjE1Ny41MjEiIGNsYXNzPSJzdDYiLz4KCQk8L2c+CgkJPGcgaWQ9InNoYXBlMS0xMyIgdjptSUQ9IjEiIHY6Z3JvdXBDb250ZXh0PSJzaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQ2LjcyNywtODQuMzY0NykiPgoJCQk8dGl0bGU+Rm9nbGlvLjE8L3RpdGxlPgoJCQk8ZWxsaXBzZSBjeD0iNDMuOTM3IiBjeT0iMTU0LjU1NiIgcng9IjQzLjkzNyIgcnk9IjE3LjAwNzkiIGNsYXNzPSJzdDIiLz4KCQk8L2c+CgkJPGcgaWQ9InNoYXBlMi0xNSIgdjptSUQ9IjIiIHY6Z3JvdXBDb250ZXh0PSJzaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYwLjM2OSwtOTMuMTM0NCkiPgoJCQk8dGl0bGU+Rm9nbGlvLjI8L3RpdGxlPgoJCQk8ZGVzYz5MaW5lSXRlbTwvZGVzYz4KCQkJPHY6dGV4dEJsb2NrIHY6bWFyZ2lucz0icmVjdCg0LDQsNCw0KSIgdjp0YWJTcGFjZT0iNDIuNTE5NyIvPgoJCQk8djp0ZXh0UmVjdCBjeD0iMjIuOTQyOSIgY3k9IjE2NC42MSIgd2lkdGg9IjQ1Ljg5IiBoZWlnaHQ9IjEzLjkwNzUiLz4KCQkJPHJlY3QgeD0iMCIgeT0iMTU3LjY1NyIgd2lkdGg9IjQ1Ljg4NTgiIGhlaWdodD0iMTMuOTA3NSIgY2xhc3M9InN0NCIvPgoJCQk8dGV4dCB4PSI2LjUiIHk9IjE2Ny4wMSIgY2xhc3M9InN0NSIgdjpsYW5nSUQ9IjEwNDAiPjx2OnBhcmFncmFwaCB2Omhvcml6QWxpZ249IjEiLz48djp0YWJMaXN0Lz5MaW5lSXRlbTwvdGV4dD4JCTwvZz4KCQk8ZyBpZD0ic2hhcGU1LTE4IiB2Om1JRD0iNSIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNi4zMzMyLC0yMi4wMDI1KSI+CgkJCTx0aXRsZT5Gb2dsaW8uNTwvdGl0bGU+CgkJCTxlbGxpcHNlIGN4PSI0My45MzciIGN5PSIxNTQuNTU2IiByeD0iNDMuOTM3IiByeT0iMTcuMDA3OSIgY2xhc3M9InN0MiIvPgoJCTwvZz4KCQk8ZyBpZD0ic2hhcGU2LTIwIiB2Om1JRD0iNiIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNy42NzE4LC0yNS42MTIzKSI+CgkJCTx0aXRsZT5Gb2dsaW8uNjwvdGl0bGU+CgkJCTxkZXNjPlNoaXBwaW5nIEFkZHJlc3M8L2Rlc2M+CgkJCTx2OnRleHRCbG9jayB2Om1hcmdpbnM9InJlY3QoNCw0LDQsNCkiIHY6dGFiU3BhY2U9IjQyLjUxOTciLz4KCQkJPHY6dGV4dFJlY3QgY3g9IjIyLjk0MjkiIGN5PSIxNTguMTY2IiB3aWR0aD0iNDUuODkiIGhlaWdodD0iMjYuNzk2MyIvPgoJCQk8cmVjdCB4PSIwIiB5PSIxNDQuNzY4IiB3aWR0aD0iNDUuODg1OCIgaGVpZ2h0PSIyNi43OTYzIiBjbGFzcz0ic3Q0Ii8+CgkJCTx0ZXh0IHg9IjUuODQiIHk9IjE1NS43NyIgY2xhc3M9InN0NSIgdjpsYW5nSUQ9IjEwNDAiPjx2OnBhcmFncmFwaCB2Omhvcml6QWxpZ249IjEiLz48djp0YWJMaXN0Lz5TaGlwcGluZzx2Om5ld2xpbmVDaGFyLz48dHNwYW4KCQkJCQkJeD0iNi45NCIgZHk9IjEuMmVtIiBjbGFzcz0ic3Q3Ij5BZGRyZXNzPC90c3Bhbj48L3RleHQ+CQk8L2c+CgkJPGcgaWQ9InNoYXBlNy0yNCIgdjptSUQ9IjciIHY6Z3JvdXBDb250ZXh0PSJzaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTE2Ljk2MywtMjIuMDAyNSkiPgoJCQk8dGl0bGU+Rm9nbGlvLjc8L3RpdGxlPgoJCQk8ZWxsaXBzZSBjeD0iNDMuOTM3IiBjeT0iMTU0LjU1NiIgcng9IjQzLjkzNyIgcnk9IjE3LjAwNzkiIGNsYXNzPSJzdDIiLz4KCQk8L2c+CgkJPGcgaWQ9InNoYXBlOC0yNiIgdjptSUQ9IjgiIHY6Z3JvdXBDb250ZXh0PSJzaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTI5LjE4OCwtMjUuNjEyMykiPgoJCQk8dGl0bGU+Rm9nbGlvLjg8L3RpdGxlPgoJCQk8ZGVzYz5CaWxsaW5nIEFkZHJlc3M8L2Rlc2M+CgkJCTx2OnRleHRCbG9jayB2Om1hcmdpbnM9InJlY3QoNCw0LDQsNCkiIHY6dGFiU3BhY2U9IjQyLjUxOTciLz4KCQkJPHY6dGV4dFJlY3QgY3g9IjIyLjk0MjkiIGN5PSIxNTguMTY2IiB3aWR0aD0iNDUuODkiIGhlaWdodD0iMjYuNzk2MyIvPgoJCQk8cmVjdCB4PSIwIiB5PSIxNDQuNzY4IiB3aWR0aD0iNDUuODg1OCIgaGVpZ2h0PSIyNi43OTYzIiBjbGFzcz0ic3Q0Ii8+CgkJCTx0ZXh0IHg9IjEwLjcyIiB5PSIxNTUuNzciIGNsYXNzPSJzdDUiIHY6bGFuZ0lEPSIxMDQwIj48djpwYXJhZ3JhcGggdjpob3JpekFsaWduPSIxIi8+PHY6dGFiTGlzdC8+QmlsbGluZzx2Om5ld2xpbmVDaGFyLz48dHNwYW4KCQkJCQkJeD0iNi45NCIgZHk9IjEuMmVtIiBjbGFzcz0ic3Q3Ij5BZGRyZXNzPC90c3Bhbj48L3RleHQ+CQk8L2c+CgkJPGcgaWQ9InNoYXBlOS0zMCIgdjptSUQ9IjkiIHY6Z3JvdXBDb250ZXh0PSJzaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjIyLjg3MywtNTQuMTgyMSkgcm90YXRlKDUyLjQ3ODQpIj4KCQkJPHRpdGxlPkZvZ2xpby45PC90aXRsZT4KCQkJPHBhdGggZD0iTTAgMTcxLjU2IEw4NS4xOSAxNzEuNTYiIGNsYXNzPSJzdDMiLz4KCQk8L2c+CgkJPGcgaWQ9InNoYXBlMTAtMzMiIHY6bUlEPSIxMCIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNDEuMzU4LC04NS43NjA4KSByb3RhdGUoNDEuNzM2OCkiPgoJCQk8dGl0bGU+Rm9nbGlvLjEwPC90aXRsZT4KCQkJPHBhdGggZD0iTTAgMTcxLjU2IEwzMS40NSAxNzEuNTYiIGNsYXNzPSJzdDMiLz4KCQk8L2c+CgkJPGcgaWQ9InNoYXBlMTEtMzYiIHY6bUlEPSIxMSIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMjUuNTAyLC02NC44NDI0KSByb3RhdGUoMzMuODAxMykiPgoJCQk8dGl0bGU+Rm9nbGlvLjExPC90aXRsZT4KCQkJPHBhdGggZD0iTTAgMTcxLjU2IEw0Mi45OSAxNzEuNTYiIGNsYXNzPSJzdDMiLz4KCQk8L2c+CgkJPGcgaWQ9InNoYXBlMTItMzkiIHY6bUlEPSIxMiIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMTguNjc2LC0xMjQuMDUpIj4KCQkJPHRpdGxlPkZvZ2xpby4xMjwvdGl0bGU+CgkJCTxkZXNjPjE8L2Rlc2M+CgkJCTx2OnRleHRCbG9jayB2Om1hcmdpbnM9InJlY3QoNCw0LDQsNCkiIHY6dGFiU3BhY2U9IjQyLjUxOTciLz4KCQkJPHY6dGV4dFJlY3QgY3g9IjE5LjU0NzIiIGN5PSIxNjQuNjEiIHdpZHRoPSIzOS4xIiBoZWlnaHQ9IjEzLjkwNzUiLz4KCQkJPHJlY3QgeD0iMCIgeT0iMTU3LjY1NyIgd2lkdGg9IjM5LjA5NDUiIGhlaWdodD0iMTMuOTA3NSIgY2xhc3M9InN0NCIvPgoJCQk8dGV4dCB4PSIxNy4zMiIgeT0iMTY3LjAxIiBjbGFzcz0ic3Q1IiB2OmxhbmdJRD0iMTA0MCI+PHY6cGFyYWdyYXBoIHY6aG9yaXpBbGlnbj0iMSIvPjx2OnRhYkxpc3QvPjE8L3RleHQ+CQk8L2c+CgkJPGcgaWQ9InNoYXBlMTMtNDIiIHY6bUlEPSIxMyIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzAuMzEsLTExNC4yNjEpIj4KCQkJPHRpdGxlPkZvZ2xpby4xMzwvdGl0bGU+CgkJCTxkZXNjPm08L2Rlc2M+CgkJCTx2OnRleHRCbG9jayB2Om1hcmdpbnM9InJlY3QoNCw0LDQsNCkiIHY6dGFiU3BhY2U9IjQyLjUxOTciLz4KCQkJPHY6dGV4dFJlY3QgY3g9IjE5LjU0NzIiIGN5PSIxNjQuNjEiIHdpZHRoPSIzOS4xIiBoZWlnaHQ9IjEzLjkwNzUiLz4KCQkJPHJlY3QgeD0iMCIgeT0iMTU3LjY1NyIgd2lkdGg9IjM5LjA5NDUiIGhlaWdodD0iMTMuOTA3NSIgY2xhc3M9InN0NCIvPgoJCQk8dGV4dCB4PSIxNS45OSIgeT0iMTY3LjAxIiBjbGFzcz0ic3Q1IiB2OmxhbmdJRD0iMTA0MCI+PHY6cGFyYWdyYXBoIHY6aG9yaXpBbGlnbj0iMSIvPjx2OnRhYkxpc3QvPm08L3RleHQ+CQk8L2c+CgkJPGcgaWQ9InNoYXBlMTQtNDUiIHY6bUlEPSIxNCIgdjpncm91cENvbnRleHQ9InNoYXBlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMjYuMDk3LC04Ny40NjUxKSI+CgkJCTx0aXRsZT5Gb2dsaW8uMTQ8L3RpdGxlPgoJCQk8ZGVzYz5tPC9kZXNjPgoJCQk8djp0ZXh0QmxvY2sgdjptYXJnaW5zPSJyZWN0KDQsNCw0LDQpIiB2OnRhYlNwYWNlPSI0Mi41MTk3Ii8+CgkJCTx2OnRleHRSZWN0IGN4PSIxOS41NDcyIiBjeT0iMTY0LjYxIiB3aWR0aD0iMzkuMSIgaGVpZ2h0PSIxMy45MDc1Ii8+CgkJCTxyZWN0IHg9IjAiIHk9IjE1Ny42NTciIHdpZHRoPSIzOS4wOTQ1IiBoZWlnaHQ9IjEzLjkwNzUiIGNsYXNzPSJzdDQiLz4KCQkJPHRleHQgeD0iMTUuOTkiIHk9IjE2Ny4wMSIgY2xhc3M9InN0NSIgdjpsYW5nSUQ9IjEwNDAiPjx2OnBhcmFncmFwaCB2Omhvcml6QWxpZ249IjEiLz48djp0YWJMaXN0Lz5tPC90ZXh0PgkJPC9nPgoJCTxnIGlkPSJzaGFwZTE1LTQ4IiB2Om1JRD0iMTUiIHY6Z3JvdXBDb250ZXh0PSJzaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjQ2LjUzLC03NC41NzYzKSI+CgkJCTx0aXRsZT5Gb2dsaW8uMTU8L3RpdGxlPgoJCQk8ZGVzYz4xPC9kZXNjPgoJCQk8djp0ZXh0QmxvY2sgdjptYXJnaW5zPSJyZWN0KDQsNCw0LDQpIiB2OnRhYlNwYWNlPSI0Mi41MTk3Ii8+CgkJCTx2OnRleHRSZWN0IGN4PSIxOS41NDcyIiBjeT0iMTY0LjYxIiB3aWR0aD0iMzkuMSIgaGVpZ2h0PSIxMy45MDc1Ii8+CgkJCTxyZWN0IHg9IjAiIHk9IjE1Ny42NTciIHdpZHRoPSIzOS4wOTQ1IiBoZWlnaHQ9IjEzLjkwNzUiIGNsYXNzPSJzdDQiLz4KCQkJPHRleHQgeD0iMTcuMzIiIHk9IjE2Ny4wMSIgY2xhc3M9InN0NSIgdjpsYW5nSUQ9IjEwNDAiPjx2OnBhcmFncmFwaCB2Omhvcml6QWxpZ249IjEiLz48djp0YWJMaXN0Lz4xPC90ZXh0PgkJPC9nPgoJCTxnIGlkPSJzaGFwZTMtNTEiIHY6bUlEPSIzIiB2Omdyb3VwQ29udGV4dD0ic2hhcGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2MC4xMTMsLTQ3LjUxNDMpIj4KCQkJPHRpdGxlPkZvZ2xpby4zPC90aXRsZT4KCQkJPGVsbGlwc2UgY3g9IjQzLjkzNyIgY3k9IjE1NS45NzQiIHJ4PSI0My45MzciIHJ5PSIxNS41OTA2IiBjbGFzcz0ic3QyIi8+CgkJPC9nPgoJCTxnIGlkPSJzaGFwZTQtNTMiIHY6bUlEPSI0IiB2Omdyb3VwQ29udGV4dD0ic2hhcGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI3NC4wMiwtNTYuMDE4MykiPgoJCQk8dGl0bGU+Rm9nbGlvLjQ8L3RpdGxlPgoJCQk8ZGVzYz5Qcm9kdWN0PC9kZXNjPgoJCQk8djp0ZXh0QmxvY2sgdjptYXJnaW5zPSJyZWN0KDQsNCw0LDQpIiB2OnRhYlNwYWNlPSI0Mi41MTk3Ii8+CgkJCTx2OnRleHRSZWN0IGN4PSIyMi45NDI5IiBjeT0iMTY0LjYxIiB3aWR0aD0iNDUuODkiIGhlaWdodD0iMTMuOTA3NSIvPgoJCQk8cmVjdCB4PSIwIiB5PSIxNTcuNjU3IiB3aWR0aD0iNDUuODg1OCIgaGVpZ2h0PSIxMy45MDc1IiBjbGFzcz0ic3Q0Ii8+CgkJCTx0ZXh0IHg9IjcuODMiIHk9IjE2Ny4wMSIgY2xhc3M9InN0NSIgdjpsYW5nSUQ9IjEwNDAiPjx2OnBhcmFncmFwaCB2Omhvcml6QWxpZ249IjEiLz48djp0YWJMaXN0Lz5Qcm9kdWN0PC90ZXh0PgkJPC9nPgoJPC9nPgo8L3N2Zz4K" alt="Image">
</div>
<div class="title">Figure 1. Abstract persistence schema of several entities defined in the same persistence unit.</div>
</div>
<div class="paragraph">
<p>This query navigates over the association
field <code>lineItems</code> of the abstract schema type <code>Order</code> to find line
items, and uses the state field <code>shipped</code> of <code>LineItem</code> to select those
orders that have at least one line item that has not yet shipped. (Note
that this query does not select orders that have no line items.)</p>
</div>
<div class="paragraph">
<p>Although reserved identifiers, such as
DISTINCT, FROM, AS, JOIN, WHERE, and FALSE appear in upper case in this
example, reserved identifiers are case
insensitive.<sup class="footnote">[<a id="_footnoteref_63" class="footnote" href="#_footnotedef_63" title="View footnote.">63</a>]</sup></p>
</div>
<div class="paragraph">
<p>The SELECT clause of this example designates
the return type of this query to be of type Order.</p>
</div>
<div class="paragraph">
<p>Because the same persistence unit defines the
abstract persistence schema of the related entities, the developer can
also specify a query over orders that utilizes the abstract schema type
for products, and hence the state fields and association fields of both
the abstract schema types <code>Order</code> and <code>Product</code>. For example, if the
abstract schema type <code>Product</code> has a state field named <code>productType</code>, a
query over orders can be specified using this state field. Such a query
might be to find all orders for products with product type office
supplies. A query for this might be as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> l.product p
<span class="keyword">WHERE</span> p.productType = <span class="string"><span class="delimiter">'</span><span class="content">office_supplies</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because <code>Order</code> is related to <code>Product</code> by
means of the relationships between <code>Order</code> and <code>LineItem</code> and between
<code>LineItem</code> and <code>Product</code>, navigation using the association fields
<code>lineItems</code> and <code>product</code> is used to express the query. This query is
specified by using the entity name <code>Order</code>, which designates the
abstract schema type over which the query ranges. The basis for the
navigation is provided by the association fields <code>lineItems</code> and
<code>product</code> of the abstract schema types Order and LineItem respectively.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-from-clause-and-navigational-declarations"><a class="anchor" href="#the-from-clause-and-navigational-declarations"></a>4.4. The FROM Clause and Navigational Declarations</h3>
<div class="paragraph">
<p>The FROM clause of a query defines the <em>domain</em> of the query:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one or more named entity abstract schema types, as specified below
in <a href="#a4766">Section 4.4.3</a>, together with</p>
</li>
<li>
<p>zero or more joined associations and collections, as specified
below in <a href="#joins">Section 4.4.5</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An <em>identification variable</em> is an identifier declared in the FROM
clause of a query. Each identification variable is assigned an
abstract schema type. Each element of the domain may declare an
identification variable.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the domain has exactly one named entity abstract schema type
and no joins, then the named entity does not require an explicit
identification variable, and its identification variable defaults
to the <em>implicit identification variable,</em> <code>this</code>.</p>
</li>
<li>
<p>Otherwise, every element of the FROM clause&#8212;&#8203;that is, every
named entity abstract schema types and every join&#8212;&#8203;must
declare an identification variable.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>from_clause ::=
    FROM {this_implicit_variable | identification_variable_declarations}

this_implicit_variable ::= entity_name

identification_variable_declarations ::=
    identification_variable_declaration
    {, {identification_variable_declaration | collection_member_declaration}}*

identification_variable_declaration ::= range_variable_declaration {join | fetch_join}*

range_variable_declaration ::= entity_name [AS] identification_variable

join ::= range_join | path_join

range_join ::= join_spec range_variable_declaration [join_condition]

path_join ::=
    join_spec join_association_path_expression [AS] identification_variable [join_condition]

fetch_join ::= join_spec FETCH join_association_path_expression

join_spec ::= [INNER | LEFT [OUTER]] JOIN

join_association_path_expression ::=
    join_collection_valued_path_expression |
    join_single_valued_path_expression |
    TREAT(join_collection_valued_path_expression AS subtype) |
    TREAT(join_single_valued_path_expression AS subtype)

join_collection_valued_path_expression ::= [identification_variable.]{single_valued_embeddable_object_field.}*collection_valued_field

join_single_valued_path_expression ::= [identification_variable.]{single_valued_embeddable_object_field.}*single_valued_object_field

join_condition ::= ON conditional_expression

collection_member_declaration ::= IN (collection_valued_path_expression) [AS] identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>The following subsections discuss the constructs used in the FROM clause.</p>
</div>
<div class="sect3">
<h4 id="a4760"><a class="anchor" href="#a4760"></a>4.4.1. Identifiers</h4>
<div class="paragraph">
<p>An identifier is a character sequence of
unlimited length. The character sequence must begin with a Java
identifier start character, and all other characters must be Java
identifier part characters. An identifier start character is any
character for which the method <code>Character.isJavaIdentifierStart</code> returns
true. This includes the underscore (<code>_</code>) character and the dollar sign
(<code>$</code>) character. An identifier part character is any character for
which the method <code>Character.isJavaIdentifierPart</code> returns true. The
question mark (<code>?</code>) character is reserved for use by the Jakarta
Persistence query language.</p>
</div>
<div class="paragraph">
<p>The following<sup class="footnote">[<a id="_footnoteref_64" class="footnote" href="#_footnotedef_64" title="View footnote.">64</a>]</sup> are reserved identifiers: ABS, ALL, AND, ANY, AS, ASC,
AVG, BETWEEN, BIT_LENGTH, BOTH, BY, CASE, CEILING, CHAR_LENGTH,
CHARACTER_LENGTH, CLASS, COALESCE, CONCAT, COUNT, CURRENT_DATE,
CURRENT_TIME, CURRENT_TIMESTAMP, DELETE, DESC, DISTINCT, ELSE, EMPTY,
END, ENTRY, ESCAPE, EXISTS, EXP, EXTRACT, FALSE, FETCH, FIRST, FLOOR,
FROM, FUNCTION, GROUP, HAVING, IN, INDEX, INNER, IS, JOIN, KEY, LEADING,
LAST, LEFT, LENGTH, LIKE, LOCAL, LN, LOCATE, LOWER, MAX, MEMBER, MIN, MOD,
NEW, NOT, NULL, NULLS, NULLIF, OBJECT, OF, ON, OR, ORDER, OUTER, POSITION,
POWER, REPLACE, RIGHT, ROUND, SELECT, SET, SIGN, SIZE, SOME, SQRT, SUBSTRING, SUM,
THEN, TRAILING, TREAT, TRIM, TRUE, TYPE, UNKNOWN, UPDATE, UPPER,
VALUE, WHEN, WHERE.</p>
</div>
<div class="paragraph">
<p>Reserved identifiers are case-insensitive.
Reserved identifiers must not be used as identification variables or
result variables (see <a href="#a5438">Section 4.9</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is recommended that SQL keywords other
than those listed above not be used as identification variables in
queries because they may be used as reserved identifiers in future
releases of this specification.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="a4765"><a class="anchor" href="#a4765"></a>4.4.2. Identification Variables</h4>
<div class="paragraph">
<p>An identification variable is a valid identifier declared in the FROM
clause of a query.</p>
</div>
<div class="paragraph">
<p>Every identification variable must be declared in the FROM clause,
except for the implicit identification variable <code>this</code>. Identification
variables are never declared in other clauses.</p>
</div>
<div class="paragraph">
<p>An identification variable must not be a reserved identifier.</p>
</div>
<div class="paragraph">
<p>An identification variable may have the same name as an entity.</p>
</div>
<div class="paragraph">
<p>Identification variables are case-insensitive.</p>
</div>
<div class="paragraph">
<p>An identification variable evaluates to a
value of the type of the expression used in declaring the variable. For
example, consider the previous query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> l.product p
<span class="keyword">WHERE</span> p.productType = <span class="string"><span class="delimiter">'</span><span class="content">office_supplies</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the FROM clause declaration <code>o.lineItems</code>
<code>l</code>, the identification variable <code>l</code> evaluates to any LineItem value
directly reachable from Order. The association field <code>lineItems</code> is a
collection of instances of the abstract schema type LineItem and the
identification variable <code>l</code> refers to an element of this collection. The
type of <code>l</code> is the abstract schema type of <code>LineItem</code>.</p>
</div>
<div class="paragraph">
<p>An identification variable can range over an
entity, embeddable, or basic abstract schema type. An identification
variable designates an instance of an abstract schema type or an element
of a collection of abstract schema type instances.</p>
</div>
<div class="paragraph">
<p>Note that for identification variables
referring to an instance of an association or collection represented as
a <code>java.util.Map</code>, the identification variable is of the abstract
schema type of the map <code>value</code>.</p>
</div>
<div class="paragraph">
<p>An identification variable always designates
a reference to a single value. It is declared in one of three ways: in a
range variable declaration, in a join clause, or in a collection member
declaration. The identification variable declarations are evaluated from
left to right in the FROM clause, and an identification variable
declaration can use the result of a preceding identification variable
declaration of the query string.</p>
</div>
<div class="paragraph">
<p>All identification variables used in the
SELECT, WHERE, ORDER BY, GROUP BY, or HAVING clause of a SELECT or
DELETE statement must be declared in the FROM clause. The identification
variables used in the WHERE clause of an UPDATE statement must be
declared in the UPDATE clause.</p>
</div>
<div class="paragraph">
<p>Identification variables are existentially
quantified in these clauses. This means that an identification variable
represents a member of a collection or an instance of an entity&#8217;s
abstract schema type. An identification variable never designates a
collection in its entirety.</p>
</div>
<div class="paragraph">
<p>An identification variable is scoped to the
query (or subquery) in which it is defined and is also visible to any
subqueries within that query scope that do not define an identification
variable of the same name.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4766"><a class="anchor" href="#a4766"></a>4.4.3. Range Variable Declarations</h4>
<div class="paragraph">
<p>A range variable declaration introduces a query domain element ranging
over a given named entity abstract schema type, with an associated
identification variable.</p>
</div>
<div class="paragraph">
<p>The syntax for declaring an identification variable as a range variable
is similar to that of SQL; optionally, it may use the AS keyword. A
range variable declaration designates an entity abstract schema type by
its entity name, as defined above in <a href="#naming">Section 4.3.1</a>.<sup class="footnote">[<a id="_footnoteref_65" class="footnote" href="#_footnotedef_65" title="View footnote.">65</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>range_variable_declaration ::= entity_name [AS] identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>The entity name in a range variable declaration is case-sensitive.</p>
</div>
<div class="paragraph">
<p>Range variable declarations allow the
developer to designate a root for objects which may not be reachable
by navigation.</p>
</div>
<div class="paragraph">
<p>In order to select values by comparing more
than one instance of an entity abstract schema type, more than one
identification variable ranging over the abstract schema type is needed
in the FROM clause.</p>
</div>
<div class="paragraph">
<p>The following query returns orders whose
quantity is greater than the order quantity for John Smith. This example
illustrates the use of two different identification variables in the
FROM clause, both of the abstract schema type Order. The SELECT clause
of this query determines that it is the orders with quantities larger
than John Smith&#8217;s that are returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o1
<span class="keyword">FROM</span> <span class="keyword">Order</span> o1, <span class="keyword">Order</span> o2
<span class="keyword">WHERE</span> o1.quantity &gt; o2.quantity <span class="keyword">AND</span>
 o2.customer.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span>
 o2.customer.firstname= <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the query domain is a single entity abstract schema type, the range
variable declaration is optional. These queries are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> quantity
<span class="keyword">FROM</span> <span class="keyword">Order</span>
<span class="keyword">WHERE</span> customer.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span>
  <span class="keyword">AND</span> customer.firstname= <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> this.quantity
<span class="keyword">FROM</span> <span class="keyword">Order</span>
<span class="keyword">WHERE</span> this.customer.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span>
  <span class="keyword">AND</span> this.customer.firstname= <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> ord.quantity
<span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> ord
<span class="keyword">WHERE</span> ord.customer.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span>
  <span class="keyword">AND</span> ord.customer.firstname= <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise, if the query domain has more than one element, each named
entity abstract schema type listed in the FROM clause must be a range
variable declaration, and the implicit identification variable is not
implicitly assigned an abstract schema type.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4792"><a class="anchor" href="#a4792"></a>4.4.4. Path Expressions</h4>
<div class="paragraph">
<p>A path expression is a sequence of identifiers uniquely identifying
a state field or association field of an element of the query domain.</p>
</div>
<div class="paragraph">
<p>A path expression may begin with a reference to an identification
variable, followed by the navigation operator (<code>.</code>). If the first
element of a path expression is not an identification variable, then
the path expression is interpreted exactly as if it began with the
implicit identification variable <code>this</code>.</p>
</div>
<div class="paragraph">
<p>The remaining elements of the path expression are interpreted as
references to state fields or association fields in the context of the
abstract schema type assigned to the identification variable&#8212;&#8203;or
to <code>this</code>, if the path expression does not begin with an identification
variable.</p>
</div>
<div class="paragraph">
<p>A reference to a state field or association field in a path expression
is case-sensitive.</p>
</div>
<div class="paragraph">
<p>The type of the path expression is the type computed as
the result of navigation; that is, the type of the state field or
association field to which the expression navigates. The type of a path
expression that navigates to an association field may be specified as a
subtype of the declared type of the association field by means of the
TREAT operator. See <a href="#a4965">Section 4.4.9</a>.</p>
</div>
<div class="paragraph">
<p>An identification variable qualified
by the KEY, VALUE, or ENTRY operator is a path expression. The KEY,
VALUE, and ENTRY operators may only be applied to identification
variables that correspond to map-valued associations or map-valued
element collections. The type of the path expression is the type
computed as the result of the operation; that is, the abstract schema
type of the field that is the value of the KEY, VALUE, or ENTRY operator
(the map key, map value, or map entry
respectively).<sup class="footnote">[<a id="_footnoteref_66" class="footnote" href="#_footnotedef_66" title="View footnote.">66</a>]</sup></p>
</div>
<div class="paragraph">
<p>In the following query, photos is a map from photo label to filename.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> i.name, VALUE(p)
<span class="keyword">FROM</span> Item i <span class="keyword">JOIN</span> i.photos p
<span class="keyword">WHERE</span> <span class="type">KEY</span>(p) <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%egret</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above query the identification
variable <code>p</code> designates an abstract schema type corresponding to the map
<code>value</code>. The results of <code>VALUE(p)</code> and <code>KEY(p)</code> are the map value and
the map key associated with <code>p</code>, respectively. The following query is
equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> i.name, p
<span class="keyword">FROM</span> Item i <span class="keyword">JOIN</span> i.photos p
<span class="keyword">WHERE</span> <span class="type">KEY</span>(p) <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%egret</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A path expression using the KEY or VALUE
operator can be further composed. A path expression using the ENTRY
operator is terminal. It cannot be further composed and can only appear
in the SELECT list of a query.</p>
</div>
<div class="paragraph">
<p>The syntax for qualified identification variables is as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>qualified_identification_variable ::=
    map_field_identification_variable |
    ENTRY(identification_variable)

map_field_identification_variable ::=
    KEY(identification_variable) |
    VALUE(identification_variable)</pre>
</div>
</div>
<div class="paragraph">
<p>Depending on navigability, a path expression
that leads to an association field or to a field whose type is an
embeddable class may be further composed. Path expressions can be
composed from other path expressions if the original path expression
evaluates to a single-valued type (not a collection).</p>
</div>
<div class="paragraph">
<p>In the following example, simple data model with <code>Employee</code>, <code>ContactInfo</code>,
<code>Address</code> and <code>Phone</code> classes is used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span> <span class="type">int</span> id;
    <span class="annotation">@Embedded</span>
    <span class="directive">private</span> ContactInfo contactInfo;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Phone</span> {
    <span class="annotation">@Id</span>
    <span class="directive">private</span> <span class="type">int</span> id;
    <span class="directive">private</span> <span class="predefined-type">String</span> vendor;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContactInfo</span> {
    <span class="annotation">@Embedded</span>
    <span class="directive">private</span> Address address;
    <span class="annotation">@ManyToMany</span>
    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;Phone&gt; phones;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> street;
    <span class="directive">private</span> <span class="predefined-type">String</span> city;
    <span class="directive">private</span> <span class="predefined-type">String</span> state;
    <span class="directive">private</span> <span class="predefined-type">String</span> zipcode;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>contactInfo</code> field denotes an embeddable class consisting of an address and set of phones.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo.phones p
<span class="keyword">WHERE</span> e.contactInfo.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Path expression navigability is composed
using inner join semantics. That is, if the value of a non-terminal
field in the path expression is null, the path is considered to have no
value, and does not participate in the determination of the result.</p>
</div>
<div class="paragraph">
<p>The following query is equivalent to the
query above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo c <span class="keyword">JOIN</span> c.phones p
<span class="keyword">WHERE</span> e.contactInfo.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="path-expression-syntax"><a class="anchor" href="#path-expression-syntax"></a>4.4.4.1. Path Expression Syntax</h5>
<div class="paragraph">
<p>The syntax for single-valued path expressions
and collection-valued path expressions is as follows.</p>
</div>
<div class="paragraph">
<p>An identification variable used in a
<code>single_valued_object_path_expression</code> or in a
<code>collection_valued_path_expression</code> may be an unqualified identification
variable or an identification variable to which the KEY or VALUE
function has been applied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>general_identification_variable ::=
    identification_variable |
    map_field_identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>The type of an entity-valued path expression
or an entity-valued subpath of a path expression used in a WHERE clause
may be specified as a subtype of the corresponding declared type by
means of the TREAT operator. See <a href="#a4965">Section 4.4.9</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>general_subpath ::= simple_subpath | treated_subpath{.single_valued_object_field}*

simple_subpath ::=
    general_identification_variable |
    general_identification_variable{.single_valued_object_field}*

treated_subpath ::= TREAT(general_subpath AS subtype)

single_valued_path_expression ::=
    qualified_identification_variable |
    TREAT(qualified_identification_variable AS subtype) |
    state_field_path_expression |
    single_valued_object_path_expression

state_field_path_expression ::= [general_subpath.]state_field

state_valued_path_expression ::= state_field_path_expression | general_identification_variable

single_valued_object_path_expression ::= general_subpath.single_valued_object_field

collection_valued_path_expression ::= general_subpath.collection_valued_field</pre>
</div>
</div>
<div class="paragraph">
<p>A <code>single_valued_object_field</code> is designated by the name of an association
field in a one-to-one or many-to-one relationship or a field of
embeddable class type. The type of a <code>single_valued_object_field</code>
is the abstract schema type of the related
entity or embeddable class.</p>
</div>
<div class="paragraph">
<p>A <code>single_valued_embeddable_object_field</code> is designated by the name
of a field of embeddable class type.</p>
</div>
<div class="paragraph">
<p>A _state <code>field</code> is designated by the name of
an entity or embeddable class state field that corresponds to a basic
type.</p>
</div>
<div class="paragraph">
<p>A <code>collection_valued_field</code> is designated by the name of an association
field in a one-to-many or a many-to-many relationship or by the name of
an element collection field. The type of a <code>collection_valued_field</code> is
a collection of values of the abstract schema type of the related entity
or element type.</p>
</div>
<div class="paragraph">
<p>It is syntactically illegal to compose a path
expression from a path expression that evaluates to a collection. For
example, if o designates Order, the path expression <code>o.lineItems.product</code>
is illegal since navigation to <code>lineItems</code> results in a collection. This
case should produce an error when the query string is verified. To
handle such a navigation, an identification variable must be declared in
the FROM clause to range over the elements of the <code>lineItems</code>
collection. Another path expression must be used to navigate over each
such element in the WHERE clause of the query, as in the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> l.product
<span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> o <span class="keyword">JOIN</span> o.lineItems l</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>collection_valued_path_expression</code> may only occur in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the FROM clause of a query,</p>
</li>
<li>
<p>an <code>empty_collection_comparison_expression</code>,</p>
</li>
<li>
<p>a <code>collection_member_expression</code>, or</p>
</li>
<li>
<p>as an argument to the SIZE operator.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a5139">Section 4.6.8</a>, <a href="#a5150">Section 4.6.9</a>, and <a href="#a5284">Section 4.7.7.2</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="joins"><a class="anchor" href="#joins"></a>4.4.5. Joins</h4>
<div class="paragraph">
<p>JPQL defines the following varieties of join:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>inner joins, and.</p>
</li>
<li>
<p>left outer joins.<sup class="footnote">[<a id="_footnoteref_67" class="footnote" href="#_footnotedef_67" title="View footnote.">67</a>]</sup></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The semantics of each variety of join is identical to SQL, and the
syntax is borrowed from ANSI SQL.</p>
</div>
<div class="paragraph">
<p>Every join has a target, either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an entity-valued path expression, or</p>
</li>
<li>
<p>an entity type (that is, range variable declaration, as already
specified in <a href="#a4766">Section 4.4.3</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An inner join may be implicitly specified by the use of a cartesian
product in the FROM clause and a join condition in the WHERE clause.
In the absence of a join condition, this reduces to the cartesian
product.</p>
</div>
<div class="paragraph">
<p>The main use case for this generalized style of join is when a join
condition does not involve a foreign key relationship mapped to an
association between entities.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c, Employee e <span class="keyword">WHERE</span> c.hatsize = e.shoesize</code></pre>
</div>
</div>
<div class="paragraph">
<p>This style of inner join (sometimes called a "theta" join) is less
typical than explicitly defined joins over relationships.</p>
</div>
<div class="paragraph">
<p>The syntax for explicit join operations is given by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>join ::= range_join | path_join

range_join ::= join_spec range_variable_declaration [join_condition]

path_join ::=
    join_spec join_association_path_expression [AS] identification_variable [join_condition]

fetch_join ::= join_spec FETCH join_association_path_expression

join_spec ::= [INNER | LEFT [OUTER]] JOIN

join_association_path_expression ::=
    join_collection_valued_path_expression |
    join_single_valued_path_expression |
    TREAT(join_collection_valued_path_expression `AS` subtype) |
    TREAT(join_single_valued_path_expression AS subtype)

join_collection_valued_path_expression ::=
    [identification_variable.]{single_valued_embeddable_object_field.}*collection_valued_field

join_single_valued_path_expression ::=
    [identification_variable.]{single_valued_embeddable_object_field.}*single_valued_object_field

join_condition ::= ON conditional_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The inner and outer join operation types described in <a href="#a4884">Section 4.4.5.1</a>, <a href="#a4898">Section 4.4.5.2</a>,
and <a href="#a4931">Section 4.4.5.3</a> are supported.</p>
</div>
<div class="sect4">
<h5 id="a4884"><a class="anchor" href="#a4884"></a>4.4.5.1. Inner Joins</h5>
<div class="paragraph">
<p>The syntax for an inner join to an entity type is given by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[INNER] JOIN range_variable_declaration [join_condition]</pre>
</div>
</div>
<div class="paragraph">
<p>The keyword INNER is optional and does not affect the semantics
of the query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
    <span class="keyword">JOIN</span> <span class="keyword">Order</span> o <span class="keyword">ON</span> o.customer.id = c.id
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, equivalently:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">Order</span> o <span class="keyword">ON</span> o.customer.id = c.id
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These queries are equivalent to the following query involving
an implicit "theta" join:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c, <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.customer.id = c.id <span class="keyword">AND</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax for an inner join over an association is given by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[INNER] JOIN join_association_path_expression [AS] identification_variable [join_condition]</pre>
</div>
</div>
<div class="paragraph">
<p>For example, the query below joins over the relationship between
customers and orders. This type of join typically equates to a
join over a foreign key relationship in the database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
   <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Equivalently:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is equivalent to the following query using the earlier IN
construct, defined in <a href="#a19497">[4]</a>. It selects those customers of
status 1 for which at least one order exists:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> OBJECT(c)
<span class="keyword">FROM</span> Customer c, <span class="keyword">IN</span>(c.orders) o
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The query below joins over <code>Employee</code>, <code>ContactInfo</code> and <code>Phone</code>.
<code>ContactInfo</code> is an embeddable class that consists of an address
and set of phones. <code>Phone</code> is an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo c <span class="keyword">JOIN</span> c.phones p
<span class="keyword">WHERE</span> c.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A join condition may be specified for an inner join. This is equivalent
to specification of the same condition in the WHERE clause.</p>
</div>
</div>
<div class="sect4">
<h5 id="a4898"><a class="anchor" href="#a4898"></a>4.4.5.2. Outer Joins</h5>
<div class="paragraph">
<p>The syntax for an outer join to an entity type is given by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>LEFT [OUTER] JOIN range_variable_declaration [join_condition]</pre>
</div>
</div>
<div class="paragraph">
<p>The keyword OUTER is optional and does not affect the semantics of
the query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="keyword">Order</span> o <span class="keyword">ON</span> o.customer.id = c.id
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, equivalently:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
    <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="keyword">Order</span> o <span class="keyword">ON</span> o.customer.id = c.id
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Outer joins enable the retrieval of a set of entities where matching
values in the join condition may be absent. For example, the queries
above return <code>Customer</code> instances with no matching <code>Order</code>.</p>
</div>
<div class="paragraph">
<p>The syntax for an outer join over an association is given by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>LEFT [OUTER] JOIN join_association_path_expression [AS] identification_variable [join_condition]</pre>
</div>
</div>
<div class="paragraph">
<p>An association outer join without no explicit <code>join_condition</code> has an
implicit join condition inferred from the foreign key relationship
mapped by the <code>join_association_path_expression</code>. Typically, a JPQL
join of this form is translated to a SQL outer join with an ON condition
specifying the foreign key relationship, as in the following examples.</p>
</div>
<div class="paragraph">
<p>Jakarta Persistence query language:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> s.products p
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p.id)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Products p
    <span class="keyword">ON</span> s.id = p.supplierId
<span class="keyword">GROUP</span> <span class="keyword">By</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>An explicit <code>join_condition</code> (that is, an ON condition in the JOIN)
results in an additional restriction in the ON condition of the
generated SQL.</p>
</div>
<div class="paragraph">
<p>Jakarta Persistence query language:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> s.products p
    <span class="keyword">ON</span> p.status = <span class="string"><span class="delimiter">'</span><span class="content">inStock</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p.id)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Products p
    <span class="keyword">ON</span> s.id = p.supplierId <span class="keyword">AND</span> p.status = <span class="string"><span class="delimiter">'</span><span class="content">inStock</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the result of this query will be different from that of the
following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> s.products p
<span class="keyword">WHERE</span> p.status = <span class="string"><span class="delimiter">'</span><span class="content">inStock</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of the latter query will exclude suppliers who have no
products in stock whereas the former query will include them.</p>
</div>
<div class="paragraph">
<p>An important use case for LEFT JOIN is in enabling the prefetching of
related data items as a side effect of a query. This is accomplished by
specifying the LEFT JOIN as a FETCH JOIN, as described below.</p>
</div>
</div>
<div class="sect4">
<h5 id="a4931"><a class="anchor" href="#a4931"></a>4.4.5.3. Fetch Joins</h5>
<div class="paragraph">
<p>A FETCH JOIN clause in a query results in eager fetching of an association
or element collection as a side effect of execution of the query.</p>
</div>
<div class="paragraph">
<p>The syntax for a fetch join is given by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>fetch_join ::= [LEFT [OUTER] | INNER] JOIN FETCH join_association_path_expression</pre>
</div>
</div>
<div class="paragraph">
<p>A FETCH JOIN must be an INNER or LEFT (OUTER) join. A FETCH JOIN does not
have an explicit join condition or identification variable.</p>
</div>
<div class="paragraph">
<p>The association referenced by the right side
of the FETCH JOIN clause must be an association or element collection
that is referenced from an entity or embeddable that is returned as a
result of the query. It is not permitted to specify an identification
variable for the objects referenced by the right side of the FETCH JOIN
clause, and hence references to the implicitly fetched entities or
elements cannot appear elsewhere in the query.</p>
</div>
<div class="paragraph">
<p>The following query returns a set of
departments. As a side effect, the associated employees for those
departments are also retrieved, even though they are not part of the
explicit query result. The initialization of the persistent state or
relationship fields or properties of the objects that are retrieved as a
result of a fetch join is determined by the metadata for that classin
this example, the <code>Employee</code> entity class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Department d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> FETCH d.employees
<span class="keyword">WHERE</span> d.deptno = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A fetch join has the same join semantics as
the corresponding inner or outer join, except that the related objects
specified on the right-hand side of the join operation are not returned
in the query result or otherwise referenced in the query. Hence, for
example, if department 1 has five employees, the above query returns
five references to the department 1 entity.</p>
</div>
<div class="paragraph">
<p>The FETCH JOIN construct must not be used in
the FROM clause of a subquery.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="collection-member-declarations"><a class="anchor" href="#collection-member-declarations"></a>4.4.6. Collection Member Declarations</h4>
<div class="paragraph">
<p>An identification variable declared by a
<code>collection_member_declaration</code> ranges over values of a collection
obtained by navigation using a path expression.</p>
</div>
<div class="paragraph">
<p>An identification variable of a collection
member declaration is declared using a special operator, the reserved
identifier IN. The argument to the IN operator is a collection-valued
path expression. The path expression evaluates to a collection type
specified as a result of navigation to a collection-valued association
field of an entity or embeddable class abstract schema type.</p>
</div>
<div class="paragraph">
<p>The syntax for declaring a collection member
identification variable is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>collection_member_declaration ::=
    IN (collection_valued_path_expression) [AS] identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>For example, the query</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l
<span class="keyword">WHERE</span> l.product.productType = <span class="string"><span class="delimiter">'</span><span class="content">office_supplies</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>can equivalently be expressed as follows, using the IN operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o, <span class="keyword">IN</span>(o.lineItems) l
<span class="keyword">WHERE</span> l.product.productType = <span class="string"><span class="delimiter">'</span><span class="content">office_supplies</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>lineItems</code> is the name of an
association field whose value is a collection of instances of the
abstract schema type <code>LineItem</code>. The identification variable <code>l</code>
designates a member of this collection, a single LineItem abstract
schema type instance. In this example, <code>o</code> is an identification variable
of the abstract schema type Order.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4957"><a class="anchor" href="#a4957"></a>4.4.7. FROM Clause and SQL</h4>
<div class="paragraph">
<p>The Jakarta Persistence query language treats
the FROM clause similarly to SQL in that the declared identification
variables affect the results of the query even if they are not used in
the WHERE clause. Application developers should use caution in defining
identification variables because the domain of the query can depend on
whether there are any values of the declared type.</p>
</div>
<div class="paragraph">
<p>For example, the FROM clause below defines a
query over all orders that have line items and existing products. If
there are no <code>Product</code> instances in the database, the domain of the
query is empty and no order is selected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> l.product p</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="polymorphism"><a class="anchor" href="#polymorphism"></a>4.4.8. Polymorphism</h4>
<div class="paragraph">
<p>Jakarta Persistence queries are automatically
polymorphic. The FROM clause of a query designates not only instances of
the specific entity class(es) to which it explicitly refers but
instances of subclasses of those classes as well. The instances returned
by a query thus include instances of the subclasses that satisfy the
query criteria.</p>
</div>
<div class="paragraph">
<p>Non-polymorphic queries or queries whose
polymorphism is restricted can be specified using entity type
expressions in the WHERE clause to restrict the domain of the query. See
<a href="#a5381">Section 4.7.12</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4965"><a class="anchor" href="#a4965"></a>4.4.9. Downcasting</h4>
<div class="paragraph">
<p>The use of the TREAT operator is supported
for downcasting within path expressions in the FROM and WHERE clauses.
Use of the TREAT operator allows access to subclass-specific state.</p>
</div>
<div class="paragraph">
<p>If during query execution the first argument
to the TREAT operator is not a subtype (proper or improper) of the
target type, the path is considered to have no value, and does not
participate in the determination of the result. That is, in the case of
a join, the referenced object does not participate in the result, and in
the case of a restriction, the associated predicate is false. Use of the
TREAT operator therefore also has the effect of filtering on the
specified type (and its subtypes) as well as performing the downcast. If
the target type is not a subtype (proper or improper) of the static type
of the first argument, the query is invalid.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> b.name, b.ISBN
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> TREAT(o.product <span class="keyword">AS</span> Book) b

<span class="class">SELECT</span> e <span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> TREAT(e.projects <span class="keyword">AS</span> LargeProject) lp
<span class="keyword">WHERE</span> lp.budget &gt; <span class="integer">1000</span>

<span class="class">SELECT</span> e <span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.projects p
<span class="keyword">WHERE</span> TREAT(p <span class="keyword">AS</span> LargeProject).budget &gt; <span class="integer">1000</span>
    <span class="keyword">OR</span> TREAT(p <span class="keyword">AS</span> SmallProject).name <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">Persist%</span><span class="delimiter">'</span></span>
    <span class="keyword">OR</span> p.description <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">cost overrun</span><span class="delimiter">&quot;</span></span>

<span class="class">SELECT</span> e <span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TREAT(e <span class="keyword">AS</span> Exempt).vacationDays &gt; <span class="integer">10</span>
    <span class="keyword">OR</span> TREAT(e <span class="keyword">AS</span> Contractor).hours &gt; <span class="integer">100</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a4985"><a class="anchor" href="#a4985"></a>4.5. WHERE Clause</h3>
<div class="paragraph">
<p>The WHERE clause of a query consists of a
conditional expression used to select objects or values that satisfy the
expression. The WHERE clause restricts the result of a select statement
or the scope of an update or delete operation.</p>
</div>
<div class="paragraph">
<p>A WHERE clause is defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>where_clause ::= WHERE conditional_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The GROUP BY construct enables the
aggregation of values according to the properties of an entity class.
The HAVING construct enables conditions to be specified that further
restrict the query result as restrictions upon the groups.</p>
</div>
<div class="paragraph">
<p>The syntax of the HAVING clause is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>having_clause ::= HAVING conditional_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The GROUP BY and HAVING constructs are
further discussed in <a href="#a5410">Section 4.8</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a4994"><a class="anchor" href="#a4994"></a>4.6. Conditional Expressions</h3>
<div class="paragraph">
<p>The following sections describe language
constructs that can be used in a conditional expression of the WHERE
clause, the HAVING clause, or in an ON condition.</p>
</div>
<div class="paragraph">
<p>State fields that are mapped in serialized
form or as lobs cannot be portably used in conditional
<sup class="footnote">[<a id="_footnoteref_68" class="footnote" href="#_footnotedef_68" title="View footnote.">68</a>]</sup>.</p>
</div>
<div class="sect3">
<h4 id="conditional-expression-composition"><a class="anchor" href="#conditional-expression-composition"></a>4.6.1. Conditional Expression Composition</h4>
<div class="paragraph">
<p>Conditional expressions are composed of other
conditional expressions, comparison operations, logical operations, path
expressions that evaluate to boolean values, boolean literals, and
boolean input parameters.</p>
</div>
<div class="paragraph">
<p>The scalar expressions described in <a href="#a5243">Section 4.7</a> can be used in
conditional expressions.</p>
</div>
<div class="paragraph">
<p>Aggregate functions can only be used in
conditional expressions in a HAVING clause. See <a href="#a5410">Section 4.8</a>.</p>
</div>
<div class="paragraph">
<p>Standard bracketing <code>()</code> for ordering expression evaluation is supported.</p>
</div>
<div class="paragraph">
<p>Conditional expressions are defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>conditional_expression ::= conditional_term | conditional_expression OR conditional_term
conditional_term ::= conditional_factor | conditional_term AND conditional_factor
conditional_factor ::= [NOT] conditional_primary
conditional_primary ::= simple_cond_expression | (conditional_expression)
simple_cond_expression ::=
    comparison_expression |
    between_expression |
    in_expression |
    like_expression |
    null_comparison_expression |
    empty_collection_comparison_expression |
    collection_member_expression |
    exists_expression</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="operators-and-operator-precedence"><a class="anchor" href="#operators-and-operator-precedence"></a>4.6.2. Operators and Operator Precedence</h4>
<div class="paragraph">
<p>The operators are listed below in order of decreasing precedence.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Navigation operator (<code>.</code>)</p>
</li>
<li>
<p>Arithmetic operators:</p>
<div class="ulist">
<ul>
<li>
<p>+, - unary</p>
</li>
<li>
<p>*, / multiplication and division</p>
</li>
<li>
<p>+, - addition and subtraction</p>
</li>
</ul>
</div>
</li>
<li>
<p>String concatenation (<em>||</em>)</p>
</li>
<li>
<p>Comparison operators: <em>=</em>, <em>&gt;</em>, <em>&gt;=</em>, <em>&lt;</em>
, <em>&lt;=</em>, <em>&lt;&gt;</em> (not equal), <em>[NOT]</em> <em>BETWEEN</em>, <em>[NOT]</em> <em>LIKE</em>, <em>[NOT]</em>
<em>IN</em>, <em>IS</em> <em>[NOT]</em> <em>NULL</em>, <em>IS</em> <em>[NOT]</em> <em>EMPTY</em>, <em>[NOT]</em> <em>MEMBER</em>
<em>[OF]</em>, <em>[NOT]</em> <em>EXISTS</em></p>
</li>
<li>
<p>Logical operators:</p>
<div class="ulist">
<ul>
<li>
<p><code>NOT</code></p>
</li>
<li>
<p><code>AND</code></p>
</li>
<li>
<p><code>OR</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections describe operators used in specific expressions.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5066"><a class="anchor" href="#a5066"></a>4.6.3. Comparison Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of comparison
expressions in a conditional expression is as
follows<sup class="footnote">[<a id="_footnoteref_69" class="footnote" href="#_footnotedef_69" title="View footnote.">69</a>]</sup>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>comparison_expression ::=
    string_expression comparison_operator {string_expression | all_or_any_expression} |
    boolean_expression {= | &lt;&gt;} {boolean_expression | all_or_any_expression} |
    enum_expression {= | &lt;&gt;} {enum_expression | all_or_any_expression} |
    datetime_expression comparison_operator
        {datetime_expression | all_or_any_expression} |
    entity_expression {= | &lt;&gt;} {entity_expression | all_or_any_expression} |
    arithmetic_expression comparison_operator
        {arithmetic_expression | all_or_any_expression} |
    entity_id_or_version_function {= | &lt;&gt;} input_parameter |
    entity_type_expression {= | &lt;&gt;} entity_type_expression}

comparison_operator ::= = | &gt; | &gt;= | &lt; | &lt;= | &lt;&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>item.cost * 1.08 &lt;= 100.00
CONCAT(person.lastName, ', ', person.firstName)) = 'Jones, Sam'
TYPE(e) = ExemptEmployee</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="between-expressions"><a class="anchor" href="#between-expressions"></a>4.6.4. Between Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison operator [NOT] BETWEEN in a
conditional expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> between_expression ::=
    arithmetic_expression [NOT] BETWEEN arithmetic_expression AND arithmetic_expression |
    string_expression [NOT] BETWEEN string_expression AND string_expression |
    datetime_expression [NOT] BETWEEN datetime_expression AND datetime_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The BETWEEN expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x BETWEEN y AND z</pre>
</div>
</div>
<div class="paragraph">
<p>is semantically equivalent to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>y &lt;= x AND x &lt;= z</pre>
</div>
</div>
<div class="paragraph">
<p>The rules for unknown and NULL values in
comparison operations apply. See <a href="#a5676">Section 4.6.13</a>.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>p.age BETWEEN 15 and 19</code> is equivalent to <code>p.age &gt;= 15 AND p.age &lt;= 19</code></p>
</li>
<li>
<p><code>p.age NOT BETWEEN 15 and 19</code> is equivalent to <code>p.age &lt; 15 OR p.age &gt; 19</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the following example,
<code>transactionHistory</code> is a list of credit card transactions defined using
an order column.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> t
<span class="keyword">FROM</span> CreditCard c <span class="keyword">JOIN</span> c.transactionHistory t
<span class="keyword">WHERE</span> c.holder.name = <span class="string"><span class="delimiter">'</span><span class="content">John Doe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> <span class="type">INDEX</span>(t) <span class="keyword">BETWEEN</span> <span class="integer">0</span> <span class="keyword">AND</span> <span class="integer">9</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a5107"><a class="anchor" href="#a5107"></a>4.6.5. In Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator [NOT] IN in a conditional expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>in_expression ::=
    {state_valued_path_expression | type_discriminator} [NOT] IN
        {(in_item {, in_item}*) | (subquery) | collection_valued_input_parameter}
in_item ::= literal | single_valued_input_parameter</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>state_valued_path_expression</code> must have
a string, numeric, date, time, timestamp, or enum value.</p>
</div>
<div class="paragraph">
<p>The literal and/or input parameter values
must be <em>like</em> the abstract schema type of the
<code>state_valued_path_expression</code> in type. (See <a href="#a5735">Section 4.6.14</a>.)</p>
</div>
<div class="paragraph">
<p>The results of the subquery must be <em>like</em>
the abstract schema type of the <code>state_valued_path_expression</code> in
type. Subqueries are discussed in <a href="#a5196">Section 4.6.12</a>.</p>
</div>
<div class="paragraph">
<p>Example 1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">o.country <span class="keyword">IN</span> (<span class="string"><span class="delimiter">'</span><span class="content">UK</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">US</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">France</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>is true for <code>UK</code> and false for <code>Peru</code>, and is equivalent to the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">(o.country = <span class="string"><span class="delimiter">'</span><span class="content">UK</span><span class="delimiter">'</span></span>) <span class="keyword">OR</span> (o.country = <span class="string"><span class="delimiter">'</span><span class="content">US</span><span class="delimiter">'</span></span>) <span class="keyword">OR</span> (o.country = <span class="string"><span class="delimiter">'</span><span class="content">France</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 2:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">o.country <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="string"><span class="delimiter">'</span><span class="content">UK</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">US</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">France</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>is false for <code>UK</code> and true for <code>Peru</code>, and is equivalent to the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="keyword">NOT</span> ((o.country = <span class="string"><span class="delimiter">'</span><span class="content">UK</span><span class="delimiter">'</span></span>) <span class="keyword">OR</span> (o.country = <span class="string"><span class="delimiter">'</span><span class="content">US</span><span class="delimiter">'</span></span>) <span class="keyword">OR</span> (o.country = <span class="string"><span class="delimiter">'</span><span class="content">France</span><span class="delimiter">'</span></span>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>If an IN or NOT IN expression has a list of <code>in_item</code> expressions,
there must be at least one item in the list.
The value of such expressions is determined according to the
following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>state_valued_path_expression</code> in an IN or NOT IN expression
evaluates to <code>NULL</code> or unknown, then the whole IN or NOT IN
expression evaluates to <code>NULL</code> or unknown.</p>
</li>
<li>
<p>Otherwise, if the <code>state_valued_path_expression</code> and at least one
<code>in_item</code> evaluate to the same value, the whole IN or NOT IN
expression evaluates to true.</p>
</li>
<li>
<p>Otherwise, if the value of a <code>state_valued_path_expression</code>
evaluates to a value distinct from the value of every <code>in_item</code>
expression, the whole IN or NOT IN expression evaluates to:</p>
<div class="ulist">
<ul>
<li>
<p>false, if every <code>in_item</code> expression evaluates to a non-null
value, or</p>
</li>
<li>
<p><code>NULL</code> or unknown if at least one <code>in_item</code> expression evaluates
to null.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The list of values may be parameterized by a collection-valued input parameter.
<sup class="footnote">[<a id="_footnoteref_70" class="footnote" href="#_footnotedef_70" title="View footnote.">70</a>]</sup> (See <a href="#a5065">Section 4.7.4</a>.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">o.country <span class="keyword">NOT</span> <span class="keyword">IN</span> :countries</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="like-expressions"><a class="anchor" href="#like-expressions"></a>4.6.6. Like Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator [NOT] LIKE in a conditional expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>like_expression ::=
    string_expression [NOT] LIKE pattern_value [ESCAPE escape_character]</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>string_expression</code> must have a string
value. The <code>pattern_value</code> is a string literal or a string-valued input
parameter in which an underscore (<code><em></code>) stands for any single
character, a percent (</em>%<em>) character stands for any sequence of
characters (including the empty sequence), and all other characters
stand for themselves. The optional <code>escape_character</code> _</em> is a
single-character string literal or a character-valued input parameter
(i.e., <code>char</code> or <code>Character</code>) and is used to escape the special meaning
of the underscore and percent characters in <code>pattern_value</code>
_.<sup class="footnote">[<a id="_footnoteref_71" class="footnote" href="#_footnotedef_71" title="View footnote.">71</a>]</sup></p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>address.phone LIKE '12%3'</em> is true for '123', '12993' and false for '1234'</p>
</li>
<li>
<p><em>asentence.word LIKE 'l_se'</em> is true for 'lose' and false for 'loose'</p>
</li>
<li>
<p><em>aword.underscored LIKE '\</em>%' ESCAPE '\'_ is true for '_foo' and false for 'bar'</p>
</li>
<li>
<p><em>address.phone NOT LIKE '12%3'</em> is false for '123' and '12993' and true for '1234'</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the value of the <code>string_expression</code> or
<code>pattern_value</code> is <code>NULL</code> or unknown, the value of the LIKE expression
is unknown. If the <code>escape_character</code> is specified and is <code>NULL</code>, the
value of the LIKE expression is unknown.</p>
</div>
</div>
<div class="sect3">
<h4 id="null-comparison-expressions"><a class="anchor" href="#null-comparison-expressions"></a>4.6.7. Null Comparison Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator IS NULL in a conditional expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>null_comparison_expression ::=
    {single_valued_path_expression | input_parameter} IS [NOT] NULL</pre>
</div>
</div>
<div class="paragraph">
<p>A null comparison expression tests whether or
not the single-valued path expression or input parameter is a <code>NULL</code>
value.</p>
</div>
<div class="paragraph">
<p>Null comparisons over instances of embeddable
class types are not supported. Support for comparisons over embeddables
may be added in a future release of this specification.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5139"><a class="anchor" href="#a5139"></a>4.6.8. Empty Collection Comparison Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator IS EMPTY in an <code>empty_collection_comparison_expression</code> is as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>empty_collection_comparison_expression ::=
    collection_valued_path_expression IS [NOT] EMPTY</pre>
</div>
</div>
<div class="paragraph">
<p>This expression tests whether or not the
collection designated by the collection-valued path expression is empty
(i.e, has no elements).</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.lineItems <span class="keyword">IS</span> EMPTY</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the value of the collection-valued path
expression in an empty collection comparison expression is unknown, the
value of the empty comparison expression is unknown.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5150"><a class="anchor" href="#a5150"></a>4.6.9. Collection Member Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator MEMBER OF<sup class="footnote">[<a id="_footnoteref_72" class="footnote" href="#_footnotedef_72" title="View footnote.">72</a>]</sup> in an
<code>collection_member_expression</code> is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>collection_member_expression ::=
    entity_or_value_expression [NOT] MEMBER [OF] collection_valued_path_expression
entity_or_value_expression ::=
    single_valued_object_path_expression |
    state_valued_path_expression |
    simple_entity_or_value_expression
simple_entity_or_value_expression ::=
    identification_variable |
    input_parameter |
    literal</pre>
</div>
</div>
<div class="paragraph">
<p>This expression tests whether the designated
value is a member of the collection specified by the collection-valued
path expression.</p>
</div>
<div class="paragraph">
<p>Expressions that evaluate to embeddable types
are not supported in collection member expressions. Support for use of
embeddables in collection member expressions may be added in a future
release of this specification.</p>
</div>
<div class="paragraph">
<p>If the collection valued path expression
designates an empty collection, the value of the MEMBER OF expression is
FALSE and the value of the NOT MEMBER OF expression is TRUE. Otherwise,
if the value of the <code>collection_valued_path_expression</code>
or <code>entity_or_value_expression</code> in the
collection member expression is <code>NULL</code> or unknown, the value of the
collection member expression is unknown.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p
<span class="keyword">FROM</span> Person p
<span class="keyword">WHERE</span> <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> MEMBER <span class="keyword">OF</span> p.nicknames</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="exists-expressions"><a class="anchor" href="#exists-expressions"></a>4.6.10. Exists Expressions</h4>
<div class="paragraph">
<p>An EXISTS expression is a predicate that is
true only if the result of the subquery consists of one or more values
and that is false otherwise.</p>
</div>
<div class="paragraph">
<p>The syntax of an exists expression is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>exists_expression ::= [NOT] EXISTS (subquery)</pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (
    <span class="class">SELECT</span> spouseEmp
    <span class="keyword">FROM</span> Employee spouseEmp
        <span class="keyword">WHERE</span> spouseEmp = emp.spouse)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of this query consists of all
employees whose spouses are also employees.</p>
</div>
</div>
<div class="sect3">
<h4 id="all-or-any-expressions"><a class="anchor" href="#all-or-any-expressions"></a>4.6.11. All or Any Expressions</h4>
<div class="paragraph">
<p>An ALL conditional expression is a predicate
over a subquery that is true if the comparison operation is true for all
values in the result of the subquery or the result of the subquery is
empty. An ALL conditional expression is false if the result of the
comparison is false for at least one value of the result of the
subquery, and is unknown if neither true nor false.</p>
</div>
<div class="paragraph">
<p>An ANY conditional expression is a predicate
over a subquery that is true if the comparison operation is true for
some value in the result of the subquery. An ANY conditional expression
is false if the result of the subquery is empty or if the comparison
operation is false for every value in the result of the subquery, and is
unknown if neither true nor false. The keyword SOME is synonymous with
ANY.</p>
</div>
<div class="paragraph">
<p>The comparison operators used with ALL or ANY
conditional expressions are =, &lt;, &lt;=, &gt;, &gt;=, &lt;&gt;. The result of the
subquery must be like that of the other argument to the comparison
operator in type. See <a href="#a5735">Section 4.6.14</a>.</p>
</div>
<div class="paragraph">
<p>The syntax of an ALL or ANY expression is
specified as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>all_or_any_expression ::= {ALL | ANY | SOME} (subquery)</pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> emp.salary &gt; <span class="keyword">ALL</span> (
    <span class="class">SELECT</span> m.salary
    <span class="keyword">FROM</span> Manager m
    <span class="keyword">WHERE</span> m.department = emp.department)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of this query consists of all
employees whose salaries exceed the salaries of all managers in their
department.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5196"><a class="anchor" href="#a5196"></a>4.6.12. Subqueries</h4>
<div class="paragraph">
<p>Subqueries may be used in the WHERE or HAVING clause.<sup class="footnote">[<a id="_footnoteref_73" class="footnote" href="#_footnotedef_73" title="View footnote.">73</a>]</sup></p>
</div>
<div class="paragraph">
<p>The syntax for subqueries is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>subquery ::= simple_select_clause subquery_from_clause [where_clause]
    [groupby_clause] [having_clause]
simple_select_clause ::= SELECT [DISTINCT] simple_select_expression
subquery_from_clause ::=
    FROM subselect_identification_variable_declaration
        {, subselect_identification_variable_declaration |
            collection_member_declaration}*
subselect_identification_variable_declaration ::=
    identification_variable_declaration |
    derived_path_expression [AS] identification_variable {join}* |
    derived_collection_member_declaration
simple_select_expression ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable
derived_path_expression ::=
    general_derived_path.single_valued_object_field |
    general_derived_path.collection_valued_field
general_derived_path ::=
    simple_derived_path |
    treated_derived_path{.single_valued_object_field}*
simple_derived_path ::= superquery_identification_variable{.single_valued_object_field}*
treated_derived_path ::= TREAT(general_derived_path AS subtype)
derived_collection_member_declaration ::=
    IN superquery_identification_variable.{single_valued_object_field.}*collection_valued_field</pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (
    <span class="class">SELECT</span> spouseEmp
    <span class="keyword">FROM</span> Employee spouseEmp
    <span class="keyword">WHERE</span> spouseEmp = emp.spouse)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that some contexts in which a subquery
can be used require that the subquery be a scalar subquery (i.e.,
produce a single result). This is illustrated in the following examples
using numeric comparisons.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> (<span class="class">SELECT</span> <span class="predefined">AVG</span>(o.price) <span class="keyword">FROM</span> c.orders o) &gt; <span class="integer">100</span>

<span class="class">SELECT</span> goodCustomer
<span class="keyword">FROM</span> Customer goodCustomer
<span class="keyword">WHERE</span> goodCustomer.balanceOwed &lt; (
    <span class="class">SELECT</span> <span class="predefined">AVG</span>(c.balanceOwed)/<span class="float">2.0</span> <span class="keyword">FROM</span> Customer c)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a5676"><a class="anchor" href="#a5676"></a>4.6.13. Null Values</h4>
<div class="paragraph">
<p>When the target of a reference does not exist
in the database, its value is regarded as <code>NULL</code>. SQL <code>NULL</code> semantics
<a href="#a19494">[2]</a> defines the evaluation of
conditional expressions containing <code>NULL</code> values.</p>
</div>
<div class="paragraph">
<p>The following is a brief description of these semantics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Comparison or arithmetic operations with a
NULL value always yield an unknown value.</p>
</li>
<li>
<p>Two NULL values are not considered to be
equal, the comparison yields an unknown value.</p>
</li>
<li>
<p>Comparison or arithmetic operations with an
unknown value always yield an unknown value.</p>
</li>
<li>
<p>The IS NULL and IS NOT NULL operators convert
a <code>NULL</code> state field or single-valued object field value into the
respective TRUE or FALSE value.</p>
</li>
<li>
<p>Boolean operators use three valued logic,
defined by <a href="#a5686">Table 1</a>, <a href="#a5705">Table 2</a>, and <a href="#a5724">Table 3</a>.</p>
</li>
</ul>
</div>
<table id="a5686" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Definition of the AND Operator</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">AND</th>
<th class="tableblock halign-left valign-top">T</th>
<th class="tableblock halign-left valign-top">F</th>
<th class="tableblock halign-left valign-top">U</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
</tbody>
</table>
<table id="a5705" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Definition of the OR Operator</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">OR</th>
<th class="tableblock halign-left valign-top">T</th>
<th class="tableblock halign-left valign-top">F</th>
<th class="tableblock halign-left valign-top">U</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
</tbody>
</table>
<table id="a5724" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Definition of the NOT Operator</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">NOT</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Jakarta Persistence query language
defines the empty string, '', as a string
with 0 length, which is not equal to a NULL value. However, NULL values
and empty strings may not always be distinguished when queries are
mapped to some databases. Application developers should therefore not
rely on the semantics of query comparisons involving the empty string
and NULL value.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="a5735"><a class="anchor" href="#a5735"></a>4.6.14. Equality and Comparison Semantics</h4>
<div class="paragraph">
<p>Only the values of <em>like</em> types are permitted
to be compared. A type is <em>like</em> another type if they correspond to the
same Java language type, or if one is a primitive Java language type and
the other is the wrapped Java class type equivalent (e.g., <code>int</code> and
<code>Integer</code> are like types in this sense). There is one exception to this
rule: it is valid to compare numeric values for which the rules of
numeric promotion apply. Conditional expressions attempting to compare
non-like type values are disallowed except for this numeric case.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the arithmetic operators, the string concatenation operator,
and comparison operators are permitted to be applied to state fields and
input parameters of the wrapped Java class equivalents to the primitive
numeric Java types.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Two entities of the same abstract schema type
are equal if and only if they have the same primary key value.</p>
</div>
<div class="paragraph">
<p>Only equality/inequality comparisons over
enums are required to be supported.</p>
</div>
<div class="paragraph">
<p>Comparisons over instances of embeddable
class or map entry types are not supported.</p>
</div>
<div class="paragraph">
<p>The following examples illustrate the syntax
and semantics of the Jakarta Persistence query language. These examples are
based on the example presented in <a href="#a4713">Section 4.3.2</a>.</p>
</div>
<div class="paragraph">
<p>Find all orders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all orders that need to be shipped to California:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.shippingAddress.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all states for which there are orders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o.shippingAddress.state
<span class="keyword">FROM</span> <span class="keyword">Order</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all orders that have line items:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the result of this query does not
include orders with no associated line items. This query can also be
written as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.lineItems <span class="keyword">IS</span> <span class="keyword">NOT</span> EMPTY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all orders that have no line items:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.lineItems <span class="keyword">IS</span> EMPTY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all pending orders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l
<span class="keyword">WHERE</span> l.shipped = <span class="predefined-constant">FALSE</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all orders in which the shipping address
differs from the billing address. This example assumes that the
application developer uses two distinct <code>entity</code> types to designate
shipping and billing addresses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span>
    <span class="keyword">NOT</span> (o.shippingAddress.state = o.billingAddress.state <span class="keyword">AND</span>
         o.shippingAddress.city = o.billingAddress.city <span class="keyword">AND</span>
         o.shippingAddress.street = o.billingAddress.street)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the application developer uses a single
<code>entity</code> type in two different relationships for both the shipping
address and the billing address, the above expression can be simplified
based on the equality rules defined in <a href="#a5735">Section 4.6.14</a>. The
query can then be written as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.shippingAddress &lt;&gt; o.billingAddress</code></pre>
</div>
</div>
<div class="paragraph">
<p>The query checks whether the same entity
abstract schema type instance (identified by its primary key) is related
to an order through two distinct relationships.</p>
</div>
<div class="sect4">
<h5 id="queries-using-input-parameters"><a class="anchor" href="#queries-using-input-parameters"></a>4.6.14.1. Queries Using Input Parameters</h5>
<div class="paragraph">
<p>The following query finds the orders for a
product whose name is designated by an input parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l
<span class="keyword">WHERE</span> l.product.name = <span class="error">?</span><span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For this query, the input parameter must be
of the type of the state field name, i.e., a string.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a5243"><a class="anchor" href="#a5243"></a>4.7. Scalar Expressions</h3>
<div class="paragraph">
<p>Numeric, string, datetime, case, and entity
type expressions result in scalar values.</p>
</div>
<div class="paragraph">
<p>Scalar expressions may be used in the SELECT
clause of a query as well as in the WHERE<sup class="footnote">[<a id="_footnoteref_74" class="footnote" href="#_footnotedef_74" title="View footnote.">74</a>]</sup> and
HAVING clauses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>scalar_expression ::=
    arithmetic_expression |
    string_expression |
    enum_expression |
    datetime_expression |
    boolean_expression |
    case_expression |
    entity_type_expression |
    entity_id_or_version_function</pre>
</div>
</div>
<div class="sect3">
<h4 id="literals"><a class="anchor" href="#literals"></a>4.7.1. Literals</h4>
<div class="paragraph">
<p>A string literal is enclosed in single
quotesfor example: 'literal'. A string literal that includes a single
quote is represented by two single quotesfor example: 'literal''s'.
String literals in queries, like Java <code>String</code> literals, use unicode
character encoding. The use of Java escape notation is not supported in
query string literals.</p>
</div>
<div class="paragraph">
<p>A numeric literal may be either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a decimal Java integer (int or long) literal</p>
</li>
<li>
<p>a Java floating point (float or double) literal, or</p>
</li>
<li>
<p>a literal <code>BigInteger</code> or <code>BigDecimal</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A suffix <code>L</code>, <code>D</code>, or <code>F</code> may be used to indicate the specific numeric
type, in accordance with the Java Language Specification. The suffix is
not case-sensitive. The literal numeric value preceding the suffix must
conform to the rules for Java numeric literals established by the Java
Language Specification.</p>
</div>
<div class="paragraph">
<p>A suffix <code>BI</code> or <code>BD</code> may be used to indicate a literal <code>BigInteger</code> or
<code>BigDecimal</code>, respectively. The literal numeric value preceding the suffix
must be an exact or approximate SQL numeric literal. For a <code>BigInteger</code>
literal, the numeric value must be an exact integer literal.</p>
</div>
<div class="paragraph">
<p>Just as in Java, when a numeric literal has no suffix:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an integer literal is interpreted as a Java int, and</p>
</li>
<li>
<p>a floating point literal is interpreted as a Java double.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Support for hexadecimal and octal numeric literals is not required by
this specification.</p>
</div>
<div class="paragraph">
<p>Enum literals support the use of Java enum
literal syntax. The fully qualified enum class name must be specified.</p>
</div>
<div class="paragraph">
<p>The JDBC escape syntax may be used for the
specification of date, time, and timestamp literals. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> c.name = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> o.submissionDate &lt; {d <span class="string"><span class="delimiter">'</span><span class="content">2008-12-31</span><span class="delimiter">'</span></span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The portability of this syntax for date,
time, and timestamp literals is dependent upon the JDBC driver in use.
Persistence providers are not required to translate from this syntax
into the native syntax of the database or driver.</p>
</div>
<div class="paragraph">
<p>The boolean literals are <code>TRUE</code> and <code>FALSE</code>.</p>
</div>
<div class="paragraph">
<p>Entity type literals are specified by entity namesfor example: <code>Customer</code>.</p>
</div>
<div class="paragraph">
<p>Although reserved literals appear in upper case, they are case-insensitive.</p>
</div>
</div>
<div class="sect3">
<h4 id="identification-variables"><a class="anchor" href="#identification-variables"></a>4.7.2. Identification Variables</h4>
<div class="paragraph">
<p>All identification variables used in the
WHERE or HAVING clause of a SELECT or DELETE statement must be declared
in the FROM clause, as described in <a href="#a4765">Section 4.4.2</a>. The identification variables used in the
WHERE clause of an UPDATE statement must be declared in the UPDATE
clause.</p>
</div>
<div class="paragraph">
<p>Identification variables are existentially
quantified in the WHERE and HAVING clause.
This means that an identification variable represents a member of a
collection or an instance of an entity&#8217;s abstract schema type. An
identification variable never designates a collection in its entirety.</p>
</div>
</div>
<div class="sect3">
<h4 id="path-expressions"><a class="anchor" href="#path-expressions"></a>4.7.3. Path Expressions</h4>
<div class="paragraph">
<p>It is illegal to use a
<code>collection_valued_path_expression</code> within a WHERE or HAVING clause as
part of a conditional expression except in an
<code>empty_collection_comparison_expression</code>, in a
<code>collection_member_expression</code>, or as an argument to the SIZE operator.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5065"><a class="anchor" href="#a5065"></a>4.7.4. Input Parameters</h4>
<div class="paragraph">
<p>An input parameter allows a value in the Java program to be safely
interpolated into the text of the parameterized query.</p>
</div>
<div class="paragraph">
<p>In a given query, either positional or named parameters may be used.
Positional and named parameters must not be mixed in a single query.</p>
</div>
<div class="paragraph">
<p>The persistence provider is required to support input parameters which
occur in the <code>WHERE</code> clause or <code>HAVING</code> clause of a query, or as the
new value for an update item in the <code>SET</code> clause of an update statement.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that if an input parameter value is null, comparison operations or
arithmetic operations involving the input parameter will result in an
unknown value. See <a href="#a5676">Section 4.6.13</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An input parameter might be <em>single-valued</em> or <em>collection-valued</em>.
An input parameter which occurs directly to the right of the <code>IN</code> keyword
in an <code>IN</code> predicate, as defined in <a href="#a5107">Section 4.6.5</a>, is collection-valued. Every
other input parameter is single-valued</p>
</div>
<div class="paragraph">
<p>The API for the binding concrete arguments to query parameters is described
in <a href="#a3125">Section 3.11</a>.</p>
</div>
<div class="sect4">
<h5 id="positional-parameters"><a class="anchor" href="#positional-parameters"></a>4.7.4.1. Positional Parameters</h5>
<div class="paragraph">
<p>The following rules apply to positional input parameters.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A positional parameter is designated by an integer, and prefixed with a
<em>?</em> symbol (question mark) in the text of the query string.
For example: <em>?1</em>.</p>
</li>
<li>
<p>Input parameters are numbered starting from 1.</p>
</li>
<li>
<p>A given positional parameter may occur more than once in the query string.</p>
</li>
<li>
<p>The ordering of the use of parameters within the text of the query string
need not match the numbering of the positional parameters.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="named-parameters"><a class="anchor" href="#named-parameters"></a>4.7.4.2. Named Parameters</h5>
<div class="paragraph">
<p>A named parameter is denoted by an identifier, and prefixed by the <em>:</em> symbol
(colon) in the text of the query string. The identifier name must follow the
usual rules for identifiers specified in <a href="#a4760">Section 4.4.1</a>. Named parameters are
case-sensitive.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> c.status = :stat</code></pre>
</div>
</div>
<div class="paragraph">
<p>A given named parameter may occur more than once in the query string.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="arithmetic-expressions"><a class="anchor" href="#arithmetic-expressions"></a>4.7.5. Arithmetic Expressions</h4>
<div class="paragraph">
<p>The arithmetic operators are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>+, - unary</p>
</li>
<li>
<p>*, / multiplication and division</p>
</li>
<li>
<p>+, - addition and subtraction</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Arithmetic operations use numeric promotion.</p>
</div>
<div class="paragraph">
<p>Arithmetic functions are described in <a href="#a5284">Section 4.7.7.2</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="string-concatenation-operator"><a class="anchor" href="#string-concatenation-operator"></a>4.7.6. String concatenation operator</h4>
<div class="paragraph">
<p>The binary concatenation operator is ||.
Its operands must be string expressions.</p>
</div>
</div>
<div class="sect3">
<h4 id="built-in-string-arithmetic-and-datetime-functional-expressions"><a class="anchor" href="#built-in-string-arithmetic-and-datetime-functional-expressions"></a>4.7.7. Built-in String, Arithmetic, and Datetime Functional Expressions</h4>
<div class="paragraph">
<p>The Jakarta Persistence query language includes
the built-in functions described in <a href="#a5264">Section 4.7.7.1</a>, <a href="#a5284">Section 4.7.7.2</a>,
<a href="#a5304">Section 4.7.7.3</a>, which may be used
in the SELECT, WHERE or HAVING clause of a query. The invocation of
predefined database functions and user-defined database functions is
described in <a href="#a5311">Section 4.7.9</a>.</p>
</div>
<div class="paragraph">
<p>If the value of any argument to a functional
expression is null or unknown, the value of the functional expression is
unknown.</p>
</div>
<div class="sect4">
<h5 id="a5264"><a class="anchor" href="#a5264"></a>4.7.7.1. String Functions</h5>
<div class="listingblock">
<div class="content">
<pre>functions_returning_strings ::=
    CONCAT(string_expression, string_expression {, string_expression}*) |
    SUBSTRING(string_expression,
              arithmetic_expression [, arithmetic_expression]) |
    TRIM([[trim_specification] [trim_character] FROM] string_expression) |
    LOWER(string_expression) |
    UPPER(string_expression) |
    REPLACE(string_expression, string_expression, string_expression) |
    LEFT(string_expression, arithmetic_expression) |
    RIGHT(string_expression, arithmetic_expression)
trim_specification ::= LEADING | TRAILING | BOTH

functions_returning_numerics ::=
    LENGTH(string_expression) |
    LOCATE(string_expression, string_expression[, arithmetic_expression])</pre>
</div>
</div>
<div class="paragraph">
<p>The CONCAT function returns a string that is
a concatenation of its arguments.</p>
</div>
<div class="paragraph">
<p>The second and third arguments of the
SUBSTRING function denote the starting position and length of the
substring to be returned. These arguments are integers. The third
argument is optional. If it is not specified, the substring from the
start position to the end of the string is returned. The first position
of a string is denoted by 1. The SUBSTRING function returns a string.</p>
</div>
<div class="paragraph">
<p>The TRIM function trims the specified
character from a string. If the character to be trimmed is not
specified, it will be assumed to be space (or blank). The optional
<code>trim_character</code> __ is a single-character string literal or a
character-valued input parameter (i.e., <code>char</code> or <code>Character</code>
)<sup class="footnote">[<a id="_footnoteref_75" class="footnote" href="#_footnotedef_75" title="View footnote.">75</a>]</sup>. If a trim specification is not provided, it
defaults to BOTH. The TRIM function returns the trimmed string.</p>
</div>
<div class="paragraph">
<p>The LOWER and UPPER functions convert a
string to lower and upper case, respectively, with regard to the locale
of the database. They return a string.</p>
</div>
<div class="paragraph">
<p>The LEFT and RIGHT functions return the leftmost or rightmost substring,
respectively, of the first argument whose length is given by the second
argument.</p>
</div>
<div class="paragraph">
<p>The REPLACE function replaces all occurrences within the first argument
string of the second argument string with the third argument string.</p>
</div>
<div class="paragraph">
<p>The LOCATE function returns the position at which one string occurs within
a second string, optionally ignoring any occurrences that begin before a
specified character position in the second string. It returns the first
character position within the second string (after the specified character
position, if any) at which the first string occurs, as an integer, where
the first character of the second string is denoted by 1. That is, the first
argument is the string to be searched for; the second argument is the string
to be searched in; the optional third argument is an integer representing
the character position at which the search starts (by default, 1, the first
character of the second string). If the first string does not occur within
the second string, 0 is returned.<sup class="footnote">[<a id="_footnoteref_76" class="footnote" href="#_footnotedef_76" title="View footnote.">76</a>]</sup></p>
</div>
<div class="paragraph">
<p>The LENGTH function returns the length of the
string in characters as an integer.</p>
</div>
</div>
<div class="sect4">
<h5 id="a5284"><a class="anchor" href="#a5284"></a>4.7.7.2. Arithmetic Functions</h5>
<div class="listingblock">
<div class="content">
<pre>functions_returning_numerics ::=
    ABS(arithmetic_expression) |
    CEILING(arithmetic_expression) |
    EXP(arithmetic_expression) |
    FLOOR(arithmetic_expression) |
    LN(arithmetic_expression) |
    MOD(arithmetic_expression, arithmetic_expression) |
    POWER(arithmetic_expression, arithmetic_expression) |
    ROUND(arithmetic_expression, arithmetic_expression) |
    SIGN(arithmetic_expression) |
    SQRT(arithmetic_expression) |
    SIZE(collection_valued_path_expression) |
    INDEX(identification_variable) |
    extract_datetime_field</pre>
</div>
</div>
<div class="paragraph">
<p>The ABS, CEILING, and FLOOR functions accept a numeric argument and
return a number (integer, float, or double) of the same type as the
argument.</p>
</div>
<div class="paragraph">
<p>The SIGN function accepts a numeric argument and returns an integer.</p>
</div>
<div class="paragraph">
<p>The SQRT, EXP, and LN functions accept a numeric argument and return
a double.</p>
</div>
<div class="paragraph">
<p>The MOD function accepts two integer arguments and returns an integer.</p>
</div>
<div class="paragraph">
<p>The ROUND function accepts a numeric argument and an integer argument
and returns a number of the same type as the first argument.</p>
</div>
<div class="paragraph">
<p>The POWER function accepts two numeric arguments and returns a double.</p>
</div>
<div class="paragraph">
<p>Numeric arguments to these functions may
correspond to the numeric Java object types as well as the primitive
numeric types.</p>
</div>
<div class="paragraph">
<p>The SIZE function returns an integer value,
the number of elements of the collection. If the collection is empty,
the SIZE function evaluates to zero.</p>
</div>
<div class="paragraph">
<p>The INDEX function returns an integer value
corresponding to the position of its argument in an ordered list. The
INDEX function can only be applied to identification variables denoting
types for which an order column has been specified.</p>
</div>
<div class="paragraph">
<p>In the following example, <em>studentWaitlist</em>
is a list of students for which an order column has been specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> w.name
<span class="keyword">FROM</span> Course c <span class="keyword">JOIN</span> c.studentWaitlist w
<span class="keyword">WHERE</span> c.name = <span class="string"><span class="delimiter">'</span><span class="content">Calculus</span><span class="delimiter">'</span></span>
<span class="keyword">AND</span> <span class="type">INDEX</span>(w) = <span class="integer">0</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="a5304"><a class="anchor" href="#a5304"></a>4.7.7.3. Datetime Functions</h5>
<div class="listingblock">
<div class="content">
<pre>functions_returning_datetime :=
    CURRENT_DATE |
    CURRENT_TIME |
    CURRENT_TIMESTAMP |
    LOCAL DATE |
    LOCAL TIME |
    LOCAL DATETIME |
    extract_datetime_part</pre>
</div>
</div>
<div class="paragraph">
<p>The functions LOCAL DATE, LOCAL TIME, and LOCAL DATETIME return the value
of the current date, time, or timestamp on the database server, respectively.
Their types are <code>java.time.LocalDate</code>, <code>java.time.LocalTime</code>, and
<code>java.time.LocalDateTime</code> respectively.</p>
</div>
<div class="paragraph">
<p>The functions CURRENT_DATE, CURRENT_TIME, and CURRENT_TIMESTAMP
return the value of the current date, time, or timestamp on the database
server, respectively. Their types are <code>java.sql.Date</code>, <code>java.sql.Time</code>,
and <code>java.sql.Timestamp</code> respectively.</p>
</div>
<div class="paragraph">
<p>The EXTRACT function takes a datetime argument and one of the following
field type identifiers: YEAR, QUARTER, MONTH, WEEK, DAY, HOUR, MINUTE,
SECOND, DATE, TIME.</p>
</div>
<div class="paragraph">
<p>EXTRACT returns the value of the corresponding field or part of the
datetime.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>extract_datetime_field :=
    EXTRACT(datetime_field FROM datetime_expression)

datetime_field := identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>For the following field type identifiers, EXTRACT returns an integer
value:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>YEAR means the calendar year.</p>
</li>
<li>
<p>QUARTER means the calendar quarter, numbered from 1 to 4.</p>
</li>
<li>
<p>MONTH means the calendar month of the year, numbered from 1.</p>
</li>
<li>
<p>WEEK means the ISO-8601 week number.</p>
</li>
<li>
<p>DAY means the calendar day of the month, numbered from 1.</p>
</li>
<li>
<p>HOUR means the hour of the day in 24-hour time, numbered from 0 to 23.</p>
</li>
<li>
<p>MINUTE means the minute of the hour, numbered from 0 to 59.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the SECOND field type identifier, EXTRACT returns a floating point
value:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SECOND means the second of the minute, numbered from 0 to 59, including
a fractional part representing fractions of a second.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is illegal to pass a datetime argument which does not have the given
field type to EXTRACT.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>extract_datetime_part :=
    EXTRACT(datetime_part FROM datetime_expression)

datetime_part := identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>For the following field type identifiers, EXTRACT returns a part of the
datetime value:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DATE means the date part of a datetime.</p>
</li>
<li>
<p>TIME means the time part of a datetime.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is illegal to pass a datetime argument which does not have the given
part to EXTRACT.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="keyword">FROM</span> Course c <span class="keyword">WHERE</span> c.year = EXTRACT(<span class="predefined-type">YEAR</span> <span class="keyword">FROM</span> LOCAL <span class="predefined-type">DATE</span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="typecasts"><a class="anchor" href="#typecasts"></a>4.7.8. Typecasts</h4>
<div class="paragraph">
<p>The CAST function converts an expression of one type to an expression
of a different type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>string_cast_function::=
    CAST(scalar_expression AS STRING)
arithmetic_cast_function::=
    CAST(string_expression AS {INTEGER | LONG | FLOAT | DOUBLE})</pre>
</div>
</div>
<div class="paragraph">
<p>The persistence provider is required to accept typecasts of the following
forms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any scalar expression to STRING</p>
</li>
<li>
<p>any string expression to INTEGER, LONG, FLOAT, or DOUBLE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Typecast expressions are evaluated by the database, with semantics that
vary somewhat between different databases.</p>
</div>
<div class="paragraph">
<p>When a typecast occurs as a select expression, the result type of the
select expression is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.lang.String</code> for a cast to STRING</p>
</li>
<li>
<p><code>java.lang.Integer</code>, <code>java.lang.Long</code>, <code>java.lang.Float</code>, or <code>java.lang.Double</code>
for a cast to INTEGER, LONG, FLOAT, or DOUBLE, respectively</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a5311"><a class="anchor" href="#a5311"></a>4.7.9. Invocation of Predefined and User-defined Database Functions</h4>
<div class="paragraph">
<p>The invocation of functions other than the
built-in functions of the Jakarta Persistence query language is supported
by means of the <code>function_invocation</code> syntax. This includes the
invocation of predefined database functions and user-defined database
functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>function_invocation ::= FUNCTION(function_name {, function_arg}*)

function_arg ::=
    literal |
    state_valued_path_expression |
    input_parameter |
    scalar_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>function_name</code> argument is a string that
denotes the database function that is to be invoked. The arguments must
be suitable for the database function that is to be invoked. The result
of the function must be suitable for the invocation context.</p>
</div>
<div class="paragraph">
<p>The function may be a database-defined
function or a user-defined function. The function may be a scalar
function or an aggregate function.</p>
</div>
<div class="paragraph">
<p>Applications that use the
<code>function_invocation</code> syntax will not be portable across databases.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> <span class="type">FUNCTION</span>(<span class="string"><span class="delimiter">'</span><span class="content">hasGoodCredit</span><span class="delimiter">'</span></span>, c.balance, c.creditLimit)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="case-expressions"><a class="anchor" href="#case-expressions"></a>4.7.10. Case Expressions</h4>
<div class="paragraph">
<p>The following forms of case
expressions are supported: general case expressions, simple case
expressions, coalesce expressions, and nullif
expressions.<sup class="footnote">[<a id="_footnoteref_77" class="footnote" href="#_footnotedef_77" title="View footnote.">77</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>case_expression ::=
    general_case_expression |
    simple_case_expression |
    coalesce_expression |
    nullif_expression

general_case_expression ::=
    CASE when_clause {when_clause}* ELSE scalar_expression END
when_clause ::= WHEN conditional_expression THEN scalar_expression

simple_case_expression ::=
    CASE case_operand simple_when_clause {simple_when_clause}*
    ELSE scalar_expression
    END
case_operand ::= state_valued_path_expression | type_discriminator
simple_when_clause ::= WHEN scalar_expression THEN scalar_expression

coalesce_expression ::= COALESCE(scalar_expression {, scalar_expression}+)

nullif_expression ::= NULLIF(scalar_expression, scalar_expression)</pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.salary =
    <span class="keyword">CASE</span> <span class="keyword">WHEN</span> e.rating = <span class="integer">1</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.1</span>
         <span class="keyword">WHEN</span> e.rating = <span class="integer">2</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.05</span>
         <span class="keyword">ELSE</span> e.salary * <span class="float">1.01</span>
    <span class="keyword">END</span>

<span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.salary =
    <span class="keyword">CASE</span> e.rating <span class="keyword">WHEN</span> <span class="integer">1</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.1</span>
                  <span class="keyword">WHEN</span> <span class="integer">2</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.05</span>
                  <span class="keyword">ELSE</span> e.salary * <span class="float">1.01</span>
    <span class="keyword">END</span>

<span class="class">SELECT</span> e.name,
    <span class="keyword">CASE</span> TYPE(e) <span class="keyword">WHEN</span> Exempt <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Exempt</span><span class="delimiter">'</span></span>
                 <span class="keyword">WHEN</span> Contractor <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Contractor</span><span class="delimiter">'</span></span>
                 <span class="keyword">WHEN</span> Intern <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Intern</span><span class="delimiter">'</span></span>
                 <span class="keyword">ELSE</span> <span class="string"><span class="delimiter">'</span><span class="content">NonExempt</span><span class="delimiter">'</span></span>
    <span class="keyword">END</span>
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> e.dept.name = <span class="string"><span class="delimiter">'</span><span class="content">Engineering</span><span class="delimiter">'</span></span>

<span class="class">SELECT</span> e.name,
       f.name,
       CONCAT(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> f.annualMiles &gt; <span class="integer">50000</span> <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Platinum </span><span class="delimiter">'</span></span>
                   <span class="keyword">WHEN</span> f.annualMiles &gt; <span class="integer">25000</span> <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Gold </span><span class="delimiter">'</span></span>
                   <span class="keyword">ELSE</span> <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
              <span class="keyword">END</span>,
       <span class="string"><span class="delimiter">'</span><span class="content">Frequent Flyer</span><span class="delimiter">'</span></span>)
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.frequentFlierPlan f</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="identifier-and-version-functions"><a class="anchor" href="#identifier-and-version-functions"></a>4.7.11. Identifier and Version Functions</h4>
<div class="paragraph">
<p>The ID and VERSION functions evaluate to the primary key or version,
respectively, of their argument, which must be an identification variable
assigned an entity abstract schema type or a path expression resolving to
a one-to-one or many-to-one relationship field. For example, if <code>Person</code>
has a primary key field named <code>ssn</code>, then <code>ID(person)</code> is a synonym for
<code>person.ssn</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>entity_id_or_version_function ::= id_function | version_function
id_function ::=
    ID(general_identification_variable |
       single_valued_object_path_expression)
version_function ::=
    VERSION(general_identification_variable |
            single_valued_object_path_expression)</pre>
</div>
</div>
<div class="paragraph">
<p>The result type of an ID or VERSION function expression is the primary
key type or version type of the argument entity, respectively.</p>
</div>
<div class="paragraph">
<p>The result may be compared to an input parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DELETE</span> <span class="keyword">from</span> Employee
<span class="keyword">WHERE</span> id(this) = :id
  <span class="keyword">AND</span> version(this) = :version</code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence provider is not required to support the use of the ID
function for entities with composite primary keys.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5381"><a class="anchor" href="#a5381"></a>4.7.12. Entity Type Expressions and Literal Entity Types</h4>
<div class="paragraph">
<p>An <em>entity type expression</em> can be used to restrict query polymorphism.
The syntax of an entity type expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>entity_type_expression ::=
    type_discriminator |
    entity_type_literal |
    input_parameter
type_discriminator ::=
    TYPE(general_identification_variable |
         single_valued_object_path_expression |
         input_parameter)</pre>
</div>
</div>
<div class="paragraph">
<p>The TYPE operator returns the exact type of its argument, which must be
an identification variable assigned an entity abstract schema type, a
path expression resolving to a one-to-one or many-to-one relationship
field, or an input parameter.</p>
</div>
<div class="paragraph">
<p>An <code>entity_type_literal</code> specifies a literal entity type by its entity
name defined above in <a href="#naming">Section 4.3.1</a>.</p>
</div>
<div class="paragraph">
<p>For an input parameter, the entity type must be specified by calling
<code>Query.setParameter()</code> with the <code>java.lang.Class</code> object representing
the entity class.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) <span class="keyword">IN</span> (Exempt, Contractor)

<span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) <span class="keyword">IN</span> (:empType1, :empType2)

<span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) <span class="keyword">IN</span> :empTypes

<span class="class">SELECT</span> TYPE(e)
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) &lt;&gt; Exempt</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a5574"><a class="anchor" href="#a5574"></a>4.7.13. Numeric Expressions and Type Promotion</h4>
<div class="paragraph">
<p>Every numeric expression in a query is assigned a Java numeric type
according to the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An expression that corresponds to a persistent state field is of the
same type as that persistent state field.</p>
</li>
<li>
<p>An expression that corresponds to one of arithmetic functions described
in <a href="#a5284">Section 4.7.7.2</a> is of the type defined by <a href="#a5284">Section 4.7.7.2</a>.</p>
</li>
<li>
<p>An expression that corresponds to one of an aggregate functions described
in <a href="#a5538">Section 4.9.5</a> is of the type defined by <a href="#a5538">Section 4.9.5</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a <code>CASE</code> expression, <code>COALESCE</code> expression, <code>NULLIF</code> expression, or
arithmetic operator expression (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>), the numeric type is
determined by its operand types, and by the following rules<sup class="footnote">[<a id="_footnoteref_78" class="footnote" href="#_footnotedef_78" title="View footnote.">78</a>]</sup>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is an operand of type <code>Double</code> or <code>double</code>, the expression
is of type <code>Double</code>;</p>
</li>
<li>
<p>otherwise, if there is an operand of type <code>Float</code> or <code>float</code>, the
expression is of type <code>Float</code>;</p>
</li>
<li>
<p>otherwise, if there is an operand of type <code>BigDecimal</code>, the expression
is of type <code>BigDecimal</code>;</p>
</li>
<li>
<p>otherwise, if there is an operand of type <code>BigInteger</code>, the expression
is of type <code>BigInteger</code>, unless the operator is <code>/</code> (division), in which
case the expression type is not defined here;</p>
</li>
<li>
<p>otherwise, if there is an operand of type <code>Long</code> or <code>long</code>, the
expression is of type <code>Long</code>, unless the operator is <code>/</code> (division),
in which case the expression type is not defined here;</p>
</li>
<li>
<p>otherwise, if there is an operand of integral type, the expression
is of type <code>Integer</code>, unless the operator is <code>/</code> (division), in which
case the expression type is not defined here.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Users should note that the semantics of the
SQL division operation are not standard across databases. In particular,
when both operands are of integral types, the result of the division
operation will be an integral type in some databases, and an
non-integral type in others. Portable applications should not assume a
particular result type.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For numeric expressions occurring in the SELECT clause, these rules
determine the Java object type returned in the query result list.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a5410"><a class="anchor" href="#a5410"></a>4.8. GROUP BY, HAVING</h3>
<div class="paragraph">
<p>The GROUP BY construct enables the
aggregation of result values according to a set of properties. The
HAVING construct enables conditions to be specified that further
restrict the query result. Such conditions are restrictions upon the
groups.</p>
</div>
<div class="paragraph">
<p>The syntax of the GROUP BY and HAVING clauses is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>groupby_clause ::= GROUP BY groupby_item {, groupby_item}*
groupby_item ::= single_valued_path_expression | identification_variable

having_clause ::= HAVING conditional_expression</pre>
</div>
</div>
<div class="paragraph">
<p>If a query contains both a WHERE clause and a
GROUP BY clause, the effect is that of first applying the where clause,
and then forming the groups and filtering them according to the HAVING
clause. The HAVING clause causes those groups to be retained that
satisfy the condition of the HAVING clause.</p>
</div>
<div class="paragraph">
<p>The requirements for the SELECT clause when
GROUP BY is used follow those of SQL: namely, any item that appears in
the SELECT clause (other than as an aggregate function or as an argument
to an aggregate function) must also appear in the GROUP BY clause. In
forming the groups, null values are treated as the same for grouping
purposes.</p>
</div>
<div class="paragraph">
<p>Grouping by an entity is permitted. In this
case, the entity must contain no serialized state fields or lob-valued
state fields that are eagerly fetched. Grouping by an entity that
contains serialized state fields or lob-valued state fields is not
portable, since the implementation is permitted to eagerly fetch fields
or properties that have been specified as LAZY.</p>
</div>
<div class="paragraph">
<p>Grouping by embeddables is not supported.</p>
</div>
<div class="paragraph">
<p>The HAVING clause is used to filter over the
groups, and can contain aggregate functions over attributes included in
the groups and/or functions or other query language operators over the
attributes that are used for grouping. It is not required that an
aggregate function used in the HAVING clause also be used in the SELECT
clause.</p>
</div>
<div class="paragraph">
<p>If there is no GROUP BY clause and the HAVING
clause is used, the result is treated as a single group, and the select
list can only consist of aggregate functions. The use of HAVING in the
absence of GROUP BY is not required to be supported by an implementation
of this specification. Portable applications should not rely on HAVING
without the use of GROUP BY.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.status, <span class="predefined">AVG</span>(c.filledOrderCount), <span class="predefined">COUNT</span>(c)
<span class="keyword">FROM</span> Customer c
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c.status
<span class="keyword">HAVING</span> c.status <span class="keyword">IN</span> (<span class="integer">1</span>, <span class="integer">2</span>)

<span class="class">SELECT</span> c.country, <span class="predefined">COUNT</span>(c)
<span class="keyword">FROM</span> Customer c
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c.country
<span class="keyword">HAVING</span> <span class="predefined">COUNT</span>(c) &gt; <span class="integer">30</span>

<span class="class">SELECT</span> c, <span class="predefined">COUNT</span>(o)
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c
<span class="keyword">HAVING</span> <span class="predefined">COUNT</span>(o) &gt;= <span class="integer">5</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a5438"><a class="anchor" href="#a5438"></a>4.9. SELECT Clause</h3>
<div class="paragraph">
<p>The SELECT clause specifies the query result, as a list of items to
be returned by the query.</p>
</div>
<div class="paragraph">
<p>The SELECT clause can contain one or more of the following elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an identification variable that ranges over an abstract schema type,</p>
</li>
<li>
<p>a single-valued path expression,</p>
</li>
<li>
<p>a scalar expression,</p>
</li>
<li>
<p>an aggregate expression,</p>
</li>
<li>
<p>a constructor expression.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The SELECT clause has the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>select_clause ::= SELECT [DISTINCT] select_item {, select_item}*
select_item ::= select_expression [[AS] result_variable]
select_expression ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable |
    OBJECT(identification_variable) |
    constructor_expression
constructor_expression ::=
    NEW constructor_name (constructor_item {, constructor_item}*)
constructor_item ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable
aggregate_expression ::=
    {AVG | MAX | MIN | SUM} ([DISTINCT] state_valued_path_expression) |
     COUNT ([DISTINCT] identification_variable | state_valued_path_expression |
         single_valued_object_path_expression) |
     function_invocation</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.id, c.status
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> o.count &gt; <span class="integer">100</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the following example, <code>videoInventory</code> is
a Map from the entity <code>Movie</code> to the number of copies in stock:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> v.location.street, <span class="type">KEY</span>(i).title, VALUE(i)
<span class="keyword">FROM</span> VideoStore v <span class="keyword">JOIN</span> v.videoInventory i
<span class="keyword">WHERE</span> v.location.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">94301</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> VALUE(i) &gt; <span class="integer">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the SELECT clause must be specified
to return only single-valued expressions. The query below is therefore
not valid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o.lineItems <span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>The DISTINCT
keyword is used to specify that duplicate values must be eliminated from
the query result.</p>
</div>
<div class="paragraph">
<p>If DISTINCT is not specified, duplicate
values are not eliminated.</p>
</div>
<div class="paragraph">
<p>The result of DISTINCT over embeddable
objects or map <code>entry</code> results is undefined.</p>
</div>
<div class="paragraph">
<p>Standalone identification variables in the
SELECT clause may optionally be qualified by the
OBJECT operator.<sup class="footnote">[<a id="_footnoteref_79" class="footnote" href="#_footnotedef_79" title="View footnote.">79</a>]</sup> The
SELECT clause must not use the OBJECT operator to qualify path
expressions.</p>
</div>
<div class="paragraph">
<p>A <code>result_variable</code> assigns a name to a <code>select_item</code> in the query result.
The <code>result variable</code> must be a valid identifier, as defined in <a href="#a4760">Section 4.4.1</a>,
must not be a reserved identifier, and must not collide with any
identification variable declared in the FROM clause. A result variable may
be used to refer to an element of the select clause from an item in the
ORDER BY clause, as specified in <a href="#a5587">Section 4.10</a>. Like identification variables,
result variables are case-insensitive.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c, <span class="predefined">COUNT</span>(l) <span class="keyword">AS</span> itemCount
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.Orders o <span class="keyword">JOIN</span> o.lineItems l
<span class="keyword">WHERE</span> c.address.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c
<span class="keyword">ORDER</span> <span class="keyword">BY</span> itemCount</code></pre>
</div>
</div>
<div class="paragraph">
<p>The SELECT clause is optional. A query with a missing SELECT clause
is interpreted as if it had the following single-item SELECT clause:
<code>select this</code>, where <code>this</code> is the implicit identification variable.</p>
</div>
<div class="paragraph">
<p>Thus, the following queries are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="keyword">FROM</span> <span class="keyword">Order</span>
<span class="keyword">WHERE</span> customer.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span>
  <span class="keyword">AND</span> customer.firstname= <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> this
<span class="keyword">FROM</span> <span class="keyword">Order</span>
<span class="keyword">WHERE</span> this.customer.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span>
  <span class="keyword">AND</span> this.customer.firstname= <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> ord
<span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> ord
<span class="keyword">WHERE</span> ord.customer.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span>
  <span class="keyword">AND</span> ord.customer.firstname= <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the implicit identification variable has not been assigned an
abstract schema type, the SELECT clause is required.</p>
</div>
<div class="sect3">
<h4 id="a5439"><a class="anchor" href="#a5439"></a>4.9.1. Result Type of the SELECT Clause</h4>
<div class="paragraph">
<p>The type of the query result specified by the
SELECT clause of a query is an entity
abstract schema type, a state field type,
the result of a scalar expression, the result of an aggregate function,
the result of a construction operation, or some sequence of these.</p>
</div>
<div class="paragraph">
<p>The result type of the SELECT clause is
defined by the the result types of the select expressions contained in
it. When multiple select expressions are used in the SELECT clause, the
elements in this result correspond in order to the order of their
specification in the SELECT clause and in type to the result types of
each of the select expressions.</p>
</div>
<div class="paragraph">
<p>The type of the result of a select_expression
is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The result type of an identification_variable
is the type of the entity object or embeddable object to which the
identification variable corresponds. The type of an
identification_variable that refers to an entity abstract schema type is
the type of the entity to which that identification variable corresponds
or a subtype as determined by the object/relational mapping.</p>
</li>
<li>
<p>The result type of a
<code>single_valued_path_expression</code> that is a <code>state_field_path_expression</code> is
the same type as the corresponding state field of the entity or
embeddable class. If the state field of the entity is a primitive type,
the result type is the corresponding object type.</p>
</li>
<li>
<p>The result type of a
<code>single_valued_path_expression</code> that is a
<code>single_valued_object_path_expression</code> is the type of the entity object or
embeddable object to which the path expression corresponds. A
<code>single_valued_object_path_expression</code> that results in an entity object
will result in an entity of the type of the relationship field or the
subtype of the relationship field of the entity object as determined by
the object/relational mapping.</p>
</li>
<li>
<p>The result type of a
<code>single_valued_path_expression</code> that is an <code>identification_variable</code> to
which the KEY or VALUE function has been applied is determined by the
type of the map key or value respectively, as defined by the above
rules.</p>
</li>
<li>
<p>The result type of a
<code>single_valued_path_expression</code> that is an <code>identification_variable</code> to
which the ENTRY function has been applied is <code>java.util.Map.Entry</code>,
where the key and value types of the map entry are determined by the
above rules as applied to the map key and map value respectively.</p>
</li>
<li>
<p>The result type of a <code>scalar_expression</code> is
the type of the scalar value to which the expression evaluates. The
result type of a numeric <code>scalar_expression</code> is defined in <a href="#a5574">Section 4.7.13</a>.</p>
</li>
<li>
<p>The result type of an
<code>entity_type_expression</code> scalar expression is the Java class to which
the resulting abstract schema type corresponds.</p>
</li>
<li>
<p>The result type of aggregate_expression is
defined in <a href="#a5538">Section 4.9.5</a>.</p>
</li>
<li>
<p>The result type of a constructor_expression
is the type of the class for which the constructor is defined. The types
of the arguments to the constructor are defined by the above rules.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a5500"><a class="anchor" href="#a5500"></a>4.9.2. Constructor Expressions in the SELECT Clause</h4>
<div class="paragraph">
<p>A constructor may be used in the SELECT list
to return an instance of a Java class. The specified class is not
required to be an entity or to be mapped to the database. The
constructor name must be fully qualified.</p>
</div>
<div class="paragraph">
<p>If an entity class name is specified as the
constructor name in the SELECT NEW clause, the resulting entity
instances will be in either the new or the detached state, depending on
whether a primary key is retrieved for the constructed object.</p>
</div>
<div class="paragraph">
<p>If a <code>single_valued_path_expression</code> or
<code>identification_variable</code> that is an argument to the constructor
references an entity, the resulting entity instance referenced by that
<code>single_valued_path_expression</code> or <code>identification_variable</code> will be in
the managed state.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> NEW com.acme.example.CustomerDetails(c.id, c.status, o.count)
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> o.count &gt; <span class="integer">100</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="null-values-in-the-query-result"><a class="anchor" href="#null-values-in-the-query-result"></a>4.9.3. Null Values in the Query Result</h4>
<div class="paragraph">
<p>If the result of a query corresponds to an
association field or state field whose value is null, that null value is
returned in the result of the query method. The IS NOT NULL construct
can be used to eliminate such null values from the result set of the
query.</p>
</div>
<div class="paragraph">
<p>Note, however, that state field types defined
in terms of Java numeric primitive types cannot produce NULL values in
the query result. A query that returns such a state field type as a
result type must not return a null value.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5511"><a class="anchor" href="#a5511"></a>4.9.4. Embeddables in the Query Result</h4>
<div class="paragraph">
<p>If the result of a query corresponds to an
identification variable or state field whose value is an embeddable, the
embeddable instance returned by the query will not be in the managed
state (i.e., it will not be part of the state of any managed entity).</p>
</div>
<div class="paragraph">
<p>In the following example, the <code>Address</code>
instances returned by the query will reference <code>Phone</code> instances. While
the <code>Phone</code> instances will be managed, the <code>Address</code> instances
referenced by the <code>addr</code> result variable will not be. Modifications to
these embeddable instances will have no effect on persistent state.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    Address address;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="predefined-type">String</span> street;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToOne</span>
    Phone phone; <span class="comment">// fetch=EAGER</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Phone</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToOne</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">address.phone</span><span class="delimiter">&quot;</span></span>)
    Employee emp; <span class="comment">// fetch=EAGER</span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e.address <span class="keyword">AS</span> addr
<span class="keyword">FROM</span> Employee e</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a5538"><a class="anchor" href="#a5538"></a>4.9.5. Aggregate Functions in the SELECT Clause</h4>
<div class="paragraph">
<p>The result of a query may be the result of an
aggregate function applied to a path expression.</p>
</div>
<div class="paragraph">
<p>The following aggregate functions can be used
in the SELECT clause of a query: AVG, COUNT, MAX, MIN, SUM, aggregate
functions defined in the database.</p>
</div>
<div class="paragraph">
<p>For all aggregate functions except COUNT, the
path expression that is the argument to the aggregate function must
terminate in a state field. The path expression argument to COUNT may
terminate in either a state field or a association field, or the
argument to COUNT may be an identification variable.</p>
</div>
<div class="paragraph">
<p>Arguments to the functions SUM and AVG must
be numeric. Arguments to the functions MAX and MIN must correspond to
orderable state field types (i.e., numeric types, string types,
character types, or date types).</p>
</div>
<div class="paragraph">
<p>The Java type that is contained in the result
of a query using an aggregate function is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>COUNT returns Long.</p>
</li>
<li>
<p>MAX, MIN return the type of the state field to which they are applied.</p>
</li>
<li>
<p>AVG returns Double.</p>
</li>
<li>
<p>SUM returns Long when applied to state fields
of integral types (other than BigInteger); Double when applied to state
fields of floating point types; BigInteger when applied to state fields
of type BigInteger; and BigDecimal when applied to state fields of type
BigDecimal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Null values are eliminated before the
aggregate function is applied, regardless of whether the keyword
DISTINCT is specified.</p>
</div>
<div class="paragraph">
<p>If SUM, AVG, MAX, or MIN is used, and there
are no values to which the aggregate function can be applied, the result
of the aggregate function is NULL.</p>
</div>
<div class="paragraph">
<p>If COUNT is used, and there are no values to
which COUNT can be applied, the result of the aggregate function is 0.</p>
</div>
<div class="paragraph">
<p>The argument to an aggregate function
may be preceded by the keyword DISTINCT to specify that duplicate values
are to be eliminated before the aggregate function is
applied.<sup class="footnote">[<a id="_footnoteref_80" class="footnote" href="#_footnotedef_80" title="View footnote.">80</a>]</sup></p>
</div>
<div class="paragraph">
<p>The use of DISTINCT with COUNT is not
supported for arguments of embeddable types or map entry types.</p>
</div>
<div class="paragraph">
<p>The invocation of aggregate database
functions, including user defined functions, is supported by means of
the FUNCTION operator. See <a href="#a5311">Section 4.7.9</a>.</p>
</div>
<div class="paragraph">
<p>The following query returns the average order quantity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">AVG</span>(o.quantity) <span class="keyword">FROM</span> <span class="keyword">Order</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following query returns the total cost of
the items that John Smith has ordered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">SUM</span>(l.price)
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following query returns the total number of orders.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">COUNT</span>(o) <span class="keyword">FROM</span> <span class="keyword">Order</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following query counts the number of
items in John Smith&#8217;s order for which prices have been specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">COUNT</span>(l.price)
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this is equivalent to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">COUNT</span>(l)
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> l.price <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a5587"><a class="anchor" href="#a5587"></a>4.10. ORDER BY Clause</h3>
<div class="paragraph">
<p>The ORDER BY clause specifies how the results of a query should be sorted.
The syntax of the ORDER BY clause is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>orderby_clause ::= ORDER BY orderby_item {, orderby_item}*
orderby_item ::= orderby_expression [ASC | DESC] [NULLS {FIRST | LAST}]
orderby_expression ::=
    state_field_path_expression |
    general_identification_variable |
    result_variable |
    scalar_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The ORDER BY clause specifies a list of items. Each <code>orderby_expression</code>
must be one of the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A <code>state_field_path_expression</code> evaluating to an orderable state field
of an entity or embeddable class abstract schema type designated in the
SELECT clause by either:</p>
<div class="ulist">
<ul>
<li>
<p>a <code>general_identification_variable</code>, or</p>
</li>
<li>
<p>a <code>single_valued_object_path_expression</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>A <code>state_field_path_expression</code> evaluating to the same state field of
the same entity or embeddable abstract schema type as a
<code>state_field_path_expression</code> in the SELECT clause.</p>
</li>
<li>
<p>A <code>general_identification_variable</code> evaluating to the same map field of
the same entity or embeddable abstract schema type as a
<code>general_identification_variable</code> in the SELECT clause.</p>
</li>
<li>
<p>A reference to a <code>result_variable</code> declared by an orderable item in the
SELECT clause. The orderable item must be an <code>aggregate_expression</code>, a
<code>scalar_expression</code>, or a <code>state_field_path_expression</code>.</p>
</li>
<li>
<p>Any <code>scalar_expression</code> involving only <code>state_field_path_expression</code>s
which would be allowed according to items 1 or 2 above.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Depending on the database, arbitrary scalar expressions may not be allowed
in the ORDER BY clause. Therefore, applications which require portability
between databases should not depend on the use of a scalar expression in
ORDER BY if it is only permitted by item 5.</p>
</div>
<div class="paragraph">
<p>For example, the four queries below are legal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity <span class="directive">DESC</span>, o.totalcost

<span class="class">SELECT</span> o.quantity, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity, a.zipcode

<span class="class">SELECT</span> o.quantity, o.cost*<span class="float">1.08</span> <span class="keyword">AS</span> taxedCost, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> a.county = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity, taxedCost, a.zipcode

<span class="class">SELECT</span> <span class="predefined">AVG</span>(o.quantity) <span class="keyword">as</span> q, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> a.zipcode
<span class="keyword">ORDER</span> <span class="keyword">BY</span> q <span class="directive">DESC</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following query is legal, but might not be supported on every database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c, o
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> UPPER(c.lastname), UPPER(c.firstname)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following two queries are <em>not</em> legal
because the <code>orderby_item</code> is not reflected in the SELECT clause of the
query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.product_name
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> l.product p <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> p.price

<span class="class">SELECT</span> p.product_name
<span class="keyword">FROM</span> <span class="keyword">Order</span> o, <span class="keyword">IN</span>(o.lineItems) l <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity</code></pre>
</div>
</div>
<div class="paragraph">
<p>The keyword ASC specifies that ascending ordering is used for the associated
<code>orderby_item</code>; the keyword DESC specifies that descending ordering is used.
If neither keyword is explicitly specified, ascending ordering is the default.</p>
</div>
<div class="paragraph">
<p>The interpretation of ascending or descending order is determined by the
database, but, in general:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ascending order for numeric values means smaller values first, while
descending order means larger values first, and</p>
</li>
<li>
<p>strings are sorted lexicographically, using a database-dependent collation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The keyword NULLS specifies the ordering of null values, either FIRST or LAST.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FIRST means that results are sorted so that all null values occur before
all non-null values.</p>
</li>
<li>
<p>LAST means that results are sorted so that all null values occur after
all non-null values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If NULLS is not specified, the database determines whether null values occur
first or last.</p>
</div>
<div class="paragraph">
<p>Items occurring earlier in the ORDER BY clause take precedence. That is,
an item occurring later in the ORDER BY clause is only used to resolve
"ties" between results which cannot be unambiguously ordered using only
earlier items.</p>
</div>
<div class="paragraph">
<p>The order of query results must be preserved in the result list or stream
returned by a query execution method when an ORDER BY clause is specified.</p>
</div>
</div>
<div class="sect2">
<h3 id="a5636"><a class="anchor" href="#a5636"></a>4.11. Bulk Update and Delete Operations</h3>
<div class="paragraph">
<p>Bulk update and delete operations apply to
entities of a single entity class (together with its subclasses, if
any). Only one entity abstract schema type may be specified in the FROM
or UPDATE clause.</p>
</div>
<div class="paragraph">
<p>The syntax of these operations is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>update_statement ::= update_clause [where_clause]
update_clause ::= UPDATE entity_name [[AS] identification_variable]
                  SET update_item {, update_item}*
update_item ::= [identification_variable.]{single_valued_embeddable_object_field.}*
    {state_field | single_valued_object_field} = new_value
new_value ::=
    scalar_expression |
    simple_entity_expression |
    NULL

delete_statement ::= delete_clause [where_clause]
delete_clause ::= DELETE FROM entity_name [[AS] identification_variable]</pre>
</div>
</div>
<div class="paragraph">
<p>The syntax of the WHERE clause is described
in <a href="#a4985">Section 4.5</a>.</p>
</div>
<div class="paragraph">
<p>A delete operation only applies to entities
of the specified class and its subclasses. It does not cascade to
related entities.</p>
</div>
<div class="paragraph">
<p>The new_value specified for an update
operation must be compatible in type with the field to which it is
assigned.</p>
</div>
<div class="paragraph">
<p>Bulk update maps directly to a database
update operation, bypassing optimistic locking checks. Portable
applications must manually update the value of the version column, if
desired, and/or manually validate the value of the version column.</p>
</div>
<div class="paragraph">
<p>The persistence context is not synchronized
with the result of the bulk update or delete.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Caution should be used when executing bulk
update or delete operations because they may result in inconsistencies
between the database and the entities in the active persistence context.
In general, bulk update and delete operations should only be performed
within a transaction in a new persistence context or before fetching or
accessing entities whose state might be affected by such operations._</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DELETE</span>
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">inactive</span><span class="delimiter">'</span></span>

<span class="class">DELETE</span>
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">inactive</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> c.orders <span class="keyword">IS</span> EMPTY

<span class="class">UPDATE</span> Customer c
<span class="class">SET</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">outstanding</span><span class="delimiter">'</span></span>
<span class="keyword">WHERE</span> c.balance &lt; <span class="integer">10000</span>

<span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.address.building = <span class="integer">22</span>
<span class="keyword">WHERE</span> e.address.building = <span class="integer">14</span>
    <span class="keyword">AND</span> e.address.city = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> e.project = <span class="string"><span class="delimiter">'</span><span class="content">Jakarta EE</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bnf"><a class="anchor" href="#bnf"></a>4.12. BNF</h3>
<div class="paragraph">
<p>BNF notation summary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>{ &#8230;&#8203; }</code> grouping</p>
</li>
<li>
<p><code>[ &#8230;&#8203; ]</code> optional constructs</p>
</li>
<li>
<p><code>*</code> zero or more</p>
</li>
<li>
<p><code>+</code> one or more</p>
</li>
<li>
<p><code>|</code> alternates</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is the BNF for the Jakarta Persistence query language.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>QL_statement ::= select_statement | update_statement | delete_statement
select_statement ::= union
union ::= intersection | union {UNION [ALL] | EXCEPT [ALL]} intersection
intersection ::= query_expression | intersection INTERSECT [ALL] query_expression
query_expression ::= select_query | (union)
select_query ::= [select_clause] from_clause [where_clause] [groupby_clause]
    [having_clause] [orderby_clause]
update_statement ::= update_clause [where_clause]
delete_statement ::= delete_clause [where_clause]
from_clause ::=
    FROM {this_implicit_variable | identification_variable_declarations}
this_implicit_variable ::= entity_name
identification_variable_declarations ::=
    identification_variable_declaration
    {, {identification_variable_declaration | collection_member_declaration}}*
identification_variable_declaration ::= range_variable_declaration {join | fetch_join}*
range_variable_declaration ::= entity_name [AS] identification_variable
join ::= range_join | path_join
range_join ::= join_spec range_variable_declaration [join_condition]
path_join ::=
    join_spec join_association_path_expression [AS] identification_variable [join_condition]
fetch_join ::= join_spec FETCH join_association_path_expression
join_spec ::= [INNER | LEFT [OUTER]] JOIN
join_condition ::= ON conditional_expression
join_association_path_expression ::=
    join_collection_valued_path_expression |
    join_single_valued_path_expression |
    TREAT(join_collection_valued_path_expression AS subtype) |
    TREAT(join_single_valued_path_expression AS subtype)
join_collection_valued_path_expression ::=
    [identification_variable.]{single_valued_embeddable_object_field.}* collection_valued_field
join_single_valued_path_expression ::=
    [identification_variable.]{single_valued_embeddable_object_field.}* single_valued_object_field
collection_member_declaration ::=
    IN (collection_valued_path_expression) [AS] identification_variable
qualified_identification_variable ::=
    map_field_identification_variable |
    ENTRY(identification_variable)
map_field_identification_variable ::=
    KEY(identification_variable) |
    VALUE(identification_variable)
single_valued_path_expression ::=
    qualified_identification_variable |
    TREAT(qualified_identification_variable AS subtype) |
    state_field_path_expression |
    single_valued_object_path_expression
general_identification_variable ::=
    identification_variable |
    map_field_identification_variable
general_subpath ::= simple_subpath | treated_subpath{.single_valued_object_field}*
simple_subpath ::=
    general_identification_variable |
    general_identification_variable{.single_valued_object_field}*
treated_subpath ::= TREAT(general_subpath AS subtype)
state_field_path_expression ::= [general_subpath.]state_field
state_valued_path_expression ::=
    state_field_path_expression | general_identification_variable
single_valued_object_path_expression ::=
    general_subpath.single_valued_object_field
collection_valued_path_expression ::= general_subpath.{collection_valued_field}
update_clause ::= UPDATE entity_name [[AS] identification_variable]
    SET update_item {, update_item}*
update_item ::= [identification_variable.]{single_valued_embeddable_object_field.}*
    {state_field | single_valued_object_field} = new_value
new_value ::=
    scalar_expression |
    simple_entity_expression |
    NULL
delete_clause ::= DELETE FROM entity_name [[AS] identification_variable]
select_clause ::= SELECT [DISTINCT] select_item {, select_item}*
select_item ::= select_expression [[AS] result_variable]
select_expression ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable |
    OBJECT(identification_variable) |
    constructor_expression
constructor_expression ::=
    NEW constructor_name (constructor_item {, constructor_item}*)
constructor_item ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable
aggregate_expression ::=
    {AVG | MAX | MIN | SUM} ([DISTINCT] state_valued_path_expression) |
    COUNT ([DISTINCT] identification_variable | state_valued_path_expression |
        single_valued_object_path_expression) |
    function_invocation
where_clause ::= WHERE conditional_expression
groupby_clause ::= GROUP BY groupby_item {, groupby_item}*
groupby_item ::= single_valued_path_expression | identification_variable
having_clause ::= HAVING conditional_expression
orderby_clause ::= ORDER BY orderby_item {, orderby_item}*
orderby_item ::= orderby_expression [ASC | DESC] [NULLS {FIRST | LAST}]
orderby_expression ::=
    state_field_path_expression |
    general_identification_variable |
    result_variable |
    scalar_expression
subquery ::= simple_select_clause subquery_from_clause [where_clause]
    [groupby_clause] [having_clause]
subquery_from_clause ::=
    FROM subselect_identification_variable_declaration
        {, subselect_identification_variable_declaration | collection_member_declaration}*
subselect_identification_variable_declaration ::=
    identification_variable_declaration |
    derived_path_expression [AS] identification_variable {join}* |
    derived_collection_member_declaration
derived_path_expression ::=
    general_derived_path.single_valued_object_field |
    general_derived_path.collection_valued_field
general_derived_path ::=
    simple_derived_path |
    treated_derived_path{.single_valued_object_field}*
simple_derived_path ::= superquery_identification_variable{.single_valued_object_field}*
treated_derived_path ::= TREAT(general_derived_path AS subtype)
derived_collection_member_declaration ::=
    IN superquery_identification_variable.{single_valued_object_field.}*collection_valued_field
simple_select_clause ::= SELECT [DISTINCT] simple_select_expression
simple_select_expression::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable
scalar_expression ::=
    arithmetic_expression |
    string_expression |
    enum_expression |
    datetime_expression |
    boolean_expression |
    case_expression |
    entity_type_expression |
    entity_id_or_version_function
conditional_expression ::= conditional_term | conditional_expression OR conditional_term
conditional_term ::= conditional_factor | conditional_term AND conditional_factor
conditional_factor ::= [NOT] conditional_primary
conditional_primary ::= simple_cond_expression | (conditional_expression)
simple_cond_expression ::=
    comparison_expression |
    between_expression |
    in_expression |
    like_expression |
    null_comparison_expression |
    empty_collection_comparison_expression |
    collection_member_expression |
    exists_expression
between_expression ::=
    arithmetic_expression [NOT] BETWEEN
        arithmetic_expression AND arithmetic_expression |
    string_expression [NOT] BETWEEN string_expression AND string_expression |
    datetime_expression [NOT] BETWEEN datetime_expression AND datetime_expression
in_expression ::=
    {state_valued_path_expression | type_discriminator} [NOT] IN
        {(in_item{, in_item}*) | (subquery) | collection_valued_input_parameter}
in_item ::= literal | single_valued_input_parameter
like_expression ::=
    string_expression [NOT] LIKE pattern_value [ESCAPE escape_character]
null_comparison_expression ::=
    {single_valued_path_expression | input_parameter} IS [NOT] NULL
empty_collection_comparison_expression ::=
    collection_valued_path_expression IS [NOT] EMPTY
collection_member_expression ::= entity_or_value_expression
    [NOT] MEMBER [OF] collection_valued_path_expression
entity_or_value_expression ::=
    single_valued_object_path_expression |
    state_field_path_expression |
    simple_entity_or_value_expression
simple_entity_or_value_expression ::=
    identification_variable |
    input_parameter |
    literal
exists_expression ::= [NOT] EXISTS (subquery)
all_or_any_expression ::= {ALL | ANY | SOME} (subquery)
comparison_expression ::=
    string_expression comparison_operator {string_expression | all_or_any_expression} |
    boolean_expression {= | &lt;&gt;} {boolean_expression | all_or_any_expression} |
    enum_expression {= | &lt;&gt;} {enum_expression | all_or_any_expression} |
    datetime_expression comparison_operator
        {datetime_expression | all_or_any_expression} |
    entity_expression {= | &lt;&gt;} {entity_expression | all_or_any_expression} |
    arithmetic_expression comparison_operator {arithmetic_expression | all_or_any_expression} |
    entity_id_or_version_function {= | &lt;&gt;} input_parameter |
    entity_type_expression {= | &lt;&gt;} entity_type_expression}
comparison_operator ::= = | &gt; | &gt;= | &lt; | &lt;= | &lt;&gt;
arithmetic_expression ::=
    arithmetic_term | arithmetic_expression {+ | -} arithmetic_term
arithmetic_term ::= arithmetic_factor | arithmetic_term {* | /} arithmetic_factor
arithmetic_factor ::= [{+ | -}] arithmetic_primary
arithmetic_primary ::=
    state_valued_path_expression |
    numeric_literal |
    (arithmetic_expression) |
    input_parameter |
    functions_returning_numerics |
    aggregate_expression |
    case_expression |
    function_invocation |
    arithmetic_cast_function |
    (subquery)
string_expression ::=
    state_valued_path_expression |
    string_literal |
    input_parameter |
    functions_returning_strings |
    aggregate_expression |
    case_expression |
    function_invocation |
    string_cast_function |
    string_expression || string_expression |
    (subquery)
datetime_expression ::=
    state_valued_path_expression |
    input_parameter |
    functions_returning_datetime |
    aggregate_expression |
    case_expression |
    function_invocation |
    date_time_timestamp_literal |
    (subquery)
boolean_expression ::=
    state_valued_path_expression |
    boolean_literal |
    input_parameter |
    case_expression |
    function_invocation |
    (subquery)
enum_expression ::=
    state_valued_path_expression |
    enum_literal |
    input_parameter |
    case_expression |
    (subquery)
entity_expression ::= single_valued_object_path_expression | simple_entity_expression
simple_entity_expression ::= identification_variable | input_parameter
entity_type_expression ::=
    type_discriminator |
    entity_type_literal |
    input_parameter
type_discriminator ::=
    TYPE(general_identification_variable |
        single_valued_object_path_expression |
        input_parameter)
arithmetic_cast_function::=
    CAST(string_expression AS {INTEGER | LONG | FLOAT | DOUBLE})
functions_returning_numerics ::=
    LENGTH(string_expression) |
    LOCATE(string_expression, string_expression[, arithmetic_expression]) |
    ABS(arithmetic_expression) |
    CEILING(arithmetic_expression) |
    EXP(arithmetic_expression) |
    FLOOR(arithmetic_expression) |
    LN(arithmetic_expression) |
    SIGN(arithmetic_expression) |
    SQRT(arithmetic_expression) |
    MOD(arithmetic_expression, arithmetic_expression) |
    POWER(arithmetic_expression, arithmetic_expression) |
    ROUND(arithmetic_expression, arithmetic_expression) |
    SIZE(collection_valued_path_expression) |
    INDEX(identification_variable) |
    extract_datetime_field
functions_returning_datetime ::=
    CURRENT_DATE |
    CURRENT_TIME |
    CURRENT_TIMESTAMP |
    LOCAL DATE |
    LOCAL TIME |
    LOCAL DATETIME |
    extract_datetime_part
string_cast_function::=
    CAST(scalar_expression AS STRING)
functions_returning_strings ::=
    CONCAT(string_expression, string_expression{, string_expression}*) |
    SUBSTRING(string_expression, arithmetic_expression[, arithmetic_expression]) |
    TRIM([[trim_specification] [trim_character] FROM] string_expression) |
    LOWER(string_expression) |
    UPPER(string_expression)
trim_specification ::= LEADING | TRAILING | BOTH
function_invocation ::= FUNCTION(function_name{, function_arg}*)
extract_datetime_field :=
    EXTRACT(datetime_field FROM datetime_expression)
datetime_field := identification_variable
extract_datetime_part :=
    EXTRACT(datetime_part FROM datetime_expression)
datetime_part := identification_variable
function_arg ::=
    literal |
    state_valued_path_expression |
    input_parameter |
    scalar_expression
entity_id_or_version_function ::= id_function | version_function
id_function ::=
    ID(general_identification_variable |
       single_valued_object_path_expression)
version_function ::=
    VERSION(general_identification_variable |
            single_valued_object_path_expression)
case_expression ::=
    general_case_expression |
    simple_case_expression |
    coalesce_expression |
    nullif_expression
general_case_expression::= CASE when_clause {when_clause}* ELSE scalar_expression END
when_clause ::= WHEN conditional_expression THEN scalar_expression
simple_case_expression ::=
    CASE case_operand simple_when_clause {simple_when_clause}*
    ELSE scalar_expression
    END
case_operand ::= state_valued_path_expression | type_discriminator
simple_when_clause ::= WHEN scalar_expression THEN scalar_expression
coalesce_expression ::= COALESCE(scalar_expression{, scalar_expression}+)
nullif_expression::= NULLIF(scalar_expression, scalar_expression)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a6072"><a class="anchor" href="#a6072"></a>5. Metamodel API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This specification provides a set of interfaces for dynamically accessing
a metamodel representing the managed classes of a persistence unit.
Instances of metamodel types may be obtained either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>via programmatic lookup using an instance of the interface <code>Metamodel</code>
(found in <a href="#_metamodel_">Section D.1</a>) obtained from the <code>EntityManagerFactory</code> or
<code>EntityManager</code> by calling <code>getMetamodel()</code>, or</p>
</li>
<li>
<p>in a typesafe way, using <em>static metamodel classes</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A static metamodel class is a class with static members providing direct
typesafe access to metamodel objects representing the persistent members
of a given managed class.</p>
</div>
<div class="sect2">
<h3 id="a6933"><a class="anchor" href="#a6933"></a>5.1. Static Metamodel Classes</h3>
<div class="paragraph">
<p>A set of static metamodel classes corresponding to the managed classes of
a persistence unit can be generated using an annotation processor or may
be created by the application developer.</p>
</div>
<div class="paragraph">
<p>In the typical case, an annotation processor is used to generate static
metamodel classes corresponding to the entities, mapped superclasses,
and embeddable classes in the persistence unit. A static metamodel class
models the persistent state and relationships of the corresponding managed
class. For portability, an annotation processor should generate a <em>canonical
metamodel</em> as specified in the next section.</p>
</div>
<div class="sect3">
<h4 id="canonical-metamodel"><a class="anchor" href="#canonical-metamodel"></a>5.1.1. Canonical Metamodel</h4>
<div class="paragraph">
<p>This specification defines as follows a
canonical metamodel and the structure of canonical metamodel classes.</p>
</div>
<div class="paragraph">
<p>For every managed class in the persistence
unit, a corresponding metamodel class is produced as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For each managed class <code>X</code> in package <code>p</code>, a metamodel class
<code>X_</code> in package <code>p</code> is created.<sup class="footnote">[<a id="_footnoteref_81" class="footnote" href="#_footnotedef_81" title="View footnote.">81</a>]</sup></p>
</li>
<li>
<p>The name of the metamodel class is derived from the name of the
managed class by appending &#8220;_&#8221; to the name of the managed class.</p>
</li>
<li>
<p>The metamodel class <code>X_</code> must be annotated with the <code>StaticMetamodel</code>
annotation found in <a href="#_staticmetamodel_">Section D.2</a>.<sup class="footnote">[<a id="_footnoteref_82" class="footnote" href="#_footnotedef_82" title="View footnote.">82</a>]</sup></p>
</li>
<li>
<p>If the managed class <code>X</code> extends another class <code>S</code>, where <code>S</code> is the
most derived managed class (i.e., entity or mapped superclass) extended
by <code>X</code>, then the metamodel class <code>X_</code> must extend the metamodel
class <code>S_</code> created for <code>S</code>.</p>
</li>
<li>
<p>The metamodel class must contain a field declaration as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> jakarta.persistence.metamodel.T&lt;X&gt; class_;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>T</code> is <code>EntityType</code>, <code>EmbeddableType</code>, or <code>MappedSuperclassType</code>
depending on whether <code>X</code> is an entity, embeddable, or mapped superclass.</p>
</div>
</li>
<li>
<p>For every persistent attribute <code>y</code> declared by class <code>X</code>, the
metamodel class must contain a field declaration as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> Y = <span class="string"><span class="delimiter">&quot;</span><span class="content">y</span><span class="delimiter">&quot;</span></span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where the field name <code>Y</code> is obtained by transforming each lowercase
character in the attribute name <code>y</code> to uppercase, inserting an
underscore if the character following the transformed character
is uppercase, and then replacing each character which is not
a legal Java identifier character with an underscore.</p>
</div>
</li>
<li>
<p>For every persistent non-collection-valued
attribute <code>y</code> declared by class <code>X</code>, where the type of <code>y</code> is <code>Y</code>, the
metamodel class must contain a declaration as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;X, Y&gt; y;</code></pre>
</div>
</div>
</li>
<li>
<p>For every persistent collection-valued
attribute <code>z</code> declared by class <code>X</code>, where the element type of <code>z</code> is
<code>Z</code>, the metamodel class must contain a declaration as follows:</p>
<div class="ulist">
<ul>
<li>
<p>if the collection type of <code>z</code> is <code>java.util.Collection</code>, then</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> CollectionAttribute&lt;X, Z&gt; z;</code></pre>
</div>
</div>
</li>
<li>
<p>if the collection type of <code>z</code> is <code>java.util.Set</code>, then</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SetAttribute&lt;X, Z&gt; z;</code></pre>
</div>
</div>
</li>
<li>
<p>if the collection type of <code>z</code> is <code>java.util.List</code>, then</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> ListAttribute&lt;X, Z&gt; z;</code></pre>
</div>
</div>
</li>
<li>
<p>if the collection type of <code>z</code> is <code>java.util.Map</code>, then</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> MapAttribute&lt;X, K, Z&gt; z;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>K</code> is the type of the key of the map in class <code>X</code></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>For every named query, named entity graph, or SQL result set
mapping with name <code>"n"</code> declared by annotations of the class <code>X</code>,
the metamodel class must contain a declaration as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> T_N = <span class="string"><span class="delimiter">&quot;</span><span class="content">n</span><span class="delimiter">&quot;</span></span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where the prefix <code>T</code> is the string <code>QUERY</code>, <code>GRAPH</code>, or <code>MAPPING</code>,
as appropriate, depending on the annotation type, and the suffix
<code>N</code> is obtained by transforming each lowercase character in the
name <code>n</code> to uppercase, inserting an underscore if the character
following the transformed character is uppercase, and then
replacing each character which is not a legal Java identifier
character with an underscore.</p>
</div>
</li>
<li>
<p>For every named query with name <code>"n"</code> and query result class
<code>R</code> declared by annotations of the class <code>X</code>, the metamodel class
must contain a declaration as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> TypedQueryReference&lt;R&gt; _n_;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>n</code> is the name <code>"n"</code> with every character which is not a legal Java identifier character
replaced with an underscore.</p>
</div>
</li>
<li>
<p>For every named entity graph with name <code>"n"</code> declared by
annotations of the class <code>X</code>, the metamodel class must contain
a declaration as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> EntityGraph&lt;X&gt; _n;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>n</code> is the name <code>"n"</code> with every character which is not a legal Java identifier character
replaced with an underscore.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Import statements must be included for the
needed <code>jakarta.persistence</code> and <code>jakarta.persistence.metamodel</code> types as appropriate
and all classes <code>X</code>, <code>Y</code>, <code>Z</code>, <code>R</code>, and <code>K</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Implementations of this specification are not required to resolve naming collisions
resulting from the rules above when generating canonical metamodel classes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Implementations of this specification are
not required to support the use of non-canonical metamodel classes.
Applications that use non-canonical metamodel classes will not be
portable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="a6961"><a class="anchor" href="#a6961"></a>5.1.1.1. Example Canonical Metamodel</h5>
<div class="paragraph">
<p>Assume the <code>Order</code> entity below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example</span>;

<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">java.math.BigDecimal</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.Entity</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.Id</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.ManyToOne</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.OneToMany</span>;

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">Integer</span> orderId;

    <span class="annotation">@ManyToOne</span>
    Customer customer;

    <span class="annotation">@OneToMany</span>
    <span class="predefined-type">Set</span>&lt;Item&gt; lineItems;

    Address shippingAddress;

    <span class="predefined-type">BigDecimal</span> totalCost;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The corresponding canonical metamodel class, <code>Order_</code>, is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example</span>;

<span class="keyword">import</span> <span class="include">java.math.BigDecimal</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SetAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.StaticMetamodel</span>;

<span class="annotation">@StaticMetamodel</span>(Order.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order_</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> EntityType&lt;Order&gt; class_;

    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;Order, <span class="predefined-type">Integer</span>&gt; orderId;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;Order, Customer&gt; customer;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SetAttribute&lt;Order, Item&gt; lineItems;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;Order, Address&gt; shippingAddress;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;Order, <span class="predefined-type">BigDecimal</span>&gt; totalCost;

    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> LINE_ITEMS = <span class="string"><span class="delimiter">&quot;</span><span class="content">lineItems</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> ORDER_ID = <span class="string"><span class="delimiter">&quot;</span><span class="content">orderId</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SHIPPING_ADDRESS = <span class="string"><span class="delimiter">&quot;</span><span class="content">shippingAddress</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> TOTAL_COST = <span class="string"><span class="delimiter">&quot;</span><span class="content">totalCost</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> CUSTOMER = <span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bootstrapping-the-static-metamodel"><a class="anchor" href="#bootstrapping-the-static-metamodel"></a>5.1.2. Bootstrapping the Static Metamodel</h4>
<div class="paragraph">
<p>When the entity manager factory for a persistence unit is created, it is
the responsibility of the persistence provider to initialize the state of
the static metamodel classes representing managed classes belonging to the
persistence unit. Any generated metamodel classes must be accessible on the
classpath.</p>
</div>
<div class="paragraph">
<p>Persistence providers must support the use of canonical metamodel classes.
Persistence providers may, but are not required to, support the use of
non-canonical metamodel classes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="runtime-access-to-metamodel"><a class="anchor" href="#runtime-access-to-metamodel"></a>5.2. Runtime Access to Metamodel</h3>
<div class="paragraph">
<p>The interfaces defined in <code>jakarta.persistence.metamodel</code> provide for
dynamic access to a metamodel of the persistent state and relationships
of the managed classes of a persistence unit.</p>
</div>
<div class="paragraph">
<p>An instance of <code>Metamodel</code> may be obtained by calling the <code>getMetamodel()</code>
method of <code>EntityManagerFactory</code> or <code>EntityManager</code>.</p>
</div>
<div class="paragraph">
<p>The complete metamodel API may be found in <a href="#metamodel-api">Appendix D</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a6925"><a class="anchor" href="#a6925"></a>6. Criteria API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Jakarta Persistence Criteria API is used to
define queries through the construction of object-based query definition
objects, rather than use of the string-based approach of the Jakarta
Persistence query language described in <a href="#a4665">Chapter 4</a>.</p>
</div>
<div class="paragraph">
<p>This chapter provides the full definition of the Criteria API.</p>
</div>
<div class="sect2">
<h3 id="overview-3"><a class="anchor" href="#overview-3"></a>6.1. Overview</h3>
<div class="paragraph">
<p>The Jakarta Persistence Criteria API, like the
Jakarta Persistence query language is based on the abstract persistence
schema of entities, their embedded objects, and their relationships as
its data model. This abstract persistence schema is materialized in the
form of metamodel objects over which the Criteria API operates. The
semantics of criteria queries are designed to reflect those of Jakarta
Persistence query language queries.</p>
</div>
<div class="paragraph">
<p>The complete criteria query API may be found in <a href="#criteria-api">Appendix C</a>.</p>
</div>
<div class="paragraph">
<p>The syntax of the Criteria API is designed to
allow the construction of an object-based query graph, whose nodes
correspond to the semantic query elements.</p>
</div>
<div class="paragraph">
<p>Java language variables can be used to
reference individual nodes in a criteria query object as it is
constructed and/or modified. Such variables, when used to refer to the
entities and embeddable types that constitute the query domain, play a
role analogous to that of the identification variables of the Jakarta
Persistence query language.</p>
</div>
<div class="paragraph">
<p>These concepts are further described in the sections that follow.
Sections <a href="#a10608">Section 6.2</a> through <a href="#a11413">Section 6.6</a> describe the construction and
modification of criteria query objects. Additional requirements on the
persistence provider are described in <a href="#a11427">Section 6.7</a>.</p>
</div>
<div class="paragraph">
<p>The metamodel on which criteria queries are based was already presented
in <a href="#a6072">Chapter 5</a>. The static metamodel classes which are used to construct
strongly-typed criteria queries are described in <a href="#a6933">Section 5.1</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a10608"><a class="anchor" href="#a10608"></a>6.2. Criteria Query API Usage</h3>
<div class="paragraph">
<p>The <code>jakarta.persistence.criteria</code> API
interfaces are designed both to allow criteria queries to be constructed
in a strongly-typed manner, using metamodel objects to provide type
safety, and to allow for string-based use as an alternative:</p>
</div>
<div class="paragraph">
<p>Metamodel objects are used to specify
navigation through joins and through path
expressions<sup class="footnote">[<a id="_footnoteref_83" class="footnote" href="#_footnotedef_83" title="View footnote.">83</a>]</sup>. Typesafe navigation is achieved by
specification of the source and target types of the navigation.</p>
</div>
<div class="paragraph">
<p>Strings may be used as an alternative to
metamodel objects, whereby joins and navigation are specified by use of
strings that correspond to attribute names.</p>
</div>
<div class="paragraph">
<p>Using either the approach based on metamodel
objects or the string-based approach, queries can be constructed both
statically and dynamically. Both approaches are equivalent in terms of
the range of queries that can be expressed and operational semantics.</p>
</div>
<div class="paragraph">
<p><a href="#a10614">Section 6.3</a> provides a description of the use of the
criteria API interfaces. This section is illustrated on the basis of the
construction of strongly-typed queries using static metamodel classes.
<a href="#a11305">Section 6.4</a> describes how
the <code>jakarta.persistence.metamodel</code> API can be used to construct
strongly-typed queries in the absence of such classes. String-based use
of the criteria API is described in <a href="#a11349">Section 6.5</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a10614"><a class="anchor" href="#a10614"></a>6.3. Constructing Criteria Queries</h3>
<div class="paragraph">
<p>A criteria query is constructed through the creation and modification of
an instance of the <code>CriteriaQuery</code> interface found in <a href="#_criteriaquery_">Section C.3</a>.</p>
</div>
<div class="paragraph">
<p>The <code>CriteriaBuilder</code> interface found in <a href="#_criteriabuilder_">Section C.1</a> is used to
construct <code>CriteriaQuery</code>, <code>CriteriaUpdate</code>, and <code>CriteriaDelete</code> objects.
The <code>CriteriaBuilder</code> implementation is accessed through the
<code>getCriteriaBuilder</code> method of the <code>EntityManager</code> or <code>EntityManagerFactory</code>
interface.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PersistenceUnit</span>
EntityManagerFactory emf;

CriteriaBuilder cb = emf.getCriteriaBuilder();</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="a10621"><a class="anchor" href="#a10621"></a>6.3.1. CriteriaQuery Creation</h4>
<div class="paragraph">
<p>A <code>CriteriaQuery</code> object is created by means
of one of the <code>createQuery</code> methods or the <code>createTupleQuery</code> method of
the <code>CriteriaBuilder</code> interface. A <code>CriteriaQuery</code> object is typed
according to its expected result type when the <code>CriteriaQuery</code> object is
created. A <code>TypedQuery</code> instance created from the <code>CriteriaQuery</code> object
by means of the <code>EntityManager</code> <code>createQuery</code> method will result in
instances of this type when the resulting query is executed.</p>
</div>
<div class="paragraph">
<p>The following methods are provided for the
creation of <code>CriteriaQuery</code> objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;T&gt; CriteriaQuery&lt;T&gt; createQuery(<span class="predefined-type">Class</span>&lt;T&gt; resultClass);

CriteriaQuery&lt;Tuple&gt; createTupleQuery();

CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; createQuery();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Methods for the creation of update and delete
queries are described in <a href="#a11239">Section 6.3.15</a>.</p>
</div>
<div class="paragraph">
<p>The methods <code>&lt;T&gt; CriteriaQuery&lt;T&gt; createQuery(Class&lt;T&gt; resultClass)</code> and
<code>createTupleQuery</code> provide for typing of criteria query results and for
typesafe query execution using the <code>TypedQuery</code> API.</p>
</div>
<div class="paragraph">
<p>The effect of the <code>createTupleQuery</code> method
is semantically equivalent to invoking the <code>createQuery</code> method with the
<code>Tuple.class</code> argument. The <code>Tuple</code> interface supports the extraction of
multiple selection items in a strongly typed manner. See <a href="#_tuple_">Section B.9</a> and
<a href="#_tupleelement_">Section B.10</a>.</p>
</div>
<div class="paragraph">
<p>The <code>CriteriaQuery&lt;Object&gt; createQuery()</code>
method supports both the case where the <code>select</code> or <code>multiselect</code> method
specifies only a single selection item and where the <code>multiselect</code>
method specifies multiple selection items. If only a single item is
specified, an instance of type <code>Object</code> will be returned for each result
of the query execution. If multiple selection items are specified, an
instance of type <code>Object[]</code> will be instantiated and returned for each
result of the execution.</p>
</div>
<div class="paragraph">
<p>See <a href="#a10945">Section 6.3.11</a> for further discussion of the specification
of selection items.</p>
</div>
</div>
<div class="sect3">
<h4 id="query-roots"><a class="anchor" href="#query-roots"></a>6.3.2. Query Roots</h4>
<div class="paragraph">
<p>A <code>CriteriaQuery</code> object defines a query over
one or more entity, embeddable, or basic abstract schema types. The root
objects of the query are entities, from which the other types are
reached by navigation. A query root plays a role analogous to that of a
range variable in the Jakarta Persistence query language and forms the
basis for defining the domain of the query.</p>
</div>
<div class="paragraph">
<p>A query root is created and added to the
query by use of the <code>from</code> method of the <code>AbstractQuery</code> interface (from
which both the <code>CriteriaQuery</code> and <code>Subquery</code> interfaces inherit). The
argument to the <code>from</code> method is the entity class or <code>EntityType</code>
instance for the entity. The result of the <code>from</code> method is a <code>Root</code>
object. The <code>Root</code> interface extends the <code>From</code> interface, which
represents objects that may occur in the from clause of a query.</p>
</div>
<div class="paragraph">
<p>A <code>CriteriaQuery</code> object may have more than
one root. The addition of a query root has the semantic effect of
creating a cartesian product between the entity type referenced by the
added root and those of the other roots.</p>
</div>
<div class="paragraph">
<p>The following query illustrates the
definition of a query root. When executed, this query causes all
instances of the <code>Customer</code> entity to be returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaBuilder cb = ...
CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
q.select(customer);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a10643"><a class="anchor" href="#a10643"></a>6.3.3. Joins</h4>
<div class="paragraph">
<p>The <code>join</code> methods of the <code>From</code> interface
extend the query domain by creating a join with a related class that can
be navigated to or that is an element of the given class of the query
domain.</p>
</div>
<div class="paragraph">
<p>The target of the join is specified by
the corresponding <code>SingularAttribute</code> or collection-valued attribute (
<code>CollectionAttribute</code>, <code>SetAttribute</code>, <code>ListAttribute</code>, or
<code>MapAttribute</code>) of the corresponding metamodel
class.<sup class="footnote">[<a id="_footnoteref_84" class="footnote" href="#_footnotedef_84" title="View footnote.">84</a>]</sup> <sup class="footnote">[<a id="_footnoteref_85" class="footnote" href="#_footnotedef_85" title="View footnote.">85</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <code>join</code> methods may be applied to
instances of the <code>Root</code> and <code>Join</code> types.</p>
</div>
<div class="paragraph">
<p>The result of a <code>join</code> method is a <code>Join</code>
object (instance of the <code>Join</code>, <code>CollectionJoin</code>, <code>SetJoin</code>,
<code>ListJoin</code>, or <code>MapJoin</code> types) that captures the source and target
types of the join.</p>
</div>
<div class="paragraph">
<p>For example, given the <code>Order</code> entity and
corresponding <code>Order_</code> metamodel class shown in <a href="#a6961">Section 5.1.1.1</a>, a join to the lineItems of the
order would be expressed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Order&gt; order = q.from(Order.class);
Join&lt;Order, Item&gt; item = order.join(Order_.lineItems);
q.select(order);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The argument to the <code>join</code> method,
<code>Order.lineItems</code>, is of type
<code>jakarta.persistence.metamodel.SetAttribute&lt;Order, Item&gt;</code>.</p>
</div>
<div class="paragraph">
<p>The <code>join</code> methods have the same semantics as
the corresponding Jakarta Persistence query language operations, as
described in <a href="#a4957">Section 4.4.7</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaBuilder cb = ...
CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Join&lt;Customer, Order&gt; order = customer.join(Customer_.orders);
Join&lt;Order, Item&gt; item = order.join(Order_.lineItems);
q.select(customer.get(Customer_.name))
    .where(cb.equal(item.get(Item_.product).get(Product_.productType), <span class="string"><span class="delimiter">&quot;</span><span class="content">printer</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.name
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> o.lineItems i
<span class="keyword">WHERE</span> i.product.productType = <span class="string"><span class="delimiter">'</span><span class="content">printer</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Joins can be chained, thus allowing this
query to be written more concisely:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Join&lt;Order, Item&gt; item = customer.join(Customer_.orders).join(Order_.lineItems);
q.select(customer.get(Customer_.name))
    .where(cb.equal(item.get(Item_.product).get(Product_.productType), <span class="string"><span class="delimiter">&quot;</span><span class="content">printer</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the <code>join</code> method defines an inner join. Outer joins are defined
by explicitly specifying a <code>JoinType</code> argument.</p>
</div>
<div class="paragraph">
<p>The following query uses a left outer join:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Join&lt;Customer,Order&gt; order = customer.join(Customer_.orders, JoinType.LEFT);
q.where(cb.equal(customer.get(Customer_.status), <span class="integer">1</span>))
    .select(customer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> c.orders o <span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>On-conditions can be specified for joins. The
following query uses an on-condition with a left outer join:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Supplier&gt; s = q.from(Supplier.class);
Join&lt;Supplier, Product&gt; p = s.join(Supplier_.products, JoinType.LEFT);
p.on(cb.equal(p.get(Product_.status), <span class="string"><span class="delimiter">&quot;</span><span class="content">inStock</span><span class="delimiter">&quot;</span></span>));
q.groupBy(s.get(Supplier_.name));
q.multiselect(s.get(Supplier_.name), cb.count(p));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> s.products p <span class="keyword">ON</span> p.status = <span class="string"><span class="delimiter">'</span><span class="content">inStock</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="fetch-joins"><a class="anchor" href="#fetch-joins"></a>6.3.4. Fetch Joins</h4>
<div class="paragraph">
<p>Fetch joins are specified by means of the
<code>fetch</code> method. The <code>fetch</code> method specifies that the referenced
association or attribute is to be fetched as a side effect of the
execution of the query. The <code>fetch</code> method can be applied to a <code>Root</code> or
<code>Join</code> instance.</p>
</div>
<div class="paragraph">
<p>An association or attribute referenced by the
<code>fetch</code> method must be referenced from an entity or embeddable that is
returned as the result of the query. A fetch join has the same join
semantics as the corresponding inner or outer join, except that the
related objects are not top-level objects in the query result and cannot
be referenced elsewhere by the query. See <a href="#a4931">Section 4.4.5.3</a>.</p>
</div>
<div class="paragraph">
<p>The <code>fetch</code> method must not be used in a subquery.</p>
</div>
<div class="paragraph">
<p>Multiple levels of fetch joins are not
required to be supported by an implementation of this specification.
Applications that use multi-level fetch joins will not be portable.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Department&gt; q = cb.createQuery(Department.class);
Root&lt;Department&gt; d = q.from(Department.class);
d.fetch(Department.employees, JoinType.LEFT);
q.where(cb.equal(d.get(Department_.deptno), <span class="integer">1</span>)).select(d);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Department d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> FETCH d.employees
<span class="keyword">WHERE</span> d.deptno = <span class="integer">1</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16277"><a class="anchor" href="#a16277"></a>6.3.5. Path Navigation</h4>
<div class="paragraph">
<p>A <code>Path</code> instance can be a <code>Root</code> instance, a
<code>Join</code> instance, a <code>Path</code> instance that has been derived from another
<code>Path</code> instance by means of the <code>get</code> navigation method, or a <code>Path</code>
instance derived from a map-valued association or element collection by
use of the <code>key</code> or <code>value</code> method.</p>
</div>
<div class="paragraph">
<p>When a criteria query is executed, path
navigationlike path navigation using the Jakarta Persistence query
languageis obtained using inner join semantics. That is, if the value
of a non-terminal <code>Path</code> instance is null, the path is considered to
have no value, and does not participate in the determination of the
query result. See <a href="#a4792">Section 4.4.4</a>.</p>
</div>
<div class="paragraph">
<p>The <code>get</code> method is used for path navigation.
The argument to the <code>get</code> method is specified by the corresponding
<code>SingularAttribute</code> or collection-valued attribute
(<code>CollectionAttribute</code>, <code>SetAttribute</code>, <code>ListAttribute</code>, or
<code>MapAttribute</code>) of the corresponding metamodel
class<sup class="footnote">[<a id="_footnoteref_86" class="footnote" href="#_footnotedef_86" title="View footnote.">86</a>]</sup>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>In the following example, <code>ContactInfo</code> is an
embeddable class consisting of an address and set of phones. <code>Phone</code> is
an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Vendor&gt; q = cb.createQuery(Vendor.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
Join&lt;ContactInfo, Phone&gt; phone =
    emp.join(Employee_.contactInfo).join(ContactInfo_.phones);
q.where(cb.equal(emp.get(Employee_.contactInfo)
        .get(ContactInfo_.address)
        .get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">95054</span><span class="delimiter">&quot;</span></span>))
    .select(phone.get(Phone_.vendor));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo.phones p
<span class="keyword">WHERE</span> e.contactInfo.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>In this example, the <code>photos</code> attribute
corresponds to a map from photo label to filename. The map key is a
string, the value an object. The result of this query will be returned
as a <code>Tuple</code> object whose elements are of types <code>String</code> and <code>Object</code>.
The <code>multiselect</code> method, described further in <a href="#a10945">Section 6.3.11</a>, is used to
specify that the query returns multiple selection items.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Item&gt; item = q.from(Item.class);
MapJoin&lt;Item, <span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; photo = item.join(Item_.photos);
q.multiselect(item.get(Item_.name), photo)
    .where(cb.like(photo.key(), <span class="string"><span class="delimiter">&quot;</span><span class="content">%egret%</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> i.name, p
<span class="keyword">FROM</span> Item i <span class="keyword">JOIN</span> i.photos p
<span class="keyword">WHERE</span> <span class="type">KEY</span>(p) <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%egret%</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="restricting-the-query-result"><a class="anchor" href="#restricting-the-query-result"></a>6.3.6. Restricting the Query Result</h4>
<div class="paragraph">
<p>The result of a query can be restricted by
specifying one or more predicate conditions. Restriction predicates are
applied to the <code>CriteriaQuery</code> object by means of the <code>where</code> method.
Invocation of the <code>where</code> method results in the modification of the
<code>CriteriaQuery</code> object with the specified restriction(s).</p>
</div>
<div class="paragraph">
<p>The argument to the <code>where</code> method can be
either an <em>Expression&lt;Boolean&gt;</em> instance or zero or more <code>Predicate</code>
instances. A predicate can be either simple or compound.</p>
</div>
<div class="paragraph">
<p>A simple predicate is created by invoking one
of the conditional methods of the <code>CriteriaBuilder</code> interface, or by the
<code>isNull</code>, <code>isNotNull</code>, and <code>in</code> methods of the <code>Expression</code> interface.
The semantics of the conditional methodse.g., <code>equal</code>, <code>notEqual</code>,
<code>gt</code>, <code>ge</code>, <code>lt</code>, <code>le</code>, <code>between</code>, and <code>like</code>  mirror those of the
corresponding Jakarta Persistence query language operators as described in
<a href="#a4665">Chapter 4</a>.</p>
</div>
<div class="paragraph">
<p>Compound predicates are constructed by means
of the <code>and</code>, <code>or</code>, and <code>not</code> methods of the <code>CriteriaBuilder</code>
interface.</p>
</div>
<div class="paragraph">
<p>The restrictions upon the types to which
conditional operations are permitted to be applied are the same as the
respective operators of the Jakarta Persistence query language as described
in subsections <a href="#a5066">Section 4.6.3</a> through <a href="#a5243">Section 4.7</a>. The same
null value semantics as described in <a href="#a5676">Section 4.6.13</a> and the subsections of
<a href="#a4994">Section 4.6</a> apply.
The equality and comparison semantics described in <a href="#a5735">Section 4.6.14</a> likewise apply.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;TransactionHistory&gt; q = cb.createQuery(TransactionHistory.class);
Root&lt;CreditCard&gt; cc = q.from(CreditCard.class);
ListJoin&lt;CreditCard,TransactionHistory&gt; t = cc.join(CreditCard_.transactionHistory);
q.select(t)
    .where(cb.equal(cc.get(CreditCard_.customer)
             .get(Customer_.accountNum), <span class="integer">321987</span>),
           cb.between (t.index(), <span class="integer">0</span>, <span class="integer">9</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> t
<span class="keyword">FROM</span> CreditCard c <span class="keyword">JOIN</span> c.transactionHistory t
<span class="keyword">WHERE</span> c.customer.accountNum = <span class="integer">321987</span> <span class="keyword">AND</span> <span class="type">INDEX</span>(t) <span class="keyword">BETWEEN</span> <span class="integer">0</span> <span class="keyword">AND</span> <span class="integer">9</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Order&gt; order = q.from(Order.class);
q.where(cb.isEmpty(order.get(Order_.lineItems)))
    .select(order);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.lineItems <span class="keyword">IS</span> EMPTY</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="downcasting"><a class="anchor" href="#downcasting"></a>6.3.7. Downcasting</h4>
<div class="paragraph">
<p>Downcasting by means of the <code>treat</code> method is
supported in joins and in the construction of <code>where</code> conditions.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Order&gt; order = q.from(Order.class);
Join&lt;Order,<span class="predefined-type">Book</span>&gt; book = cb.treat(order.join(Order_.product), <span class="predefined-type">Book</span>.class);
q.select(book.get(Book_.isbn));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> b.ISBN
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> TREAT(o.product <span class="keyword">AS</span> Book) b</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Join&lt;Customer, Order&gt; order = customer.join(Customer_.orders);
q.where(
    cb.equal(cb.treat(order.get(Order_.product), <span class="predefined-type">Book</span>.class).get(Book_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Iliad</span><span class="delimiter">&quot;</span></span>));
q.select(customer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> TREAT(o.product <span class="keyword">AS</span> Book).name = <span class="string"><span class="delimiter">'</span><span class="content">Iliad</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Employee&gt; q = cb.createQuery(Employee.class);
Root&lt;Employee&gt; e = q.from(Employee.class);
q.where(
    cb.or(cb.gt(cb.treat(e, Exempt.class).get(Exempt_.vacationDays), <span class="integer">10</span>),
    cb.gt(cb.treat(e, Contractor.class).get(Contractor_.hours), <span class="integer">100</span>)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TREAT(e <span class="keyword">AS</span> Exempt).vacationDays &gt; <span class="integer">10</span>
    <span class="keyword">OR</span> TREAT(e <span class="keyword">AS</span> Contractor).hours &gt; <span class="integer">100</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="expressions"><a class="anchor" href="#expressions"></a>6.3.8. Expressions</h4>
<div class="paragraph">
<p>An <code>Expression</code> or one of its subtypes can be
used in the construction of the query&#8217;s select list or in the
construction of <code>where</code> or <code>having</code> method conditions.</p>
</div>
<div class="paragraph">
<p>Paths and boolean predicates are expressions.</p>
</div>
<div class="paragraph">
<p>Other expressions are created by means of the
methods of the <code>CriteriaBuilder</code> interface. The <code>CriteriaBuilder</code>
interface provides methods corresponding to the built-in arthmetic,
string, datetime, and case operators and functions of the Jakarta
Persistence query language.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; cust = q.from(Customer.class);
Join&lt;Customer, Order&gt; order = cust.join(Customer_.orders);
Join&lt;Customer, Address&gt; addr = cust.join(Customer_.address);
q.where(cb.equal(addr.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>),
        cb.equal(addr.get(Address_.county), <span class="string"><span class="delimiter">&quot;</span><span class="content">Santa Clara</span><span class="delimiter">&quot;</span></span>));

q.multiselect(order.get(Order_.quantity),
        cb.prod(order.get(Order_.totalCost), <span class="float">1.08</span>),
        addr.get(Address_.zipcode));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o.quantity, o.totalCost*<span class="float">1.08</span>, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> a.county = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Employee&gt; q = cb.createQuery(Employee.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
q.select(emp)
    .where(cb.notEqual(emp.type(), Exempt.class));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>type</code> method can only be applied to a
path expression. Its result denotes the type navigated to by the path.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) &lt;&gt; Exempt</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Course&gt; c = q.from(Course.class);
ListJoin&lt;Course, Student&gt; w = c.join(Course_.studentWaitlist);
q.where(cb.equal(c.get(Course_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Calculus</span><span class="delimiter">&quot;</span></span>),
        cb.equal(w.index(), <span class="integer">0</span>))
 .select(w.get(Student_.name));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>index</code> method can be applied to a
<code>ListJoin</code> object that corresponds to a list for which an order column
has been specified. Its result denotes the position of the item in the
list.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> w.name
<span class="keyword">FROM</span> Course c <span class="keyword">JOIN</span> c.studentWaitlist w
<span class="keyword">WHERE</span> c.name = <span class="string"><span class="delimiter">'</span><span class="content">Calculus</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> <span class="type">INDEX</span>(w) = <span class="integer">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">BigDecimal</span>&gt; q = cb.createQuery(<span class="predefined-type">BigDecimal</span>.class);
Root&lt;Order&gt; order = q.from(Order.class);
Join&lt;Order, Item&gt; item = order.join(Order_.lineItems);
Join&lt;Order, Customer&gt; cust = order.join(Order_.customer);

q.where(
    cb.equal(cust.get(Customer_.lastName), <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>),
    cb.equal(cust.get(Customer_.firstName), <span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>));
q.select(cb.sum(item.get(Item_.price)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The aggregation methods <code>avg</code>, <code>max</code>, <code>min</code>
, <code>sum</code>, <code>count</code> can only be used in the construction of the select
list or in <code>having</code> method conditions.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">SUM</span>(i.price)
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems i <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastName = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstName = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Integer</span>&gt; q = cb.createQuery(<span class="predefined-type">Integer</span>.class);
Root&lt;Department&gt; d = q.from(Department.class);
q
    .where(cb.equal(d.get(Department_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Sales</span><span class="delimiter">&quot;</span></span>))
    .select(cb.size(d.get(Department_.employees)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>size</code> method can be applied to a path
expression that corresponds to an association or element collection. Its
result denotes the number of elements in the association or element
collection.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> SIZE(d.employees)
<span class="keyword">FROM</span> Department d
<span class="keyword">WHERE</span> d.name = <span class="string"><span class="delimiter">'</span><span class="content">Sales</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong></p>
</div>
<div class="paragraph">
<p>Both simple and general case expressions are
supported. The query below illustrates use of a general case expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Employee&gt; e = q.from(Employee.class);
q.where(
    cb.equal(e.get(Employee_.department).get(Department_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Engineering</span><span class="delimiter">&quot;</span></span>));
q.multiselect(
    e.get(Employee_.name),
    cb.selectCase()
        .when(
            cb.equal(e.get(Employee_.rating), <span class="integer">1</span>),
            cb.prod(e.get(Employee_.salary), <span class="float">1.1</span>))
        .when(
            cb.equal(e.get(Employee_.rating), <span class="integer">2</span>),
            cb.prod(e.get(Employee_.salary), <span class="float">1.2</span>))
        .otherwise(cb.prod(e.get(Employee_.salary), <span class="float">1.01</span>)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e.name,
    <span class="keyword">CASE</span>
        <span class="keyword">WHEN</span> e.rating = <span class="integer">1</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.1</span>
        <span class="keyword">WHEN</span> e.rating = <span class="integer">2</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.2</span>
        <span class="keyword">ELSE</span> e.salary * <span class="float">1.01</span>
    <span class="keyword">END</span>
<span class="keyword">FROM</span> EMPLOYEE e
<span class="keyword">WHERE</span> e.department.name = <span class="string"><span class="delimiter">'</span><span class="content">Engineering</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="result-types-of-expressions"><a class="anchor" href="#result-types-of-expressions"></a>6.3.8.1. Result Types of Expressions</h5>
<div class="paragraph">
<p>The <code>getJavaType</code> method, as defined in the
<code>TupleElement</code> interface, returns the runtime type of the object on
which it is invoked.</p>
</div>
<div class="paragraph">
<p>In the case of the <code>In</code>, <code>Case</code>,
<code>SimpleCase</code>, and <code>Coalesce</code> builder interfaces, the runtime results of
the <code>getJavaType</code> method may differ from the <code>Expression</code> type and may
vary as the expression is incrementally constructed. For non-numerical
operands, the implementation must return the most specific common
superclass of the types of the operands used to form the result.</p>
</div>
<div class="paragraph">
<p>In the case of the two-argument <code>sum</code>,
<code>prod</code>, <code>diff</code>, <code>quot</code>, <code>coalesce</code>, and <code>nullif</code> methods, and the
<code>In</code>, <code>Case</code>, <code>SimpleCase</code>, and <code>Coalesce</code> builder methods, the
runtime result types will differ from the <code>Expression</code> type when the
latter is <code>Number</code>. The following rules must be observed by the
implementation when materializing the results of numeric expressions
involving these methods. These rules correspond to those specified for
the Jakarta Persistence query language as defined in <a href="#a5574">Section 4.7.13</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is an operand of type Double, the
result of the operation is of type Double;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
Float, the result of the operation is of type Float;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
BigDecimal, the result of the operation is of type BigDecimal;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
BigInteger, the result of the operation is of type BigInteger, unless
the method is <code>quot</code>, in which case the numeric result type is not
further defined;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
Long, the result of the operation is of type Long, unless the method is
<code>quot</code>, in which case the numeric result type is not further defined;</p>
</li>
<li>
<p>otherwise, if there is an operand of integral
type, the result of the operation is of type Integer, unless the method
is <code>quot</code>, in which case the numeric result type is not further
defined.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Users should note that the semantics of the
SQL division operation are not standard across databases. In particular,
when both operands are of integral types, the result of the division
operation will be an integral type in some databases, and an
non-integral type in others. Portable applications should not assume a
particular result type.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="literals-2"><a class="anchor" href="#literals-2"></a>6.3.9. Literals</h4>
<div class="paragraph">
<p>An <code>Expression</code> literal instance is obtained
by passing a value to the <code>literal</code> method of the <code>CriteriaBuilder</code>
interface. An <code>Expression</code> instance representing a null is created by
the <code>nullLiteral</code> method of the <code>CriteriaBuilder</code> interface.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
Join&lt;Employee, FrequentFlierPlan&gt; fp = emp.join(Employee_.frequentFlierPlan);

q.select(
    cb.&lt;<span class="predefined-type">String</span>&gt;selectCase()
        .when(
            cb.gt(fp.get(FrequentFlierPlan_.annualMiles), <span class="integer">50000</span>),
            cb.literal(<span class="string"><span class="delimiter">&quot;</span><span class="content">Platinum</span><span class="delimiter">&quot;</span></span>))
        .when(
            cb.gt(fp.get(FrequentFlierPlan_.annualMiles), <span class="integer">25000</span>),
            cb.literal(<span class="string"><span class="delimiter">&quot;</span><span class="content">Silver</span><span class="delimiter">&quot;</span></span>))
        .otherwise(cb.nullLiteral(<span class="predefined-type">String</span>.class)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span>
    <span class="keyword">CASE</span>
        <span class="keyword">WHEN</span> fp.annualMiles &gt; <span class="integer">50000</span> <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Platinum</span><span class="delimiter">'</span></span>
        <span class="keyword">WHEN</span> fp.annualMiles &gt; <span class="integer">25000</span> <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Gold</span><span class="delimiter">'</span></span>
        <span class="keyword">ELSE</span> <span class="predefined-constant">NULL</span>
    <span class="keyword">END</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="parameter-expressions"><a class="anchor" href="#parameter-expressions"></a>6.3.10. Parameter Expressions</h4>
<div class="paragraph">
<p>A <code>ParameterExpression</code> instance is an
expression that corresponds to a parameter whose value will be supplied
before the query is executed. Parameter expressions can only be used in
the construction of conditional predicates.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; c = q.from(Customer.class);
ParameterExpression&lt;<span class="predefined-type">Integer</span>&gt; param = cb.parameter(<span class="predefined-type">Integer</span>.class);

q.select(c)
    .where(cb.equal(c.get(Customer_.status), param));</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a name is supplied when the
<code>ParameterExpression</code> instance is created, the parameter may also be
treated as a named parameter when the query is executed:</p>
</div>
<div class="paragraph">
<p>CriteriaQuery&lt;Customer&gt; q =
cb.createQuery(Customer.class);</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Root&lt;Customer&gt; c = q.from(Customer.class);
ParameterExpression&lt;<span class="predefined-type">Integer</span>&gt; param = cb.parameter(<span class="predefined-type">Integer</span>.class, <span class="string"><span class="delimiter">&quot;</span><span class="content">stat</span><span class="delimiter">&quot;</span></span>);
q.select(c).where(cb.equal(c.get(Customer_.status), param));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is equivalent to the following query in
the Jakarta Persistence query language:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c <span class="keyword">WHERE</span> c.status = :stat</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a10945"><a class="anchor" href="#a10945"></a>6.3.11. Specifying the Select List</h4>
<div class="paragraph">
<p>The select list of a query is specified by
use of the <code>select</code> or <code>multiselect</code> methods of the <code>CriteriaQuery</code>
interface. The arguments to the <code>select</code> and <code>multiselect</code> methods are
<code>Selection</code> instances.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Portable applications should use the <code>select</code>
or <code>multiselect</code> method to specify the query&#8217;s selection list.
Applications that do not use one of these methods will not be portable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>select</code> method takes a single
<code>Selection</code> argument, which can be either an <code>Expression</code> instance or a
<code>CompoundSelection</code> instance. The type of the <code>Selection</code> item must be
assignable to the defined <code>CriteriaQuery</code> result type, as described in
<a href="#a10621">Section 6.3.1</a>.</p>
</div>
<div class="paragraph">
<p>The <code>construct</code>, <code>tuple</code> and <code>array</code> methods
of the <code>CriteriaBuilder</code> interface are used to aggregate multiple
selection items into a <code>CompoundSelection</code> instance.</p>
</div>
<div class="paragraph">
<p>The <code>multiselect</code> method also supports the
specification and aggregation of multiple selection items. When the
<code>multiselect</code> method is used, the aggregation of the selection items is
determined by the result type of the <code>CriteriaQuery</code> object as described
in <a href="#a10621">Section 6.3.1</a>.</p>
</div>
<div class="paragraph">
<p>A <code>Selection</code> instance passed to the
<code>construct</code>, <code>tuple</code>, <code>array</code>, or <code>multiselect</code> methods can be one of
the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <code>Expression</code> instance.</p>
</li>
<li>
<p>A <code>Selection</code> instance obtained as the result
of the invocation of the <em>CriteriaBuilder construct</em> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>distinct</code> method of the <code>CriteriaQuery</code>
interface is used to specify that duplicate values must be eliminated
from the query result. If the <code>distinct</code> method is not used or
<code>distinct(false)</code> is invoked on the criteria query object, duplicate
values are not eliminated. When <code>distinct(true)</code> is used, and the select
items include embeddable objects or map entry results, the elimination
of duplicates is undefined.</p>
</div>
<div class="paragraph">
<p>The semantics of the <code>construct</code> method used
in the selection list is as described in <a href="#a5500">Section 4.9.2</a>. The semantics of embeddables returned by the selection list areas described in <a href="#a5511">Section 4.9.4</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>In the following example, <code>videoInventory</code> is
a Map from the entity <code>Movie</code> to the number of copies in stock.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;VideoStore&gt; v = q.from(VideoStore.class);
MapJoin&lt;VideoStore, Movie, <span class="predefined-type">Integer</span>&gt; inv = v.join(VideoStore_.videoInventory);

q.multiselect(
    v.get(VideoStore_.location).get(Address_.street),
    inv.key().get(Movie_.title),
    inv);
q.where(cb.equal(v.get(VideoStore_.location).get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">94301</span><span class="delimiter">&quot;</span></span>),
        cb.gt(inv, <span class="integer">0</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following, in
which the <code>tuple</code> method is used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;VideoStore&gt; v = q.from(VideoStore.class);
MapJoin&lt;VideoStore, Movie, <span class="predefined-type">Integer</span>&gt; inv = v.join(VideoStore_.videoInventory);

q.select(cb.tuple(
        v.get(VideoStore_.location).get(Address_.street),
        inv.key().get(Movie_.title),
        inv));
q.where(cb.equal(v.get(VideoStore_.location).get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">94301</span><span class="delimiter">&quot;</span></span>),
        cb.gt(inv, <span class="integer">0</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both are equivalent to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> v.location.street, <span class="type">KEY</span>(i).title, VALUE(i)
<span class="keyword">FROM</span> VideoStore v <span class="keyword">JOIN</span> v.videoInventory i
<span class="keyword">WHERE</span> v.location.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">94301</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> VALUE(i) &gt; <span class="integer">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 2:</p>
</div>
<div class="paragraph">
<p>The following two queries are equivalent to
the Jakarta Persistence query language query above. Because the result type
is not specified by the <code>createQuery</code> method, an <code>Object[]</code> is
returned as a result of the query execution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; q = cb.createQuery();
Root&lt;VideoStore&gt; v = q.from(VideoStore.class);
MapJoin&lt;VideoStore, Movie, <span class="predefined-type">Integer</span>&gt; inv = v.join(VideoStore_.videoInventory);

q.multiselect(
    v.get(VideoStore_.location).get(Address_.street),
    inv.key().get(Movie_.title),
    inv);

q.where(cb.equal(v.get(VideoStore_.location).get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">94301</span><span class="delimiter">&quot;</span></span>),
        cb.gt(inv, <span class="integer">0</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Equivalently:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; q = cb.createQuery();
Root&lt;VideoStore&gt; v = q.from(VideoStore.class);
MapJoin&lt;VideoStore, Movie, <span class="predefined-type">Integer</span>&gt; inv = v.join(VideoStore_.videoInventory);

q.select(cb.array(
        v.get(VideoStore_.location).get(Address_.street),
        inv.key().get(Movie_.title),
        inv));
q.where(cb.equal(v.get(VideoStore_.location).get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">94301</span><span class="delimiter">&quot;</span></span>),
        cb.gt(inv, <span class="integer">0</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 3:</p>
</div>
<div class="paragraph">
<p>The following example illustrates the
specification of a constructor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;CustomerDetails&gt; q = cb.createQuery(CustomerDetails.class);
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);

q.where(cb.gt(o.get(Order_.quantity), <span class="integer">100</span>));
q.select(cb.construct(
        CustomerDetails.class,
        c.get(Customer_.id),
        c.get(Customer_.status),
        o.get(Order_.quantity)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> NEW com.acme.example.CustomerDetails(c.id, c.status, o.quantity)
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> o.quantity &gt; <span class="integer">100</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="assigning-aliases-to-selection-items"><a class="anchor" href="#assigning-aliases-to-selection-items"></a>6.3.11.1. Assigning Aliases to Selection Items</h5>
<div class="paragraph">
<p>The <code>alias</code> method of the <code>Selection</code>
interface can be used to assign an alias to a selection item. The alias
may then later be used to extract the corresponding item from the query
result when the query is executed. The <code>alias</code> method assigns the given
alias to the <code>Selection</code> item. Once assigned, the alias cannot be
changed.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer, Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(c.get(Customer_.id), <span class="integer">97510</span>));
q.multiselect(
        o.get(Order_.quantity).alias(<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>),
        cb.prod(o.get(Order_.totalCost), <span class="float">1.08</span>).alias(<span class="string"><span class="delimiter">&quot;</span><span class="content">taxedCost</span><span class="delimiter">&quot;</span></span>),
        a.get(Address_.zipcode).alias(<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode</span><span class="delimiter">&quot;</span></span>));

TypedQuery&lt;Tuple&gt; typedQuery = em.createQuery(q);
Tuple result = typedQuery.getSingleResult();
<span class="predefined-type">Double</span> cost = (<span class="predefined-type">Double</span>)result.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">taxedCost</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="subqueries"><a class="anchor" href="#subqueries"></a>6.3.12. Subqueries</h4>
<div class="paragraph">
<p>Both correlated and non-correlated subqueries
can be used in restriction predicates. A subquery is constructed through
the creation and modification of a <code>Subquery</code> object.</p>
</div>
<div class="paragraph">
<p>A <code>Subquery</code> instance can be passed as an
argument to the <code>all</code>, <code>any</code>, or <code>some</code> methods of the
<code>CriteriaBuilder</code> interface for use in conditional expressions.</p>
</div>
<div class="paragraph">
<p>A <code>Subquery</code> instance can be passed to the
<code>CriteriaBuilder</code> <code>exists</code> method to create a conditional predicate.</p>
</div>
<div class="paragraph">
<p><strong>Example 1: Non-correlated subquery</strong></p>
</div>
<div class="paragraph">
<p>The query below contains a non-correlated
subquery. A non-correlated subquery does not reference objects of the
query of which it is a subquery. In particular, <code>Root</code>, <code>Join</code>, and
<code>Path</code> instances are not shared between the subquery and the criteria
query instance of which it is a subquery.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// create criteria query instance, with root Customer</span>
CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; goodCustomer = q.from(Customer.class);

<span class="comment">// create subquery instance, with root Customer</span>
<span class="comment">// the Subquery object is typed according to its return type</span>
Subquery&lt;<span class="predefined-type">Double</span>&gt; sq = q.subquery(<span class="predefined-type">Double</span>.class);
Root&lt;Customer&gt; customer = sq.from(Customer.class);

<span class="comment">// the result of the first query depends on the subquery</span>
q.where(cb.lt(
    goodCustomer.get(Customer_.balanceOwed),
    sq.select(cb.avg(customer.get(Customer_.balanceOwed)))));
q.select(goodCustomer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> goodCustomer
<span class="keyword">FROM</span> Customer goodCustomer
<span class="keyword">WHERE</span> goodCustomer.balanceOwed &lt; (<span class="class">SELECT</span> <span class="predefined">AVG</span>(c.balanceOwed) <span class="keyword">FROM</span> Customer c)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2: Correlated subquery</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// create CriteriaQuery instance, with root Employee</span>
CriteriaQuery&lt;Employee&gt; q = cb.createQuery(Employee.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);

<span class="comment">// create Subquery instance, with root Employee</span>
Subquery&lt;Employee&gt; sq = q.subquery(Employee.class);
Root&lt;Employee&gt; spouseEmp = sq.from(Employee.class);

<span class="comment">// the subquery references the root of the containing query</span>
sq.where(cb.equal(spouseEmp, emp.get(Employee_.spouse)))
    .select(spouseEmp);

<span class="comment">// an exists condition is applied to the subquery result:</span>
q.where(cb.exists(sq));
q.select(emp).distinct(<span class="predefined-constant">true</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above query corresponds to the following
Jakarta Persistence query language query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (
    <span class="class">SELECT</span> spouseEmp
    <span class="keyword">FROM</span> Employee spouseEmp
    <span class="keyword">WHERE</span> spouseEmp = emp.spouse)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3: Subquery qualified by all()</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// create CriteriaQuery instance, with root Employee</span>
CriteriaQuery&lt;Employee&gt; q = cb.createQuery(Employee.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);

<span class="comment">// create Subquery instance, with root Manager</span>
Subquery&lt;<span class="predefined-type">BigDecimal</span>&gt; sq = q.subquery(<span class="predefined-type">BigDecimal</span>.class);
Root&lt;Manager&gt; manager = sq.from(Manager.class);

sq.select(manager.get(Manager_.salary));
sq.where(cb.equal(
    manager.get(Manager_.department),
    emp.get(Employee_.department)));

<span class="comment">// an all expression is applied to the subquery result</span>
q.select(emp)
    .where(cb.gt(emp.get(Employee_.salary), cb.all(sq)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> emp.salary &gt; <span class="keyword">ALL</span> (
    <span class="class">SELECT</span> m.salary
    <span class="keyword">FROM</span> Manager m
    <span class="keyword">WHERE</span> m.department = emp.department)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4: A Special case</strong></p>
</div>
<div class="paragraph">
<p>In order to express some correlated
subqueries involving unidirectional relationships, it may be useful to
correlate the domain of the subquery with the domain of the containing
query. This is performed by using the <code>correlate</code> method of the
<code>Subquery</code> interface.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Subquery&lt;<span class="predefined-type">Long</span>&gt; sq = q.subquery(<span class="predefined-type">Long</span>.class);
Root&lt;Customer&gt; customerSub = sq.correlate(customer);
Join&lt;Customer,Order&gt; order = customerSub.join(Customer_.orders);

q.where(cb.gt(sq.select(cb.count(order)), <span class="integer">10</span>))
    .select(customer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> (<span class="class">SELECT</span> <span class="predefined">COUNT</span>(o) <span class="keyword">FROM</span> c.orders o) &gt; <span class="integer">10</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that joins involving the derived
subquery root do not affect the join conditions of the containing query.
The following two query definitions thus differ in semantics:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Order&gt; order = q.from(Order.class);
Subquery&lt;<span class="predefined-type">Integer</span>&gt; sq = q.subquery(<span class="predefined-type">Integer</span>.class);
Root&lt;Order&gt; orderSub = sq.correlate(order);
Join&lt;Order,Customer&gt; customer = orderSub.join(Order_.customer);
Join&lt;Customer,Account&gt; account = customer.join(Customer_.accounts);

sq.select(account.get(Account_.balance));
q.where(cb.lt(cb.literal(<span class="integer">10000</span>), cb.all(sq)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Order&gt; order = q.from(Order.class);
Join&lt;Order,Customer&gt; customer = order.join(Order_.customer);
Subquery&lt;<span class="predefined-type">Integer</span>&gt; sq = q.subquery(<span class="predefined-type">Integer</span>.class);
Join&lt;Order,Customer&gt; customerSub = sq.correlate(customer);
Join&lt;Customer,Account&gt; account = customerSub.join(Customer_.accounts);

sq.select(account.get(Account_.balance));
q.where(cb.lt(cb.literal(<span class="integer">10000</span>), cb.all(sq)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first of these queries will return orders
that are not associated with customers, whereas the second will not. The
corresponding Jakarta Persistence query language queries are the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> <span class="integer">10000</span> &lt; <span class="keyword">ALL</span> (
    <span class="class">SELECT</span> a.balance
    <span class="keyword">FROM</span> o.customer c <span class="keyword">JOIN</span> c.accounts a)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> <span class="integer">10000</span> &lt; <span class="keyword">ALL</span> (
    <span class="class">SELECT</span> a.balance
    <span class="keyword">FROM</span> c.accounts a)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="groupby-and-having"><a class="anchor" href="#groupby-and-having"></a>6.3.13. GroupBy and Having</h4>
<div class="paragraph">
<p>The <code>groupBy</code> method of the <code>CriteriaQuery</code>
interface is used to define a partitioning of the query results into
groups. The <code>having</code> method of the <code>CriteriaQuery</code> interface can be used
to filter over the groups.</p>
</div>
<div class="paragraph">
<p>The arguments to the <code>groupBy</code> method are
<code>Expression</code> instances.</p>
</div>
<div class="paragraph">
<p>When the <code>groupBy</code> method is used, each
selection item that is not the result of applying an aggregate method
must correspond to a path expression that is used for defining the
grouping. Requirements on the types that correspond to the elements of
the grouping and having constructs and their relationship to the select
items are as specified in <a href="#a5410">Section 4.8</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; customer = q.from(Customer.class);

q.groupBy(customer.get(Customer_.status));
q.having(cb.in(customer.get(Customer_.status)).value(<span class="integer">1</span>).value(<span class="integer">2</span>));
q.select(cb.tuple(
        customer.get(Customer_.status),
        cb.avg(customer.get(Customer_.filledOrderCount)),
        cb.count(customer)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.status, <span class="predefined">AVG</span>(c.filledOrderCount), <span class="predefined">COUNT</span>(c)
<span class="keyword">FROM</span> Customer c
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c.status
<span class="keyword">HAVING</span> c.status <span class="keyword">IN</span> (<span class="integer">1</span>, <span class="integer">2</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ordering-the-query-results"><a class="anchor" href="#ordering-the-query-results"></a>6.3.14. Ordering the Query Results</h4>
<div class="paragraph">
<p>The ordering of the results of a query is
defined by use of the <code>orderBy</code> method of the <code>CriteriaQuery</code> instance.
The arguments to the <code>orderBy</code> method are <code>Order</code> instances.</p>
</div>
<div class="paragraph">
<p>An <code>Order</code> instance is created by means of
the <code>asc</code> and <code>desc</code> methods of the <code>CriteriaBuilder</code> interface. An
argument to either of these methods must be one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any <code>Expression</code> instance that corresponds to
an orderable state field of an entity or embeddable class abstract
schema type that is specified as an argument to the <code>select</code> or
<code>multiselect</code> method or that is an argument to a tuple or array
constructor that is passed as an argument to the <code>select</code> method.</p>
</li>
<li>
<p>Any <code>Expression</code> instance that corresponds to
the same state field of the same entity or embeddable abstract schema
type as an <code>Expression</code> instance that is specified as an argument to the
<code>select</code> or <code>multiselect</code> method or that is an argument to a tuple or
array constructor that is passed as an argument to the <code>select</code> method.</p>
</li>
<li>
<p>An <code>Expression</code> instance that is specified as
an argument to the <code>select</code> or <code>multiselect</code> method or that is an
argument to a tuple or array constructor that is passed as an argument
to the <code>select</code> method or that is semantically equivalent to such an
<code>Expression</code> instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If more than one <code>Order</code> instance is
specified, the order in which they appear in the argument list of the
<code>orderBy</code> method determines the precedence, whereby the first item has
highest precedence.</p>
</div>
<div class="paragraph">
<p>SQL rules for the ordering of null values
apply, as described in <a href="#a5587">Section 4.10</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer,Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer,Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(a.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>));
q.select(o);
q.orderBy(cb.desc(o.get(Order_.quantity)),
    cb.asc(o.get(Order_.totalCost)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity <span class="directive">DESC</span>, o.totalcost</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer, Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(a.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>));
q.orderBy(cb.asc(o.get(Order_.quantity)),
    cb.asc(a.get(Address_.zipcode)));
q.multiselect(o.get(Order_.quantity),
    a.get(Address_.zipcode));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o.quantity, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity, a.zipcode</code></pre>
</div>
</div>
<div class="paragraph">
<p>It can be equivalently expressed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer, Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(a.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>));
q.orderBy(cb.asc(o.get(Order_.quantity)),
    cb.asc(a.get(Address_.zipcode)));
q.select(cb.tuple(o.get(Order_.quantity),
    a.get(Address_.zipcode)));</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Object</span><span class="type">[]</span>&gt; q = cb.createQuery(<span class="predefined-type">Object</span><span class="type">[]</span>.class);
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer, Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(a.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>),
    cb.equal(a.get(Address_.county), <span class="string"><span class="delimiter">&quot;</span><span class="content">Santa Clara</span><span class="delimiter">&quot;</span></span>));
q.select(cb.array(o.get(Order_.quantity),
    cb.prod(o.get(Order_.totalCost), <span class="float">1.08</span>),
    a.get(Address_.zipcode)));
q.orderBy(cb.asc(o.get(Order_.quantity)),
    cb.asc(cb.prod(o.get(Order_.totalCost), <span class="float">1.08</span>)),
    cb.asc(a.get(Address_.zipcode)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o.quantity, o.totalCost * <span class="float">1.08</span> <span class="keyword">AS</span> taxedCost, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> a.county = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity, taxedCost, a.zipcode</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a11239"><a class="anchor" href="#a11239"></a>6.3.15. Bulk Update and Delete Operations</h4>
<div class="paragraph">
<p>A bulk update query is constructed through
the creation and modification of a
<code>jakarta.persistence.criteria.CriteriaUpdate</code> object.</p>
</div>
<div class="paragraph">
<p>A <code>CriteriaUpdate</code> object is created by means
of one of the <code>createCriteriaUpdate</code> methods of the <code>CriteriaBuilder</code>
interface. A <code>CriteriaUpdate</code> object is typed according to the entity
type that is the target of the update. A <code>CriteriaUpdate</code> object has a
single root, the entity that is being updated.</p>
</div>
<div class="paragraph">
<p>A bulk delete query is constructed through
the creation and modification of a
<code>jakarta.persistence.criteria.CriteriaDelete</code> object.</p>
</div>
<div class="paragraph">
<p>A <code>CriteriaDelete</code> object is created by means
of one of the <code>createCriteriaDelete</code> methods of the <code>CriteriaBuilder</code>
interface. A <code>CriteriaDelete</code> object is typed according to the entity
type that is the target of the delete. A <code>CriteriaDelete</code> object has a
single root, the entity that is being deleted.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaUpdate&lt;Customer&gt; q = cb.createCriteriaUpdate(Customer.class);
Root&lt;Customer&gt; c = q.from(Customer.class);

q.set(c.get(Customer_.status), <span class="string"><span class="delimiter">&quot;</span><span class="content">outstanding</span><span class="delimiter">&quot;</span></span>)
    .where(cb.lt(c.get(Customer_.balance), <span class="integer">10000</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
update statement is equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">UPDATE</span> Customer c
<span class="class">SET</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">outstanding</span><span class="delimiter">'</span></span>
<span class="keyword">WHERE</span> c.balance &lt; <span class="integer">10000</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaUpdate&lt;Employee&gt; q = cb.createCriteriaUpdate(Employee.class);
Root&lt;Employee&gt; e = q.from(Employee.class);

q.set(e.get(Employee_.address).get(Address_.building), <span class="integer">22</span>)
    .where(
        cb.equal(e.get(Employee_.address).get(Address_.building), <span class="integer">14</span>),
        cb.equal(e.get(Employee_.address).get(Address_.city), <span class="string"><span class="delimiter">&quot;</span><span class="content">Santa Clara</span><span class="delimiter">&quot;</span></span>),
        cb.equal(e.get(Employee_.project).get(Project_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Jakarta EE</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Address</code> is an embeddable class. Note that
updating across implicit joins is not supported.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
update statement is equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.address.building = <span class="integer">22</span>
<span class="keyword">WHERE</span> e.address.building = <span class="integer">14</span>
    <span class="keyword">AND</span> e.address.city = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> e.project.name = <span class="string"><span class="delimiter">'</span><span class="content">Jakarta EE</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>The following update query causes multiple
attributes to be updated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaUpdate&lt;Employee&gt; q = cb.createCriteriaUpdate(Employee.class);
Root&lt;Employee&gt; e = q.from(Employee.class);

q.set(e.get(Employee_.salary), cb.prod(e.get(Employee_.salary), <span class="float">1.1f</span>))
    .set(e.get(Employee_.commission), cb.prod(e.get(Employee_.commission), <span class="float">1.1f</span>))
    .set(e.get(Employee_.bonus), cb.sum(e.get(Employee_.bonus), <span class="integer">5000</span>))
    .where(cb.equal(e.get(Employee_.dept).get(Department_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Sales</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
update statement is equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.salary = e.salary * <span class="float">1.1</span>,
    e.commission = e.commission * <span class="float">1.1</span>,
    e.bonus = e.bonus + <span class="integer">5000</span>
<span class="keyword">WHERE</span> e.dept.name = <span class="string"><span class="delimiter">'</span><span class="content">Sales</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaDelete&lt;Customer&gt; q = cb.createCriteriaDelete(Customer.class);
Root&lt;Customer&gt; c = q.from(Customer.class);

q.where(
    cb.equal(c.get(Customer_.status), <span class="string"><span class="delimiter">&quot;</span><span class="content">inactive</span><span class="delimiter">&quot;</span></span>),
    cb.isEmpty(c.get(Customer_.orders)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
delete statement is equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DELETE</span>
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">inactive</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> c.orders <span class="keyword">IS</span> EMPTY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Like bulk update and delete operations made
through the Jakarta Persistence query language, criteria API bulk update
and delete operations map directly to database operations, bypassing any
optimistic locking checks. Portable applications using bulk update
operations must manually update the value of the version column, if
desired, and/or manually validate the value of the version column.</p>
</div>
<div class="paragraph">
<p>The persistence context is not synchronized
with the result of the bulk update or delete. See <a href="#a5636">Section 4.11</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11305"><a class="anchor" href="#a11305"></a>6.4. Constructing Strongly-typed Queries using the jakarta.persistence.metamodel Interfaces</h3>
<div class="paragraph">
<p>Strongly-typed queries can also be
constructed, either statically or dynamically, in the absence of
generated metamodel classes. The <code>jakarta.persistence.metamodel</code>
interfaces are used to access the metamodel objects that correspond to
the managed classes.</p>
</div>
<div class="paragraph">
<p>The following examples illustrate this
approach. These are equivalent to the example queries shown in <a href="#a16277">Section 6.3.5</a>.</p>
</div>
<div class="paragraph">
<p>The <code>Metamodel</code> interface is obtained from
the EntityManager or EntityManagerFactory for the persistence unit, and
then used to obtain the corresponding metamodel objects for the managed
types referenced by the queries.</p>
</div>
<div class="paragraph">
<p>Example 1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">EntityManager em = ...;

Metamodel mm = em.getMetamodel();
EntityType&lt;Employee&gt; emp_ =mm.entity(Employee.class);
EmbeddableType&lt;ContactInfo&gt; cinfo_ = mm.embeddable(ContactInfo.class);
EntityType&lt;Phone&gt; phone_ = mm.entity(Phone.class);
EmbeddableType&lt;Address&gt; addr_ = mm.embeddable(Address.class);

CriteriaQuery&lt;Vendor&gt; q = cb.createQuery(Vendor.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
Join&lt;Employee, ContactInfo&gt; cinfo =
    emp.join(emp_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo</span><span class="delimiter">&quot;</span></span>, ContactInfo.class));
Join&lt;ContactInfo, Phone&gt; p =
    cinfo.join(cinfo_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>, Phone.class));
q.where(
    cb.equal(emp.get(emp_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo</span><span class="delimiter">&quot;</span></span>, ContactInfo.class))
        .get(cinfo_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, Address.class))
        .get(addr_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class)), <span class="string"><span class="delimiter">&quot;</span><span class="content">95054</span><span class="delimiter">&quot;</span></span>))
    .select(p.get(phone_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">vendor</span><span class="delimiter">&quot;</span></span>,Vendor.class)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 2:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">EntityManager em = ...;
Metamodel mm = em.getMetamodel();

EntityType&lt;Item&gt; item_ = mm.entity(Item.class);
CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Item&gt; item = q.from(Item.class);
MapJoin&lt;Item, <span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; photo =
    item.join(item_.getMap(<span class="string"><span class="delimiter">&quot;</span><span class="content">photos</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class, <span class="predefined-type">Object</span>.class));
q.multiselect(
    item.get(item_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class)), photo)
        .where(cb.like(photo.key(), <span class="string"><span class="delimiter">&quot;</span><span class="content">%egret%</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11349"><a class="anchor" href="#a11349"></a>6.5. Use of the Criteria API with Strings to Reference Attributes</h3>
<div class="paragraph">
<p>The Criteria API provides the option of
specifying the attribute references used in joins and navigation by
attribute names used as arguments to the various <code>join</code>, <code>fetch</code>, and
<code>get</code> methods.</p>
</div>
<div class="paragraph">
<p>The resulting queries have the same semantics
as described in <a href="#a10614">Section 6.3</a>, but do not provide the same level of type safety.</p>
</div>
<div class="paragraph">
<p>The examples in this section illustrate this
approach. These examples are derived from among those of sections
<a href="#a10643">Section 6.3.3</a> and <a href="#a16277">Section 6.3.5</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaBuilder cb = ...
CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Customer&gt; cust = q.from(Customer.class);
Join&lt;Order, Item&gt; item = cust.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>).join(<span class="string"><span class="delimiter">&quot;</span><span class="content">lineItems</span><span class="delimiter">&quot;</span></span>);
q.select(cust.&lt;<span class="predefined-type">String</span>&gt;get(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>))
    .where(cb.equal(item.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">product</span><span class="delimiter">&quot;</span></span>).get(<span class="string"><span class="delimiter">&quot;</span><span class="content">productType</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">printer</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.name
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> o.lineItems i
<span class="keyword">WHERE</span> i.product.productType = <span class="string"><span class="delimiter">'</span><span class="content">printer</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is not required that type parameters be
used. However, their omission may result in compiler warnings, as with
the below version of the same query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaBuilder cb = ...
CriteriaQuery q = cb.createQuery();
Root cust = q.from(Customer.class);
Join item = cust.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>).join(<span class="string"><span class="delimiter">&quot;</span><span class="content">lineItems</span><span class="delimiter">&quot;</span></span>);
q.select(cust.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)).where(
    cb.equal(item.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">product</span><span class="delimiter">&quot;</span></span>).get(<span class="string"><span class="delimiter">&quot;</span><span class="content">productType</span><span class="delimiter">&quot;</span></span>),<span class="string"><span class="delimiter">&quot;</span><span class="content">printer</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>The following query uses an outer join:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; cust = q.from(Customer.class);
Join&lt;Customer,Order&gt; order = cust.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>, JoinType.LEFT);
q.where(cb.equal(cust.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>), <span class="integer">1</span>))
    .select(cust);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>In the following example, <code>ContactInfo</code> is an
embeddable class consisting of an address and set of phones. <code>Phone</code> is
an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Vendor&gt; q = cb.createQuery(Vendor.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
Join&lt;ContactInfo, Phone&gt; phone = emp.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo</span><span class="delimiter">&quot;</span></span>).join(<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>);
q.where(cb.equal(emp.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo</span><span class="delimiter">&quot;</span></span>)
    .get(<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>)
    .get(<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">95054</span><span class="delimiter">&quot;</span></span>));
q.select(phone.&lt;Vendor&gt;get(<span class="string"><span class="delimiter">&quot;</span><span class="content">vendor</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo.phones p
<span class="keyword">WHERE</span> e.contactInfo.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="paragraph">
<p>In this example, the <code>photos</code> attribute
corresponds to a map from photo label to filename. The map key is a
string, the value an object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; q = cb.createQuery();
Root&lt;Item&gt; item = q.from(Item.class);
MapJoin&lt;Item, <span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; photo = item.joinMap(<span class="string"><span class="delimiter">&quot;</span><span class="content">photos</span><span class="delimiter">&quot;</span></span>);
q.multiselect(item.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>), photo)
    .where(cb.like(photo.key(), <span class="string"><span class="delimiter">&quot;</span><span class="content">%egret%</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> i.name, p
<span class="keyword">FROM</span> Item i <span class="keyword">JOIN</span> i.photos p
<span class="keyword">WHERE</span> <span class="type">KEY</span>(p) <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%egret%</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11413"><a class="anchor" href="#a11413"></a>6.6. Query Modification</h3>
<div class="paragraph">
<p>A <code>CriteriaQuery</code>, <code>CriteriaUpdate</code>, or
<code>CriteriaDelete</code> object may be modified, either before or after <code>Query</code>
or <code>TypedQuery</code> objects have been created and executed from it. For
example, such modification may entail replacement of the <code>where</code>
predicate or the <code>select</code> list. Modifications may thus result in the
same query object base being reused for several query instances.</p>
</div>
<div class="paragraph">
<p>For example, the user might create and
execute a query from the following <code>CriteriaQuery</code> object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; c = q.from(Customer.class);

<span class="predefined-type">Predicate</span> pred = cb.equal(c.get(Customer_.address).get(Address_.city),<span class="string"><span class="delimiter">&quot;</span><span class="content">Chicago</span><span class="delimiter">&quot;</span></span>);

q.select(c);
q.where(pred);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>CriteriaQuery</code> object might then be
modified to reflect a different predicate condition, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Predicate</span> pred2 = cb.gt(c.get(Customer_.balanceOwed), <span class="integer">1000</span>);
q.where(pred2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note, however, that query elements-in this
example, predicate conditionsare dependent on the <code>CriteriaQuery</code>,
<code>CriteriaUpdate</code>, or <code>CriteriaDelete</code> instance, and are thus not
portably reusable with different instances.</p>
</div>
</div>
<div class="sect2">
<h3 id="a11427"><a class="anchor" href="#a11427"></a>6.7. Query Execution</h3>
<div class="paragraph">
<p>A criteria query is executed by passing the
<code>CriteriaQuery</code>, <code>CriteriaUpdate</code>, or <code>CriteriaDelete</code> object to the
<code>createQuery</code> method of the <code>EntityManager</code> interface to create an
executable <code>TypedQuery</code> object (or, in the case of <code>CriteriaUpdate</code> and
<code>CriteriaDelete</code>, a <code>Query</code> object), which can then be passed to one of
the query execution methods of the <code>TypedQuery</code> or <code>Query</code> interface.</p>
</div>
<div class="paragraph">
<p>A <code>CriteriaQuery</code>, <code>CriteriaUpdate</code>, or
<code>CriteriaDelete</code> object may be further modified after an executable
query object has been created from it. The modification of the
<code>CriteriaQuery</code>, <code>CriteriaUpdate</code>, or <code>CriteriaDelete</code> object does not
have any impact on the already created executable query object. If the
modified <code>CriteriaQuery</code>, <code>CriteriaUpdate</code>, or <code>CriteriaDelete</code> object
is passed to the <code>createQuery</code> method, the persistence provider must
insure that a new executable query object is created and returned that
reflects the semantics of the changed query definition.</p>
</div>
<div class="paragraph">
<p><code>CriteriaQuery</code>, <code>CriteriaUpdate</code>, and
<code>CriteriaDelete</code> objects must be serializable. A persistence vendor is
required to support the subsequent deserialization of such an object
into a separate JVM instance of that vendor&#8217;s runtime, where both
runtime instances have access to any required vendor implementation
classes. <code>CriteriaQuery</code>, <code>CriteriaUpdate</code>, and <code>CriteriaDelete</code>
objects are not required to be interoperable across vendors.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a11431"><a class="anchor" href="#a11431"></a>7. Entity Managers and Persistence Contexts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="a11432"><a class="anchor" href="#a11432"></a>7.1. Persistence Contexts</h3>
<div class="paragraph">
<p>A persistence context is a set of managed
entity instances in which for any persistent entity identity there is a
unique entity instance. Within the persistence context, the entity
instances and their lifecycle are managed by the entity manager.</p>
</div>
<div class="paragraph">
<p>In Jakarta EE environments, a JTA transaction
typically involves calls across multiple components. Such components may
often need to access the same persistence context within a single
transaction. To facilitate such use of entity managers in Jakarta EE
environments, when an entity manager is injected into a component or
looked up directly in the JNDI naming context, its persistence context
will automatically be propagated with the current JTA transaction, and
the EntityManager references that are mapped to the same persistence
unit will provide access to this same persistence context within the JTA
transaction. This propagation of persistence contexts by the Jakarta EE
container avoids the need for the application to pass references to
EntityManager instances from one component to another. An entity manager
for which the container manages the persistence context in this manner
is termed a <em>container-managed entity manager</em>. A container-managed
entity manager&#8217;s lifecycle is managed by the Jakarta EE container.</p>
</div>
<div class="paragraph">
<p>In less common use cases within Jakarta EE
environments, applications may need to access a persistence context that
is stand-alonei.e. not propagated along with the JTA transaction
across the EntityManager references for the given persistence unit.
Instead, each instance of creating an entity manager causes a new
isolated persistence context to be created that is not accessible
through other EntityManager references within the same transaction.
These use cases are supported through the <code>createEntityManager</code> methods
of the <code>EntityManagerFactory</code> interface. An entity manager that is used
by the application to create and destroy a persistence context in this
manner is termed an <em>application-managed entity manager</em>. An
application-managed entity manager&#8217;s lifecycle is managed by the
application.</p>
</div>
<div class="paragraph">
<p>Both container-managed entity managers and
application-managed entity managers and their persistence contexts are
required to be supported in Jakarta EE web containers and EJB containers.
Within an EJB environment, container-managed entity managers are
typically used.</p>
</div>
<div class="paragraph">
<p>In Java SE environments and in Jakarta EE
application client containers, only application-managed entity managers
are required to be <sup class="footnote">[<a id="_footnoteref_87" class="footnote" href="#_footnotedef_87" title="View footnote.">87</a>]</sup>.</p>
</div>
</div>
<div class="sect2">
<h3 id="obtaining-an-entitymanager"><a class="anchor" href="#obtaining-an-entitymanager"></a>7.2. Obtaining an EntityManager</h3>
<div class="paragraph">
<p>The entity manager for a persistence context
is obtained from an entity manager factory.</p>
</div>
<div class="paragraph">
<p>When container-managed entity managers are
used (in Jakarta EE environments), the application does not interact with
the entity manager factory. The entity managers are obtained directly
through dependency injection or from JNDI, and the container manages
interaction with the entity manager factory transparently to the
application.</p>
</div>
<div class="paragraph">
<p>When application-managed entity managers are
used, the application must use the entity manager factory to manage the
entity manager and persistence context lifecycle.</p>
</div>
<div class="paragraph">
<p>An entity manager must not be shared among
multiple concurrently executing threads, as the entity manager and
persistence context are not required to be threadsafe. Entity managers
must only be accessed in a single-threaded manner.</p>
</div>
<div class="sect3">
<h4 id="obtaining-an-entity-manager-in-the-jakarta-ee-environment"><a class="anchor" href="#obtaining-an-entity-manager-in-the-jakarta-ee-environment"></a>7.2.1. Obtaining an Entity Manager in the Jakarta EE Environment</h4>
<div class="paragraph">
<p>A container-managed entity manager is
obtained by the application through dependency injection or through
direct lookup of the entity manager in the JNDI namespace. The container
manages the persistence context lifecycle and the creation and the
closing of the entity manager instance transparently to the application.</p>
</div>
<div class="paragraph">
<p>The <code>PersistenceContext</code> annotation is used
for entity manager injection. The <code>type</code> element specifies whether a
transaction-scoped or extended persistence context is to be used, as
described in <a href="#a11791">Section 7.7</a>. The <code>synchronization</code> element specifies whether
the persistence context is always automatically joined to the current
transaction (the default) or is not joined to the current transaction
unless the <code>joinTransaction</code> method is invoked by the application. The
<code>unitName</code> element may optionally be specified to designate the
persistence unit whose entity manager factory is used by the container.
The semantics of the persistence context synchronization type are
further described in <a href="#a11797">Section 7.7.1</a>. Section <a href="#a13887">Section 10.5.2</a> provides further
information about the <code>unitName</code> element.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PersistenceContext</span>
EntityManager em;

<span class="annotation">@PersistenceContext</span>(type=PersistenceContextType.EXTENDED)
EntityManager orderEM;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JNDI lookup of an entity manager is illustrated below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Stateless</span>
<span class="annotation">@PersistenceContext</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderEM</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MySessionBean</span> <span class="directive">implements</span> MyInterface {
    <span class="annotation">@Resource</span>
    SessionContext ctx;

    <span class="directive">public</span> <span class="type">void</span> doSomething() {
        EntityManager em = (EntityManager)ctx.lookup(<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderEM</span><span class="delimiter">&quot;</span></span>);

        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a11465"><a class="anchor" href="#a11465"></a>7.2.2. Obtaining an Application-managed Entity Manager</h4>
<div class="paragraph">
<p>An application-managed entity manager is
obtained by the application from an entity manager factory.</p>
</div>
<div class="paragraph">
<p>The <code>EntityManagerFactory</code> API used to obtain
an application-managed entity manager is the same independent of whether
this API is used in Jakarta EE or Java SE environments.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="obtaining-an-entity-manager-factory"><a class="anchor" href="#obtaining-an-entity-manager-factory"></a>7.3. Obtaining an Entity Manager Factory</h3>
<div class="paragraph">
<p>The <code>EntityManagerFactory</code> interface is used
by the application to create an application-managed entity
manager<sup class="footnote">[<a id="_footnoteref_88" class="footnote" href="#_footnotedef_88" title="View footnote.">88</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>Each entity manager factory provides entity
manager instances that are all configured in the same manner (e.g.,
configured to connect to the same database, use the same initial
settings as defined by the implementation, etc.)</p>
</div>
<div class="paragraph">
<p>More than one entity manager factory
instance may be available simultaneously in the
JVM.<sup class="footnote">[<a id="_footnoteref_89" class="footnote" href="#_footnotedef_89" title="View footnote.">89</a>]</sup></p>
</div>
<div class="paragraph">
<p>Methods of the <code>EntityManagerFactory</code> interface are threadsafe.</p>
</div>
<div class="sect3">
<h4 id="obtaining-an-entity-manager-factory-in-a-jakarta-ee-container"><a class="anchor" href="#obtaining-an-entity-manager-factory-in-a-jakarta-ee-container"></a>7.3.1. Obtaining an Entity Manager Factory in a Jakarta EE Container</h4>
<div class="paragraph">
<p>Within a Jakarta EE environment, an entity
manager factory can be injected using the <code>PersistenceUnit</code> annotation
or obtained through JNDI lookup. The <code>unitName</code> element may optionally
be specified to designate the persistence unit whose entity manager
factory is used. (See <a href="#a13887">Section 10.5.2</a>).</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PersistenceUnit</span>
EntityManagerFactory emf;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="obtaining-an-entity-manager-factory-in-a-java-se-environment"><a class="anchor" href="#obtaining-an-entity-manager-factory-in-a-java-se-environment"></a>7.3.2. Obtaining an Entity Manager Factory in a Java SE Environment</h4>
<div class="paragraph">
<p>Outside a Jakarta EE container environment, the
<code>jakarta.persistence.Persistence</code> class is the bootstrap class that
provides access to an entity manager factory. The application creates an
entity manager factory by calling the <code>createEntityManagerFactory</code>
method of the <code>jakarta.persistence.Persistence</code> class, described in
<a href="#a13443">Section 9.7</a>.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">EntityManagerFactory emf =
    jakarta.persistence.Persistence.createEntityManagerFactory(<span class="string"><span class="delimiter">&quot;</span><span class="content">Order</span><span class="delimiter">&quot;</span></span>);
EntityManager em = emf.createEntityManager();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="obtaining-an-entity-manager-factory-for-a-programmatically-defined-persistence-unit"><a class="anchor" href="#obtaining-an-entity-manager-factory-for-a-programmatically-defined-persistence-unit"></a>7.3.3. Obtaining an Entity Manager Factory for a programmatically-defined persistence unit</h4>
<div class="paragraph">
<p>The class <code>jakarta.persistence.PersistenceConfiguration</code> described
in <a href="#a13444">Section 9.8</a> may be used to programmatically define and configure a
persistence unit (see <a href="#a12235">Section 8.1</a>), as an alternative to packaging a
<code>persistence.xml</code> file, mapping files, and classes inside an archive
as described in <a href="#a12236">Section 8.2</a>.</p>
</div>
<div class="paragraph">
<p>An <code>EntityManagerFactory</code> may be obtained directly from the
<code>PersistenceConfiguration</code>.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">DataSource</span> datasource = (<span class="predefined-type">DataSource</span>)
        <span class="keyword">new</span> <span class="predefined-type">InitialContext</span>()
                .lookup(<span class="string"><span class="delimiter">&quot;</span><span class="content">java:global/jdbc/MyOrderDB</span><span class="delimiter">&quot;</span></span>);
EntityManagerFactory emf =
        <span class="keyword">new</span> PersistenceConfiguration()
                .name(<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement</span><span class="delimiter">&quot;</span></span>)
                .jtaDataSource(datasource)
                .mappingFile(<span class="string"><span class="delimiter">&quot;</span><span class="content">ormap.xml</span><span class="delimiter">&quot;</span></span>)
                .managedClass(Order.class)
                .managedClass(Customer.class)
                .createEntityManagerFactory();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="entitymanagerfactory-interface"><a class="anchor" href="#entitymanagerfactory-interface"></a>7.4. EntityManagerFactory Interface</h3>
<div class="paragraph">
<p>The <code>EntityManagerFactory</code> interface found in <a href="#_entitymanagerfactory_">Section B.3</a></p>
</div>
<div class="paragraph">
<p>An <code>EntityManagerFactory</code> may be used
by the application to obtain an application-managed entity manager. When
the application has finished using the entity manager factory, and/or at
application shutdown, the application should close the entity manager
factory. Once an entity manager factory has been closed, all its entity
managers are considered to be in the closed state.</p>
</div>
<div class="paragraph">
<p>An <code>EntityManagerFactory</code> also provides
access to information and services that are global to the persistence
unit. This includes access to the second level cache that is maintained
by the persistence provider and to the <code>PersistenceUnitUtil</code> interface.
The <code>Cache</code> interface is described in <a href="#a12124">Section 3.10.3</a>; the
<code>PersistenceUnitUtil</code> interface in <a href="#a12177">Section 7.11</a>.</p>
</div>
<div class="paragraph">
<p>Any number of vendor-specific properties may
be included in the map passed to the <code>createEntityManager</code> methods.
Properties that are not recognized by a vendor must be ignored.</p>
</div>
<div class="paragraph">
<p>Note that the policies of the installation
environment may restrict some information from being made available
through the <code>EntityManagerFactory</code> <code>getProperties</code> method (for example,
JDBC user, password, URL).</p>
</div>
<div class="paragraph">
<p>Vendors should use vendor namespaces for
properties (e.g., <code>com.acme.persistence.logging</code>). Entries that make
use of the namespace <code>jakarta.persistence</code> and its subnamespaces must not
be used for vendor-specific information. The namespace
<code>jakarta.persistence</code> is reserved for use by this specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="controlling-transactions"><a class="anchor" href="#controlling-transactions"></a>7.5. Controlling Transactions</h3>
<div class="paragraph">
<p>Depending on the transactional type of the
entity manager, transactions involving EntityManager operations may be
controlled either through JTA or through use of the resource-local
<code>EntityTransaction</code> API, which is mapped to a resource transaction over
the resource that underlies the entities managed by the entity manager.</p>
</div>
<div class="paragraph">
<p>An entity manager whose underlying
transactions are controlled through JTA is termed a <em>JTA entity manager</em>.</p>
</div>
<div class="paragraph">
<p>An entity manager whose underlying
transactions are controlled by the application through the
<code>EntityTransaction</code> API is termed a <em>resource-local entity manager</em>.</p>
</div>
<div class="paragraph">
<p>A container-managed entity manager must be a
JTA entity manager. JTA entity managers are only specified for use in
Jakarta EE containers.</p>
</div>
<div class="paragraph">
<p>An application-managed entity manager may be
either a JTA entity manager or a resource-local entity manager.</p>
</div>
<div class="paragraph">
<p>An entity manager is defined to be of a given
transactional typeeither JTA or resource-localat the time its
underlying entity manager factory is configured and created. See
sections <a href="#a12296">Section 8.2.1.2</a> and <a href="#a12802">Section 9.1</a>.</p>
</div>
<div class="paragraph">
<p>Both JTA entity managers and resource-local
entity managers are required to be supported in Jakarta EE web containers
and EJB containers. Within an EJB environment, a JTA entity manager is
typically used. In general, in Java SE environments only resource-local
entity managers are supported.</p>
</div>
<div class="sect3">
<h4 id="jta-entitymanagers"><a class="anchor" href="#jta-entitymanagers"></a>7.5.1. JTA EntityManagers</h4>
<div class="paragraph">
<p>An entity manager whose transactions are
controlled through JTA is a JTA entity manager. In general, a JTA entity
manager participates in the current JTA transaction, which is begun and
committed external to the entity manager and propagated to the
underlying resource manager.</p>
</div>
</div>
<div class="sect3">
<h4 id="resource-local-entitymanagers"><a class="anchor" href="#resource-local-entitymanagers"></a>7.5.2. Resource-local EntityManagers</h4>
<div class="paragraph">
<p>An entity manager whose transactions are
controlled by the application through the <code>EntityTransaction</code> API is a
resource-local entity manager. A resource-local entity manager
transaction is mapped to a resource transaction over the resource by the
persistence provider. Resource-local entity managers may use server or
local resources to connect to the database and are unaware of the
presence of JTA transactions that may or may not be active.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-entitytransaction-interface"><a class="anchor" href="#the-entitytransaction-interface"></a>7.5.3. The EntityTransaction Interface</h4>
<div class="paragraph">
<p>The <code>EntityTransaction</code> interface found in <a href="#_entitytransaction_">Section B.2</a>
is used to control resource transactions on resource-local entity
managers. The <code>getTransaction()</code> method of <code>EntityManager</code> returns
an instance of the <code>EntityTransaction</code> interface.</p>
</div>
<div class="paragraph">
<p>When a resource-local entity manager is used,
and the persistence provider runtime throws an exception defined to
cause transaction rollback, the persistence provider must mark the
transaction for rollback.</p>
</div>
<div class="paragraph">
<p>If the <code>EntityTransaction.commit</code> operation
fails, the persistence provider must roll back the transaction.</p>
</div>
<div class="paragraph">
<p>The following example illustrates the
creation of an entity manager factory in a Java SE environment, and its
use in creating and using a resource-local entity manager.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">PasswordChanger</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main (<span class="predefined-type">String</span><span class="type">[]</span> args) {
        EntityManagerFactory emf =
            Persistence.createEntityManagerFactory(<span class="string"><span class="delimiter">&quot;</span><span class="content">Order</span><span class="delimiter">&quot;</span></span>);
        EntityManager em = emf.createEntityManager();
        em.getTransaction().begin();

        User user = em.createQuery
            (<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT u FROM User u WHERE u.name=:name AND u.pass=:pass</span><span class="delimiter">&quot;</span></span>, User.class)
            .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, args[<span class="integer">0</span>])
            .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>, args[<span class="integer">1</span>])
            .getSingleResult();

        user.setPassword(args[<span class="integer">2</span>]);

        em.getTransaction().commit();
        em.close();
        emf.close();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-runintransaction-and-callintransaction-methods"><a class="anchor" href="#the-runintransaction-and-callintransaction-methods"></a>7.6. The runInTransaction and callInTransaction methods</h3>
<div class="paragraph">
<p>The <code>runInTransaction</code> and <code>callInTransaction</code> methods of the
<code>EntityManagerFactory</code> provide a shortcut for persistence context
and transaction management with an application-managed <code>EntityManager</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">entityManagerFactory.runInTransaction(entityManager -&gt; {
    User user = em.createQuery
        (<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT u FROM User u WHERE u.name=:name AND u.pass=:pass</span><span class="delimiter">&quot;</span></span>, User.class)
        .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, args[<span class="integer">0</span>])
        .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>, args[<span class="integer">1</span>])
        .getSingleResult();

    user.setPassword(args[<span class="integer">2</span>]);
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The argument function passed to <code>runInTransaction</code> or
<code>callInTransaction</code> must be called and passed a new instance of
<code>EntityManager</code>. When the argument function returns or throws an
exception, this <code>EntityManager</code> must be closed before <code>runInTransaction</code>
or <code>callInTransaction</code> returns.</p>
</div>
<div class="paragraph">
<p>The argument function is executed in the context of a transaction
associated with this new <code>EntityManager</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the transaction type of the persistence unit is JTA, and there
is a JTA transaction already associated with the caller, then the
<code>EntityManager</code> is associated with this current transaction. If the
argument function throws an exception, the JTA transaction must be
marked for rollback, and the exception must be rethrown by
<code>runInTransaction</code> or <code>callInTransaction</code>.  Otherwise,
<code>callInTransaction</code> must return the same value returned by the
argument function.</p>
</li>
<li>
<p>Otherwise, if the transaction type of the persistence unit is
resource-local, or if there is no JTA transaction already associated
with the caller, then the <code>EntityManager</code> is associated with a new
transaction. If the argument function throws an exception, this
transaction must be rolled back, and then the exception must be
rethrown by <code>runInTransaction</code> or <code>callInTransaction</code>. If the argument
function returns, then <code>runInTransaction</code> or <code>callInTransaction</code> must
attempt to commit the transaction. If the attempt to commit the
transaction fails, the exception must be rethrown. Otherwise,
<code>callInTransaction</code> must return the same value returned by the argument
function.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application should not attempt to manage the lifecycle of the
transaction or <code>EntityManager</code> directly. If the application calls an
operation of <code>EntityTransaction</code> from within a call to <code>runInTransaction</code>
or <code>callInTransaction</code>, the behavior is undefined.</p>
</div>
</div>
<div class="sect2">
<h3 id="a11791"><a class="anchor" href="#a11791"></a>7.7. Container-managed Persistence Contexts</h3>
<div class="paragraph">
<p>When a container-managed entity manager is
used, the lifecycle of the persistence context is always managed
automatically, transparently to the application, and the persistence
context is propagated with the JTA transaction.</p>
</div>
<div class="paragraph">
<p>A container-managed persistence context may
be defined to have either a lifetime that is scoped to a single
transaction or an extended lifetime that spans multiple transactions,
depending on the <code>PersistenceContextType</code> that is specified when its
entity manager is created. This specification refers to such persistence
contexts as <em>transaction-scoped persistence contexts</em> and <em>extended
persistence contexts</em> respectively.</p>
</div>
<div class="paragraph">
<p>The lifetime of the persistence context is
declared using the <code>PersistenceContext</code> annotation or the
<code>persistence-context-ref</code> deployment descriptor element. By default, a
transaction-scoped persistence context is used.</p>
</div>
<div class="paragraph">
<p>Sections <a href="#a11805">Section 7.7.2</a> and <a href="#a11810">Section 7.7.3</a> describe transaction-scoped and extended persistence contexts
in the absence of persistence context propagation. Persistence context
propagation is described in <a href="#a11816">Section 7.7.4</a>.</p>
</div>
<div class="paragraph">
<p>Persistence contexts are always associated
with an entity manager factory. In the following sections, the
persistence context should be understood to mean the persistence
context associated with a particular entity manager factory.</p>
</div>
<div class="sect3">
<h4 id="a11797"><a class="anchor" href="#a11797"></a>7.7.1. Persistence Context Synchronization Type</h4>
<div class="paragraph">
<p>By default, a container-managed persistence
context is of type <code>SynchronizationType.SYNCHRONIZED</code>. Such a
persistence context is automatically joined to the current JTA
transaction, and updates made to the persistence context are propagated
to the underlying resource manager.</p>
</div>
<div class="paragraph">
<p>A container-managed persistence context may
be specified to be of type <code>SynchronizationType.UNSYNCHRONIZED</code>. A
persistence context of type <code>SynchronizationType.UNSYNCHRONIZED</code> is not
enlisted in any JTA transaction unless explicitly joined to that
transaction by the application. A persistence context of type
<code>SynchronizationType.UNSYNCHRONIZED</code> is enlisted in a JTA transaction
and registered for subsequent transaction notifications against that
transaction by the invocation of the <code>EntityManager</code> <code>joinTransaction</code>
method. The persistence context remains joined to the transaction until
the transaction commits or rolls back. After the transaction commits or
rolls back, the persistence context will not be joined to any subsequent
transaction unless the <code>joinTransaction</code> method is invoked in the scope
of that subsequent transaction.</p>
</div>
<div class="paragraph">
<p>A persistence context of type
<code>SynchronizationType.UNSYNCHRONIZED</code> must not be flushed to the database
unless it is joined to a transaction. The application&#8217;s use of queries
with pessimistic locks, bulk update or delete queries, etc. result in
the provider throwing the <code>TransactionRequiredException</code>. After the
persistence context has been joined to the JTA transaction, these
operations are again allowed.</p>
</div>
<div class="paragraph">
<p>The application is permitted to invoke the
persist, merge, remove, and refresh entity lifecycle operations on an
entity manager of type <code>SynchronizationType.UNSYNCHRONIZED</code> independent
of whether the persistence context is joined to the current transaction.
After the persistence context has been joined to a transaction, changes
in a persistence context can be flushed to the database either
explicitly by the application or by the provider. If the <code>flush</code> method
is not explicitly invoked, the persistence provider may defer flushing
until commit time depending on the operations invoked and the flush mode
setting in effect.</p>
</div>
<div class="paragraph">
<p>If an extended persistence context of type
<code>SynchronizationType.UNSYNCHRONIZED</code> has not been joined to the current
JTA transaction, rollback of the JTA transaction will have no effect
upon the persistence context. In general, it is recommended that a
non-JTA datasource be specified for use by the persistence provider for
a persistence context of type <code>SynchronizationType.UNSYNCHRONIZED</code> that
has not been joined to a JTA transaction in order to alleviate the risk
of integrating uncommitted changes into the persistence context in the
event that the transaction is later rolled back.</p>
</div>
<div class="paragraph">
<p>If a persistence context of type
<code>SynchronizationType.UNSYNCHRONIZED</code> has been joined to the JTA
transaction, transaction rollback will cause the persistence context to
be cleared and all pre-existing managed and removed instances to become
detached. (See <a href="#a2049">Section 3.4.3</a>.)</p>
</div>
<div class="paragraph">
<p>When a JTA transaction exists, a persistence
context of type <code>SynchronizationType.UNSYNCHRONIZED</code> is propagated with
that transaction according to the rules in <a href="#a11820">Section 7.7.4.1</a> regardless of whether the persistence context has been
joined to that transaction.</p>
</div>
</div>
<div class="sect3">
<h4 id="a11805"><a class="anchor" href="#a11805"></a>7.7.2. Container-managed Transaction-scoped Persistence Context</h4>
<div class="paragraph">
<p>The application can obtain a
container-managed entity manager with transaction-scoped persistence
context by injection or direct lookup in the JNDI namespace. The
persistence context type for the entity manager is defaulted or defined
as <code>PersistenceContextType.TRANSACTION</code>.</p>
</div>
<div class="paragraph">
<p>A new persistence context begins when the
container-managed entity manager is invoked<sup class="footnote">[<a id="_footnoteref_90" class="footnote" href="#_footnotedef_90" title="View footnote.">90</a>]</sup> in
the scope of an active JTA transaction, and there is no current
persistence context already associated with the JTA transaction. The
persistence context is created and then associated with the JTA
transaction. This association of the persistence context with the JTA
transaction is independent of the synchronization type of the
persistence context and whether the persistence context has been joined
to the transaction.</p>
</div>
<div class="paragraph">
<p>The persistence context ends when the
associated JTA transaction commits or rolls back, and all entities that
were managed by the EntityManager become detached.<sup class="footnote">[<a id="_footnoteref_91" class="footnote" href="#_footnotedef_91" title="View footnote.">91</a>]</sup></p>
</div>
<div class="paragraph">
<p>If the entity manager is invoked outside the
scope of a transaction, any entities loaded from the database will
immediately become detached at the end of the method call.</p>
</div>
</div>
<div class="sect3">
<h4 id="a11810"><a class="anchor" href="#a11810"></a>7.7.3. Container-managed Extended Persistence Context</h4>
<div class="paragraph">
<p>A container-managed extended persistence
context can only be initiated within the scope of a stateful session
bean. It exists from the point at which the stateful session bean that
declares a dependency on an entity manager of type
<code>PersistenceContextType.EXTENDED</code> is created, and is said to be <code>bound</code>
to the stateful session bean. The dependency on the extended persistence
context is declared by means of the <code>PersistenceContext</code> annotation or
<code>persistence-context-ref</code> deployment descriptor element. The association
of the extended persistence context with the JTA transaction is
independent of the synchronization type of the persistence context and
whether the persistence context has been joined to the transaction.</p>
</div>
<div class="paragraph">
<p>The persistence context is closed by the
container when the <code>@Remove</code> method of the stateful session bean
completes (or the stateful session bean instance is otherwise
destroyed).</p>
</div>
<div class="sect4">
<h5 id="inheritance-of-extended-persistence-context"><a class="anchor" href="#inheritance-of-extended-persistence-context"></a>7.7.3.1. Inheritance of Extended Persistence Context</h5>
<div class="paragraph">
<p>If a stateful session bean instantiates a
stateful session bean (executing in the same EJB container instance)
which also has such an extended persistence context with the same
synchronization type, the extended persistence context of the first
stateful session bean is inherited by the second stateful session bean
and bound to it, and this rule recursively appliesindependently of
whether transactions are active or not at the point of the creation of
the stateful session beans. If the stateful session beans differ in
declared synchronization type, the EJBException is thrown by the
container.</p>
</div>
<div class="paragraph">
<p>If the persistence context has been inherited
by any stateful session beans, the container does not close the
persistence context until all such stateful session beans have been
removed or otherwise destroyed.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a11816"><a class="anchor" href="#a11816"></a>7.7.4. Persistence Context Propagation</h4>
<div class="paragraph">
<p>As described in <a href="#a11432">Section 7.1</a>, a single
persistence context may correspond to one or more JTA entity manager
instances (all associated with the same entity manager
factory<sup class="footnote">[<a id="_footnoteref_92" class="footnote" href="#_footnotedef_92" title="View footnote.">92</a>]</sup>).</p>
</div>
<div class="paragraph">
<p>The persistence context is propagated across
the entity manager instances as the JTA transaction is propagated. A
persistence context of type <code>SynchronizationType.UNSYNCHRONIZED</code> is
propagated with the JTA transaction regardless of whether it has been
joined to the transaction.</p>
</div>
<div class="paragraph">
<p>Propagation of persistence contexts only
applies within a local environment. Persistence contexts are not
propagated to remote tiers.</p>
</div>
<div class="sect4">
<h5 id="a11820"><a class="anchor" href="#a11820"></a>7.7.4.1. Requirements for Persistence Context Propagation</h5>
<div class="paragraph">
<p>Persistence contexts are propagated by the
container across component invocations as follows.</p>
</div>
<div class="paragraph">
<p>If a component is called and there is no JTA
transaction or the JTA transaction is not propagated, the persistence
context is not propagated.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If an entity manager is then invoked from
within the component:</p>
<div class="ulist">
<ul>
<li>
<p>Invocation of an entity manager defined with
<code>PersistenceContextType.TRANSACTION</code> will result in use of a new
persistence context (as described in <a href="#a11805">Section 7.7.2</a>).</p>
</li>
<li>
<p>Invocation of an entity manager defined with
<code>PersistenceContextType.EXTENDED</code> will result in the use of the existing
extended persistence context bound to that component.</p>
</li>
<li>
<p>If the entity manager is invoked within a JTA
transaction, the persistence context will be associated with the JTA
transaction.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a component is called and the JTA
transaction is propagated into that component:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the component is a stateful session bean
to which an extended persistence context has been bound and there is a
different persistence context associated with the JTA transaction, an
<code>EJBException</code> is thrown by the container.</p>
</li>
<li>
<p>If there is a persistence context of type
<code>SynchronizationType.UNSYNCHRONIZED</code> associated with the JTA transaction
and the target component specifies a persistence context of type
<code>SynchronizationType.SYNCHRONIZED</code>, the <code>IllegalStateException</code> is
thrown by the container.</p>
</li>
<li>
<p>Otherwise, if there is a persistence context
associated with the JTA transaction, that persistence context is
propagated and used.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that a component with a persistence
context of type <code>SynchronizationType.UNSYNCHRONIZED</code> may be called by a
component propagating either a persistence context of type
<code>SynchronizationType.UNSYNCHRONIZED</code> or a persistence context of type
<code>SynchronizationType.SYNCHRONIZED</code> into it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example shows a container-managed, transaction-scoped
persistence context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceContext</span>
    EntityManager em;

    <span class="directive">public</span> Order getOrder(<span class="predefined-type">Long</span> id) {
        Order order = em.find(Order.class, id);
        order.getLineItems();
        <span class="keyword">return</span> order;
    }

    <span class="directive">public</span> Product getProduct(<span class="predefined-type">String</span> name) {
        <span class="keyword">return</span> (Product) em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = : name</span><span class="delimiter">&quot;</span></span>)
               .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
               .getSingleResult();
    }

    <span class="directive">public</span> LineItem createLineItem(Order order, Product product, <span class="type">int</span> quantity) {
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        <span class="keyword">return</span> li;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example shows a container-managed extended persistence context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/*
 * An extended transaction context is used. The entities remain
 * managed in the persistence context across multiple transactions.
 */</span>
<span class="annotation">@Stateful</span>
<span class="annotation">@Transaction</span>(REQUIRES_NEW)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceContext</span>(type = EXTENDED)
    EntityManager em;

    <span class="directive">private</span> Order order;
    <span class="directive">private</span> Product product;

    <span class="directive">public</span> <span class="type">void</span> initOrder(<span class="predefined-type">Long</span> id) {
        order = em.find(Order.class, id);
    }

    <span class="directive">public</span> <span class="type">void</span> initProduct(<span class="predefined-type">String</span> name) {
        product = (Product) em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = : name</span><span class="delimiter">&quot;</span></span>)
                  .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                  .getSingleResult();
    }

    <span class="directive">public</span> LineItem createLineItem(<span class="type">int</span> quantity) {
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        <span class="keyword">return</span> li;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11894"><a class="anchor" href="#a11894"></a>7.8. Application-managed Persistence Contexts</h3>
<div class="paragraph">
<p>When an application-managed entity manager is
used, the application interacts directly with the persistence provider&#8217;s
entity manager factory to manage the entity manager lifecycle and to
obtain and destroy persistence contexts.</p>
</div>
<div class="paragraph">
<p>All such application-managed persistence
contexts are extended in scope, and can span multiple transactions.</p>
</div>
<div class="paragraph">
<p>The <code>EntityManagerFactory</code> .
<code>createEntityManager</code> method and the <code>EntityManager</code> <code>close</code> and
<code>isOpen</code> methods are used to manage the lifecycle of an
application-managed entity manager and its associated persistence
context.</p>
</div>
<div class="paragraph">
<p>The extended persistence context exists from
the point at which the entity manager has been created using
<code>EntityManagerFactory.createEntityManager</code> until the entity manager is
closed by means of <code>EntityManager.close</code>.</p>
</div>
<div class="paragraph">
<p>An extended persistence context obtained from
the application-managed entity manager is a stand-alone persistence
contextit is not propagated with the transaction.</p>
</div>
<div class="paragraph">
<p>When a JTA application-managed entity manager
is used, an application-managed persistence context may be specified to
be of type <code>SynchronizationType.UNSYNCHRONIZED</code>. A persistence context
of type <code>SynchronizationType.UNSYNCHRONIZED</code> is not enlisted in any JTA
transaction unless explicitly joined to that transaction by the
application. A persistence context of type
<code>SynchronizationType.UNSYNCHRONIZED</code> is enlisted in a JTA transaction
and registered for subsequent transaction notifications against that
transaction by the invocation of the <code>EntityManager</code> <code>joinTransaction</code>
method. The persistence context remains joined to the transaction until
the transaction commits or rolls back. After the transaction commits or
rolls back, the persistence context will not be joined to any subsequent
transaction unless the <code>joinTransaction</code> method is invoked in the scope
of that subsequent transaction.</p>
</div>
<div class="paragraph">
<p>When a JTA application-managed entity manager
is used, if the entity manager is created outside the scope of the
current JTA transaction, it is the responsibility of the application to
join the entity manager to the transaction (if desired) by calling
<code>EntityManager.joinTransaction</code>. If the entity manager is created
outside the scope of a JTA transaction, it is not joined to the
transaction unless <code>EntityManager.joinTransaction</code> is called.</p>
</div>
<div class="paragraph">
<p>The <code>EntityManager.close</code> method closes an
entity manager to release its persistence context and other resources.
After calling <code>close</code>, the application must not invoke any further
methods on the <code>EntityManager</code> instance except for <code>getTransaction</code> and
<code>isOpen</code>, or the <code>IllegalStateException</code> will be thrown. If the <code>close</code>
method is invoked when a transaction is active, the persistence context
remains managed until the transaction completes.</p>
</div>
<div class="paragraph">
<p>The <code>EntityManager.isOpen</code> method indicates
whether the entity manager is open. The <code>isOpen</code> method returns true
until the entity manager has been closed.</p>
</div>
<div class="paragraph">
<p>This example shows an application-managed persistence context used in
a stateless session bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/*
 * Container-managed transaction demarcation is used.
 * The session bean creates and closes an entity manager
 * in each business method.
 */</span>
<span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceUnit</span>
    <span class="directive">private</span> EntityManagerFactory emf;

    <span class="directive">public</span> Order getOrder(<span class="predefined-type">Long</span> id) {
        EntityManager em = emf.createEntityManager();
        Order order = em.find(Order.class, id);
        order.getLineItems();
        em.close();
        <span class="keyword">return</span> order;
    }

    <span class="directive">public</span> Product getProduct() {
        EntityManager em = emf.createEntityManager();
        Product product = (Product)
                          em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = :name</span><span class="delimiter">&quot;</span></span>)
                          .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                          .getSingleResult();
        em.close();
        <span class="keyword">return</span> product;
    }

    <span class="directive">public</span> LineItem createLineItem(Order order, Product product, <span class="type">int</span> quantity) {
        EntityManager em = emf.createEntityManager();
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        em.close();
        <span class="keyword">return</span> li; <span class="comment">// remains managed until JTA transaction ends</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This examples shows an application-managed persistence context used in
a stateless session bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/*
 * Container-managed transaction demarcation is used.
 * The session bean creates entity manager in PostConstruct
 * method and clears persistence context at the end of each
 * business method.
 */</span>
<span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceUnit</span>
    <span class="directive">private</span> EntityManagerFactory emf;

    <span class="directive">private</span> EntityManager em;

    <span class="annotation">@PostConstruct</span>
    <span class="directive">public</span> <span class="type">void</span> init() {
        em = emf.createEntityManager();
    }

    <span class="directive">public</span> Order getOrder(<span class="predefined-type">Long</span> id) {
        Order order = em.find(Order.class, id);
        order.getLineItems();
        em.clear(); <span class="comment">// entities are detached</span>
        <span class="keyword">return</span> order;
    }

    <span class="directive">public</span> Product getProduct() {
        Product product = (Product)
                          em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = :name</span><span class="delimiter">&quot;</span></span>)
                          .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                          .getSingleResult();
        em.clear();
        <span class="keyword">return</span> product;
    }

    <span class="directive">public</span> LineItem createLineItem(Order order, Product product, <span class="type">int</span> quantity) {
        em.joinTransaction();
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        <span class="comment">// persistence context is flushed to database;</span>
        <span class="comment">// all updates will be committed to database on tx commit</span>
        em.flush();
        <span class="comment">// entities in persistence context are detached</span>
        em.clear();
        <span class="keyword">return</span> li;
    }

    <span class="annotation">@PreDestroy</span>
    <span class="directive">public</span> <span class="type">void</span> destroy() {
        em.close();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example shows an application-managed persistence context used in
a stateful session bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/*
 * Container-managed transaction demarcation is used.
 * Entities remain managed until the entity manager is closed.
 */</span>
<span class="annotation">@Stateful</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceUnit</span>
    <span class="directive">private</span> EntityManagerFactory emf;

    <span class="directive">private</span> EntityManager em;

    <span class="directive">private</span> Order order;

    <span class="directive">private</span> Product product;

    <span class="annotation">@PostConstruct</span>
    <span class="directive">public</span> <span class="type">void</span> init() {
        em = emf.createEntityManager();
    }

    <span class="directive">public</span> <span class="type">void</span> initOrder(<span class="predefined-type">Long</span> id) {
        order = em.find(Order.class, id);
    }

    <span class="directive">public</span> <span class="type">void</span> initProduct(<span class="predefined-type">String</span> name) {
        product = (Product) em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = : name</span><span class="delimiter">&quot;</span></span>)
                  .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                  .getSingleResult();
    }

    <span class="directive">public</span> LineItem createLineItem(<span class="type">int</span> quantity) {
        em.joinTransaction();
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        <span class="keyword">return</span> li;
    }

    <span class="annotation">@Remove</span>
    <span class="directive">public</span> <span class="type">void</span> destroy() {
        em.close();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, this example shows an application-managed persistence context
used with a resource transaction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Usage in an ordinary Java class</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingImpl</span> {
    <span class="directive">private</span> EntityManager em;
    <span class="directive">private</span> EntityManagerFactory emf;

    <span class="directive">public</span> ShoppingCart() {
        emf = Persistence.createEntityManagerFactory(<span class="string"><span class="delimiter">&quot;</span><span class="content">orderMgt</span><span class="delimiter">&quot;</span></span>);
        em = emf.createEntityManager();
    }

    <span class="directive">private</span> Order order;
    <span class="directive">private</span> Product product;

    <span class="directive">public</span> <span class="type">void</span> initOrder(<span class="predefined-type">Long</span> id) {
        order = em.find(Order.class, id);
    }

    <span class="directive">public</span> <span class="type">void</span> initProduct(<span class="predefined-type">String</span> name) {
        product = (Product) em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = : name</span><span class="delimiter">&quot;</span></span>)
                  .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                  .getSingleResult();
    }

    <span class="directive">public</span> LineItem createLineItem(<span class="type">int</span> quantity) {
        em.getTransaction().begin();
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        em.getTransaction().commit();
        <span class="keyword">return</span> li;
    }

    <span class="directive">public</span> <span class="type">void</span> destroy() {
        em.close();
        emf.close();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="requirements-on-the-container"><a class="anchor" href="#requirements-on-the-container"></a>7.9. Requirements on the Container</h3>
<div class="sect3">
<h4 id="application-managed-persistence-contexts"><a class="anchor" href="#application-managed-persistence-contexts"></a>7.9.1. Application-managed Persistence Contexts</h4>
<div class="paragraph">
<p>When application-managed persistence contexts
are used, the container must instantiate the entity manager factory and
expose it to the application via JNDI. The container might use internal
APIs to create the entity manager factory, or it might use the
<code>PersistenceProvider.createContainerEntityManagerFactory</code> method.
However, the container is required to support third-party persistence
providers, and in this case the container must use the
<code>PersistenceProvider.createContainerEntityManagerFactory</code> method to
create the entity manager factory and the <code>EntityManagerFactory.close</code>
method to destroy the entity manager factory prior to shutdown (if it
has not been previously closed by the application).</p>
</div>
</div>
<div class="sect3">
<h4 id="container-managed-persistence-contexts"><a class="anchor" href="#container-managed-persistence-contexts"></a>7.9.2. Container Managed Persistence Contexts</h4>
<div class="paragraph">
<p>The container is responsible for managing the
lifecycle of container-managed persistence contexts, for injecting
<code>EntityManager</code> references into web components and session bean and
message-driven bean components, and for making <code>EntityManager</code>
references available to direct lookups in JNDI.</p>
</div>
<div class="paragraph">
<p>When operating with a third-party persistence
provider, the container uses the contracts defined in <a href="#a12100">Section 7.10</a>
to create and destroy container-managed
persistence contexts. It is undefined whether a new entity manager
instance is created for every persistence context, or whether entity
manager instances are sometimes reused. Exactly how the container
maintains the association between persistence context and JTA
transaction is not defined.</p>
</div>
<div class="paragraph">
<p>If a persistence context is already
associated with a JTA transaction, the container uses that persistence
context for subsequent invocations within the scope of that transaction,
according to the semantics for persistence context propagation defined
in <a href="#a11816">Section 7.7.4</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a12100"><a class="anchor" href="#a12100"></a>7.10. Runtime Contracts between the Container and Persistence Provider</h3>
<div class="paragraph">
<p>This section describes contracts
between the container and the persistence provider for the pluggability
of third-party persistence providers. Containers are required to support
these pluggability contracts.<sup class="footnote">[<a id="_footnoteref_93" class="footnote" href="#_footnotedef_93" title="View footnote.">93</a>]</sup></p>
</div>
<div class="sect3">
<h4 id="container-responsibilities"><a class="anchor" href="#container-responsibilities"></a>7.10.1. Container Responsibilities</h4>
<div class="paragraph">
<p>For the management of a transaction-scoped
persistence context, if there is no EntityManager already associated
with the JTA transaction:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The container creates a new entity manager by
calling <code>EntityManagerFactory.createEntityManager</code> when the first
invocation of an entity manager with
<code>PersistenceContextType.TRANSACTION</code> occurs within the scope of a
business method executing in the JTA transaction.</p>
</li>
<li>
<p>After the JTA transaction has completed
(either by transaction commit or rollback), the container closes the
entity manager by calling <code>EntityManager.close</code>.
<sup class="footnote">[<a id="_footnoteref_94" class="footnote" href="#_footnotedef_94" title="View footnote.">94</a>]</sup>
Note that the JTA transaction may rollback in a
background thread (e.g., as a result of transaction timeout), in which
case the container should arrange for the entity manager to be closed
but the <code>EntityManager.close</code> method should not be concurrently invoked
while the application is in an EntityManager invocation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The container must throw the
<code>TransactionRequiredException</code> if a transaction-scoped persistence
context is used and the <code>EntityManager</code> <code>persist</code>, <code>remove</code>, <code>merge</code>,
or <code>refresh</code> method is invoked when no transaction is active.</p>
</div>
<div class="paragraph">
<p>For stateful session beans with extended
persistence contexts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The container creates an entity manager by
calling <code>EntityManagerFactory.createEntityManager</code> when a stateful
session bean is created that declares a dependency on an entity manager
with <code>PersistenceContextType.EXTENDED</code>. (See <a href="#a11810">Section 7.7.3</a>).</p>
</li>
<li>
<p>The container closes the entity manager by
calling <code>EntityManager.close</code> after the stateful session bean and all
other stateful session beans that have inherited the same persistence
context as the entity manager have been removed.</p>
</li>
<li>
<p>When a business method of the stateful
session bean is invoked, if the stateful session bean uses container
managed transaction demarcation, and the entity manager is not already
associated with the current JTA transaction, the container associates
the entity manager with the current JTA transaction and, if the
persistence context is of type <code>SynchronizationType.SYNCHRONIZED</code>, the
container calls <code>EntityManager.joinTransaction</code>. If there is a
different persistence context already associated with the JTA
transaction, the container throws the <code>EJBException</code>.</p>
</li>
<li>
<p>When a business method of the stateful
session bean is invoked, if the stateful session bean uses bean managed
transaction demarcation and a UserTransaction is begun within the
method, the container associates the persistence context with the JTA
transaction and, if the persistence context is of type
<code>SynchronizationType.SYNCHRONIZED</code>, the container calls
<code>EntityManager.joinTransaction</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The container must throw the
<code>IllegalStateException</code> if the application calls <code>EntityManager.close</code>
on a container-managed entity manager.</p>
</div>
<div class="paragraph">
<p>When the container creates an entity manager,
it may pass a map of properties to the persistence provider by using the
<code>EntityManagerFactory.createEntityManager(Map map)</code> method. If
properties have been specified in the <code>PersistenceContext</code> annotation or
the <code>persistence-context-ref</code> deployment descriptor element, this method
must be used and the map must include the specified properties.</p>
</div>
<div class="paragraph">
<p>If the application invokes
<code>EntityManager.unwrap(Class&lt;T&gt; cls)</code>, and the container cannot satisfy
the request, the container must delegate the <code>unwrap</code> invocation to the
provider&#8217;s entity manager instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="provider-responsibilities"><a class="anchor" href="#provider-responsibilities"></a>7.10.2. Provider Responsibilities</h4>
<div class="paragraph">
<p>The Provider has no knowledge of the
distinction between transaction-scoped and extended persistence
contexts. It provides entity managers to the container when requested
and registers for transaction synchronization notifications.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When
<code>EntityManagerFactory.createEntityManager</code> is invoked, the provider must
create and return a new entity manager. If a JTA transaction is active
and the persistence context is of type
<code>SynchronizationType.SYNCHRONIZED</code>, the provider must register for
synchronization notifications against the JTA transaction.</p>
</li>
<li>
<p>When <code>EntityManager.joinTransaction</code> is
invoked, the provider must register for synchronization notifications
against the current JTA transaction if a previous <code>joinTransaction</code>
invocation for the transaction has not already been processed.</p>
</li>
<li>
<p>When the JTA transaction commits, if the
persistence context is of type <code>SynchronizationType.SYNCHRONIZED</code> or has
otherwise been joined to the transaction, the provider must flush all
modified entity state to the database.</p>
</li>
<li>
<p>When the JTA transaction rolls back, the
provider must detach all managed entities if the persistence context is
of type <code>SynchronizationType.SYNCHRONIZED</code> or has otherwise been joined
to the transaction. Note that the JTA transaction may rollback in a
background thread (e.g., as a result of transaction timeout), in which
case the provider should arrange for the managed entities to be detached
from the persistence context but not concurrently while the application
is in an EntityManager invocation.</p>
</li>
<li>
<p>When the provider throws an exception defined
to cause transaction rollback, the provider must mark the transaction
for rollback if the persistence context is of type
<code>SynchronizationType.SYNCHRONIZED</code> or has otherwise been joined to the
transaction.</p>
</li>
<li>
<p>When <code>EntityManager.close</code> is invoked, the
provider should release all resources that it may have allocated after
any outstanding transactions involving the entity manager have
completed. If the entity manager was already in a closed state, the
provider must throw the <code>IllegalStateException</code>.</p>
</li>
<li>
<p>When <code>EntityManager.clear</code> is invoked, the
provider must detach all managed entities.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a12177"><a class="anchor" href="#a12177"></a>7.11. PersistenceUnitUtil Interface</h3>
<div class="paragraph">
<p>The <code>PersistenceUnitUtil</code> interface found in <a href="#_persistenceunitutil_">Section B.20</a>
declares utility methods that can be invoked on entities associated
with the persistence unit. The behavior is undefined if these methods
are invoked on an entity instance that is not associated with the
persistence unit from whose entity manager factory this interface has
been obtained.</p>
</div>
</div>
<div class="sect2">
<h3 id="a12178"><a class="anchor" href="#a12178"></a>7.12. SchemaManager Interface</h3>
<div class="paragraph">
<p>The <code>SchemaManager</code> interface may be found in <a href="#_schemamanager_">Section B.16</a>.
An instance of <code>SchemaManager</code> may be obtained by calling the
<code>getSchemaManager()</code> method of <code>EntityManagerFactory</code>.</p>
</div>
<div class="paragraph">
<p>The <code>SchemaManager</code> interface allows programmatic control over schema
generation and cleanup at runtime. This differs from the functionality
described in <a href="#a12917">Section 9.4</a> which allows schema generation before or during
the application deployment and initialization process. Similarly, the
<code>generateSchema</code> method described in <a href="#a12803">Section 9.2.1</a> is intended to be called
before the <code>EntityManagerFactory</code> is available. By contrast, an instance
of <code>SchemaManager</code> is only available after an <code>EntityManagerFactory</code> has
already been created.</p>
</div>
<div class="paragraph">
<p>For example, <code>SchemaManager</code> is especially useful in tests.</p>
</div>
<div class="paragraph">
<p>The methods of <code>SchemaManager</code> correspond to values of the property
<code>jakarta.persistence.schema-generation.scripts.action</code>. The methods
<code>create()</code>, <code>drop()</code>, and <code>validate()</code> correspond to the actions
<code>create</code>, <code>drop</code>, and <code>validate</code>. The method <code>truncate()</code> has no
corresponding action.</p>
</div>
<div class="paragraph">
<p>Thus, the behavior of the <code>SchemaManager</code> may be controlled via the
properties defined in <a href="#a12917">Section 9.4</a> and <a href="#a12384">Section 8.2.1.11</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a12229"><a class="anchor" href="#a12229"></a>8. Entity Packaging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the packaging of persistence units.</p>
</div>
<div class="sect2">
<h3 id="a12235"><a class="anchor" href="#a12235"></a>8.1. Persistence Unit</h3>
<div class="paragraph">
<p>A persistence unit is a logical grouping that includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an entity manager factory and its entity managers, together with
their configuration information,</p>
</li>
<li>
<p>the set of managed classes included in the persistence unit and
managed by entity managers created by the entity manager factory,
and</p>
</li>
<li>
<p>mapping metadata (in the form of metadata annotations and/or XML
metadata) specifying the mapping of these classes to the database.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="a12236"><a class="anchor" href="#a12236"></a>8.2. Persistence Unit Packaging</h3>
<div class="paragraph">
<p>Within Jakarta EE environments, any EJB-JAR, WAR, EAR, or application
client JAR can define a persistence unit. Any number of persistence
units may be defined within these scopes.</p>
</div>
<div class="paragraph">
<p>A persistence unit may be packaged:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>within one or more jar files contained within a WAR or EAR,</p>
</li>
<li>
<p>as a set of classes within an EJB-JAR file or in the WAR <code>classes</code>
directory, or</p>
</li>
<li>
<p>as a combination of these, as defined below.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A persistence unit is defined by a <code>persistence.xml</code> file. The jar file
or directory whose <code>META-INF</code> directory contains the <code>persistence.xml</code>
file is termed the <code>root</code> of the persistence unit. In Jakarta EE
environments, the root of a persistence unit must be either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an EJB-JAR file,</p>
</li>
<li>
<p>the <code>WEB-INF/classes</code> directory of a WAR file<sup class="footnote">[<a id="_footnoteref_95" class="footnote" href="#_footnotedef_95" title="View footnote.">95</a>]</sup>,</p>
</li>
<li>
<p>a jar file in the <code>WEB-INF/lib</code> directory of a WAR file,</p>
</li>
<li>
<p>a jar file in the library directory or an EAR, or</p>
</li>
<li>
<p>an application client JAR file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is not required that an EJB-JAR or WAR file containing a persistence
unit be packaged in an EAR unless the persistence unit contains extra
persistence classes in addition to those contained within the EJB-JAR or
WAR. See <a href="#a12305">Section 8.2.1.8</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Java Persistence 1.0 supported the use of a jar file in the root of the
EAR as the root of a persistence unit. This use is no longer supported.
Portable applications should use the EAR library directory for this case
instead. See <a href="#a19499">[6]</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A persistence unit must have a name. The name of the persistence unit must
be unique within a given EJB-JAR file, within a given WAR file, within a
given application client JAR, or within an EAR. See <a href="#a12459">Section 8.2.2</a>.</p>
</div>
<div class="paragraph">
<p>The <code>persistence.xml</code> file may be used to define more than one persistence
unit within the same scope.</p>
</div>
<div class="paragraph">
<p>All persistence classes defined at the level of the Jakarta EE EAR must be
accessible to other Jakarta EE components in the applicationthat is, to
all components loaded by the application classloadersuch that if the same
entity class is referenced by two different Jakarta EE components (which
may be using different persistence units), the referenced class is the same
identical class.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, the metadata mapping files, jar files, and classes
described in the following sections can be used. To insure the portability
of a Java SE application, it is necessary to explicitly list the managed
persistence classes included in the persistence unit using the <code>class</code>
element of the <code>persistence.xml</code> file. See <a href="#a12305">Section 8.2.1.8</a>.</p>
</div>
<div class="sect3">
<h4 id="a12237"><a class="anchor" href="#a12237"></a>8.2.1. persistence.xml file</h4>
<div class="paragraph">
<p>A <code>persistence.xml</code> file defines a persistence unit. The <code>persistence.xml</code>
file is located in the <code>META-INF</code> directory of the root of the persistence
unit. It may be used to specify:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>managed persistence classes included in the persistence unit,</p>
</li>
<li>
<p>object/relational mapping information for those classes,</p>
</li>
<li>
<p>scripts for use in schema generation and bulk loading of data, and</p>
</li>
<li>
<p>other configuration information for the persistence unit and for the
entity managers and entity manager factory of the persistence unit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This information may be defined by containment or by reference, as described
below.</p>
</div>
<div class="paragraph">
<p>The object/relational mapping information can take the form of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>annotations on the managed persistence classes included in the persistence
unit,</p>
</li>
<li>
<p>an <code>orm.xml</code> file contained in the <code>META-INF</code> directory of the root of the
persistence unit,</p>
</li>
<li>
<p>one or more XML files accessible on the classpath and referenced from the
<code>persistence.xml</code> file, or</p>
</li>
<li>
<p>any combination of the previous options.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The managed persistence classes may be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>contained within the root of the persistence unit,</p>
</li>
<li>
<p>specified by referencethat is, by naming the classes, class archives, or
XML mapping files (which in turn reference classes) that are accessible on
the application classpath, or</p>
</li>
<li>
<p>specified by any combination of these means.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a12305">Section 8.2.1.8</a>.</p>
</div>
<div class="paragraph">
<p>The root element of the <code>persistence.xml</code> file is the <code>persistence</code> element.
The <code>persistence</code> element consists of one or more <code>persistence-unit</code> elements.</p>
</div>
<div class="paragraph">
<p>The <code>persistence-unit</code> element consists of the <code>name</code> and <code>transaction-type</code>
attributes and the following sub-elements:
<code>description</code>, <code>provider</code>,
<code>jta-data-source</code>, <code>non-jta-data-source</code>,
<code>mapping-file</code>, <code>jar-file</code>, <code>class</code>,
<code>exclude-unlisted-classes</code>,
<code>shared-cache-mode</code>, <code>validation-mode</code>,
and <code>properties</code>.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is required; the other attributes and elements are optional.
Their semantics are described in the following subsections.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence&gt;</span>
    <span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;description&gt;</span>
            This unit manages orders and customers.
            It does not rely on any vendor-specific features and can
            therefore be deployed to any persistence provider.
        <span class="tag">&lt;/description&gt;</span>
        <span class="tag">&lt;jta-data-source&gt;</span>jdbc/MyOrderDB<span class="tag">&lt;/jta-data-source&gt;</span>
        <span class="tag">&lt;mapping-file&gt;</span>ormap.xml<span class="tag">&lt;/mapping-file&gt;</span>
        <span class="tag">&lt;jar-file&gt;</span>MyOrderApp.jar<span class="tag">&lt;/jar-file&gt;</span>
        <span class="tag">&lt;class&gt;</span>com.widgets.Order<span class="tag">&lt;/class&gt;</span>
        <span class="tag">&lt;class&gt;</span>com.widgets.Customer<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;/persistence-unit&gt;</span>
<span class="tag">&lt;/persistence&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence&gt;</span>
    <span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;description&gt;</span>
            This unit manages inventory for auto parts.
            It depends on features provided by the
            com.acme.persistence implementation.
        <span class="tag">&lt;/description&gt;</span>
        <span class="tag">&lt;provider&gt;</span>com.acme.AcmePersistence<span class="tag">&lt;/provider&gt;</span>
        <span class="tag">&lt;jta-data-source&gt;</span>jdbc/MyPartDB<span class="tag">&lt;/jta-data-source&gt;</span>
        <span class="tag">&lt;mapping-file&gt;</span>ormap2.xml<span class="tag">&lt;/mapping-file&gt;</span>
        <span class="tag">&lt;jar-file&gt;</span>MyPartsApp.jar<span class="tag">&lt;/jar-file&gt;</span>
        <span class="tag">&lt;properties&gt;</span>
            <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.acme.persistence.sql-logging</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">on</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/properties&gt;</span>
    <span class="tag">&lt;/persistence-unit&gt;</span>
<span class="tag">&lt;/persistence&gt;</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="name"><a class="anchor" href="#name"></a>8.2.1.1. name</h5>
<div class="paragraph">
<p>The <code>name</code> attribute defines the name of the persistence unit. This name is
used to identify the persistence unit referred to by a <code>PersistenceContext</code>
or <code>PersistenceUnit</code> annotation and in the programmatic API for creating an
entity manager factory.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12296"><a class="anchor" href="#a12296"></a>8.2.1.2. transaction-type</h5>
<div class="paragraph">
<p>The <code>transaction-type</code> attribute specifies whether entity managers created by
the entity manager factory for the persistence unit are JTA entity managers or
resource-local entity managers. The value of this element must be <code>JTA</code> or
<code>RESOURCE_LOCAL</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JTA</code> means that a JTA data source is providedeither as specified by the
<code>jta-data-source</code> element, or by the container.</p>
</li>
<li>
<p>In a Jakarta EE environment, <code>RESOURCE_LOCAL</code> usually means that a non-JTA
datasource is provided.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Configuration of datasources is described below in <a href="#a12302">Section 8.2.1.7</a>.</p>
</div>
<div class="paragraph">
<p>If the <code>transaction-type</code> is not explicitly specified, its value is defaulted:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in a Jakarta EE environment, the default is <code>JTA</code>, but</p>
</li>
<li>
<p>in a Java SE environment, the default is <code>RESOURCE_LOCAL</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="description"><a class="anchor" href="#description"></a>8.2.1.3. description</h5>
<div class="paragraph">
<p>The <code>description</code> element provides optional descriptive information about the
persistence unit.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12300"><a class="anchor" href="#a12300"></a>8.2.1.4. provider</h5>
<div class="paragraph">
<p>The <code>provider</code> element specifies the name of a provider-specific implementation
of <code>jakarta.persistence.spi.PersistenceProvider</code>. The <code>provider</code> element is
optional, but should be explicitly specified if the application depends on the
use of a particular persistence provider.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12310"><a class="anchor" href="#a12310"></a>8.2.1.5. qualifier</h5>
<div class="paragraph">
<p>The <code>qualifier</code> element specifies the fully-qualified class name of
an annotation annotated <code>jakarta.inject.Qualifier</code>. This qualifier
annotation may be used to disambiguate the persistence unit for the
purposes of dependency injection.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12311"><a class="anchor" href="#a12311"></a>8.2.1.6. scope</h5>
<div class="paragraph">
<p>The <code>scope</code> element specifies the fully-qualified class name of an
annotation annotated <code>jakarta.inject.Scope</code> or
<code>jakarta.enterprise.context.NormalScope</code>. This scope annotation may
be used to determine the scope of a persistence context for the
purposes of dependency injection.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12302"><a class="anchor" href="#a12302"></a>8.2.1.7. jta-data-source, non-jta-data-source</h5>
<div class="paragraph">
<p>In Jakarta EE environments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>jta-data-source</code> element specifies the JNDI name of a JTA data source,
and/or</p>
</li>
<li>
<p>the <code>non-jta-data-source</code> element specifies the JNDI name of a non-JTA data
source.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The specified data source is used by the persistence provider to obtain database
connections. If neither element is specified, the deployer must specify a data
source at deployment, or a default data source must be provided by the container.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, these elements may be used, or the data source
information may be specified by other means, depending upon the requirements
of the provider.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12305"><a class="anchor" href="#a12305"></a>8.2.1.8. mapping-file, jar-file, class, exclude-unlisted-classes</h5>
<div class="paragraph">
<p>The following classes must be implicitly or explicitly denoted as managed
persistence classes to be included within a persistence unit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>entity classes;</p>
</li>
<li>
<p>embeddable classes;</p>
</li>
<li>
<p>mapped superclasses;</p>
</li>
<li>
<p>converter classes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The set of managed persistence classes managed by a persistence unit is
specified using one or more of the following:<sup class="footnote">[<a id="_footnoteref_96" class="footnote" href="#_footnotedef_96" title="View footnote.">96</a>]</sup></p>
</div>
<div class="ulist">
<ul>
<li>
<p>annotated managed persistence classes contained in the root of the
persistence unit (unless the <code>exclude-unlisted-classes</code> element is
specified);</p>
</li>
<li>
<p>one or more object/relational mapping XML files;</p>
</li>
<li>
<p>one or more JAR files to be searched for classes;</p>
</li>
<li>
<p>an explicit list of classes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The set of entities managed by the persistence unit is the union of these
sources, with the mapping metadata annotations (or annotation defaults)
for any given class being overridden by the XML mapping information file
if there are both annotations and XML mappings for that class. The minimum
portable level of overriding is at the level of the persistent field or
property.</p>
</div>
<div class="paragraph">
<p>The classes and/or jars that named as part of a persistence unit must be
on the classpath; referencing them from the <code>persistence.xml</code> file does
not cause them to be placed on the classpath.</p>
</div>
<div class="paragraph">
<p>All classes must be on the classpath to ensure that entity managers from
different persistence units that map the same class will be accessing the
same identical class.</p>
</div>
<div class="sect5">
<h6 id="annotated-classes-in-the-root-of-the-persistence-unit"><a class="anchor" href="#annotated-classes-in-the-root-of-the-persistence-unit"></a>Annotated Classes in the Root of the Persistence Unit</h6>
<div class="paragraph">
<p>By default, in the Java EE environment, the root of the persistence
unit is searched for annotated managed persistence classesclasses
with an <code>Entity</code>, <code>Embeddable</code>, <code>MappedSuperclass</code>, or <code>Converter</code>
annotationand mapping metadata annotations found on these classes
are processed. Where mapping annotations are missing, the classes
are mapped using mapping annotation defaults.</p>
</div>
<div class="paragraph">
<p>This behavior is disabled if the <code>exclude-unlisted-classes</code> of the
<code>persistence.xml</code> file is specified as <code>true</code>. In this case, an
annotated persistence class located in the root of the persistence
unit is not included in the persistence unit unless it is explicitly
listed in a <code>class</code> element of the <code>persistence.xml</code> file or in a
mapping file.</p>
</div>
<div class="paragraph">
<p>In the Java SE environment, this behavior is not required. Portable
Java SE applications should explicitly list each persistence class
in a <code>class</code> element of the <code>persistence.xml</code> file or in a mapping
file. The <code>exclude-unlisted-classes</code> element is not intended for use
in Java SE environments.</p>
</div>
</div>
<div class="sect5">
<h6 id="objectrelational-mapping-files"><a class="anchor" href="#objectrelational-mapping-files"></a>Object/relational Mapping Files</h6>
<div class="paragraph">
<p>An object/relational mapping XML file contains mapping information for
the classes it lists.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An object/relational mapping XML file named <code>orm.xml</code> may be located
in the <code>META-INF</code> directory in the root of the persistence unit or in
the <code>META-INF</code> directory of any jar file referenced by the
<code>persistence.xml</code>.</p>
</li>
<li>
<p>Alternatively, or in addition, one or more mapping files may be
referenced by the <code>mapping-file</code> elements of the <code>persistence-unit</code>
element. These mapping files may be present anywhere on the class path.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An <code>orm.xml</code> mapping file or other mapping file is loaded as a resource
by the persistence provider. If a mapping file is specified, the classes
and mapping information listed in the mapping file are used as described
in <a href="#a16944">Chapter 12</a>.</p>
</div>
<div class="paragraph">
<p>If multiple mapping files are specified (possibly including one or more
<code>orm.xml</code> files), the resulting mappings are obtained by combining the
mappings from all the files. If multiple mapping files referenced within
a single persistence unit (including any <code>orm.xml</code> file) contain
overlapping mapping information for a given class, the result is
undefined. That is, the object/relational mapping information contained
in any given mapping file referenced within the persistence unit must be
disjoint at the class level from object/relational mapping information
contained in other mapping files referenced within the persistence unit.</p>
</div>
</div>
<div class="sect5">
<h6 id="jar-files"><a class="anchor" href="#jar-files"></a>Jar Files</h6>
<div class="paragraph">
<p>One or more JAR files may be specified using <code>jar-file</code> elements instead
of, or in addition to, the mapping files listed by the <code>mapping-file</code>
elements. These JAR files are searched for managed persistence classes
and any mapping metadata annotations found on them are processed. Where
mapping annotations are missing, the classes are mapped using the mapping
annotation defaults defined by this specification. Such JAR files are
specified relative to the directory or jar file that <code>contains</code> the root
of the persistence unit.<sup class="footnote">[<a id="_footnoteref_97" class="footnote" href="#_footnotedef_97" title="View footnote.">97</a>]</sup></p>
</div>
<div class="paragraph">
<p>The following examples illustrate the use of the <code>jar-file</code> element to
reference additional persistence classes. These examples make use of the
convention that a jar file with a name terminating in &#8220;PUnit&#8221; contains
the <code>persistence.xml</code> file and that a jar file with a name terminating in
&#8220;Entities&#8221; contains additional persistence classes.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    earRootPUnit.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><code>persistence.xml</code> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>lib/earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    lib/earLibPUnit.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><code>persistence.xml</code> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    ejbjar.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><code>persistence.xml</code> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>lib/earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    war1.war
        WEB-INF/lib/warEntities.jar
        WEB-INF/lib/warPUnit.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><code>persistence.xml</code> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>warEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    war2.war
        WEB-INF/lib/warEntities.jar
        WEB-INF/classes/META-INF/persistence.xml</pre>
</div>
</div>
<div class="paragraph">
<p><code>persistence.xml</code> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>lib/warEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    war2.war
        WEB-INF/classes/META-INF/persistence.xml</pre>
</div>
</div>
<div class="paragraph">
<p><code>persistence.xml</code> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>../../lib/earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 7:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    war1.war
        WEB-INF/lib/warPUnit.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><code>persistence.xml</code> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>../../../lib/earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="list-of-managed-classes"><a class="anchor" href="#list-of-managed-classes"></a>List of Managed Classes</h6>
<div class="paragraph">
<p>A list of named managed persistence classesentity classes, embeddable
classes, mapped superclasses, and converter classesmay be specified
instead of, or in addition to, the listed JAR files and mapping files.
Any mapping metadata annotations found on these classes are processed.
Where mapping annotations are missing, the classes are mapped using
the mapping annotation defaults. The <code>class</code> element is used to list
a managed persistence class.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, an explicit list of all managed persistence
class names must be specified to insure portability. Portable Java SE
applications should not rely on the other mechanisms described here to
determine the managed persistence classes of a persistence unit. In
Java SE environments, a persistence provider may require that the set
of entity classes and other classes to be managed is fully enumerated
in each <code>persistence.xml</code> file.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="a12380"><a class="anchor" href="#a12380"></a>8.2.1.9. shared-cache-mode</h5>
<div class="paragraph">
<p>The <code>shared-cache-mode</code> element determines whether second-level caching
is in effect for the persistence unit. See <a href="#a3065">Section 3.10.1</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12382"><a class="anchor" href="#a12382"></a>8.2.1.10. validation-mode</h5>
<div class="paragraph">
<p>The <code>validation-mode</code> element determines whether automatic lifecycle
event time validation is in effect. See <a href="#a2374">Section 3.7.1.1</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12384"><a class="anchor" href="#a12384"></a>8.2.1.11. properties</h5>
<div class="paragraph">
<p>The <code>properties</code> element is used to specify both standard and
vendor-specific properties and hints that apply to the persistence unit
and its entity manager factory configuration.</p>
</div>
<div class="paragraph">
<p>The following properties and hints defined by this specification are
intended for use in both Jakarta EE and Java SE environments:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jakarta.persistence.lock.timeout</code></dt>
<dd>
<p>The pessimistic lock timeout in milliseconds. This is a hint only.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.query.timeout</code></dt>
<dd>
<p>The query timeout in milliseconds. This is a hint only.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.validation.group.pre-persist</code></dt>
<dd>
<p>Bean Validation groups that are targeted for validation upon the
pre-persist event (overrides the default behavior).</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.validation.group.pre-update</code></dt>
<dd>
<p>Bean Validation groups that are targeted for validation upon the
pre-update event (overrides the default behavior).</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.validation.group.pre-remove</code></dt>
<dd>
<p>Bean Validation groups that are targeted for validation upon the
pre-remove event (overrides the default behavior).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following properties defined by this specification are intended
for use in Java SE environments.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jakarta.persistence.jdbc.driver</code></dt>
<dd>
<p>Fully qualified name of the JDBC driver class.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.jdbc.url</code></dt>
<dd>
<p>Driver-specific connection URL.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.jdbc.user</code></dt>
<dd>
<p>Username for database connection authentication.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.jdbc.password</code></dt>
<dd>
<p>Password for database connection authentication</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Scripts for use in schema generation may be specified using the
<code>jakarta.persistence.schema-generation.create-script-source</code> and
<code>jakarta.persistence.schema-generation.drop-script-source</code> properties.
A script to specify SQL for the bulk loading of data may be specified
by the <code>jakarta.persistence.sql-load-script-source</code> property. These
properties are intended for use in both Jakarta EE and Java SE
environments:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.create-script-source</code></dt>
<dd>
<p>Name of a script packaged as part of the persistence application or
a string identifying a file URL that designates a script.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.drop-script-source</code></dt>
<dd>
<p>Name of a script packaged as part of the persistence application or
a string identifying a file URL that designates a script.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.sql-load-script-source</code></dt>
<dd>
<p>Name of a script packaged as part of the persistence unit or a string
identifying a file URL that designates a script.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When scripts are packaged as part of the persistence application, these
properties must specify locations relative to the root of the persistence
unit. When scripts are provided externally (or when schema generation is
configured to write script files, as described below), strings identifying
file URLs must be specified. In Jakarta EE environments, such file URLs
must be absolute paths. In Jakarta EE environments, all source and target
file locations must be accessible to the application server deploying the
persistence unit.</p>
</div>
<div class="paragraph">
<p>In general, it is expected that schema generation will be initiated by
means of the APIs described in <a href="#a12917">Section 9.4</a>. However, schema generation
actions may also be specified by means of the following properties used
in the <code>persistence.xml</code> file.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.database.action</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.database.action</code> property specifies
the action to be taken by the persistence provider with regard to the
database artifacts. The values for this property are <code>none</code>, <code>create</code>,
<code>drop-and-create</code>, <code>drop</code>, <code>validate</code>. If this property is not specified,
it is assumed that schema generation is not needed or will be initiated by
other means, and, by default, no schema generation actions will be taken
on the database. (See <a href="#a12917">Section 9.4</a>.)</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.scripts.action</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.scripts.action</code> property specifies
which scripts are to be generated by the persistence provider. The
values for this property are <code>none</code>, <code>create</code>, <code>drop-and-create</code>,
<code>drop</code>. A script will only be generated if the script target is
specified. If this property is not specified, it is assumed that script
generation is not needed or will be initiated by other means, and, by
default, no scripts will be generated. (See <a href="#a12917">Section 9.4</a>.)</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.create-source</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.create-source</code> property specifies
whether the creation of database artifacts is to occur on the basis of
the object/relational mapping metadata, DDL script, or a combination of
the two. The values for this property are <code>metadata</code>, <code>script</code>,
<code>metadata-then-script</code>, <code>script-then-metadata</code>. If this property is
not specified, and a script is specified by the
<code>jakarta.persistence.schema-generation.create-script-source</code> property, the
script (only) will be used for schema generation; otherwise if this
property is not specified, schema generation will occur on the basis of
the object/relational mapping metadata (only). The
<code>metadata-then-script</code> and <code>script-then-metadata</code> values specify that a
combination of metadata and script is to be used and the order in which
this use is to occur. If either of these values is specified and the
resulting database actions are not disjoint, the results are undefined
and schema generation may fail.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.drop-source</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.drop-source</code> property specifies
whether the dropping of database artifacts is to occur on the basis of
the object/relational mapping metadata, DDL script, or a combination of
the two. The values for this property are <code>metadata</code>, <code>script</code>,
<code>metadata-then-script</code>, <code>script-then-metadata</code>. If this property is
not specified, and a script is specified by the
<code>jakarta.persistence.schema-generation.drop-script-source</code> property, the
script (only) will be used for the dropping of database artifacts;
otherwise if this property is not specified, the dropping of database
artifacts will occur on the basis of the object/relational mapping
metadata (only). The <code>metadata-then-script</code> and <code>script-then-metadata</code>
values specify that a combination of metadata and script is to be used
and the order in which this use is to occur. If either of these values
is specified and the resulting database actions are not disjoint, the
results are undefined and the dropping of database artifacts may fail.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.scripts.create-target</code>, </dt>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.scripts.drop-target</code> </dt>
<dd>
<p>If scripts are to be generated, the target
locations for the writing of these scripts must be specified. These
targets are specified as strings corresponding to file URLs.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If a persistence provider does not recognize a property (other than a
property defined by this specification), the provider must ignore it.</p>
</div>
<div class="paragraph">
<p>Vendors should define properties in vendor-specific namespaces, (e.g
<code>com.acme.persistence.logging</code>). The namespace <code>jakarta.persistence</code>
is reserved for use by this specification, and must not be used to
define vendor-specific properties.</p>
</div>
<div class="paragraph">
<p>The following are sample contents of a <code>persistence.xml</code> file.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <code>OrderManagement</code> is created.</p>
</div>
<div class="paragraph">
<p>Any annotated managed persistence classes
found in the root of the persistence unit are added to the list of
managed persistence classes. If a <code>META-INF/orm.xml</code> file exists, any
classes referenced by it and mapping information contained in it are
used as specified above. Because no provider is specified, the
persistence unit is assumed to be portable across providers. Because the
transaction type is not specified, JTA is assumed for Jakarta EE
environments. The container must provide the data source (it may be
specified at application deployment, for example). In Java SE
environments, the data source may be specified by other means and a
transaction type of <code>RESOURCE_LOCAL</code> is assumed.</p>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;mapping-file&gt;</span>mappings.xml<span class="tag">&lt;/mapping-file&gt;</span>
<span class="tag">&lt;/persistence-unit&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <code>OrderManagement2</code>
is created. Any annotated managed persistence classes found in the root
of the persistence unit are added to the list of managed persistence
classes. The <code>mappings.xml</code> resource exists on the classpath and any
classes and mapping information contained in it are used as specified
above. If a <code>META-INF/orm.xml</code> file exists, any classes and mapping
information contained in it are used as well. The transaction type, data
source, and provider are as described above.</p>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;jar-file&gt;</span>order.jar<span class="tag">&lt;/jar-file&gt;</span>
    <span class="tag">&lt;jar-file&gt;</span>order-supplemental.jar<span class="tag">&lt;/jar-file&gt;</span>
<span class="tag">&lt;/persistence-unit&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <code>OrderManagement3</code>
is created. Any annotated managed persistence classes found in the root
of the persistence unit are added to the list of managed persistence
classes. If a <code>META-INF/orm.xml</code> file exists, any classes and mapping
information contained in it are used as specified above. The <code>order.jar</code>
and <code>order-supplemental.jar</code> files are searched for managed persistence
classes and any annotated managed persistence classes found in them
and/or any classes specified in the <code>orm.xml</code> files of these jar files
are added. The transaction-type, data source and provider are as
described above.</p>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement4</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">transaction-type</span>=<span class="attribute-value">RESOURCE_LOCAL</span><span class="tag">&gt;</span>
    <span class="tag">&lt;non-jta-data-source&gt;</span>java:app/jdbc/MyDB<span class="tag">&lt;/non-jta-data-source&gt;</span>
    <span class="tag">&lt;mapping-file&gt;</span>order-mappings.xml<span class="tag">&lt;/mapping-file&gt;</span>
    <span class="tag">&lt;class&gt;</span>com.acme.Order<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;class&gt;</span>com.acme.Customer<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;class&gt;</span>com.acme.Item<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;exclude-unlisted-classes</span><span class="tag">/&gt;</span>
<span class="tag">&lt;/persistence-unit&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <code>OrderManagement4</code>
is created. The file <code>order-mappings.xml</code> is read as a resource and any
classes referenced by it and mapping information contained in it are
used<sup class="footnote">[<a id="_footnoteref_98" class="footnote" href="#_footnotedef_98" title="View footnote.">98</a>]</sup>.
The annotated <code>Order</code>, <code>Customer</code> and
<code>Item</code> classes are loaded and are added. No (other) classes contained in
the root of the persistence unit are added to the list of managed
persistence classes. The persistence unit assumed to be portable across
providers. A entity manager factory supplying resource-local entity
managers will be created. The data source <code>java:app/jdbc/MyDB</code> must be
used.</p>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement5</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;provider&gt;</span>com.acme.AcmePersistence<span class="tag">&lt;/provider&gt;</span>
    <span class="tag">&lt;mapping-file&gt;</span>order1.xml<span class="tag">&lt;/mapping-file&gt;</span>
    <span class="tag">&lt;mapping-file&gt;</span>order2.xml<span class="tag">&lt;/mapping-file&gt;</span>
    <span class="tag">&lt;jar-file&gt;</span>order.jar<span class="tag">&lt;/jar-file&gt;</span>
    <span class="tag">&lt;jar-file&gt;</span>order-supplemental.jar<span class="tag">&lt;/jar-file&gt;</span>
<span class="tag">&lt;/persistence-unit&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <code>OrderManagement5</code>
is created. Any annotated managed persistence classes found in the root
of the persistence unit are added to the list of managed classes. The
<code>order1.xml</code> and <code>order2.xml</code> files are read as resources and any
classes referenced by them and mapping information contained in them are
also used as specified above. The <code>order.jar</code> is a jar file on the
classpath containing another persistence unit, while
<code>order-supplemental.jar</code> is just a library of classes. Both of these jar
files are searched for annotated managed persistence classes and any
annotated managed persistence classes found in them and any classes
specified in the <code>orm.xml</code> files (if any) of these jar files are added.
The provider <code>com.acme.AcmePersistence</code> must be used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the <code>persistence.xml</code> file
contained in <code>order.jar</code> is not used to augment the persistence unit
<code>OrderManagement5</code> with the classes of the persistence unit whose root
is <code>order.jar</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a12459"><a class="anchor" href="#a12459"></a>8.2.2. Persistence Unit Scope</h4>
<div class="paragraph">
<p>An EJB-JAR, WAR, application client JAR, or EAR can define a persistence
unit. When referencing a persistence unit using the <code>unitName</code> annotation
element or <code>persistence-unit-name</code> deployment descriptor element, the
visibility scope of the persistence unit is determined by its point of
definition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A persistence unit defined at the level of an EJB-JAR, WAR, or
application client JAR is scoped to that EJB-JAR, WAR, or application
JAR respectively and is visible to the components defined in that jar
or WAR.</p>
</li>
<li>
<p>A persistence unit defined at the level of an EAR is generally visible
to all components in the application. However, if a persistence unit of
the same name is defined by an EJB-JAR, WAR, or application JAR file
within the EAR, the persistence unit of that name defined at EAR level
will not be visible to the components defined by that EJB-JAR, WAR, or
application JAR file, unless the persistence unit reference uses the
persistence unit name # syntax to specify a path name to disambiguate
the reference.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The # syntax may be used with both the <code>unitName</code> annotation element or
<code>persistence-unit-name</code> deployment descriptor element to reference a
persistence unit defined at EAR level.</p>
</div>
<div class="paragraph">
<p>When the # syntax is used, the path name is interpreted relative to the
referencing application component jar file. For example, the syntax
<code>../lib/persistenceUnitRoot.jar#myPersistenceUnit</code> refers to a persistence
unit with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>name <code>myPersistenceUnit</code>, as specified in the <code>name</code> element of the
<code>persistence.xml</code> file, and</p>
</li>
<li>
<p>root given by the relative path name <code>../lib/persistenceUnitRoot.jar</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="persistence-xml-schema"><a class="anchor" href="#persistence-xml-schema"></a>8.3. persistence.xml Schema</h3>
<div class="paragraph">
<p>This section provides the XML schema for the <code>persistence.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="comment">&lt;!-- persistence.xml schema --&gt;</span>
<span class="tag">&lt;xsd:schema</span> <span class="attribute-name">targetNamespace</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/persistence</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:xsd</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:persistence</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/persistence</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">elementFormDefault</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">qualified</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">attributeFormDefault</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unqualified</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

   <span class="tag">&lt;xsd:annotation&gt;</span>
     <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

     This is the XML Schema for the persistence configuration file.
     The file must be named &quot;META-INF/persistence.xml&quot; in the
     persistence archive.

     Persistence configuration files must indicate
     the persistence schema by using the persistence namespace:

     https://jakarta.ee/xml/ns/persistence

     and indicate the version of the schema by
     using the version element as shown below:

      &lt;persistence xmlns=&quot;https://jakarta.ee/xml/ns/persistence&quot;
        xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
        xsi:schemaLocation=&quot;https://jakarta.ee/xml/ns/persistence
          https://jakarta.ee/xml/ns/persistence/persistence_3_2.xsd&quot;
        version=&quot;3.2&quot;&gt;
          ...
      &lt;/persistence&gt;

    <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
  <span class="tag">&lt;/xsd:annotation&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">versionType</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:pattern</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">[0-9]+(\.[0-9]+)*</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:complexType&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>

        <span class="comment">&lt;!-- **************************************************** --&gt;</span>

        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;xsd:complexType&gt;</span>
            <span class="tag">&lt;xsd:annotation&gt;</span>
              <span class="tag">&lt;xsd:documentation&gt;</span>

                Configuration of a persistence unit.

              <span class="tag">&lt;/xsd:documentation&gt;</span>
            <span class="tag">&lt;/xsd:annotation&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>

            <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Description of this persistence unit.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">provider</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Provider class that supplies EntityManagers for this
                    persistence unit.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">qualifier</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Qualifier annotation class used for dependency injection.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scope</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Scope annotation class used for dependency injection.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jta-data-source</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    The container-specific name of the JTA datasource to use.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">non-jta-data-source</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    The container-specific name of a non-JTA datasource to use.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapping-file</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    File containing mapping information. Loaded as a resource
                    by the persistence provider.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jar-file</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Jar file that is to be scanned for managed classes.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Managed class to be included in the persistence unit and
                    to scan for annotations.  It should be annotated
                    with either @Entity, @Embeddable or @MappedSuperclass.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-unlisted-classes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">default</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    When set to true then only listed classes and jars will
                    be scanned for persistent classes, otherwise the
                    enclosing jar or directory will also be scanned.
                    Not applicable to Java SE persistence units.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">shared-cache-mode</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence:persistence-unit-caching-type</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Defines whether caching is enabled for the
                    persistence unit if caching is supported by the
                    persistence provider. When set to ALL, all entities
                    will be cached. When set to NONE, no entities will
                    be cached. When set to ENABLE_SELECTIVE, only entities
                    specified as cacheable will be cached. When set to
                    DISABLE_SELECTIVE, entities specified as not cacheable
                    will not be cached. When not specified or when set to
                    UNSPECIFIED, provider defaults may apply.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">validation-mode</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence:persistence-unit-validation-mode-type</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    The validation mode to be used for the persistence unit.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>


              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">properties</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    A list of standard and vendor-specific properties
                    and hints.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
                <span class="tag">&lt;xsd:complexType&gt;</span>
                  <span class="tag">&lt;xsd:sequence&gt;</span>
                    <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">property</span><span class="delimiter">&quot;</span></span>
                                 <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                      <span class="tag">&lt;xsd:annotation&gt;</span>
                        <span class="tag">&lt;xsd:documentation&gt;</span>
                          A name-value pair.
                        <span class="tag">&lt;/xsd:documentation&gt;</span>
                      <span class="tag">&lt;/xsd:annotation&gt;</span>
                      <span class="tag">&lt;xsd:complexType&gt;</span>
                        <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                                       <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                        <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                                       <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                      <span class="tag">&lt;/xsd:complexType&gt;</span>
                    <span class="tag">&lt;/xsd:element&gt;</span>
                  <span class="tag">&lt;/xsd:sequence&gt;</span>
                <span class="tag">&lt;/xsd:complexType&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="tag">&lt;xsd:any</span> <span class="attribute-name">namespace</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">##other</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">processContents</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lax</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>
                    An extension point for integration related configuration, e.g. cdi:
                    <span class="comment">&lt;!--
                    &lt;persistence-unit name=&quot;my-unit&quot; xmlns:cdi=&quot;https://jakarta.ee/xml/ns/persistence-cdi&quot;&gt;
                      ...
                      &lt;cdi:scope&gt;com.example.jpa.ACustomScope&lt;/cdi:scope&gt;
                      &lt;cdi:qualifier&gt;com.example.jpa.CustomQualifier&lt;/cdi:qualifier&gt;
                    &lt;/persistence-unit&gt;
                    --&gt;</span>
                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:any&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>

            <span class="comment">&lt;!-- **************************************************** --&gt;</span>

            <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
              <span class="tag">&lt;xsd:annotation&gt;</span>
                <span class="tag">&lt;xsd:documentation&gt;</span>

                  Name used in code to reference this persistence unit.

                <span class="tag">&lt;/xsd:documentation&gt;</span>
              <span class="tag">&lt;/xsd:annotation&gt;</span>
            <span class="tag">&lt;/xsd:attribute&gt;</span>

            <span class="comment">&lt;!-- **************************************************** --&gt;</span>

            <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transaction-type</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence:persistence-unit-transaction-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
              <span class="tag">&lt;xsd:annotation&gt;</span>
                <span class="tag">&lt;xsd:documentation&gt;</span>

                  Type of transactions used by EntityManagers from this
                  persistence unit.

                <span class="tag">&lt;/xsd:documentation&gt;</span>
              <span class="tag">&lt;/xsd:annotation&gt;</span>
            <span class="tag">&lt;/xsd:attribute&gt;</span>

          <span class="tag">&lt;/xsd:complexType&gt;</span>
        <span class="tag">&lt;/xsd:element&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence:versionType</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:complexType&gt;</span>
  <span class="tag">&lt;/xsd:element&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-transaction-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum PersistenceUnitTransactionType {JTA, RESOURCE_LOCAL};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">JTA</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">RESOURCE_LOCAL</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-caching-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum SharedCacheMode { ALL, NONE, ENABLE_SELECTIVE, DISABLE_SELECTIVE, UNSPECIFIED};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ENABLE_SELECTIVE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DISABLE_SELECTIVE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UNSPECIFIED</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-validation-mode-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum ValidationMode { AUTO, CALLBACK, NONE};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">AUTO</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CALLBACK</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="tag">&lt;/xsd:schema&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="container-and-provider-contracts-for-deployment-and-bootstrapping"><a class="anchor" href="#container-and-provider-contracts-for-deployment-and-bootstrapping"></a>9. Container and Provider Contracts for Deployment and Bootstrapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter defines requirements on the Jakarta EE container and on
the persistence provider for deployment and bootstrapping.</p>
</div>
<div class="sect2">
<h3 id="a12802"><a class="anchor" href="#a12802"></a>9.1. Jakarta EE Deployment</h3>
<div class="paragraph">
<p>Each persistence unit deployed into a Jakarta EE
container consists of a single <code>persistence.xml</code> file, any number of
mapping files, and any number of class files.</p>
</div>
<div class="paragraph">
<p>At deployment time the container is
responsible for scanning the locations specified in <a href="#a12236">Section 8.2</a> and
discovering the <code>persistence.xml</code> files and processing them.</p>
</div>
<div class="paragraph">
<p>When the container finds a <code>persistence.xml</code>
file, it must process the persistence unit definitions that it contains.
The container must validate the <code>persistence.xml</code> file against the
<code>persistence_3_2.xsd</code>, <code>persistence_3_0.xsd</code> or <code>persistence_2_2.xsd</code> schema in accordance with
the version specified by the <code>persistence.xml</code> file and report any validation errors.
Provider or data source information not specified in the <code>persistence.xml</code> file
must be provided at deployment time or defaulted by the container. The
container may optionally add any container-specific properties to be
passed to the provider when creating the entity manager factory for the
persistence unit.</p>
</div>
<div class="paragraph">
<p>Once the container has read the persistence
metadata, it determines the <code>jakarta.persistence.spi.PersistenceProvider</code>
implementation class for each deployed named persistence unit. The
container then creates an instance of the <code>PersistenceProvider</code>
implementation class for each deployed named persistence unit and
invokes the <code>createContainerEntityManagerFactory</code> method on that
instance.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The container must implement the
<code>PersistenceUnitInfo</code> interface described in <a href="#a13160">Section 9.6</a> and pass the
metadatain the form of a <code>PersistenceUnitInfo</code> instanceto the
persistence provider as part of this call.</p>
</li>
<li>
<p>If a Bean Validation provider exists in the
container environment and the <code>validation-mode</code> <code>NONE</code> is not specified,
a <code>ValidatorFactory</code> instance must be made available by the container.
The container is responsible for passing this <code>ValidatorFactory</code>
instance via the map that is passed as an argument to the
<code>createContainerEntityManagerFactory</code> call. The map key used must be the
standard property name <code>jakarta.persistence.validation.factory</code>.</p>
</li>
<li>
<p>If CDI is enabled, a <code>BeanManager</code> instance
must be made available by the container. The container is responsible
for passing this <code>BeanManager</code> instance via the map that is passed as an
argument to the <code>createContainerEntityManagerFactory</code> call. The map key
used must be the standard property name <code>jakarta.persistence.bean.manager</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>EntityManagerFactory</code> instance obtained
as a result will be used by the container to create container-managed
entity managers. Only one EntityManagerFactory is permitted to be
created for each deployed persistence unit configuration. Any number of
EntityManager instances may be created from a given factory.</p>
</div>
<div class="paragraph">
<p>In a Jakarta EE environment, the classes of the
persistence unit should not be loaded by the application class loader or
any of its parent class loaders until after the entity manager factory
for the persistence unit has been created.</p>
</div>
<div class="paragraph">
<p>When a persistence unit is redeployed, the
container should call the <code>close</code> method on the previous
<code>EntityManagerFactory</code> instance and call the
<code>createContainerEntityManagerFactory</code> method again, with the required
<code>PersistenceUnitInfo</code> metadata, to achieve the redeployment.</p>
</div>
</div>
<div class="sect2">
<h3 id="bootstrapping-in-java-se-environments"><a class="anchor" href="#bootstrapping-in-java-se-environments"></a>9.2. Bootstrapping in Java SE Environments</h3>
<div class="paragraph">
<p>In Java SE environments, the
<code>Persistence.createEntityManagerFactory</code> method is used by the
application to create an entity manager factory<sup class="footnote">[<a id="_footnoteref_99" class="footnote" href="#_footnotedef_99" title="View footnote.">99</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>A persistence provider implementation running
in a Java SE environment should also act as a service provider by
supplying a service provider configuration file as defined by the Java
SE platform.</p>
</div>
<div class="paragraph">
<p>The provider configuration file serves to
export the provider implementation class to the <code>Persistence</code> bootstrap
class, positioning the provider as a candidate for backing named
persistence units. The provider supplies the provider configuration file
by creating a text file named
<code>jakarta.persistence.spi.PersistenceProvider</code> and placing it in the
<code>META-INF/services</code> directory of one of its JAR files. The contents of
the file should be the name of the provider implementation class of the
<code>jakarta.persistence.spi.PersistenceProvider</code> interface.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="paragraph">
<p>A persistence vendor called ACME persistence
products ships a JAR called <code>acme.jar</code> that contains its persistence
provider implementation. The JAR includes the provider configuration
file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>acme.jar
    META-INF/services/jakarta.persistence.spi.PersistenceProvider
    com.acme.PersistenceProvider
    ...</pre>
</div>
</div>
<div class="paragraph">
<p>The contents of the
<code>META-INF/services/jakarta.persistence.spi.PersistenceProvider</code> file is
nothing more than the name of the implementation class:
<code>com.acme.PersistenceProvider</code>.</p>
</div>
<div class="paragraph">
<p>Persistence provider jars may be installed or
made available in the same ways as other service providers, e.g. as
extensions or added to the application classpath.</p>
</div>
<div class="paragraph">
<p>The <code>Persistence</code> bootstrap class must locate
all of the persistence providers using the <code>PersistenceProviderResolver</code>
mechanism described in <a href="#a12837">Section 9.3</a> and call
<code>createEntityManagerFactory</code> on them in turn until an appropriate
backing provider returns an <code>EntityManagerFactory</code> instance. A provider
may deem itself as appropriate for the persistence unit if any of the
following are true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Its implementation class has been specified
in the <code>provider</code> element for that persistence unit in the
<code>persistence.xml</code> file and has not been overridden by a different
<code>jakarta.persistence.provider</code> property value included in the Map passed
to the <code>createEntityManagerFactory</code> method.</p>
</li>
<li>
<p>The <code>jakarta.persistence.provider</code> property was
included in the Map passed to <code>createEntityManagerFactory</code> and the value
of the property is the provider&#8217;s implementation class.</p>
</li>
<li>
<p>No provider was specified for the persistence
unit in either the <code>persistence.xml</code> or the property map.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a provider does not qualify as the
provider for the named persistence unit, it must return <code>null</code> when
<code>createEntityManagerFactory</code> is invoked on it.</p>
</div>
<div class="sect3">
<h4 id="a12803"><a class="anchor" href="#a12803"></a>9.2.1. Schema Generation</h4>
<div class="paragraph">
<p>In Java SE environments, the
<code>Persistence.generateSchema</code> method may be used by the application to
cause schema generation to occur as a separate phase from entity manager
factory creation.</p>
</div>
<div class="paragraph">
<p>In this case, the <code>Persistence</code> bootstrap
class must locate all of the persistence providers using the
<code>PersistenceProviderResolver</code> mechanism described in <a href="#a12837">Section 9.3</a>
and call <code>generateSchema</code> on them in turn until an
appropriate backing provider returns <code>true</code>. A provider may deem itself
as appropriate for the persistence unit if any of the following are
true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Its implementation class has been specified
in the <code>provider</code> element for that persistence unit in the
<code>persistence.xml</code> file and has not been overridden by a different
<code>jakarta.persistence.provider</code> property value included in the Map passed
to the <code>generateSchema</code> method.</p>
</li>
<li>
<p>The <code>jakarta.persistence.provider</code> property was
included in the Map passed to <code>generateSchema</code> and the value of the
property is the provider&#8217;s implementation class.</p>
</li>
<li>
<p>No provider was specified for the persistence
unit in either the <code>persistence.xml</code> or the property map.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a provider does not qualify as the
provider for the named persistence unit, it must return <code>false</code> when
<code>generateSchema</code> is invoked on it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a12837"><a class="anchor" href="#a12837"></a>9.3. Determining the Available Persistence Providers</h3>
<div class="paragraph">
<p>The <code>PersistenceProviderResolver</code> and
<code>PersistenceProviderResolverHolder</code> mechanism supports the dynamic
discovery of persistence providers.<sup class="footnote">[<a id="_footnoteref_100" class="footnote" href="#_footnotedef_100" title="View footnote.">100</a>]</sup></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>PersistenceProviderResolver</code> instance is responsible for
returning the list of providers available in the environment.</p>
</li>
<li>
<p>The <code>PersistenceProviderResolverHolder</code> class holds the
<code>PersistenceProviderResolver</code> instance that is in use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These interfaces may be found in <a href="#persistence-spi">Appendix E</a>.</p>
</div>
<div class="paragraph">
<p>The implementation of <code>PersistenceProviderResolverHolder</code> must be
threadsafe, but no guarantee is made against multiple threads setting
the resolver.</p>
</div>
<div class="paragraph">
<p>The container is allowed to implement
and set a specific <code>PersistenceProviderResolver</code> provided that it
respects the <code>PersistenceProviderResolver</code> contract. The
<code>PersistenceProviderResolver</code> instance to be used is set by the
container using the
<code>PersistenceProviderResolverHolder.setPersistenceProviderResolver</code>
method.<sup class="footnote">[<a id="_footnoteref_101" class="footnote" href="#_footnotedef_101" title="View footnote.">101</a>]</sup></p>
</div>
<div class="paragraph">
<p>If no <code>PersistenceProviderResolver</code> is set,
the <code>PersistenceProviderResolverHolder</code> must return a
<code>PersistenceProviderResolver</code> that returns the providers whose
persistence provider jars have been installed or made available as
service providers or extensions. This default
<code>PersistenceProviderResolver</code> instance does not guarantee the order in
which persistence providers are returned.</p>
</div>
<div class="paragraph">
<p>A <code>PersistenceProviderResolver</code> must be threadsafe.</p>
</div>
<div class="paragraph">
<p>The
<code>PersistenceProviderResolver.getPersistenceProviders()</code> method must be
used to determine the list of available persistence providers.</p>
</div>
<div class="paragraph">
<p>The results of calling the
<code>PersistenceProviderResolverHolder.getPersistenceProviderResolver</code> and
the <code>PersistenceProviderResolver.getPersistenceProviders</code> methods must
not be cached. In particular, the following methods must use the
<code>PersistenceProviderResolver</code> instance returned by the
<code>PersistenceProviderResolverHolder.getPersistenceProviderResolver</code>
method to determine the list of available providers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Persistence.createEntityManagerFactory(String)</code></p>
</li>
<li>
<p><code>Persistence.createEntityManagerFactory(String, Map)</code></p>
</li>
<li>
<p><code>PersistenceUtil.isLoaded(Object)</code></p>
</li>
<li>
<p><code>PersistenceUtil.isLoaded(Object, String)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These methods must not cache the list of
providers and must not cache the <code>PersistenceProviderResolver</code> instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the
<code>PersistenceProviderResolver.getPersistenceProviders()</code> method can
potentially be called many times. It is therefore recommended that the
implementation of this method make use of caching.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that only a single
<code>PersistenceProviderResolver</code> instance can be defined in a given
classloader hierarchy at a given time.</p>
</div>
</div>
<div class="sect2">
<h3 id="a12917"><a class="anchor" href="#a12917"></a>9.4. Schema Generation</h3>
<div class="paragraph">
<p>In cases where a preconfigured database (or a
legacy database) is not used or is not available, the Jakarta Persistence
schema generation facility may be used to generate the tables and other
database artifacts required by the persistence application. Whether
schema generation entails the creation of schemas proper in the database
is determined by the environment and the configuration of the schema
generation process, as described below.</p>
</div>
<div class="paragraph">
<p>Schema generation may happen either prior to
application deployment or when the entity manager factory is created as
part of the application deployment and initialization process.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In Jakarta EE environments, the container may
call the <code>PersistenceProvider</code> <code>generateSchema</code> method separately from
and/or prior to the creation of the entity manager factory for the
persistence unit, or the container may pass additional information to
the <code>createContainerEntityManagerFactory</code> call to cause schema
generation to happen as part of the entity manager factory creation and
application initialization process. The information passed to these
methods controls whether the generation occurs directly in the target
database, whether DDL scripts for schema generation are created, or
both.</p>
</li>
<li>
<p>In Java SE environments, the application may
call the <code>Persistence</code> <code>generateSchema</code> method separately from and/or
prior to the creation of the entity manager factory or may pass
information to the <code>createEntityManagerFactory</code> method to cause schema
generation to occur as part of the entity manager factory creation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application may provide DDL scripts to be
used for schema generation as described in <a href="#a12384">Section 8.2.1.11</a>. The application developer
may package these scripts as part of the persistence unit or may specify
strings corresponding to file URLs for the location of such scripts. In
Jakarta EE environments, such scripts may be executed by the container, or
the container may direct the persistence provider to execute the
scripts. In Java SE environments, the execution of the scripts is the
responsibility of the persistence provider. In the absence of the
specification of scripts, schema generation, if requested, will be
determined by the object/relational metadata of the persistence unit.</p>
</div>
<div class="paragraph">
<p>The following standard properties are defined
for configuring the schema generation process. In Jakarta EE environments
these properties are passed by the container in the <code>Map</code> argument to
either the <code>PersistenceProvider</code> <code>generateSchema</code> method or the
<code>createContainerEntityManagerFactory</code> method. In Java SE environments,
they are passed in the <code>Map</code> argument to either the <code>Persistence</code>
<code>generateSchema</code> method or <code>createEntityManagerFactory</code> method.</p>
</div>
<div class="paragraph">
<p>In Jakarta EE environments, any strings
corresponding to file URLs for script sources or targets must specify
absolute paths (not relative). In Jakarta EE environments, all source and
target file locations must be accessible to the application server
deploying the persistence unit</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.database.action</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.database.action</code> property specifies
the action to be taken by the persistence provider with regard to the
database artifacts. The values for this property are <em>"none"</em>,
<em>"create"</em>, <em>"drop-and-create"</em>, <em>"drop"</em>, <em>"validate"</em>. If the
<code>jakarta.persistence.schema-generation.database.action</code> property is not
specified, no schema generation actions must be taken on the database.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.scripts.action</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.scripts.action</code> property specifies
which scripts are to be generated by the persistence provider. The
values for this property are <em>"none"</em>, <em>"create"</em>, <em>"drop-and-create"</em>
, <em>"drop"</em>. A script will only be generated if the script target is
specified. If this property is not specified, no scripts will be
generated.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.create-source</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.create-source</code> property specifies
whether the creation of database artifacts is to occur on the basis of
the object/relational mapping metadata, DDL script, or a combination of
the two. The values for this property are <em>"metadata"</em>, <em>"script"</em>,
<em>"metadata-then-script"</em>, <em>"script-then-metadata"</em>. If this property
is not specified, and a script is specified by the
<code>jakarta.persistence.schema-generation.create-script-source</code> property, the
script (only) will be used for schema generation; otherwise if this
property is not specified, schema generation will occur on the basis of
the object/relational mapping metadata (only). The
<em>"metadata-then-script"</em> and <em>"script-then-metadata"</em> values specify
that a combination of metadata and script is to be used and the order in
which this use is to occur. If either of these values is specified and
the resulting database actions are not disjoint, the results are
undefined and schema generation may fail.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.drop-source</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.drop-source</code> property specifies
whether the dropping of database artifacts is to occur on the basis of
the object/relational mapping metadata, DDL script, or a combination of
the two. The values for this property are <em>"metadata"</em>, <em>"script"</em>,
<em>"metadata-then-script"</em>, <em>"script-then-metadata"</em>. If this property
is not specified, and a script is specified by the
<code>jakarta.persistence.schema-generation.drop-script-source</code> property, the
script (only) will be used for the dropping of database artifacts;
otherwise if this property is not specified, the dropping of database
artifacts will occur on the basis of the object/relational mapping
metadata (only). The <em>"metadata-then-script"</em> and
<em>"script-then-metadata"</em> values specify that a combination of metadata
and script is to be used and the order in which this use is to occur. If
either of these values is specified and the resulting database actions
are not disjoint, the results are undefined and the dropping of database
artifacts may fail.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.create-database-schemas</code> </dt>
<dd>
<p>In Jakarta EE environments, it is anticipated
that the Jakarta EE platform provider may wish to control the creation of
database schemas rather than delegate this task to the persistence
provider. The
<code>jakarta.persistence.schema-generation.create-database-schemas</code> property
specifies whether the persistence provider is to create the database
schema(s) in addition to creating database objects such as tables,
sequences, constraints, etc. The value of this boolean property should
be set to true if the persistence provider is to create schemas in the
database or to generate DDL that contains CREATE SCHEMA commands. If
this property is not supplied, the provider should not attempt to create
database schemas. This property may also be specified in Java SE
environments.
<code>jakarta.persistence.schema-generation.scripts.create-target</code>,<br></p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.scripts.drop-target</code> </dt>
<dd>
<p>If scripts are to be generated, the target
locations for the writing of these scripts must be specified.<br>
The <code>jakarta.persistence.schema-generation.scripts.create-target</code> property
specifies a <code>java.io.Writer</code> configured for use by the persistence
provider for output of the DDL script or a string specifying the file
URL for the DDL script. This property should only be specified if
scripts are to be generated.<br>
The <code>jakarta.persistence.schema-generation.scripts.drop-target</code> property
specifies a <code>java.io.Writer</code> configured for use by the persistence
provider for output of the DDL script or a string specifying the file
URL for the DDL script. This property should only be specified if
scripts are to be generated.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.database-product-name</code>, </dt>
<dt class="hdlist1"><code>jakarta.persistence.database-major-version</code>, </dt>
<dt class="hdlist1"><code>jakarta.persistence.database-minor-version</code> </dt>
<dd>
<p>If scripts are to be generated by the
persistence provider and a connection to the target database is not
supplied, the <code>jakarta.persistence.database-product-name</code> property must be
specified. The value of this property should be the value returned for
the target database by the JDBC <code>DatabaseMetaData</code> method
<code>getDatabaseProductName</code>. If sufficient database version information is
not included in the result of this method, the
<code>jakarta.persistence.database-major-version</code> and
<code>jakarta.persistence.database-minor-version</code> properties should be
specified as needed. These should contain the values returned by the
JDBC <code>getDatabaseMajorVersion</code> and <code>getDatabaseMinorVersion</code> methods
respectively.
<code>jakarta.persistence.schema-generation.create-script-source</code>,<br></p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.drop-script-source</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.create-script-source</code> and
<code>jakarta.persistence.schema-generation.drop-script-source</code> properties are
used for script execution. In Jakarta EE container environments, it is
generally expected that the container will be responsible for executing
DDL scripts, although the container is permitted to delegate this task
to the persistence provider. If DDL scripts are to be used in Java SE
environments or if the Jakarta EE container delegates the execution of
scripts to the persistence provider, these properties must be specified.<br>
The
<code>jakarta.persistence.schema-generation.create-script-source</code> property
specifies a <code>java.io.Reader</code> configured for reading of the DDL script or
a string designating a file URL for the DDL script.<br>
The
<code>jakarta.persistence.schema-generation.drop-script-source</code> property
specifies a <code>java.io.Reader</code> configured for reading of the DDL script or
a string designating a file URL for the DDL script.</p>
</dd>
<dt class="hdlist1"><code>jakarta.persistence.schema-generation.connection</code> </dt>
<dd>
<p>The <code>jakarta.persistence.schema-generation.connection</code> property specifies the
JDBC connection to be used for schema generation. This is intended for
use in Jakarta EE environments, where the platform provider may want to
control the database privileges that are available to the persistence
provider. This connection is provided by the container, and should be
closed by the container when the schema generation request or entity
manager factory creation completes. The connection provided must have
credentials sufficient for the persistence provider to carry out the
requested actions. If this property is not specified, the persistence
provider should use the DataSource that has otherwise been provided.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="data-loading"><a class="anchor" href="#data-loading"></a>9.4.1. Data Loading</h4>
<div class="paragraph">
<p>Data loading, by means of the use of SQL
scripts, may occur as part of the schema generation process after the
creation of the database artifacts or independently of schema
generation. The specification of the
<code>jakarta.persistence.sql-load-script-source</code> controls whether data loading
will occur.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jakarta.persistence.sql-load-script-source</code> </dt>
<dd>
<p>In Jakarta EE container environments, it is
generally expected that the container will be responsible for executing
data load scripts, although the container is permitted to delegate this
task to the persistence provider. If a load script is to be used in Java
SE environments or if the Jakarta EE container delegates the execution of
the load script to the persistence provider, this property must be
specified. + The
<code>jakarta.persistence.sql-load-script-source</code> property specifies a
<code>java.io.Reader</code> configured for reading of the SQL load script for
database initialization or a string designating a file URL for the
script.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="responsibilities-of-the-persistence-provider"><a class="anchor" href="#responsibilities-of-the-persistence-provider"></a>9.5. Responsibilities of the Persistence Provider</h3>
<div class="paragraph">
<p>The persistence provider must implement the
<code>PersistenceProvider</code> SPI.</p>
</div>
<div class="paragraph">
<p>In Jakarta EE environments, the persistence
provider must process the metadata that is passed to it at the time
<code>createContainerEntityManagerFactory</code> method is called and create an
instance of <code>EntityManagerFactory</code> using the <code>PersistenceUnitInfo</code>
metadata for the factory. The factory is then returned to the container.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, the persistence
provider must validate the <code>persistence.xml</code> file against the
<code>persistence</code> schema that corresponds to the version specified by the
<code>persistence.xml</code> file and report any validation errors.</p>
</div>
<div class="paragraph">
<p>The persistence provider processes the
metadata annotations on the managed classes of the persistence unit.</p>
</div>
<div class="paragraph">
<p>When the entity manager factory for a
persistence unit is created, it is the responsibility of the persistence
provider to initialize the state of the metamodel classes of the
persistence unit.</p>
</div>
<div class="paragraph">
<p>When the persistence provider obtains an
object/relational mapping file, it processes the definitions that it
contains. The persistence provider must validate any object/relational
mapping files against the object/relational mapping schema version
specified by the object/relational mapping file and report any
validation errors. The object relational mapping file must specify the
object/relational mapping schema that it is written against by
indicating the <code>version</code> element.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, the application can
pass the <code>ValidatorFactory</code> instance via the map that is passed as an
argument to the <code>Persistence.createEntityManagerFactory</code> call. The map
key used must be the standard property name
<code>jakarta.persistence.validation.factory</code>. If no <code>ValidatorFactory</code>
instance is provided by the application, and if a Bean Validation
provider is present in the classpath, the persistence provider must
instantiate the <code>ValidatorFactory</code> using the default bootstrapping
approach as defined by the Bean Validation specification
<a href="#a19498">[5]</a>, namely
<code>Validation.buildDefaultValidatorFactory()</code>.</p>
</div>
<div class="sect3">
<h4 id="jakarta-persistence-spi-persistenceprovider"><a class="anchor" href="#jakarta-persistence-spi-persistenceprovider"></a>9.5.1. jakarta.persistence.spi.PersistenceProvider</h4>
<div class="paragraph">
<p>The <code>PersistenceProvider</code> interface found in <a href="#_persistenceprovider_">Section E.3</a>
must be implemented by the persistence provider.</p>
</div>
<div class="paragraph">
<p>The <code>PersistenceProvider</code> implementation class must have a public
constructor with no parameters.</p>
</div>
<div class="paragraph">
<p>An instance of <code>PersistenceProvider</code> is responsible for creating
provider-specific implementations of <code>EntityManagerFactory</code>. It
is invoked by the container in Jakarta EE environments and by the
<code>jakarta.persistence.Persistence</code> class in Java SE environments. The
<code>jakarta.persistence.spi.PersistenceProvider</code> implementation is not
intended to be used by the application.</p>
</div>
<div class="paragraph">
<p>The properties passed to the <code>createEntityManagerFactory()</code> method
in Java SE environments are described further in <a href="#a13443">Section 9.7</a> below.</p>
</div>
</div>
<div class="sect3">
<h4 id="jakarta-persistence-spi-providerutil"><a class="anchor" href="#jakarta-persistence-spi-providerutil"></a>9.5.2. jakarta.persistence.spi.ProviderUtil</h4>
<div class="paragraph">
<p>The <code>ProviderUtil</code> interface found in <a href="#_providerutil_">Section E.7</a> is called by
the <code>PersistenceUtil</code> implementation to determine the load status of
an entity or entity attribute. It is not intended to be invoked by the
application.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13160"><a class="anchor" href="#a13160"></a>9.6. jakarta.persistence.spi.PersistenceUnitInfo Interface</h3>
<div class="paragraph">
<p>The <code>PersistenceUnitInfo</code> interface may be found in <a href="#_persistenceunitinfo_">Section E.6</a>.</p>
</div>
<div class="paragraph">
<p>The enum <code>jakarta.persistence.spi.PersistenceUnitTransactionType</code>
defines whether the entity managers created by the factory will be
JTA or resource-local entity managers. This enum is deprecated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Specifies whether entity managers created by the
 * {@link jakarta.persistence.EntityManagerFactory}
 * are JTA or resource-local entity managers.
 *
 * @since 1.0
 *
 * @deprecated replaced by
 * {@link jakarta.persistence.PersistenceUnitTransactionType}
 */</span>
<span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>, forRemoval = <span class="predefined-constant">true</span>)
<span class="directive">public</span> <span class="type">enum</span> PersistenceUnitTransactionType {

    <span class="comment">/** JTA entity managers are created. */</span>
    JTA,
        
    <span class="comment">/** Resource-local entity managers are created. */</span>
    RESOURCE_LOCAL
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The enum <code>jakarta.persistence.SharedCacheMode</code>
defines the use of caching. The <code>persistence.xml</code> <code>shared-cache-mode</code>
element has no default value. The <code>getSharedCacheMode</code> method must
return <code>UNSPECIFIED</code> if the <code>shared-cache-mode</code> element has not been
specified for the persistence unit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.spi.PersistenceUnitInfo</span>;

<span class="comment">/**
 * Specifies how the provider must use a second-level cache for the
 * persistence unit. Corresponds to the value of the {@code persistence.xml}
 * {@code shared-cache-mode} element, and returned as the result of
 * {@link PersistenceUnitInfo#getSharedCacheMode()}.
 * 
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> SharedCacheMode {

    <span class="comment">/**
     * All entities and entity-related state and data are cached.
     */</span>
    ALL, 

    <span class="comment">/**
     * Caching is disabled for the persistence unit.
     */</span>
    NONE, 

    <span class="comment">/**
     * Caching is enabled for all entities for which
     * {@link Cacheable Cacheable(true)} is specified. All other
     * entities are not cached.
     */</span>
    ENABLE_SELECTIVE, 

    <span class="comment">/**
     * Caching is enabled for all entities except those for which
     * {@link Cacheable Cacheable(false)} is specified. Entities
     * for which {@code Cacheable(false)} is specified are not cached.
     */</span>
    DISABLE_SELECTIVE, 

    <span class="comment">/**
     * Caching behavior is undefined: provider-specific defaults may apply.
     */</span>
    UNSPECIFIED
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The enum <code>jakarta.persistence.ValidationMode</code>
defines the validation mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * The validation mode to be used by the provider for the persistence
 * unit.
 * 
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> ValidationMode {
   
    <span class="comment">/**
     * If a Bean Validation provider is present in the environment,
     * the persistence provider must perform the automatic validation
     * of entities. If no Bean Validation provider is present in the
     * environment, no lifecycle event validation takes place.
     * This is the default behavior.
     */</span>
    AUTO,

    <span class="comment">/**
     * The persistence provider must perform the lifecycle event
     * validation. It is an error if there is no Bean Validation
     * provider present in the environment.
     */</span>
    CALLBACK,

    <span class="comment">/**
     * The persistence provider must not perform lifecycle event
     * validation.
     */</span>
    NONE
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="jakarta-persistence-spi-classtransformer-interface"><a class="anchor" href="#jakarta-persistence-spi-classtransformer-interface"></a>9.6.1. jakarta.persistence.spi.ClassTransformer Interface</h4>
<div class="paragraph">
<p>The <code>ClassTransformer</code> interface found in <a href="#_classtransformer_">Section E.1</a> may be
implemented by a persistence provider to transform entities and managed
classes at class load time or at class redefinition time. A persistence
provider is not required to implement this interface.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13443"><a class="anchor" href="#a13443"></a>9.7. jakarta.persistence.Persistence Class</h3>
<div class="paragraph">
<p>The <code>Persistence</code> class may be found in <a href="#_persistence_">Section B.17</a>.</p>
</div>
<div class="paragraph">
<p>The <code>Persistence</code> class is used to obtain an <code>EntityManagerFactory</code> instance
in Java SE environments. It may also be used for schema generationi.e., to
create database schemas and/or tables and/or to create DDL scripts.</p>
</div>
<div class="paragraph">
<p>The <code>Persistence</code> class is also available in a Jakarta EE container environment;
however, support for the Java SE bootstrapping APIs is not required in container
environments.</p>
</div>
<div class="paragraph">
<p>The <code>Persistence</code> class is used to obtain a <code>PersistenceUtil</code> instance in both
Jakarta EE and Java SE environments.</p>
</div>
<div class="paragraph">
<p>The <code>properties</code> argument passed to the <code>createEntityManagerFactory</code>
method is used to specify both standard and vendor-specific properties
and hints intended for use in creating the entity manager factory and
controlling its behavior.</p>
</div>
<div class="paragraph">
<p>The following properties correspond to the elements and attributes in the
<code>persistence.xml</code> file. When any of these properties are specified in the
<code>Map</code> parameter passed to the <code>createEntityManagerFactory</code> method, their
values override the values of the corresponding elements and attributes
in the <code>persistence.xml</code> file for the named persistence unit. They also
override any defaults that the persistence provider might have applied.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 10%;">
<col style="width: 25%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Corresponding element in <code>persistence.xml</code></th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12300">Section 8.2.1.4</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.qualifiers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qualifier</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12310">Section 8.2.1.5</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.scope</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12310">Section 8.2.1.5</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.transactionType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>transaction-type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12296">Section 8.2.1.2</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.jtaDataSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jta-data-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12302">Section 8.2.1.7</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.nonJtaDataSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>non-jta-data-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12302">Section 8.2.1.7</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.sharedCache.mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shared-cache-mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12380">Section 8.2.1.9</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.validation.mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>validation-mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Legal values are " <code>auto</code> ", " <code>callback</code> ", or " <code>none</code> ".
See <a href="#a12382">Section 8.2.1.10</a> and <a href="#a2374">Section 3.7.1.1</a>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following properties correspond to the  properties in the <code>persistence.xml</code>
ile. When any of these properties are specified in the <code>Map</code> parameter passed
to the <code>createEntityManagerFactory</code> method, their values override the values of
the corresponding properties in the <code>persistence.xml</code> file for the named
persistence unit. They also override any defaults that the persistence provider
might have applied.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 35%;">
<col style="width: 10%;">
<col style="width: 35%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Corresponding property in <code>persistence.xml</code></th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.lock.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code> or <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.lock.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hint only.
Value in milliseconds for pessimistic lock timeout.
See <a href="#a2132">Section 3.5.4.3</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.query.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code> or <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.query.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hint only.
Value in milliseconds for query timeout.
See <a href="#a4391">Section 3.11.4</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.validation.group.pre-persist</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.validation.group.pre-persist</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a> and <a href="#a2380">Section 3.7.1.2</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.validation.group.pre-update</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.validation.group.pre-update</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a> and <a href="#a2380">Section 3.7.1.2</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.validation.group.pre-remove</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.validation.group.pre-remove</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a> and <a href="#a2380">Section 3.7.1.2</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.create-script-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.create-script-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.drop-script-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.drop-script-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.sql-load-script-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.sql-load-script-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.database.action</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.database.action</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.scripts.action</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.scripts.action</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.create-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.create-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.drop-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.drop-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.scripts.create-target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.scripts.create-target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.scripts.drop-target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.schema-generation.scripts.drop-target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#a12384">Section 8.2.1.11</a>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following additional standard properties are defined by this specification
for the configuration of the entity manager factory:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.jdbc.driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fully qualified name of the driver class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.jdbc.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Driver-specific JDBC URL as a string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.jdbc.user</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username for database connection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.jdbc.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password for database connection authentication.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.dataSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance of <code>javax.sql.DataSource</code> to be used for the specified
persistence unit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.persistence.validation.factory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance of <code>jakarta.validation.ValidatorFactory</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Any number of vendor-specific properties may
also be included in the map. If a persistence provider does not
recognize a property (other than a property defined by this
specification), the provider must ignore it.</p>
</div>
<div class="paragraph">
<p>Vendors should use vendor namespaces for
properties (e.g., <code>com.acme.persistence.logging</code>). Entries that make
use of the namespace <code>jakarta.persistence</code> and its subnamespaces must not
be used for vendor-specific information. The namespace
<code>jakarta.persistence</code> is reserved for use by this specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="a13444"><a class="anchor" href="#a13444"></a>9.8. jakarta.persistence.PersistenceConfiguration Class</h3>
<div class="paragraph">
<p>The <code>PersistenceConfiguration</code> class found in <a href="#_persistenceconfiguration_">Section B.18</a>
is used to programmatically define and configure a persistence unit and create
an <code>EntityManagerFactory</code> instance directly. Thus, <code>PersistenceConfiguration</code>
is an alternative to XML-based configuration using <code>persistence.xml</code>, and so
the configuration options available via this API reflect the similarly-named
elements of <code>persistence.xml</code>. See <a href="#a12237">Section 8.2.1</a>.</p>
</div>
<div class="paragraph">
<p>A programmatically-configured persistence unit is considered a Java SE
persistence unit, even when this API is used within the Jakarta EE
environment.<sup class="footnote">[<a id="_footnoteref_102" class="footnote" href="#_footnotedef_102" title="View footnote.">102</a>]</sup></p>
</div>
<div class="paragraph">
<p>A persistence provider may define a subclass of <code>PersistenceConfiguration</code>
with vendor-specific configuration options. A provider must support
configuration via any instance of <code>PersistenceConfiguration</code> or of any
subclass of <code>PersistenceConfiguration</code>. If a subclass defines configuration
options the provider does not recognize, it should ignore those options.</p>
</div>
</div>
<div class="sect2">
<h3 id="persistenceutil-interface"><a class="anchor" href="#persistenceutil-interface"></a>9.9. PersistenceUtil Interface</h3>
<div class="paragraph">
<p>The <code>PersistenceUtil</code> interface found in <a href="#_persistenceutil_">Section B.19</a> is used to
determine the load state of entity instances. The semantics of the methods
of this interface are defined in <a href="#a13592">Section 9.9.1</a> below.</p>
</div>
<div class="sect3">
<h4 id="a13592"><a class="anchor" href="#a13592"></a>9.9.1. Contracts for Determining the Load State of an Entity or Entity Attribute</h4>
<div class="paragraph">
<p>The implementation of the
<code>PersistenceUtil.isLoaded(Object)</code> method must determine the list of
persistence providers available in the runtime
environment<sup class="footnote">[<a id="_footnoteref_103" class="footnote" href="#_footnotedef_103" title="View footnote.">103</a>]</sup> and call the
<code>ProviderUtil.isLoaded(Object)</code> method on each of them until either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one provider returns <code>LoadState.LOADED</code>. In
this case <code>PersistenceUtil.isLoaded</code> returns <code>true</code>.</p>
</li>
<li>
<p>one provider returns <code>LoadState.NOT_LOADED</code>.
In this case <code>PersistenceUtil.isLoaded</code> returns <code>false</code>.</p>
</li>
<li>
<p>all providers return <code>LoadState.UNKNOWN</code>. In
this case <code>PersistenceUtil.isLoaded</code> returns <code>true</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>PersistenceUtil</code> implementation
determines that only a single provider is available in the environment,
it is permitted to use provider-specific methods to determine the result
of <code>isLoaded(Object)</code> as long as the semantics defined in <a href="#a2019">Section 3.3.9</a> are observed.</p>
</div>
<div class="paragraph">
<p>The implementation of the
<em>PersistenceUtil.isLoaded(Object,String)</em> method must determine the list
of persistence providers available in the environment and call the
<code>ProviderUtil.isLoadedWithoutReference</code> method on each of them until
either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one provider returns <code>LoadState.LOADED</code>. In
this case <code>PersistenceUtil.isLoaded</code> returns <code>true</code>.</p>
</li>
<li>
<p>one provider returns <code>LoadState.NOT_LOADED</code>.
In this case <code>PersistenceUtil.isLoaded</code> returns <code>false</code>.</p>
</li>
<li>
<p>all providers return <code>LoadState.UNKNOWN</code>. In
this case, the <code>PersistenceUtil.isLoaded</code> method then calls
<code>ProviderUtil.isLoadedWithReference</code> on each of the providers until:</p>
<div class="ulist">
<ul>
<li>
<p>one provider returns <code>LoadState.LOADED</code>. In
this case <code>PersistenceUtil.isLoaded</code> return <code>true</code>.</p>
</li>
<li>
<p>one provider returns <code>LoadState.NOT_LOADED</code>.
In this case, <code>PersistenceUtil.isLoaded</code> returns <code>false</code>.</p>
</li>
<li>
<p>all providers return <code>LoadState.UNKNOWN</code>. In
this case, <code>PersistenceUtil.isLoaded</code> returns <code>true</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>PersistenceUtil</code> implementation
determines that only a single provider is available in the environment,
it is permitted to use provider specific methods to determine the result
of <em>isLoaded(Object, String)</em> as long as the semantics defined in
<a href="#a2019">Section 3.3.9</a> are observed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The rationale for splitting the
determination of load state between the methods isLoadedWithoutReference
and isLoadedWithReference is the following.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><em>It is assumed that the provider that loaded
the entity is present in the environment.</em></p>
</li>
<li>
<p><em>Providers that use bytecode enhancement
don&#8217;t need to access an attribute reference to determine its load state,
and can determine if the entity has been provided by them.</em></p>
</li>
<li>
<p><em>By first querying all providers using
bytecode enhancement, it is insured that no attribute will be loaded by
side effect.</em></p>
</li>
<li>
<p><em>Proxy-based providers do need to access an
attribute reference to determine load state, but will not trigger
attribute loading as a side effect.</em></p>
</li>
<li>
<p><em>If no provider recognizes an entity as
provided by it, it is assumed to be an object that is not instrumented
and is considered loaded.</em></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="metadata-annotations"><a class="anchor" href="#metadata-annotations"></a>10. Metadata Annotations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter and chapter <a href="#a13915">Chapter 11</a>
define the metadata annotations introduced by this specification.</p>
</div>
<div class="paragraph">
<p>The XML schema defined in chapter
<a href="#a16944">Chapter 12</a> provides an alternative to the use of metadata annotations.</p>
</div>
<div class="paragraph">
<p>These annotations and types are in the package <code>jakarta.persistence</code>.</p>
</div>
<div class="sect2">
<h3 id="entity"><a class="anchor" href="#entity"></a>10.1. Entity</h3>
<div class="paragraph">
<p>The <code>Entity</code> annotation specifies that the
class is an entity. This annotation is applied to the entity class.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> annotation element specifies the
entity name. If the <code>name</code> element is not specified, the entity name
defaults to the unqualified name of the entity class. This name is used
to refer to the entity in queries.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Documented</span>
<span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">Entity</span> {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="callback-annotations"><a class="anchor" href="#callback-annotations"></a>10.2. Callback Annotations</h3>
<div class="paragraph">
<p>The <code>EntityListeners</code> annotation specifies
the callback listener classes to be used for an entity or mapped
superclass. The <code>EntityListeners</code> annotation may be applied to an entity
class or mapped superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> EntityListeners {
    <span class="predefined-type">Class</span><span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ExcludeSuperclassListeners annotation
specifies that the invocation of superclass listeners is to be excluded
for the entity class (or mapped superclass) and its subclasses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ExcludeSuperclassListeners {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ExcludeDefaultListeners annotation
specifies that the invocation of default listeners is to be excluded for
the entity class (or mapped superclass) and its subclasses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ExcludeDefaultListeners {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following annotations are used to specify
callback methods for the corresponding lifecycle events. These
annotations may be applied to methods of an entity class, of a mapped
superclass, or of an entity listener class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PrePersist {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PostPersist {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PreRemove {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PostRemove {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PreUpdate {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PostUpdate {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PostLoad {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13662"><a class="anchor" href="#a13662"></a>10.3. EntityGraph Annotations</h3>
<div class="sect3">
<h4 id="namedentitygraph-and-namedentitygraphs-annotations"><a class="anchor" href="#namedentitygraph-and-namedentitygraphs-annotations"></a>10.3.1. NamedEntityGraph and NamedEntityGraphs Annotations</h4>
<div class="paragraph">
<p>The <code>NamedEntityGraph</code> annotation defines a named entity graph. The
annotation must be applied to the root entity of the graph, and specifies
the limits of the graph of associated attributes and entities fetched when
an operation which retrieves an instance or instances of the root entity is
executed.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> element assigns a name to the entity graph, and is used to
identify the entity graph in calls to <code>EntityManager.getEntityGraph()</code>.
If no name is explicitly specified, the name defaults to the entity name
of the annotated root entity. Entity graph names must be unique within the
persistence unit.</p>
</div>
<div class="paragraph">
<p>The <code>attributeNodes</code> element lists attributes
of the annotated entity class that are to be included in the entity
graph.</p>
</div>
<div class="paragraph">
<p>The <code>includeAllAttributes</code> element specifies
that all attributes of the annotated entity class are to be included in
the entity graph. An <code>attributeNode</code> element may still be used in
conjunction with this element to specify a subgraph for the attribute.</p>
</div>
<div class="paragraph">
<p>The <code>subgraphs</code> element specifies a list of
subgraphs, further specifying attributes that are managed types. These
subgraphs are referenced by name from <code>NamedAttributeNode</code> definitions.</p>
</div>
<div class="paragraph">
<p>The <code>subclassSubgraphs</code> element specifies a
list of subgraphs that add additional attributes for subclasses of the
root entity to which the annotation is applied.</p>
</div>
<div class="paragraph">
<p>The <code>NamedEntityGraphs</code> annotation can be
used to specify multiple named entity graphs for the entity to which it
is applied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(NamedEntityGraphs.class)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedEntityGraph {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    NamedAttributeNode<span class="type">[]</span> attributeNodes() <span class="keyword">default</span> {};
    <span class="type">boolean</span> includeAllAttributes() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    NamedSubgraph<span class="type">[]</span> subgraphs() <span class="keyword">default</span> {};
    NamedSubgraph<span class="type">[]</span> subclassSubgraphs() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedEntityGraphs {
    NamedEntityGraph<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="namedattributenode-annotation"><a class="anchor" href="#namedattributenode-annotation"></a>10.3.2. NamedAttributeNode Annotation</h4>
<div class="paragraph">
<p>The <code>NamedAttributeNode</code> annotation is used
to specify an attribute node of within an entity graph or subgraph.</p>
</div>
<div class="paragraph">
<p>The <code>value</code> element specifies the name of the
corresponding attribute.</p>
</div>
<div class="paragraph">
<p>The <code>subgraph</code> element is used to refer to a
<code>NamedSubgraph</code> specification that further characterizes an attribute
node corresponding to a managed type (entity or embeddable). The value
of the <code>subgraph</code> element must correspond to the <code>name</code> used for the
subgraph in the <code>NamedSubgraph</code> element. If the referenced attribute is
an entity which has entity subclasses, there may be more than one
<code>NamedSubgraph</code> element with this name, and the <code>subgraph</code> element is
considered to refer to all of these.</p>
</div>
<div class="paragraph">
<p>The <code>keySubgraph</code> element is used to refer to
a <code>NamedSubgraph</code> specification that further characterizes an attribute
node corresponding to the key of a Map-valued attribute. The value of
the the <code>keySubgraph</code> element must correspond to the <code>name</code> used for the
subgraph in the <code>NamedSubgraph</code> element. If the referenced attribute is
an entity which has entity subclasses, there may be more than one
<code>NamedSubgraph</code> element with this name, and the <code>keySubgraph</code> element is
considered to refer to all of these.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedAttributeNode {
    <span class="predefined-type">String</span> value();
    <span class="predefined-type">String</span> subgraph() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> keySubgraph() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="namedsubgraph-annotation"><a class="anchor" href="#namedsubgraph-annotation"></a>10.3.3. NamedSubgraph Annotation</h4>
<div class="paragraph">
<p>The <code>NamedSubgraph</code> annotation is used to
further define an attribute node. It is referenced by its name from the
<code>subgraph</code> or <code>keySubgraph</code> element of a <code>NamedAttributeNode</code> element.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> element is the name used to
reference the subgraph from a <code>NamedAttributeNode</code> definition. In the
case of entity inheritance, multiple subgraph elements have the same
name.</p>
</div>
<div class="paragraph">
<p>The <code>type</code> element must be specified when the
subgraph corresponds to a subclass of the entity type corresponding to
the referencing attribute node.</p>
</div>
<div class="paragraph">
<p>The <code>attributeNodes</code> element lists attributes
of the class that must be included. If the subgraph corresponds to a
subclass of the class referenced by the corresponding attribute node,
only subclass-specific attributes are listed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedSubgraph {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">Class</span> type() <span class="keyword">default</span> <span class="type">void</span>.class;
    NamedAttributeNode<span class="type">[]</span> attributeNodes();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13710"><a class="anchor" href="#a13710"></a>10.4. Annotations for Queries</h3>
<div class="paragraph">
<p>The following annotations are used to declare named queries.</p>
</div>
<div class="sect3">
<h4 id="a13711"><a class="anchor" href="#a13711"></a>10.4.1. NamedQuery Annotation</h4>
<div class="paragraph">
<p>The <code>NamedQuery</code> annotation declared a named query written in the Jakarta
Persistence query language.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> element assigns a name to the query, which is used to identify
the query in calls to <code>EntityManager.createNamedQuery()</code>.</p>
</div>
<div class="paragraph">
<p>The <code>query</code> element must specify a query string itself, written in the
Jakarta Persistence query language.</p>
</div>
<div class="paragraph">
<p>The <code>resultClass</code> element specifies the Java class of each query result.
The query result class may be overridden by explicitly passing a <code>Class</code>
object to <code>EntityManager.createNamedQuery(String, Class)</code>. If the
<code>resultClass</code> element of a <code>NamedQuery</code> annotation is not specified, the
persistence implementation is entitled to default the result class to
<code>Object</code> or <code>Object[]</code>.</p>
</div>
<div class="paragraph">
<p>The <code>lockMode</code> element specifies a lock mode for the entity instances in
results returned by the query. If a lock mode other than <code>NONE</code> is
specified, the query may only be executed within a persistence context
with an associated active transaction.</p>
</div>
<div class="paragraph">
<p>The <code>hints</code> elements may be used to specify query properties and hints.
Properties defined by this specification must be observed by the provider;
hints defined by this specification should be observed by the provider
when possible. Vendor-specific hints that are not recognized by a provider
must be ignored.</p>
</div>
<div class="paragraph">
<p>The <code>NamedQuery</code> and <code>NamedQueries</code> annotations can be applied to an entity
or mapped superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(NamedQueries.class)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedQuery {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> query();
    <span class="predefined-type">Class</span>&lt;?&gt; resultClass() <span class="keyword">default</span> <span class="type">void</span>.class;
    LockModeType lockMode() <span class="keyword">default</span> NONE;
    QueryHint<span class="type">[]</span> hints() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> QueryHint {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> value();
}

<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedQueries {
    NamedQuery<span class="type">[]</span> value ();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="namednativequery-annotation"><a class="anchor" href="#namednativequery-annotation"></a>10.4.2. NamedNativeQuery Annotation</h4>
<div class="paragraph">
<p>The <code>NamedNativeQuery</code> annotation defines a named native SQL query.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> element assigns a name to the query, which is used to identify
the query in calls to <code>EntityManager.createNamedQuery()</code>.</p>
</div>
<div class="paragraph">
<p>The <code>query</code> element must specify the query string itself, written in the
native SQL dialect of the database.</p>
</div>
<div class="paragraph">
<p>The <code>resultClass</code> element specifies the class of each query result. If a
result set mapping is specified, the specified result class must agree
with the type inferred from the result set mapping. If a <code>resultClass</code> is
not explicitly specified, then it is inferred from the result set mapping,
if any, or defaults to <code>Object</code> or <code>Object[]</code>. The query result class may
be overridden by explicitly passing a <code>Class</code> object to
<code>EntityManager.createNamedQuery(String, Class)</code>.</p>
</div>
<div class="paragraph">
<p>The <code>resultSetMapping</code> element specifies the name of a <code>SqlResultSetMapping</code>
specification defined elsewhere in metadata. The named <code>SqlResultSetMapping</code>
is used to interpret the result set of the native SQL query. Alternatively,
the elements <code>entities</code>, <code>classes</code>, and <code>columns</code> may be used to specify a
result set mapping. These elements may not be used in conjunction with
<code>resultSetMapping</code>.</p>
</div>
<div class="paragraph">
<p>The <code>hints</code> element may be used to specify query properties and hints.
Hints defined by this specification should be observed by the provider
when possible. Vendor-specific hints which are not recognized by the
provider must be ignored.</p>
</div>
<div class="paragraph">
<p>The <code>NamedNativeQuery</code> and <code>NamedNativeQueries</code> annotations can be applied
to an entity or mapped superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(NamedNativeQueries.class)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedNativeQuery {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> query();
    QueryHint<span class="type">[]</span> hints() <span class="keyword">default</span> {};
    <span class="predefined-type">Class</span> resultClass() <span class="keyword">default</span> <span class="type">void</span>.class;
    <span class="predefined-type">String</span> resultSetMapping() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    EntityResult<span class="type">[]</span> entities() <span class="keyword">default</span> {};
    ConstructorResult<span class="type">[]</span> classes() <span class="keyword">default</span> {};
    ColumnResult<span class="type">[]</span> columns() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedNativeQueries {
    NamedNativeQuery<span class="type">[]</span> value ();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a13759"><a class="anchor" href="#a13759"></a>10.4.3. NamedStoredProcedureQuery Annotation</h4>
<div class="paragraph">
<p>The <code>NamedStoredProcedureQuery</code> annotation is
used to specify a stored procedure, its parameters, and its result type.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> element is the name that is passed
as an argument to the <code>createNamedStoredProcedureQuery</code> method to create
an executable <code>StoredProcedureQuery</code> object.</p>
</div>
<div class="paragraph">
<p>The <code>procedureName</code> element is the name of
the stored procedure in the database.</p>
</div>
<div class="paragraph">
<p>The parameters of the stored procedure are
specified by the <code>parameters</code> element. All parameters must be specified
in the order in which they occur in the parameter list of the stored
procedure.</p>
</div>
<div class="paragraph">
<p>The <code>resultClasses</code> element refers to the
class (or classes) that are used to map the results. The
<code>resultSetMappings</code> element names one or more result set mappings, as
defined by the <code>SqlResultSetMapping</code> annotation.</p>
</div>
<div class="paragraph">
<p>If there are multiple result sets, it is
assumed that they will be mapped using the same mechanisme.g., either
all via a set of result class mappings or all via a set of result set
mappings. The order of the specification of these mappings must be the
same as the order in which the result sets will be returned by the
stored procedure invocation. If the stored procedure returns one or more
result sets and no <code>resultClasses</code> or <code>resultSetMappings</code> element is
specified, any result set will be returned as a list of type <code>Object[]</code>
. The combining of different strategies for the mapping of stored
procedure result sets is undefined.</p>
</div>
<div class="paragraph">
<p>The <code>hints</code> element may be used to specify
query properties and hints. Properties defined by this specification
must be observed by the provider. Vendor-specific hints that are not
recognized by a provider must be ignored.</p>
</div>
<div class="paragraph">
<p>The <code>NamedStoredProcedureQuery</code> and
<code>NamedStoredProcedureQueries</code> annotations can be applied to an entity or
mapped superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(NamedStoredProcedureQueries.class)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedStoredProcedureQuery {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> procedureName();
    StoredProcedureParameter<span class="type">[]</span> parameters() <span class="keyword">default</span> {};
    <span class="predefined-type">Class</span><span class="type">[]</span> resultClasses() <span class="keyword">default</span> {};
    <span class="predefined-type">String</span><span class="type">[]</span> resultSetMappings() <span class="keyword">default</span> {};
    QueryHint<span class="type">[]</span> hints() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedStoredProcedureQueries {
    NamedStoredProcedureQuery <span class="type">[]</span> value;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All parameters of a named stored procedure
query must be specified using the <code>StoredProcedureParameter</code> annotation.
The <code>name</code> element refers to the name of the parameter as defined by the
stored procedure in the database. If a parameter name is not specified,
it is assumed that the stored procedure uses positional parameters. The
<code>mode</code> element specifies whether the parameter is an IN, INOUT, OUT, or
REF_CURSOR parameter. REF_CURSOR parameters are used by some databases
to return result sets from stored procedures. The <code>type</code> element refers
to the JDBC type for the parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> StoredProcedureParameter {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ParameterMode mode() <span class="keyword">default</span> ParameterMode.IN;
    <span class="predefined-type">Class</span> type();
}

<span class="directive">public</span> <span class="type">enum</span> ParameterMode {
    IN,
    INOUT,
    OUT,
    REF_CURSOR
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a13797"><a class="anchor" href="#a13797"></a>10.4.4. Annotations for SQL Result Set Mappings</h4>
<div class="paragraph">
<p>The <code>SqlResultSetMapping</code> annotation is used to specify the mapping of
the result set of a native SQL query or stored procedure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(SqlResultSetMappings.class)
<span class="directive">public</span> <span class="annotation">@interface</span> SqlResultSetMapping {
    <span class="predefined-type">String</span> name();
    EntityResult<span class="type">[]</span> entities() <span class="keyword">default</span> {};
    ConstructorResult<span class="type">[]</span> classes() <span class="keyword">default</span> {};
    ColumnResult<span class="type">[]</span> columns() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> SqlResultSetMappings {
    SqlResultSetMapping<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> element is the name given to the result set mapping, and is
used to identify it when calling methods of the <code>EntityManager</code> which
create instances of <code>Query</code> and <code>StoredProcedureQuery</code>. The <code>entities</code>,
<code>classes</code>, and <code>columns</code> elements are used to specify the mapping of
result set columns to entities, to constructors, and to scalar values,
respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> EntityResult {
    <span class="predefined-type">Class</span> entityClass();
    LockModeType lockMode() <span class="keyword">default</span> LockModeType.OPTIMISTIC;
    FieldResult<span class="type">[]</span> fields() <span class="keyword">default</span> {};
    <span class="predefined-type">String</span> discriminatorColumn() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>entityClass</code> element specifies the class of the result.</p>
</div>
<div class="paragraph">
<p>The <code>lockMode</code> element specifies the <code>LockModeType</code> obtained when the
native SQL query is executed.</p>
</div>
<div class="paragraph">
<p>The <code>fields</code> element is used to map the columns specified in the SELECT
list of the query to the properties or fields of the entity class.</p>
</div>
<div class="paragraph">
<p>The <code>discriminatorColumn</code> element is used to specify the column name
(or alias) of the column in the SELECT list that is used to determine
the type of the entity instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> FieldResult {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> column();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> element is the name of the persistent field or property of
the class.</p>
</div>
<div class="paragraph">
<p>The <code>column</code> element specifies the name of the corresponding column in
the SELECT listi.e., column alias, if applicable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>(value={})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ConstructorResult {
    <span class="predefined-type">Class</span> targetClass();
    ColumnResult<span class="type">[]</span> columns();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>targetClass</code> element specifies the class whose constructor is to
be invoked.</p>
</div>
<div class="paragraph">
<p>The <code>columns</code> element specifies the mapping of columns in the SELECT
list to the arguments of the intended constructor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ColumnResult {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">Class</span> type() <span class="keyword">default</span> <span class="type">void</span>.class;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> element specifies the name of the column in the SELECT list.</p>
</div>
<div class="paragraph">
<p>The <code>type</code> element specifies the Java type to which the column type is
to be mapped. If the <code>type</code> element is not specified, the default JDBC
type mapping for the column will be used.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-to-entitymanager-and-entitymanagerfactory"><a class="anchor" href="#references-to-entitymanager-and-entitymanagerfactory"></a>10.5. References to EntityManager and EntityManagerFactory</h3>
<div class="paragraph">
<p>These annotations are used to express
dependencies on entity managers and entity manager factories.</p>
</div>
<div class="sect3">
<h4 id="persistencecontext-annotation"><a class="anchor" href="#persistencecontext-annotation"></a>10.5.1. PersistenceContext Annotation</h4>
<div class="paragraph">
<p>The <code>PersistenceContext</code> annotation is used
to express a dependency on a container-managed entity manager and its
associated persistence context.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> element refers to the name by
which the entity manager is to be accessed in the environment
referencing context, and is not needed when dependency injection is
used.</p>
</div>
<div class="paragraph">
<p>The optional <code>unitName</code> element refers to the
name of the persistence unit. If the <code>unitName</code> element is specified,
the persistence unit for the entity manager that is accessible in JNDI
must have the same name.</p>
</div>
<div class="paragraph">
<p>The <code>type</code> element specifies whether a
transaction-scoped or extended persistence context is to be used. If the
<code>type</code> element is not specified, a transaction-scoped persistence
context is used.</p>
</div>
<div class="paragraph">
<p>The <code>synchronizationType</code> element specifies
whether the persistence context is always automatically synchronized
with the current transaction or whether the persistence context must be
explicitly joined to the current transaction by means of the
EntityManager <code>joinTransaction</code> method.</p>
</div>
<div class="paragraph">
<p>The optional <code>properties</code> element may be used
to specify properties for the container or persistence provider.
Properties defined by this specification must be observed by the
provider. Vendor specific properties may be included in the set of
properties, and are passed to the persistence provider by the container
when the entity manager is created. Properties that are not recognized
by a vendor must be ignored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(PersistenceContexts.class)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceContext {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> unitName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    PersistenceContextType type() <span class="keyword">default</span> TRANSACTION;
    SynchronizationType synchronization() <span class="keyword">default</span> SYNCHRONIZED;
    PersistenceProperty<span class="type">[]</span> properties() <span class="keyword">default</span> {};
}

<span class="directive">public</span> <span class="type">enum</span> PersistenceContextType {
    TRANSACTION,
    EXTENDED
}

<span class="directive">public</span> <span class="type">enum</span> SynchronizationType {
    SYNCHRONIZED,
    UNSYNCHRONIZED
}

<span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceProperty {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>PersistenceContexts</code> annotation declares
one or more <code>PersistenceContext</code> annotations. It is used to express a
dependency on multiple persistence contexts<sup class="footnote">[<a id="_footnoteref_104" class="footnote" href="#_footnotedef_104" title="View footnote.">104</a>]</sup>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceContexts {
    PersistenceContext<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a13887"><a class="anchor" href="#a13887"></a>10.5.2. PersistenceUnit Annotation</h4>
<div class="paragraph">
<p>The <code>PersistenceUnit</code> annotation is used to
express a dependency on an entity manager factory and its associated
persistence unit.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> element refers to the name by
which the entity manager factory is to be accessed in the environment
referencing context, and is not needed when dependency injection is
used.</p>
</div>
<div class="paragraph">
<p>The optional <code>unitName</code> element refers to the
name of the persistence unit as defined in the <code>persistence.xml</code> file.
If the <code>unitName</code> element is specified, the persistence unit for the
entity manager factory that is accessible in JNDI must have the same
name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(PersistenceUnits.class)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceUnit {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> unitName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>PersistenceUnits</code> annotation declares
one or more <code>PersistenceUnit</code> annotations. It is used to express a
dependency on multiple persistence units<sup class="footnote">[<a id="_footnoteref_105" class="footnote" href="#_footnotedef_105" title="View footnote.">105</a>]</sup>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceUnits {
    PersistenceUnit<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13903"><a class="anchor" href="#a13903"></a>10.6. Annotations for Attribute Converter Classes</h3>
<div class="paragraph">
<p>The <code>Converter</code> annotation declares that the annotated class is a converter
and specifies whether the converter is applied automatically. Every converter
class must implement <code>AttributeConverter</code>  and must be annotated with the
<code>Converter</code> annotation or declared as a converter in the XML descriptor. The
target type for a converter is determined by the actual type argument of the
first type parameter of <code>AttributeConverter</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Converter {
    <span class="type">boolean</span> autoApply() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>autoApply</code> element is specified as <code>true</code>, the persistence provider
must automatically apply the converter to every mapped attribute of the
specified target type belonging to any entity in the persistence unit, except
for attributes for which conversion is overridden by means of the <code>Convert</code>
annotation (or XML equivalent). The <code>Convert</code> annotation is described in
<a href="#a14398">Section 11.1.10</a>. The <code>Convert</code> annotation may be used to override or disable
auto-apply conversion on a per-attribute basis.</p>
</div>
<div class="paragraph">
<p>In determining whether a converter applies to an attribute, the provider
must treat primitive types and wrapper types as equivalent.</p>
</div>
<div class="paragraph">
<p>A converter never applies to id attributes, version attributes,
relationship attributes, or to attributes explicitly annotated as
<code>Enumerated</code> or <code>Temporal</code> (or designated as such via XML).</p>
</div>
<div class="paragraph">
<p>A converter never applies to any attribute annotated
<code>@Convert(disableConversion=true)</code> or to an attribute for which the
<code>Convert</code> annotation explicitly specifies a different converter.</p>
</div>
<div class="paragraph">
<p>If <code>autoApply</code> is <code>false</code>, the converter applies only to attributes of the
target type for which conversion is explicitly enabled via the <code>Convert</code>
annotation (or corresponding XML element).</p>
</div>
<div class="paragraph">
<p>If there is more than one converter defined for the same target type,
the <code>Convert</code> annotation must be used to explicitly specify which
converter applies.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a13915"><a class="anchor" href="#a13915"></a>11. Metadata for Object/Relational Mapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The object/relational mapping metadata is
part of the application domain model contract. It expresses requirements
and expectations on the part of the application as to the mapping of the
entities and relationships of the application domain to a database.
Queries (and, in particular, SQL queries) written against the database
schema that corresponds to the application domain model are dependent
upon the mappings expressed by means of the object/relational mapping
metadata. The implementation of this specification must assume this
application dependency upon the object/relational mapping metadata and
insure that the semantics and requirements expressed by that mapping are
observed.</p>
</div>
<div class="paragraph">
<p>The use of object/relational mapping metadata
to control schema generation is specified in <a href="#a16444">Section 11.2</a>.</p>
</div>
<div class="sect2">
<h3 id="annotations-for-objectrelational-mapping"><a class="anchor" href="#annotations-for-objectrelational-mapping"></a>11.1. Annotations for Object/Relational Mapping</h3>
<div class="paragraph">
<p>These annotations and types are in the
package <code>jakarta.persistence</code>.</p>
</div>
<div class="paragraph">
<p>XML metadata may be used as an alternative to
these annotations, or to override or augment annotations, as described
in <a href="#a16944">Chapter 12</a>.</p>
</div>
<div class="sect3">
<h4 id="a13941"><a class="anchor" href="#a13941"></a>11.1.1. Access Annotation</h4>
<div class="paragraph">
<p>The <code>Access</code> annotation is used to specify an
access type to be applied to an entity class, mapped superclass, or
embeddable class, or to a specific attribute of such a class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Access {
    AccessType value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a13935">Table 4</a> lists the annotation elements that may be specified
for the <code>Access</code> annotation.</p>
</div>
<table id="a13935" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Access Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AccessType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The access type to be applied to the class or attribute.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a13942"><a class="anchor" href="#a13942"></a>11.1.2. AssociationOverride Annotation</h4>
<div class="paragraph">
<p>The <code>AssociationOverride</code> annotation is used
to override a mapping for an entity relationship.</p>
</div>
<div class="paragraph">
<p>The <code>AssociationOverride</code> annotation may be
applied to an entity that extends a mapped superclass to override a
relationship mapping defined by the mapped superclass. If the
<code>AssociationOverride</code> annotation is not specified, the association is
mapped the same as in the original mapping. When used to override a
mapping defined by a mapped superclass, the <code>AssociationOverride</code>
annotation is applied to the entity class.</p>
</div>
<div class="paragraph">
<p>The <code>AssociationOverride</code> annotation may be
used to override a relationship mapping from an embeddable within an
entity to another entity when the embeddable is on the owning side of
the relationship. When used to override a relationship mapping defined
by an embeddable class (including an embeddable class embedded within
another embeddable class), the <code>AssociationOverride</code> annotation is
applied to the field or property containing the embeddable.</p>
</div>
<div class="paragraph">
<p>When the <code>AssociationOverride</code>
annotation is used to override a relationship mapping from an embeddable
class, the <code>name</code> element specifies the referencing relationship field
or property within the embeddable class. To override mappings at
multiple levels of embedding, a dot (".") notation syntax must be used
in the <code>name</code> element to indicate an attribute within an embedded
attribute. The value of each identifier used with the dot notation is
the name of the respective embedded field or property. When the
<code>AssociationOverride</code> annotation is applied to override the mappings of
an embeddable class used as a map value, " <code>value.</code> " must be used to
prefix the name of the attribute within the embeddable class that is
being overridden in order to specify it as part of the map
value.<sup class="footnote">[<a id="_footnoteref_106" class="footnote" href="#_footnotedef_106" title="View footnote.">106</a>]</sup></p>
</div>
<div class="paragraph">
<p>If the relationship mapping is a
foreign key mapping, the <code>joinColumns</code> element of the
<code>AssociationOverride</code> annotation is used. If the relationship mapping
uses a join table, the <code>joinTable</code> element of the <code>AssociationOverride</code>
element must be specified to override the mapping of the join table
and/or its join columns.<sup class="footnote">[<a id="_footnoteref_107" class="footnote" href="#_footnotedef_107" title="View footnote.">107</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <code>joinColumns</code> element refers to the table
for the class that contains the annotation.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <code>joinColumns</code> element when table generation is in
effect. If both this element and the <code>foreignKey</code> element of any of the
<code>joinColumns</code> elements are specified, the behavior is undefined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(AssociationOverrides.class)
<span class="directive">public</span> <span class="annotation">@interface</span> AssociationOverride {
    <span class="predefined-type">String</span> name();

    JoinColumn<span class="type">[]</span> joinColumns() <span class="keyword">default</span> {};

    ForeignKey foreignKey() <span class="keyword">default</span>

    <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    JoinTable joinTable() <span class="keyword">default</span> <span class="annotation">@JoinTable</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a13960">Table 5</a> lists the annotation elements
that may be specified for the <code>AssociationOverride</code> annotation.</p>
</div>
<table id="a13960" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. AssociationOverride Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The name of the relationship
property whose mapping is being overridden if property-based access is
being used, or the name of the relationship field if field-based access
is used.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
join column(s) being mapped to the persistent attribute(s). The
joinColumns element must be specified if a foreign key mapping is used
in the overriding of the mapping of the relationship. The joinColumns
element must not be specified if a join table is used in the overriding
of the mapping of the relationship</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinTable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joinTable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
join table that maps the relationship. The joinTable element must be
specified if a join table is used in the overriding of the mapping of
the relationship. The joinTable element must not be specified if a
foreign key mapping is used in the overriding of the mapping of the
relationship.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MappedSuperclass</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">protected</span> Address address;

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() { ... }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) { ... }

    <span class="directive">public</span> Address getAddress() { ... }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) { ... }
}

<span class="annotation">@Entity</span>
<span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">PartTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// address field mapping overridden to ADDR_ID foreign key</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WAGE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">protected</span> <span class="predefined-type">Float</span> hourlyWage;

    <span class="directive">public</span> <span class="predefined-type">Float</span> getHourlyWage() { ... }

    <span class="directive">public</span> <span class="type">void</span> setHourlyWage(<span class="predefined-type">Float</span> wage) { ... }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Overriding of the mapping for
the <code>phoneNumbers</code> relationship defined in the <code>ContactInfo</code> embeddable
class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@AssociationOverride</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">phoneNumbers</span><span class="delimiter">&quot;</span></span>,
        joinTable=<span class="annotation">@JoinTable</span>(
            name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPPHONES</span><span class="delimiter">&quot;</span></span>,
            joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP</span><span class="delimiter">&quot;</span></span>),
            inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PHONE</span><span class="delimiter">&quot;</span></span>)
        )
    )
    <span class="annotation">@Embedded</span>
    ContactInfo contactInfo;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContactInfo</span> {
    <span class="annotation">@ManyToOne</span> Address address; <span class="comment">// Unidirectional</span>
    <span class="annotation">@ManyToMany</span>(targetEntity=PhoneNumber.class)
    <span class="predefined-type">List</span> phoneNumbers;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneNumber</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> number;

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo.phoneNumbers</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Employee&gt; employees;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="associationoverrides-annotation"><a class="anchor" href="#associationoverrides-annotation"></a>11.1.3. AssociationOverrides Annotation</h4>
<div class="paragraph">
<p>The mappings of multiple relationship
properties or fields may be overridden. The <code>AssociationOverrides</code>
annotation can be used for this purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> AssociationOverrides {
    AssociationOverride<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14040">Table 6</a> lists the annotation elements
that may be specified for the <code>AssociationOverrides</code> annotation.</p>
</div>
<table id="a14040" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. AssociationOverrides Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AssociationOverride[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required)
The association override mappings that are to be applied to the
relationship field or property.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MappedSuperclass</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">protected</span> Address address;

    <span class="annotation">@OneToOne</span>
    <span class="directive">protected</span> Locker locker;

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() { ... }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) { ... }

    <span class="directive">public</span> Address getAddress() { ... }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) { ... }

    <span class="directive">public</span> Locker getLocker() { ... }

    <span class="directive">public</span> <span class="type">void</span> setLocker(Locker locker) { ... }
}

<span class="annotation">@Entity</span>
<span class="annotation">@AssociationOverrides</span>({
    <span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>)),
    <span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">locker</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">LCKR_ID</span><span class="delimiter">&quot;</span></span>))})
<span class="directive">public</span> PartTimeEmployee { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>))
<span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">locker</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">LCKR_ID</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> PartTimeEmployee { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14084"><a class="anchor" href="#a14084"></a>11.1.4. AttributeOverride Annotation</h4>
<div class="paragraph">
<p>The <code>AttributeOverride</code> annotation is used to
override the mapping of a <code>Basic</code> (whether explicit or default) property
or field or <code>Id</code> property or field.</p>
</div>
<div class="paragraph">
<p>The <code>AttributeOverride</code> annotation may be
applied to an entity that extends a mapped superclass or to an embedded
field or property to override a <code>Basic</code> mapping or <code>Id</code> mapping defined
by the mapped superclass or embeddable class (or embeddable class of one
of its attributes).</p>
</div>
<div class="paragraph">
<p>The <code>AttributeOverride</code> annotation may be
applied to an element collection containing instances of an embeddable
class or to a map collection whose key and/or value is an embeddable
class. When the <code>AttributeOverride</code> annotation is applied to a map, "
<code>key.</code> " or " <code>value.</code> " must be used to prefix the name of the
attribute that is being overridden in order to specify it as part of the
map key or map value.</p>
</div>
<div class="paragraph">
<p>To override mappings at multiple levels of
embedding, a dot (".") notation form must be used in the <code>name</code> element
to indicate an attribute within an embedded attribute. The value of each
identifier used with the dot notation is the name of the respective
embedded field or property.</p>
</div>
<div class="paragraph">
<p>If the <code>AttributeOverride</code> annotation is not
specified, the column is mapped the same as in the original mapping.</p>
</div>
<div class="paragraph">
<p><a href="#a14100">Table 7</a> lists the annotation elements
that may be specified for the <code>AttributeOverride</code> annotation.</p>
</div>
<div class="paragraph">
<p>The <code>column</code> element refers to the table for
the class that contains the annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(AttributeOverrides.class)
<span class="directive">public</span> <span class="annotation">@interface</span> AttributeOverride {
    <span class="predefined-type">String</span> name();
    Column column();
}</code></pre>
</div>
</div>
<table id="a14100" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. AttributeOverride Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The name of the property whose
mapping is being overridden if property-based access is being used, or
the name of the field if field-based access is used.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The column that is being mapped
to the persistent attribute. The mapping type will remain the same as is
defined in the embeddable class or mapped superclass.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MappedSuperclass</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="directive">protected</span> <span class="predefined-type">String</span> address;

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() { ... }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) { ... }

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddress() { ... }

    <span class="directive">public</span> <span class="type">void</span> setAddress(<span class="predefined-type">String</span> address) { ... }
}

<span class="annotation">@Entity</span>
<span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">PartTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// address field mapping overridden to ADDR</span>
    <span class="directive">protected</span> <span class="predefined-type">Float</span> wage();

    <span class="directive">public</span> <span class="predefined-type">Float</span> getHourlyWage() { ... }

    <span class="directive">public</span> <span class="type">void</span> setHourlyWage(<span class="predefined-type">Float</span> wage) { ... }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span> <span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> street;

    <span class="directive">protected</span> <span class="predefined-type">String</span> city;

    <span class="directive">protected</span> <span class="predefined-type">String</span> state;

    <span class="annotation">@Embedded</span>
    <span class="directive">protected</span> Zipcode zipcode;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Zipcode</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> zip;
    <span class="directive">protected</span> <span class="predefined-type">String</span> plusFour;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> id;

    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">state</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_STATE</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode.zip</span><span class="delimiter">&quot;</span></span>, column= <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ZIP</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@Embedded</span>
    <span class="directive">protected</span> Address address;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PropertyRecord</span> {
    <span class="annotation">@EmbeddedId</span>
    PropertyOwner owner;

    <span class="annotation">@AttributeOverrides</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">key.street</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">STREET_NAME</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">value.size</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">SQUARE_FEET</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">value.tax</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ASSESSMENT</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@ElementCollection</span>
    <span class="predefined-type">Map</span>&lt;Address, PropertyInfo&gt; parcels;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PropertyInfo</span> {
    <span class="predefined-type">Integer</span> parcelNumber;
    <span class="predefined-type">Integer</span> size;
    <span class="predefined-type">BigDecimal</span> tax;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14178"><a class="anchor" href="#a14178"></a>11.1.5. AttributeOverrides Annotation</h4>
<div class="paragraph">
<p>The mappings of multiple properties or fields
may be overridden. The <code>AttributeOverrides</code> annotation can be used for
this purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> AttributeOverrides {
    AttributeOverride<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14187">Table 8</a> lists the annotation elements
that may be specified for the <code>AttributeOverrides</code> annotation.</p>
</div>
<table id="a14187" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. AttributeOverrides Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AttributeOverride[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required)
The AttributeOverride mappings that are to be applied to the field or
property.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@AttributeOverrides</span>({
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_START</span><span class="delimiter">&quot;</span></span>)),
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_END</span><span class="delimiter">&quot;</span></span>))
})
<span class="directive">public</span> EmploymentPeriod getEmploymentPeriod() { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14205"><a class="anchor" href="#a14205"></a>11.1.6. Basic Annotation</h4>
<div class="paragraph">
<p>The <code>Basic</code> annotation is the simplest type of mapping to a database column.
The <code>Basic</code> annotation may be applied to any persistent property or instance
variable whose type is one of the basic types listed in <a href="#a486">Section 2.6</a>.</p>
</div>
<div class="paragraph">
<p>For the types listed above, the persistence provider must support mappings
to the column types listed in tables B-2 and B-4 of Appendix B of the
JDBC 4.3 specification. See <a href="#a19496">[3]</a>. In addition, the provider must
support mapping:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.time.Instant</code> to the JDBC <code>TIMESTAMP</code> or <code>TIMESTAMP_WITH_TIMEZONE</code> type,</p>
</li>
<li>
<p><code>java.time.Year</code> to the JDBC <code>INTEGER</code> and <code>SMALLINT</code> types,</p>
</li>
<li>
<p><code>java.math.BigInteger</code> and <code>java.math.BigDecimal</code> to the JDBC <code>NUMERIC</code> and <code>DECIMAL</code> types,</p>
</li>
<li>
<p><code>java.util.UUID</code> to the JDBC <code>CHAR</code> and <code>VARCHAR</code> types, and</p>
</li>
<li>
<p><code>char[]</code> to the JDBC <code>CHAR</code>, <code>NCHAR</code>, <code>VARCHAR</code>, <code>NVARCHAR</code>, <code>LONGVARCHAR</code>,
and <code>LONGNVARCHAR</code> types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As described in <a href="#a511">Section 2.10</a>, the use of the <code>Basic</code>
annotation is optional for persistent fields and properties of the
types listed above. If the <code>Basic</code> annotation is not specified for such a field or
property, the default values of the <code>Basic</code> annotation will apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Basic {
    FetchType fetch() <span class="keyword">default</span> EAGER;
    <span class="type">boolean</span> optional() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14218">Table 9</a> lists the annotation elements that may be specified
for the <code>Basic</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>The <code>FetchType</code> enum defines strategies for
fetching data from the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> FetchType { LAZY, EAGER };</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>EAGER</code> strategy is a requirement on the
persistence provider runtime that data must be eagerly fetched. The
<code>LAZY</code> strategy is a <em>hint</em> to the persistence provider runtime that
data should be fetched lazily when it is first accessed. The
implementation is permitted to eagerly fetch data for which the <code>LAZY</code>
strategy hint has been specified. In particular, lazy fetching might
only be available for <code>Basic</code> mappings for which property-based access
is used.</p>
</div>
<div class="paragraph">
<p>The <code>optional</code> element is a hint as to
whether the value of the field or property may be null. It is
disregarded for primitive types.</p>
</div>
<table id="a14218" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Basic Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the value of the field or
property should be lazily loaded or must be eagerly fetched. The EAGER
strategy is a requirement on the persistence provider runtime that the
value must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAGER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the value of the field or
property may be null. This is a hint and is disregarded for primitive
types; it may be used in schema generation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Basic</span>
<span class="directive">protected</span> <span class="predefined-type">String</span> name;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Basic</span>(fetch=LAZY)
<span class="directive">protected</span> <span class="predefined-type">String</span> getName() { <span class="keyword">return</span> name; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the persistence provider stores a value of type <code>java.util.UUID</code> in
a column of type <code>VARCHAR</code> or equivalent, the value must be stored in
its canonical representation, unless the application explicitly indicates
that some other representation is preferred.</p>
</div>
</div>
<div class="sect3">
<h4 id="cacheable-annotation"><a class="anchor" href="#cacheable-annotation"></a>11.1.7. Cacheable Annotation</h4>
<div class="paragraph">
<p>The <code>Cacheable</code> annotation
specifies whether an entity should be cached if caching is enabled when
the value of the <code>persistence.xml</code> <code>shared-cache-mode</code> element is
<code>ENABLE_SELECTIVE</code> or <code>DISABLE_SELECTIVE</code>. The value of the <code>Cacheable</code>
annotation is inherited by subclasses; it can be overridden by
specifying <code>Cacheable</code> on a subclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Cacheable {
    <span class="type">boolean</span> value() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Cacheable(false)</code> means that the entity and
its state must not be cached by the provider.</p>
</div>
<div class="paragraph">
<p>If the <code>shared-cache-mode</code> element is not
specified in the <code>persistence.xml</code> file and the
<code>jakarta.persistence.sharedCache.mode</code> property is not specified when the
entity manager factory for the persistence unit is created, the
semantics of the <code>Cacheable</code> annotation are undefined.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Cacheable Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether or not the entity should
be cached.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a14250"><a class="anchor" href="#a14250"></a>11.1.8. CollectionTable Annotation</h4>
<div class="paragraph">
<p>The <code>CollectionTable</code> annotation is used in
the mapping of collections of basic or embeddable types. The
<code>CollectionTable</code> annotation specifies the table that is used for the
mapping of the collection and is specified on the collection-valued
field or property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> CollectionTable {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    JoinColumn<span class="type">[]</span> joinColumns() <span class="keyword">default</span> {};
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the columns of the collection
table that correspond to the embeddable class or basic type are derived
from the attributes of the embeddable class or from the basic type
according to the default values of the <code>Column</code> annotation, as described
in <a href="#a14330">Section 11.1.9</a>. In the
case of a basic type, the column name is derived from the name of the
collection-valued field or property. In the case of an embeddable class,
the column names are derived from the field or property names of the
embeddable class.</p>
</div>
<div class="paragraph">
<p>To override the default properties of the
column used for a basic type, the <code>Column</code> annotation is used on the
collection-valued attribute in addition to the <code>ElementCollection</code>
annotation. The value of the <code>table</code> element of the <code>Column</code> annotation
defaults to the name of the collection table.</p>
</div>
<div class="paragraph">
<p>To override these defaults for an embeddable
class, the <code>AttributeOverride</code> and/or <code>AttributeOverrides</code> annotations
must be used in addition to the <code>ElementCollection</code> annotation. The
value of the <code>table</code> element of the <code>Column</code> annotation used in the
<code>AttributeOverride</code> annotation defaults to the name of the collection
table. If the embeddable class contains references to other entities,
the default values for the columns corresponding to those references may
be overridden by means of the <code>AssociationOverride</code> and/or
<code>AssociationOverrides</code> annotations.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <code>joinColumns</code> element when table generation is in
effect. If both this element and the <code>foreignKey</code> element of any of the
<code>joinColumns</code> elements are specified, the behavior is undefined. If no
<code>foreignKey</code> annotation element is specified in either location, the
persistence provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="paragraph">
<p>If the <code>CollectionTable</code> annotation is
missing, the default values of the <code>CollectionTable</code> annotation elements
apply.</p>
</div>
<div class="paragraph">
<p>This annotation may not be applied to a persistent field or property not
annotated <code>@ElementCollection</code>.</p>
</div>
<div class="paragraph">
<p><a href="#a14269">Table 11</a> lists the annotation elements that
may be specified for the <code>CollectionTable</code> annotation and their default
values.</p>
</div>
<table id="a14269" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. CollectionTable Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the collection table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concatenation of the name of the
containing entity and the name of the collection attribute, separated by
an underscore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key columns of the
collection table which reference the primary table of the entity.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default only applies if a single join
column is used.) The same defaults as for JoinColumn (i.e., the
concatenation of the following: the name of the entity; &#8220;_&#8221;; the name of
the referenced primary key column.) However, if there is more than one
join column, a JoinColumn annotation must be specified for each join
column using the JoinColumns annotation. Both the name and the
referencedColumnName elements must be specified in each such JoinColumn
annotation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are only used if table generation is in
effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> street;
    <span class="directive">protected</span> <span class="predefined-type">String</span> city;
    <span class="directive">protected</span> <span class="predefined-type">String</span> state;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span> <span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> ssn;

    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="directive">protected</span> Address home;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span> <span class="comment">// use default table (PERSON_NICKNAMES)</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, length=<span class="integer">50</span>)
    <span class="directive">protected</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; nickNames = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">WealthyPerson</span> <span class="directive">extends</span> Person {
    <span class="annotation">@ElementCollection</span>
    <span class="annotation">@CollectionTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOMES</span><span class="delimiter">&quot;</span></span>) <span class="comment">// use default join column name</span>
    <span class="annotation">@AttributeOverrides</span>({
        <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">street</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOME_STREET</span><span class="delimiter">&quot;</span></span>)),
        <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">city</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOME_CITY</span><span class="delimiter">&quot;</span></span>)),
        <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">state</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOME_STATE</span><span class="delimiter">&quot;</span></span>))
    })
    <span class="directive">protected</span> <span class="predefined-type">Set</span>&lt;Address&gt; vacationHomes = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14330"><a class="anchor" href="#a14330"></a>11.1.9. Column Annotation</h4>
<div class="paragraph">
<p>The <code>Column</code> annotation is used to specify a
mapped column for a persistent property or field.</p>
</div>
<div class="paragraph">
<p><a href="#a14349">Table 12</a> lists the annotation elements that may be specified
for the <code>Column</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If no <code>Column</code> annotation is specified, the
default values in <a href="#a14349">Table 12</a> apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Column {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> length() <span class="keyword">default</span> <span class="integer">255</span>;
    <span class="type">int</span> precision() <span class="keyword">default</span> <span class="integer">0</span>; <span class="comment">// decimal precision</span>
    <span class="type">int</span> scale() <span class="keyword">default</span> <span class="integer">0</span>; <span class="comment">// decimal scale</span>
    <span class="type">int</span> secondPrecision() <span class="keyword">default</span> -<span class="integer">1</span>; <span class="comment">//fractional second precision</span>
    CheckConstraint<span class="type">[]</span> check() <span class="keyword">default</span> {}
    <span class="predefined-type">String</span> comment() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a14349" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Column Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The property or field name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is a unique
key. This is a shortcut for the UniqueConstraint annotation at the table
level and is useful for when the unique key constraint corresponds to
only a single column. This constraint applies in addition to any
constraint entailed by primary key mapping and to constraints specified
at the table level.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the database column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the column.</p>
<p class="tableblock"> The specified DDL must be written in the native SQL dialect of
 the target database, and is not portable across databases.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL to create a column of the
inferred type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p>
<p class="tableblock"> The specified DDL must be written in the native SQL dialect of
 the target database, and is not portable across databases.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table that
contains the column. If absent the column is assumed to be in the
primary table for the mapped object.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column
is in primary table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The column length</p>
<p class="tableblock"> Applies only to columns whose type is parameterized by length,
 for example, varchar or varbinary types.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">255</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">precision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The precision of a column of SQL type <code>decimal</code> or
 <code>numeric</code>, or of similar database-native type.</p>
<p class="tableblock"> Applies only to columns of exact numeric type.</p>
<p class="tableblock"> The default value <code>0</code> indicates that a provider-determined
 precision should be inferred.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The scale of a column of SQL type <code>decimal</code> or
 <code>numeric</code>, or of similar database-native type.</p>
<p class="tableblock"> Applies only to columns of exact numeric type.</p>
<p class="tableblock"> The default value <code>0</code> indicates that a provider-determined
 scale should be inferred.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secondPrecision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The number of decimal digits to use for storing
 fractional seconds in a SQL time or timestamp column.</p>
<p class="tableblock"> Applies only to columns of time or timestamp type.</p>
<p class="tableblock"> The default value <code>-1</code> indicates that fractional seconds
 should not be stored in a time column, or that the maximum
 number of digits supported by the database and JDBC driver
 should be stored in a timestamp column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CheckConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Check constraints for the column. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No check constraint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Comment for the column. This is
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No comment</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Portable applications which make use of schema generation should
explicitly specify the <code>precision</code> and <code>scale</code> of columns of type
<code>numeric</code> or <code>decimal</code>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DESC</span><span class="delimiter">&quot;</span></span>, nullable=<span class="predefined-constant">false</span>, length=<span class="integer">512</span>)
<span class="directive">public</span> <span class="predefined-type">String</span> getDescription() {
    <span class="keyword">return</span> description;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DESC</span><span class="delimiter">&quot;</span></span>, columnDefinition=<span class="string"><span class="delimiter">&quot;</span><span class="content">CLOB NOT NULL</span><span class="delimiter">&quot;</span></span>, table=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_DETAIL</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Lob</span>
<span class="directive">public</span> <span class="predefined-type">String</span> getDescription() {
    <span class="keyword">return</span> description;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ORDER_COST</span><span class="delimiter">&quot;</span></span>, updatable=<span class="predefined-constant">false</span>, precision=<span class="integer">12</span>, scale=<span class="integer">2</span>)
<span class="directive">public</span> <span class="predefined-type">BigDecimal</span> getCost() {
    <span class="keyword">return</span> cost;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14398"><a class="anchor" href="#a14398"></a>11.1.10. Convert Annotation</h4>
<div class="paragraph">
<p>The <code>Convert</code> annotation specifies how the values of a field or property
are converted to a basic type, enabling a converter which was defined
<code>autoApply=false</code>, overriding the use of a converter which was defined
<code>autoApply=true</code> (see <a href="#a13903">Section 10.6</a>), or overriding the use of a converter
specified by a field or property of an embedded type or inherited mapped
superclass.</p>
</div>
<div class="paragraph">
<p>When persistent properties are used, the <code>Convert</code> annotation is applied
to the getter method.</p>
</div>
<div class="paragraph">
<p>It is not necessary to use the <code>Basic</code> annotation or corresponding XML
element to specify the converted basic type. Nor is it usually necessary
to explicitly specify the converter class, except to disambiguate cases
where multiple converters would otherwise apply.</p>
</div>
<div class="paragraph">
<p>The <code>Convert</code> annotation may be applied to an entity that extends a
mapped superclass to specify or override the conversion mapping for
an inherited basic attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD, TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(Converts.class)
<span class="directive">public</span> <span class="annotation">@interface</span> Convert {
    <span class="predefined-type">Class</span> converter() <span class="keyword">default</span> <span class="type">void</span>.class;
    <span class="predefined-type">String</span> attributeName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> disableConversion() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14410">Table 13</a> lists the annotation elements that may be specified for the
<code>Convert</code> annotation.</p>
</div>
<table id="a14410" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Convert Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">converter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The converter to be applied.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No converter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the attribute to
convert. Must be specified unless the <code>Convert</code> annotation is applied to
an attribute of basic type or to an element collection of basic type.
Must not be specified otherwise.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The basic
attribute or basic element collection attribute to which the annotation
is applied</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">disableConversion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether conversion of the attribute is to be disabled.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>converter</code> element specifies the converter that is applied. Even if
an automatically-applied converter would otherwise be applicable to the
annotated field or property, the converter specified by the <code>converter</code>
element must be applied instead.</p>
</div>
<div class="paragraph">
<p>The <code>disableConversion</code> element specifies that any automatically-applied
converter that would otherwise be applicable to the given field or property
must not be applied.</p>
</div>
<div class="paragraph">
<p>If neither the <code>converter</code> element nor the <code>disableConversion</code> element is
specified, and there is exactly one converter for the type of the annotated
field or property, that converter is applied, even if it is not an
automatically-applied converter.</p>
</div>
<div class="paragraph">
<p>If multiple converters are applicable to the annotated field or property,
and the <code>converter</code> element is not specified, the behavior is undefined.</p>
</div>
<div class="paragraph">
<p>The <code>Convert</code> annotation should not be used to specify conversion of
id attributes, (including the attributes of embedded ids and derived
identities), of version attributes, of relationship attributes, or of
attributes explicitly annotated (or designated via XML) as <code>Enumerated</code>
or <code>Temporal</code>. Applications that depend on such conversions are not
portable.</p>
</div>
<div class="paragraph">
<p>The <code>Convert</code> annotation may be applied to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a basic attribute, or</p>
</li>
<li>
<p>a collection attribute (that is, an <code>ElementCollection</code>) of any
type other than <code>Map</code>, in which case the converter is applied to
the elements of the collection.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these cases, the <code>attributeName</code> element must not be specified.</p>
</div>
<div class="paragraph">
<p>Alternatively, the <code>Convert</code> annotation may be applied to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an embedded attribute,</p>
</li>
<li>
<p>a collection attribute (that is, an <code>ElementCollection</code>) whose
element type is an embeddable type, in which case the converter
is applied to the specified attribute of the embeddable instances
contained in the collection,</p>
</li>
<li>
<p>a map collection attribute (that is, an <code>ElementCollection</code> of
type <code>Map</code>), in which case the converter is applied to the keys or
values of the map, or to the specified attribute of the embeddable
instances contained in the map, or</p>
</li>
<li>
<p>an entity class which extends a mapped superclass, to enable or
override conversion of an inherited basic or embedded attribute.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these cases, the <code>attributeName</code> element must be specified.</p>
</div>
<div class="paragraph">
<p>To override conversion mappings at multiple levels of embedding, a dot
(&#8220;.&#8221;) notation form must be used in the <code>attributeName</code> element to
indicate an attribute within an embedded attribute. The value of each
identifier used with the dot notation is the name of the respective
embedded field or property.</p>
</div>
<div class="paragraph">
<p>The dot notation may also be used with map entries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the <code>Convert</code> annotation is applied to a map to specify conversion
of a map key or value of basic type, <code>"key"</code> or <code>"value"</code>, respectively,
must be used as the value of the <code>attributeName</code> element to specify that
it is the map key or value that is converted.</p>
</li>
<li>
<p>When the <code>Convert</code> annotation is applied to a map whose key or value type
is an embeddable type, the <code>attributeName</code> element must be specified, and
<code>"key."</code> or <code>"value."</code> (respectively) must be used to prefix the name of
the attribute of the key or value type that is converted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong> Convert a basic attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Converter</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">BooleanToIntegerConverter</span> <span class="directive">implements</span> AttributeConverter&lt;<span class="predefined-type">Boolean</span>, <span class="predefined-type">Integer</span>&gt; { ... }

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> id;

    <span class="annotation">@Convert</span>(converter=BooleanToIntegerConverter.class)
    <span class="type">boolean</span> fullTime;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Auto-apply conversion of a basic attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Converter</span>(autoApply=<span class="predefined-constant">true</span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeDateConverter</span> <span class="directive">implements</span>
    AttributeConverter&lt;com.acme.EmployeeDate, java.sql.Date&gt; { ... }

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> id;

    <span class="comment">// ...</span>

    <span class="comment">// EmployeeDateConverter is applied automatically</span>
    EmployeeDate startDate;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong> Disable conversion in the presence of an auto-apply converter</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Convert</span>(disableConversion=<span class="predefined-constant">true</span>)
EmployeeDate lastReview;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong> Apply a converter to an element collection of basic type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ElementCollection</span>
<span class="comment">// applies to each element in the collection</span>
<span class="annotation">@Convert</span>(converter=NameConverter.class)
<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; names;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong> Apply a converter to an element collection that is a map of basic values. The converter is applied to the map <code>value</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ElementCollection</span>
<span class="annotation">@Convert</span>(converter=EmployeeNameConverter.class)
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; responsibilities;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong> Apply a converter to a map key of basic type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>
<span class="annotation">@Convert</span>(converter=ResponsibilityCodeConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Employee&gt; responsibilities;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 7:</strong> Apply a converter to an embeddable attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@Convert</span>(converter=CountryConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">country</span><span class="delimiter">&quot;</span></span>)
Address address;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 8:</strong> Apply a converter to a nested embeddable attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@Convert</span>(converter=CityConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">region.city</span><span class="delimiter">&quot;</span></span>)
Address address;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 9:</strong> Apply a converter to a nested
attribute of an embeddable that is a map key of an element collection</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PropertyRecord</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@Convert</span>(converter=CityConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">key.region.city</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@ElementCollection</span>
    <span class="predefined-type">Map</span>&lt;Address, PropertyInfo&gt; parcels;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 10:</strong> Apply a converter to an embeddable that is a map key for a relationship</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>
<span class="annotation">@Convert</span>(converter=ResponsibilityCodeConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">key.jobType</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">Map</span>&lt;Responsibility, Employee&gt; responsibilities;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 11:</strong> Override conversion mappings for attributes inherited from a mapped superclass</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Convert</span>(converter=DateConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Convert</span>(converter=DateConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">FullTimeEmployee</span> <span class="directive">extends</span> GenericEmployee { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="converts-annotation"><a class="anchor" href="#converts-annotation"></a>11.1.11. Converts Annotation</h4>
<div class="paragraph">
<p>The <code>Converts</code> annotation can be used to
group <code>Convert</code> annotations. Multiple converters must not be applied to
the same basic attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD, TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Converts {
    Convert<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14515">Table 14</a> lists the annotation elements that may be
specified for the <code>Converts</code> annotation.</p>
</div>
<table id="a14515" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Converts Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convert[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The Convert mappings that are to
be applied to the entity or the field or property.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong> Multiple converters applied to an embedded attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@Converts</span>({
    <span class="annotation">@Convert</span>(converter=CountryConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">country</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@Convert</span>(converter=CityConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">region.city</span><span class="delimiter">&quot;</span></span>)
})
Address address;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14530"><a class="anchor" href="#a14530"></a>11.1.12. DiscriminatorColumn Annotation</h4>
<div class="paragraph">
<p>For the SINGLE_TABLE mapping strategy, and
typically also for the JOINED strategy, the persistence provider will
use a type discriminator column. The <code>DiscriminatorColumn</code> annotation is
used to define the discriminator column for the SINGLE_TABLE and JOINED
inheritance mapping strategies.</p>
</div>
<div class="paragraph">
<p>The strategy and the discriminator
column are only specified in the root of an entity class hierarchy or
subhierarchy in which a different inheritance strategy is
applied.<sup class="footnote">[<a id="_footnoteref_108" class="footnote" href="#_footnotedef_108" title="View footnote.">108</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <code>DiscriminatorColumn</code> annotation can be
specified on an entity class (including on an abstract entity class).</p>
</div>
<div class="paragraph">
<p>If the <code>DiscriminatorColumn</code> annotation is
missing, and a discriminator column is required, the name of the
discriminator column defaults to "DTYPE" and the discriminator type to
STRING.</p>
</div>
<div class="paragraph">
<p><a href="#a14548">Table 15</a> lists the annotation elements
that may be specified for the <code>DiscriminatorColumn</code> annotation and their
default values.</p>
</div>
<div class="paragraph">
<p>The supported discriminator types are defined
by the <code>DiscriminatorType</code> enum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> DiscriminatorType { STRING, CHAR, INTEGER };</code></pre>
</div>
</div>
<div class="paragraph">
<p>The type of the discriminator column, if
specified in the optional <code>columnDefinition</code> element, must be consistent
with the discriminator type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> DiscriminatorColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">DTYPE</span><span class="delimiter">&quot;</span></span>;
    DiscriminatorType discriminatorType() <span class="keyword">default</span> STRING;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> length() <span class="keyword">default</span> <span class="integer">31</span>;
}</code></pre>
</div>
</div>
<table id="a14548" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. DiscriminatorColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of column to be used for
the discriminator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"DTYPE"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DiscriminatorType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">discriminatorType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The type of object/column to use
as a class discriminator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DiscriminatorType.STRING</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the discriminator column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider-generated SQL to create a column of
the specified discriminator type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The column length for
String-based discriminator types. Ignored for other discriminator types.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DISC</span><span class="delimiter">&quot;</span></span>, discriminatorType=STRING, length=<span class="integer">20</span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="discriminatorvalue-annotation"><a class="anchor" href="#discriminatorvalue-annotation"></a>11.1.13. DiscriminatorValue Annotation</h4>
<div class="paragraph">
<p>The <code>DiscriminatorValue</code> annotation is used
to specify the value of the discriminator column for entities of the
given type. The <code>DiscriminatorValue</code> annotation can only be specified on
a concrete entity class. If the <code>DiscriminatorValue</code> annotation is not
specified and a discriminator column is used, a provider-specific
function will be used to generate a value representing the entity type.</p>
</div>
<div class="paragraph">
<p>The inheritance strategy and the
discriminator column are only specified in the root of an entity class
hierarchy or subhierarchy in which a different inheritance strategy is
applied. The discriminator value, if not defaulted, should be specified
for each entity class in the hierarchy.</p>
</div>
<div class="paragraph">
<p><a href="#a14585">Table 16</a> lists the annotation elements
that may be specified for the <code>DiscriminatorValue</code> annotation and their
default values.</p>
</div>
<div class="paragraph">
<p>The discriminator value must be consistent in
type with the discriminator type of the specified or defaulted
discriminator column. If the discriminator type is an integer, the value
specified must be able to be converted to an integer value (e.g., &#8220;1&#8221;).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> DiscriminatorValue {
    <span class="predefined-type">String</span> value();
}</code></pre>
</div>
</div>
<table id="a14585" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. DiscriminatorValue Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The value that indicates that the
row is an entity of the annotated entity type.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the DiscriminatorValue annotation is not
specified, a provider-specific function to generate a value representing
the entity type is used for the value of the discriminator column. If
the DiscriminatorType is STRING, the discriminator value default is the
entity name.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Inheritance</span>(strategy=SINGLE_TABLE)
<span class="annotation">@DiscriminatorColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DISC</span><span class="delimiter">&quot;</span></span>, discriminatorType=STRING,length=<span class="integer">20</span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }

<span class="annotation">@Entity</span>
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="elementcollection-annotation"><a class="anchor" href="#elementcollection-annotation"></a>11.1.14. ElementCollection Annotation</h4>
<div class="paragraph">
<p>The <code>ElementCollection</code> annotation
defines a collection of instances of a basic type or embeddable class.
The <code>ElementCollection</code> annotation (or equivalent XML element) must be
specified if the collection is to be mapped by means of a collection
table.<sup class="footnote">[<a id="_footnoteref_109" class="footnote" href="#_footnotedef_109" title="View footnote.">109</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ElementCollection {
    <span class="predefined-type">Class</span> targetClass() <span class="keyword">default</span> <span class="type">void</span>.class;
    FetchType fetch() <span class="keyword">default</span> LAZY;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14614">Table 17</a> lists the annotation elements
that may be specified for the <code>ElementCollection</code> annotation and their
default values.</p>
</div>
<table id="a14614" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. ElementCollection Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetClass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The basic or embeddable class
that is the element type of the collection. Optional only if the
collection field or property is defined using Java generics. Must be
specified otherwise.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The parameterized type
of the collection when defined using generics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the collection should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the collection
elements must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAZY</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span> <span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> ssn;

    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@ElementCollection</span>
    <span class="directive">protected</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; nickNames = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14634"><a class="anchor" href="#a14634"></a>11.1.15. Embeddable Annotation</h4>
<div class="paragraph">
<p>The <code>Embeddable</code> annotation is used to
specify a class whose instances are stored as an intrinsic part of an
owning entity and share the identity of the entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Embeddable {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmploymentPeriod</span> {
    <span class="annotation">@Temporal</span>(DATE)
    java.util.Date startDate;

    <span class="annotation">@Temporal</span>(DATE)
    java.util.Date endDate;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneNumber</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> areaCode;
    <span class="directive">protected</span> <span class="predefined-type">String</span> localNumber;

    <span class="annotation">@ManyToOne</span>
    PhoneServiceProvider provider;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneServiceProvider</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> street;
    <span class="directive">protected</span> <span class="predefined-type">String</span> city;
    <span class="directive">protected</span> <span class="predefined-type">String</span> state;

    <span class="annotation">@Embedded</span>
    <span class="directive">protected</span> Zipcode zipcode;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Zipcode</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> zip;
    <span class="directive">protected</span> <span class="predefined-type">String</span> plusFour;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14672"><a class="anchor" href="#a14672"></a>11.1.16. Embedded Annotation</h4>
<div class="paragraph">
<p>The <code>Embedded</code> annotation is used to
specify a persistent field or property of an entity or embeddable class
whose value is an instance of an embeddable
class.<sup class="footnote">[<a id="_footnoteref_110" class="footnote" href="#_footnotedef_110" title="View footnote.">110</a>]</sup> Each of the persistent properties or
fields of the embedded object is mapped to the database table for the
entity or embeddable class. The embeddable class must be annotated as
<code>Embeddable</code>.<sup class="footnote">[<a id="_footnoteref_111" class="footnote" href="#_footnotedef_111" title="View footnote.">111</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <code>AttributeOverride</code>,
<code>AttributeOverrides</code>, <code>AssociationOverride</code>, and
<code>AssociationOverrides</code> annotations may be used to override mappings
declared or defaulted by the embeddable class.</p>
</div>
<div class="paragraph">
<p>Implementations are not required to support
embedded objects that are mapped across more than one table (e.g., split
across primary and secondary tables or multiple secondary tables).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Embedded {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@AttributeOverrides</span>({
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_START</span><span class="delimiter">&quot;</span></span>)),
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_END</span><span class="delimiter">&quot;</span></span>))
})
<span class="directive">public</span> EmploymentPeriod getEmploymentPeriod() { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14687"><a class="anchor" href="#a14687"></a>11.1.17. EmbeddedId Annotation</h4>
<div class="paragraph">
<p>The <code>EmbeddedId</code> annotation is applied to a
persistent field or property of an entity class or mapped superclass to
denote a composite primary key that is an embeddable class. The
embeddable class must be annotated as <code>Embeddable</code>.<sup class="footnote">[<a id="_footnoteref_112" class="footnote" href="#_footnotedef_112" title="View footnote.">112</a>]</sup> Relationship mappings defined within an
embedded id class are not supported.</p>
</div>
<div class="paragraph">
<p>There must be only one <code>EmbeddedId</code>
annotation and no <code>Id</code> annotation when the <code>EmbeddedId</code> annotation is
used.</p>
</div>
<div class="paragraph">
<p>The <code>AttributeOverride</code> annotation may be
used to override the column mappings declared within the embeddable
class.</p>
</div>
<div class="paragraph">
<p>The <code>MapsId</code> annotation may be used in
conjunction with the <code>EmbeddedId</code> annotation to specify a derived
primary key. See <a href="#a149">Section 2.4.2</a> and <a href="#a15583">Section 11.1.38</a>.</p>
</div>
<div class="paragraph">
<p>If the entity has a derived primary key, the
<code>AttributeOverride</code> annotation may only be used to override those
attributes of the embedded id that do not correspond to the relationship
to the parent entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> EmbeddedId {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span> <span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@EmbeddedId</span>
    <span class="directive">protected</span> EmployeePK empPK;

    <span class="predefined-type">String</span> name;

    <span class="annotation">@ManyToOne</span>
    <span class="predefined-type">Set</span>&lt;Department&gt; dept;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    EmployeeId empPK; <span class="comment">// corresponds to PK type of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="comment">// default column name for &quot;name&quot; attribute is overridden</span>
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dep_name</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@EmbeddedId</span>
    DependentId id;

    <span class="comment">// ...</span>

    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empPK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@ManyToOne</span>
    Employee emp;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14719"><a class="anchor" href="#a14719"></a>11.1.18. Enumerated Annotation</h4>
<div class="paragraph">
<p>An <code>Enumerated</code> annotation specifies that a persistent property or field
should be persisted as an enumerated type. The <code>Enumerated</code> annotation is
optional if the type of a persistent field or property is a Java enum type.</p>
</div>
<div class="paragraph">
<p>The <code>Enumerated</code> annotation may be used in conjunction with the <code>Basic</code>
annotation. The <code>Enumerated</code> annotation may be used in conjunction with
the <code>ElementCollection</code> annotation<sup class="footnote">[<a id="_footnoteref_113" class="footnote" href="#_footnotedef_113" title="View footnote.">113</a>]</sup> when the element type of the
collection is an enum type.</p>
</div>
<div class="paragraph">
<p>An enum can be mapped as either a string or an integer<sup class="footnote">[<a id="_footnoteref_114" class="footnote" href="#_footnotedef_114" title="View footnote.">114</a>]</sup>. The <code>EnumType</code> enum defines
the available options for mapping enumerated types.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> EnumType {
    ORDINAL,
    STRING
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>value</code> member of the <code>Enumerated</code> annotation specifies the <code>EnumType</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Enumerated {
    EnumType value() <span class="keyword">default</span> ORDINAL;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14733">Table 18</a> lists the annotation elements that may be specified for the
<code>Enumerated</code> annotation and their default values.</p>
</div>
<table id="a14733" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Enumerated Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnumType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The type used in mapping an enum type.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ORDINAL</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a persistent field or property of enum type has no explicit <code>Enumerated</code>
annotation, and if no converter is applied to the field or property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if the enum type has a final field of type <code>java.lang.String</code> annotated
<code>EnumeratedValue</code>, the enumerated type is inferred to be <code>STRING</code>;</p>
</li>
<li>
<p>otherwise, the enumerated type is taken to be <code>ORDINAL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The enum type may have a final field annotated <code>EnumeratedValue</code>.
This field, if it exists, controls the mapping of enum values to database
column values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if the enum type does have a field annotated <code>EnumeratedValue</code>,
each enum value is mapped to the value of the annotated field,
or, otherwise,</p>
</li>
<li>
<p>if the enumerated type is <code>ORDINAL</code>, each enum value is mapped
to the value of the <code>ordinal</code> field, but</p>
</li>
<li>
<p>if the enumerated type is <code>STRING</code>, each enum value is mapped
to the value of the <code>name</code> field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> EmployeeStatus {FULL_TIME, PART_TIME, CONTRACT}
<span class="directive">public</span> <span class="type">enum</span> SalaryRate {JUNIOR, SENIOR, MANAGER, EXECUTIVE}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="comment">// ...</span>

    <span class="directive">public</span> EmployeeStatus getStatus() {...}

    <span class="annotation">@Enumerated</span>(STRING)
    <span class="directive">public</span> SalaryRate getPayScale() {...}

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the status property is mapped to a column
of integer type, and the payscale property to a column of varchar type,
an instance that has a status of <code>PART_TIME</code> and a pay rate of <code>JUNIOR</code>
will be stored with <code>STATUS</code> set to 1 and <code>PAYSCALE</code> set to <em>"JUNIOR"</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="a14720"><a class="anchor" href="#a14720"></a>11.1.19. EnumeratedValue Annotation</h4>
<div class="paragraph">
<p>The <code>EnumeratedValue</code> annotation specifies that an annotated field of
a Java enum type is the source of database column values when the enum
occurs as the declared type of an <code>Enumerated</code> property or field. The
annotated field must be declared final, and must be of type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>byte</code>, <code>short</code>, or <code>int</code> for an <code>ORDINAL</code> enumerated type, or</p>
</li>
<li>
<p><code>java.lang.String</code> for a <code>STRING</code> enumerated type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The field must not be set to null, and must hold a distinct value for
each value of the enum type.</p>
</div>
<div class="paragraph">
<p>If the type of the field annotated <code>EnumeratedValue</code> disagrees with
the enumerated type mapping specified by the <code>Enumerated</code> annotation,
the behavior is undefined. Portable applications should ensure that
the type of the field annotated <code>EnumeratedValue</code> agrees with the
type mapping wherever the enum type is used in a field or property
explicitly annotated <code>Enumerated</code>.</p>
</div>
<div class="paragraph">
<p>If a converter is applied to an <code>Enumerated</code> field or property, the
<code>EnumeratedValue</code> annotation is ignored for that field or property.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">enum</span> Status {
    OPEN(<span class="integer">0</span>), CLOSED(<span class="integer">1</span>), CANCELLED(-<span class="integer">1</span>);

    <span class="annotation">@EnumeratedValue</span>
    <span class="directive">final</span> <span class="type">int</span> intValue;

    Status(<span class="type">int</span> intValue) {
        <span class="local-variable">this</span>.intValue = intValue;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14754"><a class="anchor" href="#a14754"></a>11.1.20. ForeignKey Annotation</h4>
<div class="paragraph">
<p>The <code>ForeignKey</code> annotation is used to
specify the handling of foreign key constraints when schema generation
is in effect. If this annotation is not specified, the persistence
provider&#8217;s default foreign key strategy will be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ForeignKey {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ConstraintMode value() <span class="keyword">default</span> CONSTRAINT;
    <span class="predefined-type">String</span> foreignKeyDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> element specifies a name for the
foreign key constraint.</p>
</div>
<div class="paragraph">
<p>The <code>ConstraintMode</code> enum is used to control
the application of constraints.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> ConstraintMode {CONSTRAINT, NO_CONSTRAINT, PROVIDER_DEFAULT}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The enum values have the following semantics:
A value of <code>CONSTRAINT</code> will cause the persistence provider to generate
a foreign key constraint. A value of <code>NO_CONSTRAINT</code> will result in no
constraint being generated. A value of <code>PROVIDER_DEFAULT</code> will result in
the provider&#8217;s default behavior (which may or may not result in the
generation of a constraint for any given join column or set of join
columns).</p>
</div>
<div class="paragraph">
<p>The syntax used in the <code>foreignKeyDefinition</code>
element should follow the SQL syntax used by the target database for
foreign key constraints. For example, this may be similar to the
following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FOREIGN KEY (&lt;COLUMN expression&gt; {, &lt;COLUMN expression&gt;}... )
REFERENCES &lt;TABLE identifier&gt; [ (&lt;COLUMN expression&gt; {, &lt;COLUMN expression&gt;}... ) ]
[ ON UPDATE &lt;referential action&gt; ]
[ ON DELETE &lt;referential action&gt; ]</pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>ForeignKey</code> annotation is specified
with a <code>ConstraintMode</code> value of <code>CONSTRAINT</code>, but the
<code>foreignKeyDefinition</code> element is not specified, the provider will
generate a foreign key constraint whose update and delete actions it
determines most appropriate for the join column(s) to which the foreign
key constraint is applied</p>
</div>
<div class="paragraph">
<p><a href="#a14776">Table 19</a> lists the annotation elements that may be specified
for the <code>ForeignKey</code> annotation.</p>
</div>
<table id="a14776" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. ForeignKey Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the foreign key constraint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-generated name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConstraintMode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether to generate a constraint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSTRAINT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKeyDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint definition.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider-default. If the value of the <code>ConstraintMode</code> element is` NO_CONSTRAINT`,
the provider must not generate a foreign key constraint.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a14790"><a class="anchor" href="#a14790"></a>11.1.21. GeneratedValue Annotation</h4>
<div class="paragraph">
<p>The <code>GeneratedValue</code> annotation specifies a generation strategy for the
values of primary keys. The <code>GeneratedValue</code> annotation may be applied
to a primary key property or field of an entity or mapped superclass in
conjunction with the <code>Id</code> annotation.<sup class="footnote">[<a id="_footnoteref_115" class="footnote" href="#_footnotedef_115" title="View footnote.">115</a>]</sup> The persistence provider is only required to
support the use of the <code>GeneratedValue</code> annotation for simple primary
keys. Use of the <code>GeneratedValue</code> annotation for derived primary keys
is not supported.</p>
</div>
<div class="paragraph">
<p><a href="#a14806">Table 20</a> lists the annotation elements that may be specified for the
<code>GeneratedValue</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>The types of primary key generation are defined by the <code>GenerationType</code>
enum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> GenerationType { TABLE, SEQUENCE, IDENTITY, <span class="predefined-type">UUID</span>, AUTO };</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>TABLE</code> generator type value indicates that the persistence
provider must assign primary keys for the entity using an underlying
database table to ensure uniqueness.</p>
</div>
<div class="paragraph">
<p>The <code>SEQUENCE</code> and <code>IDENTITY</code> values specify the use of a database
sequence or identity column, respectively.<sup class="footnote">[<a id="_footnoteref_116" class="footnote" href="#_footnotedef_116" title="View footnote.">116</a>]</sup></p>
</div>
<div class="paragraph">
<p>The further specification of table generators and sequence generators
is described in <a href="#a16164">Section 11.1.49</a> and <a href="#a16256">Section 11.1.52</a>.</p>
</div>
<div class="paragraph">
<p>A <code>TABLE</code>, <code>SEQUENCE</code>, or <code>IDENTITY</code> generator may be used to generate
values for a primary key property or field of type <code>java.lang.Long</code>,
<code>java.lang.Integer</code>, <code>long</code>, or <code>int</code>.</p>
</div>
<div class="paragraph">
<p>The <code>UUID</code> value indicates that the persistence provider should assign
an RFC 4122 Universally Unique IDentifier.</p>
</div>
<div class="paragraph">
<p>A <code>UUID</code> generator may be used to generate values for a primary key
property or field of type <code>java.util.UUID</code> or <code>java.lang.String</code>.</p>
</div>
<div class="paragraph">
<p>The <code>AUTO</code> value indicates that the persistence provider should pick
an appropriate strategy given the type of the primary key property or
field, and the capabilities of the particular database. In the case of
a field or property of type <code>java.util.UUID</code> or <code>java.lang.String</code>,
the <code>AUTO</code> strategy is equivalent to <code>UUID</code>. In the case of a field or
property of type <code>java.lang.Long</code>, <code>java.lang.Integer</code>, <code>long</code>, or <code>int</code>,
the <code>AUTO</code> strategy may select between <code>TABLE</code>, <code>SEQUENCE</code>, or <code>IDENTITY</code>.</p>
</div>
<div class="paragraph">
<p>The <code>AUTO</code> generation strategy may expect a database resource to exist,
or it may attempt to create one. A vendor may provide documentation on
how to create such resources in the event that it does not support
schema generation or cannot create the schema resource at runtime.</p>
</div>
<div class="paragraph">
<p>This specification does not define the exact behavior of these strategies.</p>
</div>
<div class="paragraph">
<p>However, if the persistence provider stores a value generated according
to the <code>UUID</code> strategy in a column of type <code>VARCHAR</code> or equivalent, the
value must be stored in its canonical representation, unless the
application explicitly indicates that some other representation is
preferred.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> member specifies the name of a generator to use, and defaults
to the entity name of the entity in which the <code>GeneratedValue</code> annotation
occurs. If the <code>name</code> is not specified, and if there is no generator with
the defaulted name, then the persistence provider supplies a default id
generator, of a type compatible with the value of the <code>strategy</code> member.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> GeneratedValue {
    GenerationType strategy() <span class="keyword">default</span> AUTO;
    <span class="predefined-type">String</span> generator() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a14806" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. GeneratedValue Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GenerationType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The primary key generation strategy that the persistence
provider must use to generate the annotated entity primary key.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GenerationType.AUTO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">generator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the primary key generator to use as specified
in the <code>SequenceGenerator</code> or <code>TableGenerator</code> annotation which
declares the generator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The entity name of the entity in which the annotation occurs.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Id</span>
<span class="annotation">@GeneratedValue</span>(strategy=SEQUENCE, generator=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_SEQ</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Long</span> getId() { <span class="keyword">return</span> id; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Id</span>
<span class="annotation">@GeneratedValue</span>(strategy=TABLE, generator=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_GEN</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">Long</span> id;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14827"><a class="anchor" href="#a14827"></a>11.1.22. Id Annotation</h4>
<div class="paragraph">
<p>The <code>Id</code> annotation declares a primary key property or field of an entity.
The <code>Id</code> annotation may be applied to a property or field of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an entity class that is the root of an entity hierarchy, or</p>
</li>
<li>
<p>a mapped superclass that is a superclass of all entity classes in an
entity hierarchy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The field or property to which the <code>Id</code> annotation is applied should have
one of the legal simple primary key types listed in <a href="#a132">Section 2.4</a>.<sup class="footnote">[<a id="_footnoteref_117" class="footnote" href="#_footnotedef_117" title="View footnote.">117</a>]</sup><sup class="footnote">[<a id="_footnoteref_118" class="footnote" href="#_footnotedef_118" title="View footnote.">118</a>]</sup></p>
</div>
<div class="paragraph">
<p>The mapped column for the primary key of the entity is assumed to be the
primary key of the primary table. If no <code>Column</code> annotation is specified,
the primary key column name is assumed to be the name of the primary key
property or field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Id {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Id</span>
<span class="directive">public</span> <span class="predefined-type">Long</span> getId() { <span class="keyword">return</span> id; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14836"><a class="anchor" href="#a14836"></a>11.1.23. IdClass Annotation</h4>
<div class="paragraph">
<p>The <code>IdClass</code> annotation is applied to an
entity class or a mapped superclass to specify a composite primary key
class that is mapped to multiple fields or properties of the entity.</p>
</div>
<div class="paragraph">
<p>The names of the fields or properties in the
primary key class and the primary key fields or properties of the entity
must correspond and their types must match according to the rules
specified in <a href="#a132">Section 2.4</a> and <a href="#a149">Section 2.4.2</a>.</p>
</div>
<div class="paragraph">
<p>The <code>Id</code> annotation must also be applied to
the corresponding fields or properties of the entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> IdClass {
    <span class="predefined-type">Class</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14847">Table 21</a> lists the annotation elements that may be specified
for the <code>IdClass</code> annotation.</p>
</div>
<table id="a14847" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. IdClass Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The composite primary key class.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@IdClass</span>(com.acme.EmployeePK.class)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> empName;

    <span class="annotation">@Id</span>
    <span class="predefined-type">Date</span> birthDay;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14862"><a class="anchor" href="#a14862"></a>11.1.24. Index Annotation</h4>
<div class="paragraph">
<p>The <code>Index</code> annotation is used in schema
generation. Note that it is not necessary to specify an index for a
primary key, as the primary key index will be created automatically,
however, the Index annotation may be used to specify the ordering of the
columns in the index for the primary key.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Index {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> columnList();
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax of the <code>columnList</code> element is a
<code>column_list</code>, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>column_list::= index_column [,index_column]*
index_column::= column_name [ASC | DESC]</pre>
</div>
</div>
<div class="paragraph">
<p>The persistence provider must observe the specified ordering of the columns.</p>
</div>
<div class="paragraph">
<p>If <code>ASC</code> or <code>DESC</code> is not specified, <code>ASC</code>
(ascending order) is assumed.</p>
</div>
<div class="paragraph">
<p><a href="#a14877">Table 22</a> lists the annotation elements that may be specified
for the <code>Index</code> annotation.</p>
</div>
<table id="a14877" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Index Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the index.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-generated name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnList</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The names of the columns to be
included in the index.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the index is unique.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a14891"><a class="anchor" href="#a14891"></a>11.1.25. Inheritance Annotation</h4>
<div class="paragraph">
<p>The <code>Inheritance</code> annotation defines the
inheritance strategy to be used for an entity class hierarchy. It is
specified on the entity class that is the root of the entity class
hierarchy.</p>
</div>
<div class="paragraph">
<p>If the <code>Inheritance</code> annotation is not
specified or if no inheritance type is specified for an entity class
hierarchy, the SINGLE_TABLE mapping strategy is used.</p>
</div>
<div class="paragraph">
<p>Support for the combination of inheritance
strategies is not required by this specification. Portable applications
should only use a single inheritance strategy within an entity
hierarchy.</p>
</div>
<div class="paragraph">
<p>The three inheritance mapping strategies are
the single table per class hierarchy, joined subclass, and table per
concrete class strategies. See <a href="#a966">Section 2.14</a> for a more detailed discussion of
inheritance strategies.</p>
</div>
<div class="paragraph">
<p>The inheritance strategy options are defined
by the <code>InheritanceType</code> enum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> InheritanceType { SINGLE_TABLE, JOINED, TABLE_PER_CLASS };</code></pre>
</div>
</div>
<div class="paragraph">
<p>Support for the <code>TABLE_PER_CLASS</code> mapping
strategy is optional in this release.</p>
</div>
<div class="paragraph">
<p><a href="#a14907">Table 23</a> lists the annotation elements that may be specified
for the <code>Inheritance</code> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Inheritance {
    InheritanceType strategy() <span class="keyword">default</span> SINGLE_TABLE;
}</code></pre>
</div>
</div>
<table id="a14907" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Inheritance Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">InheritanceType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The inheritance strategy to use for the entity inheritance hierarchy.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">InheritanceType.SINGLE_TABLE</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Inheritance</span>(strategy=JOINED)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14922"><a class="anchor" href="#a14922"></a>11.1.26. JoinColumn Annotation</h4>
<div class="paragraph">
<p>The <code>JoinColumn</code> annotation is used to
specify a column for joining an entity association or element
collection.</p>
</div>
<div class="paragraph">
<p><a href="#a14945">Table 24</a> lists the annotation elements that may be specified
for the <code>JoinColumn</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If the <code>JoinColumn</code> annotation itself is
defaulted, a single join column is assumed and the default values
described in <a href="#a14945">Table 24</a> apply.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> annotation element defines the
name of the foreign key column. The remaining annotation elements (other
than <code>referencedColumnName</code>) refer to this column and have the same
semantics as for the <code>Column</code> annotation.</p>
</div>
<div class="paragraph">
<p>If the <code>referencedColumnName</code> element is
missing, the foreign key is assumed to refer to the primary key of the
referenced table.</p>
</div>
<div class="paragraph">
<p>Support for referenced columns that are not
primary key columns of the referenced table is optional. Applications
that use such mappings will not be portable.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> annotation element is used
to specify or control the generation of a foreign key constraint when
schema generation is in effect. If this element is not specified, the
persistence provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="paragraph">
<p>If more than one <code>JoinColumn</code> annotation is
applied to a field or property, both the <code>name</code> and the
<code>referencedColumnName</code> elements must be specified in each such
<code>JoinColumn</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(JoinColumns.class)
<span class="directive">public</span> <span class="annotation">@interface</span> JoinColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> referencedColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    CheckConstraint<span class="type">[]</span> check() <span class="keyword">default</span> {}
    <span class="predefined-type">String</span> comment() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a14945" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. JoinColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the foreign key
column. The table in which it is found depends upon the context. If the
join is for a OneToOne or ManyToOne mapping using a foreign key mapping
strategy, the foreign key column is in the table of the source entity or
embeddable. If the join is for a unidirectional OneToMany mapping using
a foreign key mapping strategy, the foreign key is in the table of the
target entity. If the join is for a ManyToMany mapping or for a OneToOne
or bidirectional ManyToOne/OneToMany mapping using a join table, the
foreign key is in a join table. If the join is for an element
collection, the foreign key is in a collection table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default only applies if a single join
column is used.) The concatenation of the following: the name of the
referencing relationship property or field of the referencing entity or
embeddable class; &#8220;_&#8221;; the name of the referenced primary key column. If
there is no such referencing relationship property or field in the
entity, or if the join is for an element collection, the join column
name is formed as the concatenation of the following: the name of the
entity; &#8220;_&#8221;; the name of the referenced primary key column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencedColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the column referenced
by this foreign key column. When used with entity relationship mappings
other than the cases described below, the referenced column is in the
table of the target entity. When used with a unidirectional OneToMany
foreign key mapping, the referenced column is in the table of the source
entity. When used inside a JoinTable annotation, the referenced key
column is in the entity table of the owning entity, or inverse entity if
the join is part of the inverse join definition. When used in a
collection table mapping, the referenced column is in the table of the
entity containing the collection.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default
only applies if single join column is being used.) The same name as the
primary key column of the referenced table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the property is a unique
key. This is a shortcut for the UniqueConstraint annotation at the table
level and is useful for when the unique key constraint is only a single
field. It is not necessary to explicitly specify this for a join column
that corresponds to a primary key that is part of a foreign key.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the foreign key column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL for the column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table that contains the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the join is for a
OneToOne or ManyToOne mapping using a foreign key mapping strategy, the
name of the table of the source entity or embeddable. If the join is for
a unidirectional OneToMany mapping using a foreign key mapping strategy,
the name of the table of the target entity. If the join is for a
ManyToMany mapping or for a OneToOne or bidirectional ManyToOne/
OneToMany mapping using a join table, the name of the join table. If the
join is for an element collection, the name of the collection table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint for
the join column. This is used only if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CheckConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Check constraints for the column. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No check constraint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Comment for the column. This is
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No comment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> Address getAddress() { <span class="keyword">return</span> address; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Unidirectional One-to-Many association using a foreign key mapping.</p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>) <span class="comment">// join column is in table for Order</span>
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Order&gt; getOrders() { <span class="keyword">return</span> orders; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="joincolumns-annotation"><a class="anchor" href="#joincolumns-annotation"></a>11.1.27. JoinColumns Annotation</h4>
<div class="paragraph">
<p>Composite foreign keys are supported by means
of the <code>JoinColumns</code> annotation. The <code>JoinColumns</code> annotation groups
<code>JoinColumn</code> annotations for the same relationship.</p>
</div>
<div class="paragraph">
<p>When the <code>JoinColumns</code> annotation is used,
both the <code>name</code> and the <code>referencedColumnName</code> elements must be
specified in each of the grouped <code>JoinColumn</code> annotations.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> annotation element is used
to specify or control the generation of a foreign key constraint when
schema generation is in effect. If both this element and the
<code>foreignKey</code> element of any of the <code>JoinColumn</code> elements referenced by
the <code>value</code> element are specified, the behavior is undefined. If no
<code>foreignKey</code> annotation element is specified in either location, the
persistence provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> JoinColumns {
    JoinColumn<span class="type">[]</span> value();
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15003">Table 25</a> lists the annotation elements that may
be specified for the <code>JoinColumns</code> annotation.</p>
</div>
<table id="a15003" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. JoinColumns Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The join columns that map the relationship.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>
<span class="annotation">@JoinColumns</span>({
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ZIP</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ZIP</span><span class="delimiter">&quot;</span></span>)
})
<span class="directive">public</span> Address getAddress() { <span class="keyword">return</span> address; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15022"><a class="anchor" href="#a15022"></a>11.1.28. JoinTable Annotation</h4>
<div class="paragraph">
<p>The <code>JoinTable</code> annotation is used in the
mapping of entity associations. A <code>JoinTable</code> annotation is specified on
the owning side of the association. A join table is typically used in
the mapping of many-to-many and unidirectional one-to-many associations.
It may also be used to map bidirectional many-to-one/one-to-many
associations, unidirectional many-to-one relationships, and one-to-one
associations (both bidirectional and unidirectional).</p>
</div>
<div class="paragraph">
<p><a href="#a15043">Table 26</a> lists the annotation elements that may be specified
for the <code>JoinTable</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If the <code>JoinTable</code> annotation is not
explicitly specified for the mapping of a many-to-many or unidirectional
one-to-many relationship, the default values of the annotation elements
apply.</p>
</div>
<div class="paragraph">
<p>The name of the join table is assumed to be
the table names of the associated primary tables concatenated together
(owning side first) using an underscore.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <code>joinColumns</code> element when table generation is in
effect. If both this element and the <code>foreignKey</code> element of any of the
<code>joinColumns</code> elements are specified, the behavior is undefined. If no
<code>foreignKey</code> annotation element is specified in either location, the
persistence provider&#8217;s default foreign key strategy will apply. The
<code>inverseForeignKey</code> element applies to the generation of a foreign key
constraint for the columns corresponding to the <code>inverseJoinColumns</code>
element, and similar rules apply.</p>
</div>
<div class="paragraph">
<p>When a join table is used in mapping a
relationship with an embeddable class on the owning side of the
relationship, the containing entity rather than the embeddable class is
considered the owner of the relationship.</p>
</div>
<div class="paragraph">
<p>This annotation may not be applied to a persistent field or property
not annotated <code>@ManyToOne</code>, <code>@OneToOne</code>, <code>@ManyToMany</code>, or <code>@OneToMany</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> JoinTable {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    JoinColumn<span class="type">[]</span> joinColumns() <span class="keyword">default</span> {};
    JoinColumn<span class="type">[]</span> inverseJoinColumns() <span class="keyword">default</span> {};
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    ForeignKey inverseForeignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
    CheckConstraint<span class="type">[]</span> check() <span class="keyword">default</span> {}
    <span class="predefined-type">String</span> comment() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a15043" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. JoinTable Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the join table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concatenated names of the two associated
primary entity tables (owning side first), separated by an underscore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key columns of the
join table which reference the primary table of the entity owning the
association (i.e. the owning side of the association).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The same defaults as for JoinColumn.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inverseJoinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key columns of the
join table which reference the primary table of the entity that does not
own the association (i.e. the inverse side of the association).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The same defaults as for JoinColumn.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inverseForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the inverse join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are only used if table generation is in
effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CheckConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Check constraints for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No check constraint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Comment for the table. This is
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No comment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@JoinTable</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_PHONE</span><span class="delimiter">&quot;</span></span>,
    joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
    inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PHONE_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15087"><a class="anchor" href="#a15087"></a>11.1.29. Lob Annotation</h4>
<div class="paragraph">
<p>A <code>Lob</code> annotation specifies that a
persistent property or field should be persisted as a large object to a
database-supported large object type. Portable applications should use
the <code>Lob</code> annotation when mapping to a database Lob type. The <code>Lob</code>
annotation may be used in conjunction with the <code>Basic</code> annotation or
with the `ElementCollection`<sup class="footnote">[<a id="_footnoteref_119" class="footnote" href="#_footnotedef_119" title="View footnote.">119</a>]</sup> annotation when the
element collection value is of basic type. A Lob may be either a binary
or character type. The Lob type is inferred from the type of the
persistent field or property and, except for string and character types,
defaults to Blob.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Lob {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Lob</span>
<span class="annotation">@Basic</span>(fetch=EAGER)
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">REPORT</span><span class="delimiter">&quot;</span></span>)
<span class="directive">protected</span> <span class="predefined-type">String</span> report;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Lob</span> <span class="annotation">@Basic</span>(fetch=LAZY)
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_PIC</span><span class="delimiter">&quot;</span></span>, columnDefinition=<span class="string"><span class="delimiter">&quot;</span><span class="content">BLOB NOT NULL</span><span class="delimiter">&quot;</span></span>)
<span class="directive">protected</span> <span class="type">byte</span><span class="type">[]</span> pic;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15100"><a class="anchor" href="#a15100"></a>11.1.30. ManyToMany Annotation</h4>
<div class="paragraph">
<p>A <code>ManyToMany</code> annotation defines a
many-valued association with many-to-many multiplicity. If the
collection is defined using generics to specify the element type, the
associated target entity class does not need to be specified; otherwise
it must be specified.</p>
</div>
<div class="paragraph">
<p>Every many-to-many association has two sides,
the owning side and the non-owning, or inverse, side. If the association
is bidirectional, either side may be designated as the owning side. If
the relationship is bidirectional, the non-owning side must use the
<code>mappedBy</code> element of the <code>ManyToMany</code> annotation to specify the
relationship field or property of the owning side.</p>
</div>
<div class="paragraph">
<p>The join table for the relationship, if not
defaulted, is specified on the owning side.</p>
</div>
<div class="paragraph">
<p>The <code>ManyToMany</code> annotation may be used
within an embeddable class contained within an entity class to specify a
relationship to a collection of entities<sup class="footnote">[<a id="_footnoteref_120" class="footnote" href="#_footnotedef_120" title="View footnote.">120</a>]</sup>. If the
relationship is bidirectional and the entity containing the embeddable
class is the owner of the relationship, the non-owning side must use the
<code>mappedBy</code> element of the <code>ManyToMany</code> annotation to specify the
relationship field or property of the embeddable class. The dot (<em>"."</em>
) notation syntax must be used in the <code>mappedBy</code> element to indicate the
relationship attribute within the embedded attribute. The value of each
identifier used with the dot notation is the name of the respective
embedded field or property.</p>
</div>
<div class="paragraph">
<p><a href="#a15119">Table 27</a> lists these annotation elements that may be
specified for the <code>ManyToMany</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>The <code>cascade</code> element specifies the set of
cascadable operations that are propagated to the associated entity. The
operations that are cascadable are defined by the <code>CascadeType</code> enum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> CascadeType {ALL, PERSIST, MERGE, REMOVE, REFRESH, DETACH};</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value <code>cascade=ALL</code> is equivalent to
<code>cascade={PERSIST, MERGE, REMOVE, REFRESH, DETACH}</code>.</p>
</div>
<div class="paragraph">
<p>When the collection is a <code>java.util.Map</code>,
the <code>cascade</code> element applies to the map <code>value</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ManyToMany {
    <span class="predefined-type">Class</span> targetEntity() <span class="keyword">default</span> <span class="type">void</span>.class;
    CascadeType<span class="type">[]</span> cascade() <span class="keyword">default</span> {};
    FetchType fetch() <span class="keyword">default</span> LAZY;
    <span class="predefined-type">String</span> mappedBy() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>EAGER</code> strategy is a requirement on the
persistence provider runtime that the associated entity must be eagerly
fetched. The <code>LAZY</code> strategy is a <code>hint</code> to the persistence provider
runtime that the associated entity should be fetched lazily when it is
first accessed. The implementation is permitted to eagerly fetch
associations for which the <code>LAZY</code> strategy hint has been specified.</p>
</div>
<table id="a15119" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. ManyToMany Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The entity class that is the
target of the association. Optional only if the collection-valued
relationship property is defined using Java generics. Must be specified
otherwise.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The parameterized type of the collection when defined using generics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CascadeType[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The operations that must be
cascaded to the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No operations are cascaded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the associated
entities must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAZY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mappedBy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field or property that owns the
relationship. Required unless the relationship is unidirectional.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>
<span class="annotation">@JoinTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_PHONES</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;PhoneNumber&gt; getPhones() { <span class="keyword">return</span> phones; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In PhoneNumber class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Customer&gt; getCustomers() { <span class="keyword">return</span> customers; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>(targetEntity=com.acme.PhoneNumber.class)
<span class="directive">public</span> <span class="predefined-type">Set</span> getPhones() { <span class="keyword">return</span> phones; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In PhoneNumber class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>(targetEntity=com.acme.Customer.class, mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Set</span> getCustomers() { <span class="keyword">return</span> customers; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>
<span class="annotation">@JoinTable</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_PHONE</span><span class="delimiter">&quot;</span></span>,
    joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
    inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PHONE_ID</span><span class="delimiter">&quot;</span></span>,referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;PhoneNumber&gt; getPhones() { <span class="keyword">return</span> phones; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In PhoneNumberClass:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Customer&gt; getCustomers() { <span class="keyword">return</span> customers; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="paragraph">
<p>Embeddable class used by the Employee entity
specifies a many-to-many relationship.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@Embedded</span>
    ContactInfo contactInfo;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContactInfo</span> {
    <span class="annotation">@ManyToOne</span>
    Address address; <span class="comment">// Unidirectional</span>

    <span class="annotation">@ManyToMany</span>
    <span class="predefined-type">List</span>&lt;PhoneNumber&gt; phoneNumbers; <span class="comment">// Bidirectional</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneNumber</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> phNumber;

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo.phoneNumbers</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Employee&gt; employees;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="manytoone-annotation"><a class="anchor" href="#manytoone-annotation"></a>11.1.31. ManyToOne Annotation</h4>
<div class="paragraph">
<p>The <code>ManyToOne</code> annotation defines a
single-valued association to another entity class that has many-to-one
multiplicity. It is not normally necessary to specify the target entity
explicitly since it can usually be inferred from the type of the object
being referenced.</p>
</div>
<div class="paragraph">
<p>The <code>ManyToOne</code> annotation may be used within
an embeddable class to specify a relationship from the embeddable class
to an entity class. If the relationship is bidirectional, the non-owning
<code>OneToMany</code> entity side must use the <code>mappedBy</code> element of the
<code>OneToMany</code> annotation to specify the relationship field or property of
the embeddable field or property on the owning side of the relationship.
The dot (&#8220;.&#8221;) notation syntax must be used in the <code>mappedBy</code> element
to indicate the relationship attribute within the embedded attribute.
The value of each identifier used with the dot notation is the name of
the respective embedded field or property.</p>
</div>
<div class="paragraph">
<p><a href="#a15202">Table 28</a> lists the annotation elements that may be specified
for the <code>ManyToOne</code> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ManyToOne {
    <span class="predefined-type">Class</span> targetEntity() <span class="keyword">default</span> <span class="type">void</span>.class;
    CascadeType<span class="type">[]</span> cascade() <span class="keyword">default</span> {};
    FetchType fetch() <span class="keyword">default</span> EAGER;
    <span class="type">boolean</span> optional() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The operations that can be cascaded are
defined by the <code>CascadeType</code> enum, defined in <a href="#a15100">Section 11.1.30</a>.</p>
</div>
<div class="paragraph">
<p>The <code>EAGER</code> strategy is a requirement on the
persistence provider runtime that the associated entity must be eagerly
fetched. The <code>LAZY</code> strategy is a <code>hint</code> to the persistence provider
runtime that the associated entity should be fetched lazily when it is
first accessed. The implementation is permitted to eagerly fetch
associations for which the <code>LAZY</code> strategy hint has been specified.</p>
</div>
<table id="a15202" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. ManyToOne Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The entity class that is the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the field or property that stores the association.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CascadeType[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The operations that must be
cascaded to the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No operations are cascaded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the associated
entity must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAGER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association is
optional. If set to false then a non-null relationship must always
exist.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>(optional=<span class="predefined-constant">false</span>)
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, nullable=<span class="predefined-constant">false</span>, updatable=<span class="predefined-constant">false</span>)
<span class="directive">public</span> Customer getCustomer() { <span class="keyword">return</span> customer; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@Embedded</span>
    JobInfo jobInfo;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">JobInfo</span> {
    <span class="predefined-type">String</span> jobDescription;

    <span class="annotation">@ManyToOne</span>
    ProgramManager pm; <span class="comment">// Bidirectional</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ProgramManager</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@OneToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">jobInfo.pm</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Employee&gt; manages;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapkey-annotation"><a class="anchor" href="#mapkey-annotation"></a>11.1.32. MapKey Annotation</h4>
<div class="paragraph">
<p>The <code>MapKey</code> annotation is used to specify
the map key for associations of type <code>java.util.Map</code> when the map key is
itself the primary key or a persistent field or property of the entity
that is the value of the map.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKey {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> element designates the name of the
persistent field or property of the associated entity that is used as
the map key. If the <code>name</code> element is not specified, the primary key of
the associated entity is used as the map key. If the primary key is a
composite primary key and is mapped as <code>IdClass</code>, an instance of the
primary key class is used as the key.</p>
</div>
<div class="paragraph">
<p>If a persistent field or property other than
the primary key is used as a map key, it is expected to be unique within
the context of the relationship.</p>
</div>
<div class="paragraph">
<p>The <code>MapKeyClass</code> annotation is not used when
<code>MapKey</code> is specified and vice versa.</p>
</div>
<div class="paragraph">
<p><a href="#a15256">Table 29</a> lists the annotation elements that may be specified
for the <code>MapKey</code> annotation.</p>
</div>
<table id="a15256" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. MapKey Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the persistent field or property that is used as the map key.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The primary key is used as the map key.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">department</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@MapKey</span> <span class="comment">// map key is primary key</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">Integer</span>, Employee&gt; getEmployees() { ... }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {

    <span class="comment">// ...</span>

    <span class="annotation">@Id</span> <span class="directive">public</span> <span class="predefined-type">Integer</span> getEmpId() { ... }
    <span class="annotation">@ManyToOne</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dept_id</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Department getDepartment() { ... }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">department</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@MapKey</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Employee&gt; getEmployees() { ... }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getEmpId() { ... }

    <span class="comment">// ...</span>

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() { ... }

    <span class="comment">// ...</span>

    <span class="annotation">@ManyToOne</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dept_id</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Department getDepartment() { ... }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapkeyclass-annotation"><a class="anchor" href="#mapkeyclass-annotation"></a>11.1.33. MapKeyClass Annotation</h4>
<div class="paragraph">
<p>The <code>MapKeyClass</code> annotation is used to
specify the type of the map key for associations of type <code>java.util.Map</code>
. The map key can be a basic type, an embeddable class, or an entity. If
the map is specified using Java generics, the <code>MapKeyClass</code> annotation
and associated type need not be specified; otherwise they must be
specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyClass {
    <span class="predefined-type">Class</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MapKeyClass</code> annotation is used in
conjunction with <code>ElementCollection</code> or one of the collection-valued
relationship annotations (<code>OneToMany</code> or <code>ManyToMany</code>).</p>
</div>
<div class="paragraph">
<p>The <code>MapKey</code> annotation is not used when
<code>MapKeyClass</code> is specified and vice versa.</p>
</div>
<div class="paragraph">
<p><a href="#a15316">Table 30</a> lists the annotation elements that may
be specified for the <code>MapKeyClass</code> annotation.</p>
</div>
<table id="a15316" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. MapKeyClass Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The type of the map key.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Item</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>(targetClass=<span class="predefined-type">String</span>.class)
    <span class="annotation">@MapKeyClass</span>(<span class="predefined-type">String</span>.class)
    <span class="predefined-type">Map</span> images; <span class="comment">// map from image name to image filename</span>

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MapKeyClass and target type of relationship can be defaulted</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Item</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; images;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Company</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>(targetEntity=com.example.VicePresident.class)
    <span class="annotation">@MapKeyClass</span>(com.example.Division.class)
    <span class="predefined-type">Map</span> organization;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MapKeyClass and target type of relationship are defaulted</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Company</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>
    <span class="predefined-type">Map</span>&lt;Division, VicePresident&gt; organization;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15367"><a class="anchor" href="#a15367"></a>11.1.34. MapKeyColumn Annotation</h4>
<div class="paragraph">
<p>The <code>MapKeyColumn</code> annotation is used to
specify the mapping for the key column of a map whose map key is a basic
type. If the <code>name</code> element is not specified, it defaults to the
concatenation of the following: the name of the referencing relationship
field or property; &#8220;_&#8221;; &#8220;KEY&#8221;.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> length() <span class="keyword">default</span> <span class="integer">255</span>;
    <span class="type">int</span> precision() <span class="keyword">default</span> <span class="integer">0</span>; <span class="comment">// decimal precision</span>
    <span class="type">int</span> scale() <span class="keyword">default</span> <span class="integer">0</span>; <span class="comment">// decimal scale</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no <code>MapKeyColumn</code> annotation is specified,
the default values in <a href="#a15384">Table 31</a> apply.</p>
</div>
<table id="a15384" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. MapKeyColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the map key column.
The table in which it is found depends upon the context. If the map key
is for an element collection, the map key column is in the collection
table for the map value. If the map key is for a ManyToMany entity
relationship or for a OneToMany entity relationship using a join table,
the map key column is in a join table. If the map key is for a OneToMany
entity relationship using a foreign key mapping strategy, the map key
column is in the table of the entity that is the value of the map.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concatenation of the following: the name
of the referencing property or field name; " <code>_</code> "; " <code>KEY</code> ".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is a unique
key. This is a shortcut for the UniqueConstraint annotation at the table
level and is useful for when the unique key constraint corresponds to
only a single column. This constraint applies in addition to any
constraint entailed by primary key mapping and to constraints specified
at the table level.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the database column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL to create a column of the inferred type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table that contains the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the map key is for
an element collection, the name of the collection table for the map
value. If the map key is for a OneToMany or ManyToMany entity
relationship using a join table, the name of the join table for the map.
If the map key is for a OneToMany entity relationship using a foreign
key mapping strategy, the name of the primary table of the entity that
is the value of the map.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The column length</p>
<p class="tableblock"> Applies only to columns whose type is parameterized by length,
 for example, varchar or varbinary types.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">255</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">precision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The precision of a column of SQL type <code>decimal</code> or
<code>numeric</code>, or of similar database-native type.</p>
<p class="tableblock"> Applies only to columns of exact numeric type.</p>
<p class="tableblock"> The default value <code>0</code> indicates that a provider-determined
 precision should be inferred.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The scale of a column of SQL type <code>decimal</code> or
<code>numeric</code>, or of similar database-native type.</p>
<p class="tableblock"> Applies only to columns of exact numeric type.</p>
<p class="tableblock"> The default value <code>0</code> indicates that a provider-determined
 scale should be inferred.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Item</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>
    <span class="annotation">@MapKeyColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">IMAGE_NAME</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">IMAGE_FILENAME</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@CollectionTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">IMAGE_MAPPING</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; images; <span class="comment">// map from image name to filename</span>

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15433"><a class="anchor" href="#a15433"></a>11.1.35. MapKeyEnumerated Annotation</h4>
<div class="paragraph">
<p>The <code>MapKeyEnumerated</code> annotation is used to
specify the enum type for a map key whose basic type is an enumerated
type.</p>
</div>
<div class="paragraph">
<p>The <code>MapKeyEnumerated</code> annotation can be
applied to an element collection or relationship of type <code>java.util.Map</code>
, in conjunction with the <code>ElementCollection</code>, <code>OneToMany</code>, or
<code>ManyToMany</code> annotation. If the map is specified using Java generics,
the <code>MapKeyClass</code> annotation and associated type need not be specified;
otherwise they must be specified.</p>
</div>
<div class="paragraph">
<p>If the enumerated type is not specified or
the <code>MapKeyEnumerated</code> annotation is not used, the enumerated type is
assumed to be <code>ORDINAL</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyEnumerated {
    EnumType value() <span class="keyword">default</span> ORDINAL;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15443">Table 32</a> lists the annotation elements that
may be specified for the <code>MapKeyEnumerated</code> annotation and their default
values. The <code>EnumType</code> enum is defined in <a href="#a14719">Section 11.1.18</a>.</p>
</div>
<table id="a15443" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. MapKeyEnumerated Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnumType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The type used in mapping an enum type.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ORDINAL</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a15450"><a class="anchor" href="#a15450"></a>11.1.36. MapKeyJoinColumn Annotation</h4>
<div class="paragraph">
<p>The <code>MapKeyJoinColumn</code> annotation is used to
specify a mapping to an entity that is a map key. The map key join
column is in the collection table, join table, or table of the target
entity that is used to represent the map.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(MapKeyJoinColumns.class)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyJoinColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> referencedColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15474">Table 33</a> lists the annotation elements that
may be specified for the <code>MapKeyJoinColumn</code> annotation and their default
values.</p>
</div>
<div class="paragraph">
<p>If no <code>MapKeyJoinColumn</code> annotation is
specified, a single join column is assumed and the default values
described below (and in <a href="#a15474">Table 33</a>) apply.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> annotation element defines the
name of the foreign key column. The remaining annotation elements (other
than <code>referencedColumnName</code>) refer to this column.</p>
</div>
<div class="paragraph">
<p>If there is a single map key join column, and
if the name annotation member is missing, the map key join column name
is formed as the concatenation of the following: the name of the
referencing relationship property or field of the referencing entity or
embeddable; " <code>_</code> "; " <code>KEY</code> ".</p>
</div>
<div class="paragraph">
<p>If the <code>referencedColumnName</code> element is
missing, the foreign key is assumed to refer to the primary key of the
referenced table. Support for referenced columns that are not primary
key columns of the referenced table is optional. Applications that use
such mappings will not be portable.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> element is used to specify
or control the generation of a foreign key constraint for the map key
join column when table generation is in effect. If the <code>foreignKey</code>
element is not specified, the persistence provider&#8217;s default foreign key
strategy will be used.</p>
</div>
<div class="paragraph">
<p>If more than one <code>MapKeyJoinColumn</code>
annotation is applied to a field or property, both the <code>name</code> and the
<code>referencedColumnName</code> elements must be specified in each such
<code>MapKeyJoinColumn</code> annotation.</p>
</div>
<table id="a15474" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. MapKeyJoinColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the foreign key
column for the map key. The table in which it is found depends upon the
context. If the join is for a map key for an element collection, the
foreign key column is in the collection table for the map value. If the
join is for a map key for a ManyToMany entity relationship or for a
OneToMany entity relationship using a join table, the foreign key column
is in a join table. If the join is for a OneToMany entity relationship
using a foreign key mapping strategy, the foreign key column for the map
key is in the table of the entity that is the value of the map.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default only applies if a single join
column is used.) The concatenation of the following: the name of the
referencing relationship property or field of the referencing entity or
embeddable class; &#8220;_&#8221;; "KEY".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencedColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the column referenced
by this foreign key column. The referenced column is in the table of the
target entity.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default only applies if
single join column is being used.) The same name as the primary key
column of the referenced table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the property is a unique
key. This is a shortcut for the UniqueConstraint annotation at the table
level and is useful for when the unique key constraint is only a single
field.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the foreign key column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL for the column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table that
contains the foreign key column. If the join is for a map key for an
element collection, the foreign key column is in the collection table
for the map value. If the join is for a map key for a ManyToMany entity
relationship or for a OneToMany entity relationship using a join table,
the foreign key column is in a join table. If the join is for a
OneToMany entity relationship using a foreign key mapping strategy, the
foreign key column for the map key is in the table of the entity that is
the value of the map.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the map is for an
element collection, the name of the collection table for the map value.
If the map is for a OneToMany or ManyToMany entity relationship using a
join table, the name of the join table for the map. If the map is for a
OneToMany entity relationship using a foreign key mapping strategy, the
name of the primary table of the entity that is the value of the map.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join column. This is used only if table generation
is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Company</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span> <span class="comment">// unidirectional</span>
    <span class="annotation">@JoinTable</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COMPANY_ORGANIZATION</span><span class="delimiter">&quot;</span></span>,
        joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COMPANY</span><span class="delimiter">&quot;</span></span>),
        inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">VICEPRESIDENT</span><span class="delimiter">&quot;</span></span>)
    )
    <span class="annotation">@MapKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DIVISION</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Map</span>&lt;Division, VicePresident&gt; organization;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">VideoStore</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="predefined-type">String</span> name;

    Address location;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>
    <span class="annotation">@CollectionTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">INVENTORY</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">STORE</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COPIES_IN_STOCK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@MapKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">MOVIE</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Map</span>&lt;Movie, <span class="predefined-type">Integer</span>&gt; videoInventory;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Movie</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> id;

    <span class="predefined-type">String</span> title;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Student</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> studentId;

    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span> <span class="comment">// students and courses are also many-many</span>
    <span class="annotation">@JoinTable</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ENROLLMENTS</span><span class="delimiter">&quot;</span></span>,
        joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">STUDENT</span><span class="delimiter">&quot;</span></span>),
        inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">SEMESTER</span><span class="delimiter">&quot;</span></span>)
    )
    <span class="annotation">@MapKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COURSE</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Map</span>&lt;Course, Semester&gt; enrollment;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapkeyjoincolumns-annotation"><a class="anchor" href="#mapkeyjoincolumns-annotation"></a>11.1.37. MapKeyJoinColumns Annotation</h4>
<div class="paragraph">
<p>Composite map keys referencing entities are
supported by means of the <code>MapKeyJoinColumns</code> annotation. The
<code>MapKeyJoinColumns</code> annotation groups <code>MapKeyJoinColumn</code> annotations.</p>
</div>
<div class="paragraph">
<p>When the <code>MapKeyJoinColumns</code> annotation is
used, both the <code>name</code> and the <code>referencedColumnName</code> elements must be
specified in each of the grouped <code>MapKeyJoinColumn</code> annotations.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <code>MapKeyJoinColumn</code> elements referenced by the
<code>value</code> element when table generation is in effect. If both this element
and the <code>foreignKey</code> element of any of the <code>MapKeyJoinColumn</code> elements
are specified, the behavior is undefined. If no <code>foreignKey</code> annotation
element is specified in either location, the persistence provider&#8217;s
default foreign key strategy will apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyJoinColumns {
    MapKeyJoinColumn<span class="type">[]</span> value();
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15572">Table 34</a> lists the annotation elements
that may be specified for the <code>MapKeyJoinColumns</code> annotation.</p>
</div>
<table id="a15572" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 34. MapKeyJoinColumns Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MapKeyJoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The map key join columns that are used to map to the entity that is the map key.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a15583"><a class="anchor" href="#a15583"></a>11.1.38. MapKeyTemporal Annotation</h4>
<div class="paragraph">
<p>The <code>MapKeyTemporal</code> annotation is used to
specify the temporal type for a map key whose basic type is a temporal
type.</p>
</div>
<div class="paragraph">
<p>The <code>MapKeyTemporal</code> annotation can be
applied to an element collection or relationship of type <code>java.util.Map</code>
, in conjunction with the <code>ElementCollection</code>, <code>OneToMany</code>, or
<code>ManyToMany</code> annotation. If the map is specified using Java generics,
the <code>MapKeyClass</code> annotation and associated type need not be specified;
otherwise they must be specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyTemporal {
    TemporalType value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MapKeyTemporal</code> enum is deprecated, and its use in newly-written code is strongly discouraged.</p>
</div>
<div class="paragraph">
<p><a href="#a15593">Table 35</a> lists the annotation elements that
may be specified for the <code>MapKeyTemporal</code> annotation and their default
values. The <code>TemporalType</code> enum is defined in <a href="#a16361">Section 11.1.54</a>.</p>
</div>
<table id="a15593" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 35. MapKeyTemporal Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TemporalType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The type used in mapping java.util.Date or java.util.Calendar.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="mappedsuperclass-annotation"><a class="anchor" href="#mappedsuperclass-annotation"></a>11.1.39. MappedSuperclass Annotation</h4>
<div class="paragraph">
<p>The <code>MappedSuperclass</code> annotation designates
a class whose mapping information is applied to the entities that
inherit from it. A mapped superclass has no separate table defined for
it.</p>
</div>
<div class="paragraph">
<p>A class designated with the
<code>MappedSuperclass</code> annotation can be mapped in the same way as an entity
except that the mappings will apply only to its subclasses since no
table exists for the mapped superclass itself. When applied to the
subclasses the inherited mappings will apply in the context of the
subclass tables. Mapping information may be overridden in such
subclasses by using the <code>AttributeOverride</code>, <code>AttributeOverrides</code>,
<code>AssociationOverride</code>, and <code>AssociationOverrides</code> annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Documented</span>
<span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MappedSuperclass {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapsid-annotation"><a class="anchor" href="#mapsid-annotation"></a>11.1.40. MapsId Annotation</h4>
<div class="paragraph">
<p>The <code>MapsId</code> annotation is used to designate
a <code>ManyToOne</code> or <code>OneToOne</code> relationship attribute that provides the
mapping for an <code>EmbeddedId</code> primary key, an attribute within an
<code>EmbeddedId</code> primary key, or a simple primary key of the parent entity.</p>
</div>
<div class="paragraph">
<p>The <code>value</code> element specifies the attribute
within a composite key to which the relationship attribute corresponds.
If the entity&#8217;s primary key is of the same Java type as the primary key
of the entity referenced by the relationship, the <code>value</code> attribute is
not specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapsId {
    <span class="predefined-type">String</span> value() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15615">Table 36</a> lists the annotation elements that may be specified
for the <code>MapsId</code> annotation.</p>
</div>
<table id="a15615" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 36. MapsId Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the attribute within
the composite key to which the relationship attribute corresponds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The relationship maps the entity&#8217;s primary key.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// parent entity has simple primary key</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> empId;

    <span class="predefined-type">String</span> name;

    <span class="comment">// ...</span>
}

<span class="comment">// dependent entity uses EmbeddedId for composite key</span>
<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    <span class="type">long</span> empid; <span class="comment">// corresponds to PK type of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@EmbeddedId</span>
    DependentId id;

    <span class="comment">// ...</span>

    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empid</span><span class="delimiter">&quot;</span></span>) <span class="comment">// maps the empid attribute of embedded id</span>
    <span class="annotation">@ManyToOne</span>
    Employee emp;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="onetomany-annotation"><a class="anchor" href="#onetomany-annotation"></a>11.1.41. OneToMany Annotation</h4>
<div class="paragraph">
<p>A <code>OneToMany</code> annotation defines a
many-valued association with one-to-many multiplicity.</p>
</div>
<div class="paragraph">
<p><a href="#a15667">Table 37</a> lists the annotation elements that may be specified
for the <code>OneToMany</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If the collection is defined using generics
to specify the element type, the associated target entity class need not
be specified; otherwise it must be specified.</p>
</div>
<div class="paragraph">
<p>The <code>OneToMany</code> annotation may be used within
an embeddable class contained within an entity class to specify a
relationship to a collection of entities<sup class="footnote">[<a id="_footnoteref_121" class="footnote" href="#_footnotedef_121" title="View footnote.">121</a>]</sup>. If the
relationship is bidirectional, the <code>mappedBy</code> element must be used to
specify the relationship field or property of the entity that is the
owner of the relationship.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OneToMany {
    <span class="predefined-type">Class</span> targetEntity() <span class="keyword">default</span> <span class="type">void</span>.class;
    CascadeType<span class="type">[]</span> cascade() <span class="keyword">default</span> {};
    FetchType fetch() <span class="keyword">default</span> LAZY;
    <span class="predefined-type">String</span> mappedBy() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> orphanRemoval() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The operations that can be cascaded are
defined by the <code>CascadeType</code> enum, defined in <a href="#a15100">Section 11.1.30</a>.</p>
</div>
<div class="paragraph">
<p>When the collection is a <code>java.util.Map</code>,
the <code>cascade</code> element and the <code>orphanRemoval</code> element apply to the map
<code>value</code>.</p>
</div>
<div class="paragraph">
<p>If <code>orphanRemoval</code> is <code>true</code> and an entity
that is the target of the relationship is removed from the relationship
(either by removal from the collection or by setting the relationship to
null), the remove operation will be applied to the entity being
orphaned. If the entity being orphaned is a detached, new, or removed
entity, the semantics of <code>orphanRemoval</code> do not apply.</p>
</div>
<div class="paragraph">
<p>If <code>orphanRemoval</code> is <code>true</code> and the remove
operation is applied to the source entity, the remove operation will be
cascaded to the relationship target in accordance with the rules of
<a href="#a1946">Section 3.3.3</a>, (and hence it is not
necessary to specify <code>cascade=REMOVE</code> for the
relationship)<sup class="footnote">[<a id="_footnoteref_122" class="footnote" href="#_footnotedef_122" title="View footnote.">122</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>The remove operation is applied at the time
of the flush operation. The <code>orphanRemoval</code> functionality is intended
for entities that are privately "owned" by their parent entity. Portable
applications must otherwise not depend upon a specific order of removal,
and must not reassign an entity that has been orphaned to another
relationship or otherwise attempt to persist it.</p>
</div>
<div class="paragraph">
<p>The default mapping for unidirectional
one-to-many relationships uses a join table as is described in
<a href="#a758">Section 2.12.5</a>. Unidirectional one-to-many relationships may be
implemented using one-to-many foreign key mappings, using the
<code>JoinColumn</code> and <code>JoinColumns</code> annotations.</p>
</div>
<table id="a15667" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 37. OneToMany Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The entity class that is the
target of the association. Optional only if the collection-valued
relationship property is defined using Java generics. Must be specified
otherwise.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The parameterized type of the collection when defined using generics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CascadeType[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The operations that must be cascaded to the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No operations are cascaded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the associated
entities must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAZY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mappedBy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field or property that owns the
relationship. Required unless the relationship is unidirectional.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">orphanRemoval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether to apply the remove
operation to entities that have been removed from the relationship and
to cascade the remove operation to those entities.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> One-to-Many association using generics</p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>(cascade=ALL, mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>, orphanRemoval=<span class="predefined-constant">true</span>)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Order&gt; getOrders() { <span class="keyword">return</span> orders; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Order class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, nullable=<span class="predefined-constant">false</span>)
<span class="directive">public</span> Customer getCustomer() { <span class="keyword">return</span> customer; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> One-to-Many association without using generics</p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>(
    targetEntity=com.acme.Order.class,
    cascade=ALL,
    mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>,
    orphanRemoval=<span class="predefined-constant">true</span>
)
<span class="directive">public</span> <span class="predefined-type">Set</span> getOrders() { <span class="keyword">return</span> orders; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Order class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, nullable=<span class="predefined-constant">false</span>)
<span class="directive">protected</span> Customer customer;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong> Unidirectional One-to-Many association using a foreign key mapping</p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>(orphanRemoval=<span class="predefined-constant">true</span>)
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>) <span class="comment">// join column is in table for Order</span>
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Order&gt; getOrders() { <span class="keyword">return</span> orders; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="onetoone-annotation"><a class="anchor" href="#onetoone-annotation"></a>11.1.42. OneToOne Annotation</h4>
<div class="paragraph">
<p>The <code>OneToOne</code> annotation defines a
single-valued association to another entity that has one-to-one
multiplicity. It is not normally necessary to specify the associated
target entity explicitly since it can usually be inferred from the type
of the object being referenced.</p>
</div>
<div class="paragraph">
<p>If the relationship is bidirectional, the
<code>mappedBy</code> element must be used to specify the relationship field or
property of the entity that is the owner of the relationship.</p>
</div>
<div class="paragraph">
<p>The <code>OneToOne</code> annotation may be used within
an embeddable class to specify a relationship from the embeddable class
to an entity class. If the relationship is bidirectional and the entity
containing the embeddable class is on the owning side of the
relationship, the non-owning side must use the <code>mappedBy</code> element of the
<code>OneToOne</code> annotation to specify the relationship field or property of
the embeddable class. The dot (&#8220;.&#8221;) notation syntax must be used in
the <code>mappedBy</code> element to indicate the relationship attribute within the
embedded attribute. The value of each identifier used with the dot
notation is the name of the respective embedded field or property.</p>
</div>
<div class="paragraph">
<p><a href="#a15735">Table 38</a> lists the annotation elements that may be specified
for the <code>OneToOne</code> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OneToOne {
    <span class="predefined-type">Class</span> targetEntity() <span class="keyword">default</span> <span class="type">void</span>.class;
    CascadeType<span class="type">[]</span> cascade() <span class="keyword">default</span> {};
    FetchType fetch() <span class="keyword">default</span> EAGER;
    <span class="type">boolean</span> optional() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> mappedBy() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> orphanRemoval() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The operations that can be cascaded are
defined by the <code>CascadeType</code> enum, defined in <a href="#a15100">Section 11.1.30</a>.</p>
</div>
<div class="paragraph">
<p>If <code>orphanRemoval</code> is <code>true</code> and an entity
that is the target of the relationship is removed from the relationship
(by setting the relationship to null), the remove operation will be
applied to the entity being orphaned. If the entity being orphaned is a
detached, new, or removed entity, the semantics of <code>orphanRemoval</code> do
not apply.</p>
</div>
<div class="paragraph">
<p>If <code>orphanRemoval</code> is <code>true</code> and the remove
operation is applied to the source entity, the remove operation will be
cascaded to the relationship target in accordance with the rules of
<a href="#a1946">Section 3.3.3</a>, (and hence it is not
necessary to specify <code>cascade=REMOVE</code> for the
relationship)<sup class="footnote">[<a id="_footnoteref_123" class="footnote" href="#_footnotedef_123" title="View footnote.">123</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>The remove operation is applied at the time
of the flush operation. The <code>orphanRemoval</code> functionality is intended
for entities that are privately "owned" by their parent entity. Portable
applications must otherwise not depend upon a specific order of removal,
and must not reassign an entity that has been orphaned to another
relationship or otherwise attempt to persist it.</p>
</div>
<table id="a15735" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 38. OneToOne Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The entity class that is the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the field or property that stores the association.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CascadeType[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The operations that must be cascaded to the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No operations are cascaded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the associated
entity must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAGER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association is
optional. If set to false then a non-null relationship must always
exist.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mappedBy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The field or property that owns
the relationship. The mappedBy element is only specified on the inverse
(non-owning) side of the association.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">orphanRemoval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether to apply the remove
operation to entities that have been removed from the relationship and
to cascade the remove operation to those entities.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> One-to-one association that maps a foreign key column.</p>
</div>
<div class="paragraph">
<p>On Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToOne</span>(optional=<span class="predefined-constant">false</span>)
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTREC_ID</span><span class="delimiter">&quot;</span></span>, unique=<span class="predefined-constant">true</span>, nullable=<span class="predefined-constant">false</span>, updatable=<span class="predefined-constant">false</span>)
<span class="directive">public</span> CustomerRecord getCustomerRecord() { <span class="keyword">return</span> customerRecord; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>On CustomerRecord class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToOne</span>(optional=<span class="predefined-constant">false</span>, mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">customerRecord</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> Customer getCustomer() { <span class="keyword">return</span> customer; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> One-to-one association where
both source and target share the same primary key values.</p>
</div>
<div class="paragraph">
<p>On Employee class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">Integer</span> id;

    <span class="annotation">@OneToOne</span>(orphanRemoval=<span class="predefined-constant">true</span>)
    <span class="annotation">@MapsId</span>
    EmployeeInfo info;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On EmployeeInfo class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeInfo</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">Integer</span> id;

    <span class="comment">//...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong> One-to-one association from an embeddable class to another entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@Embedded</span>
    LocationDetails location;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LocationDetails</span> {
    <span class="type">int</span> officeNumber;

    <span class="annotation">@OneToOne</span>
    ParkingSpot parkingSpot;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ParkingSpot</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="predefined-type">String</span> garage;

    <span class="annotation">@OneToOne</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">location.parkingSpot</span><span class="delimiter">&quot;</span></span>)
    Employee assignedTo;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="orderby-annotation"><a class="anchor" href="#orderby-annotation"></a>11.1.43. OrderBy Annotation</h4>
<div class="paragraph">
<p>The <code>OrderBy</code> annotation specifies the
ordering the elements of a collection-valued association or element
collection are to have when the association or collection is retrieved.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OrderBy {
    <span class="predefined-type">String</span> value() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax of the <code>value</code> ordering element is
an <code>orderby_list</code>, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>orderby_list ::= orderby_item [,orderby_item]*
orderby_item ::= [property_or_field_name] [ASC | DESC]</pre>
</div>
</div>
<div class="paragraph">
<p>If <code>orderby_list</code> is not specified or if <code>ASC</code>
or <code>DESC</code> is not specified, <code>ASC</code> (ascending order) is assumed.</p>
</div>
<div class="paragraph">
<p>If the ordering element is not
specified for an entity association, ordering by the primary key of the
associated entity is assumed.<sup class="footnote">[<a id="_footnoteref_124" class="footnote" href="#_footnotedef_124" title="View footnote.">124</a>]</sup></p>
</div>
<div class="paragraph">
<p>A property or field name specified as an
<code>orderby_item</code> must correspond to a basic persistent property or field
of the associated class or embedded class within it. The properties or
fields used in the ordering must correspond to columns for which
comparison operators are supported.</p>
</div>
<div class="paragraph">
<p>The dot (".") notation is used to refer to an
attribute within an embedded attribute. The value of each identifier
used with the dot notation is the name of the respective embedded field
or property.</p>
</div>
<div class="paragraph">
<p>The <code>OrderBy</code> annotation may be applied to an
element collection. When <code>OrderBy</code> is applied to an element collection
of basic type, the ordering will be by value of the basic objects and
the <code>property_or_field_name</code> is not used.<sup class="footnote">[<a id="_footnoteref_125" class="footnote" href="#_footnotedef_125" title="View footnote.">125</a>]</sup> When
specifying an ordering over an element collection of embeddable type,
the dot notation must be used to specify the attribute or attributes
that determine the ordering.</p>
</div>
<div class="paragraph">
<p>The <code>OrderBy</code> annotation is not used when an
order column is specified. See <a href="#a15873">Section 11.1.44</a>.</p>
</div>
<div class="paragraph">
<p><a href="#a15828">Table 39</a> lists the annotation elements that may be specified
for the <code>OrderBy</code> annotation.</p>
</div>
<table id="a15828" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 39. OrderBy Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The list of attributes
(optionally qualified with ASC or DESC) whose values are used in the
ordering.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ascending ordering by the primary key.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Course</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span>
    <span class="annotation">@OrderBy</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">lastname ASC</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Student&gt; getStudents() { ... };

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Student</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">students</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@OrderBy</span> <span class="comment">// PK is assumed</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Course&gt; getCourses() { ... };

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>
    <span class="annotation">@OrderBy</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode.zip, zipcode.plusFour</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Address&gt; getResidences() { ... };

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> street;
    <span class="directive">protected</span> <span class="predefined-type">String</span> city;
    <span class="directive">protected</span> <span class="predefined-type">String</span> state;

    <span class="annotation">@Embedded</span>
    <span class="directive">protected</span> Zipcode zipcode;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Zipcode</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> zip;
    <span class="directive">protected</span> <span class="predefined-type">String</span> plusFour;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15873"><a class="anchor" href="#a15873"></a>11.1.44. OrderColumn Annotation</h4>
<div class="paragraph">
<p>The <code>OrderColumn</code> annotation specifies
a column that is used to maintain the persistent order of a list. The
persistence provider is responsible for maintaining the order upon
retrieval and in the database. The persistence provider is responsible
for updating the ordering upon flushing to the database to reflect any
insertion, deletion, or reordering affecting the list. The <code>OrderColumn</code>
annotation may be specified on a one-to-many or many-to-many
relationship or on an element collection. The <code>OrderColumn</code> annotation
is specified on the side of the relationship that references the
collection that is to be ordered. The order column is not visible as
part of the state of the entity or embeddable
class.<sup class="footnote">[<a id="_footnoteref_126" class="footnote" href="#_footnotedef_126" title="View footnote.">126</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <code>OrderBy</code> annotation is not used when
<code>OrderColumn</code> is specified.</p>
</div>
<div class="paragraph">
<p><a href="#a15888">Table 40</a> lists the annotation elements that may be specified
for the <code>OrderColumn</code> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OrderColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>name</code> is not specified, the column name
is the concatenation of the following: the name of the referencing
relationship property or field of the referencing entity or embeddable
class; " <code>_</code> "; " <code>ORDER</code> ".</p>
</div>
<div class="paragraph">
<p>The order column must be of integral type.
The persistence provider must maintain a contiguous (non-sparse)
ordering of the values of the order column when updating the association
or element collection. The order column value for the first element of
the list must be 0.</p>
</div>
<table id="a15888" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 40. OrderColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the ordering column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concatenation of the name of the referencing property or field; " <code>_</code> "; " <code>ORDER</code> ".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the database column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL to create a column of the inferred type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">CreditCard</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> ccNumber;

    <span class="annotation">@OneToMany</span> <span class="comment">// unidirectional</span>
    <span class="annotation">@OrderColumn</span>
    <span class="predefined-type">List</span>&lt;CardTransaction&gt; transactionHistory;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Course</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span>
    <span class="annotation">@JoinTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COURSE_ENROLLMENT</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Student&gt; getStudents() { ... };

    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span> <span class="comment">// unidirectional</span>
    <span class="annotation">@JoinTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WAIT_LIST</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@OrderColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WAITLIST_ORDER</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Student&gt; getWaitList()  { ... }
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Student</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">students</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Course&gt; getCourses() { ... };

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example of querying the ordered list:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> w
<span class="keyword">FROM</span> course c <span class="keyword">JOIN</span> c.waitlist w
<span class="keyword">WHERE</span> c.name = <span class="string"><span class="delimiter">&quot;</span><span class="content">geometry</span><span class="delimiter">&quot;</span></span> <span class="keyword">AND</span> <span class="type">INDEX</span>(w) = <span class="integer">0</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15947"><a class="anchor" href="#a15947"></a>11.1.45. PrimaryKeyJoinColumn Annotation</h4>
<div class="paragraph">
<p>The <code>PrimaryKeyJoinColumn</code> annotation
specifies a primary key column that is used as a foreign key to join to
another table.</p>
</div>
<div class="paragraph">
<p>The <code>PrimaryKeyJoinColumn</code> annotation is used
to join the primary table of an entity subclass in the JOINED mapping
strategy to the primary table of its superclass; it is used within a
<code>SecondaryTable</code> annotation to join a secondary table to a primary
table; and it may be used in a <code>OneToOne</code> mapping in which the primary
key of the referencing entity is used as a foreign
key<sup class="footnote">[<a id="_footnoteref_127" class="footnote" href="#_footnotedef_127" title="View footnote.">127</a>]</sup> to the referenced
entity<sup class="footnote">[<a id="_footnoteref_128" class="footnote" href="#_footnotedef_128" title="View footnote.">128</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> element is used to specify
or control the generation of a foreign key constraint for the primary
key join column when table generation is in effect. If the <code>foreignKey</code>
element is not specified, the persistence provider&#8217;s default foreign key
strategy will apply.</p>
</div>
<div class="paragraph">
<p><a href="#a15962">Table 41</a> lists the annotation elements
that may be specified for the <code>PrimaryKeyJoinColumn</code> annotation and
their default values.</p>
</div>
<div class="paragraph">
<p>If no <code>PrimaryKeyJoinColumn</code> annotation is
specified for a subclass in the JOINED mapping strategy, the foreign key
columns are assumed to have the same names as the primary key columns of
the primary table of the superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(PrimaryKeyJoinColumns.class)
<span class="directive">public</span> <span class="annotation">@interface</span> PrimaryKeyJoinColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> referencedColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<table id="a15962" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 41. PrimaryKeyJoinColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the primary key column of the current table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The same name
as the primary key column of the primary table of the superclass (JOINED
mapping strategy); the same name as the primary key column of the
primary table (SecondaryTable mapping); or the same name as the primary
key column for the table for the referencing entity (OneToOne mapping).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencedColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the primary key column of the table being joined to.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
same name as the primary key column of the primary table of the
superclass (JOINED mapping strategy); the same name as the primary key
column of the primary table (SecondaryTable mapping); or the same name
as the primary key column of the table for the referenced entity
(OneToOne mapping).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the column. This should not be specified for
a OneToOne primary key association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL to create a column of the inferred type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join column. This is used only if table generation
is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong> Customer and ValuedCustomer subclass</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Inheritance</span>(strategy=JOINED)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="primarykeyjoincolumns-annotation"><a class="anchor" href="#primarykeyjoincolumns-annotation"></a>11.1.46. PrimaryKeyJoinColumns Annotation</h4>
<div class="paragraph">
<p>Composite foreign keys are supported by means
of the <code>PrimaryKeyJoinColumns</code> annotation. The <code>PrimaryKeyJoinColumns</code>
annotation groups <code>PrimaryKeyJoinColumn</code> annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PrimaryKeyJoinColumns {
    PrimaryKeyJoinColumn<span class="type">[]</span> value();
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <code>PrimaryKeyJoinColumn</code> elements referenced by the
<code>value</code> element when table generation is in effect. If both this element
and the <code>foreignKey</code> element of any of the <code>PrimaryKeyJoinColumn</code>
elements are specified, the behavior is undefined. If no <code>foreignKey</code>
annotation element is specified in either location, the persistence
provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="paragraph">
<p><a href="#a16004">Table 42</a> lists the annotation elements
that may be specified for the <code>PrimaryKeyJoinColumns</code> annotation.</p>
</div>
<table id="a16004" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 42. PrimaryKeyJoinColumns Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PrimaryKeyJoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The primary key join columns.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> ValuedCustomer subclass</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumns</span>({
    <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_TYPE</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">TYPE</span><span class="delimiter">&quot;</span></span>)
})
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> OneToOne relationship
between Employee and EmployeeInfo classes.<sup class="footnote">[<a id="_footnoteref_129" class="footnote" href="#_footnotedef_129" title="View footnote.">129</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">EmpPK</span> {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> id;
    <span class="directive">public</span> <span class="predefined-type">String</span> name;
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(com.acme.EmpPK.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> name;

    <span class="annotation">@OneToOne</span>
    <span class="annotation">@PrimaryKeyJoinColumns</span>({
        <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">NAME</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_NAME</span><span class="delimiter">&quot;</span></span>)
    })
    EmployeeInfo info;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(com.acme.EmpPK.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeInfo</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Id</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_NAME</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> name;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16062"><a class="anchor" href="#a16062"></a>11.1.47. SecondaryTable Annotation</h4>
<div class="paragraph">
<p>The <code>SecondaryTable</code> annotation is used to
specify a secondary table for the annotated entity class.</p>
</div>
<div class="paragraph">
<p>If no <code>SecondaryTable</code> annotation is
specified, it is assumed that all persistent fields or properties of the
entity are mapped to the primary table. Specifying one or more secondary
tables indicates that the data for the entity class is stored across
multiple tables.</p>
</div>
<div class="paragraph">
<p><a href="#a16082">Table 43</a> lists the annotation elements that
may be specified for the <code>SecondaryTable</code> annotation and their default
values.</p>
</div>
<div class="paragraph">
<p>If no primary key join columns are specified,
the join columns are assumed to reference the primary key columns of the
primary table, and have the same names and types as the referenced
primary key columns of the primary table.</p>
</div>
<div class="paragraph">
<p>The <code>foreignKey</code> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <code>pkJoinColumns</code> element when table generation is in
effect. If both this element and the <code>foreignKey</code> element of any of the
<code>pkJoinColumns</code> elements are specified, the behavior is undefined. If no
<code>foreignKey</code> annotation element is specified in either location, the
persistence provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="paragraph">
<p>This annotation may not be applied to a class annotated <code>@MappedSuperclass</code>
or <code>@Embeddable</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(SecondaryTables.class)
<span class="directive">public</span> <span class="annotation">@interface</span> SecondaryTable {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    PrimaryKeyJoinColumn<span class="type">[]</span> pkJoinColumns() <span class="keyword">default</span> {};
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
    CheckConstraint<span class="type">[]</span> check() <span class="keyword">default</span> {}
    <span class="predefined-type">String</span> comment() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a16082" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 43. SecondaryTable Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The name of the table.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PrimaryKeyJoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkJoinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The columns that are used to join with the primary table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column(s) of the same name(s) as the primary key column(s) in the primary table</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint for
the join column. This is used only if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are typically only used if table generation
is in effect. These constraints apply in addition to any constraints
specified by the Column and JoinColumn annotations and constraints
entailed by primary key mappings.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CheckConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Check constraints for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No check constraint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Comment for the table. This is
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No comment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> Single secondary table with a single primary key column.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTable</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_DETAIL</span><span class="delimiter">&quot;</span></span>,
    pkJoinColumns=<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>)
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Single secondary table with multiple primary key columns.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTable</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_DETAIL</span><span class="delimiter">&quot;</span></span>,
    pkJoinColumns={
        <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_TYPE</span><span class="delimiter">&quot;</span></span>)
    })
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="secondarytables-annotation"><a class="anchor" href="#secondarytables-annotation"></a>11.1.48. SecondaryTables Annotation</h4>
<div class="paragraph">
<p>The <code>SecondaryTables</code> annotation can be used
to specify multiple secondary tables for an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> SecondaryTables {
    SecondaryTable<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a16136">Table 44</a> lists the annotation elements that
may be specified for the <code>SecondaryTables</code> annotation.</p>
</div>
<table id="a16136" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 44. SecondaryTables Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SecondaryTable[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The secondary tables that are used to map the entity class.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> Multiple secondary tables
assuming primary key columns are named the same in all tables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPLOYEE</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTables</span>({
    <span class="annotation">@SecondaryTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_DETAIL</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@SecondaryTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_HIST</span><span class="delimiter">&quot;</span></span>)
})
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Multiple secondary tables with differently named primary key columns.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPLOYEE</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTables</span>({
    <span class="annotation">@SecondaryTable</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_DETAIL</span><span class="delimiter">&quot;</span></span>,
        pkJoinColumns=<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPL_ID</span><span class="delimiter">&quot;</span></span>)),
    <span class="annotation">@SecondaryTable</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_HIST</span><span class="delimiter">&quot;</span></span>,
        pkJoinColumns=<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPLOYEE_ID</span><span class="delimiter">&quot;</span></span>))
})
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16164"><a class="anchor" href="#a16164"></a>11.1.49. SequenceGenerator Annotation</h4>
<div class="paragraph">
<p>The <code>SequenceGenerator</code> annotation defines a
primary key generator that may be referenced by name when a generator
element is specified for the <code>GeneratedValue</code> annotation. A sequence
generator may be specified on the entity class or on the primary key
field or property. The scope of the generator name is global to the
persistence unit (across all generator types).</p>
</div>
<div class="paragraph">
<p>If no name is explicitly specified by the <code>SequenceGenerator</code> annotation,
and the annotation occurs on an entity class or primary key attribute of
an entity class, then the name defaults to the name of the entity.
Otherwise, if the annotation occurs elsewhere, the behavior is undefined.</p>
</div>
<div class="paragraph">
<p>If no name is explicitly specified by the <code>SequenceGenerator</code> annotation,
and the annotation occurs on a package descriptor, then the annotation
defines a recipe for producing a default generator when a <code>GeneratedValue</code>
annotation of any program element in the annotated package has
<code>strategy=SEQUENCE</code> and a defaulted <code>generator</code> name. The name of this
default generator is the defaulted generator name, and its other properties
are determined by the members of the package-level <code>SequenceGenerator</code>
annotation.</p>
</div>
<div class="paragraph">
<p><a href="#a16179">Table 45</a> lists the annotation elements that may be specified for the
<code>SequenceGenerator</code> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD, PACKAGE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(SequenceGenerators.class)
<span class="directive">public</span> <span class="annotation">@interface</span> SequenceGenerator {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> sequenceName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> initialValue() <span class="keyword">default</span> <span class="integer">1</span>;
    <span class="type">int</span> allocationSize() <span class="keyword">default</span> <span class="integer">50</span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a16179" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 45. SequenceGenerator Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A unique generator name that can be referenced by one or more
classes to be the generator for primary key values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See text above</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sequenceName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the database sequence object from which to obtain
primary key values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen sequence name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the sequence generator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the sequence generator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">initialValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The value from which the sequence
object is to start generating.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">allocationSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The amount to increment by when
allocating sequence numbers from the sequence.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SequenceGenerator</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_SEQ</span><span class="delimiter">&quot;</span></span>, allocationSize=<span class="integer">25</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16205"><a class="anchor" href="#a16205"></a>11.1.50. SequenceGenerators Annotation</h4>
<div class="paragraph">
<p>The SequenceGenerators annotation can be used
to specify multiple sequence generators.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD, PACKAGE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> SequenceGenerators {
    SequenceGenerator<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 46. SequenceGenerators Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SequenceGenerator[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The sequence generator mappings</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="table-annotation"><a class="anchor" href="#table-annotation"></a>11.1.51. Table Annotation</h4>
<div class="paragraph">
<p>The <code>Table</code> annotation specifies the
primary table for the annotated entity. Additional tables may be
specified by using the <code>SecondaryTable</code> or <code>SecondaryTables</code>
annotation.<sup class="footnote">[<a id="_footnoteref_130" class="footnote" href="#_footnotedef_130" title="View footnote.">130</a>]</sup></p>
</div>
<div class="paragraph">
<p><a href="#a16232">Table 47</a> lists the annotation elements that may be specified
for the <code>Table</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If no <code>Table</code> annotation is specified for an
entity class, the default values defined in
<a href="#a16232">Table 47</a> apply.</p>
</div>
<div class="paragraph">
<p>This annotation may not be applied to a class annotated <code>@MappedSuperclass</code>
or <code>@Embeddable</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Table {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
    CheckConstraint<span class="type">[]</span> check() <span class="keyword">default</span> {}
    <span class="predefined-type">String</span> comment() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a16232" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 47. Table Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entity name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are only used if table generation is in
effect. These constraints apply in addition to any constraints specified
by the Column and JoinColumn annotations and constraints entailed by
primary key mappings.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional
constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CheckConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Check constraints for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No check constraint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Comment for the table. This is
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No comment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>, schema=<span class="string"><span class="delimiter">&quot;</span><span class="content">RECORDS</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16256"><a class="anchor" href="#a16256"></a>11.1.52. TableGenerator Annotation</h4>
<div class="paragraph">
<p>The <code>TableGenerator</code> annotation defines a
primary key generator that may be referenced by name when a generator
element is specified for the <code>GeneratedValue</code> annotation. A table
generator may be specified on the entity class or on the primary key
field or property. The scope of the generator name is global to the
persistence unit (across all generator types).</p>
</div>
<div class="paragraph">
<p>If no name is explicitly specified by the <code>TableGenerator</code> annotation,
and the annotation occurs on an entity class or primary key attribute
of an entity class, then the name defaults to the name of the entity.
Otherwise, if the annotation occurs elsewhere, the behavior is undefined.</p>
</div>
<div class="paragraph">
<p>If no name is explicitly specified by the <code>TableGenerator</code> annotation,
and the annotation occurs on a package descriptor, then the annotation
defines a recipe for producing a default generator when a <code>GeneratedValue</code>
annotation of any program element in the annotated package has
<code>strategy=TABLE</code> and a defaulted <code>generator</code> name. The name of this
default generator is the defaulted generator name, and its other properties
are determined by the members of the package-level <code>TableGenerator</code>
annotation.</p>
</div>
<div class="paragraph">
<p><a href="#a162771">Table 48</a> lists the annotation elements that may be specified for the
<code>TableGenerator</code> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>The <code>table</code> element specifies the name of the
table that is used by the persistence provider to store generated
primary key values for entities. An entity type will typically use its
own row in the table for the generation of primary key values. The
primary key values are normally positive integers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD, PACKAGE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(TableGenerators.class)
<span class="directive">public</span> <span class="annotation">@interface</span> TableGenerator {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> pkColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> valueColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> pkColumnValue() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> initialValue() <span class="keyword">default</span> <span class="integer">0</span>;
    <span class="type">int</span> allocationSize() <span class="keyword">default</span> <span class="integer">50</span>;
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a162771" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 48. TableGenerator Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A unique generator name that can be referenced by one or more
classes to be the generator for primary key values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See text above</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Name of table that stores the generated primary key values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen table name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Name of the primary key column in the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">valueColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Name of the column that stores the last value generated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkColumnValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The primary key value in the
generator table that distinguishes this set of generated values from
others that may be stored in the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen value to store in the primary key column of the
generator table</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">initialValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The value used to initialize the
column that stores the last value generated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">allocationSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The amount to increment by when
allocating numbers from the generator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are only used if table generation is in
effect. These constraints apply in addition to primary key constraints.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@TableGenerator</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">empGen</span><span class="delimiter">&quot;</span></span>,
        table=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID_GEN</span><span class="delimiter">&quot;</span></span>,
        pkColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">GEN_KEY</span><span class="delimiter">&quot;</span></span>,
        valueColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">GEN_VALUE</span><span class="delimiter">&quot;</span></span>,
        pkColumnValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>,
        allocationSize=<span class="integer">1</span>)
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy=TABLE, generator=<span class="string"><span class="delimiter">&quot;</span><span class="content">empGen</span><span class="delimiter">&quot;</span></span>)
    <span class="type">int</span> id;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@TableGenerator</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">addressGen</span><span class="delimiter">&quot;</span></span>,
        table=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID_GEN</span><span class="delimiter">&quot;</span></span>,
        pkColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">GEN_KEY</span><span class="delimiter">&quot;</span></span>,
        valueColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">GEN_VALUE</span><span class="delimiter">&quot;</span></span>,
        pkColumnValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy=TABLE, generator=<span class="string"><span class="delimiter">&quot;</span><span class="content">addressGen</span><span class="delimiter">&quot;</span></span>)
    <span class="type">int</span> id;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tablegenerators-annotation"><a class="anchor" href="#tablegenerators-annotation"></a>11.1.53. TableGenerators Annotation</h4>
<div class="paragraph">
<p>The TableGenerators annotation can be used to
specify multiple table generators.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD, PACKAGE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> TableGenerators {
    TableGenerator<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 49. TableGenerators Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TableGenerator[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The table generator mappings</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a16361"><a class="anchor" href="#a16361"></a>11.1.54. Temporal Annotation</h4>
<div class="paragraph">
<p>The <code>Temporal</code> annotation must be specified
for persistent fields or properties of type <code>java.util.Date</code> and
<code>java.util.Calendar</code> unless a converter is being applied. It may only be
specified for fields or properties of these types.</p>
</div>
<div class="paragraph">
<p>The <code>Temporal</code> annotation may be used in
conjunction with the <code>Basic</code> annotation, the <code>Id</code> annotation, or the
`ElementCollection`<sup class="footnote">[<a id="_footnoteref_131" class="footnote" href="#_footnotedef_131" title="View footnote.">131</a>]</sup> annotation (when the element
collection value is of such a temporal type).</p>
</div>
<div class="paragraph">
<p>The <code>TemporalType</code> enum defines the mapping for these temporal types.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> TemporalType {
    DATE, <span class="comment">//java.sql.Date</span>
    TIME, <span class="comment">//java.sql.Time</span>
    TIMESTAMP <span class="comment">//java.sql.Timestamp</span>
}

<span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Temporal {
    TemporalType value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Temporal</code> annotation and <code>TemporalType</code> enum are deprecated, and their use in newly-written code is strongly discouraged.</p>
</div>
<div class="paragraph">
<p><a href="#a16378">Table 50</a> lists the annotation elements that may be specified
for the <code>Temporal</code> annotation and their default values.</p>
</div>
<table id="a16378" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 50. Temporal Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TemporalType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The type used in mapping java.util.Date or java.util.Calendar.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmploymentPeriod</span> {
    <span class="annotation">@Temporal</span>(DATE)
    java.util.Date startDate;

    <span class="annotation">@Temporal</span>(DATE)
    java.util.Date endDate;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="transient-annotation"><a class="anchor" href="#transient-annotation"></a>11.1.55. Transient Annotation</h4>
<div class="paragraph">
<p>The <code>Transient</code> annotation is used to
annotate a property or field of an entity class, mapped superclass, or
embeddable class. It specifies that the property or field is not
persistent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Transient {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@Transient</span>
    User currentUser;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16403"><a class="anchor" href="#a16403"></a>11.1.56. UniqueConstraint Annotation</h4>
<div class="paragraph">
<p>The <code>UniqueConstraint</code> annotation is used to
specify that a unique constraint is to be included in the generated DDL
for a primary or secondary table.</p>
</div>
<div class="paragraph">
<p><a href="#a16413">Table 51</a> lists the annotation elements that
may be specified for the <code>UniqueConstraint</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> UniqueConstraint {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span><span class="type">[]</span> columnNames();
    <span class="predefined-type">String</span> options() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a16413" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 51. UniqueConstraint Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Constraint name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnNames</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) An array of the column names that make up the constraint.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) A SQL fragment appended to the generated DDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing appended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPLOYEE</span><span class="delimiter">&quot;</span></span>,
    uniqueConstraints=<span class="annotation">@UniqueConstraint</span>(columnNames={<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_NAME</span><span class="delimiter">&quot;</span></span>})
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16432"><a class="anchor" href="#a16432"></a>11.1.57. Version Annotation</h4>
<div class="paragraph">
<p>The <code>Version</code> annotation declares the version field or property of an
entity class, as defined in <a href="#a2060">Section 2.5</a>. The version is used to ensure
integrity when performing the merge operation, and for optimistic
concurrency control, as specified in <a href="#a2059">Section 3.5.2</a>.</p>
</div>
<div class="paragraph">
<p>The <code>Version</code> field or property should be mapped to the primary table
of the entity; an application which maps the <code>Version</code> property to a
table other than the primary table is not portable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Version {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Version</span>
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OPTLOCK</span><span class="delimiter">&quot;</span></span>)
<span class="directive">protected</span> <span class="type">int</span> getVersionNum() { <span class="keyword">return</span> versionNum; }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a16444"><a class="anchor" href="#a16444"></a>11.2. Object/Relational Metadata Used in Schema Generation</h3>
<div class="paragraph">
<p>The following annotations and XML elements
define or control the generation of database objects. If schema
generation is in effect, the persistence provider must observe the
mapping information specified by these annotations and their
corresponding XML elements. Unless otherwise specified, all elements of
these annotations are observed in the schema generation process.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CollectionTable</code></p>
</li>
<li>
<p><code>Column</code></p>
</li>
<li>
<p><code>DiscriminatorColumn</code></p>
</li>
<li>
<p><code>EmbeddedId</code></p>
</li>
<li>
<p><code>Enumerated</code>, <code>MapKeyEnumerated</code></p>
</li>
<li>
<p><code>ForeignKey</code></p>
</li>
<li>
<p><code>GeneratedValue</code></p>
</li>
<li>
<p><code>Id</code></p>
</li>
<li>
<p><code>Index</code></p>
</li>
<li>
<p><code>Inheritance</code></p>
</li>
<li>
<p><code>JoinColumn</code></p>
</li>
<li>
<p><code>JoinTable</code></p>
</li>
<li>
<p><code>Lob</code></p>
</li>
<li>
<p><code>MapKeyColumn</code></p>
</li>
<li>
<p><code>MapKeyJoinColumn</code></p>
</li>
<li>
<p><code>OrderColumn</code></p>
</li>
<li>
<p><code>PrimaryKeyJoinColumn</code></p>
</li>
<li>
<p><code>SecondaryTable</code></p>
</li>
<li>
<p><code>SequenceGenerator</code></p>
</li>
<li>
<p><code>Table</code></p>
</li>
<li>
<p><code>TableGenerator</code></p>
</li>
<li>
<p><code>Temporal</code>, <code>MapKeyTemporal</code></p>
</li>
<li>
<p><code>UniqueConstraint</code></p>
</li>
<li>
<p><code>Version</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In some cases, these annotations and elements
may be specified explicitly, while in other cases they may be implied by
the default values of other annotations or elements. For example, by
default a table is generated corresponding to an entity and bears the
same name as that assigned to the entity (which in turn may have been
defaulted from the name of the entity class).</p>
</div>
<div class="paragraph">
<p>The naming of database objects is determined
by the defaulting rules and the explicit names used in annotations
and/or XML. The names of database objects must be treated in conformance
with the requirements of <a href="#a988">Section 2.15</a>.</p>
</div>
<div class="paragraph">
<p>The metadata annotations and corresponding
XML elements that result in generated objects are as follows.</p>
</div>
<div class="sect3">
<h4 id="table-level-elements"><a class="anchor" href="#table-level-elements"></a>11.2.1. Table-level elements</h4>
<div class="paragraph">
<p>The following annotations (and corresponding
XML elements) specify the creation of tables. The rules for their
naming, columns, and other properties are defined in the referenced
sections of this specification:</p>
</div>
<div class="sect4">
<h5 id="table"><a class="anchor" href="#table"></a>11.2.1.1. Table</h5>
<div class="paragraph">
<p>By default, a table is created for every
top-level entity and, by default, includes columns corresponding to the
basic and embedded attributes of the entity and the foreign keys to the
tables of related entities. These columns include columns that result
from the use of mapped superclasses, if any. The <code>SecondaryTable</code>
annotation, in conjunction with the use of the <code>table</code> element of the
<code>Column</code> and <code>JoinColumn</code> annotations, is used to override this mapping
to partition the state of an entity across multiple tables.</p>
</div>
<div class="paragraph">
<p>The mapping of the columns of a table is
controlled by the <code>Column</code> and <code>JoinColumn</code> annotations. When entity
state is inherited from a mapped superclass, the <code>AttributeOverride</code> and
<code>AssociationOverride</code> annotations may be used to further control the
column-level mapping of inherited state. The ordering of the columns is
not defined by this specification. When it is desirable to control the
ordering of columns, DDL scripts should be provided.</p>
</div>
<div class="paragraph">
<p>See <a href="#a16205">Section 11.1.50</a> for additional rules that apply to the
generation of tables. For the treatment of column-level mappings, see
further below.</p>
</div>
</div>
<div class="sect4">
<h5 id="inheritance"><a class="anchor" href="#inheritance"></a>11.2.1.2. Inheritance</h5>
<div class="paragraph">
<p>The <code>Inheritance</code> annotation defines the
inheritance strategy for an entity hierarchy. The inheritance strategy
determines whether the table for a top-level entity includes columns for
entities that inherit from the entity and whether it includes a
discriminator column, or whether separate tables are created for each
entity type that inherits from the top-level entity. See <a href="#a966">Section 2.14</a> and
<a href="#a14891">Section 11.1.25</a> for rules
pertaining to the treatment of entity inheritance.</p>
</div>
</div>
<div class="sect4">
<h5 id="secondarytable"><a class="anchor" href="#secondarytable"></a>11.2.1.3. SecondaryTable</h5>
<div class="paragraph">
<p>A secondary table is created to partition the
mapping of entity state across multiple tables. See <a href="#a16062">Section 11.1.47</a> for the rules
that apply to the generation of secondary tables.</p>
</div>
</div>
<div class="sect4">
<h5 id="collectiontable"><a class="anchor" href="#collectiontable"></a>11.2.1.4. CollectionTable</h5>
<div class="paragraph">
<p>A collection table is created for the mapping
of an element collection. See <a href="#a14250">Section 11.1.8</a> for the rules that apply to the generation
of collection tables. The <code>Column</code>, <code>AttributeOverride</code>, and
<code>AssociationOverride</code> annotations may be used to override
<code>CollectionTable</code> mappings, as described in <a href="#a14330">Section 11.1.9</a>,
<a href="#a14084">Section 11.1.4</a>, and <a href="#a13942">Section 11.1.2</a> respectively.</p>
</div>
</div>
<div class="sect4">
<h5 id="jointable"><a class="anchor" href="#jointable"></a>11.2.1.5. JoinTable</h5>
<div class="paragraph">
<p>By default, join tables are created for the
mapping of many-to-many relationships and unidirectional one-to-many
relationships. See <a href="#a708">Section 2.12.4</a>, <a href="#a764">Section 2.12.5.1</a>, and
<a href="#a800">Section 2.12.5.2</a> for the defaults that apply in such cases. Join tables may also be used
to map bidirectional many-to-one/one-to-many associations,
unidirectional many-to-one relationships, and one-to-one relationships
(both bidirectional and unidirectional). See <a href="#a15022">Section 11.1.28</a> for the rules that
apply to the generation of join tables. The <code>AssociationOverride</code>
annotation may be used to override join table mappings.</p>
</div>
</div>
<div class="sect4">
<h5 id="tablegenerator"><a class="anchor" href="#tablegenerator"></a>11.2.1.6. TableGenerator</h5>
<div class="paragraph">
<p>Table generator tables are used to store
generated primary key values. See <a href="#a16256">Section 11.1.52</a> for the rules
pertaining to table generators.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="column-level-elements"><a class="anchor" href="#column-level-elements"></a>11.2.2. Column-level elements</h4>
<div class="paragraph">
<p>The following annotations and corresponding
XML elements control the mapping of columns in generated tables.</p>
</div>
<div class="paragraph">
<p>The exact mapping of Java language types to
database-specific types is not defined by this specification, as
databases vary in the specific types that they support. In general,
however, an implementation of this specification should conform to the
Standard Mapping from Java Types to JDBC Types as defined by the JDBC
specification <a href="#a19496">[3]</a>. Unless otherwise explicitly
specified, however, VARCHAR and VARBINARY mappings should be used in
preference to CHAR and BINARY mappings. Applications that are sensitive
to the exact database mappings that are generated should use the
<code>columnDefinition</code> element of the <code>Column</code> annotation or include DDL
files that specify how the database schema is to be generated.</p>
</div>
<div class="sect4">
<h5 id="column"><a class="anchor" href="#column"></a>11.2.2.1. Column</h5>
<div class="paragraph">
<p>The following elements of the <code>Column</code>
annotation are used in schema generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code></p>
</li>
<li>
<p><code>unique</code></p>
</li>
<li>
<p><code>nullable</code></p>
</li>
<li>
<p><code>columnDefinition</code></p>
</li>
<li>
<p><code>table</code></p>
</li>
<li>
<p><code>length</code> (string-valued columns only)</p>
</li>
<li>
<p><code>precision</code> (exact numeric (decimal/numeric) columns only)</p>
</li>
<li>
<p><code>scale</code> (exact numeric (decimal/numeric) columns only)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a14330">Section 11.1.9</a> for the rules that apply to these elements and column
creation. The <code>AttributeOverride</code> annotation may be used to override
column mappings.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapkeycolumn"><a class="anchor" href="#mapkeycolumn"></a>11.2.2.2. MapKeyColumn</h5>
<div class="paragraph">
<p>The <code>MapKeyColumn</code> annotation specifies the
mapping for a key column of a map when the key is of basic type. The
following elements of the <code>MapKeyColumn</code> annotation are used in schema
generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code></p>
</li>
<li>
<p><code>unique</code></p>
</li>
<li>
<p><code>nullable</code></p>
</li>
<li>
<p><code>columnDefinition</code></p>
</li>
<li>
<p><code>table</code></p>
</li>
<li>
<p><code>length</code> (string-valued columns only)</p>
</li>
<li>
<p><code>precision</code> (exact numeric (decimal/numeric) columns only)</p>
</li>
<li>
<p><code>scale</code> (exact numeric (decimal/numeric) columns only)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a15367">Section 11.1.34</a> for the rules that apply to these elements and
map key column creation. The <code>AttributeOverride</code> annotation may be used
to override map key column mappings.</p>
</div>
</div>
<div class="sect4">
<h5 id="enumerated-mapkeyenumerated"><a class="anchor" href="#enumerated-mapkeyenumerated"></a>11.2.2.3. Enumerated, MapKeyEnumerated</h5>
<div class="paragraph">
<p>The <code>Enumerated</code> and <code>MapKeyEnumerated</code>
annotations control whether string- or integer-valued columns are
generated for basic attributes of enumerated types and therefore impact
the default column mappings for these types. See <a href="#a14719">Section 11.1.18</a> and
<a href="#a15433">Section 11.1.35</a>. The
<code>Column</code> and <code>MapKeyColumn</code> annotations may be used to further control
the column mappings for attributes of enumerated types.</p>
</div>
</div>
<div class="sect4">
<h5 id="temporal-mapkeytemporal"><a class="anchor" href="#temporal-mapkeytemporal"></a>11.2.2.4. Temporal, MapKeyTemporal</h5>
<div class="paragraph">
<p>The <code>Temporal</code> and <code>MapKeyTemporal</code>
annotations control whether date-, time-, or timestamp-value columns are
generated for basic attributes of temporal types, and therefore impact
the default column mappings for these types. See <a href="#a16361">Section 11.1.54</a> and
<a href="#a15583">Section 11.1.38</a>. The <code>Column</code>
and <code>MapKeyColumn</code> annotations may be used to further control the column
mappings for attributes of temporal types.</p>
</div>
</div>
<div class="sect4">
<h5 id="lob"><a class="anchor" href="#lob"></a>11.2.2.5. Lob</h5>
<div class="paragraph">
<p>The <code>Lob</code> annotation specifies that a
persistent attribute is to be persisted to a database large object type.
See <a href="#a15087">Section 11.1.29</a>. In general,
however, the treatment of the <code>Lob</code> annotation is provider-dependent.
Applications that are sensitive to the exact mapping that is used should
use the <code>columnDefinition</code> element of the <code>Column</code> annotation or include
DDL files that specify how the database schema is to be generated.</p>
</div>
</div>
<div class="sect4">
<h5 id="ordercolumn"><a class="anchor" href="#ordercolumn"></a>11.2.2.6. OrderColumn</h5>
<div class="paragraph">
<p>The <code>OrderColumn</code> annotation specifies the
generation of a column that is used to maintain the persistent ordering
of a list that is represented in an element collection, one-to-many, or
many-to-many relationship.</p>
</div>
<div class="paragraph">
<p>The following elements of the <code>OrderColumn</code>
annotation are used in schema generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code></p>
</li>
<li>
<p><code>nullable</code></p>
</li>
<li>
<p><code>columnDefinition</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a15873">Section 11.1.44</a> for the rules that pertain to the generation of order columns.</p>
</div>
</div>
<div class="sect4">
<h5 id="discriminatorcolumn"><a class="anchor" href="#discriminatorcolumn"></a>11.2.2.7. DiscriminatorColumn</h5>
<div class="paragraph">
<p>A discriminator column is generated for the
SINGLE_TABLE mapping strategy and may optionally be generated by the
provider for use with the JOINED inheritance strategy. The
<code>DiscriminatorColumn</code> annotation may be used to control the mapping of
the discriminator column. See <a href="#a14530">Section 11.1.12</a> for the rules that pertain to
discriminator columns.</p>
</div>
</div>
<div class="sect4">
<h5 id="version"><a class="anchor" href="#version"></a>11.2.2.8. Version</h5>
<div class="paragraph">
<p>The <code>Version</code> annotation specifies the
generation of a column to serve as an entity&#8217;s optimistic lock. See
<a href="#a16432">Section 11.1.57</a> for rules
that pertain to the version column. The <code>Column</code> annotation may be used
to further control the column mapping for a version attribute.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="primary-key-mappings"><a class="anchor" href="#primary-key-mappings"></a>11.2.3. Primary Key mappings</h4>
<div class="paragraph">
<p>Primary keys may be represented by basic or
embedded attributes and/or may correspond to foreign key attributes. The
<code>Id</code> and <code>EmbeddedId</code> annotations define attributes whose corresponding
columns are the constituents of database primary keys.</p>
</div>
<div class="sect4">
<h5 id="id"><a class="anchor" href="#id"></a>11.2.3.1. Id</h5>
<div class="paragraph">
<p>The <code>Id</code> annotation (which may be used used
in conjunction with the <code>IdClass</code> annotation) is used to specify
attributes whose database columns correspond to a primary key. Use of
the <code>Id</code> annotation results in the creation of a primary key consisting
of the corresponding column or columns. Rules for the <code>Id</code> annotation
are described in <a href="#a14827">Section 11.1.22</a> and <a href="#a132">Section 2.4</a>.</p>
</div>
<div class="paragraph">
<p>The <code>Column</code> annotation may be used to
further control the column mapping for an <code>Id</code> attribute that is applied
to a basic type. If the <code>Id</code> column was defined in a mapped superclass,
the <code>AttributeOverride</code> annotation may be used to control the column
mapping.</p>
</div>
<div class="paragraph">
<p>The <code>JoinColumn</code> annotation may be used to
further control the column mappings for an <code>Id</code> attribute that is
applied to a relationship that corresponds to a foreign key. If the <code>Id</code>
attribute was defined in a mapped superclass, the <code>AssociationOverride</code>
annotation may be used to control the column mapping.</p>
</div>
</div>
<div class="sect4">
<h5 id="embeddedid"><a class="anchor" href="#embeddedid"></a>11.2.3.2. EmbeddedId</h5>
<div class="paragraph">
<p>The <code>EmbeddedId</code> annotation specifies an
embedded attribute whose corresponding columns correspond to a database
primary key. Use of the <code>EmbeddedId</code> annotation results in the creation
of a primary key consisting of the corresponding columns. Rules for the
<code>EmbeddedId</code> annotation are described in <a href="#a14687">Section 11.1.17</a> and <a href="#a132">Section 2.4</a>.</p>
</div>
<div class="paragraph">
<p>The <code>Column</code> annotation may be used to
control the column mapping for an embeddable class. If the <code>EmbeddedId</code>
attribute is defined in a mapped superclass, the <code>AttributeOverride</code>
annotation may be used to control the column mappings.</p>
</div>
<div class="paragraph">
<p>If an <code>EmbeddedId</code> attribute corresponds to a
relationship attribute, the <code>MapsId</code> annotation must be used, and the
column mapping is determined by the join column for the relationship.
See <a href="#a149">Section 2.4.2</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="generatedvalue"><a class="anchor" href="#generatedvalue"></a>11.2.3.3. GeneratedValue</h5>
<div class="paragraph">
<p>The <code>GeneratedValue</code> annotation indicates a
primary key whose value is to be generated by the provider. If a
strategy is indicated, the provider must use it if it is supported by
the target database. Note that specification of the <code>AUTO</code> strategy may
result in the provider creating a database object for Id generation
(e.g., a database sequence). Rules for the <code>GeneratedValue</code> annotation
are described in <a href="#a14790">Section 11.1.21</a>. The <code>GeneratedValue</code> annotation may only be portably used
for simple (i.e., non-composite) primary keys.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="foreign-key-column-mappings"><a class="anchor" href="#foreign-key-column-mappings"></a>11.2.4. Foreign Key Column Mappings</h4>
<div class="sect4">
<h5 id="joincolumn"><a class="anchor" href="#joincolumn"></a>11.2.4.1. JoinColumn</h5>
<div class="paragraph">
<p>The <code>JoinColumn</code> annotation is typically used
in specifying a foreign key mapping. In general, the foreign key
definitions created will be provider-dependent and database-dependent.
Applications that are sensitive to the exact mapping that is used should
use the <code>foreignKey</code> element of the <code>JoinColumn</code> annotation or include
DDL files that specify how the database schemas are to be generated.</p>
</div>
<div class="paragraph">
<p>The following elements of the <code>JoinColumn</code>
annotation are used in schema generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code></p>
</li>
<li>
<p><code>referencedColumnName</code></p>
</li>
<li>
<p><code>unique</code></p>
</li>
<li>
<p><code>nullable</code></p>
</li>
<li>
<p><code>columnDefinition</code></p>
</li>
<li>
<p><code>table</code></p>
</li>
<li>
<p><code>foreignKey</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a14922">Section 11.1.26</a> for rules that apply to these elements and join
column creation, and sections <a href="#a538">Section 2.12</a> and <a href="#a14250">Section 11.1.8</a> for the rules that apply for the default
mappings of foreign keys for relationships and element collections. The
<code>AssociationOverride</code> annotation may be used to override relationship
mappings. The <code>PrimaryKeyJoinColumn</code> annotation is used to join
secondary tables and may be used in the mapping of one-to-one
relationships. See <a href="#a16567">Section 11.2.4.3</a> below.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapkeyjoincolumn"><a class="anchor" href="#mapkeyjoincolumn"></a>11.2.4.2. MapKeyJoinColumn</h5>
<div class="paragraph">
<p>The <code>MapKeyJoinColumn</code> annotation is to
specify foreign key mappings to entities that are map keys in map-valued
element collections or relationships. In general, the foreign key
definitions created should be expected to be provider-dependent and
database-dependent. Applications that are sensitive to the exact mapping
that is used should use the <code>foreignKey</code> element of the
<code>MapKeyJoinColumn</code> annotation or include DDL files that specify how the
database schemas are to be generated.</p>
</div>
<div class="paragraph">
<p>The following elements of the
<code>MapKeyJoinColumn</code> annotation are used in schema generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code></p>
</li>
<li>
<p><code>referencedColumnName</code></p>
</li>
<li>
<p><code>unique</code></p>
</li>
<li>
<p><code>nullable</code></p>
</li>
<li>
<p><code>columnDefinition</code></p>
</li>
<li>
<p><code>table</code></p>
</li>
<li>
<p><code>foreignKey</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a15450">Section 11.1.36</a> for rules that apply to these elements and
map key join column creation. The <code>AssociationOverride</code> annotation may
be used to override such mappings.</p>
</div>
</div>
<div class="sect4">
<h5 id="a16567"><a class="anchor" href="#a16567"></a>11.2.4.3. PrimaryKeyJoinColumn</h5>
<div class="paragraph">
<p>The <code>PrimaryKeyJoinColumn</code> annotation
specifies that a primary key column is to be used as a foreign key. This
annotation is used in the specification of the JOINED mapping strategy
and for joining a secondary table to a primary table in a OneToOne
relationship mapping. In general, the foreign key definitions created
should be expected to be provider-dependent and database-dependent.
Applications that are sensitive to the exact mapping that is used should
use the <code>foreignKey</code> element of the <code>PrimaryKeyJoinColumn</code> annotation or
include DDL files that specify how the database schemas are to be
generated. See <a href="#a15947">Section 11.1.45</a> for rules pertaining to the
<code>PrimaryKeyJoinColumn</code> annotation.</p>
</div>
</div>
<div class="sect4">
<h5 id="foreignkey"><a class="anchor" href="#foreignkey"></a>11.2.4.4. ForeignKey</h5>
<div class="paragraph">
<p>The <code>ForeignKey</code> annotation may be used
within the <code>JoinColumn</code>, <code>JoinColumns</code>, <code>MapKeyJoinColumn</code>,
<code>MapKeyJoinColumns</code>, <code>PrimaryKeyJoinColumn</code>, <code>PrimaryKeyJoinColumns</code>,
<code>CollectionTable</code>, <code>JoinTable</code>, <code>SecondaryTable</code>, and
<code>AssociationOverride</code> annotations to specify or override a foreign key
constraint. See <a href="#a14754">Section 11.1.20</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="other-elements"><a class="anchor" href="#other-elements"></a>11.2.5. Other Elements</h4>
<div class="sect4">
<h5 id="sequencegenerator"><a class="anchor" href="#sequencegenerator"></a>11.2.5.1. SequenceGenerator</h5>
<div class="paragraph">
<p>The <code>SequenceGenerator</code> annotation creates a
database sequence to be used for Id generation. The use of generators is
limited to those databases that support them. See <a href="#a16164">Section 11.1.49</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="index"><a class="anchor" href="#index"></a>11.2.5.2. Index</h5>
<div class="paragraph">
<p>The <code>Index</code> annotation generates an index
consisting of the specified columns. The ordering of the names in the
<code>columnList</code> element specified in the <code>Index</code> annotation must be
observed by the provider when creating the index. See <a href="#a14862">Section 11.1.24</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="uniqueconstraint"><a class="anchor" href="#uniqueconstraint"></a>11.2.5.3. UniqueConstraint</h5>
<div class="paragraph">
<p>The <code>UniqueConstraint</code> annotation generates a
unique constraint for the given table. Databases typically implement
unique constraints by creating unique indexes. The ordering of the
<code>columnNames</code> specified in the <code>UniqueConstraint</code> annotation must be
observed by the provider when creating the constraint. See <a href="#a16403">Section 11.1.56</a>. The
<code>unique</code> element of the <code>Column</code>, <code>JoinColumn</code>, <code>MapKeyColumn</code>, and
<code>MapKeyJoinColumn</code> annotations is equivalent to the use of the
<code>UniqueConstraint</code> annotation when only one column is to be included in
the constraint.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-of-the-application-of-annotations-for-objectrelational-mapping"><a class="anchor" href="#examples-of-the-application-of-annotations-for-objectrelational-mapping"></a>11.3. Examples of the Application of Annotations for Object/Relational Mapping</h3>
<div class="paragraph">
<p>This example shows some simple mappings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = AUTO)
    <span class="predefined-type">Long</span> id;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="type">int</span> version;

    <span class="annotation">@ManyToOne</span>
    Address address;

    <span class="annotation">@Basic</span>
    <span class="predefined-type">String</span> description;

    <span class="annotation">@OneToMany</span>(targetEntity = com.acme.Order.class,
               mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span> orders = <span class="keyword">new</span> <span class="predefined-type">Vector</span>();

    <span class="annotation">@ManyToMany</span>(mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">customers</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Set</span>&lt;DeliveryService&gt; serviceOptions = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> Address getAddress() {
        <span class="keyword">return</span> address;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address addr) {
        <span class="local-variable">this</span>.address = addr;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getDescription() {
        <span class="keyword">return</span> description;
    }

    <span class="directive">public</span> <span class="type">void</span> setDescription(<span class="predefined-type">String</span> desc) {
        <span class="local-variable">this</span>.description = desc;
    }

    <span class="directive">public</span> <span class="predefined-type">Collection</span> getOrders() {
        <span class="keyword">return</span> orders;
    }

    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;DeliveryService&gt; getServiceOptions() {
        <span class="keyword">return</span> serviceOptions;
    }
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> street;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = AUTO)
    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">protected</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Version</span>
    <span class="directive">public</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getStreet() {
        <span class="keyword">return</span> street;
    }

    <span class="directive">public</span> <span class="type">void</span> setStreet(<span class="predefined-type">String</span> street) {
        <span class="local-variable">this</span>.street = street;
    }
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> itemName;
    <span class="directive">private</span> <span class="type">int</span> quantity;
    <span class="directive">private</span> Customer cust;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = AUTO)
    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getItemName() {
        <span class="keyword">return</span> itemName;
    }

    <span class="directive">public</span> <span class="type">void</span> setItemName(<span class="predefined-type">String</span> itemName) {
        <span class="local-variable">this</span>.itemName = itemName;
    }

    <span class="directive">public</span> <span class="type">int</span> getQuantity() {
        <span class="keyword">return</span> quantity;
    }

    <span class="directive">public</span> <span class="type">void</span> setQuantity(<span class="type">int</span> quantity) {
        <span class="local-variable">this</span>.quantity = quantity;
    }

    <span class="annotation">@ManyToOne</span>
    <span class="directive">public</span> Customer getCustomer() {
        <span class="keyword">return</span> cust;
    }

    <span class="directive">public</span> <span class="type">void</span> setCustomer(Customer cust) {
        <span class="local-variable">this</span>.cust = cust;
    }
}

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">DLVY_SVC</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">DeliveryService</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> serviceName;
    <span class="directive">private</span> <span class="type">int</span> priceCategory;
    <span class="directive">private</span> <span class="predefined-type">Collection</span> customers;

    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getServiceName() {
        <span class="keyword">return</span> serviceName;
    }

    <span class="directive">public</span> <span class="type">void</span> setServiceName(<span class="predefined-type">String</span> serviceName) {
        <span class="local-variable">this</span>.serviceName = serviceName;
    }

    <span class="directive">public</span> <span class="type">int</span> getPriceCategory() {
        <span class="keyword">return</span> priceCategory;
    }

    <span class="directive">public</span> <span class="type">void</span> setPriceCategory(<span class="type">int</span> priceCategory) {
        <span class="local-variable">this</span>.priceCategory = priceCategory;
    }

    <span class="annotation">@ManyToMany</span>(targetEntity = com.acme.Customer.class)
    <span class="annotation">@JoinTable</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_DLVRY</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Collection</span> getCustomers() {
        <span class="keyword">return</span> customers;
    }

    <span class="directive">public</span> setCustomers(<span class="predefined-type">Collection</span> customers) {
        <span class="local-variable">this</span>.customers = customers;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, we have a more complex example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/***** Employee class *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMPL</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTable</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_SALARY</span><span class="delimiter">&quot;</span></span>,
                pkJoinColumns = <span class="annotation">@PrimaryKeyJoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="directive">private</span> Address address;
    <span class="directive">private</span> <span class="predefined-type">Collection</span> phoneNumbers;
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Project&gt; projects;
    <span class="directive">private</span> <span class="predefined-type">Long</span> salary;
    <span class="directive">private</span> EmploymentPeriod period;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = TABLE)
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">protected</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Version</span>
    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_VERSION</span><span class="delimiter">&quot;</span></span>, nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_NAME</span><span class="delimiter">&quot;</span></span>, length = <span class="integer">80</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="annotation">@ManyToOne</span>(cascade = PERSIST, optional = <span class="predefined-constant">false</span>)
    <span class="annotation">@JoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>, nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> Address getAddress() {
        <span class="keyword">return</span> address;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) {
        <span class="local-variable">this</span>.address = address;
    }

    <span class="annotation">@OneToMany</span>(targetEntity = com.acme.PhoneNumber.class,
               cascade = ALL,
               mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">employee</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Collection</span> getPhoneNumbers() {
        <span class="keyword">return</span> phoneNumbers;
    }

    <span class="directive">public</span> <span class="type">void</span> setPhoneNumbers(<span class="predefined-type">Collection</span> phoneNumbers) {
        <span class="local-variable">this</span>.phoneNumbers = phoneNumbers;
    }

    <span class="annotation">@ManyToMany</span>(cascade = PERSIST, mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">employees</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@JoinTable</span>(
        name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_PROJ</span><span class="delimiter">&quot;</span></span>,
        joinColumns = <span class="annotation">@JoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
        inverseJoinColumns = <span class="annotation">@JoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">PROJ_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>))
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Project&gt; getProjects() {
        <span class="keyword">return</span> projects;
    }

    <span class="directive">public</span> <span class="type">void</span> setProjects(<span class="predefined-type">Collection</span>&lt;Project&gt; projects) {
        <span class="local-variable">this</span>.projects = projects;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_SAL</span><span class="delimiter">&quot;</span></span>, table = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_SALARY</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Long</span> getSalary() {
        <span class="keyword">return</span> salary;
    }

    <span class="directive">public</span> <span class="type">void</span> setSalary(<span class="predefined-type">Long</span> salary) {
        <span class="local-variable">this</span>.salary = salary;
    }

    <span class="annotation">@Embedded</span>
    <span class="annotation">@AttributeOverrides</span>({
        <span class="annotation">@AttributeOverride</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>,
                           column = <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_START</span><span class="delimiter">&quot;</span></span>)),
        <span class="annotation">@AttributeOverride</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>,
                           column = <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_END</span><span class="delimiter">&quot;</span></span>))
    })
    <span class="directive">public</span> EmploymentPeriod getEmploymentPeriod() {
        <span class="keyword">return</span> period;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmploymentPeriod(EmploymentPeriod period) {
        <span class="local-variable">this</span>.period = period;
    }
}

<span class="comment">/***** Address class *****/</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Integer</span> id;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> street;
    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = IDENTITY)
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">protected</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Version</span>
    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">VERS</span><span class="delimiter">&quot;</span></span>, nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">RUE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getStreet() {
        <span class="keyword">return</span> street;
    }

    <span class="directive">public</span> <span class="type">void</span> setStreet(<span class="predefined-type">String</span> street) {
        <span class="local-variable">this</span>.street = street;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">VILLE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getCity() {
        <span class="keyword">return</span> city;
    }

    <span class="directive">public</span> <span class="type">void</span> setCity(<span class="predefined-type">String</span> city) {
        <span class="local-variable">this</span>.city = city;
    }
}

<span class="comment">/***** PhoneNumber class *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">PHONE</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneNumber</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> number;
    <span class="directive">private</span> <span class="type">int</span> phoneType;
    <span class="directive">private</span> Employee employee;

    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getNumber() {
        <span class="keyword">return</span> number;
    }

    <span class="directive">public</span> <span class="type">void</span> setNumber(<span class="predefined-type">String</span> number) {
        <span class="local-variable">this</span>.number = number;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">PTYPE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">int</span> getPhonetype() {
        <span class="keyword">return</span> phonetype;
    }

    <span class="directive">public</span> <span class="type">void</span> setPhoneType(<span class="type">int</span> phoneType) {
        <span class="local-variable">this</span>.phoneType = phoneType;
    }

    <span class="annotation">@ManyToOne</span>(optional = <span class="predefined-constant">false</span>)
    <span class="annotation">@JoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>, nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> Employee getEmployee() {
        <span class="keyword">return</span> employee;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmployee(Employee employee) {
        <span class="local-variable">this</span>.employee = employee;
    }
}

<span class="comment">/***** Project class *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Inheritance</span>(strategy = JOINED)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Proj</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">DISC</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Project</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Integer</span> projId;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;Employee&gt; employees;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = TABLE)
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() {
        <span class="keyword">return</span> projId;
    }

    <span class="directive">protected</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) {
        <span class="local-variable">this</span>.projId = id;
    }

    <span class="annotation">@Version</span>
    <span class="directive">public</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">PROJ_NAME</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="annotation">@ManyToMany</span>(mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">projects</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Set</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }
}

<span class="comment">/***** GovernmentProject subclass *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">GOVT_PROJECT</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">GovtProj</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">GOV_PROJ_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">GovernmentProject</span> <span class="directive">extends</span> Project {
    <span class="directive">private</span> <span class="predefined-type">String</span> fileInfo;

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getFileInfo() {
        <span class="keyword">return</span> fileInfo;
    }

    <span class="directive">public</span> <span class="type">void</span> setFileInfo(<span class="predefined-type">String</span> fileInfo) {
        <span class="local-variable">this</span>.fileInfo = fileInfo;
    }
}

<span class="comment">/***** CovertProject subclass *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">C_PROJECT</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">CovProj</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">COV_PROJ_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">CovertProject</span> <span class="directive">extends</span> Project {
    <span class="directive">private</span> <span class="predefined-type">String</span> classified;

    <span class="directive">public</span> CovertProject() {
        <span class="local-variable">super</span>();
    }

    <span class="directive">public</span> CovertProject(<span class="predefined-type">String</span> classified) {
        <span class="local-variable">this</span>();
        <span class="local-variable">this</span>.classified = classified;
    }

    <span class="annotation">@Column</span>(updatable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getClassified() {
        <span class="keyword">return</span> classified;
    }

    <span class="directive">protected</span> <span class="type">void</span> setClassified(<span class="predefined-type">String</span> classified) {
        <span class="local-variable">this</span>.classified = classified;
    }
}

<span class="comment">/***** EmploymentPeriod class *****/</span>
<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmploymentPeriod</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Date</span> start;
    <span class="directive">private</span> <span class="predefined-type">Date</span> end;

    <span class="annotation">@Column</span>(nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="predefined-type">Date</span> getStartDate() {
        <span class="keyword">return</span> start;
    }

    <span class="directive">public</span> <span class="type">void</span> setStartDate(<span class="predefined-type">Date</span> start) {
        <span class="local-variable">this</span>.start = start;
    }

    <span class="directive">public</span> <span class="predefined-type">Date</span> getEndDate() {
        <span class="keyword">return</span> end;
    }

    <span class="directive">public</span> <span class="type">void</span> setEndDate(<span class="predefined-type">Date</span> end) {
        <span class="local-variable">this</span>.end = end;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a16944"><a class="anchor" href="#a16944"></a>12. XML Object/Relational Mapping Descriptor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The XML object/relational mapping descriptor
serves as both an alternative to and an overriding mechanism for Java
language metadata annotations.</p>
</div>
<div class="sect2">
<h3 id="use-of-the-xml-descriptor"><a class="anchor" href="#use-of-the-xml-descriptor"></a>12.1. Use of the XML Descriptor</h3>
<div class="paragraph">
<p>The XML schema for the object
relational/mapping descriptor is contained in <a href="#a17175">Section 12.3</a>. The root element of this
schema is the <code>entity-mappings</code> element. The absence or present of the
<code>xml-mapping-metadata-complete</code> subelement contained in the
<code>persistence-unit-defaults</code> subelement of the <code>entity-mappings</code> element
controls whether the XML object/relational mapping descriptor is used to
selectively override annotation values or whether it serves as a
complete alternative to Java language metadata annotations.</p>
</div>
<div class="paragraph">
<p>If the <code>xml-mapping-metadata-complete</code>
subelement is specified, the complete set of mapping metadata for the
persistence unit is contained in the XML mapping files for the
persistence unit, and any persistence annotations on the classes are
ignored.</p>
</div>
<div class="paragraph">
<p>If <code>xml-mapping-metadata-complete</code> is
specified and XML elements are omitted, the default values apply. These
default values are the same as the corresponding defaults when
annotations are used, except in the cases specified in <a href="#a16953">Section 12.2</a> below. When the
<code>xml-mapping-metadata-complete</code> element is specified, any
<code>metadata-complete</code> attributes specified within the <code>entity</code>,
<code>mapped-superclass</code>, and <code>embeddable</code> elements are ignored.</p>
</div>
<div class="paragraph">
<p>If the <code>xml-mapping-metadata-complete</code>
subelement is not specified, the XML descriptor overrides the values set
or defaulted by the use of annotations, as described below.</p>
</div>
<div class="paragraph">
<p>The mapping files used by the application
developer must conform to the XML schema defined in <a href="#a17175">Section 12.3</a>
or to the previous versions of the XML schema, <code>orm_3_1.xsd</code>,
<code>orm_3_0.xsd</code> or <code>orm_2_2.xsd</code>,
defined in a previous version of this specification <a href="#a19493">[1]</a>
in accordance with the version specified by the <code>orm.xml</code> file.</p>
</div>
<div class="paragraph">
<p>The Jakarta Persistence persistence provider
may support use of older versions of the object/relational mapping
schema as well as the object/relational mapping schema defined in
<a href="#a17175">Section 12.3</a>, whether singly or
in combination when multiple mapping files are used.</p>
</div>
</div>
<div class="sect2">
<h3 id="a16953"><a class="anchor" href="#a16953"></a>12.2. XML Overriding Rules</h3>
<div class="paragraph">
<p>This section defines the rules that apply
when the XML descriptor is used to override annotations, and the rules
pertaining to the interaction of XML elements specified as subelements
of the <code>persistence-unit-defaults</code>, <code>entity-mappings</code>, <code>entity</code>,
<code>mapped-superclass</code>, and <code>embeddable</code> elements.</p>
</div>
<div class="sect3">
<h4 id="persistence-unit-defaults-subelements"><a class="anchor" href="#persistence-unit-defaults-subelements"></a>12.2.1. persistence-unit-defaults Subelements</h4>
<div class="sect4">
<h5 id="schema"><a class="anchor" href="#schema"></a>12.2.1.1. schema</h5>
<div class="paragraph">
<p>The <code>schema</code> subelement applies to all
entities, tables, secondary tables, join tables, collection tables,
table generators, and sequence generators in the persistence unit.</p>
</div>
<div class="paragraph">
<p>The <code>schema</code> subelement is overridden by any
<code>schema</code> subelement of the <code>entity-mappings</code> element; any <code>schema</code>
element explicitly specified in the <code>Table</code> or <code>SecondaryTable</code>
annotation on an entity or any <code>schema</code> attribute on any <code>table</code> or
<code>secondary-table</code> subelement defined within an <code>entity</code> element; any
<code>schema</code> element explicitly specified in a <code>TableGenerator</code> annotation
or <code>table-generator</code> subelement; any <code>schema</code> element explicitly
specified in a <code>SequenceGenerator</code> annotation or <code>sequence-generator</code>
subelement; any <code>schema</code> element explicitly specified in a <code>JoinTable</code>
annotation or <code>join-table</code> subelement; and any <code>schema</code> element
explicitly specified in a <code>CollectionTable</code> annotation or
<code>collection-table</code> subelement.</p>
</div>
</div>
<div class="sect4">
<h5 id="catalog"><a class="anchor" href="#catalog"></a>12.2.1.2. catalog</h5>
<div class="paragraph">
<p>The <code>catalog</code> subelement applies to all
entities, tables, secondary tables, join tables, collection tables,
table generators, and sequence generators in the persistence unit.</p>
</div>
<div class="paragraph">
<p>The <code>catalog</code> subelement is overridden by any
<code>catalog</code> subelement of the <code>entity-mappings</code> element; any <code>catalog</code>
element explicitly specified in the <code>Table</code> or <code>SecondaryTable</code>
annotation on an entity or any <code>catalog</code> attribute on any <code>table</code> or
<code>secondary-table</code> subelement defined within an <code>entity</code> XML element; any
<code>catalog</code> element explicitly specified in a <code>TableGenerator</code> annotation
or <code>table-generator</code> subelement; any <code>catalog</code> element explicitly
specified in a <code>SequenceGenerator</code> annotation or <code>sequence-generator</code>
subelement; any <code>catalog</code> element explicitly specified in a <code>JoinTable</code>
annotation or <code>join-table</code> subelement; and any <code>catalog</code> element
explicitly specified in a <code>CollectionTable</code> annotation or
<code>collection-table</code> subelement.</p>
</div>
</div>
<div class="sect4">
<h5 id="delimited-identifiers"><a class="anchor" href="#delimited-identifiers"></a>12.2.1.3. delimited-identifiers</h5>
<div class="paragraph">
<p>The <code>delimited-identifiers</code> subelement
applies to the naming of database objects, as described in <a href="#a988">Section 2.15</a>. It
specifies that all database table-, schema-, and column-level
identifiers in use for the persistence unit be treated as delimited
identifiers.</p>
</div>
<div class="paragraph">
<p>The <code>delimited-identifiers</code> subelement cannot
be overridden in this release.</p>
</div>
</div>
<div class="sect4">
<h5 id="access"><a class="anchor" href="#access"></a>12.2.1.4. access</h5>
<div class="paragraph">
<p>The <code>access</code> subelement applies to all
managed classes in the persistence unit.</p>
</div>
<div class="paragraph">
<p>The <code>access</code> subelement is overridden by the
use of any annotations specifying mapping information on the fields or
properties of the entity class; by any <code>Access</code> annotation on the entity
class, mapped superclass, or embeddable class; by any <code>access</code>
subelement of the <code>entity-mappings</code> element; by any <code>Access</code> annotation
on a field or property of an entity class, mapped superclass, or
embeddable class; by any <code>access</code> attribute defined within an <code>entity</code>,
<code>mapped-superclass</code>, or <code>embeddable</code> XML element, or by any <code>access</code>
attribute defined within an <code>id</code>, <code>embedded-id</code>, <code>version</code>, <code>basic</code>,
<code>embedded</code>, <code>many-to-one</code>, <code>one-to-one</code>, <code>one-to-many</code>,
<code>many-to-many</code>, or <code>element-collection</code> element.</p>
</div>
</div>
<div class="sect4">
<h5 id="cascade-persist"><a class="anchor" href="#cascade-persist"></a>12.2.1.5. cascade-persist</h5>
<div class="paragraph">
<p>The <code>cascade-persist</code> subelement applies to
all relationships in the persistence unit.</p>
</div>
<div class="paragraph">
<p>Specifying this subelement adds the cascade
persist option to all relationships in addition to any settings
specified in annotations or XML.</p>
</div>
<div class="paragraph">
<p>The <code>cascade-persist</code> subelement cannot be
overridden in this release.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The ability to override the <code>cascade-persist</code>
of the <code>persistence-unit-defaults</code> element will be added in a future
release of this specification.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="entity-listeners-2"><a class="anchor" href="#entity-listeners-2"></a>12.2.1.6. entity-listeners</h5>
<div class="paragraph">
<p>The <code>entity-listeners</code> subelement defines
default entity listeners for the persistence unit. These entity
listeners are called before any other entity listeners for an entity
unless the entity listener order is overridden within a
<code>mapped-superclass</code> or <code>entity</code> element, or the
<code>ExcludeDefaultListeners</code> annotation is present on the entity or mapped
superclass or the <code>exclude-default-listeners</code> subelement is specified
within the corresponding <code>entity</code> or <code>mapped-superclass</code> XML element.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="other-subelements-of-the-entity-mappings-element"><a class="anchor" href="#other-subelements-of-the-entity-mappings-element"></a>12.2.2. Other Subelements of the entity-mappings element</h4>
<div class="sect4">
<h5 id="package"><a class="anchor" href="#package"></a>12.2.2.1. package</h5>
<div class="paragraph">
<p>The <code>package</code> subelement specifies the
package of the classes listed within the subelements and attributes of
the same mapping file only. The <code>package</code> subelement is overridden if
the fully qualified class name is specified for a class and the two
disagree.</p>
</div>
</div>
<div class="sect4">
<h5 id="schema-2"><a class="anchor" href="#schema-2"></a>12.2.2.2. schema</h5>
<div class="paragraph">
<p>The <code>schema</code> subelement applies only to the
entities, tables, secondary tables, join tables, collection tables,
table generators, and sequence generators listed within the same mapping
file.</p>
</div>
<div class="paragraph">
<p>The <code>schema</code> subelement is overridden by any
<code>schema</code> element explicitly specified in the <code>Table</code>, <code>SecondaryTable</code>
, <code>JoinTable</code>, or <code>CollectionTable</code> annotation on an entity listed
within the mapping file or any <code>schema</code> attribute on any <code>table</code> or
<code>secondary-table</code> subelement defined within the <code>entity</code> element for
such an entity, or by any <code>schema</code> attribute on any <code>join-table</code> or
<code>collection-table</code> subelement of an attribute defined within the
<code>attributes</code> subelement of the <code>entity</code> element for such an entity, or
by the <code>schema</code> attribute of any <code>table-generator</code> or
<code>sequence-generator</code> element within the mapping file.</p>
</div>
</div>
<div class="sect4">
<h5 id="catalog-2"><a class="anchor" href="#catalog-2"></a>12.2.2.3. catalog</h5>
<div class="paragraph">
<p>The <code>catalog</code> subelement applies only to the
entities, tables, secondary tables, join tables, collection tables,
table generators, and sequence generators listed within the same mapping
file.</p>
</div>
<div class="paragraph">
<p>The <code>catalog</code> subelement is overridden by any
<code>catalog</code> element explicitly specified in the <code>Table</code>, <code>SecondaryTable</code>
, <code>JoinTable</code>, or <code>CollectionTable</code> annotation on an entity listed
within the mapping file or any <code>catalog</code> attribute on any <code>table</code> or
<code>secondary-table</code> subelement defined within the <code>entity</code> element for
such an entity, or by any <code>catalog</code> attribute on any <code>join-table</code> or
<code>collection-table</code> subelement of an attribute defined within the
<code>attributes</code> subelement of the <code>entity</code> element for such an entity, or
by the <code>catalog</code> attribute of any <code>table-generator</code> or
<code>sequence-generator</code> element within the mapping file.</p>
</div>
</div>
<div class="sect4">
<h5 id="access-2"><a class="anchor" href="#access-2"></a>12.2.2.4. access</h5>
<div class="paragraph">
<p>The <code>access</code> subelement applies to the
managed classes listed within the same mapping file.</p>
</div>
<div class="paragraph">
<p>The <code>access</code> subelement is overridden by the
use of any annotations specifying mapping information on the fields or
properties of the entity class; by any <code>Access</code> annotation on the entity
class, mapped superclass, or embeddable class; by any <code>Access</code>
annotation on a field or property of an entity class, mapped superclass,
or embeddable class; by any <code>access</code> attribute defined within an
<code>entity</code>, <code>mapped-superclass</code>, or <code>embeddable</code> XML element, or by any
<code>access</code> attribute defined within an <code>id</code>, <code>embedded-id</code>, <code>version</code>,
<code>basic</code>, <code>embedded</code>, <code>many-to-one</code>, <code>one-to-one</code>, <code>one-to-many</code>,
<code>many-to-many</code>, or <code>element-collection</code> element.</p>
</div>
</div>
<div class="sect4">
<h5 id="sequence-generator"><a class="anchor" href="#sequence-generator"></a>12.2.2.5. sequence-generator</h5>
<div class="paragraph">
<p>The generator defined by the
<code>sequence-generator</code> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
generators of the same name.</p>
</div>
<div class="paragraph">
<p>The generator defined is added to any
generators defined in annotations. If a generator of the same name is
defined in annotations, the generator defined by this subelement
overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="table-generator"><a class="anchor" href="#table-generator"></a>12.2.2.6. table-generator</h5>
<div class="paragraph">
<p>The generator defined by the
<code>table-generator</code> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
generators of the same name.</p>
</div>
<div class="paragraph">
<p>The generator defined is added to any
generators defined in annotations. If a generator of the same name is
defined in annotations, the generator defined by this subelement
overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-query"><a class="anchor" href="#named-query"></a>12.2.2.7. named-query</h5>
<div class="paragraph">
<p>The named query defined by the <code>named-query</code>
subelement applies to the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain named queries of the same
name.</p>
</div>
<div class="paragraph">
<p>The named query defined is added to the named
queries defined in annotations. If a named query of the same name is
defined in annotations, the named query defined by this subelement
overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-native-query"><a class="anchor" href="#named-native-query"></a>12.2.2.8. named-native-query</h5>
<div class="paragraph">
<p>The named native query defined by the
<code>named-native-query</code> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
named queries of the same name.</p>
</div>
<div class="paragraph">
<p>The named native query defined is added to
the named native queries defined in annotations. If a named query of the
same name is defined in annotations, the named query defined by this
subelement overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-stored-procedure-query"><a class="anchor" href="#named-stored-procedure-query"></a>12.2.2.9. named-stored-procedure-query</h5>
<div class="paragraph">
<p>The named stored procedure query defined by
the <code>named-stored-procedure-query</code> subelement applies to the persistence
unit. It is undefined if multiple mapping files for the persistence unit
contain named stored procedure queries of the same name.</p>
</div>
<div class="paragraph">
<p>The named stored procedure query defined is
added to the named stored procedure queries defined in annotations. If a
named stored procedure query of the same name is defined in annotations,
the named stored procedure query defined by this subelement overrides
that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="sql-result-set-mapping"><a class="anchor" href="#sql-result-set-mapping"></a>12.2.2.10. sql-result-set-mapping</h5>
<div class="paragraph">
<p>The SQL result set mapping defined by the
<code>sql-result-set-mapping</code> subelement applies to the persistence unit. It
is undefined if multiple mapping files for the persistence unit contain
SQL result set mappings of the same name.</p>
</div>
<div class="paragraph">
<p>The SQL result set mapping defined is added
to the SQL result set mappings defined in annotations. If a SQL result
set mapping of the same name is defined in annotations, the SQL result
set mapping defined by this subelement overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="entity-2"><a class="anchor" href="#entity-2"></a>12.2.2.11. entity</h5>
<div class="paragraph">
<p>The <code>entity</code> subelement defines an entity of
the persistence unit. It is undefined if multiple mapping files for the
persistence unit contain entries for the same entity.</p>
</div>
<div class="paragraph">
<p>The entity class may or may not have been
annotated as <code>Entity</code>. The subelements and attributes of the <code>entity</code>
element override as specified in <a href="#a17017">Section 12.2.3</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapped-superclass"><a class="anchor" href="#mapped-superclass"></a>12.2.2.12. mapped-superclass</h5>
<div class="paragraph">
<p>The <code>mapped-superclass</code> subelement defines a
mapped superclass of the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain entries for the same
mapped superclass.</p>
</div>
<div class="paragraph">
<p>The mapped superclass may or may not have
been annotated as <code>MappedSuperclass</code>. The subelements and attributes of
the <code>mapped-superclass</code> element override as specified in <a href="#a17106">Section 12.2.4</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="embeddable"><a class="anchor" href="#embeddable"></a>12.2.2.13. embeddable</h5>
<div class="paragraph">
<p>The <code>embeddable</code> subelement defines an
embeddable class of the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain entries for the same
embeddable class.</p>
</div>
<div class="paragraph">
<p>The <code>embeddable</code> class may or may not have
been annotated as <code>Embeddable</code>. The subelements and attributes of the
<code>embeddable</code> element override as specified in <a href="#a17150">Section 12.2.5</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="converter"><a class="anchor" href="#converter"></a>12.2.2.14. converter</h5>
<div class="paragraph">
<p>The converter defined by the <code>converter</code>
subelement applies to the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain converters for the same
target type.</p>
</div>
<div class="paragraph">
<p>The converter defined is added to the
converters defined in annotations. If a converter for the same target
type is defined in annotations, the converter defined by this subelement
overrides that definition.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a17017"><a class="anchor" href="#a17017"></a>12.2.3. entity Subelements and Attributes</h4>
<div class="paragraph">
<p>These apply only to the entity for which they
are subelements or attributes, unless otherwise specified below.</p>
</div>
<div class="sect4">
<h5 id="metadata-complete"><a class="anchor" href="#metadata-complete"></a>12.2.3.1. metadata-complete</h5>
<div class="paragraph">
<p>If the <code>metadata-complete</code> attribute of the
<code>entity</code> element is specified as <code>true</code>, any annotations on the entity
class (and its fields and properties) are ignored. When
<code>metadata-complete</code> is specified as <code>true</code> and XML attributes or
sub-elements of the <code>entity</code> element are omitted, the default values for
those attributes and elements are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="access-3"><a class="anchor" href="#access-3"></a>12.2.3.2. access</h5>
<div class="paragraph">
<p>The <code>access</code> attribute defines the access
type for the entity. The <code>access</code> attribute overrides any access type
specified by the <code>persistence-unit-defaults</code> element or
<code>entity-mappings</code> element for the given entity. The access type for a
field or property of the entity may be overridden by specifying by
overriding the mapping for that field or property using the appropriate
XML subelement, as described in <a href="#a17082">Section 12.2.3.26</a> below.</p>
</div>
<div class="paragraph">
<p>Caution must be exercised in overriding an
access type that was specified or defaulted using annotations, as doing
so may cause applications to break.</p>
</div>
</div>
<div class="sect4">
<h5 id="cacheable"><a class="anchor" href="#cacheable"></a>12.2.3.3. cacheable</h5>
<div class="paragraph">
<p>The <code>cacheable</code> attribute defines whether the
entity should be cached or must not be cached when the
<code>shared-cache-mode</code> element of the <code>persistence.xml</code> file is specified
as <code>ENABLE_SELECTIVE</code> or <code>DISABLE_SELECTIVE</code>. If the <code>Cacheable</code>
annotation was specified for the entity, its value is overridden by this
attribute. The value of the <code>cacheable</code> attribute is inherited by
subclasses (unless otherwise overridden for a subclass by the
<code>Cacheable</code> annotation or <code>cacheable</code> XML attribute).</p>
</div>
</div>
<div class="sect4">
<h5 id="name-2"><a class="anchor" href="#name-2"></a>12.2.3.4. name</h5>
<div class="paragraph">
<p>The name attribute defines the entity name.
The <code>name</code> attribute overrides the value of the entity name defined by
the <code>name</code> element of the <code>Entity</code> annotation (whether explicitly
specified or defaulted). Caution must be exercised in overriding the
entity name, as doing so may cause applications to break.</p>
</div>
</div>
<div class="sect4">
<h5 id="table-2"><a class="anchor" href="#table-2"></a>12.2.3.5. table</h5>
<div class="paragraph">
<p>The <code>table</code> subelement overrides any <code>Table</code>
annotation (including defaulted <code>Table</code> values) on the entity. If a
<code>table</code> subelement is present, and attributes or subelements of that
<code>table</code> subelement are not explicitly specified, their default values
are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="secondary-table"><a class="anchor" href="#secondary-table"></a>12.2.3.6. secondary-table</h5>
<div class="paragraph">
<p>The <code>secondary-table</code> subelement overrides
all <code>SecondaryTable</code> and <code>SecondaryTables</code> annotations (including
defaulted <code>SecondaryTable</code> values) on the entity. If a <code>secondary-table</code>
subelement is present, and attributes or subelements of that <code>secondary</code>
- <code>table</code> subelement are not explicitly specified, their default values
are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="primary-key-join-column"><a class="anchor" href="#primary-key-join-column"></a>12.2.3.7. primary-key-join-column</h5>
<div class="paragraph">
<p>The <code>primary-key-join-column</code> subelement of
the entity element specifies a primary key column that is used to join
the table of an entity subclass to the primary table for the entity when
the joined strategy is used. The <code>primary-key-join-column</code> subelement
overrides all <code>PrimaryKeyJoinColumn</code> and <code>PrimaryKeyJoinColumns</code>
annotations (including defaulted <code>PrimaryKeyJoinColumn</code> values) on the
entity. If a <code>primary-key-join-column</code> subelement is present, and
attributes or subelements of that <code>primary-key-join-column</code> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="id-class"><a class="anchor" href="#id-class"></a>12.2.3.8. id-class</h5>
<div class="paragraph">
<p>The <code>id-class</code> subelement overrides any
<code>IdClass</code> annotation specified on the entity.</p>
</div>
</div>
<div class="sect4">
<h5 id="inheritance-2"><a class="anchor" href="#inheritance-2"></a>12.2.3.9. inheritance</h5>
<div class="paragraph">
<p>The <code>inheritance</code> subelement overrides any
<code>Inheritance</code> annotation (including defaulted <code>Inheritance</code> values) on
the entity. If an <code>inheritance</code> subelement is present, and the
<code>strategy</code> attribute is not explicitly specified, its default value is
applied.</p>
</div>
<div class="paragraph">
<p>This element applies to the entity and its
subclasses (unless otherwise overridden for a subclass by an annotation
or XML element).</p>
</div>
<div class="paragraph">
<p>Support for the combination of inheritance
strategies is not required by this specification. Portable applications
should use only a single inheritance strategy within an entity
hierarchy.</p>
</div>
</div>
<div class="sect4">
<h5 id="discriminator-value"><a class="anchor" href="#discriminator-value"></a>12.2.3.10. discriminator-value</h5>
<div class="paragraph">
<p>The <code>discriminator-value</code> subelement
overrides any <code>DiscriminatorValue</code> annotations (including defaulted
<code>DiscriminatorValue</code> values) on the entity.</p>
</div>
</div>
<div class="sect4">
<h5 id="discriminator-column"><a class="anchor" href="#discriminator-column"></a>12.2.3.11. discriminator-column</h5>
<div class="paragraph">
<p>The <code>discriminator-column</code> subelement
overrides any <code>DiscriminatorColumn</code> annotation (including defaulted
<code>DiscriminatorColumn</code> values) on the entity. If a <code>discriminator-column</code>
subelement is present, and attributes of that <code>discriminator-column</code>
subelement are not explicitly specified, their default values are
applied.</p>
</div>
<div class="paragraph">
<p>This element applies to the entity and its
subclasses (unless otherwise overridden for a subclass by an annotation
or XML element).</p>
</div>
</div>
<div class="sect4">
<h5 id="sequence-generator-2"><a class="anchor" href="#sequence-generator-2"></a>12.2.3.12. sequence-generator</h5>
<div class="paragraph">
<p>The generator defined by the
<code>sequence-generator</code> subelement is added to any generators defined in
annotations and any other generators defined in XML. If a generator of
the same name is defined in annotations, the generator defined by this
subelement overrides that definition. If a <code>sequence-generator</code>
subelement is present, and attributes or subelements of that
<code>sequence-generator</code> subelement are not explicitly specified, their
default values are applied.</p>
</div>
<div class="paragraph">
<p>The generator defined by the
<code>sequence-generator</code> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
generators of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="table-generator-2"><a class="anchor" href="#table-generator-2"></a>12.2.3.13. table-generator</h5>
<div class="paragraph">
<p>The generator defined by the
<code>table-generator</code> subelement is added to any generators defined in
annotations and any other generators defined in XML. If a generator of
the same name is defined in annotations, the generator defined by this
subelement overrides that definition. If a <code>table-generator</code> subelement
is present, and attributes or subelements of that <code>table-generator</code>
subelement are not explicitly specified, their default values are
applied.</p>
</div>
<div class="paragraph">
<p>The generator defined by the
<code>table-generator</code> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
generators of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="attribute-override"><a class="anchor" href="#attribute-override"></a>12.2.3.14. attribute-override</h5>
<div class="paragraph">
<p>The <code>attribute-override</code> subelement is
additive to any <code>AttributeOverride</code> or <code>AttributeOverrides</code> annotations
on the entity. It overrides any <code>AttributeOverride</code> elements for the
same attribute name. If an <code>attribute-override</code> subelement is present,
and attributes or subelements of that <code>attribute-override</code> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="association-override"><a class="anchor" href="#association-override"></a>12.2.3.15. association-override</h5>
<div class="paragraph">
<p>The <code>association-override</code> subelement is
additive to any <code>AssociationOverride</code> or <code>AssociationOverrides</code>
annotations on the entity. It overrides any <code>AssociationOverride</code>
elements for the same attribute name. If an <code>association-override</code>
subelement is present, and attributes or subelements of that
<code>association-override</code> subelement are not explicitly specified, their
default values are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="convert"><a class="anchor" href="#convert"></a>12.2.3.16. convert</h5>
<div class="paragraph">
<p>The <code>convert</code> subelement is additive to any
<code>Convert</code> or <code>Converts</code> annotations on the entity. It overrides any
<code>Convert</code> annotation for the same attribute name. If a <code>convert</code>
subelement is present, and attributes or subelements of that <code>convert</code>
subelement are not explicitly specified, their default values are
applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-entity-graph"><a class="anchor" href="#named-entity-graph"></a>12.2.3.17. named-entity-graph</h5>
<div class="paragraph">
<p>The <code>named-entity-graph</code> subelement is
additive to any <code>NamedEntityGraph</code> annotations on the entity. It
overrides any <code>NamedEntityGraph</code> annotation with the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-query-2"><a class="anchor" href="#named-query-2"></a>12.2.3.18. named-query</h5>
<div class="paragraph">
<p>The named query defined by the <code>named-query</code>
subelement is added to any named queries defined in annotations, and any
other named queries defined in XML. If a named query of the same name is
defined in annotations, the named query defined by this subelement
overrides that definition. If a <code>named-query</code> subelement is present, and
attributes or subelements of that <code>named-query</code> subelement are not
explicitly specified, their default values are applied.</p>
</div>
<div class="paragraph">
<p>The named query defined by the <code>named-query</code>
subelement applies to the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain named queries of the same
name.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-native-query-2"><a class="anchor" href="#named-native-query-2"></a>12.2.3.19. named-native-query</h5>
<div class="paragraph">
<p>The named query defined by the
<code>named-native-query</code> subelement is added to any named queries defined in
annotations, and any other named queries defined in XML. If a named
query of the same name is defined in annotations, the named query
defined by this subelement overrides that definition. If a
<code>named-native-query</code> subelement is present, and attributes or
subelements of that <code>named-native-query</code> subelement are not explicitly
specified, their default values are applied.</p>
</div>
<div class="paragraph">
<p>The named native query defined by the
<code>named-native-query</code> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
named queries of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-stored-procedure-query-2"><a class="anchor" href="#named-stored-procedure-query-2"></a>12.2.3.20. named-stored-procedure-query</h5>
<div class="paragraph">
<p>The named stored procedure query defined by
the <code>named-stored-procedure-query</code> subelement is added to any named
stored procedure queries defined in annotations, and any other named
stored procedure queries defined in XML. If a named stored procedure
query of the same name is defined in annotations, the named stored
procedure query defined by this subelement overrides that definition. If
a <code>named-stored-procedure-query</code> subelement is present, and attributes
or subelements of that <code>named-stored-procedure-query</code> subelement are not
explicitly specified, their default values are applied.</p>
</div>
<div class="paragraph">
<p>The named stored procedure query defined by
the <code>named-stored-procedure-query</code> subelement applies to the persistence
unit. It is undefined if multiple mapping files for the persistence unit
contain named stored procedure queries of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="sql-result-set-mapping-2"><a class="anchor" href="#sql-result-set-mapping-2"></a>12.2.3.21. sql-result-set-mapping</h5>
<div class="paragraph">
<p>The SQL result set mapping defined by the
<code>sql-result-set-mapping</code> is added to the SQL result set mappings defined
in annotations, and any other SQL result set mappings defined in XML. If
a SQL result set mapping of the same name is defined in annotations, the
SQL result set mapping defined by this subelement overrides that
definition. If a <code>sql-result-set-mapping</code> subelement is present, and
attributes or subelements of that <code>sql-result-set-mapping</code> subelement
are not explicitly specified, their default values are applied.</p>
</div>
<div class="paragraph">
<p>The SQL result set mapping defined by the
<code>sql-result-set-mapping</code> subelement applies to the persistence unit. It
is undefined if multiple mapping files for the persistence unit contain
SQL result set mappings of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="exclude-default-listeners"><a class="anchor" href="#exclude-default-listeners"></a>12.2.3.22. exclude-default-listeners</h5>
<div class="paragraph">
<p>The <code>exclude-default-listeners</code> subelement
applies whether or not the <code>ExcludeDefaultListeners</code> annotation was
specified on the entity.</p>
</div>
<div class="paragraph">
<p>This element causes the default entity
listeners to be excluded for the entity and its subclasses.</p>
</div>
</div>
<div class="sect4">
<h5 id="exclude-superclass-listeners"><a class="anchor" href="#exclude-superclass-listeners"></a>12.2.3.23. exclude-superclass-listeners</h5>
<div class="paragraph">
<p>The <code>exclude-superclass-listeners</code> subelement
applies whether or not the <code>ExcludeSuperclassListeners</code> annotation was
specified on the entity.</p>
</div>
<div class="paragraph">
<p>This element causes any superclass listeners
to be excluded for the entity and its subclasses.</p>
</div>
</div>
<div class="sect4">
<h5 id="entity-listeners-3"><a class="anchor" href="#entity-listeners-3"></a>12.2.3.24. entity-listeners</h5>
<div class="paragraph">
<p>The <code>entity-listeners</code> subelement overrides
any <code>EntityListeners</code> annotation on the entity.</p>
</div>
<div class="paragraph">
<p>These listeners apply to the entity and its
subclasses unless otherwise excluded.</p>
</div>
</div>
<div class="sect4">
<h5 id="pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load"><a class="anchor" href="#pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load"></a>12.2.3.25. pre-persist, post-persist, pre-remove, post-remove, pre-update, post-update, post-load</h5>
<div class="paragraph">
<p>These subelements override any lifecycle
callback methods defined by the corresponding annotations on the entity.</p>
</div>
</div>
<div class="sect4">
<h5 id="a17082"><a class="anchor" href="#a17082"></a>12.2.3.26. attributes</h5>
<div class="paragraph">
<p>The <code>attributes</code> element groups the mapping
subelements for the fields and properties of the entity. It may be
sparsely populated to include only a subset of the fields and
properties. If the value of <code>metadata-complete</code> is <code>true</code>, the
remainder of the attributes will be defaulted according to the default
rules. If <code>metadata-complete</code> is not specified, or is <code>false</code>, the
mappings for only those properties and fields that are explicitly
specified will be overridden.</p>
</div>
<div class="sect5">
<h6 id="id-2"><a class="anchor" href="#id-2"></a>id</h6>
<div class="paragraph">
<p>The <code>id</code> subelement overrides the mapping for
the specified field or property. If an <code>id</code> subelement is present, and
attributes or subelements of that <code>id</code> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded-id"><a class="anchor" href="#embedded-id"></a>embedded-id</h6>
<div class="paragraph">
<p>The <code>embedded-id</code> subelement overrides the
mapping for the specified field or property. If an <code>embedded-id</code>
subelement is present, and attributes or subelements of that
<code>embedded-id</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="basic"><a class="anchor" href="#basic"></a>basic</h6>
<div class="paragraph">
<p>The <code>basic</code> subelement overrides the mapping
for the specified field or property. If a <code>basic</code> subelement is present,
and attributes or subelements of that <code>basic</code> subelement are not
explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="version-2"><a class="anchor" href="#version-2"></a>version</h6>
<div class="paragraph">
<p>The <code>version</code> subelement overrides the
mapping for the specified field or property. If a <code>version</code> subelement
is present, and attributes or subelements of that <code>version</code> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-one"><a class="anchor" href="#many-to-one"></a>many-to-one</h6>
<div class="paragraph">
<p>The <code>many-to-one</code> subelement overrides the
mapping for the specified field or property. If a <code>many-to-one</code>
subelement is present, and attributes or subelements of that
<code>many-to-one</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-many"><a class="anchor" href="#one-to-many"></a>one-to-many</h6>
<div class="paragraph">
<p>The <code>one-to-many</code> subelement overrides the
mapping for the specified field or property. If a <code>one-to-many</code>
subelement is present, and attributes or subelements of that
<code>one-to-many</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-one"><a class="anchor" href="#one-to-one"></a>one-to-one</h6>
<div class="paragraph">
<p>The <code>one-to-one</code> subelement overrides the
mapping for the specified field or property. If a <code>one-to-one</code>
subelement is present, and attributes or subelements of that
<code>one-to-one</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-many"><a class="anchor" href="#many-to-many"></a>many-to-many</h6>
<div class="paragraph">
<p>The <code>many-to-many</code> subelement overrides the
mapping for the specified field or property. If a <code>many-to-many</code>
subelement is present, and attributes or subelements of that
<code>many-to-many</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="element-collection"><a class="anchor" href="#element-collection"></a>element-collection</h6>
<div class="paragraph">
<p>The <code>element-collection</code> subelement overrides
the mapping for the specified field or property. If an
<code>element-collection</code> subelement is present, and attributes or
subelements of that <code>element-collection</code> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded"><a class="anchor" href="#embedded"></a>embedded</h6>
<div class="paragraph">
<p>The <code>embedded</code> subelement overrides the
mapping for the specified field or property. If an <code>embedded</code> subelement
is present, and attributes or subelements of that <code>embedded</code> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="transient"><a class="anchor" href="#transient"></a>transient</h6>
<div class="paragraph">
<p>The <code>transient</code> subelement overrides the
mapping for the specified field or property.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a17106"><a class="anchor" href="#a17106"></a>12.2.4. mapped-superclass Subelements and Attributes</h4>
<div class="paragraph">
<p>These apply only to the mapped-superclass for
which they are subelements or attributes, unless otherwise specified
below.</p>
</div>
<div class="sect4">
<h5 id="metadata-complete-2"><a class="anchor" href="#metadata-complete-2"></a>12.2.4.1. metadata-complete</h5>
<div class="paragraph">
<p>If the <code>metadata-complete</code> attribute of the
<code>mapped-superclass</code> element is specified as <code>true</code>, any annotations on
the mapped superclass (and its fields and properties) are ignored. When
<code>metadata-complete</code> is specified as <code>true</code> and attributes or
sub-elements of the <code>mapped-superclass</code> element are omitted, the default
values for those attributes and elements are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="access-4"><a class="anchor" href="#access-4"></a>12.2.4.2. access</h5>
<div class="paragraph">
<p>The <code>access</code> attribute defines the access
type for the mapped superclass. The <code>access</code> attribute overrides any
access type specified by the <code>persistence-unit-defaults</code> element or
<code>entity-mappings</code> element for the given mapped superclass. The access
type for a field or property of the mapped superclass may be overridden
by specifying by overriding the mapping for that field or property using
the appropriate XML subelement, as described in <a href="#a17126">Section 12.2.4.8</a> below.</p>
</div>
<div class="paragraph">
<p>Caution must be exercised in overriding an
access type that was specified or defaulted using annotations, as doing
so may cause applications to break.</p>
</div>
</div>
<div class="sect4">
<h5 id="id-class-2"><a class="anchor" href="#id-class-2"></a>12.2.4.3. id-class</h5>
<div class="paragraph">
<p>The <code>id-class</code> subelement overrides any
<code>IdClass</code> annotation specified on the mapped superclass.</p>
</div>
</div>
<div class="sect4">
<h5 id="exclude-default-listeners-2"><a class="anchor" href="#exclude-default-listeners-2"></a>12.2.4.4. exclude-default-listeners</h5>
<div class="paragraph">
<p>The <code>exclude-default-listeners</code> subelement
applies whether or not the <code>ExcludeDefaultListeners</code> annotation was
specified on the mapped superclass.</p>
</div>
<div class="paragraph">
<p>This element causes the default entity
listeners to be excluded for the mapped superclass and its subclasses.</p>
</div>
</div>
<div class="sect4">
<h5 id="exclude-superclass-listeners-2"><a class="anchor" href="#exclude-superclass-listeners-2"></a>12.2.4.5. exclude-superclass-listeners</h5>
<div class="paragraph">
<p>The <code>exclude-superclass-listeners</code> subelement
applies whether or not the <code>ExcludeSuperclassListeners</code> annotation was
specified on the mapped superclass.</p>
</div>
<div class="paragraph">
<p>This element causes any superclass listeners
to be excluded for the mapped superclass and its subclasses.</p>
</div>
</div>
<div class="sect4">
<h5 id="entity-listeners-4"><a class="anchor" href="#entity-listeners-4"></a>12.2.4.6. entity-listeners</h5>
<div class="paragraph">
<p>The <code>entity-listeners</code> subelement overrides
any <code>EntityListeners</code> annotation on the mapped superclass.</p>
</div>
<div class="paragraph">
<p>These listeners apply to the mapped
superclass and its subclasses unless otherwise excluded.</p>
</div>
</div>
<div class="sect4">
<h5 id="pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load-2"><a class="anchor" href="#pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load-2"></a>12.2.4.7. pre-persist, post-persist, pre-remove, post-remove, pre-update, post-update, post-load</h5>
<div class="paragraph">
<p>These subelements override any lifecycle
callback methods defined by the corresponding annotations on the mapped
superclass.</p>
</div>
</div>
<div class="sect4">
<h5 id="a17126"><a class="anchor" href="#a17126"></a>12.2.4.8. attributes</h5>
<div class="paragraph">
<p>The <code>attributes</code> element groups the mapping
subelements for the fields and properties defined by the mapped
superclass. It may be sparsely populated to include only a subset of the
fields and properties. If the value of <code>metadata-complete</code> is <code>true</code>,
the remainder of the attributes will be defaulted according to the
default rules. If <code>metadata-complete</code> is not specified, or is <code>false</code>,
the mappings for only those properties and fields that are explicitly
specified will be overridden.</p>
</div>
<div class="sect5">
<h6 id="id-3"><a class="anchor" href="#id-3"></a>id</h6>
<div class="paragraph">
<p>The <code>id</code> subelement overrides the mapping for
the specified field or property. If an <code>id</code> subelement is present, and
attributes or subelements of that <code>id</code> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded-id-2"><a class="anchor" href="#embedded-id-2"></a>embedded-id</h6>
<div class="paragraph">
<p>The <code>embedded-id</code> subelement overrides the
mapping for the specified field or property. If an <code>embedded-id</code>
subelement is present, and attributes or subelements of that
<code>embedded-id</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="basic-2"><a class="anchor" href="#basic-2"></a>basic</h6>
<div class="paragraph">
<p>The <code>basic</code> subelement overrides the mapping
for the specified field or property. If a <code>basic</code> subelement is present,
and attributes or subelements of that <code>basic</code> subelement are not
explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="version-3"><a class="anchor" href="#version-3"></a>version</h6>
<div class="paragraph">
<p>The <code>version</code> subelement overrides the
mapping for the specified field or property. If a <code>version</code> subelement
is present, and attributes or subelements of that <code>version</code> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-one-2"><a class="anchor" href="#many-to-one-2"></a>many-to-one</h6>
<div class="paragraph">
<p>The <code>many-to-one</code> subelement overrides the
mapping for the specified field or property. If a <code>many-to-one</code>
subelement is present, and attributes or subelements of that
<code>many-to-one</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-many-2"><a class="anchor" href="#one-to-many-2"></a>one-to-many</h6>
<div class="paragraph">
<p>The <code>one-to-many</code> subelement overrides the
mapping for the specified field or property. If a <code>one-to-many</code>
subelement is present, and attributes or subelements of that
<code>one-to-many</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-one-2"><a class="anchor" href="#one-to-one-2"></a>one-to-one</h6>
<div class="paragraph">
<p>The <code>one-to-one</code> subelement overrides the
mapping for the specified field or property. If a <code>one-to-one</code>
subelement is present, and attributes or subelements of that
<code>one-to-one</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-many-2"><a class="anchor" href="#many-to-many-2"></a>many-to-many</h6>
<div class="paragraph">
<p>The <code>many-to-many</code> subelement overrides the
mapping for the specified field or property. If a <code>many-to-many</code>
subelement is present, and attributes or subelements of that
<code>many-to-many</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="element-collection-2"><a class="anchor" href="#element-collection-2"></a>element-collection</h6>
<div class="paragraph">
<p>The <code>element-collection</code> subelement overrides
the mapping for the specified field or property. If an
<code>element-collection</code> subelement is present, and attributes or
subelements of that <code>element-collection</code> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded-2"><a class="anchor" href="#embedded-2"></a>embedded</h6>
<div class="paragraph">
<p>The <code>embedded</code> subelement overrides the
mapping for the specified field or property. If an <code>embedded</code> subelement
is present, and attributes or subelements of that <code>embedded</code> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="transient-2"><a class="anchor" href="#transient-2"></a>transient</h6>
<div class="paragraph">
<p>The <code>transient</code> subelement overrides the
mapping for the specified field or property.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a17150"><a class="anchor" href="#a17150"></a>12.2.5. embeddable Subelements and Attributes</h4>
<div class="paragraph">
<p>These apply only to the embeddable for which
they are subelements or attributes.</p>
</div>
<div class="sect4">
<h5 id="metadata-complete-3"><a class="anchor" href="#metadata-complete-3"></a>12.2.5.1. metadata-complete</h5>
<div class="paragraph">
<p>If the <code>metadata-complete</code> attribute of the
<code>embeddable</code> element is specified as <code>true</code>, any annotations on the
embeddable class (and its fields and properties) are ignored. When
<code>metadata-complete</code> is specified as <code>true</code> and attributes and
sub-elements of the <code>embeddable</code> element are omitted, the default values
for those attributes and elements are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="access-5"><a class="anchor" href="#access-5"></a>12.2.5.2. access</h5>
<div class="paragraph">
<p>The <code>access</code> attribute defines the access
type for the embeddable class. The <code>access</code> attribute overrides any
access type specified by the <code>persistence-unit-defaults</code> element or
<code>entity-mappings</code> element for the given embeddable class. The access
type for a field or property of the embeddable class may be overridden
by specifying by overriding the mapping for that field or property using
the appropriate XML subelement, as described in <a href="#a17157">Section 12.2.5.3</a> below.</p>
</div>
<div class="paragraph">
<p>Caution must be exercised in overriding an
access type that was specified or defaulted using annotations, as doing
so may cause applications to break.</p>
</div>
</div>
<div class="sect4">
<h5 id="a17157"><a class="anchor" href="#a17157"></a>12.2.5.3. attributes</h5>
<div class="paragraph">
<p>The <code>attributes</code> element groups the mapping
subelements for the fields and properties defined by the embeddable
class. It may be sparsely populated to include only a subset of the
fields and properties. If the value of <code>metadata-complete</code> is <code>true</code>,
the remainder of the attributes will be defaulted according to the
default rules. If <code>metadata-complete</code> is not specified, or is <code>false</code>,
the mappings for only those properties and fields that are explicitly
specified will be overridden.</p>
</div>
<div class="sect5">
<h6 id="basic-3"><a class="anchor" href="#basic-3"></a>basic</h6>
<div class="paragraph">
<p>The <code>basic</code> subelement overrides the mapping
for the specified field or property. If a <code>basic</code> subelement is present,
and attributes or subelements of that <code>basic</code> subelement are not
explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-one-3"><a class="anchor" href="#many-to-one-3"></a>many-to-one</h6>
<div class="paragraph">
<p>The <code>many-to-one</code> subelement overrides the
mapping for the specified field or property. If a <code>many-to-one</code>
subelement is present, and attributes or subelements of that
<code>many-to-one</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-many-3"><a class="anchor" href="#one-to-many-3"></a>one-to-many</h6>
<div class="paragraph">
<p>The <code>one-to-many</code> subelement overrides the
mapping for the specified field or property. If a <code>one-to-many</code>
subelement is present, and attributes or subelements of that
<code>one-to-many</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-one-3"><a class="anchor" href="#one-to-one-3"></a>one-to-one</h6>
<div class="paragraph">
<p>The <code>one-to-one</code> subelement overrides the
mapping for the specified field or property. If a <code>one-to-one</code>
subelement is present, and attributes or subelements of that
<code>one-to-one</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-many-3"><a class="anchor" href="#many-to-many-3"></a>many-to-many</h6>
<div class="paragraph">
<p>The <code>many-to-many</code> subelement overrides the
mapping for the specified field or property. If a <code>many-to-many</code>
subelement is present, and attributes or subelements of that
<code>many-to-many</code> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="element-collection-3"><a class="anchor" href="#element-collection-3"></a>element-collection</h6>
<div class="paragraph">
<p>The <code>element-collection</code> subelement overrides
the mapping for the specified field or property. If an
<code>element-collection</code> subelement is present, and attributes or
subelements of that <code>element-collection</code> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded-3"><a class="anchor" href="#embedded-3"></a>embedded</h6>
<div class="paragraph">
<p>The <code>embedded</code> subelement overrides the
mapping for the specified field or property. If an <code>embedded</code> subelement
is present, and attributes or subelements of that <code>embedded</code> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="transient-3"><a class="anchor" href="#transient-3"></a>transient</h6>
<div class="paragraph">
<p>The <code>transient</code> subelement overrides the
mapping for the specified field or property.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a17175"><a class="anchor" href="#a17175"></a>12.3. XML Schema</h3>
<div class="paragraph">
<p>This section provides the XML
object/relational mapping schema for use with the Persistence API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="comment">&lt;!-- Jakarta Persistence API object/relational mapping file schema --&gt;</span>
<span class="tag">&lt;xsd:schema</span> <span class="attribute-name">targetNamespace</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/persistence/orm</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:orm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/persistence/orm</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:xsd</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">elementFormDefault</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">qualified</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">attributeFormDefault</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unqualified</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;xsd:annotation&gt;</span>
     <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

       This is the XML Schema for the persistence object/relational mapping file.
       The file may be named &quot;META-INF/orm.xml&quot; in the persistence
       archive or it may be named some other name which would be
       used to locate the file as resource on the classpath.

       Object/relational mapping files must indicate the object/relational
       mapping file schema by using the persistence namespace:

       https://jakarta.ee/xml/ns/persistence/orm

       and indicate the version of the schema by
       using the version element as shown below:

      &lt;entity-mappings xmlns=&quot;https://jakarta.ee/xml/ns/persistence/orm&quot;
        xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
        xsi:schemaLocation=&quot;https://jakarta.ee/xml/ns/persistence/orm
          https://jakarta.ee/xml/ns/persistence/orm/orm_3_2.xsd&quot;
        version=&quot;3.2&quot;&gt;
          ...
      &lt;/entity-mappings&gt;


     <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
  <span class="tag">&lt;/xsd:annotation&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">emptyType</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">versionType</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:pattern</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">[0-9]+(\.[0-9]+)*</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-mappings</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:complexType&gt;</span>
      <span class="tag">&lt;xsd:annotation&gt;</span>
        <span class="tag">&lt;xsd:documentation&gt;</span>

        The entity-mappings element is the root element of a mapping
        file. It contains the following four types of elements:

        1. The persistence-unit-metadata element contains metadata
        for the entire persistence unit. It is undefined if this element
        occurs in multiple mapping files within the same persistence unit.

        2. The package, schema, catalog and access elements apply to all of
        the entity, mapped-superclass and embeddable elements defined in
        the same file in which they occur.

        3. The sequence-generator, table-generator, converter, named-query,
        named-native-query, named-stored-procedure-query, and
        sql-result-set-mapping elements are global to the persistence
        unit. It is undefined to have more than one sequence-generator
        or table-generator of the same name in the same or different
        mapping files in a persistence unit. It is undefined to have
        more than one named-query, named-native-query, sql-result-set-mapping,
        or named-stored-procedure-query of the same name in the same
        or different mapping files in a persistence unit.  It is also
        undefined to have more than one converter for the same target
        type in the same or different mapping files in a persistence unit.

        4. The entity, mapped-superclass and embeddable elements each define
        the mapping information for a managed persistent class. The mapping
        information contained in these elements may be complete or it may
        be partial.

        <span class="tag">&lt;/xsd:documentation&gt;</span>
      <span class="tag">&lt;/xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-metadata</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:persistence-unit-metadata</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">package</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sequence-generator</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:table-generator</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-query</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-native-query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-native-query</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-stored-procedure-query</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-stored-procedure-query</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sql-result-set-mapping</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sql-result-set-mapping</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-superclass</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:mapped-superclass</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embeddable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embeddable</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">converter</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:converter</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:versionType</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:complexType&gt;</span>
  <span class="tag">&lt;/xsd:element&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-metadata</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Metadata that applies to the persistence unit and not just to
        the mapping file in which it is contained.

        If the xml-mapping-metadata-complete element is specified,
        the complete set of mapping metadata for the persistence unit
        is contained in the XML mapping files for the persistence unit.

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xml-mapping-metadata-complete</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-defaults</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:persistence-unit-defaults</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-defaults</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        These defaults are applied to the persistence unit as a whole
        unless they are overridden by local annotation or XML
        element settings.

        schema - Used as the schema for all tables, secondary tables, join
            tables, collection tables, sequence generators, and table
            generators that apply to the persistence unit
        catalog - Used as the catalog for all tables, secondary tables, join
            tables, collection tables, sequence generators, and table
            generators that apply to the persistence unit
        delimited-identifiers - Used to treat database identifiers as
            delimited identifiers.
        access - Used as the access type for all managed classes in
            the persistence unit
        cascade-persist - Adds cascade-persist to the set of cascade options
            in all entity relationships of the persistence unit
        entity-listeners - List of default entity listeners to be invoked
            on each entity in the persistence unit.
      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">delimited-identifiers</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-listeners</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Defines the settings and mappings for an entity. Is allowed to be
        sparsely populated and used in conjunction with the annotations.
        Alternatively, the metadata-complete attribute can be used to
        indicate that no annotations on the entity class (and its fields
        or properties) are to be processed. If this is the case then
        the defaulting rules for the entity and its subelements will
        be recursively applied.

        @Target(TYPE) @Retention(RUNTIME)
        public @interface Entity {
          String name() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:table</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secondary-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:secondary-table</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:id-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inheritance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:inheritance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:discriminator-value</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:discriminator-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sequence-generator</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:table-generator</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-query</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-native-query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-native-query</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-stored-procedure-query</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-stored-procedure-query</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sql-result-set-mapping</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sql-result-set-mapping</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-default-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-superclass-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-listeners</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-persist</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">association-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:association-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-entity-graph</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-entity-graph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cacheable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">metadata-complete</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        This element determines how the persistence provider accesses the
        state of an entity or embedded object.

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PROPERTY</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FIELD</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">association-override</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(AssociationOverrides.class)
        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface AssociationOverride {
          String name();
          JoinColumn[] joinColumns() default{};
          ForeignKey foreignKey() default @ForeignKey(PROVIDER_DEFAULT);
          JoinTable joinTable() default @JoinTable;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(AttributeOverrides.class)
        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface AttributeOverride {
          String name();
          Column column();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        This element contains the entity field or property mappings.
        It may be sparsely populated to include only a subset of the
        fields or properties. If metadata-complete for the entity is true
        then the remainder of the attributes will be defaulted according
        to the default rules.

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:id</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embedded-id</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:basic</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:version</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-one</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:many-to-one</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-many</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:one-to-many</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-one</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:one-to-one</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-many</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:many-to-many</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">element-collection</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:element-collection</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embedded</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transient</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:transient</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Basic {
          FetchType fetch() default FetchType.EAGER;
          boolean optional() default true;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lob</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:lob</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">enumerated</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">optional</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum CascadeType { ALL, PERSIST, MERGE, REMOVE, REFRESH, DETACH }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-all</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-merge</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-refresh</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-detach</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">check-constraint</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface CheckConstraint {
          String name() default &quot;&quot;;
          String constraint();
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">collection-table</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface CollectionTable {
          String name() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          JoinColumn[] joinColumns() default {};
          ForeignKey foreignKey() default @ForeignKey(ConstraintMode.PROVIDER_DEFAULT);
          UniqueConstraint[] uniqueConstraints() default {};
          Index[] indexes() default {};
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>


<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Column {
          String name() default &quot;&quot;;
          boolean unique() default false;
          boolean nullable() default true;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String options() default &quot;&quot;;
          String table() default &quot;&quot;;
          int length() default 255;
          int precision() default 0; // decimal precision
          int scale() default 0; // decimal scale
          int secondPrecision() default -1; //fractional second precision
          CheckConstraint[] check() default {};
          String comment() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">comment</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">check-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:check-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">length</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">precision</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scale</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">second-precision</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({}) @Retention(RUNTIME)
        public @interface ColumnResult {
          String name();
          Class&lt;?&gt; type() default void.class;
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constraint-mode</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

       public enum ConstraintMode { CONSTRAINT, NO_CONSTRAINT, PROVIDER_DEFAULT }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CONSTRAINT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">NO_CONSTRAINT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PROVIDER_DEFAULT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>


  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constructor-result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({}) @Retention(RUNTIME)
        public @interface ConstructorResult {
          Class&lt;?&gt; targetClass();
          ColumnResult[] columns();
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Repeatable(Converts.class)
        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Convert {
          Class&lt;? extends AttributeConverter&gt; converter() default AttributeConverter.class;
          String attributeName() default &quot;&quot;;
          boolean disableConversion() default false;
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">converter</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">disable-conversion</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">converter</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface Converter {
          boolean autoApply() default false;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">auto-apply</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface DiscriminatorColumn {
          String name() default &quot;DTYPE&quot;;
          DiscriminatorType discriminatorType() default STRING;
          String columnDefinition() default &quot;&quot;;
          String options() default &quot;&quot;;
          int length() default 31;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:discriminator-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">length</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum DiscriminatorType { STRING, CHAR, INTEGER }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">STRING</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CHAR</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INTEGER</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-value</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface DiscriminatorValue {
          String value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

 <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">element-collection</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface ElementCollection {
          Class&lt;?&gt; targetClass() default void.class;
          FetchType fetch() default FetchType.LAZY;
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-by</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-class</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-column</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-column</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-join-column</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-join-column</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lob</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:lob</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">association-override</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:association-override</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">collection-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:collection-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embeddable</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Defines the settings and mappings for embeddable objects. Is
        allowed to be sparsely populated and used in conjunction with
        the annotations. Alternatively, the metadata-complete attribute
        can be used to indicate that no annotations are to be processed
        in the class. If this is the case then the defaulting rules will
        be recursively applied.

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface Embeddable {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embeddable-attributes</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">metadata-complete</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embeddable-attributes</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:basic</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-one</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:many-to-one</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-many</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:one-to-many</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-one</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:one-to-one</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-many</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:many-to-many</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">element-collection</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:element-collection</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embedded</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transient</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:transient</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Embedded {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">association-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:association-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded-id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface EmbeddedId {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listener</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Defines an entity listener to be invoked at lifecycle events
        for the entities that list this listener.

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-persist</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listeners</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface EntityListeners {
          Class&lt;?&gt;[] value();
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listener</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-listener</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({}) @Retention(RUNTIME)
        public @interface EntityResult {
          Class&lt;?&gt; entityClass();
          LockModeType lockMode() default LockModeType.OPTIMISTIC;
          FieldResult[] fields() default {};
          String discriminatorColumn() default &quot;&quot;;
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lock-mode</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:lock-mode-type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">field-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:field-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">enum-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum EnumType { ORDINAL, STRING }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ORDINAL</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">STRING</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">enumerated</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Enumerated {
          EnumType value() default ORDINAL;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enum-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum FetchType { LAZY, EAGER }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">LAZY</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EAGER</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">field-result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface FieldResult {
          String name();
          String column();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface ForeignKey {
          String name() default &quot;&quot;;
          ConstraintMode value() default CONSTRAINT;
          String foreign-key-definition() default &quot;&quot;;
          String options() default &quot;&quot;;
        }

        Note that the elements that embed the use of the annotation
        default this use as @ForeignKey(PROVIDER_DEFAULT).

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constraint-mode</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:constraint-mode</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generated-value</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface GeneratedValue {
          GenerationType strategy() default AUTO;
          String generator() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strategy</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:generation-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generation-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum GenerationType { TABLE, SEQUENCE, IDENTITY, UUID, AUTO }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TABLE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SEQUENCE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">IDENTITY</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UUID</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">AUTO</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Id {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generated-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:generated-value</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:table-generator</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sequence-generator</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-class</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface IdClass {
          Class&lt;?&gt; value();
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface Index {
          String name() default &quot;&quot;;
          String columnList();
          boolean unique() default false;
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-list</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inheritance</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface Inheritance {
          InheritanceType strategy() default InheritanceType.SINGLE_TABLE;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strategy</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:inheritance-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inheritance-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum InheritanceType { SINGLE_TABLE, TABLE_PER_CLASS, JOINED }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SINGLE_TABLE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">JOINED</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TABLE_PER_CLASS</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(JoinColumns.class)
        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface JoinColumn {
          String name() default &quot;&quot;;
          String referencedColumnName() default &quot;&quot;;
          boolean unique() default false;
          boolean nullable() default true;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String options() default &quot;&quot;;
          String table() default &quot;&quot;;
          ForeignKey foreignKey() default @ForeignKey();
          CheckConstraint[] check() default {};
          String comment() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">comment</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">check-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:check-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">referenced-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface JoinTable {
          String name() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          JoinColumn[] joinColumns() default {};
          JoinColumn[] inverseJoinColumns() default {};
          ForeignKey foreignKey() default @ForeignKey(ConstraintMode.PROVIDER_DEFAULT);
          ForeignKey inverseForeignKey() default @ForeignKey(ConstraintMode.PROVIDER_DEFAULT);
          UniqueConstraint[] uniqueConstraints() default {};
          Index[] indexes() default {};
          CheckConstraint[] check() default {};
          String comment() default &quot;&quot;;
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">comment</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inverse-join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inverse-foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">check-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:check-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lob</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Lob {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lock-mode-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum LockModeType implements FindOption, RefreshOption { READ, WRITE, OPTIMISTIC, OPTIMISTIC_FORCE_INCREMENT, PESSIMISTIC_READ, PESSIMISTIC_WRITE, PESSIMISTIC_FORCE_INCREMENT, NONE}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OPTIMISTIC</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OPTIMISTIC_FORCE_INCREMENT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PESSIMISTIC_READ</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PESSIMISTIC_WRITE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PESSIMISTIC_FORCE_INCREMENT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

<span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-many</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface ManyToMany {
          Class&lt;?&gt; targetEntity() default void.class;
          CascadeType[] cascade() default {};
          FetchType fetch() default FetchType.LAZY;
          String mappedBy() default &quot;&quot;;
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-by</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-class</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:cascade-type</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-one</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface ManyToOne {
          Class&lt;?&gt; targetEntity() default void.class;
          CascadeType[] cascade() default {};
          FetchType fetch() default FetchType.EAGER;
          boolean optional() default true;
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:cascade-type</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">optional</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">maps-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface MapKey {
          String name() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-class</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface MapKeyClass {
          Class&lt;?&gt; value();
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface MapKeyColumn {
          String name() default &quot;&quot;;
          boolean unique() default false;
          boolean nullable() default false;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String options() default &quot;&quot;;
          String table() default &quot;&quot;;
          int length() default 255;
          int precision() default 0; // decimal precision
          int scale() default 0; // decimal scale
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">length</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">precision</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scale</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-join-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(MapKeyJoinColumns.class)
        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface MapKeyJoinColumn {
          String name() default &quot;&quot;;
          String referencedColumnName() default &quot;&quot;;
          boolean unique() default false;
          boolean nullable() default false;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String options() default &quot;&quot;;
          String table() default &quot;&quot;;
          ForeignKey foreignKey() default @ForeignKey(ConstraintMode.PROVIDER_DEFAULT);
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">referenced-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>


<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-superclass</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Defines the settings and mappings for a mapped superclass. Is
        allowed to be sparsely populated and used in conjunction with
        the annotations. Alternatively, the metadata-complete attribute
        can be used to indicate that no annotations are to be processed
        If this is the case then the defaulting rules will be recursively
        applied.

        @Target(TYPE) @Retention(RUNTIME)
        public @interface MappedSuperclass {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:id-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-default-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-superclass-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-listeners</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-persist</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">metadata-complete</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-attribute-node</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface NamedAttributeNode {
          String value();
          String subgraph() default &quot;&quot;;
          String keySubgraph() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">subgraph</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">key-subgraph</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-entity-graph</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(NamedEntityGraphs.class)
        @Target({TYPE}) @Retention(RUNTIME)
        public @interface NamedEntityGraph {
          String name() default &quot;&quot;;
          NamedAttributeNode[] attributeNodes() default {};
          boolean includeAllAttributes() default false;
          NamedSubgraph[] subgraphs() default {};
          NamedSubGraph[] subclassSubgraphs() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-attribute-node</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-attribute-node</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">subgraph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-subgraph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">subclass-subgraph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-subgraph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">include-all-attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>


<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-native-query</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Repeatable(NamedNativeQueries.class)
        @Target({TYPE}) @Retention(RUNTIME)
        public @interface NamedNativeQuery {
          String name();
          String query();
          QueryHint[] hints() default {};
          Class&lt;?&gt; resultClass() default void.class;
          String resultSetMapping() default &quot;&quot;; //named SqlResultSetMapping
          EntityResult[] entities() default {};
          ConstructorResult[] classes() default {};
          ColumnResult[] columns() default {};
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:query-hint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constructor-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:constructor-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result-set-mapping</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-query</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(NamedQueries.class)
        @Target({TYPE}) @Retention(RUNTIME)
        public @interface NamedQuery {
          String name();
          String query();
          LockModeType lockMode() default LockModeType.NONE;
          QueryHint[] hints() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lock-mode</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:lock-mode-type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:query-hint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-stored-procedure-query</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(NamedStoredProcedureQueries.class)
        @Target({TYPE}) @Retention(RUNTIME)
        public @interface NamedStoredProcedureQuery {
          String name();
          String procedureName();
          StoredProcedureParameter[] parameters() default {};
          Class[] resultClasses() default {};
          String[] resultSetMappings() default{};
          QueryHint[] hints() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">parameter</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:stored-procedure-parameter</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result-set-mapping</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:query-hint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">procedure-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-subgraph</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({}) @Retention(RUNTIME)
        public @interface NamedSubgraph {
          String name();
          Class&lt;?&gt; type() default void.class;
          NamedAttributeNode[] attributeNodes();
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-attribute-node</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-attribute-node</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

<span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-many</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface OneToMany {
          Class&lt;?&gt; targetEntity() default void.class;
          CascadeType[] cascade() default {};
          FetchType fetch() default FetchType.LAZY;
          String mappedBy() default &quot;&quot;;
          boolean orphanRemoval() default false;
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-by</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-class</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-join-column</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-join-column</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:cascade-type</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orphan-removal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-one</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface OneToOne {
          Class&lt;?&gt; targetEntity() default void.class;
          CascadeType[] cascade() default {};
          FetchType fetch() default FetchType.EAGER;
          boolean optional() default true;
          String mappedBy() default &quot;&quot;;
          boolean orphanRemoval() default false;
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:cascade-type</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">optional</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orphan-removal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">maps-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-by</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface OrderBy {
          String value() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface OrderColumn {
          String name() default &quot;&quot;;
          boolean nullable() default true;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">parameter-mode</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum ParameterMode { IN, INOUT, OUT, REF_CURSOR }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">IN</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INOUT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OUT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">REF_CURSOR</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-load</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PostLoad {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-persist</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PostPersist {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-remove</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PostRemove {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-update</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PostUpdate {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-persist</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PrePersist {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-remove</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PreRemove {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-update</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PreUpdate {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-join-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(PrimaryKeyJoinColumns.class)
        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface PrimaryKeyJoinColumn {
          String name() default &quot;&quot;;
          String referencedColumnName() default &quot;&quot;;
          String columnDefinition() default &quot;&quot;;
          String options() default &quot;&quot;;
          ForeignKey foreignKey() default @ForeignKey(PROVIDER_DEFAULT);
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">referenced-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">query-hint</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface QueryHint {
          String name();
          String value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secondary-table</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(SecondaryTables.class)
        @Target({TYPE}) @Retention(RUNTIME)
        public @interface SecondaryTable {
          String name();
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          PrimaryKeyJoinColumn[] pkJoinColumns() default {};
          ForeignKey foreignKey() default @ForeignKey(ConstraintMode.PROVIDER_DEFAULT);
          UniqueConstraint[] uniqueConstraints() default {};
          Index[] indexes() default {};
          CheckConstraint[] check() default {};
          String comment() default &quot;&quot;;
          String options() default &quot;&quot;;
        }

       <span class="tag">&lt;/xsd:documentation&gt;</span>
     <span class="tag">&lt;/xsd:annotation&gt;</span>
     <span class="tag">&lt;xsd:sequence&gt;</span>
       <span class="tag">&lt;xsd:sequence&gt;</span>
         <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">comment</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
         <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
         <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
       <span class="tag">&lt;/xsd:sequence&gt;</span>
       <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
       <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
       <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
       <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">check-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:check-constraint</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-generator</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(SequenceGenerators.class)
        @Target({TYPE, METHOD, FIELD, PACKAGE}) @Retention(RUNTIME)
        public @interface SequenceGenerator {
          String name() default &quot;&quot;;
          String sequenceName() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          int initialValue() default 1;
          int allocationSize() default 50;
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">initial-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">allocation-size</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sql-result-set-mapping</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(SqlResultSetMappings.class)
        @Target({TYPE}) @Retention(RUNTIME)
        public @interface SqlResultSetMapping {
          String name();
          EntityResult[] entities() default {};
          ConstructorResult[] classes() default{};
          ColumnResult[] columns() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constructor-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:constructor-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">stored-procedure-parameter</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

        @Target({}) @Retention(RUNTIME)
        public @interface StoredProcedureParameter {
          String name() default &quot;&quot;;
          ParameterMode mode() default ParameterMode.IN;
          Class&lt;?&gt; type();
        }

      <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:parameter-mode</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface Table {
          String name() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          UniqueConstraint[] uniqueConstraints() default {};
          Index[] indexes() default {};
          CheckConstraint[] check() default {};
          String comment() default &quot;&quot;;
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">comment</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">check-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:check-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table-generator</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Repeatable(TableGenerators.class)
        @Target({TYPE, METHOD, FIELD, PACKAGE}) @Retention(RUNTIME)
        public @interface TableGenerator {
          String name() default &quot;&quot;;
          String table() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          String pkColumnName() default &quot;&quot;;
          String valueColumnName() default &quot;&quot;;
          String pkColumnValue() default &quot;&quot;;
          int initialValue() default 0;
          int allocationSize() default 50;
          UniqueConstraint[] uniqueConstraints() default {};
          Indexes[] indexes() default {};
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">check-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:check-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pk-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">value-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pk-column-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">initial-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">allocation-size</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Temporal {
          TemporalType value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Deprecated(since = &quot;3.2&quot;)
        public enum TemporalType {
          DATE, // java.sql.Date
          TIME, // java.sql.Time
          TIMESTAMP // java.sql.Timestamp
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DATE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TIME</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TIMESTAMP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
     <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transient</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Transient {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface UniqueConstraint {
          String name() default &quot;&quot;;
          String[] columnNames();
          String options() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">options</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Version {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="tag">&lt;/xsd:schema&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-documents"><a class="anchor" href="#related-documents"></a>Related Documents</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="a19493"></a>[1] Jakarta Persistence, v. 2.2. <em><a href="https://jakarta.ee/specifications/persistence/2.2/" class="bare">https://jakarta.ee/specifications/persistence/2.2/</a></em>.</p>
</li>
<li>
<p><a id="a19494"></a>[2] SQL 2003, Part 2, Foundation (SQL/Foundation). ISO/IEC 9075-2:2003.</p>
</li>
<li>
<p><a id="a19496"></a>[3] JDBC 4.3 Specification. <a href="http://jcp.org/en/jsr/detail?id=221" class="bare">http://jcp.org/en/jsr/detail?id=221</a>.</p>
</li>
<li>
<p><a id="a19497"></a>[4] Enterprise JavaBeans, v. 2.1.</p>
</li>
<li>
<p><a id="a19498"></a>[5] Jakarta Bean Validation, v. 3.0. <em><a href="https://jakarta.ee/specifications/bean-validation/3.0/" class="bare">https://jakarta.ee/specifications/bean-validation/3.0/</a></em>.</p>
</li>
<li>
<p><a id="a19499"></a>[6] Jakarta EE Platform, v. 9.0. <em><a href="https://jakarta.ee/specifications/platform/9/" class="bare">https://jakarta.ee/specifications/platform/9/</a></em>.</p>
</li>
<li>
<p><a id="a19500"></a>[7] Jakarta Contexts and Dependency Injection, v 3.0. <em><a href="https://jakarta.ee/specifications/cdi/3.0/" class="bare">https://jakarta.ee/specifications/cdi/3.0/</a></em>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="revision-history"><a class="anchor" href="#revision-history"></a>Appendix A: Revision History</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix lists the significant changes that have been made during the development of the Jakarta Persistence specification.</p>
</div>
<div class="sect2">
<h3 id="jakarta-persistence-3-2"><a class="anchor" href="#jakarta-persistence-3-2"></a>A.1. Jakarta Persistence 3.2</h3>
<div class="paragraph">
<p>Added support for Java record types as embeddable classes</p>
</div>
<div class="paragraph">
<p>Added support for <code>java.time.Instant</code> and <code>java.time.Year</code> and clarified JDBC mappings for basic types</p>
</div>
<div class="paragraph">
<p>Added <code>union</code>, <code>intersect</code>, <code>except</code>, <code>cast</code>, <code>left</code>, <code>right</code>, and <code>replace</code> for Jakarta Persistence QL and criteria queries</p>
</div>
<div class="paragraph">
<p>Added <code>||</code> string concatenation operator and <code>id</code> and <code>version</code> functions to Jakarta Persistence QL</p>
</div>
<div class="paragraph">
<p>Added <code>CriteriaSelect</code> to the Criteria API</p>
</div>
<div class="paragraph">
<p>Added <code>extract()</code> to <code>CriteriaBuilder</code></p>
</div>
<div class="paragraph">
<p>Added <code>subquery(EntityType)</code> to <code>CommonAbstractCriteria</code></p>
</div>
<div class="paragraph">
<p>Added support for specifying null precedence when ordering Jakarta Persistence QL and criteria queries</p>
</div>
<div class="paragraph">
<p>Added <code>getSingleResultOrNull()</code> to <code>Query</code>, <code>TypedQuery</code>, <code>StoredProcedureQuery</code></p>
</div>
<div class="paragraph">
<p>Added <code>entities()</code>, <code>classes()</code> and <code>columns()</code> to <code>NamedNativeQuery</code></p>
</div>
<div class="paragraph">
<p>Added <code>lockMode()</code> to <code>EntityResult</code> with the default being <code>OPTIMISTIC</code></p>
</div>
<div class="paragraph">
<p>Added <code>getVersion()</code>, <code>isLoaded()</code>, <code>load()</code>, <code>isInstance()</code> and <code>getClass()</code> methods to <code>PersistenceUnitUtil</code></p>
</div>
<div class="paragraph">
<p>Added overload of <code>entity()</code> accepting an entity name to <code>Metamodel</code></p>
</div>
<div class="paragraph">
<p>Added <code>javax.annotation.processing.Generated</code> to the list of defined annotations on <code>StaticMetamodel</code></p>
</div>
<div class="paragraph">
<p>Added joins on <code>EntityType</code>s</p>
</div>
<div class="paragraph">
<p>Added constants for managed types, named queries, named graphs and named result set mappings to generated <code>StaticMetamodel</code></p>
</div>
<div class="paragraph">
<p>Added <code>LocalDateTime</code> and <code>Instant</code> to supported <code>Version</code> types</p>
</div>
<div class="paragraph">
<p>Added <code>where()</code>, <code>having()</code>, <code>and()</code>, <code>or()</code>, <code>array()</code>, <code>tuple()</code> overloads accepting <code>List</code> to <code>CriteriaQuery</code> and <code>CriteriaBuilder</code></p>
</div>
<div class="paragraph">
<p>Added <code>equalTo()</code> and <code>notEqualTo()</code> to <code>Expression</code></p>
</div>
<div class="paragraph">
<p>Added <code>concat()</code> overload accepting list of expressions to <code>CriteriaBuilder</code></p>
</div>
<div class="paragraph">
<p>Added <code>Graph</code> interface as parent of <code>EntityGraph</code> and <code>Subgraph</code> and moved common operations there</p>
</div>
<div class="paragraph">
<p>Added <code>addAttributeNode()</code>, <code>removeAttributeNode()</code>, <code>addTreatedSubgraph()</code>, <code>addElementSubgraph()</code>, <code>addTreatedElementSubgraph()</code>,
<code>addMapKeySubgraph()</code>, and <code>addTreatedMapKeySubgraph()</code> methods to <code>Graph</code></p>
</div>
<div class="paragraph">
<p>Added <code>find()</code>, <code>refresh()</code>, <code>lock()</code> overloads to <code>EntityManager</code> taking newly introduced <code>FindOption</code>s, <code>RefreshOption</code>s,
and <code>LockOption</code>s respectively</p>
</div>
<div class="paragraph">
<p>Added <code>setCacheStoreMode()</code>, and <code>setCacheRetreiveMode()</code> methods to <code>EntityManager</code> and <code>Query</code></p>
</div>
<div class="paragraph">
<p>Added <code>getReference</code> overload to <code>EntityManager</code></p>
</div>
<div class="paragraph">
<p>Added <code>runWithConnection()</code> and <code>callWithConnection()</code> to <code>EntityManager</code></p>
</div>
<div class="paragraph">
<p>Added <code>runInTransaction()</code> and <code>callInTransaction()</code> to <code>EntityManagerFactory</code></p>
</div>
<div class="paragraph">
<p>Added <code>getName()</code> to <code>EntityManagerFactory</code></p>
</div>
<div class="paragraph">
<p>Added <code>setTimeout(Integer)</code> and <code>getTimeout()</code> to <code>EntityTransaction</code></p>
</div>
<div class="paragraph">
<p>Added programmatic API to obtain <code>EntityManagerFactory</code> using <code>PersistenceConfiguration</code></p>
</div>
<div class="paragraph">
<p>Added constants for properties defined by the specification to the <code>PersistenceConfiguration</code></p>
</div>
<div class="paragraph">
<p>Added <code>SchemaManager</code> API</p>
</div>
<div class="paragraph">
<p>Added options member to elements which result in DDL generation</p>
</div>
<div class="paragraph">
<p>Added <code>EnumeratedValue</code> allowing custom mapping of fields of Java enums</p>
</div>
<div class="paragraph">
<p>Added <code>comment</code> and <code>check</code> members to <code>@Table</code> and <code>@Column</code> annotations, along with <code>@CheckConstraint</code></p>
</div>
<div class="paragraph">
<p>Added <code>secondPrecision</code> to <code>@Column</code> annotation and clarified semantics of <code>@Column</code> members</p>
</div>
<div class="paragraph">
<p>Added factory-level access to named queries and named entity graphs</p>
</div>
<div class="paragraph">
<p>Added integration points for dependency injection</p>
</div>
<div class="paragraph">
<p>Allowed scalar expressions in the <code>ORDER BY</code> clause in Jakarta Persistence QL</p>
</div>
<div class="paragraph">
<p>Made the <code>name</code> member of <code>TableGenerator</code> and <code>SequenceGenerator</code> optional and allow usage of these annotations
at the java package level</p>
</div>
<div class="paragraph">
<p>Made identification variables and the <code>SELECT</code> clause in Jakarta Persistence QL optional</p>
</div>
<div class="paragraph">
<p>Clarified the primary key types supported for each <code>GenerationType</code></p>
</div>
<div class="paragraph">
<p>Clarified availability of <code>SEQUENCE</code>, <code>TABLE</code> and <code>UUID</code> generated IDs on <code>PrePersist</code></p>
</div>
<div class="paragraph">
<p>Clarified semantics of numeric literals and numeric type promotions, and added support for <code>bi</code> and <code>bd</code> suffixes</p>
</div>
<div class="paragraph">
<p>Clarified semantics of <code>Convert</code>/<code>Converter</code> annotations</p>
</div>
<div class="paragraph">
<p>Clarified rules around distinction of entity names and identification variables and case-sensitivity in Jakarta Persistence QL queries</p>
</div>
<div class="paragraph">
<p>Clarified the semantics of <code>Bindable.ENTITY_TYPE</code> in javadoc</p>
</div>
<div class="paragraph">
<p>Clarified the semantics of collection-valued query parameters</p>
</div>
<div class="paragraph">
<p>Entity and embeddable classes may now be static inner classes</p>
</div>
<div class="paragraph">
<p>Primary key classes are no longer required to be public and serializable</p>
</div>
<div class="paragraph">
<p>Pulled <code>getParameters()</code> up from <code>CriteriaQuery</code> to <code>CommonAbstractCriteria</code></p>
</div>
<div class="paragraph">
<p>Updated persistence and object/relational mapping schemas</p>
</div>
<div class="paragraph">
<p>Fixed wildcard types in <code>addSubgraph</code> and <code>addAttributeNode</code> in <code>Graph</code></p>
</div>
<div class="paragraph">
<p>Fixed lower type bounds to the <code>Path.get</code> entity argument <code>X</code></p>
</div>
<div class="paragraph">
<p>Fixed example code in the javadoc of <code>AttributeOverrides</code></p>
</div>
<div class="paragraph">
<p>Fixed <code>maxOccurs</code> of the version element in ORM schema to allow at most one element</p>
</div>
<div class="paragraph">
<p>Partially fixed raw types warnings through the API</p>
</div>
<div class="paragraph">
<p>Improved AsciiDoc formatting and fixed typos through the specification document</p>
</div>
<div class="sect3">
<h4 id="deprecations"><a class="anchor" href="#deprecations"></a>A.1.1. Deprecations</h4>
<div class="paragraph">
<p>Deprecated usage of <code>Calendar</code>, <code>Date</code>, <code>Time</code>, <code>Timestamp</code>, <code>Temporal</code>, <code>MapKeyTemporal</code> and <code>TemporalType</code>
in new applications in favour of <code>java.time</code> API</p>
</div>
<div class="paragraph">
<p>Deprecated use of <code>Byte[]</code> and <code>Character[]</code> arrays types for basic attributes, in favor of primitive array types</p>
</div>
<div class="paragraph">
<p>Deprecated <code>multiselect</code> methods in <code>CriteriaQuery</code>. The preference is to use <code>array</code> or <code>tuple</code> method defined in <code>CriteriaBuilder</code></p>
</div>
</div>
<div class="sect3">
<h4 id="deprecations-for-removal"><a class="anchor" href="#deprecations-for-removal"></a>A.1.2. Deprecations for removal</h4>
<div class="paragraph">
<p>Deprecated <code>addSubclassSubgraph()</code> in <code>EntityGraph</code> for removal; <code>addTreatedSubgraph()</code> method should be used as direct replacement</p>
</div>
<div class="paragraph">
<p>Deprecated <code>addSubgraph(Attribute, Class)</code> and <code>addKeySubgraph()</code> in <code>Graph</code>/<code>EntityGraph</code>/<code>SubGraph</code> for removal; <code>addTreatedSubgraph(Attribute, Class)</code>
and <code>addMapKeySubgraph()</code> methods should be used as direct replacements</p>
</div>
<div class="paragraph">
<p>Deprecated <code>jakarta.persistence.spi.PersistenceUnitTransactionType</code> for removal; <code>jakarta.persistence.PersistenceUnitTransactionType</code>
methods should be used as direct replacement</p>
</div>
<div class="paragraph">
<p>Deprecated default public no-arg constructor in <code>jakarta.persistence.Persistence</code> and <code>PERSISTENCE_PROVIDER</code> and <code>providers</code> fields
in this class for removal with no replacement. This class is not designed for extensibility</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jakarta-persistence-3-1"><a class="anchor" href="#jakarta-persistence-3-1"></a>A.2. Jakarta Persistence 3.1</h3>
<div class="paragraph">
<p><code>EntityManagerFactory</code> and <code>EntityManager</code> interfaces extend <code>java.lang.AutoCloseable</code> interface</p>
</div>
<div class="paragraph">
<p>Fixed <code>ClassTransformer.transform</code> to throw Persistence API specific exception</p>
</div>
<div class="paragraph">
<p>Added support for <code>java.util.UUID</code> and <code>GenerationType.UUID</code></p>
</div>
<div class="paragraph">
<p>Added <code>CEILING</code>, <code>EXP</code>, <code>FLOOR</code>, <code>LN</code>, <code>POWER</code>, <code>ROUND</code>, and <code>SIGN</code>
numeric functions to Jakarta Persistence QL and <code>ceiling()</code>, <code>exp()</code>,
<code>floor()</code>, <code>ln()</code>, <code>power()</code>,  <code>round()</code>, and <code>sign()</code> to Criteria API</p>
</div>
<div class="paragraph">
<p>Added <code>LOCAL DATE</code>, <code>LOCAL DATETIME</code>, and <code>LOCAL TIME</code> functions to Jakarta Persistence QL and
corresponding <code>localDate()</code>, <code>localDateTime()</code>, and <code>localTime()</code> to Criteria API</p>
</div>
<div class="paragraph">
<p>Added <code>EXTRACT</code> function to Jakarta Persistence QL</p>
</div>
<div class="paragraph">
<p>Added support for <code>Expression</code>s as conditions in <code>Criteria</code> <code>CASE</code> expressions</p>
</div>
<div class="paragraph">
<p>Clarified mixing types of query input parameters</p>
</div>
<div class="paragraph">
<p>Added missing definition of <code>single_valued_embeddable_object_field</code> in Jakarta Persistence QL BNF</p>
</div>
<div class="paragraph">
<p>Clarified definition of the <code>Basic</code> type</p>
</div>
<div class="paragraph">
<p>Clarified the order of parameters in the <code>LOCATE</code> function</p>
</div>
<div class="paragraph">
<p>Clarified <code>SqlResultSetMapping</code> with multiple <code>EntityResult</code>s and conflicting aliases</p>
</div>
</div>
<div class="sect2">
<h3 id="jakarta-persistence-3-0"><a class="anchor" href="#jakarta-persistence-3-0"></a>A.3. Jakarta Persistence 3.0</h3>
<div class="paragraph">
<p>Created document from Java Persistence 2.2 Final Release specification.</p>
</div>
<div class="paragraph">
<p>The document was converted to <code>Asciidoc</code> format.</p>
</div>
<div class="paragraph">
<p>Packages of all API classes were changed to <code>jakarta.persistence</code>. These changes are reflected in the specification document.</p>
</div>
<div class="paragraph">
<p>Schema namespaces were changed from <a href="http://xmlns.jcp.org/xml/ns/persistence" class="bare">http://xmlns.jcp.org/xml/ns/persistence</a> and <a href="http://xmlns.jcp.org/xml/ns/persistence/orm" class="bare">http://xmlns.jcp.org/xml/ns/persistence/orm</a>
to <a href="https://jakarta.ee/xml/ns/persistence" class="bare">https://jakarta.ee/xml/ns/persistence</a> and <a href="https://jakarta.ee/xml/ns/persistence/orm" class="bare">https://jakarta.ee/xml/ns/persistence/orm</a></p>
</div>
<div class="paragraph">
<p>References to schema versions lower than 2.2 were removed.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-persistence-2-2-maintenance-release-draft"><a class="anchor" href="#java-persistence-2-2-maintenance-release-draft"></a>A.4. Java Persistence 2.2 (Maintenance Release Draft)</h3>
<div class="paragraph">
<p>Created document from Java Persistence 2.1
Final Release specification.</p>
</div>
<div class="paragraph">
<p>The following annotations have been marked <code>@Repeatable</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AssociationOverride</code></p>
</li>
<li>
<p><code>AttributeOverride</code></p>
</li>
<li>
<p><code>Convert</code></p>
</li>
<li>
<p><code>JoinColumn</code></p>
</li>
<li>
<p><code>MapKeyJoinColumn</code></p>
</li>
<li>
<p><code>NamedEntityGraph</code></p>
</li>
<li>
<p><code>NamedNativeQuery</code></p>
</li>
<li>
<p><code>NamedQuery</code></p>
</li>
<li>
<p><code>NamedStoredProcedureQuery</code></p>
</li>
<li>
<p><code>PersistenceContext</code></p>
</li>
<li>
<p><code>PersistenceUnit</code></p>
</li>
<li>
<p><code>PrimaryKeyJoinColumn</code></p>
</li>
<li>
<p><code>SecondaryTable</code></p>
</li>
<li>
<p><code>SqlResultSetMapping</code></p>
</li>
<li>
<p><code>SequenceGenerator</code></p>
</li>
<li>
<p><code>TableGenerator</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Added <code>SequenceGenerators</code> and <code>TableGenerators</code> annotations.</p>
</div>
<div class="paragraph">
<p>Added support for CDI injection into
<code>AttributeConverter</code> classes.</p>
</div>
<div class="paragraph">
<p>Added support for the mapping of the following java.time types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.time.LocalDate</code></p>
</li>
<li>
<p><code>java.time.LocalTime</code></p>
</li>
<li>
<p><code>java.time.LocalDateTime</code></p>
</li>
<li>
<p><code>java.time.OffsetTime</code></p>
</li>
<li>
<p><code>java.time.OffsetDateTime</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Added default <code>Stream getResultStream()</code> method
to Query interface.</p>
</div>
<div class="paragraph">
<p>Added default <code>Stream&lt;X&gt; getResultStream()</code>
method to TypedQuery interface.</p>
</div>
<div class="paragraph">
<p>Replaced reference to JAR file specification
in persistence provider bootstrapping section with more general
reference to Java SE service provider requirements.</p>
</div>
<div class="paragraph">
<p>Updated persistence.xml and orm.xml schemas to 2.2 versions.</p>
</div>
<div class="paragraph">
<p>Updated Related Documents.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="persistence-api"><a class="anchor" href="#persistence-api"></a>Appendix B: Persistence API Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following APIs are defined in the package <code>jakarta.persistence</code>.</p>
</div>
<div class="sect2">
<h3 id="_entitymanager_"><a class="anchor" href="#_entitymanager_"></a>B.1. <code>EntityManager</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaSelect</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Metamodel</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaBuilder</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaQuery</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaUpdate</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaDelete</span>;

<span class="comment">/**
 * Interface used to interact with the persistence context.
 *
 * &lt;p&gt;An instance of {@code EntityManager} must be obtained from
 * an {@link EntityManagerFactory}, and is only able to manage
 * persistence of entities belonging to the associated persistence
 * unit.
 *
 * &lt;p&gt;An application-managed {@code EntityManager} may be created
 * via a call to {@link EntityManagerFactory#createEntityManager()}.
 * The {@code EntityManager} must be explicitly closed via a call
 * to {@link #close()}, to allow resources to be cleaned up by the
 * persistence provider. This approach places almost complete
 * responsibility for cleanup and exception management on the client,
 * and is thus considered quite error-prone. It is much safer to use
 * the methods {@link EntityManagerFactory#runInTransaction} and
 * {@link EntityManagerFactory#callInTransaction}.
 * {@snippet :
 * entityManagerFactory.runInTransaction(entityManager -&gt; {
 *     // do work in a persistence context
 *     ...
 * });
 * }
 *
 * &lt;p&gt;In the Jakarta EE environment, a container-managed
 * {@link EntityManager} may be obtained by dependency injection,
 * using {@link PersistenceContext}.
 * {@snippet :
 * // inject the container-managed entity manager
 * @PersistenceContext(unitName=&quot;orderMgt&quot;)
 * EntityManager entityManager;
 * }
 *
 * &lt;p&gt;If the persistence unit has
 * {@linkplain PersistenceUnitTransactionType#RESOURCE_LOCAL
 * resource local} transaction management, transactions must
 * be managed using the {@link EntityTransaction} obtained by
 * calling {@link #getTransaction()}.
 *
 * &lt;p&gt;A complete idiom for custom application management of
 * the {@link EntityManager} and its associated resource-local
 * {@link EntityTransaction} is as follows:
 * {@snippet :
 * EntityManager entityManager = entityManagerFactory.createEntityManager();
 * EntityTransaction transaction = entityManager.getTransaction();
 * try {
 *     transaction.begin();
 *     // do work
 *     ...
 *     transaction.commit();
 * }
 * catch (Exception e) {
 *     if (transaction.isActive()) transaction.rollback();
 *     throw e;
 * }
 * finally {
 *     entityManager.close();
 * }
 * }
 *
 * &lt;p&gt;Each {@code EntityManager} instance is associated with a
 * distinct &lt;em&gt;persistence context&lt;/em&gt;. A persistence context
 * is a set of entity instances in which for any given persistent
 * entity identity (defined by an entity type and primary key)
 * there is at most one entity instance. The entity instances
 * associated with a persistence context are considered managed
 * objects, with a well-defined lifecycle under the control of
 * the persistence provider.
 *
 * &lt;p&gt;Any entity instance can be characterized as being in one of
 * the following lifecycle states:
 * &lt;ul&gt;
 * &lt;li&gt;A &lt;em&gt;new&lt;/em&gt; entity has no persistent identity, and is
 *     not yet associated with any persistence context.
 * &lt;li&gt;A &lt;em&gt;managed&lt;/em&gt; entity is an instance with a persistent
 *     identity that is currently associated with a persistence
 *     context.
 * &lt;li&gt;A &lt;em&gt;detached&lt;/em&gt; entity is an instance with a persistent
 *     identity that is not (or no longer) associated with any
 *     active persistence context.
 * &lt;li&gt;A &lt;em&gt;removed&lt;/em&gt; entity is an instance with a persistent
 *     identity, and associated with a persistence context, that
 *     is scheduled for removal from the database upon transaction
 *     commit.
 * &lt;/ul&gt;
 *
 * &lt;p&gt;The {@code EntityManager} API is used to perform operations
 * that affect the state of the persistence context, or that modify
 * the lifecycle state of individual entity instances. The client
 * may {@linkplain #persist} and {@linkplain #remove} instances,
 * {@linkplain #find(Class, Object) find} entities by their primary
 * key, and execute {@linkplain #createQuery(String) queries} which
 * range over entity types. An entity may be disassociated from
 * the persistence context by calling {@link #detach}, and a
 * persistence context may be completely cleared, detaching all
 * its entities, by calling {@link #clear()}.
 *
 * &lt;p&gt;The client may also make changes to the state of an entity
 * instance by mutating the entity directly, or it may request
 * that the state of a detached instance be {@linkplain #merge
 * merged}, replacing the state of a managed instance with the
 * same persistent identity. Note that there is no explicit
 * &quot;update&quot; operation; since an entity is a managed object,
 * modifications to its persistent fields and properties are
 * automatically detected, as long as it is associated with an
 * active persistence context.
 *
 * &lt;p&gt;Modifications to the state of entities associated with a
 * persistence context are not immediately synchronized with the
 * database. Synchronization happens during a process called
 * &lt;em&gt;flush&lt;/em&gt;. The timing of the flush process depends on the
 * {@linkplain FlushModeType flush mode}, which may be set
 * explicitly by calling {@link #setFlushMode(FlushModeType)}.
 * &lt;ul&gt;
 * &lt;li&gt;For {@link FlushModeType#COMMIT}, the persistence context
 *     is flushed before the transaction commits.
 * &lt;li&gt;For {@link FlushModeType#AUTO}, which is the default, the
 *     persistence context must also be flushed before execution
 *     of any query whose result set would be affected by
 *     unflushed modifications to entities associated with the
 *     persistence context.
 * &lt;/ul&gt;
 * The client may force an immediate flush to occur by calling
 * {@link #flush()}.
 *
 * &lt;p&gt;At any given moment, a persistence context might hold an
 * optimistic or pessimistic &lt;em&gt;lock&lt;/em&gt; on an entity instance.
 * The full range of possible lock types is enumerated by
 * {@link LockModeType}. Some operations of this interface,
 * including the methods {@link #lock(Object, LockModeType)},
 * {@link #refresh(Object, LockModeType)}, and
 * {@link #find(Class, Object, LockModeType)}, accept an explicit
 * {@link LockModeType}, allowing the client to request a specific
 * type of lock.
 *
 * &lt;p&gt;Interaction of the persistence context (or first-level cache)
 * with the second-level cache, if any, may be controlled by
 * calling {@link #setCacheRetrieveMode(CacheRetrieveMode)} and
 * {@link #setCacheStoreMode(CacheStoreMode)}.
 *
 * &lt;p&gt;Some operations accept one or more built-in and vendor-specific
 * options:
 * &lt;ul&gt;
 * &lt;li&gt;{@link #find(Class, Object, FindOption...)} and 
 *     {@link #find(EntityGraph, Object, FindOption...)} accept
 *     {@link FindOption}s,
 * &lt;li&gt;{@link #refresh(Object, RefreshOption...)} accepts
 *     {@link RefreshOption}s, and
 * &lt;li&gt;{@link #lock(Object, LockModeType, LockOption...)} accepts
 *     {@link LockOption}s.
 * &lt;/ul&gt;
 *
 * @see Query
 * @see TypedQuery
 * @see CriteriaQuery
 * @see PersistenceContext
 * @see StoredProcedureQuery
 * @see EntityManagerFactory
 * 
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityManager</span> <span class="directive">extends</span> AutoCloseable {

    <span class="comment">/**
     * Make a new entity instance managed and persistent, resulting in
     * its insertion in the database when the persistence context is
     * synchronized with the database, or make a removed entity managed,
     * undoing the effect of a previous call to {@link #remove(Object)}.
     * This operation cascades to every entity related by an association
     * marked {@link CascadeType#PERSIST cascade=PERSIST}. If the given
     * entity instance is already managed, that is, if it already belongs
     * to this persistence context, and has not been marked for removal,
     * it is itself ignored, but the operation still cascades.
     * @param entity  a new, managed, or removed entity instance
     * @throws EntityExistsException if the given entity is detached
     * (if the entity is detached, the {@code EntityExistsException}
     * may be thrown when the persist operation is invoked, or the
     * {@code EntityExistsException} or another {@code PersistenceException}
     * may be thrown at flush or commit time)
     * @throws IllegalArgumentException if the given instance is not an
     *         entity
     * @throws TransactionRequiredException if there is no transaction
     *         when invoked on a container-managed entity manager that
     *         is of type {@link PersistenceContextType#TRANSACTION}
     */</span>
    <span class="type">void</span> persist(<span class="predefined-type">Object</span> entity);
    
    <span class="comment">/**
     * Merge the state of the given new or detached entity instance
     * into the current persistence context, resulting in, respectively,
     * an insert or possible update when the persistence context is
     * synchronized with the database. Return a managed instance with
     * the same persistent state as the given entity instance, but a
     * distinct Java object identity. If the given entity is detached,
     * the returned entity has the same persistent identity. This
     * operation cascades to every entity related by an association
     * marked {@link CascadeType#MERGE cascade=MERGE}. If the given
     * entity instance is managed, that is, if it belongs to this
     * persistence context, and has not been marked for removal, it is
     * itself ignored, but the operation still cascades, and it is
     * returned directly.
     * @param entity  a new, managed, or detached entity instance
     * @return the managed instance that the state was merged to
     * @throws IllegalArgumentException if the instance is not an entity
     *         or is a removed entity
     * @throws TransactionRequiredException if there is no transaction
     *         when invoked on a container-managed entity manager of
     *         that is of type {@link PersistenceContextType#TRANSACTION}
     */</span>
    &lt;T&gt; T merge(T entity);

    <span class="comment">/**
     * Mark a managed entity instance as removed, resulting in its deletion
     * from the database when the persistence context is synchronized with
     * the database. This operation cascades to every entity related by an
     * association marked {@link CascadeType#REMOVE cascade=REMOVE}. If the
     * given entity instance is already removed, it is ignored. If the
     * given entity is new, it is itself ignored, but the operation still
     * cascades.
     * @param entity  a managed, new, or removed entity instance
     * @throws IllegalArgumentException if the instance is not an entity
     *         or is a detached entity
     * @throws TransactionRequiredException if invoked on a
     *         container-managed entity manager of type
     *         {@link PersistenceContextType#TRANSACTION} and there is
     *         no transaction
     */</span>
    <span class="type">void</span> remove(<span class="predefined-type">Object</span> entity);
    
    <span class="comment">/**
     * Find by primary key.
     * Search for an entity of the specified class and primary key.
     * If the entity instance is contained in the persistence context,
     * it is returned from there.
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or if the second argument is
     *         not a valid type for that entity's primary key or is
     *         null
     */</span>
    &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey);
    
    <span class="comment">/**
     * Find by primary key, using the specified properties. 
     * Search for an entity of the specified class and primary key. 
     * If the entity instance is contained in the persistence 
     * context, it is returned from there. 
     * If a vendor-specific property or hint is not recognized, 
     * it is silently ignored. 
     * @param entityClass  entity class
     * @param primaryKey   primary key
     * @param properties  standard and vendor-specific properties 
     *        and hints
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if the first argument does 
     *         not denote an entity type or if the second argument
     *         is not a valid type for that entity's primary key or
     *         is null
     * @since 2.0
     */</span>
    &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey,
               <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);
    
    <span class="comment">/**
     * Find by primary key and obtain the given lock type for the
     * resulting entity. Search for an entity of the specified class and
     * primary key, and lock it with respect to the specified lock type.
     * If the entity instance is contained in the persistence context,
     * it is returned from there, and the effect of this method is the
     * same as if the {@link #lock} method had been called on the entity.
     * &lt;p&gt; If the entity is found within the persistence context and
     * the lock mode type is pessimistic and the entity has a version
     * attribute, the persistence provider must perform optimistic
     * version checks when obtaining the database lock. If these checks
     * fail, the {@link OptimisticLockException} is thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @param lockMode  lock mode
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or the second argument is
     *         not a valid type for that entity's primary key or
     *         is null
     * @throws TransactionRequiredException if there is no 
     *         transaction and a lock mode other than {@code NONE} is
     *         specified or if invoked on an entity manager which has
     *         not been joined to the current transaction and a lock
     *         mode other than {@code NONE} is specified
     * @throws OptimisticLockException if the optimistic version 
     *         check fails
     * @throws PessimisticLockException if pessimistic locking 
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 2.0
     */</span>
    &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey,
               LockModeType lockMode);

    <span class="comment">/**
     * Find by primary key and lock the entity, using the specified
     * properties. Search for an entity of the specified class and
     * primary key, and lock it with respect to the specified lock type.
     * If the entity instance is contained in the persistence context,
     * it is returned from there.  
     * &lt;p&gt; If the entity is found within the persistence context and
     * the lock mode type is pessimistic and the entity has a version
     * attribute, the persistence provider must perform optimistic
     * version checks when obtaining the database lock. If these checks
     * fail, the {@link OptimisticLockException} is thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific property or hint is not recognized, 
     * it is silently ignored.  
     * &lt;p&gt;Portable applications should not rely on the standard
     * timeout hint. Depending on the database in use and the locking
     * mechanisms used by the provider, the hint may or may not be
     * observed.
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @param lockMode  lock mode
     * @param properties  standard and vendor-specific properties
     *        and hints
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or the second argument is
     *         not a valid type for that entity's primary key or
     *         is null
     * @throws TransactionRequiredException if there is no 
     *         transaction and a lock mode other than {@code NONE} is
     *         specified or if invoked on an entity manager which has
     *         not been joined to the current transaction and a lock
     *         mode other than {@code NONE} is specified
     * @throws OptimisticLockException if the optimistic version check
     *         fails
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *        only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 2.0
     */</span>
    &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey,
               LockModeType lockMode,
               <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Find an instance of the given entity class by primary key,
     * using the specified {@linkplain FindOption options}.
     * Search for an entity with the specified class and primary key.
     * If the given options include a {@link LockModeType}, lock it
     * with respect to the specified lock type.
     * If the entity instance is contained in the persistence context,
     * it is returned from there.
     * &lt;p&gt;If the entity is found within the persistence context and
     * the lock mode type is pessimistic and the entity has a version
     * attribute, the persistence provider must perform optimistic
     * version checks when obtaining the database lock.  If these checks
     * fail, the {@code OptimisticLockException} is thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@code PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level
     *     rollback
     * &lt;li&gt;the {@code LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific {@linkplain FindOption option} is not
     * recognized, it is silently ignored.
     * &lt;p&gt;Portable applications should not rely on the standard
     * {@linkplain Timeout timeout option}. Depending on the database
     * in use and the locking mechanisms used by the provider, this
     * option may or may not be observed.
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @param options  standard and vendor-specific options
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if there are contradictory
     *         options, if the first argument does not denote an entity
     *         type belonging to the persistence unit, or if the second
     *         argument is not a valid non-null instance of the entity
     *         primary key type
     * @throws TransactionRequiredException if there is no transaction
     *         and a lock mode other than {@code NONE} is
     *         specified or if invoked on an entity manager which has
     *         not been joined to the current transaction and a lock
     *         mode other than {@code NONE} is specified
     * @throws OptimisticLockException if the optimistic version check
     *         fails
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 3.2
     */</span>
    &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey,
               FindOption... options);

    <span class="comment">/**
     * Find an instance of the root entity of the given {@link EntityGraph}
     * by primary key, using the specified {@linkplain FindOption options},
     * and interpreting the {@code EntityGraph} as a load graph.
     * Search for an entity with the specified type and primary key.
     * If the given options include a {@link LockModeType}, lock it
     * with respect to the specified lock type.
     * If the entity instance is contained in the persistence context,
     * it is returned from there.
     * &lt;p&gt; If the entity is found within the persistence context and
     * the lock mode type is pessimistic and the entity has a version
     * attribute, the persistence provider must perform optimistic
     * version checks when obtaining the database lock. If these checks
     * fail, the {@code OptimisticLockException} is thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific {@linkplain FindOption option} is not
     * recognized, it is silently ignored.
     * &lt;p&gt;Portable applications should not rely on the standard
     * {@linkplain Timeout timeout option}. Depending on the database
     * in use and the locking mechanisms used by the provider, this
     * option may or may not be observed.
     * @param entityGraph  entity graph interpreted as a load graph
     * @param primaryKey  primary key
     * @param options  standard and vendor-specific options
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if there are contradictory
     *         options, if the first argument does not denote an entity
     *         type belonging to the persistence unit, or if the second
     *         argument is not a valid non-null instance of the entity
     *         primary key type
     * @throws TransactionRequiredException if there is no transaction
     *         and a lock mode other than {@code NONE} is
     *         specified or if invoked on an entity manager which has
     *         not been joined to the current transaction and a lock
     *         mode other than {@code NONE} is specified
     * @throws OptimisticLockException if the optimistic version check
     *         fails
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 3.2
     */</span>
    &lt;T&gt; T find(EntityGraph&lt;T&gt; entityGraph, <span class="predefined-type">Object</span> primaryKey,
               FindOption... options);

    <span class="comment">/**
     * Obtain a reference to an instance of the given entity class
     * with the given primary key, whose state may be lazily fetched.
     * &lt;p&gt;If the requested instance does not exist in the database,
     * the {@link EntityNotFoundException} is thrown when the
     * instance state is first accessed.
     * (The persistence provider runtime is permitted but not
     * required to throw the {@code EntityNotFoundException} when
     * {@code getReference()} is called.)
     * &lt;p&gt;This operation allows the application to create an
     * association to an entity without loading its state from the
     * database.
     * &lt;p&gt;The application should not expect the instance state to
     * be available upon detachment, unless it was accessed by the
     * application while the entity manager was open.
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @return a reference to the entity instance
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or the second argument is
     *         not a valid type for that entity's primary key or
     *         is null
     * @throws EntityNotFoundException if the entity state cannot
     *         be accessed
     */</span>
    &lt;T&gt; T getReference(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey);

    <span class="comment">/**
     * Obtain a reference to an instance of the entity class of the
     * given object, with the same primary key as the given object,
     * whose state may be lazily fetched. The given object may be
     * persistent or detached, but may be neither new nor removed.
     * &lt;p&gt;If the requested instance does not exist in the database,
     * the {@link EntityNotFoundException} is thrown when the
     * instance state is first accessed.
     * (The persistence provider runtime is permitted but not
     * required to throw the {@code EntityNotFoundException} when
     * {@code getReference()} is called.)
     * &lt;p&gt;This operation allows the application to create an
     * association to an entity without loading its state from the
     * database.
     * &lt;p&gt;The application should not expect the instance state to
     * be available upon detachment, unless it was accessed by the
     * application while the entity manager was open.
     * @param entity  a persistent or detached entity instance
     * @return a reference to the entity instance
     * @throws IllegalArgumentException if the given object is not
     *         an entity, or if it is neither persistent nor detached
     * @throws EntityNotFoundException if the entity state cannot be
     *         accessed
     */</span>
    &lt;T&gt; T getReference(T entity);

    <span class="comment">/**
     * Synchronize changes held in the persistence context to the
     * underlying database.
     * @throws TransactionRequiredException if there is
     *        no transaction or if the entity manager has not been
     *        joined to the current transaction
     * @throws PersistenceException if the flush fails
     */</span>
    <span class="type">void</span> flush();

    <span class="comment">/**
     * Set the {@linkplain FlushModeType flush mode} that applies to
     * all objects contained in the persistence context.
     * @param flushMode  flush mode
     */</span>
    <span class="type">void</span> setFlushMode(FlushModeType flushMode);

    <span class="comment">/**
     * Get the {@linkplain FlushModeType flush mode} that applies to
     * all objects contained in the persistence context.
     * @return the current {@link FlushModeType}
     */</span>
    FlushModeType getFlushMode();

    <span class="comment">/**
     * Lock an entity instance belonging to the persistence context,
     * obtaining the specified {@linkplain LockModeType lock mode}.
     * &lt;p&gt;If a pessimistic lock mode type is specified and the entity
     * contains a version attribute, the persistence provider must 
     * also perform optimistic version checks when obtaining the 
     * database lock. If these checks fail, the
     * {@link OptimisticLockException} is thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * @param entity  a managed entity instance
     * @param lockMode  lock mode
     * @throws IllegalArgumentException if the instance is not an
     *         entity or is a detached entity
     * @throws TransactionRequiredException if there is no 
     *         transaction or if invoked on an entity manager which
     *         has not been joined to the current transaction
     * @throws EntityNotFoundException if the entity does not exist 
     *         in the database when pessimistic locking is
     *         performed
     * @throws OptimisticLockException if the optimistic version check
     *         fails
     * @throws PessimisticLockException if pessimistic locking fails 
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     */</span>
    <span class="type">void</span> lock(<span class="predefined-type">Object</span> entity, LockModeType lockMode);

    <span class="comment">/**
     * Lock an entity instance belonging to the persistence context,
     * obtaining the specified {@linkplain LockModeType lock mode},
     * using the specified properties.
     * &lt;p&gt;If a pessimistic lock mode type is specified and the entity
     * contains a version attribute, the persistence provider must 
     * also perform optimistic version checks when obtaining the 
     * database lock. If these checks fail, the
     * {@link OptimisticLockException} is thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} ia thrown if the database
     *     locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific property or hint is not recognized, 
     * it is silently ignored.  
     * &lt;p&gt;Portable applications should not rely on the standard
     * timeout hint. Depending on the database in use and the locking
     * mechanisms used by the provider, the hint may or may not be
     * observed.
     * @param entity  a managed entity instance
     * @param lockMode  lock mode
     * @param properties  standard and vendor-specific properties
     *        and hints
     * @throws IllegalArgumentException if the instance is not an
     *         entity or is a detached entity
     * @throws TransactionRequiredException if there is no 
     *         transaction or if invoked on an entity manager which
     *         has not been joined to the current transaction
     * @throws EntityNotFoundException if the entity does not exist 
     *         in the database when pessimistic locking is performed
     * @throws OptimisticLockException if the optimistic version check
     *         fails
     * @throws PessimisticLockException if pessimistic locking fails 
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 2.0
     */</span>
    <span class="type">void</span> lock(<span class="predefined-type">Object</span> entity, LockModeType lockMode,
              <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Lock an entity instance belonging to the persistence context,
     * obtaining the specified {@linkplain LockModeType lock mode},
     * using the specified {@linkplain LockOption options}.
     * &lt;p&gt;If a pessimistic lock mode type is specified and the entity
     * contains a version attribute, the persistence provider must
     * also perform optimistic version checks when obtaining the
     * database lock. If these checks fail, the
     * {@link OptimisticLockException} is thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific {@link LockOption} is not recognized,
     * it is silently ignored.
     * &lt;p&gt;Portable applications should not rely on the standard
     * {@linkplain Timeout timeout option}. Depending on the database
     * in use and the locking mechanisms used by the provider, the
     * option may or may not be observed.
     * @param entity  a managed entity instance
     * @param lockMode  lock mode
     * @param options  standard and vendor-specific options
     * @throws IllegalArgumentException if the instance is not an
     *         entity or is a detached entity
     * @throws TransactionRequiredException if there is no
     *         transaction or if invoked on an entity manager which
     *         has not been joined to the current transaction
     * @throws EntityNotFoundException if the entity does not exist
     *         in the database when pessimistic locking is
     *         performed
     * @throws OptimisticLockException if the optimistic version
     *         check fails
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 3.2
     */</span>
    <span class="type">void</span> lock(<span class="predefined-type">Object</span> entity, LockModeType lockMode,
              LockOption... options);

    <span class="comment">/**
     * Refresh the state of the given managed entity instance from
     * the database, overwriting unflushed changes made to the entity,
     * if any. This operation cascades to every entity related by an
     * association marked {@link CascadeType#REFRESH cascade=REFRESH}.
     * @param entity  a managed entity instance
     * @throws IllegalArgumentException if the instance is not
     *         an entity or the entity is not managed
     * @throws TransactionRequiredException if there is no
     *         transaction when invoked on a container-managed
     *         entity manager of type
     *         {@link PersistenceContextType#TRANSACTION}
     * @throws EntityNotFoundException if the entity no longer
     *        exists in the database
     */</span>
    <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Refresh the state of the given managed entity instance from
     * the database, using the specified properties, and overwriting
     * unflushed changes made to the entity, if any. This operation
     * cascades to every entity related by an association marked
     * {@link CascadeType#REFRESH cascade=REFRESH}.
     * &lt;p&gt;If a vendor-specific property or hint is not recognized,
     * it is silently ignored. 
     * @param entity  a managed entity instance
     * @param properties  standard and vendor-specific properties 
     *        and hints
     * @throws IllegalArgumentException if the instance is not 
     *         an entity or the entity is not managed
     * @throws TransactionRequiredException if there is no
     *         transaction when invoked on a container-managed
     *         entity manager of type
     *         {@link PersistenceContextType#TRANSACTION}
     * @throws EntityNotFoundException if the entity no longer 
     *         exists in the database
     * @since 2.0
     */</span>
    <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity,
                 <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Refresh the state of the given managed entity instance from
     * the database, overwriting unflushed changes made to the entity,
     * if any, and obtain the given {@linkplain LockModeType lock mode}.
     * This operation cascades to every entity related by an association
     * marked {@link CascadeType#REFRESH cascade=REFRESH}.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback.
     * &lt;/ul&gt;
     * @param entity  a managed entity instance
     * @param lockMode  lock mode
     * @throws IllegalArgumentException if the instance is not an entity
     *         or if the entity is not managed
     * @throws TransactionRequiredException if invoked on a 
     *         container-managed entity manager of type
     *         {@link PersistenceContextType#TRANSACTION} when there is
     *         no transaction; if invoked on an extended entity manager
     *         when there is no transaction and a lock mode other than
     *         {@link LockModeType#NONE} was specified; or if invoked
     *         on an extended entity manager that has not been joined
     *         to the current transaction and any lock mode other than
     *         {@code NONE} was specified
     * @throws EntityNotFoundException if the entity no longer exists
     *         in the database
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 2.0
     */</span>
    <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity, LockModeType lockMode);

    <span class="comment">/**
     * Refresh the state of the given managed entity instance from
     * the database, overwriting unflushed changes made to the entity,
     * if any, and obtain the given {@linkplain LockModeType lock mode},
     * using the specified properties. This operation cascades to every
     * entity related by an association marked {@link CascadeType#REFRESH
     * cascade=REFRESH}.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback.
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific property or hint is not recognized, 
     * it is silently ignored.
     * &lt;p&gt;Portable applications should not rely on the standard
     * timeout hint. Depending on the database in use and the locking
     * mechanisms used by the provider, the hint may or may not be
     * observed.
     * @param entity  a managed entity instance
     * @param lockMode  lock mode
     * @param properties  standard and vendor-specific properties
     *        and hints
     * @throws IllegalArgumentException if the instance is not an
     *         entity or if the entity is not managed
     * @throws TransactionRequiredException if invoked on a 
     *         container-managed entity manager of type
     *         {@link PersistenceContextType#TRANSACTION} when there is
     *         no transaction; if invoked on an extended entity manager
     *         when there is no transaction and a lock mode other than
     *         {@link LockModeType#NONE} was specified; or if invoked
     *         on an extended entity manager that has not been joined
     *         to the current transaction and any lock mode other than
     *         {@code NONE} was specified
     * @throws EntityNotFoundException if the entity no longer exists
     *        in the database
     * @throws PessimisticLockException if pessimistic locking fails
     *        and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *        only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 2.0
     */</span>
    <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity, LockModeType lockMode,
                 <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Refresh the state of the given managed entity instance from the
     * database, using the specified {@linkplain RefreshOption options},
     * overwriting changes made to the entity, if any. If the supplied
     * options include a {@link LockModeType}, lock the given entity,
     * obtaining the given lock mode. This operation cascades to every
     * entity related by an association marked {@link CascadeType#REFRESH
     * cascade=REFRESH}.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance is
     * found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt;the {@link PessimisticLockException} is thrown if the
     *     database locking failure causes transaction-level rollback
     * &lt;li&gt;the {@link LockTimeoutException} is thrown if the database
     *     locking failure causes only statement-level rollback.
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific {@link RefreshOption} is not recognized,
     * it is silently ignored.
     * &lt;p&gt;Portable applications should not rely on the standard
     * {@linkplain Timeout timeout option}. Depending on the database in
     * use and the locking mechanisms used by the provider, the hint may
     * or may not be observed.
     * @param entity  a managed entity instance
     * @param options  standard and vendor-specific options
     * @throws IllegalArgumentException if the instance is not an entity
     *         or if the entity is not managed
     * @throws TransactionRequiredException if invoked on a
     *         container-managed entity manager of type
     *         {@link PersistenceContextType#TRANSACTION} when there is
     *         no transaction; if invoked on an extended entity manager
     *         when there is no transaction and a lock mode other than
     *         {@link LockModeType#NONE} was specified; or if invoked
     *         on an extended entity manager that has not been joined
     *         to the current transaction and any lock mode other than
     *         {@code NONE} was specified
     * @throws EntityNotFoundException if the entity no longer exists in
     *         the database
     * @throws PessimisticLockException if pessimistic locking fails and
     *         the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and only
     *         the statement is rolled back
     * @throws PersistenceException if an unsupported lock call is made
     * @since 3.2
     */</span>
    <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity,
                 RefreshOption... options);

    <span class="comment">/**
     * Clear the persistence context, causing all managed entities to
     * become detached. Changes made to entities that have not already
     * been flushed to the database will never be made persistent.
     */</span>
    <span class="type">void</span> clear();

    <span class="comment">/**
     * Evict the given managed or removed entity from the persistence
     * context, causing the entity to become immediately detached.
     * Unflushed changes made to the entity, if any, including deletion
     * of the entity, will never be synchronized to the database.
     * Managed entities which reference the given entity continue to
     * reference it. This operation cascades to every entity related by
     * an association marked {@link CascadeType#DETACH cascade=DETACH}.
     * If the given entity instance is new or detached, that is, if it
     * is not associated with this persistence context, it is ignored.
     * @param entity  a managed or removed entity instance
     * @throws IllegalArgumentException if the instance is not an 
     *         entity
     * @since 2.0
     */</span>
    <span class="type">void</span> detach(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Determine if the given object is a managed entity instance
     * belonging to the current persistence context.
     * @param entity  entity instance
     * @return boolean value indicating if entity belongs to the
     *         persistence context
     * @throws IllegalArgumentException if not an entity
     */</span>
    <span class="type">boolean</span> contains(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Get the current {@linkplain LockModeType lock mode} held by
     * this persistence context on the given managed entity instance.
     * @param entity  a managed entity instance
     * @return the lock mode currently held
     * @throws TransactionRequiredException if there is no active
     *         transaction or if the entity manager has not been
     *         joined to the current transaction
     * @throws IllegalArgumentException if a transaction is active
     *         but the given instance is not a managed entity
     * @since 2.0
     */</span>
    LockModeType getLockMode(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Set the default {@linkplain CacheRetrieveMode cache retrieval
     * mode} for this persistence context.
     * @param cacheRetrieveMode cache retrieval mode
     * @since 3.2
     */</span>
    <span class="type">void</span> setCacheRetrieveMode(CacheRetrieveMode cacheRetrieveMode);

    <span class="comment">/**
     * Set the default {@linkplain CacheStoreMode cache storage mode}
     * for this persistence context.
     * @param cacheStoreMode cache storage mode
     * @since 3.2
     */</span>
    <span class="type">void</span> setCacheStoreMode(CacheStoreMode cacheStoreMode);

    <span class="comment">/**
     * The cache retrieval mode for this persistence context.
     * @since 3.2
     */</span>
    CacheRetrieveMode getCacheRetrieveMode();

    <span class="comment">/**
     * The cache storage mode for this persistence context.
     * @since 3.2
     */</span>
    CacheStoreMode getCacheStoreMode();

    <span class="comment">/**
     * Set an entity manager property or hint. 
     * If a vendor-specific property or hint is not recognized, it is
     * silently ignored. 
     * @param propertyName name of the property or hint
     * @param value  value for the property or hint
     * @throws IllegalArgumentException if the property or hint name
     *         is recognized by the implementation, but the second
     *         argument is not valid value
     * @since 2.0
     */</span>
    <span class="type">void</span> setProperty(<span class="predefined-type">String</span> propertyName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * The properties and hints and their associated values which are
     * in effect for this entity manager. Modifying the contents of
     * the returned map does not change the configuration in effect.
     * @return a map of properties and hints currently in effect
     * @since 2.0
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getProperties();

    <span class="comment">/**
     * Create an instance of {@link Query} for executing a
     * Jakarta Persistence query language statement.
     * @param qlString a Jakarta Persistence query string
     * @return the new query instance
     * @throws IllegalArgumentException if the query string is
     *         found to be invalid
     */</span>
    <span class="predefined-type">Query</span> createQuery(<span class="predefined-type">String</span> qlString);

    <span class="comment">/**
     * Create an instance of {@link TypedQuery} for executing a
     * criteria query.
     * @param criteriaQuery  a criteria query object
     * @return the new query instance
     * @throws IllegalArgumentException if the criteria query is
     *         found to be invalid
     * @since 2.0
     */</span>
    &lt;T&gt; TypedQuery&lt;T&gt; createQuery(CriteriaQuery&lt;T&gt; criteriaQuery);

    <span class="comment">/**
     * Create an instance of {@link TypedQuery} for executing a
     * criteria query, which may be a union or intersection of
     * top-level queries.
     * @param selectQuery  a criteria query object
     * @return the new query instance
     * @throws IllegalArgumentException if the criteria query is
     *         found to be invalid
     * @since 3.2
     */</span>
    &lt;T&gt; TypedQuery&lt;T&gt; createQuery(CriteriaSelect&lt;T&gt; selectQuery);

    <span class="comment">/**
     * Create an instance of {@link Query} for executing a criteria
     * update query.
     * @param updateQuery  a criteria update query object
     * @return the new query instance
     * @throws IllegalArgumentException if the update query is
     *         found to be invalid
     * @since 2.1
     */</span>
    <span class="predefined-type">Query</span> createQuery(CriteriaUpdate&lt;?&gt; updateQuery);

    <span class="comment">/**
     * Create an instance of {@link Query} for executing a criteria
     * delete query.
     * @param deleteQuery  a criteria delete query object
     * @return the new query instance
     * @throws IllegalArgumentException if the delete query is
     *         found to be invalid
     * @since 2.1
     */</span>
    <span class="predefined-type">Query</span> createQuery(CriteriaDelete&lt;?&gt; deleteQuery);

    <span class="comment">/**
     * Create an instance of {@link TypedQuery} for executing a
     * Jakarta Persistence query language statement.
     * The select list of the query must contain only a single
     * item, which must be assignable to the type specified by
     * the {@code resultClass} argument.
     * @param qlString a Jakarta Persistence query string
     * @param resultClass the type of the query result
     * @return the new query instance
     * @throws IllegalArgumentException if the query string is
     *         found to be invalid or if the query result is
     *         found to not be assignable to the specified type
     * @since 2.0
     */</span>
    &lt;T&gt; TypedQuery&lt;T&gt; createQuery(<span class="predefined-type">String</span> qlString, <span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">/**
     * Create an instance of {@link Query} for executing a named
     * query written in the Jakarta Persistence query language or
     * in native SQL.
     * @param name the name of a query defined in metadata
     * @return the new query instance
     * @throws IllegalArgumentException if a query has not been
     *         defined with the given name or if the query string is
     *         found to be invalid
     * @see NamedQuery
     * @see NamedNativeQuery
     */</span>
    <span class="predefined-type">Query</span> createNamedQuery(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Create an instance of {@link TypedQuery} for executing a
     * Jakarta Persistence query language named query.
     * The select list of the query must contain only a single
     * item, which must be assignable to the type specified by
     * the {@code resultClass} argument.
     * @param name the name of a query defined in metadata
     * @param resultClass the type of the query result
     * @return the new query instance
     * @throws IllegalArgumentException if a query has not been
     *         defined with the given name or if the query string is
     *         found to be invalid or if the query result is found to
     *         not be assignable to the specified type
     * @since 2.0
     */</span>
    &lt;T&gt; TypedQuery&lt;T&gt; createNamedQuery(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">/**
     * Create an instance of {@link TypedQuery} for executing a
     * named query written in the Jakarta Persistence query
     * language or in native SQL.
     * @param reference a reference to the query defined in metadata
     * @return the new query instance
     * @throws IllegalArgumentException if a query has not been
     *         defined, or if the query string is found to be
     *         invalid, or if the query result is found to not be
     *         assignable to the specified type
     * @see EntityManagerFactory#getNamedQueries(Class)
     * @see NamedQuery
     * @see NamedNativeQuery
     */</span>
    &lt;T&gt; TypedQuery&lt;T&gt; createQuery(TypedQueryReference&lt;T&gt; reference);

    <span class="comment">/**
     * Create an instance of {@link Query} for executing a native
     * SQL statement, e.g., for update or delete.
     *
     * &lt;p&gt;If the query is not an update or delete query, query
     * execution will result in each row of the SQL result being
     * returned as a result of type {@code Object[]} (or a result
     * of type {@code Object} if there is only one column in the
     * select list.) Column values are returned in the order of
     * their occurrence in the select list and default JDBC type
     * mappings are applied.
     * @param sqlString a native SQL query string
     * @return the new query instance
     */</span>
    <span class="predefined-type">Query</span> createNativeQuery(<span class="predefined-type">String</span> sqlString);

    <span class="comment">/**
     * Create an instance of {@link Query} for executing a native
     * SQL query.
     *
     * &lt;p&gt;&lt;em&gt;In the next release of this API, the return type of this
     * method will change to {@code TypedQuery&lt;T&gt;}.&lt;/em&gt;
     * @param sqlString a native SQL query string
     * @param resultClass the type of the query result
     * @return the new query instance
     */</span>
    &lt;T&gt; <span class="predefined-type">Query</span> createNativeQuery(<span class="predefined-type">String</span> sqlString, <span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">/**
     * Create an instance of {@link Query} for executing
     * a native SQL query.
     * @param sqlString a native SQL query string
     * @param resultSetMapping the name of the result set mapping
     * @return the new query instance
     */</span>
    <span class="predefined-type">Query</span> createNativeQuery(<span class="predefined-type">String</span> sqlString, <span class="predefined-type">String</span> resultSetMapping);

    <span class="comment">/**
     * Create an instance of {@link StoredProcedureQuery} for executing
     * a stored procedure in the database.
     * &lt;p&gt;Parameters must be registered before the stored procedure can
     * be executed.
     * &lt;p&gt;If the stored procedure returns one or more result sets, any
     * result set is returned as a list of type {@code Object[]}.
     * @param name name assigned to the stored procedure query in
     *        metadata
     * @return the new stored procedure query instance
     * @throws IllegalArgumentException if no query has been defined
     *         with the given name
     * @since 2.1
     */</span>
    StoredProcedureQuery createNamedStoredProcedureQuery(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Create an instance of {@link StoredProcedureQuery} for executing a
     * stored procedure in the database.
     * &lt;p&gt;Parameters must be registered before the stored procedure can
     * be executed.
     * &lt;p&gt;If the stored procedure returns one or more result sets, any
     * result set is returned as a list of type {@code Object[]}.
     * @param procedureName name of the stored procedure in the database
     * @return the new stored procedure query instance
     * @throws IllegalArgumentException if a stored procedure of the
     *         given name does not exist (or if query execution will
     *         fail)
     * @since 2.1
     */</span>
    StoredProcedureQuery createStoredProcedureQuery(<span class="predefined-type">String</span> procedureName);

    <span class="comment">/**
     * Create an instance of {@link StoredProcedureQuery} for executing
     * a stored procedure in the database.
     * &lt;p&gt;Parameters must be registered before the stored procedure can
     * be executed.
     * &lt;p&gt;The {@code resultClass} arguments must be specified in the
     * order in which the result sets is returned by the stored procedure
     * invocation.
     * @param procedureName name of the stored procedure in the database
     * @param resultClasses classes to which the result sets
     *        produced by the stored procedure are to be mapped
     * @return the new stored procedure query instance
     * @throws IllegalArgumentException if a stored procedure of the
     *         given name does not exist (or if query execution will
     *         fail)
     * @since 2.1
     */</span>
    StoredProcedureQuery createStoredProcedureQuery(
            <span class="predefined-type">String</span> procedureName, <span class="predefined-type">Class</span>&lt;?&gt;... resultClasses);

    <span class="comment">/**
     * Create an instance of {@link StoredProcedureQuery} for executing
     * a stored procedure in the database.
     * &lt;p&gt;Parameters must be registered before the stored procedure can
     * be executed.
     * &lt;p&gt;The {@code resultSetMapping} arguments must be specified in
     * the order in which the result sets is returned by the stored
     * procedure invocation.
     * @param procedureName name of the stored procedure in the
     *        database
     * @param resultSetMappings the names of the result set mappings
     *        to be used in mapping result sets
     *        returned by the stored procedure
     * @return the new stored procedure query instance
     * @throws IllegalArgumentException if a stored procedure or
     *         result set mapping of the given name does not exist
     *         (or the query execution will fail)
     */</span>
    StoredProcedureQuery createStoredProcedureQuery(
            <span class="predefined-type">String</span> procedureName, <span class="predefined-type">String</span>... resultSetMappings);

    <span class="comment">/**
     * Indicate to the entity manager that a JTA transaction is
     * active and join the persistence context to it. 
     * &lt;p&gt;This method should be called on a JTA application 
     * managed entity manager that was created outside the scope
     * of the active transaction or on an entity manager of type
     * {@link SynchronizationType#UNSYNCHRONIZED} to associate
     * it with the current JTA transaction.
     * @throws TransactionRequiredException if there is no active
     *         transaction
     */</span>
    <span class="type">void</span> joinTransaction();

    <span class="comment">/**
     * Determine whether the entity manager is joined to the
     * current transaction. Returns false if the entity manager
     * is not joined to the current transaction or if no
     * transaction is active.
     * @return boolean
     * @since 2.1
     */</span>
    <span class="type">boolean</span> isJoinedToTransaction();

    <span class="comment">/**
     * Return an object of the specified type to allow access to
     * a provider-specific API. If the provider implementation
     * of {@code EntityManager} does not support the given type,
     * the {@link PersistenceException} is thrown.
     * @param cls  the class of the object to be returned.
     *             This is usually either the underlying class
     *             implementing {@code EntityManager} or an
     *             interface it implements.
     * @return an instance of the specified class
     * @throws PersistenceException if the provider does not 
     *         support the given type
     * @since 2.0
     */</span>
    &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; cls);

    <span class="comment">/**
     * Return the underlying provider object for the
     * {@link EntityManager}, if available. The result of this
     * method is implementation-specific.
     * &lt;p&gt;The {@code unwrap} method is to be preferred for new
     * applications.
     * @return the underlying provider object
     */</span>
    <span class="predefined-type">Object</span> getDelegate();

    <span class="comment">/**
     * Close an application-managed entity manager.
     * &lt;p&gt;After invocation of {@code close()}, every method of
     * the {@code EntityManager} instance and of any instance
     * of {@link Query}, {@link TypedQuery}, or
     * {@link StoredProcedureQuery} obtained from it throws
     * the {@link IllegalStateException}, except for
     * {@link #getProperties()}, {@link #getTransaction()},
     * and {@link #isOpen()} (which returns false).
     * &lt;p&gt;If this method is called when the entity manager is
     * joined to an active transaction, the persistence context
     * remains managed until the transaction completes.
     * @throws IllegalStateException if the entity manager is
     *         container-managed
     */</span>
    <span class="type">void</span> close();

    <span class="comment">/**
     * Determine whether the entity manager is open. 
     * @return true until the entity manager has been closed
     */</span>
    <span class="type">boolean</span> isOpen();

    <span class="comment">/**
     * Return the resource-level {@link EntityTransaction} object.
     * The {@code EntityTransaction} instance may be used serially
     * to begin and commit multiple transactions.
     * @return EntityTransaction instance
     * @throws IllegalStateException if invoked on a JTA entity
     *         manager
     */</span>
    EntityTransaction getTransaction();

    <span class="comment">/**
     * The {@linkplain EntityManagerFactory entity manager factory}
     * which created this entity manager.
     * @return the {@link EntityManagerFactory}
     * @throws IllegalStateException if the entity manager has 
     *         been closed
     * @since 2.0
     */</span>
    EntityManagerFactory getEntityManagerFactory();

    <span class="comment">/**
     * Obtain an instance of {@link CriteriaBuilder} which may be
     * used to construct {@link CriteriaQuery} objects.
     * @return an instance of {@link CriteriaBuilder}
     * @throws IllegalStateException if the entity manager has
     *         been closed
     * @see EntityManagerFactory#getCriteriaBuilder()
     * @since 2.0
     */</span>
    CriteriaBuilder getCriteriaBuilder();

    <span class="comment">/**
     * Obtain an instance of the {@link Metamodel} interface which
     * provides access to metamodel objects describing the managed
     * types belonging to the persistence unit.
     * @return an instance of {@link Metamodel}
     * @throws IllegalStateException if the entity manager has
     *         been closed
     * @since 2.0
     */</span>
    Metamodel getMetamodel();

    <span class="comment">/**
     * Create a new mutable {@link EntityGraph}, allowing dynamic
     * definition of an entity graph.
     * @param rootType class of entity graph
     * @return entity graph
     * @since 2.1
     */</span>
    &lt;T&gt; EntityGraph&lt;T&gt; createEntityGraph(<span class="predefined-type">Class</span>&lt;T&gt; rootType);

    <span class="comment">/**
     * Obtain a mutable copy of a named {@link EntityGraph}, or
     * return null if there is no entity graph with the given
     * name.
     * @param graphName name of an entity graph
     * @return entity graph
     * @since 2.1
     */</span>
    EntityGraph&lt;?&gt; createEntityGraph(<span class="predefined-type">String</span> graphName);

    <span class="comment">/**
     * Obtain a named {@link EntityGraph}. The returned instance
     * of {@code EntityGraph} should be considered immutable.
     * @param graphName  name of an existing entity graph
     * @return named entity graph
     * @throws IllegalArgumentException if there is no entity
     *         of graph with the given name
     * @since 2.1
     */</span>
    EntityGraph&lt;?&gt; getEntityGraph(<span class="predefined-type">String</span> graphName);

    <span class="comment">/**
     * Return all named {@link EntityGraph}s that are defined for
     * the given entity class type.
     * @param entityClass  entity class
     * @return list of all entity graphs defined for the entity
     * @throws IllegalArgumentException if the class is not an entity
     * @since 2.1
     */</span>
    &lt;T&gt; <span class="predefined-type">List</span>&lt;EntityGraph&lt;? <span class="local-variable">super</span> T&gt;&gt; getEntityGraphs(<span class="predefined-type">Class</span>&lt;T&gt; entityClass);

    <span class="comment">/**
     * Execute the given action using the database connection underlying this
     * {@code EntityManager}. Usually, the connection is a JDBC connection, but a
     * provider might support some other native connection type, and is not required
     * to support {@code java.sql.Connection}. If this {@code EntityManager} is
     * associated with a transaction, the action is executed in the context of the
     * transaction. The given action should close any resources it creates, but should
     * not close the connection itself, nor commit or roll back the transaction. If
     * the given action throws an exception, the persistence provider must mark the
     * transaction for rollback.
     * @param action the action
     * @param &lt;C&gt; the connection type, usually {@code java.sql.Connection}
     * @throws PersistenceException wrapping the checked {@link Exception} thrown by
     *         {@link ConnectionConsumer#accept}, if any
     * @since 3.2
     */</span>
    &lt;C&gt; <span class="type">void</span> runWithConnection(ConnectionConsumer&lt;C&gt; action);

    <span class="comment">/**
     * Call the given function and return its result using the database connection
     * underlying this {@code EntityManager}. Usually, the connection is a JDBC
     * connection, but a provider might support some other native connection type,
     * and is not required to support {@code java.sql.Connection}. If this
     * {@code EntityManager} is associated with a transaction, the function is
     * executed in the context of the transaction. The given function should close
     * any resources it creates, but should not close the connection itself, nor
     * commit or roll back the transaction. If the given action throws an exception,
     * the persistence provider must mark the transaction for rollback.
     * @param function the function
     * @param &lt;C&gt; the connection type, usually {@code java.sql.Connection}
     * @param &lt;T&gt; the type of result returned by the function
     * @return the value returned by {@link ConnectionFunction#apply}.
     * @throws PersistenceException wrapping the checked {@link Exception} thrown by
     *         {@link ConnectionFunction#apply}, if any
     * @since 3.2
     */</span>
    &lt;C,T&gt; T callWithConnection(ConnectionFunction&lt;C, T&gt; function);

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_entitytransaction_"><a class="anchor" href="#_entitytransaction_"></a>B.2. <code>EntityTransaction</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Interface used to control transactions on resource-local entity
 * managers. The {@link EntityManager#getTransaction} method returns
 * the {@code EntityTransaction} interface.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityTransaction</span> {

     <span class="comment">/**
      * Start a resource transaction. 
      * @throws IllegalStateException if {@link #isActive()} is true
      */</span>
     <span class="type">void</span> begin();

     <span class="comment">/**
      * Commit the current resource transaction, writing any unflushed
      * changes to the database.
      * @throws IllegalStateException if {@link #isActive()} is false
      * @throws RollbackException if the commit fails
      */</span>
     <span class="type">void</span> commit();

     <span class="comment">/**
      * Roll back the current resource transaction. 
      * @throws IllegalStateException if {@link #isActive()} is false
      * @throws PersistenceException if an unexpected error 
      *         condition is encountered
      */</span>
     <span class="type">void</span> rollback();

     <span class="comment">/**
      * Mark the current resource transaction so that the only possible
      * outcome of the transaction is for the transaction
      * to be rolled back. 
      * @throws IllegalStateException if {@link #isActive()} is false
      */</span>
     <span class="type">void</span> setRollbackOnly();

     <span class="comment">/**
      * Determine whether the current resource transaction has been 
      * marked for rollback.
      * @return boolean indicating whether the transaction has been
      *         marked for rollback
      * @throws IllegalStateException if {@link #isActive()} is false
      */</span>
     <span class="type">boolean</span> getRollbackOnly();

     <span class="comment">/**
      * Indicate whether a resource transaction is in progress.
      * @return boolean indicating whether transaction is in progress
      * @throws PersistenceException if an unexpected error 
      *         condition is encountered
      */</span>
     <span class="type">boolean</span> isActive();

     <span class="comment">/**
      * Set the transaction timeout, in seconds. This is a hint.
      * @param timeout the timeout, in seconds, or null to indicate
      *                that the database server should set the timeout
      * @since 3.2
      */</span>
     <span class="type">void</span> setTimeout(<span class="predefined-type">Integer</span> timeout);

     <span class="comment">/**
      * The transaction timeout.
      * @since 3.2
      */</span>
     <span class="predefined-type">Integer</span> getTimeout();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_entitymanagerfactory_"><a class="anchor" href="#_entitymanagerfactory_"></a>B.3. <code>EntityManagerFactory</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.function.Consumer</span>;
<span class="keyword">import</span> <span class="include">java.util.function.Function</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Metamodel</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaBuilder</span>;

<span class="comment">/**
 * Interface used to interact with the persistence unit, and to
 * create new instances of {@link EntityManager}.
 *
 * &lt;p&gt;A persistence unit defines the set of all classes that are
 * related or grouped by the application, and which must be
 * colocated in their mapping to a single database. If two entity
 * types participate in an association, then they must belong to
 * the same persistence unit.
 *
 * &lt;p&gt;A persistence unit may be defined by a {@code persistence.xml}
 * file, or it may be defined at runtime via the
 * {@link PersistenceConfiguration} API.
 *
 * &lt;p&gt;Every persistence unit has a &lt;em&gt;transaction type&lt;/em&gt;,
 * either {@link PersistenceUnitTransactionType#JTA JTA}, or
 * {@link PersistenceUnitTransactionType#RESOURCE_LOCAL RESOURCE_LOCAL}.
 * Resource-local transactions are managed programmatically via the
 * {@link EntityTransaction} interface.
 *
 * &lt;p&gt;An {@link EntityManagerFactory} with a lifecycle managed by
 * the application may be created using the static operations of
 * the {@link Persistence} class:
 * &lt;ul&gt;
 * &lt;li&gt;if the persistence unit is defined in {@code persistence.xml},
 *     an entity manager factory may be created by calling
 *     {@link Persistence#createEntityManagerFactory(String)} or
 *     {@link Persistence#createEntityManagerFactory(String,Map)},
 *     or
 * &lt;li&gt;if the persistence unit was defined using
 *     {@link PersistenceConfiguration}, an entity manager factory
 *     may be created by calling
 *     {@link Persistence#createEntityManagerFactory(PersistenceConfiguration)}.
 * &lt;/ul&gt;
 *
 * &lt;p&gt;Usually, there is exactly one {@code EntityManagerFactory} for
 * each persistence unit:
 * {@snippet :
 * // create a factory at initialization time
 * static final EntityManagerFactory entityManagerFactory =
 *         Persistence.createEntityManagerFactory(&quot;orderMgt&quot;);
 * }
 *
 * &lt;p&gt;Alternatively, in the Jakarta EE environment, a
 * container-managed {@code EntityManagerFactory} may be obtained
 * by dependency injection, using {@link PersistenceUnit}.
 * {@snippet :
 * // inject the container-managed factory
 * @PersistenceUnit(unitName=&quot;orderMgt&quot;)
 * EntityManagerFactory entityManagerFactory;
 * }
 *
 * &lt;p&gt;An application-managed {@code EntityManager} may be created
 * via a call to {@link #createEntityManager()}. However, this
 * approach places complete responsibility for cleanup and exception
 * management on the client, and is thus considered error-prone. It
 * is much safer to use the methods {@link #runInTransaction} and
 * {@link #callInTransaction} to obtain {@code EntityManager}s.
 * Alternatively, in the Jakarta EE environment, a container-managed
 * {@link EntityManager} may be obtained by dependency injection,
 * using {@link PersistenceContext}, and the application need not
 * interact with the {@code EntityManagerFactory} directly.
 *
 * &lt;p&gt;The {@code EntityManagerFactory} provides access to certain
 * other useful APIs:
 * &lt;ul&gt;
 * &lt;li&gt;an instance of {@link Metamodel} exposing a model of the
 *     managed types associated with the persistence unit may be
 *     obtained by calling {@link #getMetamodel()},
 * &lt;li&gt;an instance of {@link SchemaManager}, allowing programmatic
 *     control over schema generation and validation, may be
 *     obtained by calling {@link #getSchemaManager()},
 * &lt;li&gt;an instance of {@link Cache}, allowing direct programmatic
 *     control over the second-level cache, may be obtained by
 *     calling {@link #getCache()},
 * &lt;li&gt;the {@link CriteriaBuilder}, used to define criteria queries,
 *     may be obtained by calling {@link #getCriteriaBuilder()},
 *     and
 * &lt;li&gt;the {@link PersistenceUnitUtil} may be obtained by calling
 *     {@link #getPersistenceUnitUtil()}.
 * &lt;/ul&gt;
 *
 * &lt;p&gt;When the application has finished using the entity manager
 * factory, or when the application terminates, the application
 * should {@linkplain #close} the entity manager factory. If
 * necessary, a {@link java.lang.ref.Cleaner} may be used:
 * {@snippet :
 * // factory should be destroyed before program terminates
 * Cleaner.create().register(entityManagerFactory, entityManagerFactory::close);
 * }
 * Once an {@code EntityManagerFactory} has been closed, all its
 * entity managers are considered to be in the closed state.
 *
 * @see EntityManager
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityManagerFactory</span> <span class="directive">extends</span> AutoCloseable {

    <span class="comment">/**
     * Create a new application-managed {@link EntityManager}. This
     * method returns a new {@code EntityManager} instance each time
     * it is invoked. 
     * &lt;p&gt;The {@link EntityManager#isOpen} method will return true
     * on the returned instance.
     * @return entity manager instance
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     */</span>
    EntityManager createEntityManager();
    
    <span class="comment">/**
     * Create a new application-managed {@link EntityManager} with
     * the given {@link Map} specifying property settings. This
     * method returns a new {@code EntityManager} instance each time
     * it is invoked.
     * &lt;p&gt;The {@link EntityManager#isOpen} method will return true
     * on the returned instance.
     * @param map properties for entity manager
     * @return entity manager instance
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     */</span>
    EntityManager createEntityManager(<span class="predefined-type">Map</span>&lt;?, ?&gt; map);

    <span class="comment">/**
     * Create a new JTA application-managed {@link EntityManager} with
     * the specified synchronization type. This method returns a new
     * {@code EntityManager} instance each time it is invoked.
     * &lt;p&gt;The {@link EntityManager#isOpen} method will return true on
     * the returned instance.
     * @param synchronizationType  how and when the entity manager should
     *                             be synchronized with the current JTA
     *                             transaction
     * @return entity manager instance
     * @throws IllegalStateException if the entity manager factory has
     * been configured for resource-local entity managers or is closed
     *
     * @since 2.1
     */</span>
    EntityManager createEntityManager(SynchronizationType synchronizationType);

    <span class="comment">/**
     * Create a new JTA application-managed {@link EntityManager} with
     * the specified synchronization type and map of properties. This
     * method returns a new {@code EntityManager} instance each time it
     * is invoked.
     * &lt;p&gt;The {@link EntityManager#isOpen} method will return true on the
     * returned instance.
     * @param synchronizationType  how and when the entity manager should
     *                             be synchronized with the current JTA
     *                             transaction
     * @param map properties for entity manager
     * @return entity manager instance
     * @throws IllegalStateException if the entity manager factory has
     * been configured for resource-local entity managers or is closed
     *
     * @since 2.1
     */</span>
    EntityManager createEntityManager(SynchronizationType synchronizationType, <span class="predefined-type">Map</span>&lt;?, ?&gt; map);

    <span class="comment">/**
     * Return an instance of {@link CriteriaBuilder} which may be used
     * to construct {@link jakarta.persistence.criteria.CriteriaQuery}
     * objects.
     * @return an instance of {@link CriteriaBuilder}
     * @throws IllegalStateException if the entity manager factory has
     * been closed
     *
     * @see EntityManager#getCriteriaBuilder()
     *
     * @since 2.0
     */</span>
    CriteriaBuilder getCriteriaBuilder();
    
    <span class="comment">/**
     * Return an instance of the {@link Metamodel} interface for access
     * to the metamodel of the persistence unit.
     * @return an instance of {@link Metamodel}
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 2.0
     */</span>
    Metamodel getMetamodel();

    <span class="comment">/**
     * Indicates whether the factory is open. Returns true until the
     * factory has been closed.
     * @return boolean indicating whether the factory is open
     */</span>
    <span class="type">boolean</span> isOpen();
    
    <span class="comment">/**
     * Close the factory, releasing any resources that it holds.
     * After a factory instance has been closed, all methods invoked
     * on it will throw the {@link IllegalStateException}, except
     * for {@link #isOpen}, which will return false. Once an
     * {@code EntityManagerFactory} has been closed, all its
     * entity managers are considered to be in the closed state.
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     */</span>
    <span class="type">void</span> close();

    <span class="comment">/**
     * The name of the persistence unit.
     *
     * @since 3.2
     */</span>
    <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     * Get the properties and associated values that are in effect
     * for the entity manager factory. Changing the contents of the
     * map does not change the configuration in effect.
     * @return properties
     * @throws IllegalStateException if the entity manager factory 
     * has been closed
     *
     * @since 2.0
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getProperties();

    <span class="comment">/**
     * Access the cache that is associated with the entity manager 
     * factory (the &quot;second level cache&quot;).
     * @return an instance of {@link Cache}, or null if there is no
     * second-level cache in use
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 2.0
     */</span>
    Cache getCache();

    <span class="comment">/**
     * Return interface providing access to utility methods for the
     * persistence unit.
     * @return an instance of {@link PersistenceUnitUtil}
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 2.0
     */</span>
    PersistenceUnitUtil getPersistenceUnitUtil();

    <span class="comment">/**
     * The type of transaction management used by this persistence
     * unit, either resource-local transaction management, or JTA.
     *
     * @since 3.2
     */</span>
    PersistenceUnitTransactionType getTransactionType();

    <span class="comment">/**
     * Return interface providing access to schema management
     * operations for the persistence unit.
     * @return an instance of {@link SchemaManager}
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 3.2
     */</span>
    SchemaManager getSchemaManager();

    <span class="comment">/**
     * Define the query, typed query, or stored procedure query as
     * a named query such that future query objects can be created
     * from it using the {@link EntityManager#createNamedQuery} or
     * {@link EntityManager#createNamedStoredProcedureQuery} methods.
     * &lt;p&gt;Any configuration of the query object (except for actual
     * parameter binding) in effect when the named query is added
     * is retained as part of the named query definition. This
     * includes configuration information such as max results, hints,
     * flush mode, lock mode, result set mapping information, and
     * information about stored procedure parameters.
     * &lt;p&gt;When the query is executed, information that can be set by
     * means of the query APIs can be overridden. Information that is
     * overridden does not affect the named query as registered with
     * the entity manager factory, and thus does not affect subsequent
     * query objects created from it by calling {@code createNamedQuery}
     * or {@code createNamedStoredProcedureQuery}.
     * &lt;p&gt;If a named query of the same name has been previously defined,
     * either statically via metadata or via this method, that query
     * definition is replaced.
     *
     * @param name name for the query
     * @param query a {@link Query}, {@link TypedQuery},
     *             or {@link StoredProcedureQuery}
     *
     * @since 2.1
     */</span>
    <span class="type">void</span> addNamedQuery(<span class="predefined-type">String</span> name, <span class="predefined-type">Query</span> query);

    <span class="comment">/**
     * Return an object of the specified type to allow access to
     * a provider-specific API. If the provider implementation of
     * {@code EntityManagerFactory} does not support the given
     * type, the {@link PersistenceException} is thrown.
     * @param cls the class of the object to be returned.
     *            This is usually either the underlying class
     *            implementing {@code EntityManagerFactory} or an
     *            interface it implements.
     * @return an instance of the specified class
     * @throws PersistenceException if the provider does not support
     *        the given type
     * @since 2.1
     */</span>
    &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; cls);

    <span class="comment">/**
     * Add a named copy of the given {@link EntityGraph} to this
     * {@code EntityManagerFactory}. If an entity graph with the
     * given name already exists, it is replaced.
     * @param graphName  name for the entity graph
     * @param entityGraph  entity graph
     * @since 2.1
     */</span>
    &lt;T&gt; <span class="type">void</span> addNamedEntityGraph(<span class="predefined-type">String</span> graphName, EntityGraph&lt;T&gt; entityGraph);

    <span class="comment">/**
     * A map keyed by {@linkplain NamedQuery#name query name}, containing
     * {@linkplain TypedQueryReference references} to every named query whose
     * result type is assignable to the given Java type.
     * @param resultType any Java type, including {@code Object.class}
     *                   meaning all queries
     * @return a map keyed by query name
     * @param &lt;R&gt; the specified upper bound on the query result types
     */</span>
    &lt;R&gt; <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, TypedQueryReference&lt;R&gt;&gt; getNamedQueries(<span class="predefined-type">Class</span>&lt;R&gt; resultType);

    <span class="comment">/**
     * A map keyed by {@linkplain NamedEntityGraph#name graph name}, containing
     * every named {@linkplain EntityGraph entity graph} whose entity type is
     * assignable to the given Java type.
     * @param entityType any Java type, including {@code Object.class}
     *                   meaning all entity graphs
     * @return a map keyed by graph name
     * @param &lt;E&gt; the specified upper bound on the entity graph types
     */</span>
    &lt;E&gt; <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, EntityGraph&lt;? <span class="directive">extends</span> E&gt;&gt; getNamedEntityGraphs(<span class="predefined-type">Class</span>&lt;E&gt; entityType);

    <span class="comment">/**
     * Create a new application-managed {@link EntityManager} with an active
     * transaction, and execute the given function, passing the {@code EntityManager}
     * to the function.
     * &lt;p&gt;
     * If the transaction type of the persistence unit is JTA, and there is a JTA
     * transaction already associated with the caller, then the {@code EntityManager}
     * is associated with this current transaction. If the given function throws an
     * exception, the JTA transaction is marked for rollback, and the exception is
     * rethrown.
     * &lt;p&gt;
     * Otherwise, if the transaction type of the persistence unit is resource-local,
     * or if there is no JTA transaction already associated with the caller, then
     * the {@code EntityManager} is associated with a new transaction. If the given
     * function returns without throwing an exception, this transaction is committed.
     * If the function does throw an exception, the transaction is rolled back, and
     * the exception is rethrown.
     * &lt;p&gt;
     * Finally, the {@code EntityManager} is closed before this method returns
     * control to the client.
     *
     * @param work a function to be executed in the scope of the transaction
     */</span>
    <span class="type">void</span> runInTransaction(Consumer&lt;EntityManager&gt; work);
    <span class="comment">/**
     * Create a new application-managed {@link EntityManager} with an active
     * transaction, and call the given function, passing the {@code EntityManager}
     * to the function.
     * &lt;p&gt;
     * If the transaction type of the persistence unit is JTA, and there is a JTA
     * transaction already associated with the caller, then the {@code EntityManager}
     * is associated with this current transaction. If the given function returns
     * without throwing an exception, the result of the function is returned. If the
     * given function throws an exception, the JTA transaction is marked for rollback,
     * and the exception is rethrown.
     * &lt;p&gt;
     * Otherwise, if the transaction type of the persistence unit is resource-local,
     * or if there is no JTA transaction already associated with the caller, then
     * the {@code EntityManager} is associated with a new transaction. If the given
     * function returns without throwing an exception, this transaction is committed
     * and the result of the function is returned. If the function does throw an
     * exception, the transaction is rolled back, and the exception is rethrown.
    * &lt;p&gt;
     * Finally, the {@code EntityManager} is closed before this method returns
     * control to the client.
     *
     * @param work a function to be called in the scope of the transaction
     * @return the value returned by the given function
     */</span>
    &lt;R&gt; R callInTransaction(Function&lt;EntityManager, R&gt; work);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lockmodetype_"><a class="anchor" href="#_lockmodetype_"></a>B.4. <code>LockModeType</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Enumerates the kinds of optimistic or pessimistic lock which
 * may be obtained on an entity instance.
 *
 * &lt;p&gt; A specific lock mode may be requested by passing an explicit
 * {@code LockModeType} as an argument to:
 * &lt;ul&gt;
 * &lt;li&gt;one of the methods of {@link EntityManager} which obtains
 *     locks ({@link EntityManager#lock lock()},
 *     {@link EntityManager#find find()}, or
 *     {@link EntityManager#refresh refresh()}), or
 * &lt;li&gt;to {@link Query#setLockMode(LockModeType)} or
 *     {@link TypedQuery#setLockMode(LockModeType)}.
 * &lt;/ul&gt;
 * 
 * &lt;p&gt; Optimistic locks are specified using
 * {@link LockModeType#OPTIMISTIC LockModeType.OPTIMISTIC} and
 * {@link LockModeType#OPTIMISTIC_FORCE_INCREMENT}. The lock mode
 * types {@link LockModeType#READ} and {@link LockModeType#WRITE} are
 * synonyms for {@code OPTIMISTIC} and {@code OPTIMISTIC_FORCE_INCREMENT}
 * respectively. The latter are preferred for new applications.
 *
 * &lt;p&gt; The semantics of requesting locks of type
 * {@code LockModeType.OPTIMISTIC} and
 * {@code LockModeType.OPTIMISTIC_FORCE_INCREMENT} are the
 * following.
 *
 * &lt;p&gt; If transaction T1 calls for a lock of type 
 * {@code LockModeType.OPTIMISTIC} on a versioned object, 
 * the entity manager must ensure that neither of the following 
 * phenomena can occur:
 * &lt;ul&gt;
 *   &lt;li&gt; P1 (Dirty read): Transaction T1 modifies a row. 
 * Another transaction T2 then reads that row and obtains the
 * modified value, before T1 has committed or rolled back.
 * Transaction T2 eventually commits successfully; it does not 
 * matter whether T1 commits or rolls back and whether it does 
 * so before or after T2 commits.
 *   &lt;/li&gt;
 *   &lt;li&gt; P2 (Non-repeatable read): Transaction T1 reads a row. 
 * Another transaction T2 then modifies or deletes that row, 
 * before T1 has committed. Both transactions eventually commit 
 * successfully.
 *   &lt;/li&gt;
 * &lt;/ul&gt;
 *
 * &lt;p&gt; Lock modes must always prevent the phenomena P1 and P2.
 *
 * &lt;p&gt; In addition, obtaining a lock of type
 * {@code LockModeType.OPTIMISTIC_FORCE_INCREMENT} on a versioned
 * object, will also force an update (increment) to the entity's
 * version column.
 *
 * &lt;p&gt; The persistence implementation is not required to support
 * the use of optimistic lock modes on non-versioned objects. When
 * it cannot support such a lock request, it must throw the {@link
 * PersistenceException}.
 *
 * &lt;p&gt;The lock modes {@link LockModeType#PESSIMISTIC_READ},
 * {@link LockModeType#PESSIMISTIC_WRITE}, and
 * {@link LockModeType#PESSIMISTIC_FORCE_INCREMENT} are used to
 * immediately obtain long-term database locks.
 *
 * &lt;p&gt; The semantics of requesting locks of type
 * {@code LockModeType.PESSIMISTIC_READ},
 * {@code LockModeType.PESSIMISTIC_WRITE}, and
 * {@code LockModeType.PESSIMISTIC_FORCE_INCREMENT} are the
 * following.
 *
 * &lt;p&gt; If transaction T1 calls for a lock of type
 * {@code LockModeType.PESSIMISTIC_READ} or
 * {@code LockModeType.PESSIMISTIC_WRITE} on an object, the entity
 * manager must ensure that neither of the following phenomena can
 * occur: 
 * &lt;ul&gt; 
 * &lt;li&gt; P1 (Dirty read): Transaction T1 modifies a
 * row. Another transaction T2 then reads that row and obtains the
 * modified value, before T1 has committed or rolled back.
 *
 * &lt;li&gt; P2 (Non-repeatable read): Transaction T1 reads a row.
 * Another transaction T2 then modifies or deletes that row, before
 * T1 has committed or rolled back.
 * &lt;/ul&gt;
 *
 * &lt;p&gt; A lock with {@code LockModeType.PESSIMISTIC_WRITE} can be
 * obtained on an entity instance to force serialization among
 * transactions attempting to update the entity data. A lock with
 * {@code LockModeType.PESSIMISTIC_READ} can be used to query data
 * using repeatable-read semantics without the need to reread the
 * data at the end of the transaction to obtain a lock, and without
 * blocking other transactions reading the data. A lock with
 * {@code LockModeType.PESSIMISTIC_WRITE} can be used when querying
 * data and there is a high likelihood of deadlock or update failure
 * among concurrent updating transactions.
 * 
 * &lt;p&gt; The persistence implementation must support the use of locks
 * of type {@code LockModeType.PESSIMISTIC_READ} and
 * {@code LockModeType.PESSIMISTIC_WRITE} with non-versioned entities
 * as well as with versioned entities.
 *
 * &lt;p&gt; When the lock cannot be obtained, and the database locking
 * failure results in transaction-level rollback, the provider must
 * throw the {@link PessimisticLockException} and ensure that the
 * JTA transaction or {@code EntityTransaction} has been marked for
 * rollback.
 * 
 * &lt;p&gt; When the lock cannot be obtained, and the database locking
 * failure results in only statement-level rollback, the provider
 * must throw the {@link LockTimeoutException} (and must not mark
 * the transaction for rollback).
 *
 * @since 1.0
 *
 */</span>
<span class="directive">public</span> <span class="type">enum</span> LockModeType <span class="directive">implements</span> FindOption, RefreshOption {
    <span class="comment">/**
     * Synonymous with {@link #OPTIMISTIC}.
     * &lt;p&gt;
     * {@code OPTIMISTIC} is preferred for new applications.
     *
     */</span>
    READ,

    <span class="comment">/**
     * Synonymous with {@link #OPTIMISTIC_FORCE_INCREMENT}.
     * &lt;p&gt;
     * {@code OPTIMISTIC_FORCE_INCREMENT} is preferred for
     * new applications.
     *
     */</span>
    WRITE,

    <span class="comment">/**
     * Optimistic lock.
     *
     * @since 2.0
     */</span>
    OPTIMISTIC,

    <span class="comment">/**
     * Optimistic lock, with version update.
     *
     * @since 2.0
     */</span>
    OPTIMISTIC_FORCE_INCREMENT,

    <span class="comment">/**
     *
     * Pessimistic read lock.
     *
     * @since 2.0
     */</span>
    PESSIMISTIC_READ,

    <span class="comment">/**
     * Pessimistic write lock.
     *
     * @since 2.0
     */</span>
    PESSIMISTIC_WRITE,

    <span class="comment">/**
     * Pessimistic write lock, with version update.
     *
     * @since 2.0
     */</span>
    PESSIMISTIC_FORCE_INCREMENT,

    <span class="comment">/**
     * No lock.
     *
     * @since 2.0
     */</span>
    NONE
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cache_"><a class="anchor" href="#_cache_"></a>B.5. <code>Cache</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Interface used to interact with the second-level cache.
 * If no second-level cache is in use, the methods of this
 * interface have no effect, except for {@link #contains},
 * which returns false.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Cache</span> {

    <span class="comment">/**
     * Whether the cache contains data for the given entity.
     * @param cls  entity class 
     * @param primaryKey  primary key
     * @return boolean indicating whether the entity is in the cache
     */</span>
    <span class="type">boolean</span> contains(<span class="predefined-type">Class</span>&lt;?&gt; cls, <span class="predefined-type">Object</span> primaryKey);

    <span class="comment">/**
     * Remove the data for the given entity from the cache.
     * @param cls  entity class
     * @param primaryKey  primary key
     */</span>
    <span class="type">void</span> evict(<span class="predefined-type">Class</span>&lt;?&gt; cls, <span class="predefined-type">Object</span> primaryKey);

    <span class="comment">/**
     * Remove the data for entities of the specified class
     * (and its subclasses) from the cache.
     * @param cls  entity class
     */</span>
    <span class="type">void</span> evict(<span class="predefined-type">Class</span>&lt;?&gt; cls);

    <span class="comment">/**
     * Clear the cache.
     */</span>
    <span class="type">void</span> evictAll();

    <span class="comment">/**
     * Return an object of the specified type to allow access to
     * the provider-specific API. If the provider's implementation
     * of the {@code Cache} interface does not support the specified
     * class, the {@link PersistenceException} is thrown.
     * @param cls  the class of the object to be returned.
     *             This is usually either the underlying class
     *             implementing {@code Cache}, or an interface it
     *             implements.
     * @return an instance of the specified type
     * @throws PersistenceException if the provider does not support
     *         the given type
     * @since 2.1
     */</span>
    &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; cls);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_query_"><a class="anchor" href="#_query_"></a>B.6. <code>Query</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.Calendar</span>;
<span class="keyword">import</span> <span class="include">java.util.Date</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.stream.Stream</span>;

<span class="comment">/**
 * Interface used to control query execution.
 *
 * @see TypedQuery
 * @see StoredProcedureQuery
 * @see Parameter
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Query</span> {

    <span class="comment">/**
     * Execute a SELECT query and return the query results as an untyped
     * {@link List}.
     * @return a list of the results, or an empty list if there are
     *         no results
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         {@code NONE} has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="annotation">@SuppressWarnings</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">rawtypes</span><span class="delimiter">&quot;</span></span>})
    <span class="predefined-type">List</span> getResultList();

    <span class="comment">/**
     * Execute a SELECT query and return the query results as an untyped
     * {@link java.util.stream.Stream}.
     *
     * &lt;p&gt;By default, this method delegates to {@code getResultList().stream()},
     * however persistence provider may choose to override this method
     * to provide additional capabilities.
     *
     * @return a stream of the results, or an empty stream if there
     *         are no results
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         {@code NONE} has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     * @see Stream
     * @see #getResultList()
     * @since 2.2
     */</span>
    <span class="annotation">@SuppressWarnings</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">rawtypes</span><span class="delimiter">&quot;</span></span>})
    <span class="keyword">default</span> Stream getResultStream() {
        <span class="keyword">return</span> getResultList().stream();
    }

    <span class="comment">/**
     * Execute a SELECT query that returns a single untyped result.
     * @return the result
     * @throws NoResultException if there is no result
     * @throws NonUniqueResultException if more than one result
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         {@code NONE} has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">Object</span> getSingleResult();

    <span class="comment">/**
     * Execute a SELECT query that returns a single untyped result.
     * @return the result, or null if there is no result
     * @throws NonUniqueResultException if more than one result
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         {@code NONE} has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">Object</span> getSingleResultOrNull();

    <span class="comment">/**
     * Execute an update or delete statement.
     * @return the number of entities updated or deleted
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language SELECT statement or for
     *         a criteria query
     * @throws TransactionRequiredException if there is 
     *         no transaction or the persistence context has not
     *         been joined to the transaction
     * @throws QueryTimeoutException if the statement execution 
     *         exceeds the query timeout value set and only
     *         the statement is rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">int</span> executeUpdate();

    <span class="comment">/**
     * Set the maximum number of results to retrieve.
     * @param maxResult  maximum number of results to retrieve
     * @return the same query instance
     * @throws IllegalArgumentException if the argument is negative
     */</span>
    <span class="predefined-type">Query</span> setMaxResults(<span class="type">int</span> maxResult);

    <span class="comment">/**
     * The maximum number of results the query object was set to retrieve.
     * Returns {@link Integer#MAX_VALUE} if {@link #setMaxResults} was not
     * applied to the query object.
     * @return maximum number of results
     * @since 2.0
     */</span>
    <span class="type">int</span> getMaxResults();

    <span class="comment">/**
     * Set the position of the first result to retrieve.
     * @param startPosition position of the first result, numbered from 0
     * @return the same query instance
     * @throws IllegalArgumentException if the argument is negative
     */</span>
    <span class="predefined-type">Query</span> setFirstResult(<span class="type">int</span> startPosition);

    <span class="comment">/**
     * The position of the first result the query object was set to
     * retrieve. Returns {@code 0} if {@code setFirstResult} was not
     * applied to the query object.
     * @return position of the first result
     * @since 2.0
     */</span>
    <span class="type">int</span> getFirstResult();

    <span class="comment">/**
     * Set a query property or hint. The hints elements may be used 
     * to specify query properties and hints. Properties defined by
     * this specification must be observed by the provider. 
     * Vendor-specific hints that are not recognized by a provider
     * must be silently ignored. Portable applications should not
     * rely on the standard timeout hint. Depending on the database
     * in use and the locking mechanisms used by the provider,
     * this hint may or may not be observed.
     * @param hintName  name of the property or hint
     * @param value  value for the property or hint
     * @return the same query instance
     * @throws IllegalArgumentException if the second argument is not
     *         valid for the implementation
     */</span>
    <span class="predefined-type">Query</span> setHint(<span class="predefined-type">String</span> hintName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Get the properties and hints and associated values that are in
     * effect for the query instance.
     * @return query properties and hints
     * @since 2.0
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getHints();

    <span class="comment">/**
     * Bind the value of a {@code Parameter} object.
     * @param param  parameter object
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter
     *         does not correspond to a parameter of the
     *         query
     * @since 2.0
     */</span>
    &lt;T&gt; <span class="predefined-type">Query</span> setParameter(Parameter&lt;T&gt; param, T value);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Calendar} to a {@link Parameter} object.
     * @param param parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     * @since 2.0
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Query</span> setParameter(Parameter&lt;<span class="predefined-type">Calendar</span>&gt; param, <span class="predefined-type">Calendar</span> value, 
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Date} to a {@link Parameter} object.
     * @param param parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     * @since 2.0
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Query</span> setParameter(Parameter&lt;<span class="predefined-type">Date</span>&gt; param, <span class="predefined-type">Date</span> value, 
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does 
     *         not correspond to a parameter of the query or if
     *         the argument is of incorrect type
     */</span>
    <span class="predefined-type">Query</span> setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Calendar} to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does 
     *         not correspond to a parameter of the query or if
     *         the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Query</span> setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Calendar</span> value, 
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Date} to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does 
     *         not correspond to a parameter of the query or if
     *         the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Query</span> setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Date</span> value, 
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the
     *         query or if the argument is of incorrect type
     */</span>
    <span class="predefined-type">Query</span> setParameter(<span class="type">int</span> position, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Calendar} to a positional
     * parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query or
     *         if the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Query</span> setParameter(<span class="type">int</span> position, <span class="predefined-type">Calendar</span> value,  
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Date} to a positional
     * parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query or
     *         if the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Query</span> setParameter(<span class="type">int</span> position, <span class="predefined-type">Date</span> value,  
                       TemporalType temporalType);

    <span class="comment">/**
     * Get the parameter objects corresponding to the declared
     * parameters of the query.
     * Returns empty set if the query has no parameters.
     * This method is not required to be supported for native
     * queries.
     * @return set of the parameter objects
     * @throws IllegalStateException if invoked on a native
     *         query when the implementation does not support
     *         this use
     * @since 2.0
     */</span>
    <span class="predefined-type">Set</span>&lt;Parameter&lt;?&gt;&gt; getParameters();

    <span class="comment">/**
     * Get the parameter object corresponding to the declared
     * parameter of the given name.
     * This method is not required to be supported for native
     * queries.
     * @param name  parameter name
     * @return parameter object
     * @throws IllegalArgumentException if the parameter of the
     *         specified name does not exist
     * @throws IllegalStateException if invoked on a native
     *         query when the implementation does not support
     *         this use
     * @since 2.0
     */</span>
    Parameter&lt;?&gt; getParameter(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Get the parameter object corresponding to the declared
     * parameter of the given name and type.
     * This method is required to be supported for criteria queries
     * only.
     * @param name  parameter name
     * @param type  type
     * @return parameter object
     * @throws IllegalArgumentException if the parameter of the
     *         specified name does not exist or is not assignable
     *         to the type
     * @throws IllegalStateException if invoked on a native
     *         query or Jakarta Persistence query language query when
     *         the implementation does not support this use
     * @since 2.0
     */</span>
    &lt;T&gt; Parameter&lt;T&gt; getParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * Get the parameter object corresponding to the declared
     * positional parameter with the given position.
     * This method is not required to be supported for native
     * queries.
     * @param position  position
     * @return parameter object
     * @throws IllegalArgumentException if the parameter with the
     *         specified position does not exist
     * @throws IllegalStateException if invoked on a native
     *         query when the implementation does not support
     *         this use
     * @since 2.0
     */</span>
    Parameter&lt;?&gt; getParameter(<span class="type">int</span> position);

    <span class="comment">/**
     * Get the parameter object corresponding to the declared
     * positional parameter with the given position and type.
     * This method is not required to be supported by the provider.
     * @param position  position
     * @param type  type
     * @return parameter object
     * @throws IllegalArgumentException if the parameter with the
     *         specified position does not exist or is not assignable
     *         to the type
     * @throws IllegalStateException if invoked on a native
     *         query or Jakarta Persistence query language query when
     *         the implementation does not support this use
     * @since 2.0
     */</span>
    &lt;T&gt; Parameter&lt;T&gt; getParameter(<span class="type">int</span> position, <span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * Return a boolean indicating whether a value has been bound 
     * to the parameter.
     * @param param parameter object
     * @return boolean indicating whether parameter has been bound
     * @since 2.0
     */</span>
    <span class="type">boolean</span> isBound(Parameter&lt;?&gt; param);

    <span class="comment">/**
     * Return the input value bound to the parameter.
     * (Note that OUT parameters are unbound.)
     * @param param parameter object
     * @return parameter value
     * @throws IllegalArgumentException if the parameter is not 
     *         a parameter of the query
     * @throws IllegalStateException if the parameter has not
     *         been bound
     * @since 2.0
     */</span>
    &lt;T&gt; T getParameterValue(Parameter&lt;T&gt; param);

    <span class="comment">/**
     * Return the input value bound to the named parameter.
     * (Note that OUT parameters are unbound.)
     * @param name  parameter name
     * @return parameter value
     * @throws IllegalStateException if the parameter has not
     *         been bound
     * @throws IllegalArgumentException if the parameter of the
     *         specified name does not exist
     * @since 2.0
     */</span>
    <span class="predefined-type">Object</span> getParameterValue(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Return the input value bound to the positional parameter.
     * (Note that OUT parameters are unbound.)
     * @param position  position
     * @return parameter value
     * @throws IllegalStateException if the parameter has not
     *          been bound
     * @throws IllegalArgumentException if the parameter with the
     *          specified position does not exist
     * @since 2.0
     */</span>
    <span class="predefined-type">Object</span> getParameterValue(<span class="type">int</span> position);

    <span class="comment">/**
     * Set the flush mode type to be used for the query execution.
     * The flush mode type applies to the query regardless of the
     * flush mode type in use for the entity manager.
     * @param flushMode  flush mode
     * @return the same query instance
     */</span>
    <span class="predefined-type">Query</span> setFlushMode(FlushModeType flushMode);

    <span class="comment">/**
     * Get the flush mode in effect for the query execution. 
     * If a flush mode has not been set for the query object, 
     * returns the flush mode in effect for the entity manager.
     * @return flush mode
     * @since 2.0
     */</span>
    FlushModeType getFlushMode();

    <span class="comment">/**
     * Set the lock mode type to be used for the query execution.
     * @param lockMode  lock mode
     * @return the same query instance
     * @throws IllegalStateException if the query is found not to
     *         be a Jakarta Persistence query language SELECT query
     *         or a {@link jakarta.persistence.criteria.CriteriaQuery}
     *         query
     * @since 2.0
     */</span>
    <span class="predefined-type">Query</span> setLockMode(LockModeType lockMode);

    <span class="comment">/**
     * Get the current lock mode for the query. Returns null if a
     * lock mode has not been set on the query object.
     * @return lock mode
     * @throws IllegalStateException if the query is found not to
     *          be a Jakarta Persistence query language SELECT query
     *          or a {@link jakarta.persistence.criteria.CriteriaQuery}
     *          query
     * @since 2.0
     */</span>
    LockModeType getLockMode();

    <span class="comment">/**
     * Set the cache retrieval mode that is in effect during query
     * execution. This cache retrieval mode overrides the cache
     * retrieve mode in use by the entity manager.
     * @param cacheRetrieveMode cache retrieval mode
     * @return the same query instance
     * @since 3.2
     */</span>
    <span class="predefined-type">Query</span> setCacheRetrieveMode(CacheRetrieveMode cacheRetrieveMode);

    <span class="comment">/**
     * Set the cache storage mode that is in effect during query
     * execution. This cache storage mode overrides the cache
     * storage mode in use by the entity manager.
     * @param cacheStoreMode cache storage mode
     * @return the same query instance
     * @since 3.2
     */</span>
    <span class="predefined-type">Query</span> setCacheStoreMode(CacheStoreMode cacheStoreMode);

    <span class="comment">/**
     * The cache retrieval mode that will be in effect during query
     * execution.
     * @since 3.2
     */</span>
    CacheRetrieveMode getCacheRetrieveMode();

    <span class="comment">/**
     * The cache storage mode that will be in effect during query
     * execution.
     * @since 3.2
     */</span>
    CacheStoreMode getCacheStoreMode();

    <span class="comment">/**
     * Set the query timeout, in milliseconds. This is a hint,
     * and is an alternative to {@linkplain #setHint setting
     * the hint} {@code jakarta.persistence.query.timeout}.
     * @param timeout the timeout, in milliseconds, or null to
     *                indicate no timeout
     * @return the same query instance
     * @since 3.2
     */</span>
    <span class="predefined-type">Query</span> setTimeout(<span class="predefined-type">Integer</span> timeout);

    <span class="comment">/**
     * The query timeout.
     * @since 3.2
     */</span>
    <span class="predefined-type">Integer</span> getTimeout();

    <span class="comment">/**
     * Return an object of the specified type to allow access to 
     * a provider-specific API. If the provider implementation of
     * {@code Query} does not support the given type, the
     * {@link PersistenceException} is thrown.
     * @param cls  the type of the object to be returned.
     *             This is usually either the underlying class
     *             implementing {@code Query} or an interface it
     *             implements.
     * @return an instance of the specified class
     * @throws PersistenceException if the provider does not support
     *         the given type
     * @since 2.0
     */</span>
    &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; cls);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="typedquery"><a class="anchor" href="#typedquery"></a>B.7. <code>TypedQuery</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Date</span>;
<span class="keyword">import</span> <span class="include">java.util.Calendar</span>;
<span class="keyword">import</span> <span class="include">java.util.stream.Stream</span>;

<span class="comment">/**
 * Interface used to control the execution of typed queries.
 *
 * @param &lt;X&gt; query result type
 *
 * @see Query
 * @see Parameter
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TypedQuery</span>&lt;X&gt; <span class="directive">extends</span> <span class="predefined-type">Query</span> {
        
    <span class="comment">/**
     * Execute a SELECT query and return the query results as a typed
     * {@link List List&amp;lt;X&amp;gt;}.
     * @return a list of the results, each of type {@link X}, or an
     *         empty list if there are no results
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         {@code NONE} has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">List</span>&lt;X&gt; getResultList();

    <span class="comment">/**
     * Execute a SELECT query and return the query result as a typed
     * {@link java.util.stream.Stream Stream&amp;lt;X&amp;gt;}.
     *
     * &lt;p&gt;By default, this method delegates to {@link List#stream()
     * getResultList().stream()}, however, persistence provider may
     * choose to override this method to provide additional capabilities.
     *
     * @return a stream of the results, each of type {@link X}, or an
     *         empty stream if there are no results
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         {@code NONE} has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     * @see Stream
     * @see #getResultList()
     * @since 2.2
     */</span>
    <span class="keyword">default</span> Stream&lt;X&gt; getResultStream() {
        <span class="keyword">return</span> getResultList().stream();
    }

    <span class="comment">/**
     * Execute a SELECT query that returns a single result.
     * @return the result, of type {@link X}
     * @throws NoResultException if there is no result
     * @throws NonUniqueResultException if more than one result
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         {@code NONE} has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    X getSingleResult();

    <span class="comment">/**
     * Execute a SELECT query that returns a single untyped result.
     * @return the result, of type {@link X}, or null if there is no
     *         result
     * @throws NonUniqueResultException if more than one result
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         {@code NONE} has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    X getSingleResultOrNull();

    <span class="comment">/**
     * Set the maximum number of results to retrieve.
     * @param maxResult  maximum number of results to retrieve
     * @return the same query instance
     * @throws IllegalArgumentException if the argument is negative
     */</span>
    TypedQuery&lt;X&gt; setMaxResults(<span class="type">int</span> maxResult);

    <span class="comment">/**
     * Set the position of the first result to retrieve.
     * @param startPosition position of the first result, 
     *        numbered from 0
     * @return the same query instance
     * @throws IllegalArgumentException if the argument is negative
     */</span>
    TypedQuery&lt;X&gt; setFirstResult(<span class="type">int</span> startPosition);

    <span class="comment">/**
     * Set a query property or hint. The hints elements may be used 
     * to specify query properties and hints. Properties defined by
     * this specification must be observed by the provider. 
     * Vendor-specific hints that are not recognized by a provider
     * must be silently ignored. Portable applications should not
     * rely on the standard timeout hint. Depending on the database
     * in use and the locking mechanisms used by the provider,
     * this hint may or may not be observed.
     * @param hintName  name of property or hint
     * @param value  value for the property or hint
     * @return the same query instance
     * @throws IllegalArgumentException if the second argument is not
     *         valid for the implementation
     */</span>
    TypedQuery&lt;X&gt; setHint(<span class="predefined-type">String</span> hintName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind the value of a {@code Parameter} object.
     * @param param  parameter object
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter
     *         does not correspond to a parameter of the
     *         query
     */</span>
     &lt;T&gt; TypedQuery&lt;X&gt; setParameter(Parameter&lt;T&gt; param, T value);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Calendar} to a {@link Parameter} object.
     * @param param  parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    TypedQuery&lt;X&gt; setParameter(Parameter&lt;<span class="predefined-type">Calendar</span>&gt; param, 
                               <span class="predefined-type">Calendar</span> value,  
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Date} to a {@link Parameter} object.
     * @param param  parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    TypedQuery&lt;X&gt; setParameter(Parameter&lt;<span class="predefined-type">Date</span>&gt; param, <span class="predefined-type">Date</span> value,  
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does 
     *         not correspond to a parameter of the query or if
     *         the argument is of incorrect type
     */</span>
    TypedQuery&lt;X&gt; setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Calendar} to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if
     *         the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    TypedQuery&lt;X&gt; setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Calendar</span> value, 
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Date} to a named parameter.
     * @param name   parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if
     *         the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    TypedQuery&lt;X&gt; setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Date</span> value, 
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the
     *         query or if the argument is of incorrect type
     */</span>
    TypedQuery&lt;X&gt; setParameter(<span class="type">int</span> position, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Calendar} to a positional
     * parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query
     *         or if the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    TypedQuery&lt;X&gt; setParameter(<span class="type">int</span> position, <span class="predefined-type">Calendar</span> value,  
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Date} to a positional
     * parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
      *        correspond to a positional parameter of the query
     *         or if the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    TypedQuery&lt;X&gt; setParameter(<span class="type">int</span> position, <span class="predefined-type">Date</span> value,  
                               TemporalType temporalType);

     <span class="comment">/**
      * Set the flush mode type to be used for the query execution.
      * The flush mode type applies to the query regardless of the
      * flush mode type in use for the entity manager.
      * @param flushMode  flush mode
      * @return the same query instance
      */</span>
     TypedQuery&lt;X&gt; setFlushMode(FlushModeType flushMode);

     <span class="comment">/**
      * Set the lock mode type to be used for the query execution.
      * @param lockMode  lock mode
      * @return the same query instance
      * @throws IllegalStateException if the query is found not to 
      *         be a Jakarta Persistence query language SELECT query
      *         or a {@link jakarta.persistence.criteria.CriteriaQuery}
      *         query
      */</span>
     TypedQuery&lt;X&gt; setLockMode(LockModeType lockMode);

    <span class="comment">/**
     * Set the cache retrieval mode that is in effect during
     * query execution. This cache retrieval mode overrides the
     * cache retrieve mode in use by the entity manager.
     * @param cacheRetrieveMode cache retrieval mode
     * @return the same query instance
     * @since 3.2
     */</span>
    TypedQuery&lt;X&gt; setCacheRetrieveMode(CacheRetrieveMode cacheRetrieveMode);

    <span class="comment">/**
     * Set the cache storage mode that is in effect during
     * query execution. This cache storage mode overrides the
     * cache storage mode in use by the entity manager.
     * @param cacheStoreMode cache storage mode
     * @return the same query instance
     * @since 3.2
     */</span>
    TypedQuery&lt;X&gt; setCacheStoreMode(CacheStoreMode cacheStoreMode);

    <span class="comment">/**
     * Set the query timeout, in milliseconds. This is a hint,
     * and is an alternative to {@linkplain #setHint setting
     * the hint} {@code jakarta.persistence.query.timeout}.
     * @param timeout the timeout, in milliseconds, or null to
     *                indicate no timeout
     * @return the same query instance
     * @since 3.2
     */</span>
    TypedQuery&lt;X&gt; setTimeout(<span class="predefined-type">Integer</span> timeout);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="storedprocedurequery"><a class="anchor" href="#storedprocedurequery"></a>B.8. <code>StoredProcedureQuery</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.Calendar</span>;
<span class="keyword">import</span> <span class="include">java.util.Date</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * Interface used to control stored procedure query execution.
 *
 * &lt;p&gt;
 * Stored procedure query execution may be controlled in accordance with 
 * the following:
 * &lt;ul&gt;
 * &lt;li&gt;The {@link #setParameter} methods are used to set the values of
 * all required {@code IN} and {@code INOUT} parameters. It is not
 * required to set the values of stored procedure parameters for which
 * default values have been defined by the stored procedure.&lt;/li&gt;
 * &lt;li&gt; When {@link #getResultList} and {@link #getSingleResult} are
 * called on a {@code StoredProcedureQuery} object, the provider calls
 * {@link #execute} on an unexecuted stored procedure query before
 * processing {@code getResultList} or {@code getSingleResult}.&lt;/li&gt;
 * &lt;li&gt; When {@link #executeUpdate} is called on a
 * {@code StoredProcedureQuery} object, the provider will call
 * {@link #execute} on an unexecuted stored procedure query, followed
 * by {@link #getUpdateCount}. The results of {@code executeUpdate} will
 * be those of {@code getUpdateCount}.&lt;/li&gt;
 * &lt;li&gt; The {@link #execute} method supports both the simple case where
 * scalar results are passed back only via {@code INOUT} and {@code OUT}
 * parameters as well as the most general case (multiple result sets
 * and/or update counts, possibly also in combination with output
 * parameter values).&lt;/li&gt;
 * &lt;li&gt; The {@code execute} method returns true if the first result is
 * a result set, and false if it is an update count or there are no
 * results other than through {@code INOUT} and {@code OUT} parameters,
 * if any.&lt;/li&gt;
 * &lt;li&gt; If the {@code execute} method returns true, the pending result
 * set can be obtained by calling {@link #getResultList} or
 * {@link #getSingleResult}.&lt;/li&gt;
 * &lt;li&gt; The {@link #hasMoreResults} method can then be used to test for
 * further results.&lt;/li&gt;
 * &lt;li&gt; If {@code execute} or {@code hasMoreResults} returns false, the
 * {@link #getUpdateCount} method can be called to obtain the pending
 * result if it is an update count. The {@code getUpdateCount} method
 * will return either the update count (zero or greater) or -1 if there
 * is no update count (i.e., either the next result is a result set or
 * there is no next update count).&lt;/li&gt;
 * &lt;li&gt; For portability, results that correspond to JDBC result sets
 * and update counts need to be processed before the values of any
 * {@code INOUT} or {@code OUT} parameters are extracted.&lt;/li&gt;
 * &lt;li&gt; After results returned through {@link #getResultList} and
 * {@link #getUpdateCount} have been exhausted, results returned through
 * {@code INOUT} and {@code OUT} parameters can be retrieved.&lt;/li&gt;
 * &lt;li&gt; The {@link #getOutputParameterValue} methods are used to
 * retrieve the values passed back from the procedure through
 * {@code INOUT} and {@code OUT} parameters.&lt;/li&gt;
 * &lt;li&gt; When using {@code REF_CURSOR} parameters for result sets the
 * update counts should be exhausted before calling {@link #getResultList}
 * to retrieve the result set. Alternatively, the {@code REF_CURSOR}
 * result set can be retrieved through {@link #getOutputParameterValue}.
 * Result set mappings are applied to results corresponding to
 * {@code REF_CURSOR} parameters in the order the {@code REF_CURSOR}
 * parameters were registered with the query.&lt;/li&gt;
 * &lt;li&gt; In the simplest case, where results are returned only via
 * {@code INOUT} and {@code OUT} parameters, {@code execute} can be
 * followed immediately by calls to {@link #getOutputParameterValue}.
 * &lt;/li&gt;
 * &lt;/ul&gt;
 *
 * @see Query
 * @see Parameter
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">StoredProcedureQuery</span> <span class="directive">extends</span> <span class="predefined-type">Query</span> {

    <span class="comment">/**
     * Set a query property or hint. The hints elements may be used 
     * to specify query properties and hints. Properties defined by
     * this specification must be observed by the provider. 
     * Vendor-specific hints that are not recognized by a provider
     * must be silently ignored. Portable applications should not
     * rely on the standard timeout hint. Depending on the database
     * in use, this hint may or may not be observed.
     * @param hintName  name of the property or hint
     * @param value  value for the property or hint
     * @return the same query instance
     * @throws IllegalArgumentException if the second argument is not
     *         valid for the implementation
     */</span>
    StoredProcedureQuery setHint(<span class="predefined-type">String</span> hintName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind the value of a {@code Parameter} object.
     * @param param  parameter object
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     */</span>
    &lt;T&gt; StoredProcedureQuery setParameter(Parameter&lt;T&gt; param, 
                                          T value);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Calendar} to a {@link Parameter} object.
     * @param param parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    StoredProcedureQuery setParameter(Parameter&lt;<span class="predefined-type">Calendar</span>&gt; param,
                                      <span class="predefined-type">Calendar</span> value, 
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@link java.util.Date} to a {@link Parameter} object.
     * @param param parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    StoredProcedureQuery setParameter(Parameter&lt;<span class="predefined-type">Date</span>&gt; param,
                                      <span class="predefined-type">Date</span> value,
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does 
     *         not correspond to a parameter of the query or if the
     *         argument is of incorrect type
     */</span>
    StoredProcedureQuery setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of {@code java.util.Calendar} to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does 
     *         not correspond to a parameter of the query or if the
     *         value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    StoredProcedureQuery setParameter(<span class="predefined-type">String</span> name, 
                                      <span class="predefined-type">Calendar</span> value, 
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@code java.util.Date} to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does 
     *         not correspond to a parameter of the query or if the
     *         value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    StoredProcedureQuery setParameter(<span class="predefined-type">String</span> name, 
                                      <span class="predefined-type">Date</span> value, 
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query
     *         or if the argument is of incorrect type
     */</span>
    StoredProcedureQuery setParameter(<span class="type">int</span> position, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of {@code java.util.Calendar} to a positional
     * parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query or
     *         if the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    StoredProcedureQuery setParameter(<span class="type">int</span> position, 
                                      <span class="predefined-type">Calendar</span> value,  
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of {@code java.util.Date} to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query or
     *         if the value argument is of incorrect type
     * @deprecated Newly-written code should use the date/time types
     *             defined in {@link java.time}.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    StoredProcedureQuery setParameter(<span class="type">int</span> position, 
                                      <span class="predefined-type">Date</span> value,  
                                      TemporalType temporalType);

    <span class="comment">/**
     * Set the flush mode type to be used for the query execution.
     * The flush mode type applies to the query regardless of the
     * flush mode type in use for the entity manager.
     * @param flushMode  flush mode
     * @return the same query instance
     */</span>
    StoredProcedureQuery setFlushMode(FlushModeType flushMode);

    <span class="comment">/**
     * Set the cache retrieval mode that is in effect during
     * query execution. This cache retrieval mode overrides the
     * cache retrieve mode in use by the entity manager.
     * @param cacheRetrieveMode cache retrieval mode
     * @return the same query instance
     * @since 3.2
     */</span>
    StoredProcedureQuery setCacheRetrieveMode(CacheRetrieveMode cacheRetrieveMode);

    <span class="comment">/**
     * Set the cache storage mode that is in effect during
     * query execution. This cache storage mode overrides the
     * cache storage mode in use by the entity manager.
     * @param cacheStoreMode cache storage mode
     * @return the same query instance
     * @since 3.2
     */</span>
    StoredProcedureQuery setCacheStoreMode(CacheStoreMode cacheStoreMode);

    <span class="comment">/**
     * Set the query timeout, in milliseconds. This is a hint,
     * and is an alternative to {@linkplain #setHint setting
     * the hint} {@code jakarta.persistence.query.timeout}.
     * @param timeout the timeout, in milliseconds, or null to
     *                indicate no timeout
     * @return the same query instance
     * @since 3.2
     */</span>
    StoredProcedureQuery setTimeout(<span class="predefined-type">Integer</span> timeout);

    <span class="comment">/**
     * Register a positional parameter.
     * All parameters must be registered.
     * @param position  parameter position
     * @param type  type of the parameter
     * @param mode  parameter mode 
     * @return the same query instance
     */</span>
    StoredProcedureQuery registerStoredProcedureParameter(
          <span class="type">int</span> position,
          <span class="predefined-type">Class</span>&lt;?&gt; type,
          ParameterMode mode);

    <span class="comment">/**
     * Register a named parameter.
     * @param parameterName  name of the parameter as registered or
     *            specified in metadata
     * @param type  type of the parameter
     * @param mode  parameter mode 
     * @return the same query instance
     */</span>
    StoredProcedureQuery registerStoredProcedureParameter(
          <span class="predefined-type">String</span> parameterName,
          <span class="predefined-type">Class</span>&lt;?&gt; type,
          ParameterMode mode);

    <span class="comment">/**
     * Retrieve a value passed back from the procedure
     * through an INOUT or OUT parameter.
     * For portability, all results corresponding to result sets
     * and update counts must be retrieved before the values of 
     * output parameters.
     * @param position  parameter position
     * @return the result that is passed back through the parameter
     * @throws IllegalArgumentException if the position does
     *         not correspond to a parameter of the query or is
     *         not an INOUT or OUT parameter
     */</span>
    <span class="predefined-type">Object</span> getOutputParameterValue(<span class="type">int</span> position);

    <span class="comment">/**
     * Retrieve a value passed back from the procedure
     * through an INOUT or OUT parameter.
     * For portability, all results corresponding to result sets
     * and update counts must be retrieved before the values of 
     * output parameters.
     * @param parameterName  name of the parameter as registered or
     *        specified in metadata
     * @return the result that is passed back through the parameter
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or is
     *         not an INOUT or OUT parameter
     */</span>
    <span class="predefined-type">Object</span> getOutputParameterValue(<span class="predefined-type">String</span> parameterName);

    <span class="comment">/**
     * Return true if the first result corresponds to a result set,
     * and false if it is an update count or if there are no results
     * other than through INOUT and OUT parameters, if any.
     * @return  true if first result corresponds to result set
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">boolean</span> execute();

    <span class="comment">/**
     * Return the update count of -1 if there is no pending result or
     * if the first result is not an update count.  The provider will
     * call {@code execute} on the query if needed.
     * @return the update count or -1 if there is no pending result
     * or if the next result is not an update count.
     * @throws TransactionRequiredException if there is 
     *         no transaction or the persistence context has not
     *         been joined to the transaction
     * @throws QueryTimeoutException if the statement execution 
     *         exceeds the query timeout value set and only
     *         the statement is rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">int</span> executeUpdate();

    <span class="comment">/**
     * Retrieve the list of results from the next result set.
     * The provider will call {@code execute} on the query
     * if needed.
     * A {@code REF_CURSOR} result set, if any, is retrieved
     * in the order the {@code REF_CURSOR} parameter was 
     * registered with the query.
     * @return a list of the results or null is the next item is not 
     * a result set
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">List</span> getResultList();

    <span class="comment">/**
     * Retrieve a single result from the next result set.
     * The provider will call {@code execute} on the query
     * if needed.
     * A {@code REF_CURSOR} result set, if any, is retrieved
     * in the order the {@code REF_CURSOR} parameter was 
     * registered with the query.
     * @return the result or null if the next item is not a result set
     * @throws NoResultException if there is no result in the next
     *         result set
     * @throws NonUniqueResultException if more than one result
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">Object</span> getSingleResult();

    <span class="comment">/**
     * Retrieve a single result from the next result set.
     * The provider will call {@code execute} on the query
     * if needed.
     * A {@code REF_CURSOR} result set, if any, is retrieved
     * in the order the {@code REF_CURSOR} parameter was
     * registered with the query.
     * @return the result or null if the next item is not a result set
     *         or if there is no result in the next result set
     * @throws NonUniqueResultException if more than one result
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">Object</span> getSingleResultOrNull();

    <span class="comment">/**
     * Return true if the next result corresponds to a result set,
     * and false if it is an update count or if there are no results
     * other than through INOUT and OUT parameters, if any.
     * @return true if next result corresponds to result set
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">boolean</span> hasMoreResults();

    <span class="comment">/**
     * Return the update count or  -1 if there is no pending result
     * or if the next result is not an update count.
     * @return update count or -1 if there is no pending result or if
     *         the next result is not an update count
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds 
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">int</span> getUpdateCount();

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tuple_"><a class="anchor" href="#_tuple_"></a>B.9. <code>Tuple</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * Interface for extracting the elements of a query result tuple.
 *
 * @see TupleElement
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Tuple</span> {

    <span class="comment">/**
     * Get the value of the specified tuple element.
     * @param tupleElement  tuple element
     * @return value of tuple element
     * @throws IllegalArgumentException if tuple element
     *         does not correspond to an element in the
     *         query result tuple
     */</span>
    &lt;X&gt; X get(TupleElement&lt;X&gt; tupleElement);

    <span class="comment">/**
     * Get the value of the tuple element to which the
     * specified alias has been assigned.
     * @param alias  alias assigned to tuple element
     * @param type of the tuple element
     * @return value of the tuple element
     * @throws IllegalArgumentException if alias
     *         does not correspond to an element in the
     *         query result tuple or element cannot be
     *         assigned to the specified type
     */</span>
    &lt;X&gt; X get(<span class="predefined-type">String</span> alias, <span class="predefined-type">Class</span>&lt;X&gt; type); 

    <span class="comment">/**
     * Get the value of the tuple element to which the
     * specified alias has been assigned.
     * @param alias  alias assigned to tuple element
     * @return value of the tuple element
     * @throws IllegalArgumentException if alias
      *        does not correspond to an element in the
     *         query result tuple
     */</span>
    <span class="predefined-type">Object</span> get(<span class="predefined-type">String</span> alias); 

    <span class="comment">/**
     * Get the value of the element at the specified
     * position in the result tuple. The first position
     * is 0.
     * @param i  position in result tuple
     * @param type  type of the tuple element
     * @return value of the tuple element
     * @throws IllegalArgumentException if i exceeds
     *         length of result tuple  or element cannot
     *         be assigned to the specified type
     */</span>
    &lt;X&gt; X get(<span class="type">int</span> i, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Get the value of the element at the specified
     * position in the result tuple. The first position
     * is 0.
     * @param i  position in result tuple
     * @return value of the tuple element
     * @throws IllegalArgumentException if i exceeds
     *         length of result tuple
     */</span>
    <span class="predefined-type">Object</span> get(<span class="type">int</span> i);

    <span class="comment">/**
     * Return the values of the result tuple elements as
     * an array.
     * @return tuple element values
     */</span>
    <span class="predefined-type">Object</span><span class="type">[]</span> toArray();

    <span class="comment">/**
     * Return the tuple elements.
     * @return tuple elements
     */</span>
    <span class="predefined-type">List</span>&lt;TupleElement&lt;?&gt;&gt; getElements();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tupleelement_"><a class="anchor" href="#_tupleelement_"></a>B.10. <code>TupleElement</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * The {@code TupleElement} interface defines an element that is
 * returned in a query result tuple.
 * 
 * @param &lt;X&gt; the type of the element
 *
 * @see Tuple
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TupleElement</span>&lt;X&gt; {
    
    <span class="comment">/**
     * Return the Java type of the tuple element.
     * @return the Java type of the tuple element
     */</span>
    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt; getJavaType();

    <span class="comment">/**
     * Return the alias assigned to the tuple element or null, 
     * if no alias has been assigned.
     * @return alias
     */</span>
    <span class="predefined-type">String</span> getAlias();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="parameter"><a class="anchor" href="#parameter"></a>B.11. <code>Parameter</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Type for query parameter objects.
 *
 * @param &lt;T&gt; the type of the parameter
 *
 * @see Query
 * @see TypedQuery
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Parameter</span>&lt;T&gt; {

    <span class="comment">/**
     * Return the parameter name, or null if the parameter is
     * not a named parameter or no name has been assigned.
     * @return parameter name
     */</span>
    <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     * Return the parameter position, or null if the parameter
     * is not a positional parameter. 
     * @return position of parameter
     */</span>
    <span class="predefined-type">Integer</span> getPosition();

    <span class="comment">/**
     * Return the Java type of the parameter. Values bound to
     * the parameter must be assignable to this type.
     * This method is required to be supported for criteria
     * queries only. Applications that use this method for
     * Jakarta Persistence query language queries and native
     * queries will not be portable.
     * @return the Java type of the parameter
     * @throws IllegalStateException if invoked on a parameter
     *         obtained from a query language query or native
     *         query when the implementation does not support
     *         this usage
     */</span>
     <span class="predefined-type">Class</span>&lt;T&gt; getParameterType();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="graph"><a class="anchor" href="#graph"></a>B.12. <code>Graph</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Attribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.MapAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.PluralAttribute</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * Declares operations common to {@link EntityGraph} and {@link Subgraph}.
 *
 * @see EntityGraph
 * @see Subgraph
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Graph</span>&lt;T&gt; {

    <span class="comment">/**
     * Get an existing attribute node for the attribute with the given
     * name, or add a new attribute node if there is no existing node.
     *
     * @param attributeName  name of the attribute
     * @return the attribute node
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     *
     * @since 3.2
     */</span>
    &lt;Y&gt; AttributeNode&lt;Y&gt; addAttributeNode(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Get an existing attribute node for the given attribute, or add
     * a new attribute node if there is no existing node.
     *
     * @param attribute  attribute
     * @return the attribute node
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     *
     * @since 3.2
     */</span>
    &lt;Y&gt; AttributeNode&lt;Y&gt; addAttributeNode(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, Y&gt; attribute);

    <span class="comment">/**
     * Determine if there is an existing attribute node for the attribute
     * with the given name.
     *
     * @param attributeName  name of the attribute
     * @return true if there is an existing attribute node
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     *
     * @since 3.2
     */</span>
    <span class="type">boolean</span> hasAttributeNode(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Determine if there is an existing attribute node for the given
     * attribute.
     *
     * @param attribute  attribute
     * @return true if there is an existing attribute node
     *
     * @since 3.2
     */</span>
    <span class="type">boolean</span> hasAttributeNode(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, ?&gt; attribute);

    <span class="comment">/**
     * Get an existing attribute node for the attribute with the given
     * name.
     *
     * @param attributeName  name of the attribute
     * @return the attribute node
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws java.util.NoSuchElementException if there is no existing
     *         node for the attribute
     *
     * @since 3.2
     */</span>
    &lt;Y&gt; AttributeNode&lt;Y&gt; getAttributeNode(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Get an existing attribute node for the given attribute.
     *
     * @param attribute  attribute
     * @return the attribute node
     * @throws java.util.NoSuchElementException if there is no existing
     *         node for the attribute
     *
     * @since 3.2
     */</span>
    &lt;Y&gt; AttributeNode&lt;Y&gt; getAttributeNode(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, Y&gt; attribute);

    <span class="comment">/**
     * Remove an attribute node from the entity graph.
     * When this graph is interpreted as a load graph, this operation
     * suppresses inclusion of an attribute mapped for eager fetching.
     * The effect of this call may be overridden by subsequent
     * invocations of {@link #addAttributeNode} or {@link #addSubgraph}.
     * If there is no existing node for the given attribute name, this
     * operation has no effect.
     *
     * @param attributeName  name of the attribute
     *
     * @since 3.2
     */</span>
    <span class="type">void</span> removeAttributeNode(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Remove an attribute node from the entity graph.
     * When this graph is interpreted as a load graph, this operation
     * suppresses inclusion of an attribute mapped for eager fetching.
     * The effect of this call may be overridden by subsequent
     * invocations of {@link #addAttributeNode} or {@link #addSubgraph}.
     * If there is no existing node for the given attribute, this
     * operation has no effect.
     *
     * @param attribute  attribute
     *
     * @since 3.2
     */</span>
    <span class="type">void</span> removeAttributeNode(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, ?&gt; attribute);

    <span class="comment">/**
     * Remove all attribute nodes of the given attribute types.
     * When this graph is interpreted as a load graph, this operation
     * suppresses inclusion of attributes mapped for eager fetching.
     * The effect of this call may be overridden by subsequent
     * invocations of {@link #addAttributeNode} or {@link #addSubgraph}.
     *
     * @since 3.2
     */</span>
    <span class="type">void</span> removeAttributeNodes(<span class="predefined-type">Attribute</span>.PersistentAttributeType nodeTypes);

    <span class="comment">/**
     * Add one or more attribute nodes to the entity graph.
     * If there is already an existing node for one of the given
     * attribute names, that particular argument is ignored and
     * has no effect.
     *
     * @param attributeName  name of the attribute     
     * @throws IllegalArgumentException if the attribute is not an 
     *         attribute of this managed type.
     * @throws IllegalStateException if the EntityGraph has been 
     *         statically defined
     */</span>
    <span class="type">void</span> addAttributeNodes(<span class="predefined-type">String</span>... attributeName);

    <span class="comment">/**
     * Add one or more attribute nodes to the entity graph.
     * If there is already an existing node for one of the given
     * attributes, that particular argument is ignored and has no
     * effect.
     *
     * @param attribute  attribute
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="type">void</span> addAttributeNodes(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, ?&gt;... attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type. This allows for construction of multi-node entity graphs
     * that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target 
     *         type is not a managed type
     * @throws IllegalStateException if the EntityGraph has been 
     *         statically defined
     */</span>
    &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, X&gt; attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type with inheritance.  This allows for multiple subclass
     * subgraphs to be defined for this node of the entity
     * graph. Subclass subgraphs will automatically include the
     * specified attributes of superclass subgraphs.
     *
     * @param attribute  attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     *
     * @since 3.2
     */</span>
    &lt;Y&gt; Subgraph&lt;Y&gt; addTreatedSubgraph(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, ? <span class="local-variable">super</span> Y&gt; attribute, <span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed type
     * with inheritance. This allows for multiple subclass
     * subgraphs to be defined for this node of the entity graph.
     * Subclass subgraphs will automatically include the specified
     * attributes of superclass subgraphs
     *
     * @param attribute  attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target 
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been 
     *         statically defined
     * @deprecated use {@link #addTreatedSubgraph(Attribute, Class)}
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>, forRemoval = <span class="predefined-constant">true</span>)
    &lt;X&gt; Subgraph&lt;? <span class="directive">extends</span> X&gt; addSubgraph(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, X&gt; attribute, <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed type.
     * This allows for construction of multi-node entity graphs
     * that include related managed types.
     *
     * @param attributeName  name of the attribute 
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute is not an 
     *         attribute of this managed type.
     * @throws IllegalArgumentException if the attribute's target 
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been 
     *         statically defined
     */</span>
    &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type with inheritance.  This allows for multiple subclass
     * subgraphs to be defined for this node of the entity
     * graph. Subclass subgraphs will automatically include the
     * specified attributes of superclass subgraphs
     *
     * @param attributeName  name of the attribute 
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute is not 
     *         an attribute of this managed type.
     * @throws IllegalArgumentException if the attribute's target 
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been 
      *        statically defined
     */</span>
    &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a collection element
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the element attribute
     * @throws IllegalArgumentException if the attribute's target type
     *         is not an entity
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     *
     * @since 3.2
     */</span>
    &lt;E&gt; Subgraph&lt;E&gt; addElementSubgraph(PluralAttribute&lt;? <span class="local-variable">super</span> T, ?, E&gt; attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a collection element
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the element attribute
     * @throws IllegalArgumentException if the attribute's target type
     *         is not an entity
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     *
     * @since 3.2
     */</span>
    &lt;E&gt; Subgraph&lt;E&gt; addTreatedElementSubgraph(PluralAttribute&lt;? <span class="local-variable">super</span> T, ?, ? <span class="local-variable">super</span> E&gt; attribute, <span class="predefined-type">Class</span>&lt;E&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a collection element
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attributeName  name of the attribute
     * @return subgraph for the element attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    &lt;X&gt; Subgraph&lt;X&gt; addElementSubgraph(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a collection element
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attributeName  name of the attribute
     * @param type  entity subclass
     * @return subgraph for the element attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    &lt;X&gt; Subgraph&lt;X&gt; addElementSubgraph(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type entity
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    &lt;K&gt; Subgraph&lt;K&gt; addMapKeySubgraph(MapAttribute&lt;? <span class="local-variable">super</span> T, K, ?&gt; attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type with inheritance. This allows for
     * construction of multi-node entity graphs that include related
     * managed types.  Subclass subgraphs will automatically include
     * the specified attributes of superclass subgraphs
     *
     * @param attribute  attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type entity
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    &lt;K&gt; Subgraph&lt;K&gt; addTreatedMapKeySubgraph(MapAttribute&lt;? <span class="local-variable">super</span> T, ? <span class="local-variable">super</span> K, ?&gt; attribute, <span class="predefined-type">Class</span>&lt;K&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute's target 
     *         type is not a managed type entity
     * @throws IllegalStateException if this EntityGraph has been 
     *         statically defined
     * @deprecated use {@link #addMapKeySubgraph(MapAttribute)}
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>, forRemoval = <span class="predefined-constant">true</span>)
    &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, X&gt; attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type with inheritance. This allows for
     * construction of multi-node entity graphs that include related
     * managed types.  Subclass subgraphs will automatically include
     * the specified attributes of superclass subgraphs
     *
     * @param attribute  attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target 
     *         type is not a managed type entity
     * @throws IllegalStateException if this EntityGraph has been 
     *         statically defined
     * @deprecated use {@link #addTreatedMapKeySubgraph(MapAttribute, Class)}
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>, forRemoval = <span class="predefined-constant">true</span>)
    &lt;X&gt; Subgraph&lt;? <span class="directive">extends</span> X&gt; addKeySubgraph(<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> T, X&gt; attribute, <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attributeName  name of the attribute
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute is not an 
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target 
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type with inheritance. This allows for
     * construction of multi-node entity graphs that include related
     * managed types.  Subclass subgraphs will include the specified
     * attributes of superclass subgraphs
     *
     * @param attributeName  name of the attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute is not an 
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been 
     *         statically defined
     */</span>
    &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Return the attribute nodes corresponding to the attributes of
     * this managed type that are included in the graph.
     * @return list of attribute nodes included in the graph or an
     * empty list if none have been defined
     */</span>
    <span class="predefined-type">List</span>&lt;AttributeNode&lt;?&gt;&gt; getAttributeNodes();

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="entitygraph"><a class="anchor" href="#entitygraph"></a>B.13. <code>EntityGraph</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * This type represents the root of an entity graph that will be
 * used as a template to define the attribute nodes and boundaries
 * of a graph of entities and entity relationships. The root must
 * be an entity type.
 * &lt;p&gt;
 * The methods to add subgraphs implicitly create the corresponding
 * attribute nodes as well; such attribute nodes should not be
 * redundantly specified.
 *
 * @param &lt;T&gt; The type of the root entity.
 *
 * @see AttributeNode
 * @see Subgraph
 * @see NamedEntityGraph
 *
 * @see EntityManager#createEntityGraph(Class)
 * @see EntityManager#createEntityGraph(String)
 * @see EntityManager#getEntityGraph(String)
 * @see EntityManagerFactory#addNamedEntityGraph(String, EntityGraph)
 * @see EntityManager#find(EntityGraph, Object, FindOption...)
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityGraph</span>&lt;T&gt; <span class="directive">extends</span> Graph&lt;T&gt; {

    <span class="comment">/**
     * Return the name of a named {@code EntityGraph} (an entity
     * graph defined by means of the {@link NamedEntityGraph}
     * annotation, XML descriptor element, or added by means of the
     * {@link EntityManagerFactory#addNamedEntityGraph} method).
     * Returns null if the {@code EntityGraph} is not a named
     * {@code EntityGraph}.
     */</span>
    <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     * Add additional attributes to this entity graph that
     * correspond to attributes of subclasses of the entity type of
     * this {@code EntityGraph}. Subclass subgraphs automatically
     * include the specified attributes of superclass subgraphs.
     *
     * @param type  entity subclass
     * @return subgraph for the subclass
     * @throws IllegalArgumentException if the type is not an entity type
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    &lt;S <span class="directive">extends</span> T&gt; Subgraph&lt;S&gt; addTreatedSubgraph(<span class="predefined-type">Class</span>&lt;S&gt; type);

    <span class="comment">/**
     * Add additional attributes to this entity graph that
     * correspond to attributes of subclasses of the entity type of
     * this {@code EntityGraph}. Subclass subgraphs automatically
     * include the specified attributes of superclass subgraphs.
     *
     * @param type  entity subclass
     * @return subgraph for the subclass
     * @throws IllegalArgumentException if the type is not an entity type
     * @throws IllegalStateException if the EntityGraph has been 
     *         statically defined
     * @deprecated use {@link #addTreatedSubgraph(Class)}
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>, forRemoval = <span class="predefined-constant">true</span>)
    &lt;T&gt; Subgraph&lt;? <span class="directive">extends</span> T&gt; addSubclassSubgraph(<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> T&gt; type);

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="subgraph"><a class="anchor" href="#subgraph"></a>B.14. <code>Subgraph</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * This type represents a subgraph for an attribute node that
 * corresponds to a managed type. Using this class, an entity
 * subgraph can be embedded within an {@link EntityGraph}.
 *
 * @param &lt;T&gt; The type of the attribute.
 *
 * @see EntityGraph
 * @see AttributeNode
 * @see NamedSubgraph
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Subgraph</span>&lt;T&gt; <span class="directive">extends</span> Graph&lt;T&gt; {

    <span class="comment">/**
     * Return the type for which this subgraph was defined.
     * @return managed type referenced by the subgraph
     */</span>
    <span class="predefined-type">Class</span>&lt;T&gt; getClassType();

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="attributenode"><a class="anchor" href="#attributenode"></a>B.15. <code>AttributeNode</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.Map</span>;

<span class="comment">/**
 * Represents an attribute node of an entity graph.
 *
 * @param &lt;T&gt; The type of the attribute.
 *
 * @see EntityGraph
 * @see Subgraph
 * @see NamedAttributeNode
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AttributeNode</span>&lt;T&gt; {

    <span class="comment">/**
     * Return the name of the attribute corresponding to the
     * attribute node.
     * @return name of the attribute
     */</span>
    <span class="predefined-type">String</span> getAttributeName();

    <span class="comment">/**
     * Return a map of subgraphs associated with this attribute
     * node.
     * @return a {@link Map} of subgraphs associated with this
     * attribute node or an empty {@code Map} if none have been
     * defined
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">Class</span>, Subgraph&gt; getSubgraphs();

    <span class="comment">/**
     * Return a map of subgraphs associated with this attribute
     * node's map key.
     * @return a {@link Map} of subgraphs associated with this
     * attribute node's map key or an empty {@code Map} if none
     * have been defined
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">Class</span>, Subgraph&gt; getKeySubgraphs();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_schemamanager_"><a class="anchor" href="#_schemamanager_"></a>B.16. <code>SchemaManager</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.Map</span>;

<span class="comment">/**
 * Allows programmatic {@linkplain #create schema creation},
 * {@linkplain #validate schema validation},
 * {@linkplain #truncate data cleanup}, and
 * {@linkplain #drop schema cleanup} for entities belonging
 * to a certain persistence unit.
 * 
 * &lt;p&gt;Properties are inherited from the {@link EntityManagerFactory},
 * that is, they may be specified via {@code persistence.xml} or
 * {@link Persistence#createEntityManagerFactory(String, Map)}.
 *
 * @see EntityManagerFactory#getSchemaManager()
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">SchemaManager</span> {
        <span class="comment">/**
         * Create database objects mapped by entities belonging to the
         * persistence unit.
         *
         * &lt;p&gt;If a DDL operation fails, the behavior is undefined.
         * A provider may throw an exception, or it may ignore the problem
         * and continue.
         *
         * @param createSchemas if {@code true}, attempt to create schemas,
         *                      otherwise, assume the schemas already exist
         */</span>
        <span class="type">void</span> create(<span class="type">boolean</span> createSchemas);

        <span class="comment">/**
         * Drop database objects mapped by entities belonging to the
         * persistence unit, undoing the effects of the
         * {@linkplain #create(boolean) previous creation}.
         *
         * &lt;p&gt;If a DDL operation fails, the behavior is undefined.
         * A provider may throw an exception, or it may ignore the problem
         * and continue.
         *
         * @param dropSchemas if {@code true}, drop schemas,
         *                    otherwise, leave them be
         */</span>
        <span class="type">void</span> drop(<span class="type">boolean</span> dropSchemas);

        <span class="comment">/**
         * Validate that the database objects mapped by entities belonging
         * to the persistence unit have the expected definitions.
         *
         * &lt;p&gt;The persistence provider is not required to perform
         * any specific validation, so the semantics of this operation are
         * entirely provider-specific.
         *
         * @throws SchemaValidationException if a database object is missing or
         * does not have the expected definition
         */</span>
        <span class="type">void</span> validate() <span class="directive">throws</span> SchemaValidationException;

        <span class="comment">/**
         * Truncate the database tables mapped by entities belonging to
         * the persistence unit, and then re-import initial data from any
         * configured SQL scripts for data loading.
         *
         * &lt;p&gt;If a SQL operation fails, the behavior is undefined.
         * A provider may throw an exception, or it may ignore the problem
         * and continue.
         */</span>
        <span class="type">void</span> truncate();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_persistence_"><a class="anchor" href="#_persistence_"></a>B.17. <code>Persistence</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">java.util.HashSet</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.PersistenceProvider</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.PersistenceProviderResolver</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.PersistenceProviderResolverHolder</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.LoadState</span>;

<span class="comment">/**
 * Bootstrap class used to obtain an {@link EntityManagerFactory}
 * in Java SE environments. It may also be used to cause schema
 * generation to occur.
 * 
 * &lt;p&gt;The {@code Persistence} class is available in a Jakarta EE
 * container environment as well; however, support for the Java SE
 * bootstrapping APIs is not required in container environments.
 * 
 * &lt;p&gt;The {@code Persistence} class is used to obtain a {@link
 * PersistenceUtil PersistenceUtil} instance in both Jakarta EE
 * and Java SE environments.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Persistence</span> {

    <span class="comment">/**
     * Default constructor.
     * @deprecated This class is not intended to be extended nor instantiated,
     *     it is going to be marked {@code final} when this constructor becomes hidden.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>, forRemoval = <span class="predefined-constant">true</span>)
    <span class="directive">public</span> Persistence() {
        <span class="comment">//kept for backward compatibility with pre-3.2 versions</span>
    }

    <span class="comment">/**
     * Create and return an {@link EntityManagerFactory} for the named
     * persistence unit.
     * 
     * @param persistenceUnitName the name of the persistence unit
     * @return the factory that creates {@link EntityManager}s configured
     *         according to the specified persistence unit
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> EntityManagerFactory createEntityManagerFactory(<span class="predefined-type">String</span> persistenceUnitName) {
        <span class="keyword">return</span> createEntityManagerFactory(persistenceUnitName, <span class="predefined-constant">null</span>);
    }

    <span class="comment">/**
     * Create and return an {@link EntityManagerFactory} for the named
     * persistence unit, using the given properties.
     * 
     * @param persistenceUnitName the name of the persistence unit
     * @param properties additional properties to use when creating the
     *                   factory. These properties may include properties
     *                   to control schema generation. The values of these
     *                   properties override any values that may have been
     *                   configured elsewhere.
     * @return the factory that creates {@link EntityManager}s configured
     *        according to the specified persistence unit
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> EntityManagerFactory createEntityManagerFactory(<span class="predefined-type">String</span> persistenceUnitName, <span class="predefined-type">Map</span>&lt;?,?&gt; properties) {

        EntityManagerFactory emf = <span class="predefined-constant">null</span>;
        PersistenceProviderResolver resolver = PersistenceProviderResolverHolder.getPersistenceProviderResolver();

        <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; providers = resolver.getPersistenceProviders();

        <span class="keyword">for</span> (PersistenceProvider provider : providers) {
            emf = provider.createEntityManagerFactory(persistenceUnitName, properties);
            <span class="keyword">if</span> (emf != <span class="predefined-constant">null</span>) {
                <span class="keyword">break</span>;
            }
        }
        <span class="keyword">if</span> (emf == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> PersistenceException(<span class="string"><span class="delimiter">&quot;</span><span class="content">No Persistence provider for EntityManager named </span><span class="delimiter">&quot;</span></span> + persistenceUnitName);
        }
        <span class="keyword">return</span> emf;
    }

    <span class="comment">/**
     * Create and return an {@link EntityManagerFactory} for the named
     * persistence unit, using the given properties.
     *
     * @param configuration configuration of the persistence unit
     * @return the factory that creates {@link EntityManager}s configured
     *         according to the specified persistence unit
     *
     * @since 3.2
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> EntityManagerFactory createEntityManagerFactory(PersistenceConfiguration configuration) {

        EntityManagerFactory emf = <span class="predefined-constant">null</span>;
        PersistenceProviderResolver resolver = PersistenceProviderResolverHolder.getPersistenceProviderResolver();

        <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; providers = resolver.getPersistenceProviders();

        <span class="keyword">for</span> (PersistenceProvider provider : providers) {
            emf = provider.createEntityManagerFactory(configuration);
            <span class="keyword">if</span> (emf != <span class="predefined-constant">null</span>) {
                <span class="keyword">break</span>;
            }
        }
        <span class="keyword">if</span> (emf == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> PersistenceException(<span class="string"><span class="delimiter">&quot;</span><span class="content">No Persistence provider for EntityManager named </span><span class="delimiter">&quot;</span></span> + configuration.name());
        }
        <span class="keyword">return</span> emf;
    }


    <span class="comment">/**
     * Create database schemas and/or tables and/or create DDL scripts
     * as determined by the supplied properties.
     * &lt;p&gt;
     * Called when schema generation is to occur as a separate phase
     * from creation of the entity manager factory.
     * &lt;p&gt;
     * @param persistenceUnitName the name of the persistence unit
     * @param map properties for schema generation; these may also
     *            contain provider-specific properties. The values
     *            of these properties override any values that may
     *            have been configured elsewhere.
     * @throws PersistenceException if insufficient or inconsistent
     *         configuration information is provided or if schema
     *         generation otherwise fails.
     *
     * @since 2.1
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> generateSchema(<span class="predefined-type">String</span> persistenceUnitName, <span class="predefined-type">Map</span>&lt;?,?&gt; map) {
        PersistenceProviderResolver resolver = PersistenceProviderResolverHolder.getPersistenceProviderResolver();
        <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; providers = resolver.getPersistenceProviders();
        
        <span class="keyword">for</span> (PersistenceProvider provider : providers) {
            <span class="keyword">if</span> (provider.generateSchema(persistenceUnitName, map)) {
                <span class="keyword">return</span>;
            }
        }
        
        <span class="keyword">throw</span> <span class="keyword">new</span> PersistenceException(<span class="string"><span class="delimiter">&quot;</span><span class="content">No Persistence provider to generate schema named </span><span class="delimiter">&quot;</span></span> + persistenceUnitName);
    }
    

    <span class="comment">/**
     * Return the {@link PersistenceUtil} instance
     * @return {@link PersistenceUtil} instance
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> PersistenceUtil getPersistenceUtil() {
       <span class="keyword">return</span> <span class="keyword">new</span> PersistenceUtilImpl();
    }

    
    <span class="comment">/**
     * Implementation of the {@link PersistenceUtil} interface
     * @since 2.0
     */</span>
    <span class="directive">private</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">PersistenceUtilImpl</span> <span class="directive">implements</span> PersistenceUtil {
        <span class="directive">public</span> <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName) {
            PersistenceProviderResolver resolver = PersistenceProviderResolverHolder.getPersistenceProviderResolver();

            <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; providers = resolver.getPersistenceProviders();

            <span class="keyword">for</span> (PersistenceProvider provider : providers) {
                LoadState loadstate = provider.getProviderUtil().isLoadedWithoutReference(entity, attributeName);
                <span class="keyword">if</span>(loadstate == LoadState.LOADED) {
                    <span class="keyword">return</span> <span class="predefined-constant">true</span>;
                } <span class="keyword">else</span> <span class="keyword">if</span> (loadstate == LoadState.NOT_LOADED) {
                    <span class="keyword">return</span> <span class="predefined-constant">false</span>;
                } <span class="comment">// else continue</span>
            }

            <span class="comment">//None of the providers could determine the load state try isLoadedWithReference</span>
            <span class="keyword">for</span> (PersistenceProvider provider : providers) {
                LoadState loadstate = provider.getProviderUtil().isLoadedWithReference(entity, attributeName);
                <span class="keyword">if</span>(loadstate == LoadState.LOADED) {
                    <span class="keyword">return</span> <span class="predefined-constant">true</span>;
                } <span class="keyword">else</span> <span class="keyword">if</span> (loadstate == LoadState.NOT_LOADED) {
                    <span class="keyword">return</span> <span class="predefined-constant">false</span>;
                } <span class="comment">// else continue</span>
            }

            <span class="comment">//None of the providers could determine the load state.</span>
            <span class="keyword">return</span> <span class="predefined-constant">true</span>;
        }

        <span class="directive">public</span> <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity) {
            PersistenceProviderResolver resolver = PersistenceProviderResolverHolder.getPersistenceProviderResolver();

            <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; providers = resolver.getPersistenceProviders();

            <span class="keyword">for</span> (PersistenceProvider provider : providers) {
                LoadState loadstate = provider.getProviderUtil().isLoaded(entity);
                <span class="keyword">if</span>(loadstate == LoadState.LOADED) {
                    <span class="keyword">return</span> <span class="predefined-constant">true</span>;
                } <span class="keyword">else</span> <span class="keyword">if</span> (loadstate == LoadState.NOT_LOADED) {
                    <span class="keyword">return</span> <span class="predefined-constant">false</span>;
                } <span class="comment">// else continue</span>
            }
            <span class="comment">//None of the providers could determine the load state</span>
            <span class="keyword">return</span> <span class="predefined-constant">true</span>;
        }
    }

    <span class="comment">/**
     * This final String is deprecated and should be removed and is only here for TCK backward compatibility
     * @since 1.0
     * @deprecated
     *
     * TODO: Either change TCK reference to PERSISTENCE_PROVIDER field to expect 
     * &quot;jakarta.persistence.spi.PersistenceProvider&quot; or remove PERSISTENCE_PROVIDER field and also update TCK signature 
     * tests. 
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>, forRemoval = <span class="predefined-constant">true</span>)
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> PERSISTENCE_PROVIDER = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.spi.PersistenceProvider</span><span class="delimiter">&quot;</span></span>;
    
    <span class="comment">/**
     * This instance variable is deprecated and should be removed and is only here for TCK backward compatibility
     * @since 1.0
     * @deprecated
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>, forRemoval = <span class="predefined-constant">true</span>)
    <span class="directive">protected</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">Set</span>&lt;PersistenceProvider&gt; providers = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>&lt;PersistenceProvider&gt;();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_persistenceconfiguration_"><a class="anchor" href="#_persistenceconfiguration_"></a>B.18. <code>PersistenceConfiguration</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.Objects</span>;

<span class="comment">/**
 * Represents a configuration of a persistence unit, allowing programmatic
 * creation of an {@link EntityManagerFactory}. The configuration options
 * available via this API reflect the similarly-named elements of the
 * {@code persistence.xml} file.
 *
 * &lt;p&gt;This API may not be used to configure a container-managed persistence
 * unit. That is, the configured persistence unit should be considered a
 * Java SE persistence unit, even when this API is used within the Jakarta
 * EE environment.
 *
 * &lt;p&gt;If injection of the {@link EntityManagerFactory} is required, a CDI
 * {@code Producer} may be used to make the {@link EntityManagerFactory}
 * available as a CDI managed bean.
 *
 * {@snippet :
 * @Produces @ApplicationScoped @Documents
 * EntityManagerFactory configure() {
 *     return new PersistenceConfiguration()
 *             .name(&quot;DocumentData&quot;)
 *             .nonJtaDataSource(&quot;java:global/jdbc/DocumentDatabase&quot;)
 *             .managedClass(Document.class)
 *             .createEntityManagerFactory();
 * }
 * }
 *
 * &lt;p&gt;Similarly, if injection of an {@link EntityManager} is required,
 * a CDI {@code Producer} method/{@code Disposer} method pair may be
 * used to make the {@link EntityManager} available as a CDI managed
 * bean.
 *
 * {@snippet :
 * @Produces @TransactionScoped @Documents
 * EntityManager create(@Documents EntityManagerFactory factory) {
 *     return factory.createEntityManager();
 * }
 *
 * void close(@Disposes @Documents EntityManager entityManager) {
 *     entityManager.close();
 * }
 * }
 *
 * &lt;p&gt;It is intended that persistence providers define subclasses of
 * this class with vendor-specific configuration options. A provider
 * must support configuration via any instance of this class or of any
 * subclass of this class.
 *
 * @see Persistence#createEntityManagerFactory(PersistenceConfiguration)
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PersistenceConfiguration</span> {

    <span class="comment">/**
     * Fully qualified name of the JDBC driver class.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> JDBC_DRIVER = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.jdbc.driver</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * JDBC URL.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> JDBC_URL = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.jdbc.url</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * Username for JDBC authentication.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> JDBC_USER = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.jdbc.user</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * Password for JDBC authentication.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> JDBC_PASSWORD = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.jdbc.password</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * An instance of {@code javax.sql.DataSource}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> JDBC_DATASOURCE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.dataSource</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * Default pessimistic lock timeout hint.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> LOCK_TIMEOUT = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.lock.timeout</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * Default query timeout hint.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> QUERY_TIMEOUT = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.query.timeout</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * The action to be performed against the database.
     *
     * &lt;p&gt;Standard actions are: {@code none}, {@code create},
     * {@code drop}, {@code drop-and-create}, {@code validate}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SCHEMAGEN_DATABASE_ACTION = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.schema-generation.database.action</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * The action to be generated as a SQL script.
     *
     * &lt;p&gt;The script is generated in the location specified by
     * {@value #SCHEMAGEN_CREATE_TARGET} or {@value #SCHEMAGEN_DROP_TARGET}.
     *
     * &lt;p&gt;Standard actions are: {@code none}, {@code create},
     * {@code drop}, {@code drop-and-create}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SCHEMAGEN_SCRIPTS_ACTION = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.schema-generation.scripts.action</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * The source of artifacts to be created.
     *
     * &lt;p&gt;Standard sources are: {@code metadata}, {@code script},
     * {@code metadata-then-script}, {@code script-then-metadata}.
     *
     * &lt;p&gt;The location of the script source is specified by
     * {@value #SCHEMAGEN_CREATE_SCRIPT_SOURCE}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SCHEMAGEN_CREATE_SOURCE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.schema-generation.create-source</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * The source of artifacts to be dropped.
     *
     * &lt;p&gt;Standard sources are: {@code metadata}, {@code script},
     * {@code metadata-then-script}, {@code script-then-metadata}.
     *
     * &lt;p&gt;The location of the script source is specified by
     * {@value #SCHEMAGEN_DROP_SCRIPT_SOURCE}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SCHEMAGEN_DROP_SOURCE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.schema-generation.drop-source</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * An application-provided SQL script to be executed when the
     * schema is created.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SCHEMAGEN_CREATE_SCRIPT_SOURCE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.schema-generation.create-script-source</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * An application-provided SQL script to be executed when the
     * schema is dropped.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SCHEMAGEN_DROP_SCRIPT_SOURCE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.schema-generation.drop-script-source</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * The provider-generated SQL script which creates the schema
     * when {@value SCHEMAGEN_SCRIPTS_ACTION} is set.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SCHEMAGEN_CREATE_TARGET = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.schema-generation.create-target</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * The provider-generated SQL script which drops the schema
     * when {@value SCHEMAGEN_SCRIPTS_ACTION} is set.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SCHEMAGEN_DROP_TARGET = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.schema-generation.drop-target</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * An instance of {@code jakarta.validation.ValidatorFactory},
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> VALIDATION_FACTORY = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.validation.factory</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * Target groups for validation at {@link PrePersist}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> VALIDATION_GROUP_PRE_PERSIST = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.validation.group.pre-persist</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * Target groups for validation at {@link PreUpdate}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> VALIDATION_GROUP_PRE_UPDATE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.validation.group.pre-update</span><span class="delimiter">&quot;</span></span>;
    <span class="comment">/**
     * Target groups for validation at {@link PreRemove}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> VALIDATION_GROUP_PRE_REMOVE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.validation.group.pre-remove</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * String specifying a {@link SharedCacheMode}.
     *
     * &lt;p&gt;Defined for use with
     * {@link Persistence#createEntityManagerFactory(String, Map)}.
     * Clients of this {@code PersistenceConfiguration} class
     * should use {@link #sharedCacheMode(SharedCacheMode)}.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> CACHE_MODE = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.sharedCache.mode</span><span class="delimiter">&quot;</span></span>;

    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> name;

    <span class="directive">private</span> <span class="predefined-type">String</span> provider;
    <span class="directive">private</span> <span class="predefined-type">String</span> jtaDataSource;
    <span class="directive">private</span> <span class="predefined-type">String</span> nonJtaDataSource;

    <span class="directive">private</span> SharedCacheMode sharedCacheMode = SharedCacheMode.UNSPECIFIED;
    <span class="directive">private</span> ValidationMode validationMode = ValidationMode.AUTO;
    <span class="directive">private</span> PersistenceUnitTransactionType transactionType = PersistenceUnitTransactionType.RESOURCE_LOCAL;

    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; managedClasses = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; mappingFileNames = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>,<span class="predefined-type">Object</span>&gt; properties = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();

    <span class="comment">/**
     * Create a new empty configuration. An empty configuration does not
     * typically hold enough information for successful invocation of
     * {@link #createEntityManagerFactory()}.
     *
     * @param name the name of the persistence unit, which may be used by
     *             the persistence provider for logging and error reporting
     */</span>
    <span class="directive">public</span> PersistenceConfiguration(<span class="predefined-type">String</span> name) {
        Objects.requireNonNull(name, <span class="string"><span class="delimiter">&quot;</span><span class="content">Persistence unit name should not be null</span><span class="delimiter">&quot;</span></span>);
        <span class="local-variable">this</span>.name = name;
    }

    <span class="comment">/**
     * Create a new {@link EntityManagerFactory} based on this configuration.
     * @throws PersistenceException if required configuration is missing or
     *                             if the factory could not be created
     */</span>
    <span class="directive">public</span> EntityManagerFactory createEntityManagerFactory() {
        <span class="keyword">return</span> Persistence.createEntityManagerFactory(<span class="local-variable">this</span>);
    }

    <span class="comment">/**
     * The name of the persistence unit, which may be used by the persistence
     * provider for logging and error reporting.
     * @return the name of the persistence unit.
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> name() {
        <span class="keyword">return</span> name;
    }

    <span class="comment">/**
     * Specify the persistence provider.
     * @param providerClassName the qualified name of the persistence provider class
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration provider(<span class="predefined-type">String</span> providerClassName) {
        <span class="local-variable">this</span>.provider = providerClassName;
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * The fully-qualified name of a concrete class implementing
     * {@link jakarta.persistence.spi.PersistenceProvider}.
     * @return the qualified name of the persistence provider class.
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> provider() {
        <span class="keyword">return</span> provider;
    }

    <span class="comment">/**
     * Specify the JNDI name of a JTA {@code javax.sql.DataSource}.
     * @param dataSourceJndiName the JNDI name of a JTA datasource
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration jtaDataSource(<span class="predefined-type">String</span> dataSourceJndiName) {
        <span class="local-variable">this</span>.jtaDataSource = dataSourceJndiName;
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * The JNDI name of a JTA {@code javax.sql.DataSource}.
     * @return the configured JTA datasource, if any, or null
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> jtaDataSource() {
        <span class="keyword">return</span> jtaDataSource;
    }

    <span class="comment">/**
     * Specify the JNDI name of a non-JTA {@code javax.sql.DataSource}.
     * @param dataSourceJndiName the JNDI name of a non-JTA datasource
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration nonJtaDataSource(<span class="predefined-type">String</span> dataSourceJndiName) {
        <span class="local-variable">this</span>.nonJtaDataSource = dataSourceJndiName;
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * The JNDI name of a non-JTA {@code javax.sql.DataSource}.
     * @return the configured non-JTA datasource, if any, or null
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> nonJtaDataSource() {
        <span class="keyword">return</span> nonJtaDataSource;
    }

    <span class="comment">/**
     * Add a managed class (an {@link Entity}, {@link Embeddable},
     * {@link MappedSuperclass}, or {@link Converter}) to the
     * configuration.
     * @param managedClass the managed class
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration managedClass(<span class="predefined-type">Class</span>&lt;?&gt; managedClass) {
        managedClasses.add(managedClass);
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * The configured managed classes, that is, a list of classes
     * annotated {@link Entity}, {@link Embeddable},
     * {@link MappedSuperclass}, or {@link Converter}.
     * @return all configured managed classes
     */</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; managedClasses() {
        <span class="keyword">return</span> managedClasses;
    }

    <span class="comment">/**
     * Add the path of an XML mapping file loaded as a resource to
     * the configuration.
     * @param name the resource path of the mapping file
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration mappingFile(<span class="predefined-type">String</span> name) {
        mappingFileNames.add(name);
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * The configured resource paths of XML mapping files.
     * @return all configured mapping file resource paths
     */</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; mappingFiles() {
        <span class="keyword">return</span> mappingFileNames;
    }

    <span class="comment">/**
     * Specify the transaction type for the persistence unit.
     * @param transactionType the transaction type
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration transactionType(PersistenceUnitTransactionType transactionType) {
        <span class="local-variable">this</span>.transactionType = transactionType;
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * The {@linkplain PersistenceUnitTransactionType transaction type}.
     * &lt;ul&gt;
     * &lt;li&gt;If {@link PersistenceUnitTransactionType#JTA}, a JTA data
     *    source must be provided via {@link #jtaDataSource()},
     *    or by the container.
     * &lt;li&gt;If {@link PersistenceUnitTransactionType#RESOURCE_LOCAL},
     *    database connection properties may be specified via
     *    {@link #properties()}, or a non-JTA datasource may be
     *    provided via {@link #nonJtaDataSource()}.
     * &lt;/ul&gt;
     * @return the transaction type
     */</span>
    <span class="directive">public</span> PersistenceUnitTransactionType transactionType() {
        <span class="keyword">return</span> transactionType;
    }

    <span class="comment">/**
     * Specify the shared cache mode for the persistence unit.
     * @param sharedCacheMode the shared cache mode
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration sharedCacheMode(SharedCacheMode sharedCacheMode) {
        <span class="local-variable">this</span>.sharedCacheMode = sharedCacheMode;
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * The shared cache mode. The default behavior is unspecified
     * and {@linkplain SharedCacheMode#UNSPECIFIED provider-specific}.
     * @return the shared cache mode
     */</span>
    <span class="directive">public</span> SharedCacheMode sharedCacheMode() {
        <span class="keyword">return</span> sharedCacheMode;
    }

    <span class="comment">/**
     * Specify the validation mode for the persistence unit.
     * @param validationMode the shared cache mode
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration validationMode(ValidationMode validationMode) {
        <span class="local-variable">this</span>.validationMode = validationMode;
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * The validation mode, {@link ValidationMode#AUTO} by default.
     * @return the validation mode
     */</span>
    <span class="directive">public</span> ValidationMode validationMode() {
        <span class="keyword">return</span> validationMode;
    }

    <span class="comment">/**
     * Set a property of this persistence unit.
     * @param name the property name
     * @param value the property value
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration property(<span class="predefined-type">String</span> name, <span class="predefined-type">Object</span> value) {
        properties.put(name, value);
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * Set multiple properties of this persistence unit.
     * @param properties the properties
     * @return this configuration
     */</span>
    <span class="directive">public</span> PersistenceConfiguration properties(<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>,?&gt; properties) {
        <span class="local-variable">this</span>.properties.putAll(properties);
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">/**
     * Standard and vendor-specific property settings.
     * @return the configured properties
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties() {
        <span class="keyword">return</span> properties;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_persistenceutil_"><a class="anchor" href="#_persistenceutil_"></a>B.19. <code>PersistenceUtil</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Utility interface between the application and the persistence
 * provider(s). 
 * 
 * &lt;p&gt;The {@code PersistenceUtil} interface instance obtained from
 * the {@link Persistence} class is used to determine the load state
 * of an entity or entity attribute regardless of which persistence
 * provider in the environment created the entity.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceUtil</span> {

    <span class="comment">/**
     * Determine the load state of a given persistent attribute.
     * @param entity  entity containing the attribute
     * @param attributeName name of attribute whose load state is
     *        to be determined
     * @return false if entity's state has not been loaded or if
     * the attribute state has not been loaded, else true
     */</span>
    <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Determine the load state of an entity.
     * This method can be used to determine the load state of an
     * entity passed as a reference. An entity is considered loaded
     * if all attributes for which {@link FetchType#EAGER} has been
     * specified have been loaded.
     * &lt;p&gt;The {@link #isLoaded(Object, String)} method should be
     * used to determine the load state of an attribute. Not doing
     * so might lead to unintended loading of state.
     * @param entity whose load state is to be determined
     * @return false if the entity has not been loaded, else true
     */</span>
    <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_persistenceunitutil_"><a class="anchor" href="#_persistenceunitutil_"></a>B.20. <code>PersistenceUnitUtil</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Attribute</span>;

<span class="comment">/**
 * Utility interface between the application and the persistence
 * provider managing the persistence unit.
 *
 * &lt;p&gt;The methods of this interface should only be invoked on
 * entity instances obtained from or managed by entity managers
 * for this persistence unit or on new entity instances.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceUnitUtil</span> <span class="directive">extends</span> PersistenceUtil {

    <span class="comment">/**
     * Determine the load state of a given persistent attribute
     * of an entity belonging to the persistence unit.
     * @param entity  entity instance containing the attribute
     * @param attributeName name of attribute whose load state is
     *        to be determined
     * @return false if entity's state has not been loaded or if 
     *         the attribute state has not been loaded, else true
     */</span>
    <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Determine the load state of a given persistent attribute
     * of an entity belonging to the persistence unit.
     * @param entity  entity instance containing the attribute
     * @param attribute  attribute whose load state is to be determined
     * @return false if entity's state has not been loaded or if
     *         the attribute state has not been loaded, else true
     * @since 3.2
     */</span>
    &lt;E&gt; <span class="type">boolean</span> isLoaded(E entity, <span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> E, ?&gt; attribute);

    <span class="comment">/**
     * Determine the load state of an entity belonging to the
     * persistence unit. This method can be used to determine the
     * load state of an entity passed as a reference. An entity is
     * considered loaded if all attributes for which
     * {@link FetchType#EAGER} has been specified have been loaded.
     * &lt;p&gt; The {@link #isLoaded(Object, String)} method should be
     * used to determine the load state of an attribute. Not doing
     * so might lead to unintended loading of state.
     * @param entity   entity instance whose load state is to be determined
     * @return false if the entity has not been loaded, else true
     */</span>
    <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Load the persistent value of a given persistent attribute
     * of an entity belonging to the persistence unit and to an
     * open persistence context.
     * After this method returns, {@link #isLoaded(Object,String)}
     * must return true with the given entity instance and attribute.
     * @param entity  entity instance
     * @param attributeName  the name of the attribute to be loaded
     * @throws IllegalArgumentException if the given object is not an
     * instance of an entity class belonging to the persistence unit
     * @throws PersistenceException if the entity is not associated
     * with an open persistence context or cannot be loaded from the
     * database
     * @since 3.2
     */</span>
    <span class="type">void</span> load(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Load the persistent value of a given persistent attribute
     * of an entity belonging to the persistence unit and to an
     * open persistence context.
     * After this method returns, {@link #isLoaded(Object,Attribute)}
     * must return true with the given entity instance and attribute.
     * @param entity  entity instance to be loaded
     * @param attribute  the attribute to be loaded
     * @throws IllegalArgumentException if the given object is not an
     * instance of an entity class belonging to the persistence unit
     * @throws PersistenceException if the entity is not associated
     * with an open persistence context or cannot be loaded from the
     * database
     * @since 3.2
     */</span>
    &lt;E&gt; <span class="type">void</span> load(E entity, <span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> E, ?&gt; attribute);

    <span class="comment">/**
     * Load the persistent state of an entity belonging to the
     * persistence unit and to an open persistence context.
     * After this method returns, {@link #isLoaded(Object)} must
     * return true with the given entity instance.
     * @param entity  entity instance to be loaded
     * @throws IllegalArgumentException if the given object is not an
     * instance of an entity class belonging to the persistence unit
     * @throws PersistenceException if the entity is not associated
     * with an open persistence context or cannot be loaded from the
     * database
     * @since 3.2
     */</span>
    <span class="type">void</span> load(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Return true if the given entity belonging to the persistence
     * unit and to an open persistence context is an instance of the
     * given entity class, or false otherwise. This method may, but
     * is not required to, load the given entity by side effect.
     * @param entity  entity instance
     * @param entityClass  an entity class belonging to the persistence
     * unit
     * @throws IllegalArgumentException if the given object is not an
     * instance of an entity class belonging to the persistence unit
     * or if the given class is not an entity class belonging to the
     * persistence unit
     * @throws PersistenceException if the entity is not associated
     * with an open persistence context or cannot be loaded from the
     * database
     * @since 3.2
     */</span>
    <span class="type">boolean</span> isInstance(<span class="predefined-type">Object</span> entity, <span class="predefined-type">Class</span>&lt;?&gt; entityClass);

    <span class="comment">/**
     * Return the concrete entity class if the given entity belonging
     * to the persistence unit and to an open persistence context.
     * This method may, but is not required to, load the given entity
     * by side effect.
     * @param entity  entity instance
     * @return an entity class belonging to the persistence unit
     * @throws IllegalArgumentException if the given object is not an
     * instance of an entity class belonging to the persistence unit
     * @throws PersistenceException if the entity is not associated
     * with an open persistence context or cannot be loaded from the
     * database
     * @since 3.2
     */</span>
    &lt;T&gt; <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> T&gt; getClass(T entity);

    <span class="comment">/**
     * Return the id of the entity.
     * A generated id is not guaranteed to be available until after
     * the database insert has occurred.
     * Returns null if the entity does not yet have an id.
     * @param entity  entity instance
     * @return id of the entity
     * @throws IllegalArgumentException if the object is found not 
     *         to be an entity
     */</span>
    <span class="predefined-type">Object</span> getIdentifier(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Return the version of the entity.
     * A generated version is not guaranteed to be available until after
     * the database insert has occurred.
     * Returns null if the entity does not yet have an id.
     * @param entity  entity instance
     * @return id of the entity
     * @throws IllegalArgumentException if the object is found not
     *         to be an entity
     * @since 3.2
     */</span>
    <span class="predefined-type">Object</span> getVersion(<span class="predefined-type">Object</span> entity);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="criteria-api"><a class="anchor" href="#criteria-api"></a>Appendix C: Criteria API Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following APIs are defined in the package <code>jakarta.persistence.criteria</code>.</p>
</div>
<div class="sect2">
<h3 id="_criteriabuilder_"><a class="anchor" href="#_criteriabuilder_"></a>C.1. <code>CriteriaBuilder</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.math.BigDecimal</span>;
<span class="keyword">import</span> <span class="include">java.math.BigInteger</span>;
<span class="keyword">import</span> <span class="include">java.time.temporal.Temporal</span>;
<span class="keyword">import</span> <span class="include">java.util.Collection</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.Tuple</span>;

<span class="comment">/**
 * Used to construct criteria queries, compound selections, 
 * expressions, predicates, orderings.
 *
 * &lt;p&gt; Note that {@link Predicate} is used instead of
 * {@code Expression&lt;Boolean&gt;} in this API in
 * order to work around the fact that Java generics are not
 * compatible with varags.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaBuilder</span> {

    <span class="comment">/**
     * Create a {@link CriteriaQuery} object.
     * @return criteria query object
     */</span>
    CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; createQuery();

    <span class="comment">/**
     * Create a {@link CriteriaQuery} object with the given
     * result type.
     * @param resultClass  type of the query result
     * @return criteria query object
     */</span>
    &lt;T&gt; CriteriaQuery&lt;T&gt; createQuery(<span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">/**
     * Create a {@link CriteriaQuery} object that returns a
     * tuple of objects as its result.
     * @return criteria query object
     */</span>
    CriteriaQuery&lt;Tuple&gt; createTupleQuery();

    <span class="comment">// methods to construct queries for bulk updates and deletes:</span>

    <span class="comment">/**
     * Create a {@link CriteriaUpdate} query object to perform a
     * bulk update operation.
     * @param targetEntity  target type for update operation
     * @return the query object
     * @since 2.1
     */</span>
    &lt;T&gt; CriteriaUpdate&lt;T&gt; createCriteriaUpdate(<span class="predefined-type">Class</span>&lt;T&gt; targetEntity);

    <span class="comment">/**
     * Create a {@link CriteriaDelete} query object to perform a
     * bulk delete operation.
     * @param targetEntity  target type for delete operation
     * @return the query object
     * @since 2.1
     */</span>
    &lt;T&gt; CriteriaDelete&lt;T&gt; createCriteriaDelete(<span class="predefined-type">Class</span>&lt;T&gt; targetEntity);


    <span class="comment">// selection construction methods:</span>
        
    <span class="comment">/**
     * Create a selection item corresponding to a constructor.
     * This method is used to specify a constructor that is
     * applied to the results of the query execution. If the
     * constructor is for an entity class, the resulting entities
     * will be in the new state after the query is executed.
     * @param resultClass  class whose instance is to be constructed
     * @param selections  arguments to the constructor
     * @return compound selection item
     * @throws IllegalArgumentException if an argument is a 
     *         tuple- or array-valued selection item
     */</span>
    &lt;Y&gt; CompoundSelection&lt;Y&gt; construct(<span class="predefined-type">Class</span>&lt;Y&gt; resultClass, Selection&lt;?&gt;... selections);

    <span class="comment">/**
     * Create a tuple-valued selection item.
     * @param selections  selection items
     * @return tuple-valued compound selection
     * @throws IllegalArgumentException if an argument is a 
     *         tuple- or array-valued selection item
     */</span>
    CompoundSelection&lt;Tuple&gt; tuple(Selection&lt;?&gt;... selections);

    <span class="comment">/**
     * Create a tuple-valued selection item.
     * @param selections  list of selection items
     * @return tuple-valued compound selection
     * @throws IllegalArgumentException if an argument is a
     *         tuple- or array-valued selection item
     * @since 3.2
     */</span>
    CompoundSelection&lt;Tuple&gt; tuple(<span class="predefined-type">List</span>&lt;Selection&lt;?&gt;&gt; selections);

    <span class="comment">/**
     * Create an array-valued selection item.
     * @param selections  selection items
     * @return array-valued compound selection
     * @throws IllegalArgumentException if an argument is a
     *         tuple- or array-valued selection item
     */</span>
    CompoundSelection&lt;<span class="predefined-type">Object</span><span class="type">[]</span>&gt; array(Selection&lt;?&gt;... selections);

    <span class="comment">/**
     * Create an array-valued selection item.
     * @param selections  list of selection items
     * @return array-valued compound selection
     * @throws IllegalArgumentException if an argument is a
     *         tuple- or array-valued selection item
     * @since 3.2
     */</span>
    CompoundSelection&lt;<span class="predefined-type">Object</span><span class="type">[]</span>&gt; array(<span class="predefined-type">List</span>&lt;Selection&lt;?&gt;&gt; selections);


    <span class="comment">//ordering:</span>
        
    <span class="comment">/**
     * Create an ordering by the ascending value of the expression.
     * @param expression  expression used to define the ordering
     * @return ascending ordering corresponding to the expression
     */</span>
    Order asc(<span class="predefined-type">Expression</span>&lt;?&gt; expression);

    <span class="comment">/**
     * Create an ordering by the descending value of the expression.
     * @param expression  expression used to define the ordering
     * @return descending ordering corresponding to the expression
     */</span>
    Order desc(<span class="predefined-type">Expression</span>&lt;?&gt; expression);

    <span class="comment">/**
     * Create an ordering by the ascending value of the expression.
     * @param expression  expression used to define the ordering
     * @param nullPrecedence  the precedence of null values
     * @return ascending ordering corresponding to the expression
     * @since 3.2
     */</span>
    Order asc(<span class="predefined-type">Expression</span>&lt;?&gt; expression, Nulls nullPrecedence);

    <span class="comment">/**
     * Create an ordering by the descending value of the expression.
     * @param expression  expression used to define the ordering
     * @param nullPrecedence  the precedence of null values
     * @return descending ordering corresponding to the expression
     * @since 3.2
     */</span>
    Order desc(<span class="predefined-type">Expression</span>&lt;?&gt; expression, Nulls nullPrecedence);


    <span class="comment">//aggregate functions:</span>
        
    <span class="comment">/**
     * Create an aggregate expression applying the avg operation.
     * @param x  expression representing input value to avg operation
     * @return avg expression
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; avg(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the sum operation.
     * @param x  expression representing input value to sum operation
     * @return sum expression
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; sum(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the sum operation to an
     * Integer-valued expression, returning a Long result.
     * @param x  expression representing input value to sum operation
     * @return sum expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Long</span>&gt; sumAsLong(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the sum operation to a
     * Float-valued expression, returning a Double result.
     * @param x  expression representing input value to sum operation
     * @return sum expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; sumAsDouble(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Float</span>&gt; x);
    
    <span class="comment">/**
     * Create an aggregate expression applying the numerical max 
     * operation.
     * @param x  expression representing input value to max operation
     * @return max expression
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; max(<span class="predefined-type">Expression</span>&lt;N&gt; x);
    
    <span class="comment">/**
     * Create an aggregate expression applying the numerical min 
     * operation.
     * @param x  expression representing input value to min operation
     * @return min expression
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; min(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an aggregate expression for finding the greatest of
     * the values (strings, dates, etc).
     * @param x  expression representing input value to greatest
     *           operation
     * @return greatest expression
     */</span>
    &lt;X <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> X&gt;&gt; <span class="predefined-type">Expression</span>&lt;X&gt; greatest(<span class="predefined-type">Expression</span>&lt;X&gt; x);
    
    <span class="comment">/**
     * Create an aggregate expression for finding the least of
     * the values (strings, dates, etc).
     * @param x  expression representing input value to least
     *           operation
     * @return least expression
     */</span>
    &lt;X <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> X&gt;&gt; <span class="predefined-type">Expression</span>&lt;X&gt; least(<span class="predefined-type">Expression</span>&lt;X&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the count operation.
     * @param x  expression representing input value to count 
     *           operation
     * @return count expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Long</span>&gt; count(<span class="predefined-type">Expression</span>&lt;?&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the count distinct 
     * operation.
     * @param x  expression representing input value to 
     *        count distinct operation
     * @return count distinct expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Long</span>&gt; countDistinct(<span class="predefined-type">Expression</span>&lt;?&gt; x);
        


    <span class="comment">//subqueries:</span>
        
    <span class="comment">/**
     * Create a predicate testing the existence of a subquery result.
     * @param subquery  subquery whose result is to be tested
     * @return exists predicate
     */</span>
    <span class="predefined-type">Predicate</span> exists(Subquery&lt;?&gt; subquery);
        
    <span class="comment">/**
     * Create an all expression over the subquery results.
     * @param subquery  subquery
     * @return all expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; all(Subquery&lt;Y&gt; subquery);
        
    <span class="comment">/**
     * Create a some expression over the subquery results.
     * This expression is equivalent to an {@code any} expression.
     * @param subquery  subquery
     * @return some expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; some(Subquery&lt;Y&gt; subquery);
        
    <span class="comment">/**
     * Create an any expression over the subquery results. 
     * This expression is equivalent to a {@code some} expression.
     * @param subquery  subquery
     * @return any expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; any(Subquery&lt;Y&gt; subquery);


    <span class="comment">//boolean functions:</span>
        
    <span class="comment">/**
     * Create a conjunction of the given boolean expressions.
     * @param x  boolean expression
     * @param y  boolean expression
     * @return and predicate
     */</span>
    <span class="predefined-type">Predicate</span> and(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; y);
    
    <span class="comment">/**
     * Create a conjunction of the given restriction predicates.
     * A conjunction of zero predicates is true.
     * @param restrictions  zero or more restriction predicates
     * @return and predicate
     */</span>
    <span class="predefined-type">Predicate</span> and(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Create a conjunction of the given restriction predicates.
     * A conjunction of zero predicates is true.
     * @param restrictions  a list of zero or more restriction predicates
     * @return and predicate
     * @since 3.2
     */</span>
    <span class="predefined-type">Predicate</span> and(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Predicate</span>&gt; restrictions);

    <span class="comment">/**
     * Create a disjunction of the given boolean expressions.
     * @param x  boolean expression
     * @param y  boolean expression
     * @return or predicate
     */</span>
    <span class="predefined-type">Predicate</span> or(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; y);

    <span class="comment">/**
     * Create a disjunction of the given restriction predicates.
     * A disjunction of zero predicates is false.
     * @param restrictions  zero or more restriction predicates
     * @return or predicate
     */</span>
    <span class="predefined-type">Predicate</span> or(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Create a disjunction of the given restriction predicates.
     * A disjunction of zero predicates is false.
     * @param restrictions  a list of zero or more restriction predicates
     * @return or predicate
     * @since 3.2
     */</span>
    <span class="predefined-type">Predicate</span> or(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Predicate</span>&gt; restrictions);

    <span class="comment">/**
     * Create a negation of the given restriction. 
     * @param restriction  restriction expression
     * @return not predicate
     */</span>
    <span class="predefined-type">Predicate</span> not(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);
        
    <span class="comment">/**
     * Create a conjunction (with zero conjuncts).
     * A conjunction with zero conjuncts is true.
     * @return and predicate
     */</span>
    <span class="predefined-type">Predicate</span> conjunction();

    <span class="comment">/**
     * Create a disjunction (with zero disjuncts).
     * A disjunction with zero disjuncts is false.
     * @return or predicate
     */</span>
    <span class="predefined-type">Predicate</span> disjunction();

        
    <span class="comment">//turn Expression&lt;Boolean&gt; into a Predicate</span>
    <span class="comment">//useful for use with varargs methods</span>

    <span class="comment">/**
     * Create a predicate testing for a true value.
     * @param x  expression to be tested
     * @return predicate
     */</span>
    <span class="predefined-type">Predicate</span> isTrue(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; x);

    <span class="comment">/**
     * Create a predicate testing for a false value.
     * @param x  expression to be tested
     * @return predicate
     */</span>
    <span class="predefined-type">Predicate</span> isFalse(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; x);

        
    <span class="comment">//null tests:</span>

    <span class="comment">/**
     * Create a predicate to test whether the expression is null.
     * @param x expression
     * @return is-null predicate
     */</span>
    <span class="predefined-type">Predicate</span> isNull(<span class="predefined-type">Expression</span>&lt;?&gt; x);

    <span class="comment">/**
     * Create a predicate to test whether the expression is not null.
     * @param x expression
     * @return is-not-null predicate
     */</span>
    <span class="predefined-type">Predicate</span> isNotNull(<span class="predefined-type">Expression</span>&lt;?&gt; x);

    <span class="comment">//equality:</span>
        
    <span class="comment">/**
     * Create a predicate for testing the arguments for equality.
     * @param x  expression
     * @param y  expression
     * @return equality predicate
     */</span>
    <span class="predefined-type">Predicate</span> equal(<span class="predefined-type">Expression</span>&lt;?&gt; x, <span class="predefined-type">Expression</span>&lt;?&gt; y);
        
    <span class="comment">/**
     * Create a predicate for testing the arguments for equality.
     * @param x  expression
     * @param y  object
     * @return equality predicate
     */</span>
    <span class="predefined-type">Predicate</span> equal(<span class="predefined-type">Expression</span>&lt;?&gt; x, <span class="predefined-type">Object</span> y);

    <span class="comment">/**
     * Create a predicate for testing the arguments for inequality.
     * @param x  expression
     * @param y  expression
     * @return inequality predicate
     */</span>
    <span class="predefined-type">Predicate</span> notEqual(<span class="predefined-type">Expression</span>&lt;?&gt; x, <span class="predefined-type">Expression</span>&lt;?&gt; y);
        
    <span class="comment">/**
     * Create a predicate for testing the arguments for inequality.
     * @param x  expression
     * @param y  object
     * @return inequality predicate
     */</span>
    <span class="predefined-type">Predicate</span> notEqual(<span class="predefined-type">Expression</span>&lt;?&gt; x, <span class="predefined-type">Object</span> y);

        
    <span class="comment">//comparisons for generic (non-numeric) operands:</span>

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * greater than the second.
     * @param x  expression
     * @param y  expression
     * @return greater-than predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> greaterThan(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);
        
    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * greater than the second.
     * @param x  expression
     * @param y  value
     * @return greater-than predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> greaterThan(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);
    
    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * greater than or equal to the second.
     * @param x  expression
     * @param y  expression
     * @return greater-than-or-equal predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> greaterThanOrEqualTo(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * greater than or equal to the second.
     * @param x  expression
     * @param y  value
     * @return greater-than-or-equal predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> greaterThanOrEqualTo(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * less than the second.
     * @param x  expression
     * @param y  expression
     * @return less-than predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> lessThan(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * less than the second.
     * @param x  expression
     * @param y  value
     * @return less-than predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> lessThan(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);
        
    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * less than or equal to the second.
     * @param x  expression
     * @param y  expression
     * @return less-than-or-equal predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> lessThanOrEqualTo(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * less than or equal to the second.
     * @param x  expression
     * @param y  value
     * @return less-than-or-equal predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> lessThanOrEqualTo(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * between the second and third arguments in value.
     * @param v  expression 
     * @param x  expression
     * @param y  expression
     * @return between predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> between(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; v, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * between the second and third arguments in value.
     * @param v  expression 
     * @param x  value
     * @param y  value
     * @return between predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> between(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; v, Y x, Y y);
        

    <span class="comment">//comparisons for numeric operands:</span>
        
    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * greater than the second.
     * @param x  expression
     * @param y  expression
     * @return greater-than predicate
     */</span>
    <span class="predefined-type">Predicate</span> gt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * greater than the second.
     * @param x  expression
     * @param y  value
     * @return greater-than predicate
     */</span>
    <span class="predefined-type">Predicate</span> gt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * greater than or equal to the second.
     * @param x  expression
     * @param y  expression
     * @return greater-than-or-equal predicate
     */</span>
    <span class="predefined-type">Predicate</span> ge(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * greater than or equal to the second.
     * @param x  expression
     * @param y  value
     * @return greater-than-or-equal predicate
     */</span>        
    <span class="predefined-type">Predicate</span> ge(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * less than the second.
     * @param x  expression
     * @param y  expression
     * @return less-than predicate
     */</span>
    <span class="predefined-type">Predicate</span> lt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * less than the second.
     * @param x  expression
     * @param y  value
     * @return less-than predicate
     */</span>
    <span class="predefined-type">Predicate</span> lt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * less than or equal to the second.
     * @param x  expression
     * @param y  expression
     * @return less-than-or-equal predicate
     */</span>
    <span class="predefined-type">Predicate</span> le(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is 
     * less than or equal to the second.
     * @param x  expression
     * @param y  value
     * @return less-than-or-equal predicate
     */</span>
    <span class="predefined-type">Predicate</span> le(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);
        

    <span class="comment">//numerical operations:</span>

    <span class="comment">/**
     * Create an expression that returns the sign of its
     * argument, that is, {@code 1} if its argument is
     * positive, {@code -1} if its argument is negative,
     * or {@code 0} if its argument is exactly zero.
     * @param x expression
     * @return sign
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; sign(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x);
        
    <span class="comment">/**
     * Create an expression that returns the arithmetic negation
     * of its argument.
     * @param x expression
     * @return arithmetic negation
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; neg(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an expression that returns the absolute value
     * of its argument.
     * @param x expression
     * @return absolute value
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; abs(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an expression that returns the ceiling of its
     * argument, that is, the smallest integer greater than
     * or equal to its argument.
     * @param x expression
     * @return ceiling
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; ceiling(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an expression that returns the floor of its
     * argument, that is, the largest integer smaller than
     * or equal to its argument.
     * @param x expression
     * @return floor
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; floor(<span class="predefined-type">Expression</span>&lt;N&gt; x);
    <span class="comment">/**
     * Create an expression that returns the sum
     * of its arguments.
     * @param x expression
     * @param y expression
     * @return sum
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; sum(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);
        
    <span class="comment">/**
     * Create an expression that returns the sum
     * of its arguments.
     * @param x expression
     * @param y value
     * @return sum
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; sum(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, N y);

    <span class="comment">/**
     * Create an expression that returns the sum
     * of its arguments.
     * @param x value
     * @param y expression
     * @return sum
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; sum(N x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the product
     * of its arguments.
     * @param x expression
     * @param y expression
     * @return product
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; prod(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the product
     * of its arguments.
     * @param x expression
     * @param y value
     * @return product
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; prod(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, N y);

    <span class="comment">/**
     * Create an expression that returns the product
     * of its arguments.
     * @param x value
     * @param y expression
     * @return product
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; prod(N x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the difference
     * between its arguments.
     * @param x expression
     * @param y expression
     * @return difference
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; diff(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the difference
     * between its arguments.
     * @param x expression
     * @param y value
     * @return difference
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; diff(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, N y);

    <span class="comment">/**
     * Create an expression that returns the difference
     * between its arguments.
     * @param x value
     * @param y expression
     * @return difference
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; diff(N x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);
        
    <span class="comment">/**
     * Create an expression that returns the quotient
     * of its arguments.
     * @param x expression
     * @param y expression
     * @return quotient
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Number</span>&gt; quot(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create an expression that returns the quotient
     * of its arguments.
     * @param x expression
     * @param y value
     * @return quotient
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Number</span>&gt; quot(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create an expression that returns the quotient
     * of its arguments.
     * @param x value
     * @param y expression
     * @return quotient
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Number</span>&gt; quot(<span class="predefined-type">Number</span> x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);
        
    <span class="comment">/**
     * Create an expression that returns the modulus
     * (remainder under integer division) of its
     * arguments.
     * @param x expression
     * @param y expression
     * @return modulus
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; mod(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; y);
        
    <span class="comment">/**
     * Create an expression that returns the modulus
     * (remainder under integer division) of its
     * arguments.
     * @param x expression
     * @param y value
     * @return modulus
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; mod(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; x, <span class="predefined-type">Integer</span> y);

    <span class="comment">/**
     * Create an expression that returns the modulus
     * (remainder under integer division) of its
     * arguments.
     * @param x value
     * @param y expression
     * @return modulus
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; mod(<span class="predefined-type">Integer</span> x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; y);

    <span class="comment">/**
     * Create an expression that returns the square root
     * of its argument.
     * @param x expression
     * @return square root
     */</span>        
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; sqrt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x);

    <span class="comment">/**
     * Create an expression that returns the exponential
     * of its argument, that is, Euler's number &lt;i&gt;e&lt;/i&gt;
     * raised to the power of its argument.
     * @param x expression
     * @return exponential
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; exp(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x);

    <span class="comment">/**
     * Create an expression that returns the natural logarithm
     * of its argument.
     * @param x expression
     * @return natural logarithm
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; ln(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x);

    <span class="comment">/**
     * Create an expression that returns the first argument
     * raised to the power of its second argument.
     * @param x base
     * @param y exponent
     * @return the base raised to the power of the exponent
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; power(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create an expression that returns the first argument
     * raised to the power of its second argument.
     * @param x base
     * @param y exponent
     * @return the base raised to the power of the exponent
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; power(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create an expression that returns the first argument
     * rounded to the number of decimal places given by the
     * second argument.
     * @param x base
     * @param n number of decimal places
     * @return the rounded value
     */</span>
    &lt;T <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;T&gt; round(<span class="predefined-type">Expression</span>&lt;T&gt; x, <span class="predefined-type">Integer</span> n);


    <span class="comment">//typecasts:</span>
    
    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return {@literal Expression&lt;Long&gt;}
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Long</span>&gt; toLong(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return {@literal Expression&lt;Integer&gt;}
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; toInteger(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast. Returns same expression object.
     * @param number  numeric expression
     * @return {@literal Expression&lt;Float&gt;}
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Float</span>&gt; toFloat(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return {@literal Expression&lt;Double&gt;}
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; toDouble(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return {@literal Expression&lt;BigDecimal&gt;}
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">BigDecimal</span>&gt; toBigDecimal(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return {@literal Expression&lt;BigInteger&gt;}
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">BigInteger</span>&gt; toBigInteger(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);
        
    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param character expression
     * @return {@literal Expression&lt;String&gt;}
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; toString(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; character);

        
    <span class="comment">//literals:</span>

    <span class="comment">/**
     * Create an expression for a literal.
     * @param value  value represented by the expression
     * @return expression literal
     * @throws IllegalArgumentException if value is null
     */</span>
    &lt;T&gt; <span class="predefined-type">Expression</span>&lt;T&gt; literal(T value);

    <span class="comment">/**
     * Create an expression for a null literal with the given type.
     * @param resultClass  type of the null literal
     * @return null expression literal
     */</span>
    &lt;T&gt; <span class="predefined-type">Expression</span>&lt;T&gt; nullLiteral(<span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">//parameters:</span>

    <span class="comment">/**
     * Create a parameter expression.
     * @param paramClass parameter class
     * @return parameter expression
     */</span>
    &lt;T&gt; ParameterExpression&lt;T&gt; parameter(<span class="predefined-type">Class</span>&lt;T&gt; paramClass);

    <span class="comment">/**
     * Create a parameter expression with the given name.
     * @param paramClass parameter class
     * @param name  name that can be used to refer to 
     *              the parameter
     * @return parameter expression
     */</span>
    &lt;T&gt; ParameterExpression&lt;T&gt; parameter(<span class="predefined-type">Class</span>&lt;T&gt; paramClass, <span class="predefined-type">String</span> name);


    <span class="comment">//collection operations:</span>
        
    <span class="comment">/**
     * Create a predicate that tests whether a collection is empty.
     * @param collection expression
     * @return is-empty predicate
     */</span>
    &lt;C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;?&gt;&gt; <span class="predefined-type">Predicate</span> isEmpty(<span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     * Create a predicate that tests whether a collection is
     * not empty.
     * @param collection expression
     * @return is-not-empty predicate
     */</span>
    &lt;C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;?&gt;&gt; <span class="predefined-type">Predicate</span> isNotEmpty(<span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     * Create an expression that tests the size of a collection.
     * @param collection expression
     * @return size expression
     */</span> 
    &lt;C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;?&gt;&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; size(<span class="predefined-type">Expression</span>&lt;C&gt; collection);
        
    <span class="comment">/**
     * Create an expression that tests the size of a collection.
     * @param collection collection
     * @return size expression
     */</span> 
    &lt;C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;?&gt;&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; size(C collection);
        
    <span class="comment">/**
     * Create a predicate that tests whether an element is
     * a member of a collection.
     * If the collection is empty, the predicate will be false.
     * @param elem element expression
     * @param collection expression
     * @return is-member predicate
     */</span>
    &lt;E, C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;E&gt;&gt; <span class="predefined-type">Predicate</span> isMember(<span class="predefined-type">Expression</span>&lt;E&gt; elem, <span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     * Create a predicate that tests whether an element is
     * a member of a collection.
     * If the collection is empty, the predicate will be false.
     * @param elem element
     * @param collection expression
     * @return is-member predicate
     */</span>
    &lt;E, C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;E&gt;&gt; <span class="predefined-type">Predicate</span> isMember(E elem, <span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     * Create a predicate that tests whether an element is
     * not a member of a collection.
     * If the collection is empty, the predicate will be true.
     * @param elem element expression
     * @param collection expression
     * @return is-not-member predicate
     */</span>
    &lt;E, C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;E&gt;&gt; <span class="predefined-type">Predicate</span> isNotMember(<span class="predefined-type">Expression</span>&lt;E&gt; elem, <span class="predefined-type">Expression</span>&lt;C&gt; collection);
        
    <span class="comment">/**
     * Create a predicate that tests whether an element is
     * not a member of a collection.
     * If the collection is empty, the predicate will be true.
     * @param elem element
     * @param collection expression
     * @return is-not-member predicate
     */</span>
    &lt;E, C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;E&gt;&gt; <span class="predefined-type">Predicate</span> isNotMember(E elem, <span class="predefined-type">Expression</span>&lt;C&gt; collection);


    <span class="comment">//get the values and keys collections of the Map, which may then</span>
    <span class="comment">//be passed to size(), isMember(), isEmpty(), etc</span>

    <span class="comment">/**
     * Create an expression that returns the values of a map.
     * @param map  map
     * @return collection expression
     */</span>
    &lt;V, M <span class="directive">extends</span> <span class="predefined-type">Map</span>&lt;?, V&gt;&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Collection</span>&lt;V&gt;&gt; values(M map);

    <span class="comment">/**
     * Create an expression that returns the keys of a map.
     * @param map  map
     * @return set expression
     */</span>
    &lt;K, M <span class="directive">extends</span> <span class="predefined-type">Map</span>&lt;K, ?&gt;&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Set</span>&lt;K&gt;&gt; keys(M map);

        
    <span class="comment">//string functions:</span>
        
    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern);
        
    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string 
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern);
        
    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @param escapeChar  escape character expression
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; escapeChar);
        
    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @param escapeChar  escape character
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="type">char</span> escapeChar);
        
    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string 
     * @param escapeChar  escape character expression
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string 
     * @param escapeChar  escape character
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="type">char</span> escapeChar);
        
    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern);
        
    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string 
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @param escapeChar  escape character expression
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @param escapeChar  escape character
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="type">char</span> escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string 
     * @param escapeChar  escape character expression
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; escapeChar);
        
   <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string 
     * @param escapeChar  escape character
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="type">char</span> escapeChar);

    <span class="comment">/**
     * Create an expression for string concatenation.
     * If the given list of expressions is empty, returns
     * an expression equivalent to {@code literal(&quot;&quot;)}.
     * @param expressions  string expressions
     * @return expression corresponding to concatenation
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; concat(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt;&gt; expressions);

    <span class="comment">/**
     * Create an expression for string concatenation.
     * @param x  string expression
     * @param y  string expression
     * @return expression corresponding to concatenation
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; concat(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; y);
        
    <span class="comment">/**
     * Create an expression for string concatenation.
     * @param x  string expression
     * @param y  string 
     * @return expression corresponding to concatenation
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; concat(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> y);

    <span class="comment">/**
     * Create an expression for string concatenation.
     * @param x  string 
     * @param y  string expression
     * @return expression corresponding to concatenation
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; concat(<span class="predefined-type">String</span> x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; y);
        
    <span class="comment">/**
     * Create an expression for substring extraction.
     * Extracts a substring starting at the specified position
     * through to end of the string.
     * First position is 1.
     * @param x  string expression
     * @param from  start position expression 
     * @return expression corresponding to substring extraction
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; from);
        
    <span class="comment">/**
     * Create an expression for substring extraction.
     * Extracts a substring starting at the specified position
     * through to end of the string.
     * First position is 1.
     * @param x  string expression
     * @param from  start position 
     * @return expression corresponding to substring extraction
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="type">int</span> from);

    <span class="comment">/**
     * Create an expression for substring extraction.
     * Extracts a substring of given length starting at the
     * specified position.
     * First position is 1.
     * @param x  string expression
     * @param from  start position expression 
     * @param len  length expression
     * @return expression corresponding to substring extraction
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; from, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; len);
        
    <span class="comment">/**
     * Create an expression for substring extraction.
     * Extracts a substring of given length starting at the
     * specified position.
     * First position is 1.
     * @param x  string expression
     * @param from  start position 
     * @param len  length
     * @return expression corresponding to substring extraction
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="type">int</span> from, <span class="type">int</span> len);
        
    <span class="comment">/**
     * Used to specify how strings are trimmed.
     */</span>
    <span class="type">enum</span> Trimspec {

        <span class="comment">/**
         * Trim from leading end.
         */</span>
        LEADING,
 
        <span class="comment">/**
         * Trim from trailing end.
         */</span>
        TRAILING, 

        <span class="comment">/**
         * Trim from both ends.
         */</span>
        BOTH 
    }
        
    <span class="comment">/**
     * Create expression to trim blanks from both ends of
     * a string.
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);
        
    <span class="comment">/**
     * Create expression to trim blanks from a string.
     * @param ts  trim specification
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(Trimspec ts, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression to trim character from both ends of
     * a string.
     * @param t  expression for character to be trimmed
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; t, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression to trim character from a string.
     * @param ts  trim specification
     * @param t  expression for character to be trimmed
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(Trimspec ts, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; t, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);
        
    <span class="comment">/**
     * Create expression to trim character from both ends of
     * a string.
     * @param t  character to be trimmed
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(<span class="type">char</span> t, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);
        
    <span class="comment">/**
     * Create expression to trim character from a string.
     * @param ts  trim specification
     * @param t  character to be trimmed
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(Trimspec ts, <span class="type">char</span> t, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);
        
    <span class="comment">/**
     * Create expression for converting a string to lowercase.
     * @param x  string expression
     * @return expression to convert to lowercase
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; lower(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);
        
    <span class="comment">/**
     * Create expression for converting a string to uppercase.
     * @param x  string expression
     * @return expression to convert to uppercase
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; upper(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);
        
    <span class="comment">/**
     * Create expression to return length of a string.
     * @param x  string expression
     * @return length expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; length(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create an expression for the leftmost substring of a string,
     * @param x  string expression
     * @param len  length of the substring to return
     * @return expression for the leftmost substring
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; left(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="type">int</span> len);

    <span class="comment">/**
     * Create an expression for the rightmost substring of a string,
     * @param x  string expression
     * @param len  length of the substring to return
     * @return expression for the rightmost substring
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; right(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="type">int</span> len);

    <span class="comment">/**
     * Create an expression for the leftmost substring of a string,
     * @param x  string expression
     * @param len  length of the substring to return
     * @return expression for the leftmost substring
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; left(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; len);

    <span class="comment">/**
     * Create an expression for the rightmost substring of a string,
     * @param x  string expression
     * @param len  length of the substring to return
     * @return expression for the rightmost substring
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; right(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; len);

    <span class="comment">/**
     * Create an expression replacing every occurrence of a substring
     * within a string.
     * @param x  string expression
     * @param substring  the literal substring to replace
     * @param replacement  the replacement string
     * @return expression for the resulting string
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; replace(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; replacement);

    <span class="comment">/**
     * Create an expression replacing every occurrence of a substring
     * within a string.
     * @param x  string expression
     * @param substring  the literal substring to replace
     * @param replacement  the replacement string
     * @return expression for the resulting string
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; replace(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> substring, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; replacement);

    <span class="comment">/**
     * Create an expression replacing every occurrence of a substring
     * within a string.
     * @param x  string expression
     * @param substring  the literal substring to replace
     * @param replacement  the replacement string
     * @return expression for the resulting string
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; replace(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring, <span class="predefined-type">String</span> replacement);

    <span class="comment">/**
     * Create an expression replacing every occurrence of a substring
     * within a string.
     * @param x  string expression
     * @param substring  the literal substring to replace
     * @param replacement  the replacement string
     * @return expression for the resulting string
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; replace(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> substring, <span class="predefined-type">String</span> replacement);


    <span class="comment">/**
     * Create expression to locate the position of one string
     * within another, returning position of first character
     * if found.
     * The first position in a string is denoted by 1.  If the
     * string to be located is not found, 0 is returned.
     * &lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; the order of the parameters
     * of this method is reversed compared to the corresponding
     * function in JPQL.
     * @param x  expression for string to be searched
     * @param pattern  expression for string to be located
     * @return expression corresponding to position
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; locate(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern);
        
    <span class="comment">/**
     * Create expression to locate the position of one string
     * within another, returning position of first character
     * if found.
     * The first position in a string is denoted by 1.  If the
     * string to be located is not found, 0 is returned.
     * &lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; the order of the parameters
     * of this method is reversed compared to the corresponding
     * function in JPQL.
     * @param x  expression for string to be searched
     * @param pattern  string to be located
     * @return expression corresponding to position
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; locate(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern);

    <span class="comment">/**
     * Create expression to locate the position of one string
     * within another, returning position of first character
     * if found.
     * The first position in a string is denoted by 1.  If the
     * string to be located is not found, 0 is returned.
     * &lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; the order of the first two
     * parameters of this method is reversed compared to the
     * corresponding function in JPQL.
     * @param x  expression for string to be searched
     * @param pattern  expression for string to be located
     * @param from  expression for position at which to start search
     * @return expression corresponding to position
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; locate(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; from);

    <span class="comment">/**
     * Create expression to locate the position of one string
     * within another, returning position of first character
     * if found.
     * The first position in a string is denoted by 1.  If the
     * string to be located is not found, 0 is returned.
     * &lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; the order of the first two
     * parameters of this method is reversed compared to the
     * corresponding function in JPQL.
     * @param x  expression for string to be searched
     * @param pattern  string to be located
     * @param from  position at which to start search
     * @return expression corresponding to position
     */</span>        
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; locate(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="type">int</span> from);
        

    <span class="comment">// Date/time/timestamp functions:</span>

    <span class="comment">/**
     * Create expression to return current date.
     * @return expression for current date
     */</span>
    <span class="predefined-type">Expression</span>&lt;java.sql.Date&gt; currentDate();

    <span class="comment">/**
     * Create expression to return current timestamp.
     * @return expression for current timestamp
     */</span>        
    <span class="predefined-type">Expression</span>&lt;java.sql.Timestamp&gt; currentTimestamp();

    <span class="comment">/**
     * Create expression to return current time.
     * @return expression for current time
     */</span>        
    <span class="predefined-type">Expression</span>&lt;java.sql.Time&gt; currentTime();

    <span class="comment">/**
     * Create expression to return current local date.
     * @return expression for current date
     */</span>
    <span class="predefined-type">Expression</span>&lt;java.time.LocalDate&gt; localDate();

    <span class="comment">/**
     * Create expression to return current local datetime.
     * @return expression for current timestamp
     */</span>
    <span class="predefined-type">Expression</span>&lt;java.time.LocalDateTime&gt; localDateTime();

    <span class="comment">/**
     * Create expression to return current local time.
     * @return expression for current time
     */</span>
    <span class="predefined-type">Expression</span>&lt;java.time.LocalTime&gt; localTime();

    <span class="comment">/**
     * Create an expression that returns the value of a
     * field extracted from a date, time, or datetime.
     * @param field a temporal field type
     * @param temporal a date, time, or datetime
     * @return expression for the value of the extracted field
     * @since 3.2
     */</span>
    &lt;N,T <span class="directive">extends</span> Temporal&gt; <span class="predefined-type">Expression</span>&lt;N&gt; extract(TemporalField&lt;N,T&gt; field, <span class="predefined-type">Expression</span>&lt;T&gt; temporal);
        

    <span class="comment">//in builders:</span>
        
    <span class="comment">/**
     * Interface used to build in predicates.
     */</span>
    <span class="type">interface</span> <span class="class">In</span>&lt;T&gt; <span class="directive">extends</span> <span class="predefined-type">Predicate</span> {

         <span class="comment">/**
          * Return the expression to be tested against the
          * list of values.
          * @return expression
          */</span>
         <span class="predefined-type">Expression</span>&lt;T&gt; getExpression();
        
         <span class="comment">/**
          * Add to list of values to be tested against.
          * @param value value
          * @return in predicate
          */</span>
         In&lt;T&gt; value(T value);

         <span class="comment">/**
          * Add to list of values to be tested against.
          * @param value expression
          * @return in predicate
          */</span>
         In&lt;T&gt; value(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> T&gt; value);
     }
        
    <span class="comment">/**
     * Create predicate to test whether given expression
     * is contained in a list of values.
     * @param  expression to be tested against list of values
     * @return  in predicate
     */</span>
    &lt;T&gt; In&lt;T&gt; in(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> T&gt; expression);
        

    <span class="comment">// coalesce, nullif:</span>

    <span class="comment">/**
     * Create an expression that returns null if all its arguments
     * evaluate to null, and the value of the first non-null argument
     * otherwise.
     * @param x expression
     * @param y expression
     * @return coalesce expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; coalesce(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create an expression that returns null if all its arguments
     * evaluate to null, and the value of the first non-null argument
     * otherwise.
     * @param x expression
     * @param y value
     * @return coalesce expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; coalesce(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);
    
    <span class="comment">/**
     * Create an expression that tests whether its argument are
     * equal, returning null if they are and the value of the
     * first expression if they are not.
     * @param x expression
     * @param y expression
     * @return nullif expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; nullif(<span class="predefined-type">Expression</span>&lt;Y&gt; x, <span class="predefined-type">Expression</span>&lt;?&gt; y);

    <span class="comment">/**
     * Create an expression that tests whether its argument are
     * equal, returning null if they are and the value of the
     * first expression if they are not.
     * @param x expression
     * @param y value
     * @return nullif expression 
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; nullif(<span class="predefined-type">Expression</span>&lt;Y&gt; x, Y y);


    <span class="comment">// coalesce builder:</span>

    <span class="comment">/**
     * Interface used to build coalesce expressions.  
     *  
     * A coalesce expression is equivalent to a case expression
     * that returns null if all its arguments evaluate to null,
     * and the value of its first non-null argument otherwise.
     */</span>
    <span class="type">interface</span> <span class="class">Coalesce</span>&lt;T&gt; <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;T&gt; {

         <span class="comment">/**
          * Add an argument to the coalesce expression.
          * @param value  value
          * @return coalesce expression
          */</span>
         Coalesce&lt;T&gt; value(T value);

         <span class="comment">/**
          * Add an argument to the coalesce expression.
          * @param value expression
          * @return coalesce expression
          */</span>
         Coalesce&lt;T&gt; value(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> T&gt; value);
        }
        
    <span class="comment">/**
     * Create a coalesce expression.
     * @return coalesce expression
     */</span>
    &lt;T&gt; Coalesce&lt;T&gt; coalesce();


    <span class="comment">//case builders:</span>

    <span class="comment">/**
     * Interface used to build simple case expressions.
     * Case conditions are evaluated in the order in which
     * they are specified.
     */</span>
    <span class="type">interface</span> <span class="class">SimpleCase</span>&lt;C,R&gt; <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;R&gt; {

                <span class="comment">/**
                 * Return the expression to be tested against the
                 * conditions.
                 * @return expression
                 */</span>
                <span class="predefined-type">Expression</span>&lt;C&gt; getExpression();

                <span class="comment">/**
                 * Add a when/then clause to the case expression.
                 * @param condition  &quot;when&quot; condition
                 * @param result  &quot;then&quot; result value
                 * @return simple case expression
                 */</span>
                SimpleCase&lt;C, R&gt; when(C condition, R result);

                <span class="comment">/**
                 * Add a when/then clause to the case expression.
                 * @param condition  &quot;when&quot; condition
                 * @param result  &quot;then&quot; result expression
                 * @return simple case expression
                 */</span>
                SimpleCase&lt;C, R&gt; when(C condition, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);

                <span class="comment">/**
                 * Add a when/then clause to the case expression.
                 * @param condition  &quot;when&quot; condition
                 * @param result  &quot;then&quot; result value
                 * @return simple case expression
                 */</span>
                SimpleCase&lt;C, R&gt; when(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> C&gt; condition, R result);

                <span class="comment">/**
                 * Add a when/then clause to the case expression.
                 * @param condition  &quot;when&quot; condition
                 * @param result  &quot;then&quot; result expression
                 * @return simple case expression
                 */</span>
                SimpleCase&lt;C, R&gt; when(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> C&gt; condition, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);

                <span class="comment">/**
                 * Add an &quot;else&quot; clause to the case expression.
                 * @param result  &quot;else&quot; result
                 * @return expression
                 */</span>
                <span class="predefined-type">Expression</span>&lt;R&gt; otherwise(R result);

                <span class="comment">/**
                 * Add an &quot;else&quot; clause to the case expression.
                 * @param result  &quot;else&quot; result expression
                 * @return expression
                 */</span>
                <span class="predefined-type">Expression</span>&lt;R&gt; otherwise(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);
        }
        
    <span class="comment">/**
     * Create a simple case expression.
     * @param expression  to be tested against the case conditions
     * @return simple case expression
     */</span>
    &lt;C, R&gt; SimpleCase&lt;C,R&gt; selectCase(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> C&gt; expression);


    <span class="comment">/**
     * Interface used to build general case expressions.
     * Case conditions are evaluated in the order in which
     * they are specified.
     */</span>
    <span class="type">interface</span> <span class="class">Case</span>&lt;R&gt; <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;R&gt; {

                <span class="comment">/**
                 * Add a when/then clause to the case expression.
                 * @param condition  &quot;when&quot; condition
                 * @param result  &quot;then&quot; result value
                 * @return general case expression
                 */</span>
                Case&lt;R&gt; when(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; condition, R result);

                <span class="comment">/**
                 * Add a when/then clause to the case expression.
                 * @param condition  &quot;when&quot; condition
                 * @param result  &quot;then&quot; result expression
                 * @return general case expression
                 */</span>
                Case&lt;R&gt; when(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; condition, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);

                <span class="comment">/**
                 * Add an &quot;else&quot; clause to the case expression.
                 * @param result  &quot;else&quot; result
                 * @return expression
                 */</span>
                <span class="predefined-type">Expression</span>&lt;R&gt; otherwise(R result);

                <span class="comment">/**
                 * Add an &quot;else&quot; clause to the case expression.
                 * @param result  &quot;else&quot; result expression
                 * @return expression
                 */</span>
                <span class="predefined-type">Expression</span>&lt;R&gt; otherwise(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);
        }
        
    <span class="comment">/**
     * Create a general case expression.
     * @return general case expression
     */</span>
    &lt;R&gt; Case&lt;R&gt; selectCase();

    <span class="comment">/**
     * Create an expression for the execution of a database
     * function.
     * @param name  function name
     * @param type  expected result type
     * @param args  function arguments
     * @return expression
     */</span>
   &lt;T&gt; <span class="predefined-type">Expression</span>&lt;T&gt; function(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;T&gt; type,
<span class="predefined-type">Expression</span>&lt;?&gt;... args);


    <span class="comment">// methods for downcasting:</span>

    <span class="comment">/**
     * Downcast Join object to the specified type.
     * @param join  Join object
     * @param type type to be downcast to
     * @return  Join object of the specified type
     * @since 2.1
     */</span>
    &lt;X, T, V <span class="directive">extends</span> T&gt; Join&lt;X, V&gt; treat(Join&lt;X, T&gt; join, <span class="predefined-type">Class</span>&lt;V&gt; type);

    <span class="comment">/**
     * Downcast CollectionJoin object to the specified type.
     * @param join  CollectionJoin object
     * @param type type to be downcast to
     * @return  CollectionJoin object of the specified type
     * @since 2.1
     */</span>
    &lt;X, T, E <span class="directive">extends</span> T&gt; CollectionJoin&lt;X, E&gt; treat(CollectionJoin&lt;X, T&gt; join, <span class="predefined-type">Class</span>&lt;E&gt; type);

    <span class="comment">/**
     * Downcast SetJoin object to the specified type.
     * @param join  SetJoin object
     * @param type type to be downcast to
     * @return  SetJoin object of the specified type
     * @since 2.1
     */</span>
    &lt;X, T, E <span class="directive">extends</span> T&gt; SetJoin&lt;X, E&gt; treat(SetJoin&lt;X, T&gt; join, <span class="predefined-type">Class</span>&lt;E&gt; type);

    <span class="comment">/**
     * Downcast ListJoin object to the specified type.
     * @param join  ListJoin object
     * @param type type to be downcast to
     * @return  ListJoin object of the specified type
     * @since 2.1
     */</span>
    &lt;X, T, E <span class="directive">extends</span> T&gt; ListJoin&lt;X, E&gt; treat(ListJoin&lt;X, T&gt; join, <span class="predefined-type">Class</span>&lt;E&gt; type);

    <span class="comment">/**
     * Downcast MapJoin object to the specified type.
     * @param join  MapJoin object
     * @param type type to be downcast to
     * @return  MapJoin object of the specified type
     * @since 2.1
     */</span>
    &lt;X, K, T, V <span class="directive">extends</span> T&gt; MapJoin&lt;X, K, V&gt; treat(MapJoin&lt;X, K, T&gt; join, <span class="predefined-type">Class</span>&lt;V&gt; type);


    <span class="comment">/**
     * Downcast Path object to the specified type.
     * @param path  path
     * @param type type to be downcast to
     * @return  Path object of the specified type
     * @since 2.1
     */</span>
    &lt;X, T <span class="directive">extends</span> X&gt; Path&lt;T&gt; treat(Path&lt;X&gt; path, <span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * Downcast Root object to the specified type.
     * @param root  root
     * @param type type to be downcast to
     * @return  Root object of the specified type
     * @since 2.1
     */</span>
    &lt;X, T <span class="directive">extends</span> X&gt; Root&lt;T&gt; treat(Root&lt;X&gt; root, <span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * Create a query which is the union of the given queries.
     * @return a new criteria query which returns the union of
     *         the results of the given queries
     * @since 3.2
     */</span>
    &lt;T&gt; CriteriaSelect&lt;T&gt; union(CriteriaSelect&lt;? <span class="directive">extends</span> T&gt; left, CriteriaSelect&lt;? <span class="directive">extends</span> T&gt; right);

    <span class="comment">/**
     * Create a query which is the union of the given queries,
     * without elimination of duplicate results.
     * @return a new criteria query which returns the union of
     *         the results of the given queries
     * @since 3.2
     */</span>
    &lt;T&gt; CriteriaSelect&lt;T&gt; unionAll(CriteriaSelect&lt;? <span class="directive">extends</span> T&gt; left, CriteriaSelect&lt;? <span class="directive">extends</span> T&gt; right);

    <span class="comment">/**
     * Create a query which is the intersection of the given queries.
     * @return a new criteria query which returns the intersection of
     *         the results of the given queries
     * @since 3.2
     */</span>
    &lt;T&gt; CriteriaSelect&lt;T&gt; intersect(CriteriaSelect&lt;? <span class="local-variable">super</span> T&gt; left, CriteriaSelect&lt;? <span class="local-variable">super</span> T&gt; right);

    <span class="comment">/**
     * Create a query which is the intersection of the given queries,
     * without elimination of duplicate results.
     * @return a new criteria query which returns the intersection of
     *         the results of the given queries
     * @since 3.2
     */</span>
    &lt;T&gt; CriteriaSelect&lt;T&gt; intersectAll(CriteriaSelect&lt;? <span class="local-variable">super</span> T&gt; left, CriteriaSelect&lt;? <span class="local-variable">super</span> T&gt; right);

    <span class="comment">/**
     * Create a query by (setwise) subtraction of the second query
     * from the first query.
     * @return a new criteria query which returns the result of
     *         subtracting the results of the second query from the
     *         results of the first query
     * @since 3.2
     */</span>
    &lt;T&gt; CriteriaSelect&lt;T&gt; except(CriteriaSelect&lt;T&gt; left, CriteriaSelect&lt;?&gt; right);

    <span class="comment">/**
     * Create a query by (setwise) subtraction of the second query
     * from the first query, without elimination of duplicate results.
     * @return a new criteria query which returns the result of
     *         subtracting the results of the second query from the
     *         results of the first query
     * @since 3.2
     */</span>
    &lt;T&gt; CriteriaSelect&lt;T&gt; exceptAll(CriteriaSelect&lt;T&gt; left, CriteriaSelect&lt;?&gt; right);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="criteriadelete"><a class="anchor" href="#criteriadelete"></a>C.2. <code>CriteriaDelete</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="comment">/**
 * The {@code CriteriaDelete} interface defines functionality for 
 * performing bulk delete operations using the Criteria API
 *
 * &lt;p&gt;Criteria API bulk delete operations map directly to database 
 * delete operations. The persistence context is not synchronized 
 * with the result of the bulk delete.
 *
 * &lt;p&gt; A {@code CriteriaDelete} object must have a single root.
 *
 * @param &lt;T&gt;  the entity type that is the target of the DELETE
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaDelete</span>&lt;T&gt; <span class="directive">extends</span> CommonAbstractCriteria {


    <span class="comment">/**
     * Create and add a query root corresponding to the entity
     * that is the target of the DELETE.
     * A {@code CriteriaDelete} object has a single root, the entity that
     * is being deleted.
     * @param entityClass  the entity class
     * @return query root corresponding to the given entity
     */</span>
    Root&lt;T&gt; from(<span class="predefined-type">Class</span>&lt;T&gt; entityClass);

    <span class="comment">/**
     * Create and add a query root corresponding to the entity
     * that is the target of the DELETE.
     * A {@code CriteriaDelete} object has a single root, the entity that
     * is being deleted.
     * @param entity  metamodel entity representing the entity
     *                of type X
     * @return query root corresponding to the given entity
     */</span>
    Root&lt;T&gt; from(EntityType&lt;T&gt; entity);

   <span class="comment">/**
    * Return the query root.
    * @return the query root
    */</span>
   Root&lt;T&gt; getRoot();

    <span class="comment">/**
     * Modify the DELETE query to restrict the target of the deletion 
     * according to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified delete query
     */</span>    
   CriteriaDelete&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the DELETE query to restrict the target of the deletion
     * according to the conjunction of the specified restriction 
     * predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  zero or more restriction predicates
     * @return the modified delete query
     */</span>
   CriteriaDelete&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_criteriaquery_"><a class="anchor" href="#_criteriaquery_"></a>C.3. <code>CriteriaQuery</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.Tuple</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * The {@code CriteriaQuery} interface defines functionality that is
 * specific to top-level queries.
 *
 * @param &lt;T&gt;  the type of the defined result
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaQuery</span>&lt;T&gt; <span class="directive">extends</span> AbstractQuery&lt;T&gt;, CriteriaSelect&lt;T&gt; {
        
    <span class="comment">/**
     * Specify the item that is to be returned in the query result.
     * Replaces the previously specified selection(s), if any.
     * 
     * &lt;p&gt; Note: Applications using the string-based API may need to
     * specify the type of the select item when it results from
     * a get or join operation and the query result type is 
     * specified. 
     *
     * &lt;p&gt;For example:
     * {@snippet :
     * CriteriaQuery&lt;String&gt; q = cb.createQuery(String.class);
     * Root&lt;Order&gt; order = q.from(Order.class);
     * q.select(order.get(&quot;shippingAddress&quot;).&lt;String&gt;get(&quot;state&quot;));
     * 
     * CriteriaQuery&lt;Product&gt; q2 = cb.createQuery(Product.class);
     * q2.select(q2.from(Order.class)
     *             .join(&quot;items&quot;)
     *             .&lt;Item, Product&gt;join(&quot;product&quot;));
     * }
     *
     * @param selection  selection specifying the item that is
     *                   to be returned in the query result
     * @return the modified query
     * @throws IllegalArgumentException if the selection is
     *         a compound selection and more than one selection
     *         item has the same assigned alias
     */</span>
    CriteriaQuery&lt;T&gt; select(Selection&lt;? <span class="directive">extends</span> T&gt; selection);

    <span class="comment">/**
     * Specify the selection items that are to be returned in the query result.
     * Replaces the previously specified selection(s), if any.
     *
     * &lt;p&gt; The type of the result of the query execution depends on the specification
     * of the type of the criteria query object created as well as the arguments
     * to the {@code multiselect} method.
     *
     * &lt;p&gt; An argument to the multiselect method must not be a tuple- or array-valued
     * compound selection item.
     *
     * &lt;p&gt;The semantics of this method are as follows: 
     * &lt;ul&gt; 
     * &lt;li&gt; 
     * If the type of the criteria query is {@code CriteriaQuery&lt;Tuple&gt;}
     * (i.e., a criteria query object created by either the {@code createTupleQuery}
     * method or by passing a {@link Tuple} class argument to the {@code createQuery}
     * method), a {@link Tuple} object corresponding to the arguments of the
     * {@code multiselect} method, in the specified order, will be instantiated and
     * returned for each row that results from the query execution.
     *
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;X&gt;}
     * for some user-defined class X (i.e., a criteria query object created by
     * passing a X class argument to the {@code createQuery} method), the arguments
     * to the {@code multiselect} method will be passed to the X constructor and an
     * instance of type X will be returned for each row.
     *
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;X[]&gt;}
     * for some class X, an instance of type {@code X[]} will be returned for each row.
     * The elements of the array will correspond to the arguments of the
     * {@code multiselect} method, in the specified order.
     *
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;Object&gt;}
     * or if the criteria query was created without specifying a type, and only a single
     * argument is passed to the {@code multiselect} method, an instance of type
     * {@code Object} will be returned for each row.
     *
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;Object&gt;}
     * or if the criteria query was created without specifying a type, and more than one
     * argument is passed to the {@code multiselect} method, an instance of type
     * {@code Object[]} will be instantiated and returned for each row.  The elements of
     * the array will correspond to the arguments to the {@code multiselect} method, in
     * the specified order.
     * &lt;/ul&gt;
     *
     * @param selections  selection items corresponding to the
     *                    results to be returned by the query
     * @return the modified query
     * @throws IllegalArgumentException if a selection item is
     *         not valid or if more than one selection item has
     *         the same assigned alias
     *
     * @deprecated Since this method is not typesafe, the use of
     * {@link CriteriaBuilder#array} or {@link CriteriaBuilder#tuple}
     * with {@link #select} is strongly preferred.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    CriteriaQuery&lt;T&gt; multiselect(Selection&lt;?&gt;... selections);


    <span class="comment">/**
     * Specify the selection items that are to be returned in the query result.
     * Replaces the previously specified selection(s), if any.
     *
     * &lt;p&gt; The type of the result of the query execution depends on the specification
     * of the type of the criteria query object created as well as the argument to the
     * {@code multiselect} method. An element of the list passed to the {@code multiselect}
     * method must not be a tuple- or array-valued compound selection item.
     *
     * &lt;p&gt; The semantics of this method are as follows:
     * &lt;ul&gt;
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;Tuple&gt;}
     * (i.e., a criteria query object created by either the {@code createTupleQuery}
     * method or by passing a {@link Tuple} class argument to the {@code createQuery}
     * method), a {@code Tuple} object corresponding to the elements of the list passed
     * to the {@code multiselect} method, in the specified order, will be instantiated
     * and returned for each row that results from the query execution.
     *
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;X&gt;}
     * for some user-defined class X (i.e., a criteria query object created by passing
     * a X class argument to the {@code createQuery} method), the elements of the list
     * passed to the {@code multiselect} method will be passed to the X constructor
     * and an instance of type X will be returned for each row.
     *
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;X[]&gt;}
     * for some class X, an instance of type {@code X[]} will be returned for
     * each row. The elements of the array will correspond to the elements of
     * the list passed to the {@code multiselect} method, in the specified order.
     *
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;Object&gt;}
     * or if the criteria query was created without specifying a type, and the list
     * passed to the {@code multiselect} method contains only a single element, an
     * instance of type {@code Object} will be returned for each row.
     *
     * &lt;li&gt; If the type of the criteria query is {@code CriteriaQuery&lt;Object&gt;}
     * or if the criteria query was created without specifying a type, and the list
     * passed to the {@code multiselect} method contains more than one element, an
     * instance of type {@code Object[]} will be instantiated and returned for each row.
     * The elements of the array will correspond to the elements of the list passed to
     * the {@code multiselect} method, in the specified order.
     * &lt;/ul&gt;
     *
     * @param selectionList  list of selection items corresponding
     *                       to the results to be returned by the
     *                       query
     * @return the modified query
     * @throws IllegalArgumentException if a selection item is
     *         not valid or if more than one selection item has
     *         the same assigned alias
     *
     * @deprecated Since this method is not typesafe, the use of
     * {@link CriteriaBuilder#array} or {@link CriteriaBuilder#tuple}
     * with {@link #select} is strongly preferred.
     */</span>
    <span class="annotation">@Deprecated</span>(since = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.2</span><span class="delimiter">&quot;</span></span>)
    CriteriaQuery&lt;T&gt; multiselect(<span class="predefined-type">List</span>&lt;Selection&lt;?&gt;&gt; selectionList);

    <span class="comment">/**
     * Modify the query to restrict the query result according
     * to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param restriction  a simple or compound boolean expression
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the query to restrict the query result according 
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param restrictions  zero or more restriction predicates
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Modify the query to restrict the query result according
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the
     * corresponding {@code AbstractQuery} method.
     * @param restrictions  a list of zero or more restriction predicates
     * @return the modified query
     * @since 3.2
     */</span>
    CriteriaQuery&lt;T&gt; where(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Predicate</span>&gt; restrictions);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the query results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously 
     * added grouping expressions are simply removed.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param grouping  zero or more grouping expressions
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; groupBy(<span class="predefined-type">Expression</span>&lt;?&gt;... grouping);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the query results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously 
     * added grouping expressions are simply removed.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param grouping  list of zero or more grouping expressions
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; groupBy(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;?&gt;&gt; grouping);

    <span class="comment">/**
     * Specify a restriction over the groups of the query.
     * Replaces the previous having restriction(s), if any.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param restriction  a simple or compound boolean expression
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; having(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Specify restrictions over the groups of the query
     * according the conjunction of the specified restriction 
     * predicates.
     * Replaces the previously added having restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param restrictions  zero or more restriction predicates
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; having(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify restrictions over the groups of the query
     * according the conjunction of the specified restriction
     * predicates.
     * Replaces the previously added having restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the
     * corresponding {@code AbstractQuery} method.
     * @param restrictions  a list of zero or more restriction predicates
     * @return the modified query
     * @since 3.2
     */</span>
    CriteriaQuery&lt;T&gt; having(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Predicate</span>&gt; restrictions);

    <span class="comment">/**
     * Specify the ordering expressions that are used to
     * order the query results.
     * Replaces the previous ordering expressions, if any.
     * If no ordering expressions are specified, the previous
     * ordering, if any, is simply removed, and results will
     * be returned in no particular order.
     * The left-to-right sequence of the ordering expressions
     * determines the precedence, whereby the leftmost has the
     * highest precedence.
     * @param o  zero or more ordering expressions
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; orderBy(Order... o);

    <span class="comment">/**
     * Specify the ordering expressions that are used to
     * order the query results.
     * Replaces the previous ordering expressions, if any.
     * If no ordering expressions are specified, the previous
     * ordering, if any, is simply removed, and results will
     * be returned in no particular order.
     * The order of the ordering expressions in the list
     * determines the precedence, whereby the first element in
     * the list has the highest precedence.
     * @param o  list of zero or more ordering expressions
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; orderBy(<span class="predefined-type">List</span>&lt;Order&gt; o);

    <span class="comment">/**
     * Specify whether duplicate query results are eliminated.
     * A true value will cause duplicates to be eliminated.
     * A false value will cause duplicates to be retained.
     * If distinct has not been specified, duplicate results must
     * be retained.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param distinct  boolean value specifying whether duplicate
     *        results must be eliminated from the query result or
     *        whether they must be retained
     * @return the modified query.
     */</span>
    CriteriaQuery&lt;T&gt; distinct(<span class="type">boolean</span> distinct);
    
    <span class="comment">/**
     * Return the ordering expressions in order of precedence.
     * Returns empty list if no ordering expressions have been
     * specified.
     * Modifications to the list do not affect the query.
     * @return the list of ordering expressions
     */</span>
    <span class="predefined-type">List</span>&lt;Order&gt; getOrderList();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="criteriaselect"><a class="anchor" href="#criteriaselect"></a>C.4. <code>CriteriaSelect</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Abstracts over {@linkplain CriteriaQuery top-level queries} and
 * {@linkplain CriteriaBuilder#union unions} and
 * {@linkplain CriteriaBuilder#intersect intersections} of top-level
 * queries.
 *
 * @param &lt;T&gt;  the type returned by the query
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaSelect</span>&lt;T&gt; {
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="criteriaupdate"><a class="anchor" href="#criteriaupdate"></a>C.5. <code>CriteriaUpdate</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="comment">/**
 * The {@code CriteriaUpdate} interface defines functionality for
 * performing bulk update operations using the Criteria API.
 *
 * &lt;p&gt;Criteria API bulk update operations map directly to database
 * update operations, bypassing any optimistic locking checks.
 * Portable applications using bulk update operations must manually
 * update the value of the version column, if desired, and/or manually
 * validate the value of the version column. The persistence context
 * is not automatically synchronized with the result of the bulk update.
 *
 * &lt;p&gt; A {@code CriteriaUpdate} object must have a single root.
 *
 * @param &lt;T&gt;  the entity type that is the target of the update
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaUpdate</span>&lt;T&gt; <span class="directive">extends</span> CommonAbstractCriteria {

   <span class="comment">/**
    * Create and add a query root corresponding to the entity
    * that is the target of the update.
    * A {@code CriteriaUpdate} object has a single root, the
    * entity that is being updated.
    * @param entityClass  the entity class
    * @return query root corresponding to the given entity
    */</span>
   Root&lt;T&gt; from(<span class="predefined-type">Class</span>&lt;T&gt; entityClass);

   <span class="comment">/**
    * Create and add a query root corresponding to the entity
    * that is the target of the update.
    * A {@code CriteriaUpdate} object has a single root, the
    * entity that is being updated.
    * @param entity  metamodel entity representing the entity
    *                of type X
    * @return query root corresponding to the given entity
    */</span>
   Root&lt;T&gt; from(EntityType&lt;T&gt; entity);

   <span class="comment">/**
    * Return the query root.
    * @return the query root
    */</span>
   Root&lt;T&gt; getRoot();

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attribute  attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   &lt;Y, X <span class="directive">extends</span> Y&gt; CriteriaUpdate&lt;T&gt; set( SingularAttribute&lt;? <span class="local-variable">super</span> T, Y&gt; attribute, X value);

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attribute  attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   &lt;Y&gt; CriteriaUpdate&lt;T&gt; set( SingularAttribute&lt;? <span class="local-variable">super</span> T, Y&gt; attribute, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; value);

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attribute  attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   &lt;Y, X <span class="directive">extends</span> Y&gt; CriteriaUpdate&lt;T&gt; set(Path&lt;Y&gt; attribute, X value);

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attribute  attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   &lt;Y&gt; CriteriaUpdate&lt;T&gt; set(Path&lt;Y&gt; attribute, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; value);

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attributeName  name of the attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   CriteriaUpdate&lt;T&gt; set(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Modify the update query to restrict the target of the
     * update according to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified update query
     */</span>    
   CriteriaUpdate&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the update query to restrict the target of the
     * update according to the conjunction of the specified
     * restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  zero or more restriction predicates
     * @return the modified update query
     */</span>
   CriteriaUpdate&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="abstractquery"><a class="anchor" href="#abstractquery"></a>C.6. <code>AbstractQuery</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="comment">/**
 * The {@code AbstractQuery} interface defines functionality that is common
 * to both top-level queries and subqueries.
 * It is not intended to be used directly in query construction.
 *
 * &lt;p&gt; All queries must have:
 *         a set of root entities (which may in turn own joins).
 * &lt;p&gt; All queries may have:
 *         a conjunction of restrictions.
 *
 * @param &lt;T&gt;  the type of the result
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AbstractQuery</span>&lt;T&gt; <span class="directive">extends</span> CommonAbstractCriteria {

    <span class="comment">/**
     * Create and add a query root corresponding to the given entity,
     * forming a cartesian product with any existing roots.
     * @param entityClass  the entity class
     * @return query root corresponding to the given entity
     */</span>
    &lt;X&gt; Root&lt;X&gt; from(<span class="predefined-type">Class</span>&lt;X&gt; entityClass);

    <span class="comment">/**
     * Create and add a query root corresponding to the given entity,
     * forming a cartesian product with any existing roots.
     * @param entity  metamodel entity representing the entity
     *                of type X
     * @return query root corresponding to the given entity
     */</span>
    &lt;X&gt; Root&lt;X&gt; from(EntityType&lt;X&gt; entity);

    <span class="comment">/**
     * Modify the query to restrict the query results according
     * to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified query
     */</span>    
    AbstractQuery&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the query to restrict the query results according 
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  zero or more restriction predicates
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Modify the query to restrict the query result according
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  a list of zero or more restriction predicates
     * @return the modified query
     * @since 3.2
     */</span>
    AbstractQuery&lt;T&gt; where(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Predicate</span>&gt; restrictions);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the query results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously 
     * added grouping expressions are simply removed.
     * @param grouping  zero or more grouping expressions
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; groupBy(<span class="predefined-type">Expression</span>&lt;?&gt;... grouping);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the query results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously 
     * added grouping expressions are simply removed.
     * @param grouping  list of zero or more grouping expressions
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; groupBy(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;?&gt;&gt; grouping);

    <span class="comment">/**
     * Specify a restriction over the groups of the query.
     * Replaces the previous having restriction(s), if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; having(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Specify restrictions over the groups of the query
     * according the conjunction of the specified restriction 
     * predicates.
     * Replaces the previously having added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  zero or more restriction predicates
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; having(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify restrictions over the groups of the query
     * according the conjunction of the specified restriction
     * predicates.
     * Replaces the previously added having restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  a list of zero or more restriction predicates
     * @return the modified query
     * @since 3.2
     */</span>
    AbstractQuery&lt;T&gt; having(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Predicate</span>&gt; restrictions);

    <span class="comment">/**
     * Specify whether duplicate query results are eliminated.
     * A true value will cause duplicates to be eliminated.
     * A false value will cause duplicates to be retained.
     * If distinct has not been specified, duplicate results must
     * be retained.
     * @param distinct  boolean value specifying whether duplicate
     *        results must be eliminated from the query result or
     *        whether they must be retained
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; distinct(<span class="type">boolean</span> distinct);

    <span class="comment">/**
     * Return the query roots. These are the roots that are
     * defined for the {@link CriteriaQuery} or {@link Subquery}
     * itself, including any subquery roots defined as a result of
     * correlation. Returns an empty set if no roots have been
     * defined. Modifications to the set do not affect the query.
     * @return the set of query roots
     */</span>   
    <span class="predefined-type">Set</span>&lt;Root&lt;?&gt;&gt; getRoots();

    <span class="comment">/**
     * Return the selection of the query, or null if no selection
     * has been set.
     * @return selection item 
     */</span>
    Selection&lt;T&gt; getSelection();

    <span class="comment">/**
     * Return a list of the grouping expressions.  Returns empty
     * list if no grouping expressions have been specified.
     * Modifications to the list do not affect the query.
     * @return the list of grouping expressions
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;?&gt;&gt; getGroupList();

    <span class="comment">/**
     * Return the predicate that corresponds to the restriction(s)
     * over the grouping items, or null if no restrictions have 
     * been specified.
     * @return having clause predicate
     */</span>
    <span class="predefined-type">Predicate</span> getGroupRestriction();

    <span class="comment">/**
     * Return whether duplicate query results must be eliminated or
     * retained.
     * @return boolean indicating whether duplicate query results 
     *         must be eliminated
     */</span>
    <span class="type">boolean</span> isDistinct();

    <span class="comment">/**
     * Return the result type of the query or subquery. If
     * a result type was specified as an argument to the
     * {@code createQuery} or {@code subquery} method, that
     * type is returned. If the query was created using the
     * {@code createTupleQuery} method, the result type is
     * {@code Tuple}. Otherwise, the result type is
     * {@code Object}.
     * @return result type
     */</span>
    <span class="predefined-type">Class</span>&lt;T&gt; getResultType();          
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="collectionjoin"><a class="anchor" href="#collectionjoin"></a>C.7. <code>CollectionJoin</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.Collection</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.CollectionAttribute</span>;

<span class="comment">/**
 * The {@code CollectionJoin} interface is the type of the result of
 * joining to a collection over an association or element 
 * collection that has been specified as a {@link java.util.Collection}.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;E&gt; the element type of the target {@code Collection} 
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CollectionJoin</span>&lt;Z, E&gt; 
                <span class="directive">extends</span> PluralJoin&lt;Z, <span class="predefined-type">Collection</span>&lt;E&gt;, E&gt; {

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified join object
     * @since 2.1
     */</span>
    CollectionJoin&lt;Z, E&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restrictions  zero or more restriction predicates
     * @return the modified join object
     * @since 2.1
     */</span>
    CollectionJoin&lt;Z, E&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Return the metamodel representation for the collection
     * attribute.
     * @return metamodel type representing the {@code Collection} that is
     *         the target of the join
     */</span>
    CollectionAttribute&lt;? <span class="local-variable">super</span> Z, E&gt; getModel();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="commonabstractcriteria"><a class="anchor" href="#commonabstractcriteria"></a>C.8. <code>CommonAbstractCriteria</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * The {@code CommonAbstractCriteria} interface defines functionality
 * that is common to both top-level criteria queries and subqueries as 
 * well as to update and delete criteria operations.
 * It is not intended to be used directly in query construction.
 *
 * &lt;p&gt; Note that criteria queries and criteria update and delete operations
 * are typed differently.
 * Criteria queries are typed according to the query result type.
 * Update and delete operations are typed according to the target of the
 * update or delete.
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CommonAbstractCriteria</span> {

    <span class="comment">/**
     * Create a subquery of the query. 
     * @param type  the subquery result type
     * @return subquery 
     */</span>
    &lt;U&gt; Subquery&lt;U&gt; subquery(<span class="predefined-type">Class</span>&lt;U&gt; type);

    <span class="comment">/**
     * Create a subquery of the query.
     * @param type  the subquery result type
     * @return subquery
     */</span>
    &lt;U&gt; Subquery&lt;U&gt; subquery(EntityType&lt;U&gt; type);

    <span class="comment">/**
     * Return the predicate that corresponds to the where clause
     * restriction(s), or null if no restrictions have been
     * specified.
     * @return where clause predicate
     */</span>
    <span class="predefined-type">Predicate</span> getRestriction();

    <span class="comment">/**
     * Return the parameters of the query.  Returns empty set if
     * there are no parameters.
     * Modifications to the set do not affect the query.
     * @return the query parameters
     */</span>
    <span class="predefined-type">Set</span>&lt;ParameterExpression&lt;?&gt;&gt; getParameters();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="compoundselection"><a class="anchor" href="#compoundselection"></a>C.9. <code>CompoundSelection</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * The {@code CompoundSelection} interface defines a compound
 * selection item (a tuple, array, or result of a constructor).
 *
 * @param &lt;X&gt; the type of the selection item
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CompoundSelection</span>&lt;X&gt; <span class="directive">extends</span> Selection&lt;X&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="expression"><a class="anchor" href="#expression"></a>C.10. <code>Expression</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.Collection</span>;

<span class="comment">/**
 * Type for query expressions.
 *
 * @param &lt;T&gt; the type of the expression
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Expression</span>&lt;T&gt; <span class="directive">extends</span> Selection&lt;T&gt; {

    <span class="comment">/**
     * Create a predicate to test whether the expression is null.
     * @return predicate testing whether the expression is null
     */</span>
    <span class="predefined-type">Predicate</span> isNull();

    <span class="comment">/**
     * Create a predicate to test whether the expression is 
     * not null.
     * @return predicate testing whether the expression is not null
     */</span>
    <span class="predefined-type">Predicate</span> isNotNull();

    <span class="comment">/**
     * Create a predicate to test whether the expression is equal to
     * the argument.
     * @param value  expression to be tested against
     * @return predicate testing for equality
     * @since 3.2
     */</span>
    <span class="predefined-type">Predicate</span> equalTo(<span class="predefined-type">Expression</span>&lt;?&gt; value);

    <span class="comment">/**
     * Create a predicate to test whether the expression is equal to
     * the argument.
     * @param value  value to be tested against
     * @return predicate testing for equality
     * @since 3.2
     */</span>
    <span class="predefined-type">Predicate</span> equalTo(<span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Create a predicate to test whether the expression is unequal
     * to the argument.
     * @param value  expression to be tested against
     * @return predicate testing for inequality
     * @since 3.2
     */</span>
    <span class="predefined-type">Predicate</span> notEqualTo(<span class="predefined-type">Expression</span>&lt;?&gt; value);

    <span class="comment">/**
     * Create a predicate to test whether the expression is unequal
     * to the argument.
     * @param value  value to be tested against
     * @return predicate testing for inequality
     * @since 3.2
     */</span>
    <span class="predefined-type">Predicate</span> notEqualTo(<span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Create a predicate to test whether the expression is a member
     * of the argument list.
     * @param values  values to be tested against
     * @return predicate testing for membership
     */</span>
    <span class="predefined-type">Predicate</span> in(<span class="predefined-type">Object</span>... values);

    <span class="comment">/**
     * Create a predicate to test whether the expression is a member
     * of the argument list.
     * @param values  expressions to be tested against
     * @return predicate testing for membership
     */</span>
    <span class="predefined-type">Predicate</span> in(<span class="predefined-type">Expression</span>&lt;?&gt;... values);

    <span class="comment">/**
     * Create a predicate to test whether the expression is a member
     * of the collection.
     * @param values  collection of values to be tested against
     * @return predicate testing for membership
     */</span>
    <span class="predefined-type">Predicate</span> in(<span class="predefined-type">Collection</span>&lt;?&gt; values);

    <span class="comment">/**
     * Create a predicate to test whether the expression is a member
     * of the collection.
     * @param values expression corresponding to collection to be
     *        tested against
     * @return predicate testing for membership
     */</span>
    <span class="predefined-type">Predicate</span> in(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Collection</span>&lt;?&gt;&gt; values);

    <span class="comment">/**
     * Perform a typecast upon the expression, returning a new
     * expression object.
     * Unlike {@link #cast(Class)}, this method does not cause
     * type conversion: the runtime type is not changed.
     * &lt;p&gt;&lt;em&gt;Warning: may result in a runtime failure.&lt;/em&gt;
     * @param type  intended type of the expression
     * @return new expression of the given type
     * @see #cast(Class)
     */</span>
    &lt;X&gt; <span class="predefined-type">Expression</span>&lt;X&gt; as(<span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Cast this expression to the specified type, returning a
     * new expression object.
     * Unlike {@link #as(Class)}, this method &lt;em&gt;does&lt;/em&gt;
     * result in a runtime type conversion.
     * &lt;p&gt;&lt;em&gt;Providers are required to support casting
     * scalar expressions to {@link String}, and
     * {@code String} expressions to {@link Integer},
     * {@link Long}, {@link Float}, and {@link Double}.
     * Support for typecasts between other basic types is
     * not required.&lt;/em&gt;
     * @param type  a basic type
     * @return a scalar expression of the given basic type
     * @since 3.2
     */</span>
    &lt;X&gt; <span class="predefined-type">Expression</span>&lt;X&gt; cast(<span class="predefined-type">Class</span>&lt;X&gt; type);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fetch"><a class="anchor" href="#fetch"></a>C.11. <code>Fetch</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Attribute</span>;

<span class="comment">/**
 * Represents a join-fetched association or attribute.
 *
 * @param &lt;Z&gt;  the source type of the fetch
 * @param &lt;X&gt;  the target type of the fetch
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Fetch</span>&lt;Z, X&gt; <span class="directive">extends</span> FetchParent&lt;Z, X&gt; {

    <span class="comment">/**
     * Return the metamodel attribute corresponding to the 
     * fetch join.
     * @return metamodel attribute for the join
     */</span>
    <span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> Z, ?&gt; getAttribute();

    <span class="comment">/**
     * Return the parent of the fetched item.
     * @return fetch parent
     */</span>
    FetchParent&lt;?, Z&gt; getParent();

    <span class="comment">/**
     * Return the join type used in the fetch join.
     * @return join type
     */</span>
    JoinType getJoinType();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fetchparent"><a class="anchor" href="#fetchparent"></a>C.12. <code>FetchParent</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.PluralAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;

<span class="comment">/**
 * Represents an element of the from clause which may
 * function as the parent of Fetches.
 *
 * @param &lt;Z&gt;  the source type
 * @param &lt;X&gt;  the target type
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">FetchParent</span>&lt;Z, X&gt; {

    <span class="comment">/**
     * Return the fetch joins that have been made from this type.
     * Returns empty set if no fetch joins have been made from
     * this type.
     * Modifications to the set do not affect the query.
     * @return fetch joins made from this type
     */</span>
    java.util.Set&lt;Fetch&lt;X, ?&gt;&gt; getFetches();

    <span class="comment">/**
     * Create a fetch join to the specified single-valued attribute 
     * using an inner join.
     * @param attribute  target of the join
     * @return the resulting fetch join
     */</span>        
    &lt;Y&gt; Fetch&lt;X, Y&gt; fetch(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute);

    <span class="comment">/**
     * Create a fetch join to the specified single-valued attribute 
     * using the given join type.
     * @param attribute  target of the join
     * @param jt  join type
     * @return the resulting fetch join
     */</span>        
    &lt;Y&gt; Fetch&lt;X, Y&gt; fetch(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute, JoinType jt);

    <span class="comment">/**
     * Create a fetch join to the specified collection-valued 
     * attribute using an inner join. 
     * @param attribute  target of the join
     * @return the resulting join
     */</span>
    &lt;Y&gt; Fetch&lt;X, Y&gt; fetch(PluralAttribute&lt;? <span class="local-variable">super</span> X, ?, Y&gt; attribute);
        
    <span class="comment">/**
     * Create a fetch join to the specified collection-valued 
     * attribute using the given join type.
     * @param attribute  target of the join
     * @param jt  join type
     * @return the resulting join
     */</span>
    &lt;Y&gt; Fetch&lt;X, Y&gt; fetch(PluralAttribute&lt;? <span class="local-variable">super</span> X, ?, Y&gt; attribute, JoinType jt);
        

    <span class="comment">//String-based:</span>
        
    <span class="comment">/**
     * Create a fetch join to the specified attribute using an 
     * inner join.
     * @param attributeName  name of the attribute for the
     *        target of the join
     * @return the resulting fetch join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>        
    <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hiding</span><span class="delimiter">&quot;</span></span>)
    &lt;X, Y&gt; Fetch&lt;X, Y&gt; fetch(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Create a fetch join to the specified attribute using 
     * the given join type.
     * @param attributeName  name of the attribute for the
     *              target of the join
     * @param jt  join type
     * @return the resulting fetch join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>        
    <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hiding</span><span class="delimiter">&quot;</span></span>)
    &lt;X, Y&gt; Fetch&lt;X, Y&gt; fetch(<span class="predefined-type">String</span> attributeName, JoinType jt);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="abstractquery-2"><a class="anchor" href="#abstractquery-2"></a>C.13. <code>AbstractQuery</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.CollectionAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.ListAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.MapAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SetAttribute</span>;

<span class="keyword">import</span> <span class="include">java.util.Collection</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * Represents a bound type, usually an entity that appears in
 * the from clause, but may also be an embeddable belonging to
 * an entity in the from clause. 
 * &lt;p&gt; Serves as a factory for {@link Join}s of associations,
 * embeddables, and collections belonging to the type, and for
 * {@link Path}s of attributes belonging to the type.
 *
 * @param &lt;Z&gt;  the source type
 * @param &lt;X&gt;  the target type
 *
 * @since 2.0
 */</span>
<span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hiding</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">From</span>&lt;Z, X&gt; <span class="directive">extends</span> Path&lt;X&gt;, FetchParent&lt;Z, X&gt; {

    <span class="comment">/**
     * Return the joins that have been made from this bound type.
     * Returns empty set if no joins have been made from this
     * bound type.
     * Modifications to the set do not affect the query.
     * @return joins made from this type
     */</span>
    <span class="predefined-type">Set</span>&lt;Join&lt;X, ?&gt;&gt; getJoins();
        
    <span class="comment">/**
     * Whether the {@link From} object has been obtained as a result
     * of correlation (use of a {@link Subquery#correlate} method).
     * @return boolean indicating whether the object has been
     *         obtained through correlation
     */</span>
    <span class="type">boolean</span> isCorrelated();

    <span class="comment">/**
     * Returns the parent {@link From} object from which the correlated
     * {@link From} object has been obtained through correlation (use
     * of {@link Subquery#correlate} method).
     * @return  the parent of the correlated {@code From} object
     * @throws IllegalStateException if the {@code From} object has
     *         not been obtained through correlation
     */</span>
    From&lt;Z, X&gt; getCorrelationParent();

    <span class="comment">/**
     * Create and add an inner join to the given entity.
     * @param entityClass  the target entity class
     * @return the resulting join
     * @since 3.2
     */</span>
    &lt;Y&gt; Join&lt;X, Y&gt; join(<span class="predefined-type">Class</span>&lt;Y&gt; entityClass);

    <span class="comment">/**
     * Create and add a join to the given entity.
     * @param entityClass  the target entity class
     * @param joinType  join type
     * @return the resulting join
     * @since 3.2
     */</span>
    &lt;Y&gt; Join&lt;X, Y&gt; join(<span class="predefined-type">Class</span>&lt;Y&gt; entityClass, JoinType joinType);

    <span class="comment">/**
     * Create and add an inner join to the given entity.
     * @param entity  metamodel entity representing the join target
     * @return the resulting join
     * @since 3.2
     */</span>
    &lt;Y&gt; Join&lt;X, Y&gt; join(EntityType&lt;Y&gt; entity);

    <span class="comment">/**
     * Create and add a join to the given entity.
     * @param entity  metamodel entity representing the join target
     * @param joinType  join type
     * @return the resulting join
     * @since 3.2
     */</span>
    &lt;Y&gt; Join&lt;X, Y&gt; join(EntityType&lt;Y&gt; entity, JoinType joinType);

    <span class="comment">/**
     * Create an inner join to the specified single-valued 
     * attribute.
     * @param attribute  target of the join
     * @return the resulting join
     */</span>
    &lt;Y&gt; Join&lt;X, Y&gt; join(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute);

    <span class="comment">/**
     * Create a join to the specified single-valued attribute 
     * using the given join type.
     * @param attribute  target of the join
     * @param jt  join type 
     * @return the resulting join
     */</span>
    &lt;Y&gt; Join&lt;X, Y&gt; join(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute, JoinType jt);

    <span class="comment">/**
     * Create an inner join to the specified {@link Collection}-valued
     * attribute.
     * @param collection  target of the join
     * @return the resulting join
     */</span>
    &lt;Y&gt; CollectionJoin&lt;X, Y&gt; join(CollectionAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; collection);

    <span class="comment">/**
     * Create an inner join to the specified {@link Set}-valued
     * attribute.
     * @param set  target of the join
     * @return the resulting join
     */</span>
    &lt;Y&gt; SetJoin&lt;X, Y&gt; join(SetAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; set);

    <span class="comment">/**
     * Create an inner join to the specified
     * {@link List}-valued attribute.
     * @param list  target of the join
     * @return the resulting join
     */</span>
    &lt;Y&gt; ListJoin&lt;X, Y&gt; join(ListAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; list);

    <span class="comment">/**
     * Create an inner join to the specified {@link Map}-valued
     * attribute.
     * @param map  target of the join
     * @return the resulting join
     */</span>
    &lt;K, V&gt; MapJoin&lt;X, K, V&gt; join(MapAttribute&lt;? <span class="local-variable">super</span> X, K, V&gt; map);

    <span class="comment">/**
     * Create a join to the specified {@link Collection}-valued
     * attribute using the given join type.
     * @param collection  target of the join
     * @param jt  join type 
     * @return the resulting join
     */</span>
    &lt;Y&gt; CollectionJoin&lt;X, Y&gt; join(CollectionAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; collection, JoinType jt);

    <span class="comment">/**
     * Create a join to the specified {@link Set}-valued attribute
     * using the given join type.
     * @param set  target of the join
     * @param jt  join type 
     * @return the resulting join
     */</span>
    &lt;Y&gt; SetJoin&lt;X, Y&gt; join(SetAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; set, JoinType jt);

    <span class="comment">/**
     * Create a join to the specified {@link List}-valued attribute
     * using the given join type.
     * @param list  target of the join
     * @param jt  join type 
     * @return the resulting join
     */</span>
    &lt;Y&gt; ListJoin&lt;X, Y&gt; join(ListAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; list, JoinType jt);

    <span class="comment">/**
     * Create a join to the specified {@link Map}-valued attribute
     * using the given join type.
     * @param map  target of the join
     * @param jt  join type 
     * @return the resulting join
     */</span>
    &lt;K, V&gt; MapJoin&lt;X, K, V&gt; join(MapAttribute&lt;? <span class="local-variable">super</span> X, K, V&gt; map, JoinType jt);


    <span class="comment">//String-based:</span>

    <span class="comment">/**
     * Create an inner join to the specified attribute.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, Y&gt; Join&lt;X, Y&gt; join(<span class="predefined-type">String</span> attributeName);        

    <span class="comment">/**
     * Create an inner join to the specified {@link Collection}-valued
     * attribute.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, Y&gt; CollectionJoin&lt;X, Y&gt; joinCollection(<span class="predefined-type">String</span> attributeName);        

    <span class="comment">/**
     * Create an inner join to the specified {@link Set}-valued
     * attribute.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, Y&gt; SetJoin&lt;X, Y&gt; joinSet(<span class="predefined-type">String</span> attributeName);        

    <span class="comment">/**
     * Create an inner join to the specified {@link List}-valued
     * attribute.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, Y&gt; ListJoin&lt;X, Y&gt; joinList(<span class="predefined-type">String</span> attributeName);                
    
    <span class="comment">/**
     * Create an inner join to the specified {@link Map}-valued
     * attribute.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, K, V&gt; MapJoin&lt;X, K, V&gt; joinMap(<span class="predefined-type">String</span> attributeName);        

    <span class="comment">/**
     * Create a join to the specified attribute using the given
     * join type.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @param jt  join type
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, Y&gt; Join&lt;X, Y&gt; join(<span class="predefined-type">String</span> attributeName, JoinType jt);        
    
    <span class="comment">/**
     * Create a join to the specified {@link Collection}-valued
     * attribute using the given join type.
     * @param attributeName  name of the attribute for the 
     *                       target of the join
     * @param jt  join type
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, Y&gt; CollectionJoin&lt;X, Y&gt; joinCollection(<span class="predefined-type">String</span> attributeName, JoinType jt);        

    <span class="comment">/**
     * Create a join to the specified {@link Set}-valued attribute
     * using the given join type.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @param jt  join type
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, Y&gt; SetJoin&lt;X, Y&gt; joinSet(<span class="predefined-type">String</span> attributeName, JoinType jt);        

    <span class="comment">/**
     * Create a join to the specified {@link List}-valued attribute
     * using the given join type.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @param jt  join type
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *         name does not exist
     */</span>
    &lt;X, Y&gt; ListJoin&lt;X, Y&gt; joinList(<span class="predefined-type">String</span> attributeName, JoinType jt);        

    <span class="comment">/**
     * Create a join to the specified {@link Map}-valued attribute
     * using the given join type.
     * @param attributeName  name of the attribute for the
     *                       target of the join
     * @param jt  join type
     * @return the resulting join
     * @throws IllegalArgumentException if attribute of the given
     *        name does not exist
     */</span>
    &lt;X, K, V&gt; MapJoin&lt;X, K, V&gt; joinMap(<span class="predefined-type">String</span> attributeName, JoinType jt);        
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="join"><a class="anchor" href="#join"></a>C.14. <code>Join</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Attribute</span>;

<span class="comment">/**
 * A join to an entity, embeddable, or basic type.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;X&gt; the target type of the join
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Join</span>&lt;Z, X&gt; <span class="directive">extends</span> From&lt;Z, X&gt; {

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified join object
     * @since 2.1
     */</span>
    Join&lt;Z, X&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restrictions  zero or more restriction predicates
     * @return the modified join object
     * @since 2.1
     */</span>
    Join&lt;Z, X&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/** 
     * Return the predicate that corresponds to the ON 
     * restriction(s) on the join, or null if no ON condition 
     * has been specified.
     * @return the ON restriction predicate
     * @since 2.1
     */</span>
    <span class="predefined-type">Predicate</span> getOn();

    <span class="comment">/**
     * Return the metamodel attribute representing the join
     * target, if any, or null if the target of the join is an
     * entity type.
     * @return metamodel attribute or null
     */</span>
    <span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> Z, ?&gt; getAttribute();

    <span class="comment">/**
     * Return the parent of the join.
     * @return join parent
     */</span>
    From&lt;?, Z&gt; getParent();

    <span class="comment">/**
     * Return the join type.
     * @return join type
     */</span>
    JoinType getJoinType();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jointype"><a class="anchor" href="#jointype"></a>C.15. <code>JoinType</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Defines the three varieties of join.
 *
 * &lt;p&gt;Support for {@link #RIGHT} outer joins is not required. Applications
 * which make use of right joins might not be portable between providers or
 * between SQL databases.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> JoinType {

    <span class="comment">/**
     * Inner join.
     */</span>
    INNER, 

    <span class="comment">/**
     * Left outer join.
     */</span>
    LEFT, 

    <span class="comment">/**
     * Right outer join.
     */</span>
    RIGHT,
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listjoin"><a class="anchor" href="#listjoin"></a>C.16. <code>ListJoin</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.ListAttribute</span>;

<span class="comment">/**
 * The {@code ListJoin} interface is the type of the result of
 * joining to a collection over an association or element 
 * collection that has been specified as a {@link java.util.List}.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;E&gt; the element type of the target List
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ListJoin</span>&lt;Z, E&gt; 
                <span class="directive">extends</span> PluralJoin&lt;Z, <span class="predefined-type">List</span>&lt;E&gt;, E&gt; {

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified join object
     * @since 2.1
     */</span>
    ListJoin&lt;Z, E&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restrictions  zero or more restriction predicates
     * @return the modified join object
     * @since 2.1
     */</span>
    ListJoin&lt;Z, E&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Return the metamodel representation for the list attribute.
     * @return metamodel type representing the {@code List} that is
     *         the target of the join
     */</span>
    ListAttribute&lt;? <span class="local-variable">super</span> Z, E&gt; getModel();

    <span class="comment">/**
     * Create an expression that corresponds to the index of
     * the object in the referenced association or element
     * collection.
     * This method must only be invoked upon an object that
     * represents an association or element collection for
     * which an order column has been defined.
     * @return expression denoting the index
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; index();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="localdatefield"><a class="anchor" href="#localdatefield"></a>C.17. <code>LocalDateField</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.time.LocalDate</span>;

<span class="comment">/**
 * Each instance represents a type of field which can be
 * extracted from a {@link LocalDate}.
 *
 * @param &lt;N&gt; the resulting type of the extracted value
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LocalDateField</span>&lt;N&gt; <span class="directive">implements</span> TemporalField&lt;N, LocalDate&gt; {

        <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> name;

        <span class="directive">private</span> LocalDateField(<span class="predefined-type">String</span> name) {
                <span class="local-variable">this</span>.name = name;
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
                <span class="keyword">return</span> name;
        }

        <span class="comment">/**
         * The calendar year.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateField&lt;<span class="predefined-type">Integer</span>&gt; YEAR = <span class="keyword">new</span> LocalDateField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The calendar quarter, numbered from 1 to 4.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateField&lt;<span class="predefined-type">Integer</span>&gt; QUARTER = <span class="keyword">new</span> LocalDateField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">quarter</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The calendar month of the year, numbered from 1.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateField&lt;<span class="predefined-type">Integer</span>&gt; MONTH = <span class="keyword">new</span> LocalDateField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">month</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The ISO-8601 week number.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateField&lt;<span class="predefined-type">Integer</span>&gt; WEEK = <span class="keyword">new</span> LocalDateField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">week</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The calendar day of the month, numbered from 1.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateField&lt;<span class="predefined-type">Integer</span>&gt; DAY = <span class="keyword">new</span> LocalDateField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">day</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="localdatetimefield"><a class="anchor" href="#localdatetimefield"></a>C.18. <code>LocalDateTimeField</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.time.LocalDate</span>;
<span class="keyword">import</span> <span class="include">java.time.LocalDateTime</span>;
<span class="keyword">import</span> <span class="include">java.time.LocalTime</span>;

<span class="comment">/**
 * Each instance represents a type of field which can be
 * extracted from a {@link LocalDateTime}.
 *
 * @param &lt;N&gt; the resulting type of the extracted value
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LocalDateTimeField</span>&lt;N&gt; <span class="directive">implements</span> TemporalField&lt;N, LocalDateTime&gt; {

        <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> name;

        <span class="directive">private</span> LocalDateTimeField(<span class="predefined-type">String</span> name) {
                <span class="local-variable">this</span>.name = name;
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
                <span class="keyword">return</span> name;
        }

        <span class="comment">/**
         * The calendar year.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;<span class="predefined-type">Integer</span>&gt; YEAR = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The calendar quarter, numbered from 1 to 4.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;<span class="predefined-type">Integer</span>&gt; QUARTER = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">quarter</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The calendar month of the year, numbered from 1.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;<span class="predefined-type">Integer</span>&gt; MONTH = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">month</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The ISO-8601 week number.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;<span class="predefined-type">Integer</span>&gt; WEEK = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">week</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The calendar day of the month, numbered from 1.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;<span class="predefined-type">Integer</span>&gt; DAY = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">day</span><span class="delimiter">&quot;</span></span>);

        <span class="comment">/**
         * The hour of the day in 24-hour time, numbered from 0 to 23.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;<span class="predefined-type">Integer</span>&gt; HOUR = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">hour</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The minute of the hour, numbered from 0 to 59.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;<span class="predefined-type">Integer</span>&gt; MINUTE = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">minute</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The second of the minute, numbered from 0 to 59, including a fractional
         * part representing fractions of a second
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;<span class="predefined-type">Double</span>&gt; SECOND = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">second</span><span class="delimiter">&quot;</span></span>);

        <span class="comment">/**
         * The {@linkplain LocalDate date} part of a datetime.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;LocalDate&gt; DATE = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The {@linkplain LocalTime time} part of a datetime.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalDateTimeField&lt;LocalTime&gt; TIME = <span class="keyword">new</span> LocalDateTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">time</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="localtimefield"><a class="anchor" href="#localtimefield"></a>C.19. <code>LocalTimeField</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.time.LocalTime</span>;

<span class="comment">/**
 * Each instance represents a type of field which can be
 * extracted from a {@link LocalTime}.
 *
 * @param &lt;N&gt; the resulting type of the extracted value
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LocalTimeField</span>&lt;N&gt; <span class="directive">implements</span> TemporalField&lt;N, LocalTime&gt; {

        <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> name;

        <span class="directive">private</span> LocalTimeField(<span class="predefined-type">String</span> name) {
                <span class="local-variable">this</span>.name = name;
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
                <span class="keyword">return</span> name;
        }

        <span class="comment">/**
         * The hour of the day in 24-hour time, numbered from 0 to 23.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalTimeField&lt;<span class="predefined-type">Integer</span>&gt; HOUR = <span class="keyword">new</span> LocalTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">hour</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The minute of the hour, numbered from 0 to 59.
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalTimeField&lt;<span class="predefined-type">Integer</span>&gt; MINUTE = <span class="keyword">new</span> LocalTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">minute</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">/**
         * The second of the minute, numbered from 0 to 59, including a fractional
         * part representing fractions of a second
         */</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> LocalTimeField&lt;<span class="predefined-type">Double</span>&gt; SECOND = <span class="keyword">new</span> LocalTimeField&lt;&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">second</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mapjoin"><a class="anchor" href="#mapjoin"></a>C.20. <code>MapJoin</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.MapAttribute</span>;

<span class="comment">/**
 * The {@code MapJoin} interface is the type of the result of
 * joining to a collection over an association or element 
 * collection that has been specified as a {@link java.util.Map}.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;K&gt; the type of the target Map key
 * @param &lt;V&gt; the type of the target Map value
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MapJoin</span>&lt;Z, K, V&gt; 
                <span class="directive">extends</span> PluralJoin&lt;Z, <span class="predefined-type">Map</span>&lt;K, V&gt;, V&gt; {

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified join object
     * @since 2.1
     */</span>
    MapJoin&lt;Z, K, V&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restrictions  zero or more restriction predicates
     * @return the modified join object
     * @since 2.1
     */</span>
    MapJoin&lt;Z, K, V&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Return the metamodel representation for the map attribute.
     * @return metamodel type representing the {@code Map} that is
     *         the target of the join
     */</span>
    MapAttribute&lt;? <span class="local-variable">super</span> Z, K, V&gt; getModel();
    
    <span class="comment">/**
     * Create a path expression that corresponds to the map key.
     * @return path corresponding to map key
     */</span>
    Path&lt;K&gt; key();
    
    <span class="comment">/**
     * Create a path expression that corresponds to the map value.
     * This method is for stylistic use only: it just returns this.
     * @return path corresponding to the map value
     */</span>
    Path&lt;V&gt; value(); 
    
    <span class="comment">/**
     * Create an expression that corresponds to the map entry.
     * @return expression corresponding to the map entry
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Map</span>.Entry&lt;K, V&gt;&gt; entry();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="nulls"><a class="anchor" href="#nulls"></a>C.21. <code>Nulls</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Specifies the precedence of null values within query result sets.
 *
 * @see CriteriaBuilder#asc(Expression, Nulls)
 * @see CriteriaBuilder#desc(Expression, Nulls)
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">enum</span> Nulls {
        <span class="comment">/**
         * Null precedence not specified.
         */</span>
        NONE,
        <span class="comment">/**
         * Null values occur at the beginning of the result set.
         */</span>
        FIRST,
        <span class="comment">/**
         * Null values occur at the end of the result set.
         */</span>
        LAST
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="order"><a class="anchor" href="#order"></a>C.22. <code>Order</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * An object that defines an ordering over the query results.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Order</span> {

   <span class="comment">/**
    * Switch the ordering.
    * @return a new {@code Order} instance with the reversed ordering
    */</span>
    Order reverse();

   <span class="comment">/**
    * Whether ascending ordering is in effect.
    * @return boolean indicating whether ordering is ascending
    */</span>
    <span class="type">boolean</span> isAscending();

    <span class="comment">/**
     * Return the precedence of null values.
     * @return the {@linkplain Nulls precedence of null values}
     * @since 3.2
     */</span>
    Nulls getNullPrecedence();

   <span class="comment">/**
    * Return the expression that is used for ordering.
    * @return expression used for ordering
    */</span>
   <span class="predefined-type">Expression</span>&lt;?&gt; getExpression();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="parameterexpression"><a class="anchor" href="#parameterexpression"></a>C.23. <code>ParameterExpression</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.Parameter</span>;

<span class="comment">/**
 * Type of criteria query parameter expressions.
 *
 * @param &lt;T&gt; the type of the parameter expression
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ParameterExpression</span>&lt;T&gt; <span class="directive">extends</span> Parameter&lt;T&gt;, <span class="predefined-type">Expression</span>&lt;T&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="path"><a class="anchor" href="#path"></a>C.24. <code>Path</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.PluralAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Bindable</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.MapAttribute</span>;

<span class="comment">/**
 * Represents a simple or compound attribute path from a 
 * bound type or collection, and is a &quot;primitive&quot; expression.
 *
 * @param &lt;X&gt;  the type referenced by the path
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Path</span>&lt;X&gt; <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;X&gt; {

    <span class="comment">/** 
     * Return the bindable object that corresponds to the path
     * expression.
     * @return bindable object corresponding to the path
     */</span>
    Bindable&lt;X&gt; getModel(); 
    
    <span class="comment">/**
     * Return the parent &quot;node&quot; in the path or null if no parent.
     * @return parent
     */</span>
    Path&lt;?&gt; getParentPath();
        
    <span class="comment">/**
     * Create a path corresponding to the referenced
     * single-valued attribute.
     * @param attribute single-valued attribute
     * @return path corresponding to the referenced attribute
     */</span>
    &lt;Y&gt; Path&lt;Y&gt; get(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute);

    <span class="comment">/**
     * Create a path corresponding to the referenced 
     * collection-valued attribute.
     * @param collection collection-valued attribute
     * @return expression corresponding to the referenced attribute
     */</span>
    &lt;E, C <span class="directive">extends</span> java.util.Collection&lt;E&gt;&gt; <span class="predefined-type">Expression</span>&lt;C&gt; get(PluralAttribute&lt;? <span class="local-variable">super</span> X, C, E&gt; collection);

    <span class="comment">/**
     * Create a path corresponding to the referenced 
     * map-valued attribute.
     * @param map map-valued attribute
     * @return expression corresponding to the referenced attribute
     */</span>
    &lt;K, V, M <span class="directive">extends</span> java.util.Map&lt;K, V&gt;&gt; <span class="predefined-type">Expression</span>&lt;M&gt; get(MapAttribute&lt;? <span class="local-variable">super</span> X, K, V&gt; map);

    <span class="comment">/**
     * Create an expression corresponding to the type of the path.
     * @return expression corresponding to the type of the path
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt;&gt; type();


    <span class="comment">//String-based:</span>
        
    <span class="comment">/**
     * Create a path corresponding to the referenced attribute.
     * 
     * &lt;p&gt; Note: Applications using the string-based API may need to 
     * specify the type resulting from the {@link #get} operation in
     * order to avoid the use of {@code Path} variables.
     *
     * &lt;p&gt;For example:
     * {@snippet :
     * CriteriaQuery&lt;Person&gt; q = cb.createQuery(Person.class);
     * Root&lt;Person&gt; p = q.from(Person.class);
     * q.select(p)
     *  .where(cb.isMember(&quot;joe&quot;,
     *                     p.&lt;Set&lt;String&gt;&gt;get(&quot;nicknames&quot;)));
     * }
     * &lt;p&gt;rather than:
     * {@snippet :
     * CriteriaQuery&lt;Person&gt; q = cb.createQuery(Person.class);
     * Root&lt;Person&gt; p = q.from(Person.class);
     * Path&lt;Set&lt;String&gt;&gt; nicknames = p.get(&quot;nicknames&quot;);
     * q.select(p)
     *  .where(cb.isMember(&quot;joe&quot;, nicknames));
     * }
     *
     * @param attributeName  name of the attribute
     * @return path corresponding to the referenced attribute
     * @throws IllegalStateException if invoked on a path that
     *         corresponds to a basic type
     * @throws IllegalArgumentException if attribute of the given
     *         name does not otherwise exist
     */</span>
    &lt;Y&gt; Path&lt;Y&gt; get(<span class="predefined-type">String</span> attributeName);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pluraljoin"><a class="anchor" href="#pluraljoin"></a>C.25. <code>PluralJoin</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.PluralAttribute</span>;

<span class="comment">/**
 * The {@code PluralJoin} interface defines functionality
 * that is common to joins to all collection types.  It is
 * not intended to be used directly in query construction.
 *
 * @param &lt;Z&gt; the source type
 * @param &lt;C&gt; the collection type
 * @param &lt;E&gt; the element type of the collection 
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PluralJoin</span>&lt;Z, C, E&gt; <span class="directive">extends</span> Join&lt;Z, E&gt; {

    <span class="comment">/**
     * Return the metamodel representation for the collection-valued 
     * attribute corresponding to the join.
     * @return metamodel collection-valued attribute corresponding
     *         to the target of the join
     */</span>
    PluralAttribute&lt;? <span class="local-variable">super</span> Z, C, E&gt; getModel();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="predicate"><a class="anchor" href="#predicate"></a>C.26. <code>Predicate</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * The type of a simple or compound predicate: a conjunction or
 * disjunction of restrictions.
 * A simple predicate is considered to be a conjunction with a
 * single conjunct.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Predicate</span> <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; {

        <span class="type">enum</span> BooleanOperator {
              AND, OR
        }
        
    <span class="comment">/**
     * Return the boolean operator for the predicate.
     * If the predicate is simple, this is {@code AND}.
     * @return boolean operator for the predicate
     */</span>
    BooleanOperator getOperator();
    
    <span class="comment">/**
     * Whether the predicate has been created from another
     * predicate by applying {@link Predicate#not()}
     * or by calling {@link CriteriaBuilder#not}.
     * @return boolean indicating if the predicate is 
     *                 a negated predicate
     */</span>
    <span class="type">boolean</span> isNegated();

    <span class="comment">/**
     * Return the top-level conjuncts or disjuncts of the
     * predicate. Returns empty list if there are no top-level
     * conjuncts or disjuncts of the predicate.
     * Modifications to the list do not affect the query.
     * @return list of boolean expressions forming the predicate
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt;&gt; getExpressions();

    <span class="comment">/**
     * Create a negation of the predicate.
     * @return negated predicate 
     */</span>
    <span class="predefined-type">Predicate</span> not();

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="root"><a class="anchor" href="#root"></a>C.27. <code>Root</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="comment">/**
 * A root type in the from clause.
 * Query roots always reference entities.
 *
 * @param &lt;X&gt; the entity type referenced by the root
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Root</span>&lt;X&gt; <span class="directive">extends</span> From&lt;X, X&gt; {

    <span class="comment">/**
     * Return the metamodel entity corresponding to the root.
     * @return metamodel entity corresponding to the root
     */</span>
    EntityType&lt;X&gt; getModel();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="selection"><a class="anchor" href="#selection"></a>C.28. <code>Selection</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.TupleElement</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * The {@code Selection} interface defines an item that is to be
 * returned in a query result.
 *
 * @param &lt;X&gt; the type of the selection item
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Selection</span>&lt;X&gt; <span class="directive">extends</span> TupleElement&lt;X&gt; {

    <span class="comment">/**
     * Assigns an alias to the selection item.
     * Once assigned, an alias cannot be changed or reassigned.
     * Returns the same selection item.
     * @param name  alias
     * @return selection item 
     */</span>
    Selection&lt;X&gt; alias(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Whether the selection item is a compound selection.
     * @return boolean indicating whether the selection is a compound
     *         selection
     */</span>
    <span class="type">boolean</span> isCompoundSelection();

    <span class="comment">/**
     * Return the selection items composing a compound selection.
     * Modifications to the list do not affect the query.
     * @return list of selection items
     * @throws IllegalStateException if selection is not a 
     *         compound selection
     */</span>
    <span class="predefined-type">List</span>&lt;Selection&lt;?&gt;&gt; getCompoundSelectionItems();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setjoin"><a class="anchor" href="#setjoin"></a>C.29. <code>SetJoin</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SetAttribute</span>;

<span class="comment">/**
 * The {@code SetJoin} interface is the type of the result of
 * joining to a collection over an association or element 
 * collection that has been specified as a {@link java.util.Set}.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;E&gt; the element type of the target {@code Set}
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">SetJoin</span>&lt;Z, E&gt; <span class="directive">extends</span> PluralJoin&lt;Z, <span class="predefined-type">Set</span>&lt;E&gt;, E&gt; {

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified join object
     * @since 2.1
     */</span>
    SetJoin&lt;Z, E&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the join to restrict the result according to the
     * specified ON condition and return the join object.  
     * Replaces the previous ON condition, if any.
     * @param restrictions  zero or more restriction predicates
     * @return the modified join object
     * @since 2.1
     */</span>
    SetJoin&lt;Z, E&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Return the metamodel representation for the set attribute.
     * @return metamodel type representing the {@code Set} that is
     *         the target of the join
     */</span>
    SetAttribute&lt;? <span class="local-variable">super</span> Z, E&gt; getModel();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="subquery"><a class="anchor" href="#subquery"></a>C.30. <code>Subquery</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * The {@code Subquery} interface defines functionality that is
 * specific to subqueries.
 *
 * &lt;p&gt;A subquery has an expression as its selection item.
 *
 * @param &lt;T&gt; the type of the selection item.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Subquery</span>&lt;T&gt; <span class="directive">extends</span> AbstractQuery&lt;T&gt;, <span class="predefined-type">Expression</span>&lt;T&gt; {
        
    <span class="comment">/**
     * Specify the item that is to be returned as the subquery 
     * result.
     * Replaces the previously specified selection, if any.
     * @param expression  expression specifying the item that
     *        is to be returned as the subquery result
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; select(<span class="predefined-type">Expression</span>&lt;T&gt; expression);
        
    <span class="comment">/**
     * Modify the subquery to restrict the result according
     * to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param restriction  a simple or compound boolean expression
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the subquery to restrict the result according 
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param restrictions  zero or more restriction predicates
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Modify the query to restrict the query result according
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the
     * corresponding {@code AbstractQuery} method.
     * @param restrictions  a list of zero or more restriction predicates
     * @return the modified query
     * @since 3.2
     */</span>
    Subquery&lt;T&gt; where(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Predicate</span>&gt; restrictions);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the subquery results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously 
     * added grouping expressions are simply removed.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param grouping  zero or more grouping expressions
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; groupBy(<span class="predefined-type">Expression</span>&lt;?&gt;... grouping);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the subquery results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously 
     * added grouping expressions are simply removed.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param grouping  list of zero or more grouping expressions
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; groupBy(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;?&gt;&gt; grouping);

    <span class="comment">/**
     * Specify a restriction over the groups of the subquery.
     * Replaces the previous having restriction(s), if any.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param restriction  a simple or compound boolean expression
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; having(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Specify restrictions over the groups of the subquery
     * according the conjunction of the specified restriction 
     * predicates.
     * Replaces the previously added having restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param restrictions  zero or more restriction predicates
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; having(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify restrictions over the groups of the query
     * according the conjunction of the specified restriction
     * predicates.
     * Replaces the previously added having restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the
     * corresponding {@code AbstractQuery} method.
     * @param restrictions  a list of zero or more restriction predicates
     * @return the modified query
     * @since 3.2
     */</span>
    Subquery&lt;T&gt; having(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Predicate</span>&gt; restrictions);

    <span class="comment">/**
     * Specify whether duplicate query results are eliminated.
     * A true value will cause duplicates to be eliminated.
     * A false value will cause duplicates to be retained.
     * If distinct has not been specified, duplicate results must
     * be retained.
     * This method only overrides the return type of the 
     * corresponding {@code AbstractQuery} method.
     * @param distinct  boolean value specifying whether duplicate
     *        results must be eliminated from the subquery result or
     *        whether they must be retained
     * @return the modified subquery.
     */</span>
    Subquery&lt;T&gt; distinct(<span class="type">boolean</span> distinct);
        
    <span class="comment">/**
     * Create a subquery root correlated to a root of the 
     * enclosing query.
     * @param parentRoot  a root of the containing query
     * @return subquery root
     */</span>
    &lt;Y&gt; Root&lt;Y&gt; correlate(Root&lt;Y&gt; parentRoot);

    <span class="comment">/**
     * Create a subquery join object correlated to a join object
     * of the enclosing query.
     * @param parentJoin  join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, Y&gt; Join&lt;X, Y&gt; correlate(Join&lt;X, Y&gt; parentJoin);

    <span class="comment">/**
     * Create a subquery collection join object correlated to a 
     * collection join object of the enclosing query.
     * @param parentCollection  join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, Y&gt; CollectionJoin&lt;X, Y&gt; correlate(CollectionJoin&lt;X, Y&gt; parentCollection);

    <span class="comment">/**
     * Create a subquery set join object correlated to a set join
     * object of the enclosing query.
     * @param parentSet  join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, Y&gt; SetJoin&lt;X, Y&gt; correlate(SetJoin&lt;X, Y&gt; parentSet);

    <span class="comment">/**
     * Create a subquery list join object correlated to a list join
     * object of the enclosing query.
     * @param parentList join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, Y&gt; ListJoin&lt;X, Y&gt; correlate(ListJoin&lt;X, Y&gt; parentList);

    <span class="comment">/**
     * Create a subquery map join object correlated to a map join
     * object of the enclosing query.
     * @param parentMap join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, K, V&gt; MapJoin&lt;X, K, V&gt; correlate(MapJoin&lt;X, K, V&gt; parentMap);

    <span class="comment">/**
     * Return the query of which this is a subquery.
     * This must be a CriteriaQuery or a Subquery.
     * @return the enclosing query or subquery
     */</span>
    AbstractQuery&lt;?&gt; getParent();

    <span class="comment">/**
     * Return the query of which this is a subquery.
     * This may be a CriteriaQuery, CriteriaUpdate, CriteriaDelete,
     * or a Subquery.
     * @return the enclosing query or subquery
     * @since 2.1
     */</span>
    CommonAbstractCriteria getContainingQuery();
        
    <span class="comment">/**
     * Return the selection expression.
     * @return the item to be returned in the subquery result
     */</span>
    <span class="predefined-type">Expression</span>&lt;T&gt; getSelection();

    <span class="comment">/**
     * Return the correlated joins of the subquery.
     * Returns empty set if the subquery has no correlated
     * joins.
     * Modifications to the set do not affect the query.
     * @return the correlated joins of the subquery
     */</span>
    <span class="predefined-type">Set</span>&lt;Join&lt;?, ?&gt;&gt; getCorrelatedJoins();

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="temporalfield"><a class="anchor" href="#temporalfield"></a>C.31. <code>TemporalField</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.time.temporal.Temporal</span>;

<span class="comment">/**
 * Each instance represents a type of field which can be
 * extracted from a date, time, or datetime.
 *
 * @param &lt;N&gt; the resulting type of the extracted value
 * @param &lt;T&gt; the temporal type (date, time, or datetime)
 *
 * @see LocalDateField
 * @see LocalTimeField
 * @see LocalDateTimeField
 * @see CriteriaBuilder#extract(TemporalField, Expression)
 *
 * @since 3.2
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TemporalField</span>&lt;N,T <span class="directive">extends</span> Temporal&gt; {}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="metamodel-api"><a class="anchor" href="#metamodel-api"></a>Appendix D: Metamodel API Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following APIs are defined in the package <code>jakarta.persistence.metamodel</code>.</p>
</div>
<div class="sect2">
<h3 id="_metamodel_"><a class="anchor" href="#_metamodel_"></a>D.1. <code>Metamodel</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * Provides access to the metamodel of persistent entities in the
 * persistence unit.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Metamodel</span> {

    <span class="comment">/**
     * Return the metamodel entity type representing the entity.
     * @param entityName  the name of the represented entity
     * @return the metamodel entity type
     * @throws IllegalArgumentException if not an entity
     * @see jakarta.persistence.Entity#name
     * @since 3.2
     */</span>
    EntityType&lt;?&gt; entity(<span class="predefined-type">String</span> entityName);

    <span class="comment">/**
     * Return the metamodel entity type representing the entity.
     * @param cls  the type of the represented entity
     * @return the metamodel entity type
     * @throws IllegalArgumentException if not an entity
     */</span>
    &lt;X&gt; EntityType&lt;X&gt; entity(<span class="predefined-type">Class</span>&lt;X&gt; cls);

    <span class="comment">/**
     * Return the metamodel managed type representing the 
     * entity, mapped superclass, or embeddable class.
     * @param cls  the type of the represented managed class
     * @return the metamodel managed type
     * @throws IllegalArgumentException if not a managed class
     */</span>
    &lt;X&gt; ManagedType&lt;X&gt; managedType(<span class="predefined-type">Class</span>&lt;X&gt; cls);
    
    <span class="comment">/**
     * Return the metamodel embeddable type representing the
     * embeddable class.
     * @param cls  the type of the represented embeddable class
     * @return the metamodel embeddable type
     * @throws IllegalArgumentException if not an embeddable class
     */</span>
    &lt;X&gt; EmbeddableType&lt;X&gt; embeddable(<span class="predefined-type">Class</span>&lt;X&gt; cls);

    <span class="comment">/**
     * Return the metamodel managed types.
     * @return the metamodel managed types
     */</span>
    <span class="predefined-type">Set</span>&lt;ManagedType&lt;?&gt;&gt; getManagedTypes();

    <span class="comment">/**
     * Return the metamodel entity types.
     * @return the metamodel entity types
     */</span>
    <span class="predefined-type">Set</span>&lt;EntityType&lt;?&gt;&gt; getEntities();

    <span class="comment">/**
     * Return the metamodel embeddable types.
     * Returns am empty set if there are no embeddable types.
     * @return the metamodel embeddable types
     */</span>
    <span class="predefined-type">Set</span>&lt;EmbeddableType&lt;?&gt;&gt; getEmbeddables();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_staticmetamodel_"><a class="anchor" href="#_staticmetamodel_"></a>D.2. <code>StaticMetamodel</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="keyword">import</span> <span class="include">java.lang.annotation.ElementType</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Retention</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.RetentionPolicy</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Target</span>;

<span class="comment">/**
 * The {@code StaticMetamodel} annotation specifies that the class is
 * a metamodel class that represents the entity, mapped superclass,
 * or embeddable class designated by the {@link #value} element.
 *
 * @since 2.0
 */</span>
<span class="annotation">@Target</span>(<span class="predefined-type">ElementType</span>.TYPE)
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> StaticMetamodel {

    <span class="comment">/** 
     * Class being modelled by the annotated class.
     */</span>
    <span class="predefined-type">Class</span>&lt;?&gt; value();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="attribute"><a class="anchor" href="#attribute"></a>D.3. <code>Attribute</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Represents an attribute of a Java type.
 *
 * @param &lt;X&gt; The represented type that contains the attribute
 * @param &lt;Y&gt; The type of the represented attribute
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Attribute</span>&lt;X, Y&gt; {

        <span class="type">enum</span> PersistentAttributeType {
            
             <span class="comment">/** Many-to-one association */</span>
             MANY_TO_ONE, 

              <span class="comment">/** One-to-one association */</span>
             ONE_TO_ONE, 
             
             <span class="comment">/** Basic attribute */</span>
             BASIC, 

             <span class="comment">/** Embeddable class attribute */</span>
             EMBEDDED,

             <span class="comment">/** Many-to-many association */</span>
             MANY_TO_MANY, 

             <span class="comment">/** One-to-many association */</span>
             ONE_TO_MANY, 

             <span class="comment">/** Element collection */</span>
             ELEMENT_COLLECTION
        }

    <span class="comment">/**
     * Return the name of the attribute.
     * @return name
     */</span>
    <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     * Return the persistent attribute type for the attribute.
     * @return persistent attribute type
     */</span>
    PersistentAttributeType getPersistentAttributeType();

    <span class="comment">/**
     * Return the managed type representing the type in which 
     * the attribute was declared.
     * @return declaring type
     */</span>
    ManagedType&lt;X&gt; getDeclaringType();

    <span class="comment">/**
     * Return the Java type of the represented attribute.
     * @return Java type
     */</span>
    <span class="predefined-type">Class</span>&lt;Y&gt; getJavaType();

    <span class="comment">/**
     * Return the {@link java.lang.reflect.Member} for the
         *  represented attribute.
     * @return corresponding {@link java.lang.reflect.Member}
     */</span>
    java.lang.reflect.Member getJavaMember();

    <span class="comment">/**
     * Is the attribute an association.
     * @return boolean indicating whether the attribute 
     *         corresponds to an association
     */</span>
    <span class="type">boolean</span> isAssociation();

    <span class="comment">/**
     * Is the attribute collection-valued (represents a
         * {@code Collection}, {@code Set}, {@code List}, or
         * {@code Map}).
     * @return boolean indicating whether the attribute is 
     *         collection-valued
     */</span>
    <span class="type">boolean</span> isCollection();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="basictype"><a class="anchor" href="#basictype"></a>D.4. <code>BasicType</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * An instance of {@code BasicType} represents a
 * {@linkplain jakarta.persistence.Basic basic type}
 * (possibly an {@linkplain jakarta.persistence.Enumerated
 * enumerated}, {@linkplain jakarta.persistence.Lob LOB}, or
 * {@linkplain jakarta.persistence.Temporal temporal} type).
 *
 * @param &lt;X&gt; The represented basic type
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BasicType</span>&lt;X&gt; <span class="directive">extends</span> <span class="predefined-type">Type</span>&lt;X&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bindable"><a class="anchor" href="#bindable"></a>D.5. <code>Bindable</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.Path</span>;

<span class="comment">/**
 * An instances of the type {@code Bindable} represents an object
 * or attribute type that can be bound into a {@link Path Path}.
 *
 * @param &lt;T&gt; The type of the represented object or attribute
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Bindable</span>&lt;T&gt; {
    
    <span class="type">enum</span> BindableType {
        <span class="comment">/**
         * Single-valued attribute type.
         *
         * @see SingularAttribute
         */</span>
        SINGULAR_ATTRIBUTE, 

        <span class="comment">/**
         * Multivalued attribute type, that is, a collection.
         *
         * @see PluralAttribute
         */</span>
        PLURAL_ATTRIBUTE, 

        <span class="comment">/**
         * Entity type.
         *
         * @see EntityType
         */</span>
        ENTITY_TYPE
    }

    <span class="comment">/**
     * Return the bindable type of the represented object.
     * @return bindable type
     */</span>        
    BindableType getBindableType();

    <span class="comment">/**
     * Return the Java type of the represented object.
     * If the bindable type of the object is {@code PLURAL_ATTRIBUTE},
     * the Java element type is returned. If the bindable type is
     * {@code SINGULAR_ATTRIBUTE} or {@code ENTITY_TYPE}, 
     * the Java type of the
     * represented entity or attribute is returned.
     * @return Java type
     */</span>
    <span class="predefined-type">Class</span>&lt;T&gt; getBindableJavaType();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="collectionattribute"><a class="anchor" href="#collectionattribute"></a>D.6. <code>CollectionAttribute</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Instances of the type {@code CollectionAttribute} represent
 * persistent {@link java.util.Collection}-valued attributes.
 *
 * @param &lt;X&gt; The type the represented Collection belongs to
 * @param &lt;E&gt; The element type of the represented Collection
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CollectionAttribute</span>&lt;X, E&gt; 
        <span class="directive">extends</span> PluralAttribute&lt;X, java.util.Collection&lt;E&gt;, E&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="embeddabletype"><a class="anchor" href="#embeddabletype"></a>D.7. <code>EmbeddableType</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * An instance of {@code EmbeddableType} represents an
 * {@linkplain jakarta.persistence.Embeddable embeddable}
 * type.
 *
 * @param &lt;X&gt; The represented embeddable type.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EmbeddableType</span>&lt;X&gt; <span class="directive">extends</span> ManagedType&lt;X&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="entitytype"><a class="anchor" href="#entitytype"></a>D.8. <code>EntityType</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * An instance of {@code EntityType} represents
 * an {@linkplain jakarta.persistence.Entity entity}
 * type.
 *
 * @param &lt;X&gt; The represented entity type.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityType</span>&lt;X&gt; 
            <span class="directive">extends</span> IdentifiableType&lt;X&gt;, Bindable&lt;X&gt;{

    <span class="comment">/**
     * Return the entity name.
     * @return entity name
     */</span>
    <span class="predefined-type">String</span> getName();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="identifiabletype"><a class="anchor" href="#identifiabletype"></a>D.9. <code>IdentifiableType</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * An instance of the type {@code IdentifiableType} represents an
 * entity or mapped superclass type.
 *
 * @param &lt;X&gt; The represented entity or mapped superclass type.
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">IdentifiableType</span>&lt;X&gt; <span class="directive">extends</span> ManagedType&lt;X&gt; {
        
    <span class="comment">/**
     * Return the attribute that corresponds to the id attribute of 
     * the entity or mapped superclass.
     * @param type  the type of the represented id attribute
     * @return id attribute
     * @throws IllegalArgumentException if id attribute of the given
     *         type is not present in the identifiable type or if
     *         the identifiable type has an id class
     */</span>
    &lt;Y&gt; SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; getId(<span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     * Return the attribute that corresponds to the id attribute 
     * declared by the entity or mapped superclass.
     * @param type  the type of the represented declared 
     *              id attribute
     * @return declared id attribute
     * @throws IllegalArgumentException if id attribute of the given
     *         type is not declared in the identifiable type or if
     *         the identifiable type has an id class
     */</span>
    &lt;Y&gt; SingularAttribute&lt;X, Y&gt; getDeclaredId(<span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     * Return the attribute that corresponds to the version 
     * attribute of the entity or mapped superclass.
     * @param type  the type of the represented version attribute
     * @return version attribute
     * @throws IllegalArgumentException if version attribute of the 
     *                 given type is not present in the identifiable type
     */</span>
    &lt;Y&gt; SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; getVersion(<span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     * Return the attribute that corresponds to the version 
     * attribute declared by the entity or mapped superclass.
     * @param type  the type of the represented declared version 
     *              attribute
     * @return declared version attribute
     * @throws IllegalArgumentException if version attribute of the 
     *         type is not declared in the identifiable type
     */</span>
    &lt;Y&gt; SingularAttribute&lt;X, Y&gt; getDeclaredVersion(<span class="predefined-type">Class</span>&lt;Y&gt; type);
        
    <span class="comment">/**
     * Return the identifiable type that corresponds to the most
     * specific mapped superclass or entity extended by the entity 
     * or mapped superclass. 
     * @return supertype of identifiable type or null if no 
     *         such supertype
     */</span>
    IdentifiableType&lt;? <span class="local-variable">super</span> X&gt; getSupertype();

    <span class="comment">/**
     * Whether the identifiable type has a single id attribute.
     * Returns true for a simple id or embedded id; returns false
     * for an idclass.
     * @return boolean indicating whether the identifiable
     *         type has a single id attribute
     */</span>
    <span class="type">boolean</span> hasSingleIdAttribute();

    <span class="comment">/**
     * Whether the identifiable type has a version attribute.
     * @return boolean indicating whether the identifiable
     *         type has a version attribute
     */</span>
    <span class="type">boolean</span> hasVersionAttribute();

    <span class="comment">/**
     *  Return the attributes corresponding to the id class of the
     *  identifiable type.
     *  @return id attributes
     *  @throws IllegalArgumentException if the identifiable type
     *          does not have an id class
     */</span>
     <span class="predefined-type">Set</span>&lt;SingularAttribute&lt;? <span class="local-variable">super</span> X, ?&gt;&gt; getIdClassAttributes();

    <span class="comment">/**
     * Return the type that represents the type of the id.
     * @return type of id
     */</span>
    <span class="predefined-type">Type</span>&lt;?&gt; getIdType();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listattribute"><a class="anchor" href="#listattribute"></a>D.10. <code>ListAttribute</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Instances of the type {@code ListAttribute} represent persistent 
 * {@link java.util.List}-valued attributes.
 *
 * @param &lt;X&gt; The type the represented List belongs to
 * @param &lt;E&gt; The element type of the represented List
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ListAttribute</span>&lt;X, E&gt; 
                <span class="directive">extends</span> PluralAttribute&lt;X, java.util.List&lt;E&gt;, E&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="managedtype"><a class="anchor" href="#managedtype"></a>D.11. <code>ManagedType</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 *  Instances of the type {@code ManagedType} represent entity, mapped 
 *  superclass, and embeddable types.
 *
 *  @param &lt;X&gt; The represented type.
 *
 *  @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ManagedType</span>&lt;X&gt; <span class="directive">extends</span> <span class="predefined-type">Type</span>&lt;X&gt; {

    <span class="comment">/**
     * Return the attributes of the managed type.
     * @return attributes of the managed type
     */</span>
     <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> X, ?&gt;&gt; getAttributes();

    <span class="comment">/**
     * Return the attributes declared by the managed type.
     * Returns empty set if the managed type has no declared
     * attributes.
     * @return declared attributes of the managed type
     */</span>
     <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Attribute</span>&lt;X, ?&gt;&gt; getDeclaredAttributes();

    <span class="comment">/**
     * Return the single-valued attribute of the managed 
     * type that corresponds to the specified name and Java type.
     * @param name  the name of the represented attribute
     * @param type  the type of the represented attribute
     * @return single-valued attribute with given name and type
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not present in the managed type
     */</span>
    &lt;Y&gt; SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; getSingularAttribute(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     * Return the single-valued attribute declared by the 
     * managed type that corresponds to the specified name and 
     * Java type.
     * @param name  the name of the represented attribute
     * @param type  the type of the represented attribute
     * @return declared single-valued attribute of the given 
     *         name and type
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not declared in the managed type
     */</span>
    &lt;Y&gt; SingularAttribute&lt;X, Y&gt; getDeclaredSingularAttribute(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     * Return the single-valued attributes of the managed type.
     * Returns empty set if the managed type has no single-valued
     * attributes.
     * @return single-valued attributes
     */</span>
    <span class="predefined-type">Set</span>&lt;SingularAttribute&lt;? <span class="local-variable">super</span> X, ?&gt;&gt; getSingularAttributes();

    <span class="comment">/**
     * Return the single-valued attributes declared by the managed
     * type.
     * Returns empty set if the managed type has no declared
     * single-valued attributes.
     * @return declared single-valued attributes
     */</span>
    <span class="predefined-type">Set</span>&lt;SingularAttribute&lt;X, ?&gt;&gt; getDeclaredSingularAttributes();

    <span class="comment">/**
     * Return the Collection-valued attribute of the managed type 
     * that corresponds to the specified name and Java element type.
     * @param name  the name of the represented attribute
     * @param elementType  the element type of the represented 
     *                     attribute
     * @return CollectionAttribute of the given name and element
     *         type
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not present in the managed type
     */</span>    
    &lt;E&gt; CollectionAttribute&lt;? <span class="local-variable">super</span> X, E&gt; getCollection(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     * Return the Collection-valued attribute declared by the 
     * managed type that corresponds to the specified name and Java 
     * element type.
     * @param name  the name of the represented attribute
     * @param elementType  the element type of the represented 
     *                     attribute
     * @return declared {@code CollectionAttribute} of the given name and 
     *         element type
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not declared in the managed type
     */</span>
    &lt;E&gt; CollectionAttribute&lt;X, E&gt; getDeclaredCollection(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     * Return the Set-valued attribute of the managed type that
     * corresponds to the specified name and Java element type.
     * @param name  the name of the represented attribute
     * @param elementType  the element type of the represented 
     *                     attribute
     * @return SetAttribute of the given name and element type
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not present in the managed type
     */</span>
    &lt;E&gt; SetAttribute&lt;? <span class="local-variable">super</span> X, E&gt; getSet(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     * Return the Set-valued attribute declared by the managed type 
     * that corresponds to the specified name and Java element type.
     * @param name  the name of the represented attribute
     * @param elementType  the element type of the represented 
     *                     attribute
     * @return declared SetAttribute of the given name and 
     *         element type
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not declared in the managed type
     */</span>
    &lt;E&gt; SetAttribute&lt;X, E&gt; getDeclaredSet(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     * Return the List-valued attribute of the managed type that
     * corresponds to the specified name and Java element type.
     * @param name  the name of the represented attribute
     * @param elementType  the element type of the represented 
     *                     attribute
     * @return ListAttribute of the given name and element type
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not present in the managed type
     */</span>
    &lt;E&gt; ListAttribute&lt;? <span class="local-variable">super</span> X, E&gt; getList(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     * Return the List-valued attribute declared by the managed 
     * type that corresponds to the specified name and Java 
     * element type.
     * @param name  the name of the represented attribute
     * @param elementType  the element type of the represented 
     *                     attribute
     * @return declared ListAttribute of the given name and 
     *         element type
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not declared in the managed type
     */</span>
    &lt;E&gt; ListAttribute&lt;X, E&gt; getDeclaredList(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     * Return the Map-valued attribute of the managed type that
     * corresponds to the specified name and Java key and value
     * types.
     * @param name  the name of the represented attribute
     * @param keyType  the key type of the represented attribute
     * @param valueType  the value type of the represented attribute
     * @return MapAttribute of the given name and key and value
     * types
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not present in the managed type
     */</span>
    &lt;K, V&gt; MapAttribute&lt;? <span class="local-variable">super</span> X, K, V&gt; getMap(<span class="predefined-type">String</span> name, 
                                                <span class="predefined-type">Class</span>&lt;K&gt; keyType, 
                                                <span class="predefined-type">Class</span>&lt;V&gt; valueType);

    <span class="comment">/**
     * Return the Map-valued attribute declared by the managed 
     * type that corresponds to the specified name and Java key 
     * and value types.
     * @param name  the name of the represented attribute
     * @param keyType  the key type of the represented attribute
     * @param valueType  the value type of the represented attribute
     * @return declared MapAttribute of the given name and key 
     *         and value types
     * @throws IllegalArgumentException if attribute of the given
     *         name and type is not declared in the managed type
     */</span>
    &lt;K, V&gt; MapAttribute&lt;X, K, V&gt; getDeclaredMap(<span class="predefined-type">String</span> name, 
                                                <span class="predefined-type">Class</span>&lt;K&gt; keyType, 
                                                <span class="predefined-type">Class</span>&lt;V&gt; valueType);
    
    <span class="comment">/**
     * Return all multi-valued attributes (Collection-, Set-,
     * List-, and Map-valued attributes) of the managed type.
     * Returns empty set if the managed type has no multi-valued
     * attributes.
     * @return Collection-, Set-, List-, and Map-valued attributes
     */</span>
    <span class="predefined-type">Set</span>&lt;PluralAttribute&lt;? <span class="local-variable">super</span> X, ?, ?&gt;&gt; getPluralAttributes();

    <span class="comment">/**
     * Return all multi-valued attributes (Collection-, Set-,
     * List-, and Map-valued attributes) declared by the 
     * managed type.
     * Returns empty set if the managed type has no declared
     * multivalued attributes.
     * @return declared Collection-, Set-, List-, and Map-valued
     *         attributes
     */</span>
    <span class="predefined-type">Set</span>&lt;PluralAttribute&lt;X, ?, ?&gt;&gt; getDeclaredPluralAttributes();


<span class="comment">//String-based:</span>

    <span class="comment">/**
     * Return the attribute of the managed
     * type that corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return attribute with given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not present in the managed type
     */</span>
    <span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> X, ?&gt; getAttribute(<span class="predefined-type">String</span> name); 

    <span class="comment">/**
     * Return the attribute declared by the managed
     * type that corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return attribute with given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not declared in the managed type
     */</span>
    <span class="predefined-type">Attribute</span>&lt;X, ?&gt; getDeclaredAttribute(<span class="predefined-type">String</span> name); 

    <span class="comment">/**
     * Return the single-valued attribute of the managed type that
     * corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return single-valued attribute with the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not present in the managed type
     */</span>
    SingularAttribute&lt;? <span class="local-variable">super</span> X, ?&gt; getSingularAttribute(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Return the single-valued attribute declared by the managed
     * type that corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return declared single-valued attribute of the given 
     *         name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not declared in the managed type
     */</span>
    SingularAttribute&lt;X, ?&gt; getDeclaredSingularAttribute(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Return the Collection-valued attribute of the managed type 
     * that corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return CollectionAttribute of the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not present in the managed type
     */</span>    
    CollectionAttribute&lt;? <span class="local-variable">super</span> X, ?&gt; getCollection(<span class="predefined-type">String</span> name); 

    <span class="comment">/**
     * Return the Collection-valued attribute declared by the 
     * managed type that corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return declared CollectionAttribute of the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not declared in the managed type
     */</span>
    CollectionAttribute&lt;X, ?&gt; getDeclaredCollection(<span class="predefined-type">String</span> name); 

    <span class="comment">/**
     * Return the Set-valued attribute of the managed type that
     * corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return SetAttribute of the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not present in the managed type
     */</span>
    SetAttribute&lt;? <span class="local-variable">super</span> X, ?&gt; getSet(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Return the Set-valued attribute declared by the managed type 
     * that corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return declared SetAttribute of the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not declared in the managed type
     */</span>
    SetAttribute&lt;X, ?&gt; getDeclaredSet(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Return the List-valued attribute of the managed type that
     * corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return ListAttribute of the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not present in the managed type
     */</span>
    ListAttribute&lt;? <span class="local-variable">super</span> X, ?&gt; getList(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Return the List-valued attribute declared by the managed 
     * type that corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return declared ListAttribute of the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not declared in the managed type
     */</span>
    ListAttribute&lt;X, ?&gt; getDeclaredList(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Return the Map-valued attribute of the managed type that
     * corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return MapAttribute of the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not present in the managed type
     */</span>
    MapAttribute&lt;? <span class="local-variable">super</span> X, ?, ?&gt; getMap(<span class="predefined-type">String</span> name); 

    <span class="comment">/**
     * Return the Map-valued attribute declared by the managed 
     * type that corresponds to the specified name.
     * @param name  the name of the represented attribute
     * @return declared MapAttribute of the given name
     * @throws IllegalArgumentException if attribute of the given
     *         name is not declared in the managed type
     */</span>
    MapAttribute&lt;X, ?, ?&gt; getDeclaredMap(<span class="predefined-type">String</span> name);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mapattribute"><a class="anchor" href="#mapattribute"></a>D.12. <code>MapAttribute</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Instances of the type {@code MapAttribute} represent
 * persistent {@link java.util.Map}-valued attributes.
 *
 * @param &lt;X&gt; The type the represented Map belongs to
 * @param &lt;K&gt; The type of the key of the represented Map
 * @param &lt;V&gt; The type of the value of the represented Map
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MapAttribute</span>&lt;X, K, V&gt; 
        <span class="directive">extends</span> PluralAttribute&lt;X, java.util.Map&lt;K, V&gt;, V&gt; {

    <span class="comment">/**
     * Return the Java type of the map key.
     * @return Java key type
     */</span>
    <span class="predefined-type">Class</span>&lt;K&gt; getKeyJavaType();

    <span class="comment">/**
     * Return the type representing the key type of the map.
     * @return type representing key type
     */</span>
    <span class="predefined-type">Type</span>&lt;K&gt; getKeyType();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mappedsuperclasstype"><a class="anchor" href="#mappedsuperclasstype"></a>D.13. <code>MappedSuperclassType</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * An instance of the type {@code MappedSuperclassType} represents a
 * {@linkplain jakarta.persistence.MappedSuperclass mapped superclass}
 * type.
 *
 * @param &lt;X&gt; The represented mapped superclass type
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MappedSuperclassType</span>&lt;X&gt; <span class="directive">extends</span> IdentifiableType&lt;X&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pluralattribute"><a class="anchor" href="#pluralattribute"></a>D.14. <code>PluralAttribute</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Instances of the type {@code PluralAttribute} represent 
 * persistent collection-valued attributes.
 *
 * @param &lt;X&gt; The type the represented collection belongs to
 * @param &lt;C&gt; The type of the represented collection
 * @param &lt;E&gt; The element type of the represented collection
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PluralAttribute</span>&lt;X, C, E&gt; 
                <span class="directive">extends</span> <span class="predefined-type">Attribute</span>&lt;X, C&gt;, Bindable&lt;E&gt; {
        
        <span class="type">enum</span> CollectionType {

            <span class="comment">/** Collection-valued attribute */</span>
            COLLECTION, 

            <span class="comment">/** Set-valued attribute */</span>
            SET, 

            <span class="comment">/** List-valued attribute */</span>
            LIST, 

            <span class="comment">/** Map-valued attribute */</span>
            MAP
        }
                
    <span class="comment">/**
     * Return the collection type.
     * @return collection type
     */</span>
    CollectionType getCollectionType();

    <span class="comment">/**
     * Return the type representing the element type of the 
     * collection.
     * @return element type
     */</span>
    <span class="predefined-type">Type</span>&lt;E&gt; getElementType();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setattribute"><a class="anchor" href="#setattribute"></a>D.15. <code>SetAttribute</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Instances of the type {@code SetAttribute} represent
 * persistent {@link java.util.Set}-valued attributes.
 *
 * @param &lt;X&gt; The type the represented Set belongs to
 * @param &lt;E&gt; The element type of the represented Set
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">SetAttribute</span>&lt;X, E&gt; 
        <span class="directive">extends</span> PluralAttribute&lt;X, java.util.Set&lt;E&gt;, E&gt; {} </code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="singularattribute"><a class="anchor" href="#singularattribute"></a>D.16. <code>SingularAttribute</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type {@code SingularAttribute} represents persistent
 * single-valued properties or fields.
 *
 * @param &lt;X&gt; The type containing the represented attribute
 * @param &lt;T&gt; The type of the represented attribute
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">SingularAttribute</span>&lt;X, T&gt; 
                <span class="directive">extends</span> <span class="predefined-type">Attribute</span>&lt;X, T&gt;, Bindable&lt;T&gt; {
        
    <span class="comment">/**
     * Is the attribute an id attribute? This method returns true
     * if the attribute is a {@linkplain jakarta.persistence.Id simple
     * id}, an {@linkplain jakarta.persistence.EmbeddedId embedded id},
     * or an attribute of an {@linkplain jakarta.persistence.IdClass
     * id class}.
     * @return boolean indicating whether the attribute is an id
     */</span>
    <span class="type">boolean</span> isId();

    <span class="comment">/**
     * Is the attribute a {@linkplain jakarta.persistence.Version
     * version} attribute?
     * @return boolean indicating whether the attribute is a
     *         version attribute
     */</span>
    <span class="type">boolean</span> isVersion();

    <span class="comment">/** 
     * Can the attribute be null?
     * @return boolean indicating whether the attribute can
     *        be null
     * @see jakarta.persistence.Basic#optional
     */</span>
    <span class="type">boolean</span> isOptional();

    <span class="comment">/**
     * Return the type that represents the type of the attribute.
     * @return type of attribute
     */</span>
    <span class="predefined-type">Type</span>&lt;T&gt; getType();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type"><a class="anchor" href="#type"></a>D.17. <code>Type</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * An instance of the type {@code Type} represents a persistent
 * object or attribute type.
 *
 * @param &lt;X&gt;  The type of the represented object or attribute
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Type</span>&lt;X&gt; {

    <span class="type">enum</span> PersistenceType {

        <span class="comment">/** Entity class */</span>
        ENTITY,

        <span class="comment">/** Embeddable class */</span>
        EMBEDDABLE,

        <span class="comment">/** Mapped superclass */</span>
        MAPPED_SUPERCLASS,

        <span class="comment">/** Basic type */</span>
        BASIC
    }

    <span class="comment">/**
     * Return the persistence type.
     * @return persistence type
     */</span>        
    PersistenceType getPersistenceType();

    <span class="comment">/**
     * Return the represented Java type.
     * @return Java type
     */</span>
    <span class="predefined-type">Class</span>&lt;X&gt; getJavaType();
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="persistence-spi"><a class="anchor" href="#persistence-spi"></a>Appendix E: Persistence SPI Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following APIs are defined in the package <code>jakarta.persistence.spi</code>.</p>
</div>
<div class="sect2">
<h3 id="_classtransformer_"><a class="anchor" href="#_classtransformer_"></a>E.1. <code>ClassTransformer</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.security.ProtectionDomain</span>;

<span class="comment">/**
 * A persistence provider supplies an instance of this 
 * interface to the {@link PersistenceUnitInfo#addTransformer}
 * method. The supplied transformer instance will get 
 * called to transform entity class files when they are 
 * loaded or redefined. The transformation occurs before  
 * the class is defined by the JVM.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ClassTransformer</span> {

    <span class="comment">/**
     * Invoked when a class is being loaded or redefined.
     * The implementation of this method may transform the 
     * supplied class file and return a new replacement class 
     * file.
     *
     * @param loader  the defining loader of the class to be 
     *        transformed, may be null if the bootstrap loader
     * @param className  the name of the class in the internal form 
     *        of fully qualified class and interface names
     * @param classBeingRedefined  if this is a redefine, the 
     *        class being redefined, otherwise null
     * @param protectionDomain  the protection domain of the 
     *        class being defined or redefined
     * @param classfileBuffer  the input byte buffer in class 
     *        file format - must not be modified
     * @return a well-formed class file buffer (the result of 
     *         the transform), or null if no transform is performed
     * @throws TransformerException  if the input does
     *         not represent a well-formed class file
     */</span>
    <span class="type">byte</span><span class="type">[]</span> transform(<span class="predefined-type">ClassLoader</span> loader,
                     <span class="predefined-type">String</span> className,
                     <span class="predefined-type">Class</span>&lt;?&gt; classBeingRedefined,
                     <span class="predefined-type">ProtectionDomain</span> protectionDomain, 
                     <span class="type">byte</span><span class="type">[]</span> classfileBuffer) 
        <span class="directive">throws</span> <span class="exception">TransformerException</span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="loadstate"><a class="anchor" href="#loadstate"></a>E.2. <code>LoadState</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Load states returned by the {@link ProviderUtil} SPI methods.
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">enum</span> LoadState {
    <span class="comment">/** The state of the element is known to have been loaded. */</span>
    LOADED,
    <span class="comment">/** The state of the element is known not to have been loaded. */</span>
    NOT_LOADED,
    <span class="comment">/** The load state of the element cannot be determined. */</span>
    UNKNOWN
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_persistenceprovider_"><a class="anchor" href="#_persistenceprovider_"></a>E.3. <code>PersistenceProvider</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.EntityManagerFactory</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.Persistence</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.PersistenceConfiguration</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.PersistenceException</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;

<span class="comment">/**
 * Interface implemented by the persistence provider.
 *
 * &lt;p&gt; It is invoked by the container in Jakarta EE environments and
 * by the {@link Persistence} class in Java SE environments to create
 * an {@link EntityManagerFactory} and/or to cause schema generation
 * to occur.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceProvider</span> {

    <span class="comment">/**
     * Called by {@link Persistence} class when an
     * {@link EntityManagerFactory} is to be created.
     *
     * @param emName  the name of the persistence unit
     * @param map  a Map of properties for use by the 
     * persistence provider. These properties may be used to
     * override the values of the corresponding elements in 
     * the {@code persistence.xml} file or specify values for
     * properties not specified in the {@code persistence.xml}
     * (and may be null if no properties are specified).
     * @return EntityManagerFactory for the persistence unit, 
     * or null if the provider is not the right provider
     *
     * @see Persistence#createEntityManagerFactory(String, Map)
     */</span>
    EntityManagerFactory createEntityManagerFactory(<span class="predefined-type">String</span> emName, <span class="predefined-type">Map</span>&lt;?, ?&gt; map);

    <span class="comment">/**
     * Called by {@link Persistence} class when an
     * {@link EntityManagerFactory} is to be created.
     *
     * @param configuration  the configuration of the persistence unit
     * @return EntityManagerFactory for the persistence unit,
     * or null if the provider is not the right provider
     * @throws IllegalStateException if required configuration is missing
     *
     * @see Persistence#createEntityManagerFactory(PersistenceConfiguration)
     *
     * @since 3.2
     */</span>
    EntityManagerFactory createEntityManagerFactory(PersistenceConfiguration configuration);

    <span class="comment">/**
     * Called by the container when an {@link EntityManagerFactory}
     * is to be created. 
     *
     * @param info  metadata for use by the persistence provider
     * @param map  a Map of integration-level properties for use 
     * by the persistence provider (may be null if no properties
     * are specified). These properties may include properties to
     * control schema generation. If a Bean Validation provider is
     * present in the classpath, the container must pass the
     * {@code ValidatorFactory} instance in the map with the key
     * {@code &quot;jakarta.persistence.validation.factory&quot;}. If the
     * containing archive is a bean archive, the container must
     * pass the {@code BeanManager} instance in the map with the
     * key {@code &quot;jakarta.persistence.bean.manager&quot;}.
     * @return {@link EntityManagerFactory} for the persistence unit
     * specified by the metadata
     */</span>
    EntityManagerFactory createContainerEntityManagerFactory(PersistenceUnitInfo info, <span class="predefined-type">Map</span>&lt;?, ?&gt; map);


    <span class="comment">/**
     * Create database schemas and/or tables and/or create DDL
     * scripts as determined by the supplied properties.
     * &lt;p&gt;
     * Called by the container when schema generation is to
     * occur as a separate phase from creation of the entity
     * manager factory.
     * &lt;p&gt;
     * @param info metadata for use by the persistence provider
     * @param map properties for schema generation;  these may
     *            also include provider-specific properties
     * @throws PersistenceException if insufficient or inconsistent
     *         configuration information is provided of if schema
     *         generation otherwise fails
     *
     * @since 2.1
     */</span>
    <span class="type">void</span> generateSchema(PersistenceUnitInfo info, <span class="predefined-type">Map</span>&lt;?, ?&gt; map);

    <span class="comment">/**
     * Create database schemas and/or tables and/or create DDL
     * scripts as determined by the supplied properties.
     * &lt;p&gt;
     * Called by the {@link Persistence} class when schema generation
     * is to occur as a separate phase from creation of the entity
     * manager factory.
     * &lt;p&gt;
     * @param persistenceUnitName the name of the persistence unit
     * @param map properties for schema generation;  these may
     *            also contain provider-specific properties.  The
     *            value of these properties override any values that
     *            may have been configured elsewhere.
     * @return true  if schema was generated, otherwise false
     * @throws PersistenceException if insufficient or inconsistent
     *         configuration information is provided or if schema
     *         generation otherwise fails
     *
     * @since 2.1
     */</span>
    <span class="type">boolean</span> generateSchema(<span class="predefined-type">String</span> persistenceUnitName, <span class="predefined-type">Map</span>&lt;?, ?&gt; map);

    <span class="comment">/**
     * Return the utility interface implemented by the persistence
     * provider.
     * @return an instance of {@link ProviderUtil}
     *
     * @since 2.0
     */</span>
    ProviderUtil getProviderUtil();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="persistenceproviderresolver"><a class="anchor" href="#persistenceproviderresolver"></a>E.4. <code>PersistenceProviderResolver</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * Provides a list of {@linkplain PersistenceProvider persistence
 * providers} available in the runtime environment.
 * 
 * &lt;p&gt; Implementations must be thread-safe.
 *
 * &lt;p&gt; Note that the {@link #getPersistenceProviders} method can
 * potentially be called many times: it is recommended that the
 * implementation of this method make use of caching.
 *
 * @see PersistenceProvider
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceProviderResolver</span> {

    <span class="comment">/**
     * Returns a list of the {@linkplain PersistenceProvider
     * persistence provider} implementations available in the
     * runtime environment.
     *
     * @return list of the persistence providers available 
     *         in the environment
     */</span>
    <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; getPersistenceProviders();

    <span class="comment">/**
     * Clear cache of providers.
     */</span>
    <span class="type">void</span> clearCachedProviders();
} </code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="persistenceproviderresolverholder"><a class="anchor" href="#persistenceproviderresolverholder"></a>E.5. <code>PersistenceProviderResolverHolder</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">java.lang.ref.ReferenceQueue</span>;
<span class="keyword">import</span> <span class="include">java.lang.ref.SoftReference</span>;
<span class="keyword">import</span> <span class="include">java.lang.ref.WeakReference</span>;
<span class="keyword">import</span> <span class="include">java.security.AccessController</span>;
<span class="keyword">import</span> <span class="include">java.security.PrivilegedAction</span>;
<span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="keyword">import</span> <span class="include">java.util.Iterator</span>;
<span class="keyword">import</span> <span class="include">java.util.ServiceConfigurationError</span>;
<span class="keyword">import</span> <span class="include">java.util.ServiceLoader</span>;
<span class="keyword">import</span> <span class="include">java.util.logging.Level</span>;
<span class="keyword">import</span> <span class="include">java.util.logging.Logger</span>;


<span class="comment">/**
 * Holds the global {@link PersistenceProviderResolver} instance.
 * If no {@code PersistenceProviderResolver} is set by the environment,
 * the default {@code PersistenceProviderResolver} is used.
 *
 * &lt;p&gt;Enable {@code &quot;jakarta.persistence.spi&quot;} logger to show diagnostic
 * information.
 * 
 * &lt;p&gt;Implementations must be thread-safe.
 * 
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PersistenceProviderResolverHolder</span> {

    <span class="directive">private</span> <span class="directive">static</span> PersistenceProviderResolver singleton = <span class="keyword">new</span> DefaultPersistenceProviderResolver();

    <span class="comment">/**
     * Returns the current persistence provider resolver.
     * 
     * @return the current persistence provider resolver
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> PersistenceProviderResolver getPersistenceProviderResolver() {
        <span class="keyword">return</span> singleton;
    }

    <span class="comment">/**
     * Defines the persistence provider resolver used.
     * 
     * @param resolver persistence provider resolver to be used.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> setPersistenceProviderResolver(PersistenceProviderResolver resolver) {
        <span class="keyword">if</span> (resolver == <span class="predefined-constant">null</span>) {
            singleton = <span class="keyword">new</span> DefaultPersistenceProviderResolver();
        } <span class="keyword">else</span> {
            singleton = resolver;
        }
    }

    <span class="comment">/**
     * Default provider resolver class to use when none is explicitly set.
     * 
     * &lt;p&gt;Uses service loading mechanism as described in the Jakarta Persistence
     * specification. A ServiceLoader.load() call is made with the current context
     * classloader to find the service provider files on the classpath.
     */</span>
    <span class="directive">private</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">DefaultPersistenceProviderResolver</span> <span class="directive">implements</span> PersistenceProviderResolver {

        <span class="comment">/**
         * Cached list of available providers cached by CacheKey to ensure
         * there is not potential for provider visibility issues. 
         */</span>
        <span class="directive">private</span> <span class="directive">volatile</span> <span class="predefined-type">HashMap</span>&lt;CacheKey, PersistenceProviderReference&gt; providers = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;CacheKey, PersistenceProviderReference&gt;();
        
        <span class="comment">/**
         * Queue for reference objects referring to class loaders or persistence providers.
         */</span>
        <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">ReferenceQueue</span> referenceQueue = <span class="keyword">new</span> <span class="predefined-type">ReferenceQueue</span>();

        <span class="directive">public</span> <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; getPersistenceProviders() {
            <span class="comment">// Before we do the real loading work, see whether we need to</span>
            <span class="comment">// do some cleanup: If references to class loaders or</span>
            <span class="comment">// persistence providers have been nulled out, remove all related</span>
            <span class="comment">// information from the cache.</span>
            processQueue();
            
            <span class="predefined-type">ClassLoader</span> loader = getContextClassLoader();
            CacheKey cacheKey = <span class="keyword">new</span> CacheKey(loader);
            PersistenceProviderReference providersReferent = <span class="local-variable">this</span>.providers.get(cacheKey);
            <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; loadedProviders = <span class="predefined-constant">null</span>;
            
            <span class="keyword">if</span> (providersReferent != <span class="predefined-constant">null</span>) {
                loadedProviders = providersReferent.get();
            }

            <span class="keyword">if</span> (loadedProviders == <span class="predefined-constant">null</span>) {
                loadedProviders = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
                <span class="predefined-type">Iterator</span>&lt;PersistenceProvider&gt; ipp = ServiceLoader.load(PersistenceProvider.class, loader).iterator();
                <span class="keyword">try</span> {
                    <span class="keyword">while</span> (ipp.hasNext()) {
                        <span class="keyword">try</span> {
                            PersistenceProvider pp = ipp.next();
                            loadedProviders.add(pp);
                        } <span class="keyword">catch</span> (ServiceConfigurationError sce) {
                            log(<span class="predefined-type">Level</span>.FINEST, sce.toString());
                        }
                    }
                } <span class="keyword">catch</span> (ServiceConfigurationError sce) {
                    log(<span class="predefined-type">Level</span>.FINEST, sce.toString());
                }

                <span class="comment">// If none are found we'll log the provider names for diagnostic</span>
                <span class="comment">// purposes.</span>
                <span class="keyword">if</span> (loadedProviders.isEmpty()) {
                    log(<span class="predefined-type">Level</span>.WARNING, <span class="string"><span class="delimiter">&quot;</span><span class="content">No valid providers found.</span><span class="delimiter">&quot;</span></span>);
                }
                
                providersReferent = <span class="keyword">new</span> PersistenceProviderReference(loadedProviders, referenceQueue, cacheKey);

                <span class="local-variable">this</span>.providers.put(cacheKey, providersReferent);
            }

            <span class="keyword">return</span> loadedProviders;
        }
        
        <span class="comment">/**
         * Remove garbage collected cache keys &amp; providers.
         */</span>
        <span class="directive">private</span> <span class="type">void</span> processQueue() {
            CacheKeyReference ref;
            <span class="keyword">while</span> ((ref = (CacheKeyReference) referenceQueue.poll()) != <span class="predefined-constant">null</span>) {
                providers.remove(ref.getCacheKey());
            }            
        }

        <span class="comment">/**
         * Wraps {@code Thread.currentThread().getContextClassLoader()} into a
         * doPrivileged block if security manager is present
         */</span>
        <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">ClassLoader</span> getContextClassLoader() {
            <span class="keyword">if</span> (<span class="predefined-type">System</span>.getSecurityManager() == <span class="predefined-constant">null</span>) {
                <span class="keyword">return</span> <span class="predefined-type">Thread</span>.currentThread().getContextClassLoader();
            } <span class="keyword">else</span> {
                <span class="keyword">return</span> <span class="predefined-type">AccessController</span>.doPrivileged(<span class="keyword">new</span> <span class="predefined-type">PrivilegedAction</span>&lt;<span class="predefined-type">ClassLoader</span>&gt;() {
                    <span class="directive">public</span> <span class="predefined-type">ClassLoader</span> run() {
                        <span class="keyword">return</span> <span class="predefined-type">Thread</span>.currentThread().getContextClassLoader();
                    }
                });
            }
        }

        <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> LOGGER_SUBSYSTEM = <span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.persistence.spi</span><span class="delimiter">&quot;</span></span>;

        <span class="directive">private</span> <span class="predefined-type">Logger</span> logger;

        <span class="directive">private</span> <span class="type">void</span> log(<span class="predefined-type">Level</span> level, <span class="predefined-type">String</span> message) {
            <span class="keyword">if</span> (<span class="local-variable">this</span>.logger == <span class="predefined-constant">null</span>) {
                <span class="local-variable">this</span>.logger = <span class="predefined-type">Logger</span>.getLogger(LOGGER_SUBSYSTEM);
            }
            <span class="local-variable">this</span>.logger.log(level, LOGGER_SUBSYSTEM + <span class="string"><span class="delimiter">&quot;</span><span class="content">::</span><span class="delimiter">&quot;</span></span> + message);
        }

        <span class="comment">/**
         * Clear all cached providers
         */</span>
        <span class="directive">public</span> <span class="type">void</span> clearCachedProviders() {
            <span class="local-variable">this</span>.providers.clear();
        }

        
        <span class="comment">/**
         * The common interface to get a CacheKey implemented by
         * LoaderReference and PersistenceProviderReference.
         */</span>
        <span class="directive">private</span> <span class="type">interface</span> <span class="class">CacheKeyReference</span> {
            CacheKey getCacheKey();
        }        
        
        <span class="comment">/**
          * Key used for cached persistence providers. The key checks
          * the class loader to determine if the persistence providers
          * is a match to the requested one. The loader may be null.
          */</span>
        <span class="directive">private</span> <span class="type">class</span> <span class="class">CacheKey</span> <span class="directive">implements</span> <span class="predefined-type">Cloneable</span> {
            
            <span class="comment">/* Weak Reference to ClassLoader */</span>
            <span class="directive">private</span> LoaderReference loaderRef;
            
            <span class="comment">/* Cached Hashcode */</span>
            <span class="directive">private</span> <span class="type">int</span> hashCodeCache;

            CacheKey(<span class="predefined-type">ClassLoader</span> loader) {
                <span class="keyword">if</span> (loader == <span class="predefined-constant">null</span>) {
                    <span class="local-variable">this</span>.loaderRef = <span class="predefined-constant">null</span>;
                } <span class="keyword">else</span> {
                    loaderRef = <span class="keyword">new</span> LoaderReference(loader, referenceQueue, <span class="local-variable">this</span>);
                }
                calculateHashCode();
            }

            <span class="predefined-type">ClassLoader</span> getLoader() {
                <span class="keyword">return</span> (loaderRef != <span class="predefined-constant">null</span>) ? loaderRef.get() : <span class="predefined-constant">null</span>;
            }

            <span class="directive">public</span> <span class="type">boolean</span> equals(<span class="predefined-type">Object</span> other) {
                <span class="keyword">if</span> (<span class="local-variable">this</span> == other) {
                    <span class="keyword">return</span> <span class="predefined-constant">true</span>;
                }
                <span class="keyword">try</span> {
                    <span class="directive">final</span> CacheKey otherEntry = (CacheKey) other;
                    <span class="comment">// quick check to see if they are not equal</span>
                    <span class="keyword">if</span> (hashCodeCache != otherEntry.hashCodeCache) {
                        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
                    }
                    <span class="comment">// are refs (both non-null) or (both null)?</span>
                    <span class="keyword">if</span> (loaderRef == <span class="predefined-constant">null</span>) {
                        <span class="keyword">return</span> otherEntry.loaderRef == <span class="predefined-constant">null</span>;
                    }
                    <span class="predefined-type">ClassLoader</span> loader = loaderRef.get();
                    <span class="keyword">return</span> (otherEntry.loaderRef != <span class="predefined-constant">null</span>)
                    <span class="comment">// with a null reference we can no longer find</span>
                    <span class="comment">// out which class loader was referenced; so</span>
                    <span class="comment">// treat it as unequal</span>
                    &amp;&amp; (loader != <span class="predefined-constant">null</span>) &amp;&amp; (loader == otherEntry.loaderRef.get());
                } <span class="keyword">catch</span> (<span class="exception">NullPointerException</span> e) {
                } <span class="keyword">catch</span> (<span class="exception">ClassCastException</span> e) {
                }

                <span class="keyword">return</span> <span class="predefined-constant">false</span>;
            }

            <span class="directive">public</span> <span class="type">int</span> hashCode() {
                <span class="keyword">return</span> hashCodeCache;
            }

            <span class="directive">private</span> <span class="type">void</span> calculateHashCode() {
                <span class="predefined-type">ClassLoader</span> loader = getLoader();
                <span class="keyword">if</span> (loader != <span class="predefined-constant">null</span>) {
                    hashCodeCache = loader.hashCode();
                }
            }

            <span class="directive">public</span> <span class="predefined-type">Object</span> clone() {
                <span class="keyword">try</span> {
                    CacheKey clone = (CacheKey) <span class="local-variable">super</span>.clone();
                    <span class="keyword">if</span> (loaderRef != <span class="predefined-constant">null</span>) {
                        clone.loaderRef = <span class="keyword">new</span> LoaderReference(loaderRef.get(), referenceQueue, clone);
                    }
                    <span class="keyword">return</span> clone;
                } <span class="keyword">catch</span> (<span class="exception">CloneNotSupportedException</span> e) {
                    <span class="comment">// this should never happen</span>
                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">InternalError</span>();
                }
            }

            <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
                <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">CacheKey[</span><span class="delimiter">&quot;</span></span> + getLoader() + <span class="string"><span class="delimiter">&quot;</span><span class="content">)]</span><span class="delimiter">&quot;</span></span>;
            }
        }
       
       <span class="comment">/**
         * References to class loaders are weak references, so that they can be
         * garbage collected when nobody else is using them. The DefaultPersistenceProviderResolver 
         * class has no reason to keep class loaders alive.
         */</span>
        <span class="directive">private</span> <span class="type">class</span> <span class="class">LoaderReference</span> <span class="directive">extends</span> <span class="predefined-type">WeakReference</span>&lt;<span class="predefined-type">ClassLoader</span>&gt; 
                <span class="directive">implements</span> CacheKeyReference {
            <span class="directive">private</span> CacheKey cacheKey;

            <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
            LoaderReference(<span class="predefined-type">ClassLoader</span> referent, <span class="predefined-type">ReferenceQueue</span> q, CacheKey key) {
                <span class="local-variable">super</span>(referent, q);
                cacheKey = key;
            }

            <span class="directive">public</span> CacheKey getCacheKey() {
                <span class="keyword">return</span> cacheKey;
            }
        }

        <span class="comment">/**
         * References to persistence provider are soft references so that they can be garbage
         * collected when they have no hard references.
         */</span>
        <span class="directive">private</span> <span class="type">class</span> <span class="class">PersistenceProviderReference</span> <span class="directive">extends</span> <span class="predefined-type">SoftReference</span>&lt;<span class="predefined-type">List</span>&lt;PersistenceProvider&gt;&gt;
                <span class="directive">implements</span> CacheKeyReference {
            <span class="directive">private</span> CacheKey cacheKey;

            <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
            PersistenceProviderReference(<span class="predefined-type">List</span>&lt;PersistenceProvider&gt; referent, <span class="predefined-type">ReferenceQueue</span> q, CacheKey key) {
                <span class="local-variable">super</span>(referent, q);
                cacheKey = key;
            }

            <span class="directive">public</span> CacheKey getCacheKey() {
                <span class="keyword">return</span> cacheKey;
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_persistenceunitinfo_"><a class="anchor" href="#_persistenceunitinfo_"></a>E.6. <code>PersistenceUnitInfo</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">javax.sql.DataSource</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Properties</span>;
<span class="keyword">import</span> <span class="include">java.net.URL</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.SharedCacheMode</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.ValidationMode</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.EntityManagerFactory</span>;

<span class="comment">/**
 * Interface implemented by the container and used by the persistence
 * provider when creating an {@link EntityManagerFactory}.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceUnitInfo</span> {
        
    <span class="comment">/**
     * Returns the name of the persistence unit. Corresponds to the
     * {@code name} attribute in the {@code persistence.xml} file.
     * @return the name of the persistence unit
     */</span>
    <span class="predefined-type">String</span> getPersistenceUnitName();

    <span class="comment">/**
     * Returns the fully qualified name of the persistence provider
     * implementation class. Corresponds to the {@code provider} element
     * in the {@code persistence.xml} file.
     * @return  the fully qualified name of the persistence provider 
     * implementation class
     */</span>
    <span class="predefined-type">String</span> getPersistenceProviderClassName();

    <span class="comment">/**
     * Returns the fully-qualified class name of an annotation annotated
     * {@code Scope} or {@code NormalScope}. Corresponds to the {@code scope}
     * element in {@code persistence.xml}.
     * @return  the fully-qualified class name of the scope annotation,
     *          or null if no scope was explicitly specified
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getScopeAnnotationName();

    <span class="comment">/**
     * Returns the fully-qualified class names of annotations annotated
     * {@code Qualifier}. Corresponds to the {@code qualifier} element in
     * {@code persistence.xml}.
     * @return  the fully-qualified class names of the qualifier annotations,
     *          or an empty list if no qualifier annotations were explicitly
     *          specified
     */</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getQualifierAnnotationNames();

    <span class="comment">/**
     * Returns the transaction type of the entity managers created by
     * the {@link EntityManagerFactory}. The transaction type corresponds
     * to the {@code transaction-type} attribute in the {@code persistence.xml}
     * file.
     * @return  transaction type of the entity managers created
     * by the EntityManagerFactory
     *
     * &lt;p&gt;Note: This method will change its return type to {@link jakarta.persistence.PersistenceUnitTransactionType}
     * in the next major version.
     */</span>
    PersistenceUnitTransactionType getTransactionType();

    <span class="comment">/**
     * Returns the JTA-enabled data source to be used by the
     * persistence provider. The data source corresponds to the
     * {@code jta-data-source} element in the {@code persistence.xml}
     * file or is provided at deployment or by the container.
     * @return the JTA-enabled data source to be used by the 
     * persistence provider
     */</span>
    <span class="predefined-type">DataSource</span> getJtaDataSource();

    <span class="comment">/**
     * Returns the non-JTA-enabled data source to be used by the
     * persistence provider for accessing data outside a JTA
     * transaction. The data source corresponds to the named
     * {@code non-jta-data-source} element in the {@code persistence.xml}
     * file or provided at deployment or by the container.
     * @return the non-JTA-enabled data source to be used by the 
     * persistence provider for accessing data outside a JTA 
     * transaction
     */</span>
    <span class="predefined-type">DataSource</span> getNonJtaDataSource();

    <span class="comment">/**
     * Returns the list of the names of the mapping files that the
     * persistence provider must load to determine the mappings for
     * the entity classes. The mapping files must be in the standard
     * XML mapping format, be uniquely named and be resource-loadable
     * from the application classpath.  Each mapping file name
     * corresponds to a {@code mapping-file} element in the
     * {@code persistence.xml} file.
     * @return the list of mapping file names that the persistence
     * provider must load to determine the mappings for the entity
     * classes 
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getMappingFileNames();

    <span class="comment">/**
     * Returns a list of URLs for the jar files or exploded jar
     * file directories that the persistence provider must examine
     * for managed classes of the persistence unit. Each URL
     * corresponds to a {@code jar-file} element in the
     * {@code persistence.xml} file. A URL will either be a
     * file: URL referring to a jar file or referring to a directory
     * that contains an exploded jar file, or some other URL from
     * which an InputStream in jar format can be obtained.
     * @return a list of URL objects referring to jar files or
     * directories 
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">URL</span>&gt; getJarFileUrls();

    <span class="comment">/**
     * Returns the URL for the jar file or directory that is the
     * root of the persistence unit. (If the persistence unit is
     * rooted in the WEB-INF/classes directory, this is the URL
     * of that directory.)
     * The URL will either be a file: URL referring to a jar file 
     * or referring to a directory that contains an exploded jar
     * file, or some other URL from which an InputStream in jar
     * format can be obtained.
     * @return a URL referring to a jar file or directory
     */</span>
    <span class="predefined-type">URL</span> getPersistenceUnitRootUrl();

    <span class="comment">/**
     * Returns the list of the names of the classes that the
     * persistence provider must add to its set of managed
     * classes. Each name corresponds to a named {@code class} element in the
     * {@code persistence.xml} file.
     * @return the list of the names of the classes that the 
     * persistence provider must add to its set of managed 
     * classes 
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getManagedClassNames();

    <span class="comment">/**
     * Returns whether classes in the root of the persistence unit
     * that have not been explicitly listed are to be included in the
     * set of managed classes. This value corresponds to the
     * {@code exclude-unlisted-classes} element in the
     * {@code persistence.xml} file.
     * @return whether classes in the root of the persistence
     * unit that have not been explicitly listed are to be
     * included in the set of managed classes
     */</span>
    <span class="type">boolean</span> excludeUnlistedClasses();

    <span class="comment">/**
     * Returns the specification of how the provider must use
     * a second-level cache for the persistence unit.
     * The result of this method corresponds to the {@code shared-cache-mode}
     * element in the {@code persistence.xml} file.
     * @return the second-level cache mode that must be used by the
     * provider for the persistence unit
     *
     * @since 2.0
     */</span>
    SharedCacheMode getSharedCacheMode();

    <span class="comment">/**
     * Returns the validation mode to be used by the persistence
     * provider for the persistence unit.  The validation mode
     * corresponds to the {@code validation-mode} element in the
     * {@code persistence.xml} file.
     * @return the validation mode to be used by the 
     * persistence provider for the persistence unit
     * 
     * @since 2.0
     */</span>
    ValidationMode getValidationMode();

    <span class="comment">/**
     * Returns a properties object. Each property corresponds to a
     * {@code property} element in the {@code persistence.xml} file
     * or to a property set by the container.
     * @return Properties object 
     */</span>
    <span class="predefined-type">Properties</span> getProperties();
    
    <span class="comment">/**
     * Returns the schema version of the {@code persistence.xml} file.
     * @return {@code persistence.xml} schema version
     *
     * @since 2.0
     */</span>
    <span class="predefined-type">String</span> getPersistenceXMLSchemaVersion();

    <span class="comment">/**
     * Returns ClassLoader that the provider may use to load any
     * classes, resources, or open URLs.
     * @return ClassLoader that the provider may use to load any 
     * classes, resources, or open URLs 
     */</span>
    <span class="predefined-type">ClassLoader</span> getClassLoader();

    <span class="comment">/**
     * Add a transformer supplied by the provider that is called for
     * every new class definition or class redefinition that gets
     * loaded by the loader returned by the
     * {@link PersistenceUnitInfo#getClassLoader} method. The
     * transformer has no effect on the result returned by the
     * {@link PersistenceUnitInfo#getNewTempClassLoader} method.
     * Classes are only transformed once within the same classloading
     * scope, regardless of how many persistence units they may be 
     * a part of.
     * @param transformer   provider-supplied transformer that the
     * container invokes at class-(re)definition time
     */</span>
    <span class="type">void</span> addTransformer(ClassTransformer transformer);

    <span class="comment">/**
     * Return a new instance of a {@link ClassLoader} that the provider
     * may use to temporarily load any classes, resources, or open
     * URLs. The scope and classpath of this loader is exactly the
     * same as that of the loader returned by {@link
     * PersistenceUnitInfo#getClassLoader}. None of the classes loaded
     * by this class loader are visible to application components. The
     * provider may only use this {@code ClassLoader} within the scope
     * of the {@link PersistenceProvider#createContainerEntityManagerFactory}
     * call.
     * @return temporary {@code ClassLoader} with same visibility as
     * current loader
     */</span>
    <span class="predefined-type">ClassLoader</span> getNewTempClassLoader();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_providerutil_"><a class="anchor" href="#_providerutil_"></a>E.7. <code>ProviderUtil</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence.FetchType</span>;

<span class="comment">/**
 * Utility interface implemented by the persistence provider. This
 * interface is invoked by the {@link jakarta.persistence.PersistenceUtil}
 * implementation to determine the load status of an entity or entity
 * attribute.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ProviderUtil</span> { 

    <span class="comment">/**
     * If the provider determines that the entity has been provided by
     * itself and that the state of the specified attribute has been loaded,
     * this method returns {@link LoadState#LOADED}.
     * &lt;p&gt; If the provider determines that the entity has been provided
     * by itself and that either entity attributes with {@link FetchType#EAGER}
     * have not been loaded or that the state of the specified attribute has
     * not been loaded, this method returns {@link LoadState#NOT_LOADED}.
     * &lt;p&gt; If a provider cannot determine the load state, this method
     * returns {@link LoadState#UNKNOWN}.
     * &lt;p&gt; The provider's implementation of this method must not obtain a
     * reference to an attribute value, as this could trigger the loading
     * of entity state if the entity has been provided by a different
     * provider.
     * @param entity  entity instance
     * @param attributeName  name of attribute whose load status is
     *        to be determined
     * @return load status of the attribute
     */</span>
    LoadState isLoadedWithoutReference(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * If the provider determines that the entity has been provided by
     * itself and that the state of the specified attribute has been loaded,
     * this method returns {@link LoadState#LOADED}.
     * &lt;p&gt; If a provider determines that the entity has been provided by
     * itself and that either the entity attributes with {@link FetchType#EAGER}
     * have not been loaded or that the state of the specified attribute has
     * not been loaded, this method returns {@link LoadState#NOT_LOADED}.
     * &lt;p&gt; If the provider cannot determine the load state, this method
     * returns {@link LoadState#UNKNOWN}.
     * &lt;p&gt; The provider's implementation of this method is permitted to
     * obtain a reference to the attribute value. (This access is safe
     * because providers which might trigger the loading of the attribute
     * state will have already been determined by
     * {@link #isLoadedWithoutReference}.)
     *
     * @param entity  entity instance
     * @param attributeName  name of attribute whose load status is
     *        to be determined
     * @return load status of the attribute
     */</span>
    LoadState isLoadedWithReference(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * If the provider determines that the entity has been provided by
     * itself and that the state of all attributes for which
     * {@link FetchType#EAGER} has been specified have been loaded, this
     * method returns {@link LoadState#LOADED}.
     * &lt;p&gt; If the provider determines that the entity has been provided
     * by itself and that not all attributes with {@link FetchType#EAGER}
     * have been loaded, this method returns {@link LoadState#NOT_LOADED}.
     * &lt;p&gt; If the provider cannot determine if the entity has been
     * provided by itself, this method returns {@link LoadState#UNKNOWN}.
     * &lt;p&gt; The provider's implementation of this method must not obtain
     * a reference to any attribute value, as this could trigger the
     * loading of entity state if the entity has been provided by a
     * different provider.
     * @param entity whose loaded status is to be determined
     * @return load status of the entity
     */</span>
    LoadState isLoaded(<span class="predefined-type">Object</span> entity);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. An entity instance is a local object inaccessible to remote processes. If instances of an entity are to be passed by value as detached objects (e.g., via a remote interface), the entity class must be serializable.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. The term "persistence provider runtime" refers to the runtime environment of the persistence implementation. In a JakartaEE environment, this might be the Jakarta EE container itself, or a third-party persistence provider implementation integrated with the container.
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. These annotations must not be applied to the setter methods.
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. Portable applications should not expect the order of a list to be maintained across persistence contexts unless the <code>OrderColumn</code> or <code>OrderBy</code> annotation is used and modifications to the list observe the specified ordering.
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. A persistence provider is permitted&#8212;&#8203;but not required&#8212;&#8203;to accept the combinations <code>@Basic @ElementCollection</code> and <code>@Embedded @ElementCollection</code>.
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. Specifically, if <code>getX</code> is the name of the getter method and <code>setX</code> is the name of the setter method, where <code>X</code> is any string, the name of the persistent property is obtained by calling <code>java.beans.Introspector.decapitalize(X)</code>.
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. Lazy fetching is a hint to the persistence provider and can be specified by means of the <code>Basic</code>, <code>OneToOne</code>, <code>OneToMany</code>, <code>ManyToOne</code>, <code>ManyToMany</code>, and <code>ElementCollection</code> annotations and their XML equivalents. See <a href="#a13915">Chapter 11</a>.
</div>
<div class="footnote" id="_footnotedef_8">
<a href="#_footnoteref_8">8</a>. The use of XML as an alternative and the interaction between Java language annotations and XML elements in defining default and explicit access types is described in <a href="#a16944">Chapter 12</a>.
</div>
<div class="footnote" id="_footnotedef_9">
<a href="#_footnoteref_9">9</a>. An <code>Access</code> annotation of a field or property getter is considered a "mapping annotation" for the purposes of this section. Therefore, an attribute-level <code>Access</code> annotation may not be used to selectively override the access type of an attribute of an entity class with a defaulted access type.
</div>
<div class="footnote" id="_footnotedef_10">
<a href="#_footnoteref_10">10</a>. Composite primary keys often arise when mapping a legacy database with primary keys comprising multiple columns.
</div>
<div class="footnote" id="_footnotedef_11">
<a href="#_footnoteref_11">11</a>. In general, however, approximate numeric types (e.g., floating point types) should never be used in primary keys.
</div>
<div class="footnote" id="_footnotedef_12">
<a href="#_footnoteref_12">12</a>. This includes not changing the value of a mutable type that is primary key or an attribute of a composite primary key.
</div>
<div class="footnote" id="_footnotedef_13">
<a href="#_footnoteref_13">13</a>. The implementation may, but is not required to, throw an exception. Portable applications must not rely on any such specific behavior.
</div>
<div class="footnote" id="_footnotedef_14">
<a href="#_footnoteref_14">14</a>. If the application does not set a primary key attribute mapped to the same column or columns as the relationship, the value of that attribute might not be available until after the entity has been flushed to the database.
</div>
<div class="footnote" id="_footnotedef_15">
<a href="#_footnoteref_15">15</a>. The primary key of the parent might be represented as an embedded id or as an id class.
</div>
<div class="footnote" id="_footnotedef_16">
<a href="#_footnoteref_16">16</a>. Note that the use of PrimaryKeyJoinColumn instead of MapsId would result in the same mapping in this example. Use of MapsId is preferred for the mapping of derived identities.
</div>
<div class="footnote" id="_footnotedef_17">
<a href="#_footnoteref_17">17</a>. Bulk update statements, however, are permitted to set the version of an entity. See <a href="#a5636">Section 4.11</a>.
</div>
<div class="footnote" id="_footnotedef_18">
<a href="#_footnoteref_18">18</a>. Note that an instance of <code>Calendar</code> must be fully initialized for the SQL type it maps.
</div>
<div class="footnote" id="_footnotedef_19">
<a href="#_footnoteref_19">19</a>. The use of <code>java.util.Calendar</code> or of <code>java.util.Date</code> is strongly discouraged. Newly-written programs should use the date/time types defined in the package <code>java.time</code>.
</div>
<div class="footnote" id="_footnotedef_20">
<a href="#_footnoteref_20">20</a>. The use of date/time types defined in the package <code>java.sql</code> is strongly discouraged. Newly-written programs should use the date/time types defined in <code>java.time</code>.
</div>
<div class="footnote" id="_footnotedef_21">
<a href="#_footnoteref_21">21</a>. The use of <code>Byte</code> arrays or of <code>Character</code> arrays is discouraged. Newly-written programs should use <code>byte</code> or <code>char</code> arrays instead.
</div>
<div class="footnote" id="_footnotedef_22">
<a href="#_footnoteref_22">22</a>. Direct or indirect circular containment dependencies among embeddable classes are not permitted.
</div>
<div class="footnote" id="_footnotedef_23">
<a href="#_footnoteref_23">23</a>. An entity cannot have a unidirectional relationship to the embeddable class of another entity (or itself).
</div>
<div class="footnote" id="_footnotedef_24">
<a href="#_footnoteref_24">24</a>. Note that when an embeddable instance is used as a map key, these attributes represent its identity. Changes to embeddable instances used as map keys have undefined behaviour and should be avoided.
</div>
<div class="footnote" id="_footnotedef_25">
<a href="#_footnoteref_25">25</a>. For associations of type <code>java.util.Map</code>, <em>target type</em> refers to the type that is the Map <code>value</code>.
</div>
<div class="footnote" id="_footnotedef_26">
<a href="#_footnoteref_26">26</a>. If the parent is detached or new or was previously removed before the orphan was associated with it, the remove operation is not applied to the entity being orphaned.
</div>
<div class="footnote" id="_footnotedef_27">
<a href="#_footnoteref_27">27</a>. When the relationship is modeled as a <code>java.util.Map</code>, Entity B references a collection of Entity A means that Entity B references a map collection in which the type of the Map <code>value</code> is Entity A. The map key may be a basic type, embeddable class, or an entity.
</div>
<div class="footnote" id="_footnotedef_28">
<a href="#_footnoteref_28">28</a>. The superclass must not be an embeddable class or id class.
</div>
<div class="footnote" id="_footnotedef_29">
<a href="#_footnoteref_29">29</a>. If a transaction-scoped persistence context is used, it is not required to be retained across transactions.
</div>
<div class="footnote" id="_footnotedef_30">
<a href="#_footnoteref_30">30</a>. This includes instances of a non-entity class that extends an entity class.
</div>
<div class="footnote" id="_footnotedef_31">
<a href="#_footnoteref_31">31</a>. If &lt;delimited-identifiers&gt; is specified and individual annotations or XML elements or attributes use escaped double quotes, the double-quotes appear in the name of the database identifier.
</div>
<div class="footnote" id="_footnotedef_32">
<a href="#_footnoteref_32">32</a>. This includes, for example. modifications to persistent attributes of type char[] and byte[].
</div>
<div class="footnote" id="_footnotedef_33">
<a href="#_footnoteref_33">33</a>. This might be an issue if unique constraints (such as those described for the default mappings in <a href="#a640">Section 2.12.3.1</a> and <a href="#a764">Section 2.12.5.1</a>) were not applied in the definition of the object/relational mapping.
</div>
<div class="footnote" id="_footnotedef_34">
<a href="#_footnoteref_34">34</a>. Note that when a new transaction is begun, the managed objects in an extended persistence context are <code>not</code> reloaded from the database.
</div>
<div class="footnote" id="_footnotedef_35">
<a href="#_footnoteref_35">35</a>. These are instances that were persistent in the database at the start of the transaction.
</div>
<div class="footnote" id="_footnotedef_36">
<a href="#_footnoteref_36">36</a>. It is unspecified as to whether instances that were not persistent in the database behave as new instances or detached instances after rollback. This may be implementation-dependent.
</div>
<div class="footnote" id="_footnotedef_37">
<a href="#_footnoteref_37">37</a>. Applications may require that database isolation levels higher than read-committed be in effect. The configuration of the setting database isolation levels, however, is outside the scope of this specification.
</div>
<div class="footnote" id="_footnotedef_38">
<a href="#_footnoteref_38">38</a>. Such alternative mechanisms might be standardized by a future release of this specification.
</div>
<div class="footnote" id="_footnotedef_39">
<a href="#_footnoteref_39">39</a>. This includes owned relationships maintained in join tables.
</div>
<div class="footnote" id="_footnotedef_40">
<a href="#_footnoteref_40">40</a>. Typically, by incrementing the version number, or by replacing the previous timestamp with a timestamp representing the current time.
</div>
<div class="footnote" id="_footnotedef_41">
<a href="#_footnoteref_41">41</a>. Ideally, version verification and update happen in a single atomic operation against the datastore, for example, in a single SQL update statement.
</div>
<div class="footnote" id="_footnotedef_42">
<a href="#_footnoteref_42">42</a>. Implementations are permitted to use database mechanisms other than locking to achieve the semantic effects described here, for example, multiversion concurrency control mechanisms.
</div>
<div class="footnote" id="_footnotedef_43">
<a href="#_footnoteref_43">43</a>. This is achieved by using a lock with <code>LockModeType.PESSIMISTIC_WRITE</code> or <code>LockModeType.PESSIMISTIC_FORCE_INCREMENT</code> as described in <a href="#a2084">Section 3.5.4</a>.
</div>
<div class="footnote" id="_footnotedef_44">
<a href="#_footnoteref_44">44</a>. For example, a persistence provider may use an underlying database platform&#8217;s SELECT FOR UPDATE statements to implement pessimistic locking if that construct provides appropriate semantics, or the provider may use an isolation level of repeatable read.
</div>
<div class="footnote" id="_footnotedef_45">
<a href="#_footnoteref_45">45</a>. The lock mode type NONE may be specified as a method argument and also provides a default value for annotations.
</div>
<div class="footnote" id="_footnotedef_46">
<a href="#_footnoteref_46">46</a>. Databases concurrency control mechanisms that provide comparable semantics, e.g., multiversion concurrency control, can be used by the provider.
</div>
<div class="footnote" id="_footnotedef_47">
<a href="#_footnoteref_47">47</a>. The persistence provider is not required to flush the entity to the database immediately.
</div>
<div class="footnote" id="_footnotedef_48">
<a href="#_footnoteref_48">48</a>. CDI is enabled by default in Jakarta EE. See the Jakarta EE specification <a href="#a19499">[6]</a>.
</div>
<div class="footnote" id="_footnotedef_49">
<a href="#_footnoteref_49">49</a>. The persistence provider may support CDI injection into entity listeners in other environments in which the BeanManager is available.
</div>
<div class="footnote" id="_footnotedef_50">
<a href="#_footnoteref_50">50</a>. For example, if a transaction commit occurs as a result of the normal termination of a session bean business method with transaction attribute <code>RequiresNew</code>, the <code>PostPersist</code> and <code>PostRemove</code> callbacks are executed in the naming context, the transaction context, and the security context of that component.
</div>
<div class="footnote" id="_footnotedef_51">
<a href="#_footnoteref_51">51</a>. Note that this caution applies also to the actions of objects that might be injected into an entity listener
</div>
<div class="footnote" id="_footnotedef_52">
<a href="#_footnoteref_52">52</a>. Excluded listeners may be reintroduced on an entity class by listing them explicitly in the <code>EntityListeners</code> annotation or XML <code>entity-listeners</code> element.
</div>
<div class="footnote" id="_footnotedef_53">
<a href="#_footnoteref_53">53</a>. If a method overrides an inherited callback method but specifies a different lifecycle event or is not a lifecycle callback method, the overridden method will not be invoked.
</div>
<div class="footnote" id="_footnotedef_54">
<a href="#_footnoteref_54">54</a>. We plan to provide a facility for more complex attribute conversions in a future release of this specification.
</div>
<div class="footnote" id="_footnotedef_55">
<a href="#_footnoteref_55">55</a>. CDI is enabled by default in Jakarta EE. See the Jakarta EE specification <a href="#a19499">[6]</a>.
</div>
<div class="footnote" id="_footnotedef_56">
<a href="#_footnoteref_56">56</a>. The persistence provider may support CDI injection into attribute converters in other environments in which the BeanManager is available.
</div>
<div class="footnote" id="_footnotedef_57">
<a href="#_footnoteref_57">57</a>. A lock mode is specified for a query by means of the <code>setLockMode</code> method or by specifying the lock mode in the <code>NamedQuery</code> annotation.
</div>
<div class="footnote" id="_footnotedef_58">
<a href="#_footnoteref_58">58</a>. Note that the setLockMode method may be called more than once (with different values) on a Query or TypedQuery object.
</div>
<div class="footnote" id="_footnotedef_59">
<a href="#_footnoteref_59">59</a>. Note that locking will not occur for data passed to aggregate functions. Further, queries involving aggregates with pessimistic locking may not be supported on all database platforms.
</div>
<div class="footnote" id="_footnotedef_60">
<a href="#_footnoteref_60">60</a>. Support for joins is currently limited to single-valued relationships that are mapped directlyi.e., not via join tables.
</div>
<div class="footnote" id="_footnotedef_61">
<a href="#_footnoteref_61">61</a>. Note that REF_CURSOR parameters are used by some databases to return result sets from stored procedures.
</div>
<div class="footnote" id="_footnotedef_62">
<a href="#_footnoteref_62">62</a>. As in SQL, the <code>INTERSECT</code> and <code>INTERSECT ALL</code> operations have higher precedence than <code>UNION</code>, <code>UNION ALL</code>, <code>EXCEPT</code>, and <code>EXCEPT ALL</code>.
</div>
<div class="footnote" id="_footnotedef_63">
<a href="#_footnoteref_63">63</a>. This chapter uses the convention that reserved identifiers appear in upper case in the examples and BNF for the language.
</div>
<div class="footnote" id="_footnotedef_64">
<a href="#_footnoteref_64">64</a>. BIT_LENGTH, CHAR_LENGTH, CHARACTER_LENGTH, POSITION, and UNKNOWN are not currently used: they are reserved for future use.
</div>
<div class="footnote" id="_footnotedef_65">
<a href="#_footnoteref_65">65</a>. A range variable never designates an embeddable class abstract schema type.
</div>
<div class="footnote" id="_footnotedef_66">
<a href="#_footnoteref_66">66</a>. Note that use of VALUE is optional, as an identification variable referring to an association of type <code>java.util.Map</code> is of the abstract schema type of the map value. (See <a href="#a4765">Section 4.4.2</a>.)
</div>
<div class="footnote" id="_footnotedef_67">
<a href="#_footnoteref_67">67</a>. Support for right outer joins and full outer joins is under consideration for inclusion in a future version of this specification.
</div>
<div class="footnote" id="_footnotedef_68">
<a href="#_footnoteref_68">68</a>. The implementation is not expected to perform such query operations involving such fields in memory rather than in the database.
</div>
<div class="footnote" id="_footnotedef_69">
<a href="#_footnoteref_69">69</a>. Note that queries that contain subqueries on both sides of a comparison operation will not be portable across all databases.
</div>
<div class="footnote" id="_footnotedef_70">
<a href="#_footnoteref_70">70</a>. Note that use of a collection-valued input parameter might prevent precompilation of the query.
</div>
<div class="footnote" id="_footnotedef_71">
<a href="#_footnoteref_71">71</a>. Refer to <a href="#a19494">[2]</a> for a more precise characterization of these rules.
</div>
<div class="footnote" id="_footnotedef_72">
<a href="#_footnoteref_72">72</a>. The use of the reserved word OF is optional in this expression.
</div>
<div class="footnote" id="_footnotedef_73">
<a href="#_footnoteref_73">73</a>. Subqueries are restricted to the WHERE and HAVING clauses in this release. Support for subqueries in the FROM clause will be considered in a later release of this specification.
</div>
<div class="footnote" id="_footnotedef_74">
<a href="#_footnoteref_74">74</a>. Note that expressions involving aggregate operators must not be used in the WHERE clause.
</div>
<div class="footnote" id="_footnotedef_75">
<a href="#_footnoteref_75">75</a>. Note that not all databases support the use of a trim character other than the space character; use of this argument may result in queries that are not portable.
</div>
<div class="footnote" id="_footnotedef_76">
<a href="#_footnoteref_76">76</a>. Note that not all databases support the use of the third argument to LOCATE; use of this argument may result in queries that are not portable.
</div>
<div class="footnote" id="_footnotedef_77">
<a href="#_footnoteref_77">77</a>. Note that not all databases support the use of SQL case expressions. The use of case expressions may result in queries that are not portable to such databases.
</div>
<div class="footnote" id="_footnotedef_78">
<a href="#_footnoteref_78">78</a>. For a general or simple <code>CASE</code> expression, the operands are the scalar expressions in the <code>THEN</code> and <code>ELSE</code> clauses.
</div>
<div class="footnote" id="_footnotedef_79">
<a href="#_footnoteref_79">79</a>. Note that the keyword OBJECT is not required. It is preferred that it be omitted for new queries.
</div>
<div class="footnote" id="_footnotedef_80">
<a href="#_footnoteref_80">80</a>. It is legal to specify DISTINCT with MAX or MIN, but it does not affect the result.
</div>
<div class="footnote" id="_footnotedef_81">
<a href="#_footnoteref_81">81</a>. We expect that the option of different packages will be provided in a future release of this specification.
</div>
<div class="footnote" id="_footnotedef_82">
<a href="#_footnoteref_82">82</a>. If the class was generated, it should also be annotated with either <code>javax.annotation.processing.Generated</code> or <code>jakarta.annotation.Generated</code>. The use of any other annotations on static metamodel classes is undefined.
</div>
<div class="footnote" id="_footnotedef_83">
<a href="#_footnoteref_83">83</a>. The attributes of these metamodel objects play a role analogous to that which would be played by member literals.
</div>
<div class="footnote" id="_footnotedef_84">
<a href="#_footnoteref_84">84</a>. Metamodel objects are used to specify typesafe nagivation through joins and through path expressions. These metamodel objects capture both the source and target types of the attribute through which navigation occurs, and are thus the mechanism by which typesafe navigation is achieved.
</div>
<div class="footnote" id="_footnotedef_85">
<a href="#_footnoteref_85">85</a>. Attribute names serve this role for string-based queries. See <a href="#a11349">Section 6.5</a>.
</div>
<div class="footnote" id="_footnotedef_86">
<a href="#_footnoteref_86">86</a>. Attribute names serve this role for string-based queries. See <a href="#a11349">Section 6.5</a>.
</div>
<div class="footnote" id="_footnotedef_87">
<a href="#_footnoteref_87">87</a>. Note that the use of JTA is not required to be supported in application client containers.
</div>
<div class="footnote" id="_footnotedef_88">
<a href="#_footnoteref_88">88</a>. It may also be used internally by the Jakarta EE container. See <a href="#a12100">Section 7.10</a>.
</div>
<div class="footnote" id="_footnotedef_89">
<a href="#_footnoteref_89">89</a>. This may be the case when using multiple databases, since in a typical configuration a single entity manager only communicates with a single database. There is only one entity manager factory per persistence unit, however.
</div>
<div class="footnote" id="_footnotedef_90">
<a href="#_footnoteref_90">90</a>. Specifically, when one of the methods of the EntityManager interface is invoked.
</div>
<div class="footnote" id="_footnotedef_91">
<a href="#_footnoteref_91">91</a>. Note that this applies to a transaction-scoped persistence context of type SynchronizationType.UNSYNCHRONIZED that has not been joined to the transaction as well.
</div>
<div class="footnote" id="_footnotedef_92">
<a href="#_footnoteref_92">92</a>. Entity manager instances obtained from different entity manager factories never share the same persistence context.
</div>
<div class="footnote" id="_footnotedef_93">
<a href="#_footnoteref_93">93</a>. It is not required that these contracts be used when a third-party persistence provider is not used: the container might use these same APIs or its might use its own internal APIs.
</div>
<div class="footnote" id="_footnotedef_94">
<a href="#_footnoteref_94">94</a>. The container may choose to pool EntityManagers: it instead of creating and closing in each case, it may acquire one from its pool and call <code>clear()</code> on it.
</div>
<div class="footnote" id="_footnotedef_95">
<a href="#_footnoteref_95">95</a>. The root of the persistence unit is the <code>WEB-INF/classes</code> directory; the <code>persistence.xml</code> file is therefore contained in the <code>WEB-INF/classes/META-INF</code> directory.
</div>
<div class="footnote" id="_footnotedef_96">
<a href="#_footnoteref_96">96</a>. Note that an given class may be used in more than one persistence unit.
</div>
<div class="footnote" id="_footnotedef_97">
<a href="#_footnoteref_97">97</a>. Persistence providers are encouraged to support this syntax for use in Java SE environments.
</div>
<div class="footnote" id="_footnotedef_98">
<a href="#_footnoteref_98">98</a>. Note that in this example a META-INF/orm.xml file is assumed not to exist.
</div>
<div class="footnote" id="_footnotedef_99">
<a href="#_footnoteref_99">99</a>. Use of these Java SE bootstrapping APIs may be supported in Jakarta EE containers; however, support for such use is not required.
</div>
<div class="footnote" id="_footnotedef_100">
<a href="#_footnoteref_100">100</a>. In dynamic environments (e.g., OSGi-based environments, containers based on dynamic kernels, etc.), the list of persistence providers may change.
</div>
<div class="footnote" id="_footnotedef_101">
<a href="#_footnoteref_101">101</a>. If a custom PersistenceProviderResolver is needed in a JavaSE environment, it must be set before Persistence.createEntityManagerFactory is called. Note, however, that the setPersistenceProviderResolver method is not intended for general use, but rather is aimed at containers maintaining a dynamic environment.
</div>
<div class="footnote" id="_footnotedef_102">
<a href="#_footnoteref_102">102</a>. Persistence units defined programmatically using the <code>PersistenceConfiguration</code> class do not support JNDI lookup or injection via the <code>PersistenceContext</code> or <code>PersistenceUnit</code> annotations.
</div>
<div class="footnote" id="_footnotedef_103">
<a href="#_footnoteref_103">103</a>. The determining of the persistence providers that are available is discussed in <a href="#a12837">Section 9.3</a>.
</div>
<div class="footnote" id="_footnotedef_104">
<a href="#_footnoteref_104">104</a>. A dependency on ultiple persistence contexts may be needed, for example, when multiple persistence units are used.
</div>
<div class="footnote" id="_footnotedef_105">
<a href="#_footnoteref_105">105</a>. Multiple persistence units may be needed, for example, when mapping to multiple databases.
</div>
<div class="footnote" id="_footnotedef_106">
<a href="#_footnoteref_106">106</a>. The use of map keys that contain embeddables that reference entities is not permitted.
</div>
<div class="footnote" id="_footnotedef_107">
<a href="#_footnoteref_107">107</a>. Note that <code>either</code> the <code>joinColumns</code> element <code>or</code> the <code>joinTable</code> element of the <code>AssociationOverride</code> annotation is specified for overriding a given relationship (but never both).
</div>
<div class="footnote" id="_footnotedef_108">
<a href="#_footnoteref_108">108</a>. The combination of inheritance strategies within a single entity inheritance hierarchy is not defined by this specification.
</div>
<div class="footnote" id="_footnotedef_109">
<a href="#_footnoteref_109">109</a>. If it is not specified, the rules of <a href="#a511">Section 2.10</a> apply.
</div>
<div class="footnote" id="_footnotedef_110">
<a href="#_footnoteref_110">110</a>. If the embeddable class is used as a primary key, the <code>EmbeddedId</code> rather than the <code>Embedded</code> annotation is used.
</div>
<div class="footnote" id="_footnotedef_111">
<a href="#_footnoteref_111">111</a>. Use of the <code>Embedded</code> annotation is not required. See <a href="#a511">Section 2.10</a>.
</div>
<div class="footnote" id="_footnotedef_112">
<a href="#_footnoteref_112">112</a>. Note that the <code>Id</code> annotation is not used in the embeddable class.
</div>
<div class="footnote" id="_footnotedef_113">
<a href="#_footnoteref_113">113</a>. If the element collection is a <code>Map</code>, this applies to the map value.
</div>
<div class="footnote" id="_footnotedef_114">
<a href="#_footnoteref_114">114</a>. Mapping of stateful enum values is not supported.
</div>
<div class="footnote" id="_footnotedef_115">
<a href="#_footnoteref_115">115</a>. Portable applications should not use the <code>GeneratedValue</code> annotation on other persistent fields or properties.
</div>
<div class="footnote" id="_footnotedef_116">
<a href="#_footnoteref_116">116</a>. Note that <code>SEQUENCE</code> and <code>IDENTITY</code> are not portable across all databases.
</div>
<div class="footnote" id="_footnotedef_117">
<a href="#_footnoteref_117">117</a>. A primary key with a type not listed is not portable.
</div>
<div class="footnote" id="_footnotedef_118">
<a href="#_footnoteref_118">118</a>. In general, floating point types should never be used in primary keys.
</div>
<div class="footnote" id="_footnotedef_119">
<a href="#_footnoteref_119">119</a>. If the element collection is a Map, this applies to the map value.
</div>
<div class="footnote" id="_footnotedef_120">
<a href="#_footnoteref_120">120</a>. The <code>ManyToMany</code> annotation must not be used within an embeddable class used in an element collection.
</div>
<div class="footnote" id="_footnotedef_121">
<a href="#_footnoteref_121">121</a>. The <code>OneToMany</code> annotation must not be used within an embeddable class used in an element collection.
</div>
<div class="footnote" id="_footnotedef_122">
<a href="#_footnoteref_122">122</a>. If the parent is detached or new or was previously removed before the orphan was associated with it, the remove operation is not applied to the entity being orphaned.
</div>
<div class="footnote" id="_footnotedef_123">
<a href="#_footnoteref_123">123</a>. If the parent is detached or new or was previously removed before the orphan was associated with it, the remove operation is not applied to the entity being orphaned.
</div>
<div class="footnote" id="_footnotedef_124">
<a href="#_footnoteref_124">124</a>. If the primary key is a composite primary key, the precedence of ordering among the attributes within the primary key is not futher defined. To assign such a precedence within these attributes, each of the individual attributes must be specified as an orderby_item.
</div>
<div class="footnote" id="_footnotedef_125">
<a href="#_footnoteref_125">125</a>. In all other cases when OrderBy is applied to an element collection, the <code>property_or_field_name</code> must be specified.
</div>
<div class="footnote" id="_footnotedef_126">
<a href="#_footnoteref_126">126</a>. The <code>OrderBy</code> annotation should be used for ordering that is visible as persistent state and maintained by the application.
</div>
<div class="footnote" id="_footnotedef_127">
<a href="#_footnoteref_127">127</a>. It is not expected that a database foreign key be defined for the OneToOne mapping, as the OneToOne relationship may be defined as optional=true.
</div>
<div class="footnote" id="_footnotedef_128">
<a href="#_footnoteref_128">128</a>. The derived id mechanisms described in <a href="#a155">Section 2.4.2.1</a> are now to be preferred over PrimaryKeyJoinColumn for the OneToOne mapping case.
</div>
<div class="footnote" id="_footnotedef_129">
<a href="#_footnoteref_129">129</a>. Note that the derived identity mechanisms described in <a href="#a155">Section 2.4.2.1</a> is now preferred to the use of PrimaryKeyJoinColumn for this case.
</div>
<div class="footnote" id="_footnotedef_130">
<a href="#_footnoteref_130">130</a>. When a joined inheritance strategy is used, the Table annotation is used to specify a primary table for the subclass-specific state if the default is not used.
</div>
<div class="footnote" id="_footnotedef_131">
<a href="#_footnoteref_131">131</a>. If the element collection is a Map, this applies to the map value.
</div>
</div>
<div id="footer">
<div id="footer-text">
 3.2<br>
Last updated 2024-03-28 10:18:14 UTC
</div>
</div>
</body>
</html>