<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Jakarta Persistence Team, https://projects.eclipse.org/projects/ee4j.jpa">
<title>Jakarta Persistence</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Jakarta Persistence</h1>
<div class="details">
<span id="author" class="author">Jakarta Persistence Team, https://projects.eclipse.org/projects/ee4j.jpa</span><br>
<span id="email" class="email"><a href="https://dev.eclipse.org/mailman/listinfo/jpa-dev" class="bare">https://dev.eclipse.org/mailman/listinfo/jpa-dev</a></span><br>
<span id="revnumber"> 3.0,</span>
<span id="revdate">September 08, 2020</span>
<br><span id="revremark"></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel2">
<li><a href="#eclipse-foundation-specification-license">Eclipse Foundation Specification License</a>
<ul class="sectlevel3">
<li><a href="#disclaimers">Disclaimers</a></li>
</ul>
</li>
<li><a href="#scope">Scope</a></li>
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#expert-group">1.1. Expert Group</a></li>
<li><a href="#document-conventions">1.2. Document Conventions</a></li>
</ul>
</li>
<li><a href="#entities">2. Entities</a>
<ul class="sectlevel2">
<li><a href="#a18">2.1. The Entity Class</a></li>
<li><a href="#persistent-fields-and-properties">2.2. Persistent Fields and Properties</a>
<ul class="sectlevel3">
<li><a href="#example">2.2.1. Example</a></li>
</ul>
</li>
<li><a href="#a113">2.3. Access Type</a>
<ul class="sectlevel3">
<li><a href="#default-access-type">2.3.1. Default Access Type</a></li>
<li><a href="#a122">2.3.2. Explicit Access Type</a></li>
<li><a href="#access-type-of-an-embeddable-class">2.3.3. Access Type of an Embeddable Class</a></li>
<li><a href="#defaulted-access-types-of-embeddable-classes-and-mapped-superclasses">2.3.4. Defaulted Access Types of Embeddable Classes and Mapped Superclasses</a></li>
</ul>
</li>
<li><a href="#a132">2.4. Primary Keys and Entity Identity</a>
<ul class="sectlevel3">
<li><a href="#a149">2.4.1. Primary Keys Corresponding to Derived Identities</a>
<ul class="sectlevel4">
<li><a href="#a155">2.4.1.1. Specification of Derived Identities</a></li>
<li><a href="#mapping-of-derived-identities">2.4.1.2. Mapping of Derived Identities</a></li>
<li><a href="#examples-of-derived-identities">2.4.1.3. Examples of Derived Identities</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a487">2.5. Embeddable Classes</a></li>
<li><a href="#a494">2.6. Collections of Embeddable Classes and Basic Types</a></li>
<li><a href="#map-collections">2.7. Map Collections</a>
<ul class="sectlevel3">
<li><a href="#map-keys">2.7.1. Map Keys</a></li>
<li><a href="#map-values">2.7.2. Map Values</a></li>
</ul>
</li>
<li><a href="#a511">2.8. Mapping Defaults for Non-Relationship Fields or Properties</a></li>
<li><a href="#a516">2.9. Entity Relationships</a></li>
<li><a href="#a538">2.10. Relationship Mapping Defaults</a>
<ul class="sectlevel3">
<li><a href="#bidirectional-onetoone-relationships">2.10.1. Bidirectional OneToOne Relationships</a></li>
<li><a href="#bidirectional-manytoone-onetomany-relationships">2.10.2. Bidirectional ManyToOne / OneToMany Relationships</a></li>
<li><a href="#unidirectional-single-valued-relationships">2.10.3. Unidirectional Single-Valued Relationships</a>
<ul class="sectlevel4">
<li><a href="#a640">2.10.3.1. Unidirectional OneToOne Relationships</a></li>
<li><a href="#unidirectional-manytoone-relationships">2.10.3.2. Unidirectional ManyToOne Relationships</a></li>
</ul>
</li>
<li><a href="#a708">2.10.4. Bidirectional ManyToMany Relationships</a></li>
<li><a href="#a758">2.10.5. Unidirectional Multi-Valued Relationships</a>
<ul class="sectlevel4">
<li><a href="#a764">2.10.5.1. Unidirectional OneToMany Relationships</a></li>
<li><a href="#a800">2.10.5.2. Unidirectional ManyToMany Relationships</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#inheritance">2.11. Inheritance</a>
<ul class="sectlevel3">
<li><a href="#abstract-entity-classes">2.11.1. Abstract Entity Classes</a></li>
<li><a href="#mapped-superclasses">2.11.2. Mapped Superclasses</a></li>
<li><a href="#non-entity-classes-in-the-entity-inheritance-hierarchy">2.11.3. Non-Entity Classes in the Entity Inheritance Hierarchy</a></li>
</ul>
</li>
<li><a href="#a966">2.12. Inheritance Mapping Strategies</a>
<ul class="sectlevel3">
<li><a href="#single-table-per-class-hierarchy-strategy">2.12.1. Single Table per Class Hierarchy Strategy</a></li>
<li><a href="#joined-subclass-strategy">2.12.2. Joined Subclass Strategy</a></li>
<li><a href="#table-per-concrete-class-strategy">2.12.3. Table per Concrete Class Strategy</a></li>
</ul>
</li>
<li><a href="#a988">2.13. Naming of Database Objects</a></li>
</ul>
</li>
<li><a href="#a1060">3. Entity Operations</a>
<ul class="sectlevel2">
<li><a href="#a1062">3.1. EntityManager</a>
<ul class="sectlevel3">
<li><a href="#a1066">3.1.1. EntityManager Interface</a></li>
<li><a href="#example-of-use-of-entitymanager-api">3.1.2. Example of Use of EntityManager API</a></li>
</ul>
</li>
<li><a href="#a1929">3.2. Entity Instance&#8217;s Life Cycle</a>
<ul class="sectlevel3">
<li><a href="#entity-instance-creation">3.2.1. Entity Instance Creation</a></li>
<li><a href="#persisting-an-entity-instance">3.2.2. Persisting an Entity Instance</a></li>
<li><a href="#a1946">3.2.3. Removal</a></li>
<li><a href="#a1955">3.2.4. Synchronization to the Database</a></li>
<li><a href="#refreshing-an-entity-instance">3.2.5. Refreshing an Entity Instance</a></li>
<li><a href="#evicting-an-entity-instance-from-the-persistence-context">3.2.6. Evicting an Entity Instance from the Persistence Context</a></li>
<li><a href="#a1982">3.2.7. Detached Entities</a>
<ul class="sectlevel4">
<li><a href="#merging-detached-entity-state">3.2.7.1. Merging Detached Entity State</a></li>
<li><a href="#detached-entities-and-lazy-loading">3.2.7.2. Detached Entities and Lazy Loading</a></li>
</ul>
</li>
<li><a href="#managed-instances">3.2.8. Managed Instances</a></li>
<li><a href="#a2019">3.2.9. Load State</a></li>
</ul>
</li>
<li><a href="#a2027">3.3. Persistence Context Lifetime and Synchronization Type</a>
<ul class="sectlevel3">
<li><a href="#synchronization-with-the-current-transaction">3.3.1. Synchronization with the Current Transaction</a></li>
<li><a href="#transaction-commit">3.3.2. Transaction Commit</a></li>
<li><a href="#a2049">3.3.3. Transaction Rollback</a></li>
</ul>
</li>
<li><a href="#a2052">3.4. Locking and Concurrency</a>
<ul class="sectlevel3">
<li><a href="#a2056">3.4.1. Optimistic Locking</a></li>
<li><a href="#a2059">3.4.2. Version Attributes</a></li>
<li><a href="#a2066">3.4.3. Pessimistic Locking</a></li>
<li><a href="#a2084">3.4.4. Lock Modes</a>
<ul class="sectlevel4">
<li><a href="#a2100">3.4.4.1. OPTIMISTIC, OPTIMISTIC_FORCE_INCREMENT</a></li>
<li><a href="#a2113">3.4.4.2. PESSIMISTIC_READ, PESSIMISTIC_WRITE, PESSIMISTIC_FORCE_INCREMENT</a></li>
<li><a href="#a2132">3.4.4.3. Lock Mode Properties and Uses</a></li>
</ul>
</li>
<li><a href="#optimisticlockexception">3.4.5. OptimisticLockException</a></li>
</ul>
</li>
<li><a href="#a2153">3.5. Entity Listeners and Callback Methods</a>
<ul class="sectlevel3">
<li><a href="#entity-listeners">3.5.1. Entity Listeners</a></li>
<li><a href="#lifecycle-callback-methods">3.5.2. Lifecycle Callback Methods</a></li>
<li><a href="#a2202">3.5.3. Semantics of the Life Cycle Callback Methods for Entities</a></li>
<li><a href="#example-2">3.5.4. Example</a></li>
<li><a href="#a2251">3.5.5. Multiple Lifecycle Callback Methods for an Entity Lifecycle Event</a></li>
<li><a href="#example-3">3.5.6. Example</a></li>
<li><a href="#exceptions">3.5.7. Exceptions</a></li>
<li><a href="#specification-of-callback-listener-classes-and-lifecycle-methods-in-the-xml-descriptor">3.5.8. Specification of Callback Listener Classes and Lifecycle Methods in the XML Descriptor</a>
<ul class="sectlevel4">
<li><a href="#specification-of-callback-listeners">3.5.8.1. Specification of Callback Listeners</a></li>
<li><a href="#specification-of-the-binding-of-entity-listener-classes-to-entities">3.5.8.2. Specification of the Binding of Entity Listener Classes to Entities</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a2366">3.6. Bean Validation</a>
<ul class="sectlevel3">
<li><a href="#automatic-validation-upon-lifecycle-events">3.6.1. Automatic Validation Upon Lifecycle Events</a>
<ul class="sectlevel4">
<li><a href="#a2374">3.6.1.1. Enabling Automatic Validation</a></li>
<li><a href="#a2380">3.6.1.2. Requirements for Automatic Validation upon Lifecycle Events</a></li>
</ul>
</li>
<li><a href="#a2394">3.6.2. Providing the ValidatorFactory</a></li>
</ul>
</li>
<li><a href="#a2397">3.7. Entity Graphs</a>
<ul class="sectlevel3">
<li><a href="#entitygraph-interface">3.7.1. EntityGraph Interface</a></li>
<li><a href="#attributenode-interface">3.7.2. AttributeNode Interface</a></li>
<li><a href="#subgraph-interface">3.7.3. Subgraph Interface</a></li>
<li><a href="#a2814">3.7.4. Use of Entity Graphs in find and query operations</a>
<ul class="sectlevel4">
<li><a href="#fetch-graph-semantics">3.7.4.1. Fetch Graph Semantics</a></li>
<li><a href="#load-graph-semantics">3.7.4.2. Load Graph Semantics</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a2999">3.8. Type Conversion of Basic Attributes</a></li>
<li><a href="#a3061">3.9. Caching</a>
<ul class="sectlevel3">
<li><a href="#a3065">3.9.1. The shared-cache-mode Element</a></li>
<li><a href="#cache-retrieve-mode-and-cache-store-mode-properties">3.9.2. Cache Retrieve Mode and Cache Store Mode Properties</a></li>
</ul>
</li>
<li><a href="#a3125">3.10. Query APIs</a>
<ul class="sectlevel3">
<li><a href="#a3127">3.10.1. Query Interface</a></li>
<li><a href="#typedquery-interface">3.10.2. TypedQuery Interface</a></li>
<li><a href="#a3868">3.10.3. Tuple Interface</a></li>
<li><a href="#a3949">3.10.4. TupleElement Interface</a></li>
<li><a href="#parameter-interface">3.10.5. Parameter Interface</a></li>
<li><a href="#storedprocedurequery-interface">3.10.6. StoredProcedureQuery Interface</a></li>
<li><a href="#query-execution">3.10.7. Query Execution</a>
<ul class="sectlevel4">
<li><a href="#example-4">3.10.7.1. Example</a></li>
</ul>
</li>
<li><a href="#a4374">3.10.8. Queries and Flush Mode</a></li>
<li><a href="#a4385">3.10.9. Queries and Lock Mode</a></li>
<li><a href="#a4391">3.10.10. Query Hints</a></li>
<li><a href="#a4397">3.10.11. Parameter Objects</a></li>
<li><a href="#a4401">3.10.12. Named Parameters</a></li>
<li><a href="#a4405">3.10.13. Positional Parameters</a></li>
<li><a href="#named-queries">3.10.14. Named Queries</a></li>
<li><a href="#polymorphic-queries">3.10.15. Polymorphic Queries</a></li>
<li><a href="#a4427">3.10.16. SQL Queries</a>
<ul class="sectlevel4">
<li><a href="#returning-managed-entities-from-native-queries">3.10.16.1. Returning Managed Entities from Native Queries</a></li>
<li><a href="#returning-unmanaged-instances">3.10.16.2. Returning Unmanaged Instances</a></li>
<li><a href="#combinations-of-result-types">3.10.16.3. Combinations of Result Types</a></li>
<li><a href="#restrictions">3.10.16.4. Restrictions</a></li>
</ul>
</li>
<li><a href="#stored-procedures">3.10.17. Stored Procedures</a>
<ul class="sectlevel4">
<li><a href="#named-stored-procedure-queries">3.10.17.1. Named Stored Procedure Queries</a></li>
<li><a href="#dynamically-specified-stored-procedure-queries">3.10.17.2. Dynamically-specified Stored Procedure Queries</a></li>
<li><a href="#a4625">3.10.17.3. Stored Procedure Query Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a4639">3.11. Summary of Exceptions</a></li>
</ul>
</li>
<li><a href="#a4665">4. Query Language</a>
<ul class="sectlevel2">
<li><a href="#overview">4.1. Overview</a></li>
<li><a href="#statement-types">4.2. Statement Types</a>
<ul class="sectlevel3">
<li><a href="#select-statements">4.2.1. Select Statements</a></li>
<li><a href="#update-and-delete-statements">4.2.2. Update and Delete Statements</a></li>
</ul>
</li>
<li><a href="#abstract-schema-types-and-query-domains">4.3. Abstract Schema Types and Query Domains</a>
<ul class="sectlevel3">
<li><a href="#naming">4.3.1. Naming</a></li>
<li><a href="#a4713">4.3.2. Example</a></li>
</ul>
</li>
<li><a href="#the-from-clause-and-navigational-declarations">4.4. The FROM Clause and Navigational Declarations</a>
<ul class="sectlevel3">
<li><a href="#a4760">4.4.1. Identifiers</a></li>
<li><a href="#a4765">4.4.2. Identification Variables</a></li>
<li><a href="#range-variable-declarations">4.4.3. Range Variable Declarations</a></li>
<li><a href="#path-expressions">4.4.4. Path Expressions</a>
<ul class="sectlevel4">
<li><a href="#path-expression-syntax">4.4.4.1. Path Expression Syntax</a></li>
</ul>
</li>
<li><a href="#joins">4.4.5. Joins</a>
<ul class="sectlevel4">
<li><a href="#a4884">4.4.5.1. Inner Joins (Relationship Joins)</a></li>
<li><a href="#a4898">4.4.5.2. Left Outer Joins</a></li>
<li><a href="#a4931">4.4.5.3. Fetch Joins</a></li>
</ul>
</li>
<li><a href="#collection-member-declarations">4.4.6. Collection Member Declarations</a></li>
<li><a href="#a4957">4.4.7. FROM Clause and SQL</a></li>
<li><a href="#polymorphism">4.4.8. Polymorphism</a></li>
<li><a href="#a4965">4.4.9. Downcasting</a></li>
</ul>
</li>
<li><a href="#a4985">4.5. WHERE Clause</a></li>
<li><a href="#a4994">4.6. Conditional Expressions</a>
<ul class="sectlevel3">
<li><a href="#literals">4.6.1. Literals</a></li>
<li><a href="#identification-variables">4.6.2. Identification Variables</a></li>
<li><a href="#path-expressions-2">4.6.3. Path Expressions</a></li>
<li><a href="#input-parameters">4.6.4. Input Parameters</a>
<ul class="sectlevel4">
<li><a href="#positional-parameters">4.6.4.1. Positional Parameters</a></li>
<li><a href="#named-parameters">4.6.4.2. Named Parameters</a></li>
</ul>
</li>
<li><a href="#conditional-expression-composition">4.6.5. Conditional Expression Composition</a></li>
<li><a href="#operators-and-operator-precedence">4.6.6. Operators and Operator Precedence</a></li>
<li><a href="#a5066">4.6.7. Comparison Expressions</a></li>
<li><a href="#between-expressions">4.6.8. Between Expressions</a></li>
<li><a href="#a5107">4.6.9. In Expressions</a></li>
<li><a href="#like-expressions">4.6.10. Like Expressions</a></li>
<li><a href="#null-comparison-expressions">4.6.11. Null Comparison Expressions</a></li>
<li><a href="#a5139">4.6.12. Empty Collection Comparison Expressions</a></li>
<li><a href="#a5150">4.6.13. Collection Member Expressions</a></li>
<li><a href="#exists-expressions">4.6.14. Exists Expressions</a></li>
<li><a href="#all-or-any-expressions">4.6.15. All or Any Expressions</a></li>
<li><a href="#a5196">4.6.16. Subqueries</a></li>
<li><a href="#a5243">4.6.17. Scalar Expressions</a>
<ul class="sectlevel4">
<li><a href="#arithmetic-expressions">4.6.17.1. Arithmetic Expressions</a></li>
<li><a href="#built-in-string-arithmetic-and-datetime-functional-expressions">4.6.17.2. Built-in String, Arithmetic, and Datetime Functional Expressions</a></li>
<li><a href="#a5311">4.6.17.3. Invocation of Predefined and User-defined Database Functions</a></li>
<li><a href="#case-expressions">4.6.17.4. Case Expressions</a></li>
<li><a href="#a5381">4.6.17.5. Entity Type Expressions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a5410">4.7. GROUP BY, HAVING</a></li>
<li><a href="#a5438">4.8. SELECT Clause</a>
<ul class="sectlevel3">
<li><a href="#result-type-of-the-select-clause">4.8.1. Result Type of the SELECT Clause</a></li>
<li><a href="#a5500">4.8.2. Constructor Expressions in the SELECT Clause</a></li>
<li><a href="#null-values-in-the-query-result">4.8.3. Null Values in the Query Result</a></li>
<li><a href="#a5511">4.8.4. Embeddables in the Query Result</a></li>
<li><a href="#a5538">4.8.5. Aggregate Functions in the SELECT Clause</a>
<ul class="sectlevel4">
<li><a href="#examples">4.8.5.1. Examples</a></li>
</ul>
</li>
<li><a href="#a5574">4.8.6. Numeric Expressions in the SELECT Clause</a></li>
</ul>
</li>
<li><a href="#a5587">4.9. ORDER BY Clause</a></li>
<li><a href="#a5636">4.10. Bulk Update and Delete Operations</a></li>
<li><a href="#a5676">4.11. Null Values</a></li>
<li><a href="#a5735">4.12. Equality and Comparison Semantics</a></li>
<li><a href="#examples-2">4.13. Examples</a>
<ul class="sectlevel3">
<li><a href="#simple-queries">4.13.1. Simple Queries</a></li>
<li><a href="#queries-with-relationships">4.13.2. Queries with Relationships</a></li>
<li><a href="#queries-using-input-parameters">4.13.3. Queries Using Input Parameters</a></li>
</ul>
</li>
<li><a href="#bnf">4.14. BNF</a></li>
</ul>
</li>
<li><a href="#a6072">5. Metamodel API</a>
<ul class="sectlevel2">
<li><a href="#metamodel-api-interfaces">5.1. Metamodel API Interfaces</a>
<ul class="sectlevel3">
<li><a href="#metamodel-interface">5.1.1. Metamodel Interface</a></li>
<li><a href="#type-interface">5.1.2. Type Interface</a></li>
<li><a href="#managedtype-interface">5.1.3. ManagedType Interface</a></li>
<li><a href="#identifiabletype-interface">5.1.4. IdentifiableType Interface</a></li>
<li><a href="#entitytype-interface">5.1.5. EntityType Interface</a></li>
<li><a href="#embeddabletype-interface">5.1.6. EmbeddableType Interface</a></li>
<li><a href="#mappedsuperclasstype-interface">5.1.7. MappedSuperclassType Interface</a></li>
<li><a href="#basictype-interface">5.1.8. BasicType Interface</a></li>
<li><a href="#bindable-interface">5.1.9. Bindable Interface</a></li>
<li><a href="#attribute-interface">5.1.10. Attribute Interface</a></li>
<li><a href="#singularattribute-interface">5.1.11. SingularAttribute Interface</a></li>
<li><a href="#pluralattribute-interface">5.1.12. PluralAttribute Interface</a></li>
<li><a href="#collectionattribute-interface">5.1.13. CollectionAttribute Interface</a></li>
<li><a href="#setattribute-interface">5.1.14. SetAttribute Interface</a></li>
<li><a href="#listattribute-interface">5.1.15. ListAttribute Interface</a></li>
<li><a href="#mapattribute-interface">5.1.16. MapAttribute Interface</a></li>
<li><a href="#staticmetamodel-annotation">5.1.17. StaticMetamodel Annotation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a6925">6. Criteria API</a>
<ul class="sectlevel2">
<li><a href="#overview-2">6.1. Overview</a></li>
<li><a href="#a6933">6.2. Metamodel</a>
<ul class="sectlevel3">
<li><a href="#static-metamodel-classes">6.2.1. Static Metamodel Classes</a>
<ul class="sectlevel4">
<li><a href="#canonical-metamodel">6.2.1.1. Canonical Metamodel</a></li>
<li><a href="#a6961">6.2.1.2. Example</a></li>
</ul>
</li>
<li><a href="#bootstrapping">6.2.2. Bootstrapping</a></li>
</ul>
</li>
<li><a href="#a6997">6.3. Criteria API Interfaces</a>
<ul class="sectlevel3">
<li><a href="#criteriabuilder-interface">6.3.1. CriteriaBuilder Interface</a></li>
<li><a href="#commonabstractcriteria-interface">6.3.2. CommonAbstractCriteria Interface</a></li>
<li><a href="#abstractquery-interface">6.3.3. AbstractQuery Interface</a></li>
<li><a href="#a8857">6.3.4. CriteriaQuery Interface</a></li>
<li><a href="#criteriaupdate-interface">6.3.5. CriteriaUpdate Interface</a></li>
<li><a href="#criteriadelete-interface">6.3.6. CriteriaDelete Interface</a></li>
<li><a href="#subquery-interface">6.3.7. Subquery Interface</a></li>
<li><a href="#selection-interface">6.3.8. Selection Interface</a></li>
<li><a href="#compoundselection-interface">6.3.9. CompoundSelection Interface</a></li>
<li><a href="#expression-interface">6.3.10. Expression Interface</a></li>
<li><a href="#predicate-interface">6.3.11. Predicate Interface</a></li>
<li><a href="#path-interface">6.3.12. Path Interface</a></li>
<li><a href="#fetchparent-interface">6.3.13. FetchParent Interface</a></li>
<li><a href="#fetch-interface">6.3.14. Fetch Interface</a></li>
<li><a href="#from-interface">6.3.15. From Interface</a></li>
<li><a href="#root-interface">6.3.16. Root Interface</a></li>
<li><a href="#join-interface">6.3.17. Join Interface</a></li>
<li><a href="#jointype">6.3.18. JoinType</a></li>
<li><a href="#pluraljoin-interface">6.3.19. PluralJoin Interface</a></li>
<li><a href="#collectionjoin-interface">6.3.20. CollectionJoin Interface</a></li>
<li><a href="#setjoin-interface">6.3.21. SetJoin Interface</a></li>
<li><a href="#listjoin-interface">6.3.22. ListJoin Interface</a></li>
<li><a href="#mapjoin-interface">6.3.23. MapJoin Interface</a></li>
<li><a href="#order-interface">6.3.24. Order Interface</a></li>
<li><a href="#parameterexpression-interface">6.3.25. ParameterExpression Interface</a></li>
</ul>
</li>
<li><a href="#a10608">6.4. Criteria Query API Usage</a></li>
<li><a href="#a10614">6.5. Constructing Criteria Queries</a>
<ul class="sectlevel3">
<li><a href="#a10621">6.5.1. CriteriaQuery Creation</a></li>
<li><a href="#query-roots">6.5.2. Query Roots</a></li>
<li><a href="#a10643">6.5.3. Joins</a></li>
<li><a href="#fetch-joins">6.5.4. Fetch Joins</a></li>
<li><a href="#a16277">6.5.5. Path Navigation</a></li>
<li><a href="#restricting-the-query-result">6.5.6. Restricting the Query Result</a></li>
<li><a href="#downcasting">6.5.7. Downcasting</a></li>
<li><a href="#expressions">6.5.8. Expressions</a>
<ul class="sectlevel4">
<li><a href="#result-types-of-expressions">6.5.8.1. Result Types of Expressions</a></li>
</ul>
</li>
<li><a href="#literals-2">6.5.9. Literals</a></li>
<li><a href="#parameter-expressions">6.5.10. Parameter Expressions</a></li>
<li><a href="#a10945">6.5.11. Specifying the Select List</a>
<ul class="sectlevel4">
<li><a href="#assigning-aliases-to-selection-items">6.5.11.1. Assigning Aliases to Selection Items</a></li>
</ul>
</li>
<li><a href="#subqueries">6.5.12. Subqueries</a></li>
<li><a href="#groupby-and-having">6.5.13. GroupBy and Having</a></li>
<li><a href="#ordering-the-query-results">6.5.14. Ordering the Query Results</a></li>
<li><a href="#a11239">6.5.15. Bulk Update and Delete Operations</a></li>
</ul>
</li>
<li><a href="#a11305">6.6. Constructing Strongly-typed Queries using the jakarta.persistence.metamodel Interfaces</a></li>
<li><a href="#a11349">6.7. Use of the Criteria API with Strings to Reference Attributes</a></li>
<li><a href="#a11413">6.8. Query Modification</a></li>
<li><a href="#a11427">6.9. Query Execution</a></li>
</ul>
</li>
<li><a href="#a11431">7. Entity Managers and Persistence Contexts</a>
<ul class="sectlevel2">
<li><a href="#a11432">7.1. Persistence Contexts</a></li>
<li><a href="#obtaining-an-entitymanager">7.2. Obtaining an EntityManager</a>
<ul class="sectlevel3">
<li><a href="#obtaining-an-entity-manager-in-the-jakarta-ee-environment">7.2.1. Obtaining an Entity Manager in the Jakarta EE Environment</a></li>
<li><a href="#a11465">7.2.2. Obtaining an Application-managed Entity Manager</a></li>
</ul>
</li>
<li><a href="#obtaining-an-entity-manager-factory">7.3. Obtaining an Entity Manager Factory</a>
<ul class="sectlevel3">
<li><a href="#obtaining-an-entity-manager-factory-in-a-jakarta-ee-container">7.3.1. Obtaining an Entity Manager Factory in a Jakarta EE Container</a></li>
<li><a href="#obtaining-an-entity-manager-factory-in-a-java-se-environment">7.3.2. Obtaining an Entity Manager Factory in a Java SE Environment</a></li>
</ul>
</li>
<li><a href="#entitymanagerfactory-interface">7.4. EntityManagerFactory Interface</a></li>
<li><a href="#controlling-transactions">7.5. Controlling Transactions</a>
<ul class="sectlevel3">
<li><a href="#jta-entitymanagers">7.5.1. JTA EntityManagers</a></li>
<li><a href="#resource-local-entitymanagers">7.5.2. Resource-local EntityManagers</a></li>
<li><a href="#the-entitytransaction-interface">7.5.3. The EntityTransaction Interface</a></li>
<li><a href="#example-5">7.5.4. Example</a></li>
</ul>
</li>
<li><a href="#a11791">7.6. Container-managed Persistence Contexts</a>
<ul class="sectlevel3">
<li><a href="#a11797">7.6.1. Persistence Context Synchronization Type</a></li>
<li><a href="#a11805">7.6.2. Container-managed Transaction-scoped Persistence Context</a></li>
<li><a href="#a11810">7.6.3. Container-managed Extended Persistence Context</a>
<ul class="sectlevel4">
<li><a href="#inheritance-of-extended-persistence-context">7.6.3.1. Inheritance of Extended Persistence Context</a></li>
</ul>
</li>
<li><a href="#a11816">7.6.4. Persistence Context Propagation</a>
<ul class="sectlevel4">
<li><a href="#a11820">7.6.4.1. Requirements for Persistence Context Propagation</a></li>
</ul>
</li>
<li><a href="#examples-3">7.6.5. Examples</a>
<ul class="sectlevel4">
<li><a href="#container-managed-transaction-scoped-persistence-context">7.6.5.1. Container-managed Transaction-scoped Persistence Context</a></li>
<li><a href="#container-managed-extended-persistence-context">7.6.5.2. Container-managed Extended Persistence Context</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a11894">7.7. Application-managed Persistence Contexts</a>
<ul class="sectlevel3">
<li><a href="#examples-4">7.7.1. Examples</a>
<ul class="sectlevel4">
<li><a href="#application-managed-persistence-context-used-in-stateless-session-bean">7.7.1.1. Application-managed Persistence Context used in Stateless Session Bean</a></li>
<li><a href="#application-managed-persistence-context-used-in-stateless-session-bean-2">7.7.1.2. Application-managed Persistence Context used in Stateless Session Bean</a></li>
<li><a href="#application-managed-persistence-context-used-in-stateful-session-bean">7.7.1.3. Application-managed Persistence Context used in Stateful Session Bean</a></li>
<li><a href="#application-managed-persistence-context-with-resource-transaction">7.7.1.4. Application-managed Persistence Context with Resource Transaction</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#requirements-on-the-container">7.8. Requirements on the Container</a>
<ul class="sectlevel3">
<li><a href="#application-managed-persistence-contexts">7.8.1. Application-managed Persistence Contexts</a></li>
<li><a href="#container-managed-persistence-contexts">7.8.2. Container Managed Persistence Contexts</a></li>
</ul>
</li>
<li><a href="#a12100">7.9. Runtime Contracts between the Container and Persistence Provider</a>
<ul class="sectlevel3">
<li><a href="#container-responsibilities">7.9.1. Container Responsibilities</a></li>
<li><a href="#provider-responsibilities">7.9.2. Provider Responsibilities</a></li>
</ul>
</li>
<li><a href="#a12124">7.10. Cache Interface</a></li>
<li><a href="#a12177">7.11. PersistenceUnitUtil Interface</a></li>
</ul>
</li>
<li><a href="#a12229">8. Entity Packaging</a>
<ul class="sectlevel2">
<li><a href="#persistence-unit">8.1. Persistence Unit</a></li>
<li><a href="#a12236">8.2. Persistence Unit Packaging</a>
<ul class="sectlevel3">
<li><a href="#persistence-xml-file">8.2.1. persistence.xml file</a>
<ul class="sectlevel4">
<li><a href="#name">8.2.1.1. name</a></li>
<li><a href="#a12296">8.2.1.2. transaction-type</a></li>
<li><a href="#description">8.2.1.3. description</a></li>
<li><a href="#a12300">8.2.1.4. provider</a></li>
<li><a href="#a12302">8.2.1.5. jta-data-source, non-jta-data-source</a></li>
<li><a href="#a12305">8.2.1.6. mapping-file, jar-file, class, exclude-unlisted-classes</a></li>
<li><a href="#a12380">8.2.1.7. shared-cache-mode</a></li>
<li><a href="#a12382">8.2.1.8. validation-mode</a></li>
<li><a href="#a12384">8.2.1.9. properties</a></li>
<li><a href="#examples-5">8.2.1.10. Examples</a></li>
</ul>
</li>
<li><a href="#a12459">8.2.2. Persistence Unit Scope</a></li>
</ul>
</li>
<li><a href="#persistence-xml-schema">8.3. persistence.xml Schema</a></li>
</ul>
</li>
<li><a href="#container-and-provider-contracts-for-deployment-and-bootstrapping">9. Container and Provider Contracts for Deployment and Bootstrapping</a>
<ul class="sectlevel2">
<li><a href="#a12802">9.1. Jakarta EE Deployment</a></li>
<li><a href="#bootstrapping-in-java-se-environments">9.2. Bootstrapping in Java SE Environments</a>
<ul class="sectlevel3">
<li><a href="#schema-generation">9.2.1. Schema Generation</a></li>
</ul>
</li>
<li><a href="#a12837">9.3. Determining the Available Persistence Providers</a>
<ul class="sectlevel3">
<li><a href="#persistenceproviderresolver-interface">9.3.1. PersistenceProviderResolver interface</a></li>
<li><a href="#persistenceproviderresolverholder-class">9.3.2. PersistenceProviderResolverHolder class</a></li>
</ul>
</li>
<li><a href="#a12917">9.4. Schema Generation</a>
<ul class="sectlevel3">
<li><a href="#data-loading">9.4.1. Data Loading</a></li>
</ul>
</li>
<li><a href="#responsibilities-of-the-persistence-provider">9.5. Responsibilities of the Persistence Provider</a>
<ul class="sectlevel3">
<li><a href="#jakarta-persistence-spi-persistenceprovider">9.5.1. jakarta.persistence.spi.PersistenceProvider</a></li>
<li><a href="#jakarta-persistence-spi-providerutil">9.5.2. jakarta.persistence.spi.ProviderUtil</a></li>
</ul>
</li>
<li><a href="#a13160">9.6. jakarta.persistence.spi.PersistenceUnitInfo Interface</a>
<ul class="sectlevel3">
<li><a href="#jakarta-persistence-spi-classtransformer-interface">9.6.1. jakarta.persistence.spi.ClassTransformer Interface</a></li>
</ul>
</li>
<li><a href="#a13443">9.7. jakarta.persistence.Persistence Class</a></li>
<li><a href="#persistenceutil-interface">9.8. PersistenceUtil Interface</a>
<ul class="sectlevel3">
<li><a href="#a13592">9.8.1. Contracts for Determining the Load State of an Entity or Entity Attribute</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#metadata-annotations">10. Metadata Annotations</a>
<ul class="sectlevel2">
<li><a href="#entity">10.1. Entity</a></li>
<li><a href="#callback-annotations">10.2. Callback Annotations</a></li>
<li><a href="#a13662">10.3. EntityGraph Annotations</a>
<ul class="sectlevel3">
<li><a href="#namedentitygraph-and-namedentitygraphs-annotations">10.3.1. NamedEntityGraph and NamedEntityGraphs Annotations</a></li>
<li><a href="#namedattributenode-annotation">10.3.2. NamedAttributeNode Annotation</a></li>
<li><a href="#namedsubgraph-annotation">10.3.3. NamedSubgraph Annotation</a></li>
</ul>
</li>
<li><a href="#a13710">10.4. Annotations for Queries</a>
<ul class="sectlevel3">
<li><a href="#a13711">10.4.1. NamedQuery Annotation</a></li>
<li><a href="#namednativequery-annotation">10.4.2. NamedNativeQuery Annotation</a></li>
<li><a href="#a13759">10.4.3. NamedStoredProcedureQuery Annotation</a></li>
<li><a href="#a13797">10.4.4. Annotations for SQL Result Set Mappings</a></li>
</ul>
</li>
<li><a href="#references-to-entitymanager-and-entitymanagerfactory">10.5. References to EntityManager and EntityManagerFactory</a>
<ul class="sectlevel3">
<li><a href="#persistencecontext-annotation">10.5.1. PersistenceContext Annotation</a></li>
<li><a href="#a13887">10.5.2. PersistenceUnit Annotation</a></li>
</ul>
</li>
<li><a href="#a13903">10.6. Annotations for Type Converter Classes</a></li>
</ul>
</li>
<li><a href="#a13915">11. Metadata for Object/Relational Mapping</a>
<ul class="sectlevel2">
<li><a href="#annotations-for-objectrelational-mapping">11.1. Annotations for Object/Relational Mapping</a>
<ul class="sectlevel3">
<li><a href="#access-annotation">11.1.1. Access Annotation</a></li>
<li><a href="#a13942">11.1.2. AssociationOverride Annotation</a></li>
<li><a href="#associationoverrides-annotation">11.1.3. AssociationOverrides Annotation</a></li>
<li><a href="#a14084">11.1.4. AttributeOverride Annotation</a></li>
<li><a href="#a14178">11.1.5. AttributeOverrides Annotation</a></li>
<li><a href="#a14205">11.1.6. Basic Annotation</a></li>
<li><a href="#cacheable-annotation">11.1.7. Cacheable Annotation</a></li>
<li><a href="#a14250">11.1.8. CollectionTable Annotation</a></li>
<li><a href="#a14330">11.1.9. Column Annotation</a></li>
<li><a href="#a14398">11.1.10. Convert Annotation</a></li>
<li><a href="#converts-annotation">11.1.11. Converts Annotation</a></li>
<li><a href="#a14530">11.1.12. DiscriminatorColumn Annotation</a></li>
<li><a href="#discriminatorvalue-annotation">11.1.13. DiscriminatorValue Annotation</a></li>
<li><a href="#elementcollection-annotation">11.1.14. ElementCollection Annotation</a></li>
<li><a href="#a14634">11.1.15. Embeddable Annotation</a></li>
<li><a href="#a14672">11.1.16. Embedded Annotation</a></li>
<li><a href="#a14687">11.1.17. EmbeddedId Annotation</a></li>
<li><a href="#a14719">11.1.18. Enumerated Annotation</a></li>
<li><a href="#a14754">11.1.19. ForeignKey Annotation</a></li>
<li><a href="#a14790">11.1.20. GeneratedValue Annotation</a></li>
<li><a href="#a14827">11.1.21. Id Annotation</a></li>
<li><a href="#a14836">11.1.22. IdClass Annotation</a></li>
<li><a href="#a14862">11.1.23. Index Annotation</a></li>
<li><a href="#a14891">11.1.24. Inheritance Annotation</a></li>
<li><a href="#a14922">11.1.25. JoinColumn Annotation</a></li>
<li><a href="#joincolumns-annotation">11.1.26. JoinColumns Annotation</a></li>
<li><a href="#a15022">11.1.27. JoinTable Annotation</a></li>
<li><a href="#a15087">11.1.28. Lob Annotation</a></li>
<li><a href="#a15100">11.1.29. ManyToMany Annotation</a></li>
<li><a href="#manytoone-annotation">11.1.30. ManyToOne Annotation</a></li>
<li><a href="#mapkey-annotation">11.1.31. MapKey Annotation</a></li>
<li><a href="#mapkeyclass-annotation">11.1.32. MapKeyClass Annotation</a></li>
<li><a href="#a15367">11.1.33. MapKeyColumn Annotation</a></li>
<li><a href="#a15433">11.1.34. MapKeyEnumerated Annotation</a></li>
<li><a href="#a15450">11.1.35. MapKeyJoinColumn Annotation</a></li>
<li><a href="#mapkeyjoincolumns-annotation">11.1.36. MapKeyJoinColumns Annotation</a></li>
<li><a href="#a15583">11.1.37. MapKeyTemporal Annotation</a></li>
<li><a href="#mappedsuperclass-annotation">11.1.38. MappedSuperclass Annotation</a></li>
<li><a href="#mapsid-annotation">11.1.39. MapsId Annotation</a></li>
<li><a href="#onetomany-annotation">11.1.40. OneToMany Annotation</a></li>
<li><a href="#onetoone-annotation">11.1.41. OneToOne Annotation</a></li>
<li><a href="#orderby-annotation">11.1.42. OrderBy Annotation</a></li>
<li><a href="#a15873">11.1.43. OrderColumn Annotation</a></li>
<li><a href="#a15947">11.1.44. PrimaryKeyJoinColumn Annotation</a></li>
<li><a href="#primarykeyjoincolumns-annotation">11.1.45. PrimaryKeyJoinColumns Annotation</a></li>
<li><a href="#a16062">11.1.46. SecondaryTable Annotation</a></li>
<li><a href="#secondarytables-annotation">11.1.47. SecondaryTables Annotation</a></li>
<li><a href="#a16164">11.1.48. SequenceGenerator Annotation</a></li>
<li><a href="#a16205">11.1.49. SequenceGenerators Annotation</a></li>
<li><a href="#table-annotation">11.1.50. Table Annotation</a></li>
<li><a href="#a16256">11.1.51. TableGenerator Annotation</a></li>
<li><a href="#tablegenerators-annotation">11.1.52. TableGenerators Annotation</a></li>
<li><a href="#a16361">11.1.53. Temporal Annotation</a></li>
<li><a href="#transient-annotation">11.1.54. Transient Annotation</a></li>
<li><a href="#a16403">11.1.55. UniqueConstraint Annotation</a></li>
<li><a href="#a16432">11.1.56. Version Annotation</a></li>
</ul>
</li>
<li><a href="#a16444">11.2. Object/Relational Metadata Used in Schema Generation</a>
<ul class="sectlevel3">
<li><a href="#table-level-elements">11.2.1. Table-level elements</a>
<ul class="sectlevel4">
<li><a href="#table">11.2.1.1. Table</a></li>
<li><a href="#inheritance-2">11.2.1.2. Inheritance</a></li>
<li><a href="#secondarytable">11.2.1.3. SecondaryTable</a></li>
<li><a href="#collectiontable">11.2.1.4. CollectionTable</a></li>
<li><a href="#jointable">11.2.1.5. JoinTable</a></li>
<li><a href="#tablegenerator">11.2.1.6. TableGenerator</a></li>
</ul>
</li>
<li><a href="#column-level-elements">11.2.2. Column-level elements</a>
<ul class="sectlevel4">
<li><a href="#column">11.2.2.1. Column</a></li>
<li><a href="#mapkeycolumn">11.2.2.2. MapKeyColumn</a></li>
<li><a href="#enumerated-mapkeyenumerated">11.2.2.3. Enumerated, MapKeyEnumerated</a></li>
<li><a href="#temporal-mapkeytemporal">11.2.2.4. Temporal, MapKeyTemporal</a></li>
<li><a href="#lob">11.2.2.5. Lob</a></li>
<li><a href="#ordercolumn">11.2.2.6. OrderColumn</a></li>
<li><a href="#discriminatorcolumn">11.2.2.7. DiscriminatorColumn</a></li>
<li><a href="#version">11.2.2.8. Version</a></li>
</ul>
</li>
<li><a href="#primary-key-mappings">11.2.3. Primary Key mappings</a>
<ul class="sectlevel4">
<li><a href="#id">11.2.3.1. Id</a></li>
<li><a href="#embeddedid">11.2.3.2. EmbeddedId</a></li>
<li><a href="#generatedvalue">11.2.3.3. GeneratedValue</a></li>
</ul>
</li>
<li><a href="#foreign-key-column-mappings">11.2.4. Foreign Key Column Mappings</a>
<ul class="sectlevel4">
<li><a href="#joincolumn">11.2.4.1. JoinColumn</a></li>
<li><a href="#mapkeyjoincolumn">11.2.4.2. MapKeyJoinColumn</a></li>
<li><a href="#a16567">11.2.4.3. PrimaryKeyJoinColumn</a></li>
<li><a href="#foreignkey">11.2.4.4. ForeignKey</a></li>
</ul>
</li>
<li><a href="#other-elements">11.2.5. Other Elements</a>
<ul class="sectlevel4">
<li><a href="#sequencegenerator">11.2.5.1. SequenceGenerator</a></li>
<li><a href="#index">11.2.5.2. Index</a></li>
<li><a href="#uniqueconstraint">11.2.5.3. UniqueConstraint</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#examples-of-the-application-of-annotations-for-objectrelational-mapping">11.3. Examples of the Application of Annotations for Object/Relational Mapping</a>
<ul class="sectlevel3">
<li><a href="#examples-of-simple-mappings">11.3.1. Examples of Simple Mappings</a></li>
<li><a href="#a-more-complex-example">11.3.2. A More Complex Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a16944">12. XML Object/Relational Mapping Descriptor</a>
<ul class="sectlevel2">
<li><a href="#use-of-the-xml-descriptor">12.1. Use of the XML Descriptor</a></li>
<li><a href="#a16953">12.2. XML Overriding Rules</a>
<ul class="sectlevel3">
<li><a href="#persistence-unit-defaults-subelements">12.2.1. persistence-unit-defaults Subelements</a>
<ul class="sectlevel4">
<li><a href="#schema">12.2.1.1. schema</a></li>
<li><a href="#catalog">12.2.1.2. catalog</a></li>
<li><a href="#delimited-identifiers">12.2.1.3. delimited-identifiers</a></li>
<li><a href="#access">12.2.1.4. access</a></li>
<li><a href="#cascade-persist">12.2.1.5. cascade-persist</a></li>
<li><a href="#entity-listeners-2">12.2.1.6. entity-listeners</a></li>
</ul>
</li>
<li><a href="#other-subelements-of-the-entity-mappings-element">12.2.2. Other Subelements of the entity-mappings element</a>
<ul class="sectlevel4">
<li><a href="#package">12.2.2.1. package</a></li>
<li><a href="#schema-2">12.2.2.2. schema</a></li>
<li><a href="#catalog-2">12.2.2.3. catalog</a></li>
<li><a href="#access-2">12.2.2.4. access</a></li>
<li><a href="#sequence-generator">12.2.2.5. sequence-generator</a></li>
<li><a href="#table-generator">12.2.2.6. table-generator</a></li>
<li><a href="#named-query">12.2.2.7. named-query</a></li>
<li><a href="#named-native-query">12.2.2.8. named-native-query</a></li>
<li><a href="#named-stored-procedure-query">12.2.2.9. named-stored-procedure-query</a></li>
<li><a href="#sql-result-set-mapping">12.2.2.10. sql-result-set-mapping</a></li>
<li><a href="#entity-2">12.2.2.11. entity</a></li>
<li><a href="#mapped-superclass">12.2.2.12. mapped-superclass</a></li>
<li><a href="#embeddable">12.2.2.13. embeddable</a></li>
<li><a href="#converter">12.2.2.14. converter</a></li>
</ul>
</li>
<li><a href="#a17017">12.2.3. entity Subelements and Attributes</a>
<ul class="sectlevel4">
<li><a href="#metadata-complete">12.2.3.1. metadata-complete</a></li>
<li><a href="#access-3">12.2.3.2. access</a></li>
<li><a href="#cacheable">12.2.3.3. cacheable</a></li>
<li><a href="#name-2">12.2.3.4. name</a></li>
<li><a href="#table-2">12.2.3.5. table</a></li>
<li><a href="#secondary-table">12.2.3.6. secondary-table</a></li>
<li><a href="#primary-key-join-column">12.2.3.7. primary-key-join-column</a></li>
<li><a href="#id-class">12.2.3.8. id-class</a></li>
<li><a href="#inheritance-3">12.2.3.9. inheritance</a></li>
<li><a href="#discriminator-value">12.2.3.10. discriminator-value</a></li>
<li><a href="#discriminator-column">12.2.3.11. discriminator-column</a></li>
<li><a href="#sequence-generator-2">12.2.3.12. sequence-generator</a></li>
<li><a href="#table-generator-2">12.2.3.13. table-generator</a></li>
<li><a href="#attribute-override">12.2.3.14. attribute-override</a></li>
<li><a href="#association-override">12.2.3.15. association-override</a></li>
<li><a href="#convert">12.2.3.16. convert</a></li>
<li><a href="#named-entity-graph">12.2.3.17. named-entity-graph</a></li>
<li><a href="#named-query-2">12.2.3.18. named-query</a></li>
<li><a href="#named-native-query-2">12.2.3.19. named-native-query</a></li>
<li><a href="#named-stored-procedure-query-2">12.2.3.20. named-stored-procedure-query</a></li>
<li><a href="#sql-result-set-mapping-2">12.2.3.21. sql-result-set-mapping</a></li>
<li><a href="#exclude-default-listeners">12.2.3.22. exclude-default-listeners</a></li>
<li><a href="#exclude-superclass-listeners">12.2.3.23. exclude-superclass-listeners</a></li>
<li><a href="#entity-listeners-3">12.2.3.24. entity-listeners</a></li>
<li><a href="#pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load">12.2.3.25. pre-persist, post-persist, pre-remove, post-remove, pre-update, post-update, post-load</a></li>
<li><a href="#a17082">12.2.3.26. attributes</a></li>
</ul>
</li>
<li><a href="#a17106">12.2.4. mapped-superclass Subelements and Attributes</a>
<ul class="sectlevel4">
<li><a href="#metadata-complete-2">12.2.4.1. metadata-complete</a></li>
<li><a href="#access-4">12.2.4.2. access</a></li>
<li><a href="#id-class-2">12.2.4.3. id-class</a></li>
<li><a href="#exclude-default-listeners-2">12.2.4.4. exclude-default-listeners</a></li>
<li><a href="#exclude-superclass-listeners-2">12.2.4.5. exclude-superclass-listeners</a></li>
<li><a href="#entity-listeners-4">12.2.4.6. entity-listeners</a></li>
<li><a href="#pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load-2">12.2.4.7. pre-persist, post-persist, pre-remove, post-remove, pre-update, post-update, post-load</a></li>
<li><a href="#attributes">12.2.4.8. attributes</a></li>
</ul>
</li>
<li><a href="#a17150">12.2.5. embeddable Subelements and Attributes</a>
<ul class="sectlevel4">
<li><a href="#metadata-complete-3">12.2.5.1. metadata-complete</a></li>
<li><a href="#access-5">12.2.5.2. access</a></li>
<li><a href="#a17157">12.2.5.3. attributes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#a17175">12.3. XML Schema</a></li>
</ul>
</li>
<li><a href="#related-documents">Related Documents</a></li>
<li><a href="#revision-history">Appendix A: Revision History</a>
<ul class="sectlevel2">
<li><a href="#maintenance-release-draft">A.1. Maintenance Release Draft</a></li>
<li><a href="#jakarta-persistence-3-0">A.2. Jakarta Persistence 3.0</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre>Specification: Jakarta Persistence

Version: 3.0

Status: Final Release

Release: September 08, 2020</pre>
</div>
</div>
<div class="paragraph">
<p>Copyright (c) 2019, 2020 Eclipse Foundation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="eclipse-foundation-specification-license"><a class="anchor" href="#eclipse-foundation-specification-license"></a>Eclipse Foundation Specification License</h3>
<div class="paragraph">
<p>By using and/or copying this document, or the Eclipse Foundation
document from which this statement is linked, you (the licensee) agree
that you have read, understood, and will comply with the following
terms and conditions:</p>
</div>
<div class="paragraph">
<p>Permission to copy, and distribute the contents of this document, or
the Eclipse Foundation document from which this statement is linked, in
any medium for any purpose and without fee or royalty is hereby
granted, provided that you include the following on ALL copies of the
document, or portions thereof, that you use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>link or URL to the original Eclipse Foundation document.</p>
</li>
<li>
<p>All existing copyright notices, or if one does not exist, a notice
(hypertext is preferred, but a textual representation is permitted)
of the form: "Copyright (c) [$date-of-document]
Eclipse Foundation, Inc. <a href="#url to this license">[url to this license]</a>"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Inclusion of the full text of this NOTICE must be provided. We
request that authorship attribution be provided in any software,
documents, or other items or products that you create pursuant to the
implementation of the contents of this document, or any portion
thereof.</p>
</div>
<div class="paragraph">
<p>No right to create modifications or derivatives of Eclipse Foundation
documents is granted pursuant to this license, except anyone may
prepare and distribute derivative works and portions of this document
in software that implements the specification, in supporting materials
accompanying such software, and in documentation of such software,
PROVIDED that all such works include the notice below. HOWEVER, the
publication of derivative works of this document for use as a technical
specification is expressly prohibited.</p>
</div>
<div class="paragraph">
<p>The notice is:</p>
</div>
<div class="paragraph">
<p>"Copyright (c) 2018 Eclipse Foundation. This software or
document includes material copied from or derived from [title and URI
of the Eclipse Foundation specification document]."</p>
</div>
<div class="sect3">
<h4 id="disclaimers"><a class="anchor" href="#disclaimers"></a>Disclaimers</h4>
<div class="paragraph">
<p>THIS DOCUMENT IS PROVIDED &quot;AS IS,&quot; AND THE COPYRIGHT
HOLDERS AND THE ECLIPSE FOUNDATION MAKE NO REPRESENTATIONS OR
WARRANTIES, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
NON-INFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THE DOCUMENT ARE
SUITABLE FOR ANY PURPOSE; NOR THAT THE IMPLEMENTATION OF SUCH CONTENTS
WILL NOT INFRINGE ANY THIRD PARTY PATENTS, COPYRIGHTS, TRADEMARKS OR
OTHER RIGHTS.</p>
</div>
<div class="paragraph">
<p>THE COPYRIGHT HOLDERS AND THE ECLIPSE FOUNDATION WILL NOT BE LIABLE
FOR ANY DIRECT, INDIRECT, SPECIAL OR CONSEQUENTIAL DAMAGES ARISING OUT
OF ANY USE OF THE DOCUMENT OR THE PERFORMANCE OR IMPLEMENTATION OF THE
CONTENTS THEREOF.</p>
</div>
<div class="paragraph">
<p>The name and trademarks of the copyright holders or the Eclipse
Foundation may NOT be used in advertising or publicity pertaining to
this document or its contents without specific, written prior
permission. Title to copyright in this document will at all times
remain with copyright holders.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="scope"><a class="anchor" href="#scope"></a>Scope</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jakarta Persistence defines a standard for management of persistence
and object/relational mapping in Java&#174; environments.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document is the specification of the
Jakarta API for the management of persistence and object/relational mapping
with Jakarta EE and Java SE. The technical objective of this work is to
provide an object/relational mapping facility for the Java application
developer using a Java domain model to manage a relational database.</p>
</div>
<div class="paragraph">
<p>The Jakarta Persistence 3.0 specification is the first release after
moving the project to Eclipse Foundation. All APIs are moved from <em>javax.*</em>
package to <em>jakarta.*</em> package. All properties containing <em>javax</em> as
part of the name are renamed the way that <em>javax</em> is replaced with <em>jakarta</em>.</p>
</div>
<div class="paragraph">
<p>The Java Persistence 2.2 specification
enhances the Jakarta Persistence API with support for repeating
annotations; injection into attribute converters; support for mapping of
the <em>java.time.LocalDate</em>, <em>java.time.LocalTime</em>, <em>java.time.LocalDateTime</em>,
<em>java.time.OffsetTime</em>, and <em>java.time.OffsetDateTime</em> types; and methods to
retrieve the results of <em>Query</em> and <em>TypedQuery</em> as streams.</p>
</div>
<div class="paragraph">
<p>The Java Persistence 2.1 specification added
support for schema generation, type conversion methods, use of entity
graphs in queries and find operations, unsynchronized persistence
contexts, stored procedure invocation, and injection into entity
listener classes. It also includes enhancements to the Java Persistence
query language, the Criteria API, and to the mapping of native queries.</p>
</div>
<div class="sect2">
<h3 id="expert-group"><a class="anchor" href="#expert-group"></a>1.1. Expert Group</h3>
<div class="paragraph">
<p>This revision to the JPA specification is
based on JPA 2.1, whose work was conducted as part of JSR 338 under the
Java Community Process Program. This specification is the result of the
collaborative work of the members of the JSR 338 Expert Group: akquinet
tech@Spree: Michael Bouschen; Ericsson: Nicolas Seyvet; IBM: Kevin
Sutter, Pinaki Poddar; OW2: Florent Benoit; Oracle: Linda DeMichiel,
Gordon Yorke, Michael Keith; Pramati Technologies: Deepak Anupalli; Red
Hat, Inc.: Emmanuel Bernard, Steve Ebersole, Scott Marlow; SAP AG:
Rainer Schweigkoffer; Sybase: Evan Ireland; Tmax Soft Inc.: Miju Byon;
Versant: Christian von Kutzleben; VMware: Oliver Gierke; individual
members: Matthew Adams; Adam Bien; Bernd Mueller; Werner Keil.</p>
</div>
<div class="paragraph">
<p>The work of the JSR 338 Expert Group was
conducted using the jpa-spec.java.net project.</p>
</div>
</div>
<div class="sect2">
<h3 id="document-conventions"><a class="anchor" href="#document-conventions"></a>1.2. Document Conventions</h3>
<div class="paragraph">
<p>The regular Times font is used for
information that is prescriptive by this specification.</p>
</div>
<div class="paragraph">
<p><em>The italic Times font is used for paragraphs
that contain descriptive information, such as notes describing typical
use, or notes clarifying the text with prescriptive specification.</em></p>
</div>
<div class="paragraph">
<p>A monospaced font is used for code examples and to specify the BNF of the
Jakarta Persistence query language.</p>
</div>
<div class="paragraph">
<p>This document is written in terms of the
use of Java language metadata annotations. An XML descriptor (as
specified in <a href="#a16944">Chapter 12</a>) may be used as an alternative to
annotations or to augment or override annotations. The elements of this
descriptor mirror the annotations and have the same semantics. When
semantic requirements are written in terms of annotations, it should be
understood that the same semantics apply when the XML descriptor is used
as an alternative.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entities"><a class="anchor" href="#entities"></a>2. Entities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An entity is a lightweight persistent domain object.</p>
</div>
<div class="paragraph">
<p>The primary programming artifact is the
entity class. An entity class may make use of auxiliary classes that
serve as helper classes or that are used to represent the state of the
entity.</p>
</div>
<div class="paragraph">
<p>This chapter describes requirements on entity
classes and instances.</p>
</div>
<div class="sect2">
<h3 id="a18"><a class="anchor" href="#a18"></a>2.1. The Entity Class</h3>
<div class="paragraph">
<p>The entity class must be annotated with the
<em>Entity</em> annotation or denoted in the XML descriptor as an entity.</p>
</div>
<div class="paragraph">
<p>The entity class must have a no-arg
constructor. The entity class may have other constructors as well. The
no-arg constructor must be public or protected.</p>
</div>
<div class="paragraph">
<p>The entity class must be a top-level class.
An enum or interface must not be designated as an entity.</p>
</div>
<div class="paragraph">
<p>The entity class must not be final. No
methods or persistent instance variables of the entity class may be
final.</p>
</div>
<div class="paragraph">
<p>If an entity instance is to be passed by
value as a detached object (e.g., through a remote interface), the
entity class must implement the <em>Serializable</em> interface.</p>
</div>
<div class="paragraph">
<p>Entities support inheritance, polymorphic
associations, and polymorphic queries.</p>
</div>
<div class="paragraph">
<p>Both abstract and concrete classes can be
entities. Entities may extend non-entity classes as well as entity
classes, and non-entity classes may extend entity classes.</p>
</div>
<div class="paragraph">
<p>The persistent state of an entity is
represented by instance variables, which may correspond to JavaBeans
properties. An instance variable must be directly accessed only from
within the methods of the entity by the entity instance itself. Instance
variables must not be accessed by clients of the entity. The state of
the entity is available to clients only through the entity&#8217;s
methods—i.e., accessor methods (getter/setter methods) or other business
methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="persistent-fields-and-properties"><a class="anchor" href="#persistent-fields-and-properties"></a>2.2. Persistent Fields and Properties</h3>
<div class="paragraph">
<p>The persistent state of an entity is accessed
by the persistence provider runtime<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> either via
JavaBeans style property accessors (“property access”) or via instance
variables (“field access”). Whether persistent properties or persistent
fields or a combination of the two is used for the provider&#8217;s access to
a given class or entity hierarchy is determined as described in <a href="#a113">Section 2.3</a>.</p>
</div>
<div class="paragraph">
<p>Terminology Note: The persistent fields and
properties of an entity class are generically referred to in this
document as the “attributes” of the class.</p>
</div>
<div class="paragraph">
<p>The instance variables of a class must be
private, protected, or package visibility independent of whether field
access or property access is used. When property access is used, the
property accessor methods must be public or protected.</p>
</div>
<div class="paragraph">
<p>It is required that the entity class follow
the method signature conventions for JavaBeans read/write properties (as
defined by the JavaBeans Introspector class) for persistent properties
when property access is used.</p>
</div>
<div class="paragraph">
<p>In this case, for every persistent
property <em>property</em> of type <em>T</em> of the entity, there is a getter method,
<em>getProperty</em>, and setter method <em>setProperty</em>. For boolean
properties, <em>isProperty</em> may be used as an alternative name for the
getter method.<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
<div class="paragraph">
<p>For single-valued persistent properties,
these method signatures are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">T getProperty()

<span class="type">void</span> setProperty(T t)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Collection-valued persistent fields and
properties must be defined in terms of one of the following
collection-valued interfaces regardless of whether the entity class
otherwise adheres to the JavaBeans method conventions noted above and
whether field or property access is used: <em>java.util.Collection</em>,
<em>java.util.Set</em>, <em>java.util.List</em> <sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup>,
<em>java.util.Map</em>. The collection implementation type may be used by the
application to initialize fields or properties before the entity is made
persistent. Once the entity becomes managed (or detached), subsequent
access must be through the interface type.</p>
</div>
<div class="paragraph">
<p>Terminology Note: The terms “collection” and
“collection-valued” are used in this specification to denote any of the
above types unless further qualified. In cases where a
<em>java.util.Collection</em> type (or one of its subtypes) is to be
distinguished, the type is identified as such. The terms “map” and “map
collection” are used to apply to a collection of type <em>java.util.Map</em>
when a collection of type <em>java.util.Map</em> needs to be distinguished as
such.</p>
</div>
<div class="paragraph">
<p>For collection-valued persistent properties,
type <em>T</em> must be one of these collection interface types in the method
signatures above. Use of the generic variants of these collection types
is encouraged (for example, <em>Set&lt;Order&gt;</em>).</p>
</div>
<div class="paragraph">
<p>In addition to returning and setting the
persistent state of the instance, property accessor methods may contain
other business logic as well, for example, to perform validation. The
persistence provider runtime executes this logic when property-based
access is used.</p>
</div>
<div class="paragraph">
<p>Caution should be exercised in adding
business logic to the accessor methods when property access is used. The
order in which the persistence provider runtime calls these methods when
loading or storing persistent state is not defined. Logic contained in
such methods therefore should not rely upon a specific invocation order.</p>
</div>
<div class="paragraph">
<p>If property access is used and lazy
fetching is specified, portable applications should not directly access
the entity state underlying the property methods of managed instances
until after it has been fetched by the persistence
provider.<sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p>
</div>
<div class="paragraph">
<p>If a persistence context is joined to a
transaction, runtime exceptions thrown by property accessor methods
cause the current transaction to be marked for rollback; exceptions
thrown by such methods when used by the persistence runtime to load or
store persistent state cause the persistence runtime to mark the current
transaction for rollback and to throw a <em>PersistenceException</em> that
wraps the application exception.</p>
</div>
<div class="paragraph">
<p>Entity subclasses may override the property
accessor methods. However, portable applications must not override the
object/relational mapping metadata that applies to the persistent fields
or properties of entity superclasses.</p>
</div>
<div class="paragraph">
<p>The persistent fields or properties of an
entity may be of the following types: Java primitive types,
<em>java.lang.String</em>, other Java serializable types (including wrappers
of the primitive types, <em>java.math.BigInteger</em>, <em>java.math.BigDecimal</em>
, <em>java.util.Date</em>, <em>java.util.Calendar<sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup></em>,
<em>java.sql.Date</em>, <em>java.sql.Time</em>, <em>java.sql.Timestamp</em>, <em>byte[]</em>,
<em>Byte[]</em>, <em>char[]</em>, <em>Character[]</em>, <em>java.time.LocalDate</em>,
<em>java.time.LocalTime</em>, <em>java.time.LocalDateTime</em>,
<em>java.time.OffsetTime</em>, <em>java.time.OffsetDateTime</em>, and user-defined
types that implement the <em>Serializable</em> interface <em>)</em>; enums; entity
types; collections of entity types; embeddable classes (see <a href="#a487">Section 2.5</a>); collections of
basic and embeddable types (see <a href="#a494">Section 2.6</a>).</p>
</div>
<div class="paragraph">
<p>Object/relational mapping metadata may be
specified to customize the object/relational mapping and the loading and
storing of the entity state and relationships. See <a href="#a13915">Chapter 11</a>.</p>
</div>
<div class="sect3">
<h4 id="example"><a class="anchor" href="#example"></a>2.2.1. Example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="directive">private</span> Address address;
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Order&gt; orders = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();
    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;PhoneNumber&gt; phones = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="comment">// No-arg constructor</span>
    <span class="directive">public</span> Customer() {}

    <span class="annotation">@Id</span> <span class="comment">// property access is used</span>
    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> Address getAddress() {
        <span class="keyword">return</span> address;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) {
        <span class="local-variable">this</span>.address = address;
    }

    <span class="annotation">@OneToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Order&gt; getOrders() {
        <span class="keyword">return</span> orders;
    }

    <span class="directive">public</span> <span class="type">void</span> setOrders(<span class="predefined-type">Collection</span>&lt;Order&gt; orders) {
        <span class="local-variable">this</span>.orders = orders;
    }

    <span class="annotation">@ManyToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;PhoneNumber&gt; getPhones() {
        <span class="keyword">return</span> phones;
    }

    <span class="directive">public</span> <span class="type">void</span> setPhones(<span class="predefined-type">Set</span>&lt;PhoneNumber&gt; phones) {
        <span class="local-variable">this</span>.phones = phones;
    }

    <span class="comment">// Business method to add a phone number to the customer</span>
    <span class="directive">public</span> <span class="type">void</span> addPhone(PhoneNumber phone) {
        <span class="local-variable">this</span>.getPhones().add(phone);

        <span class="comment">// Update the phone entity instance to refer to this customer</span>
        phone.addCustomer(<span class="local-variable">this</span>);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a113"><a class="anchor" href="#a113"></a>2.3. Access Type</h3>
<div class="sect3">
<h4 id="default-access-type"><a class="anchor" href="#default-access-type"></a>2.3.1. Default Access Type</h4>
<div class="paragraph">
<p>By default, a single access type (field or
property access) applies to an entity hierarchy. The default access type
of an entity hierarchy is determined by the placement of mapping
annotations on the attributes of the entity classes and mapped
superclasses of the entity hierarchy that do not explicitly specify an
access type. An access type is explicitly specified by means of the
<em>Access</em> annotation<sup class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup>, as described in <a href="#a122">Section 2.3.2</a>.</p>
</div>
<div class="paragraph">
<p>When annotations are used to define a default
access type, the placement of the mapping annotations on either the
persistent fields or persistent properties of the entity class specifies
the access type as being either field- or property-based access
respectively.</p>
</div>
<div class="paragraph">
<p>When field-based access is used, the
object/relational mapping annotations for the entity class annotate the
instance variables, and the persistence provider runtime accesses
instance variables directly. All non- <em>transient</em> instance variables
that are not annotated with the <em>Transient</em> annotation are persistent.</p>
</div>
<div class="paragraph">
<p>When property-based access is used, the
object/relational mapping annotations for the entity class annotate the
getter property accessors<sup class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup>, and the persistence
provider runtime accesses persistent state via the property accessor
methods. All properties not annotated with the <em>Transient</em> annotation
are persistent.</p>
</div>
<div class="paragraph">
<p>Mapping annotations must not be applied to
fields or properties that are <em>transient</em> or <em>Transient</em>.</p>
</div>
<div class="paragraph">
<p>All such classes in the entity hierarchy
whose access type is defaulted in this way must be consistent in their
placement of annotations on either fields or properties, such that a
single, consistent default access type applies within the hierarchy. Any
embeddable classes used by such classes will have the same access type
as the default access type of the hierarchy unless the <em>Access</em>
annotation is specified as defined below.</p>
</div>
<div class="paragraph">
<p>It is an error if a default access type
cannot be determined and an access type is not explicitly specified by
means of annotations or the XML descriptor. The behavior of applications
that mix the placement of annotations on fields and properties within an
entity hierarchy without explicitly specifying the <em>Access</em> annotation
is undefined.</p>
</div>
</div>
<div class="sect3">
<h4 id="a122"><a class="anchor" href="#a122"></a>2.3.2. Explicit Access Type</h4>
<div class="paragraph">
<p>An access type for an individual entity
class, mapped superclass, or embeddable class can be specified for that
class independent of the default for the entity hierarchy by means of
the <em>Access</em> annotation applied to the class. This explicit access type
specification does not affect the access type of other entity classes or
mapped superclasses in the entity hierarchy. The following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When <em>Access(FIELD)</em> is applied to an entity
class, mapped superclass, or embeddable class, mapping annotations may
be placed on the instance variables of that class, and the persistence
provider runtime accesses persistent state via the instance variables
defined by the class. All non-transient instance variables that are not
annotated with the <em>Transient</em> annotation are persistent. When
<em>Access(FIELD)</em> is applied to such a class, it is possible to
selectively designate individual attributes within the class for
property access. To specify a persistent property for access by the
persistence provider runtime, that property must be designated
<em>Access(PROPERTY)</em>.<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnotedef_8" title="View footnote.">8</a>]</sup> The behavior is undefined if
mapping annotations are placed on any properties defined by the class
for which <em>Access(PROPERTY)</em> is not specified. Persistent state
inherited from superclasses is accessed in accordance with the access
types of those superclasses.</p>
</li>
<li>
<p>When <em>Access(PROPERTY)</em> is applied to an
entity class, mapped superclass, or embeddable class, mapping
annotations may be placed on the properties of that class, and the
persistence provider runtime accesses persistent state via the
properties defined by that class. All properties that are not annotated
with the <em>Transient</em> annotation are persistent. When <em>Access(PROPERTY)</em>
is applied to such a class, it is possible to selectively designate
individual attributes within the class for instance variable access. To
specify a persistent instance variable for access by the persistence
provider runtime, that instance variable must be designated
<em>Access(FIELD)</em>. The behavior is undefined if mapping annotations are
placed on any instance variables defined by the class for which
<em>Access(FIELD)</em> is not specified. Persistent state inherited from
superclasses is accessed in accordance with the access types of those
superclasses.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that when access types are combined
within a class, the <em>Transient</em> annotation should be used to avoid
duplicate persistent mappings.</p>
</div>
</div>
<div class="sect3">
<h4 id="access-type-of-an-embeddable-class"><a class="anchor" href="#access-type-of-an-embeddable-class"></a>2.3.3. Access Type of an Embeddable Class</h4>
<div class="paragraph">
<p>The access type of an embeddable class is
determined by the access type of the entity class, mapped superclass, or
embeddable class in which it is embedded (including as a member of an
element collection) independent of whether the access type of the
containing class has been explicitly specified or defaulted. A different
access type for an embeddable class can be specified for that embeddable
class by means of the <em>Access</em> annotation as described above.</p>
</div>
</div>
<div class="sect3">
<h4 id="defaulted-access-types-of-embeddable-classes-and-mapped-superclasses"><a class="anchor" href="#defaulted-access-types-of-embeddable-classes-and-mapped-superclasses"></a>2.3.4. Defaulted Access Types of Embeddable Classes and Mapped Superclasses</h4>
<div class="paragraph">
<p>Care must be exercised when defining an
embeddable class or mapped superclass which is used both in a context of
field access and in a context of property access and whose access type
is not explicitly specified by means of the <em>Access</em> annotation or XML
mapping file.</p>
</div>
<div class="paragraph">
<p>Such classes should be defined so that the
number, names, and types of the resulting persistent attributes are
identical, independent of the access type in use. The behavior of such
classes whose attributes are not independent of access type is otherwise
undefined with regard to use with the metamodel API if they occur in
contexts of differing access types within the same persistence unit.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a132"><a class="anchor" href="#a132"></a>2.4. Primary Keys and Entity Identity</h3>
<div class="paragraph">
<p>Every entity must have a primary key.</p>
</div>
<div class="paragraph">
<p>The primary key must be defined on the entity
class that is the root of the entity hierarchy or on a mapped superclass
that is a (direct or indirect) superclass of all entity classes in the
entity hierarchy. The primary key must be defined exactly once in an
entity hierarchy.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A primary key corresponds to one or more
fields or properties (“attributes”) of the entity class.</p>
</li>
<li>
<p>A simple (i.e., non-composite) primary key
must correspond to a single persistent field or property of the entity
class. The <em>Id</em> annotation or <em>id</em> XML element must be used to denote a
simple primary key. See <a href="#a14827">Section 11.1.21</a>.</p>
</li>
<li>
<p>A composite primary key must correspond to
either a single persistent field or property or to a set of such fields
or properties as described below. A primary key class must be defined to
represent a composite primary key. Composite primary keys typically
arise when mapping from legacy databases when the database key is
comprised of several columns. The <em>EmbeddedId</em> or <em>IdClass</em> annotation
is used to denote a composite primary key. See <a href="#a14687">Section 11.1.17</a> and <a href="#a14836">Section 11.1.22</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A simple primary key or a field or property
of a composite primary key should be one of the following types: any
Java primitive type; any primitive wrapper type; <em>java.lang.String</em>;
<em>java.util.Date</em>; <em>java.sql.Date</em>; <em>java.math.BigDecimal</em>;
<em>java.math.BigInteger</em>.<sup class="footnote">[<a id="_footnoteref_9" class="footnote" href="#_footnotedef_9" title="View footnote.">9</a>]</sup> If the primary key is a
composite primary key derived from the primary key of another entity,
the primary key may contain an attribute whose type is that of the
primary key of the referenced entity as described in <a href="#a149">Section 2.4.1</a>.
Entities whose primary keys use types other than these will
not be portable. If generated primary keys are used, only integral types
will be portable. If <em>java.util.Date</em> is used as a primary key field or
property, the temporal type should be specified as <em>DATE</em>.</p>
</div>
<div class="paragraph">
<p>The following rules apply for composite
primary keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The primary key class must be public and must
have a public no-arg constructor.</p>
</li>
<li>
<p>The access type (field- or property-based
access) of a primary key class is determined by the access type of the
entity for which it is the primary key unless the primary key is a
embedded id and a different access type is specified. See Section <a href="#a113">Section 2.3</a>.</p>
</li>
<li>
<p>If property-based access is used, the
properties of the primary key class must be public or protected.</p>
</li>
<li>
<p>The primary key class must be serializable.</p>
</li>
<li>
<p>The primary key class must define <em>equals</em>
and <em>hashCode</em> methods. The semantics of value equality for these
methods must be consistent with the database equality for the database
types to which the key is mapped.</p>
</li>
<li>
<p>A composite primary key must either be
represented and mapped as an embeddable class (see <a href="#a14687">Section 11.1.17</a>) or must be
represented as an id class and mapped to multiple fields or properties
of the entity class (see <a href="#a14836">Section 11.1.22</a>).</p>
</li>
<li>
<p>If the composite primary key class is
represented as an id class, the names of primary key fields or
properties in the primary key class and those of the entity class to
which the id class is mapped must correspond and their types must be the
same.</p>
</li>
<li>
<p>A primary key that corresponds to a derived
identity must conform to the rules of <a href="#a149">Section 2.4.1</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The value of its primary key uniquely
identifies an entity instance within a persistence context and to
<em>EntityManager</em> operations as described in
<a href="#a1060">Chapter 3</a>. The application must
not change the value of the primary key<sup class="footnote">[<a id="_footnoteref_10" class="footnote" href="#_footnotedef_10" title="View footnote.">10</a>]</sup>. The
behavior is undefined if this occurs.<sup class="footnote">[<a id="_footnoteref_11" class="footnote" href="#_footnotedef_11" title="View footnote.">11</a>]</sup></p>
</div>
<div class="sect3">
<h4 id="a149"><a class="anchor" href="#a149"></a>2.4.1. Primary Keys Corresponding to Derived Identities</h4>
<div class="paragraph">
<p>The identity of an entity may be derived from
the identity of another entity (the “parent” entity) when the former
entity (the “dependent” entity) is the owner of a many-to-one or
one-to-one relationship to the parent entity and a foreign key maps the
relationship from dependent to parent.</p>
</div>
<div class="paragraph">
<p>If a many-to-one or one-to-one entity
relationship corresponds to a primary key attribute, the entity
containing this relationship cannot be persisted without the
relationship having been assigned an entity since the identity of the
entity containing the relationship is derived from the referenced
entity.<sup class="footnote">[<a id="_footnoteref_12" class="footnote" href="#_footnotedef_12" title="View footnote.">12</a>]</sup></p>
</div>
<div class="paragraph">
<p>Derived identities may be captured by means
of simple primary keys or by means of composite primary keys as
described in <a href="#a155">Section 2.4.1.1</a> below.</p>
</div>
<div class="paragraph">
<p>If the dependent entity class has primary key
attributes in addition to those corresponding to the parent&#8217;s primary
key or if the parent has a composite primary key, an embedded id or id
class must be used to specify the primary key of the dependent entity.
It is not necessary that parent entity and dependent entity both use
embedded ids or both use id classes to represent composite primary keys
when the parent has a composite key.</p>
</div>
<div class="paragraph">
<p>A dependent entity may have more than one
parent entity.</p>
</div>
<div class="sect4">
<h5 id="a155"><a class="anchor" href="#a155"></a>2.4.1.1. Specification of Derived Identities</h5>
<div class="paragraph">
<p>If the dependent entity uses an id class to
represent its primary key, one of the two following rules must be
observed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The names of the attributes of the id class
and the <em>Id</em> attributes of the dependent entity class must correspond as
follows:</p>
<div class="ulist">
<ul>
<li>
<p>The <em>Id</em> attribute in the entity class and
the corresponding attribute in the id class must have the same name.</p>
</li>
<li>
<p>If an <em>Id</em> attribute in the entity class is
of basic type, the corresponding attribute in the id class must have the
same type.</p>
</li>
<li>
<p>If an <em>Id</em> attribute in the entity is a
many-to-one or one-to-one relationship to a parent entity, the
corresponding attribute in the id class must be of the same Java type as
the id class or embedded id of the parent entity (if the parent entity
has a composite primary key) or the type of the <em>Id</em> attribute of the
parent entity (if the parent entity has a simple primary key).</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the dependent entity has a single
primary key attribute (i.e., the relationship attribute), the id class
specified by the dependent entity must be the same as the primary key
class of the parent entity. The <em>Id</em> annotation is applied to the
relationship to the parent entity.<sup class="footnote">[<a id="_footnoteref_13" class="footnote" href="#_footnotedef_13" title="View footnote.">13</a>]</sup></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the dependent entity uses an
embedded id to represent its primary key, the attribute in the embedded
id corresponding to the relationship attribute must be of the same type
as the primary key of the parent entity and must be designated by the
<em>MapsId</em> annotation applied to the relationship attribute. The <em>value</em>
element of the <em>MapsId</em> annotation must be used to specify the name of
the attribute within the embedded id to which the relationship attribute
corresponds. If the embedded id of the dependent entity is of the same
Java type as the primary key of the parent entity, the relationship
attribute maps both the relationship to the parent and the primary key
of the dependent entity, and in this case the <em>MapsId</em> annotation is
specified without the <em>value</em> element.<sup class="footnote">[<a id="_footnoteref_14" class="footnote" href="#_footnotedef_14" title="View footnote.">14</a>]</sup></p>
</div>
<div class="paragraph">
<p>If the dependent entity has a single primary
key attribute (i.e, the relationship attribute or an attribute that
corresponds to the relationship attribute) and the primary key of the
parent entity is a simple primary key, the primary key of the dependent
entity is a simple primary key of the same type as that of the parent
entity (and neither <em>EmbeddedId</em> nor <em>IdClass</em> is specified). In this
case, either (1) the relationship attribute is annotated <em>Id</em>, or (2) a
separate <em>Id</em> attribute is specified and the relationship attribute is
annotated <em>MapsId</em> (and the <em>value</em> element of the <em>MapsId</em> annotation
is not specified).</p>
</div>
</div>
<div class="sect4">
<h5 id="mapping-of-derived-identities"><a class="anchor" href="#mapping-of-derived-identities"></a>2.4.1.2. Mapping of Derived Identities</h5>
<div class="paragraph">
<p>A primary key attribute that is derived from
the identity of a parent entity is mapped by the corresponding
relationship attribute. The default mapping for this relationship is as
specified in <a href="#a538">Section 2.10</a>. In the case where a default mapping does not apply or
where a default mapping is to be overridden, the <em>JoinColumn</em> or
<em>JoinColumns</em> annotation is used on the relationship attribute.</p>
</div>
<div class="paragraph">
<p>If the dependent entity uses an embedded id
to represent its primary key, the <em>AttributeOverride</em> annotation may be
used to override the default mapping of embedded id attributes that do
not correspond to the relationship attributes mapping the derived
identity. The embedded id attributes that correspond to the relationship
are treated by the provider as “read only”—that is, any updates to them
on the part of the application are not propagated to the database.</p>
</div>
<div class="paragraph">
<p>If the dependent uses an id class, the
<em>Column</em> annotation may be used to override the default mapping of <em>Id</em>
attributes that are not relationship attributes.</p>
</div>
</div>
<div class="sect4">
<h5 id="examples-of-derived-identities"><a class="anchor" href="#examples-of-derived-identities"></a>2.4.1.3. Examples of Derived Identities</h5>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity has a simple primary key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span> <span class="type">long</span> empId;
    <span class="predefined-type">String</span> empName;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity uses <em>IdClass</em> to represent a composite key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name; <span class="comment">// matches name of @Id attribute</span>
    <span class="type">long</span> emp; <span class="comment">// matches name of @Id attribute and type of Employee PK</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(DependentId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@Id</span> <span class="predefined-type">String</span> name;

    <span class="comment">// id attribute mapped by join column default</span>
    <span class="annotation">@Id</span> <span class="annotation">@ManyToOne</span>
    Employee emp;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.emp.empName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case(b):</strong> The dependent entity uses <em>EmbeddedId</em> to represent a composite key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    <span class="type">long</span> empPK; <span class="comment">// corresponds to PK type of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@EmbeddedId</span> DependentId id;

    <span class="comment">// id attribute mapped by join column default</span>
    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empPK</span><span class="delimiter">&quot;</span></span>) <span class="comment">// maps empPK attribute of embedded id</span>
    <span class="annotation">@ManyToOne</span>
    Employee emp;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.emp.empName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity uses <em>IdClass</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeId</span> {
    <span class="predefined-type">String</span> firstName;
    <span class="predefined-type">String</span> lastName;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(EmployeeId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span> <span class="predefined-type">String</span> firstName
    <span class="annotation">@Id</span> <span class="predefined-type">String</span> lastName

   <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity uses <em>IdClass</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name; <span class="comment">// matches name of attribute</span>
    EmployeeId emp; <span class="comment">//matches name of attribute and type of Employee PK</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(DependentId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> name;

    <span class="annotation">@Id</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@ManyToOne</span>
    Employee emp;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.emp.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent entity uses
<em>EmbeddedId</em>. The type of the <em>empPK</em> attribute is the same as that of
the primary key of <em>Employee</em>. The <em>EmployeeId</em> class needs to be
annotated <em>Embeddable</em> or denoted as an embeddable class in the XML
descriptor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    EmployeeId empPK;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@EmbeddedId</span>
    DependentId id;

    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empPK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@ManyToOne</span>
    Employee emp;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.emp.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the following alternative query
will yield the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.id.empPK.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity uses <em>EmbeddedId</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeId</span> {
    <span class="predefined-type">String</span> firstName;
    <span class="predefined-type">String</span> lastName;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@EmbeddedId</span>
    EmployeeId empId;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity uses <em>IdClass</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name; <span class="comment">// matches name of @Id attribute</span>
    EmployeeId emp; <span class="comment">// matches name of @Id attribute and type of embedded id of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(DependentId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dep_name</span><span class="delimiter">&quot;</span></span>) <span class="comment">// default column name is overridden</span>
    <span class="predefined-type">String</span> name;

    <span class="annotation">@Id</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@ManyToOne</span> Employee
    emp;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">and</span> d.emp.empId.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent entity uses <em>EmbeddedId</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    EmployeeId empPK; <span class="comment">// corresponds to PK type of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="comment">// default column name for &quot;name&quot; attribute is overridden</span>
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dep_name</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@EmbeddedId</span> DependentId id;

    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empPK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })
    <span class="annotation">@ManyToOne</span>
    Employee emp;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">and</span> d.emp.empId.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the following alternative query will yield the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Dependent d
<span class="keyword">WHERE</span> d.id.name = <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> d.id.empPK.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Sam</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity has a simple primary key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> ssn;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity has a
single primary key attribute which is mapped by the relationship
attribute. The primary key of <em>MedicalHistory</em> is of type <em>String</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="comment">// default join column name is overridden</span>
    <span class="annotation">@Id</span>
    <span class="annotation">@OneToOne</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK</span><span class="delimiter">&quot;</span></span>)
    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m
<span class="keyword">WHERE</span> m.patient.ssn = <span class="string"><span class="delimiter">'</span><span class="content">123-45-6789</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent entity has
a single primary key attribute corresponding to the relationship
attribute. The primary key attribute is of the same basic type as the
primary key of the parent entity. The <em>MapsId</em> annotation applied to the
relationship attribute indicates that the primary key is mapped by the
relationship attribute.<sup class="footnote">[<a id="_footnoteref_15" class="footnote" href="#_footnotedef_15" title="View footnote.">15</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> id; <span class="comment">// overriding not allowed</span>

    <span class="comment">// ...</span>

    <span class="comment">// default join column name is overridden</span>
    <span class="annotation">@MapsId</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@OneToOne</span>
    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m <span class="keyword">WHERE</span> m.patient.ssn = <span class="string"><span class="delimiter">'</span><span class="content">123-45-6789</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity uses <em>IdClass</em>. The
dependent&#8217;s primary key class is of same type as that of the parent
entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">PersonId</span> {
    <span class="predefined-type">String</span> firstName;
    <span class="predefined-type">String</span> lastName;
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(PersonId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> firstName;

    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> lastName;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent entity uses <em>IdClass</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(PersonId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@OneToOne</span>
    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m
<span class="keyword">WHERE</span> m.patient.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Charles</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent entity uses the
<em>EmbeddedId</em> and <em>MapsId</em> annotations. The <em>PersonId</em> class needs to be
annotated <em>Embeddable</em> or denoted as an embeddable class in the XML
descriptor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="comment">// all attributes map to relationship:</span>
    AttributeOverride not allowed

    <span class="annotation">@EmbeddedId</span>
    PersonId id;

    <span class="comment">// ...</span>

    <span class="annotation">@MapsId</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    <span class="annotation">@OneToOne</span> Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m
<span class="keyword">WHERE</span> m.patient.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Charles</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the following alternative query
will yield the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> m
<span class="keyword">FROM</span> MedicalHistory m
<span class="keyword">WHERE</span> m.id.firstName = <span class="string"><span class="delimiter">'</span><span class="content">Charles</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong></p>
</div>
<div class="paragraph">
<p>The parent entity uses <em>EmbeddedId</em>. The
dependent&#8217;s primary key is of the same type as that of the parent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PersonId</span> {
    <span class="predefined-type">String</span> firstName;
    <span class="predefined-type">String</span> lastName;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@EmbeddedId</span> PersonId id;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (a):</strong> The dependent class uses <em>IdClass</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(PersonId.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@OneToOne</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })

    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case (b):</strong> The dependent class uses <em>EmbeddedId</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MedicalHistory</span> {
    <span class="comment">// All attributes are mapped by the relationship</span>
    <span class="comment">// AttributeOverride is not allowed</span>
    <span class="annotation">@EmbeddedId</span> PersonId id;

    <span class="comment">// ...</span>

    <span class="annotation">@MapsId</span>
    <span class="annotation">@JoinColumns</span>({
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK1</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FK2</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>)
    })
    <span class="annotation">@OneToOne</span>
    Person patient;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a487"><a class="anchor" href="#a487"></a>2.5. Embeddable Classes</h3>
<div class="paragraph">
<p>An entity may use other fine-grained classes
to represent entity state. Instances of these classes, unlike entity
instances, do not have persistent identity of their own. Instead, they
exist only as part of the state of the entity to which they belong. An
entity may have collections of embeddables as well as single-valued
embeddable attributes. Embeddables may also be used as map keys and map
values. Embedded objects belong strictly to their owning entity, and are
not sharable across persistent entities. Attempting to share an embedded
object across entities has undefined semantics.</p>
</div>
<div class="paragraph">
<p>Embeddable classes must adhere to the
requirements specified in <a href="#a18">Section 2.1</a> for entities with the exception that embeddable classes
are not annotated as <em>Entity</em>. Embeddable classes must be annotated as
<em>Embeddable</em> or denoted in the XML descriptor as such. The access type
for an embedded object is determined as described in <a href="#a113">Section 2.3</a>.</p>
</div>
<div class="paragraph">
<p>An embeddable class may be used to represent
the state of another embeddable class.</p>
</div>
<div class="paragraph">
<p>An embeddable class (including an
embeddable class within another embeddable class) may contain a
collection of a basic type or other embeddable
class.<sup class="footnote">[<a id="_footnoteref_16" class="footnote" href="#_footnotedef_16" title="View footnote.">16</a>]</sup></p>
</div>
<div class="paragraph">
<p>An embeddable class may contain a
relationship to an entity or collection of entities. Since instances of
embeddable classes themselves have no persistent identity, the
relationship <em>from</em> the referenced entity is to the <em>entity</em> that
contains the embeddable instance(s) and not to the embeddable
itself.<sup class="footnote">[<a id="_footnoteref_17" class="footnote" href="#_footnotedef_17" title="View footnote.">17</a>]</sup> An embeddable class that is used as an
embedded id or as a map key must not contain such a relationship.</p>
</div>
<div class="paragraph">
<p>Additional requirements and restrictions on
embeddable classes are described in <a href="#a494">Section 2.6</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a494"><a class="anchor" href="#a494"></a>2.6. Collections of Embeddable Classes and Basic Types</h3>
<div class="paragraph">
<p>A persistent field or property of an entity
or embeddable class may correspond to a collection of a basic type or
embeddable class (“element collection”). Such a collection, when
specified as such by the <em>ElementCollection</em> annotation, is mapped by
means of a collection table, as defined in <a href="#a14250">Section 11.1.8</a>. If the
<em>ElementCollection</em> annotation (or XML equivalent) is not specified for
the collection-valued field or property, the rules of <a href="#a511">Section 2.8</a> apply.</p>
</div>
<div class="paragraph">
<p>An embeddable class (including an embeddable
class within another embeddable class) that is contained within an
element collection must not contain an element collection, nor may it
contain a relationship to an entity other than a many-to-one or
one-to-one relationship. The embeddable class must be on the owning side
of such a relationship and the relationship must be mapped by a foreign
key mapping. (See <a href="#a516">Section 2.9</a>)</p>
</div>
</div>
<div class="sect2">
<h3 id="map-collections"><a class="anchor" href="#map-collections"></a>2.7. Map Collections</h3>
<div class="paragraph">
<p>Collections of elements and entity
relationships can be represented as <em>java.util.Map</em> collections.</p>
</div>
<div class="paragraph">
<p>The map key and the map value independently
can each be a basic type, an embeddable class, or an entity.</p>
</div>
<div class="paragraph">
<p>The <em>ElementCollection</em>, <em>OneToMany</em>, and
<em>ManyToMany</em> annotations are used to specify the map as an element
collection or entity relationship as follows: when the map value is a
basic type or embeddable class, the <em>ElementCollection</em> annotation is
used; when the map value is an entity, the <em>OneToMany</em> or <em>ManyToMany</em>
annotation is used.</p>
</div>
<div class="paragraph">
<p>Bidirectional relationships represented as
<em>java.util.Map</em> collections support the use of the <em>Map</em> datatype on one
side of the relationship only.</p>
</div>
<div class="sect3">
<h4 id="map-keys"><a class="anchor" href="#map-keys"></a>2.7.1. Map Keys</h4>
<div class="paragraph">
<p>If the map key type is a basic type, the
<em>MapKeyColumn</em> annotation can be used to specify the column mapping for
the map key. If the <em>MapKeyColumn</em> annotation is not specified, the
default values of the <em>MapKeyColumn</em> annotation apply as described in <a href="#a15367">Section 11.1.33</a>.</p>
</div>
<div class="paragraph">
<p>If the map key type is an embeddable class,
the mappings for the map key columns are defaulted according to the
default column mappings for the embeddable class. (See <a href="#a14330">Section 11.1.9</a>). The
<em>AttributeOverride</em> and <em>AttributeOverrides</em> annotations can be used to
override these mappings, as described in <a href="#a14084">Section 11.1.4</a> and <a href="#a14178">Section 11.1.5</a>. If an
embeddable class is used as a map key, the embeddable class must
implement the <em>hashCode</em> and <em>equals</em> methods consistently with the
database columns to which the embeddable is
mapped<sup class="footnote">[<a id="_footnoteref_18" class="footnote" href="#_footnotedef_18" title="View footnote.">18</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>If the map key type is an entity, the
<em>MapKeyJoinColumn</em> and <em>MapKeyJoinColumns</em> annotations are used to
specify the column mappings for the map key. If the primary key of the
referenced entity is a simple primary key and the <em>MapKeyJoinColumn</em>
annotation is not specified, the default values of the
<em>MapKeyJoinColumn</em> annotation apply as described in <a href="#a15450">Section 11.1.35</a>.</p>
</div>
<div class="paragraph">
<p>If Java generic types are not used in the
declaration of a relationship attribute of type <em>java.util.Map</em>, the
<em>MapKeyClass</em> annotation must be used to specify the type of the key of
the map.</p>
</div>
<div class="paragraph">
<p>The <em>MapKey</em> annotation is used to specify
the special case where the map key is itself the primary key or a
persistent field or property of the entity that is the value of the map.
The <em>MapKeyClass</em> annotation is not used when <em>MapKey</em> is specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="map-values"><a class="anchor" href="#map-values"></a>2.7.2. Map Values</h4>
<div class="paragraph">
<p>When the value type of the map is a basic
type or an embeddable class, a collection table is used to map the map.
If Java generic types are not used, the <em>targetClass</em> element of the
<em>ElementCollection</em> annotation must be used to specify the value type
for the map. The default column mappings for the map value are derived
according to the default mapping rules for the <em>CollectionTable</em>
annotation defined in <a href="#a14250">Section 11.1.8</a>. The <em>Column</em> annotation is used to override
these defaults for a map value of basic type. The <em>AttributeOverride(s)</em> and <em>AssociationOverride(s)</em> annotations are used to override
the mappings for a map value that is an embeddable class.</p>
</div>
<div class="paragraph">
<p>When the value type of the map is an entity,
a join table is used to map the map for a many-to-many relationship or,
by default, for a one-to-many unidirectional relationship. If the
relationship is a bidirectional one-to-many/many-to-one relationship, by
default the map is mapped in the table of the entity that is the value
of the map. If Java generic types are not used, the <em>targetEntity</em>
element of the <em>OneToMany</em> or <em>ManyToMany</em> annotation must be used to
specify the value type for the map. Default mappings are described in
<a href="#a538">Section 2.10</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a511"><a class="anchor" href="#a511"></a>2.8. Mapping Defaults for Non-Relationship Fields or Properties</h3>
<div class="paragraph">
<p>If a persistent field or property other than
a relationship property is <em>not</em> annotated with one of the mapping
annotations defined in <a href="#a13915">Chapter 11</a> (or equivalent mapping information is not
specified in the XML descriptor), the following default mapping rules
are applied in order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the type is a class that is annotated with
the <em>Embeddable</em> annotation, it is mapped in the same way as if the
field or property were annotated with the <em>Embedded</em> annotation. See
<a href="#a14634">Section 11.1.15</a> and <a href="#a14672">Section 11.1.16</a>.</p>
</li>
<li>
<p>If the type of the field or property is one
of the following, it is mapped in the same way as it would if it were
annotated as <em>Basic</em>: Java primitive types, wrappers of the primitive
types, <em>java.lang.String</em>, <em>java.math.BigInteger</em>,
<em>java.math.BigDecimal</em>, <em>java.util.Date</em>, <em>java.util.Calendar</em>,
<em>java.sql.Date</em>, <em>java.sql.Time</em>, <em>java.sql.Timestamp</em>,
<em>java.time.LocalDate</em>, <em>java.time.LocalTime</em>,
<em>java.time.LocalDateTime</em>, <em>java.time.OffsetTime</em>,
<em>java.time.OffsetDateTime</em>, <em>byte[]</em>, <em>Byte[]</em>, <em>char[]</em>,
<em>Character[]</em>, enums, any other type that implements <em>Serializable</em>.
See <a href="#a14205">Section 11.1.6</a>, <a href="#a14719">Section 11.1.18</a>, <a href="#a15087">Section 11.1.28</a>, and <a href="#a16361">Section 11.1.53</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is an error if no annotation is present
and none of the above rules apply.</p>
</div>
</div>
<div class="sect2">
<h3 id="a516"><a class="anchor" href="#a516"></a>2.9. Entity Relationships</h3>
<div class="paragraph">
<p>Relationships among entities may be
one-to-one, one-to-many, many-to-one, or many-to-many. Relationships are
polymorphic.</p>
</div>
<div class="paragraph">
<p>If there is an association between two
entities, one of the following relationship modeling annotations must be
applied to the corresponding persistent property or field of the
referencing entity: <em>OneToOne</em>, <em>OneToMany</em>, <em>ManyToOne</em>,
<em>ManyToMany</em>. For associations that do not specify the target type
(e.g., where Java generic types are not used for collections), it is
necessary to specify the entity that is the target of the
relationship.<sup class="footnote">[<a id="_footnoteref_19" class="footnote" href="#_footnotedef_19" title="View footnote.">19</a>]</sup> Equivalent XML elements may be used
as an alternative to these mapping annotations.</p>
</div>
<div class="paragraph">
<p><em>These annotations mirror common practice in
relational database schema modeling. The use of the relationship
modeling annotations allows the object/relationship mapping of
associations to the relational database schema to be fully defaulted, to
provide an ease-of-development facility. This is described in <a href="#a538">Section 2.10</a>.</em></p>
</div>
<div class="paragraph">
<p>Relationships may be bidirectional or
unidirectional. A bidirectional relationship has both an owning side and
an inverse (non-owning) side. A unidirectional relationship has only an
owning side. The owning side of a relationship determines the updates to
the relationship in the database, as described in <a href="#a1955">Section 3.2.4</a>.</p>
</div>
<div class="paragraph">
<p>The following rules apply to bidirectional
relationships:</p>
</div>
<div class="paragraph">
<p>The inverse side of a bidirectional
relationship must refer to its owning side by use of the <em>mappedBy</em>
element of the <em>OneToOne</em>, <em>OneToMany</em>, or <em>ManyToMany</em> annotation.
The <em>mappedBy</em> element designates the property or field in the entity
that is the owner of the relationship.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The many side of one-to-many / many-to-one
bidirectional relationships must be the owning side, hence the
<em>mappedBy</em> element cannot be specified on the <em>ManyToOne</em> annotation.</p>
</li>
<li>
<p>For one-to-one bidirectional relationships,
the owning side corresponds to the side that contains the corresponding
foreign key.</p>
</li>
<li>
<p>For many-to-many bidirectional relationships
either side may be the owning side.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The relationship modeling annotation
constrains the use of the <em>cascade=REMOVE</em> specification. The
<em>cascade=REMOVE</em> specification should only be applied to associations
that are specified as <em>OneToOne</em> or <em>OneToMany</em>. Applications that
apply <em>cascade=REMOVE</em> to other associations are not portable.</p>
</div>
<div class="paragraph">
<p>Associations that are specified as <em>OneToOne</em>
or <em>OneToMany</em> support use of the <em>orphanRemoval</em> option. The following
behaviors apply when <em>orphanRemoval</em> is in effect:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If an entity that is the target of the
relationship is removed from the relationship (by setting the
relationship to null or removing the entity from the relationship
collection), the remove operation will be applied to the entity being
orphaned. The remove operation is applied at the time of the flush
operation. The <em>orphanRemoval</em> functionality is intended for entities
that are privately “owned” by their parent entity. Portable applications
must otherwise not depend upon a specific order of removal, and must not
reassign an entity that has been orphaned to another relationship or
otherwise attempt to persist it. If the entity being orphaned is a
detached, new, or removed entity, the semantics of <em>orphanRemoval</em> do
not apply.</p>
</li>
<li>
<p>If the remove operation is applied to a
managed source entity, the remove operation will be cascaded to the
relationship target in accordance with the rules of <a href="#a1946">Section 3.2.3</a>,
(and hence it is not necessary to specify <em>cascade=REMOVE</em> for the
relationship)<sup class="footnote">[<a id="_footnoteref_20" class="footnote" href="#_footnotedef_20" title="View footnote.">20</a>]</sup>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#a538">Section 2.10</a>, defines relationship mapping defaults
for entity relationships. Additional mapping annotations (e.g., column
and table mapping annotations) may be specified to override or further
refine the default mappings and mapping strategies described in <a href="#a538">Section 2.10</a>.</p>
</div>
<div class="paragraph">
<p>In addition, this specification also requires
support for the following alternative mapping strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The mapping of unidirectional one-to-many
relationships by means of foreign key mappings. The <em>JoinColumn</em>
annotation or corresponding XML element must be used to specify such
non-default mappings. See <a href="#a14922">Section 11.1.25</a>.</p>
</li>
<li>
<p>The mapping of unidirectional and
bidirectional one-to-one relationships, bidirectional
many-to-one/one-to-many relationships, and unidirectional many-to-one
relationships by means of join table mappings. The <em>JoinTable</em>
annotation or corresponding XML element must be used to specify such
non-default mappings. See <a href="#a15022">Section 11.1.27</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such mapping annotations must be specified on
the owning side of the relationship. Any overriding of mapping defaults
must be consistent with the relationship modeling annotation that is
specified. For example, if a many-to-one relationship mapping is
specified, it is not permitted to specify a unique key constraint on the
foreign key for the relationship.</p>
</div>
<div class="paragraph">
<p>The persistence provider handles the
object/relational mapping of the relationships, including their loading
and storing to the database as specified in the metadata of the entity
class, and the referential integrity of the relationships as specified
in the database (e.g., by foreign key constraints).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that it is the application that bears
responsibility for maintaining the consistency of runtime
relationships—for example, for insuring that the “one” and the “many”
sides of a bidirectional relationship are consistent with one another
when the application updates the relationship at runtime.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If there are no associated entities for a
multi-valued relationship of an entity fetched from the database, the
persistence provider is responsible for returning an empty collection as
the value of the relationship.</p>
</div>
</div>
<div class="sect2">
<h3 id="a538"><a class="anchor" href="#a538"></a>2.10. Relationship Mapping Defaults</h3>
<div class="paragraph">
<p>This section defines the mapping defaults
that apply to the use of the <em>OneToOne</em>, <em>OneToMany</em>, <em>ManyToOne</em>,
and <em>ManyToMany</em> relationship modeling annotations. The same mapping
defaults apply when the XML descriptor is used to denote the
relationship cardinalities.</p>
</div>
<div class="sect3">
<h4 id="bidirectional-onetoone-relationships"><a class="anchor" href="#bidirectional-onetoone-relationships"></a>2.10.1. Bidirectional OneToOne Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a single instance of Entity B.</p>
</li>
<li>
<p>Entity B references a single instance of Entity A.</p>
</li>
<li>
<p>Entity A is specified as the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <em>A</em>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <em>B</em>.</p>
</li>
<li>
<p>Table <em>A</em> contains a foreign key to table <em>B</em>.
The foreign key column name is formed as the concatenation of the
following: the name of the relationship property or field of entity A; "
<em>_</em> "; the name of the primary key column in table <em>B</em>. The foreign key
column has the same type as the primary key of table <em>B</em> and there is a
unique key constraint on it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> Cubicle assignedCubicle;

    <span class="annotation">@OneToOne</span>
    <span class="directive">public</span> Cubicle getAssignedCubicle() {
        <span class="keyword">return</span> assignedCubicle;
    }

    <span class="directive">public</span> <span class="type">void</span> setAssignedCubicle(Cubicle cubicle) {
        <span class="local-variable">this</span>.assignedCubicle = cubicle;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Cubicle</span> {
    <span class="directive">private</span> Employee residentEmployee;

    <span class="annotation">@OneToOne</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">assignedCubicle</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Employee getResidentEmployee() {
        <span class="keyword">return</span> residentEmployee;
    }

    <span class="directive">public</span> <span class="type">void</span> setResidentEmployee(Employee employee) {
        <span class="local-variable">this</span>.residentEmployee = employee;
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> references a single instance of Entity <em>Cubicle</em>.</p>
</li>
<li>
<p>Entity <em>Cubicle</em> references a single instance of Entity <em>Employee</em>.</p>
</li>
<li>
<p>Entity <em>Employee</em> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> is mapped to a table named <em>EMPLOYEE</em>.</p>
</li>
<li>
<p>Entity <em>Cubicle</em> is mapped to a table named <em>CUBICLE</em>.</p>
</li>
<li>
<p>Table <em>EMPLOYEE</em> contains a foreign key to
table <em>CUBICLE</em>. The foreign key column is named <em>ASSIGNEDCUBICLE_</em> &lt;PK
of CUBICLE&gt;, where &lt;PK of CUBICLE&gt; denotes the name of the primary key
column of table <em>CUBICLE</em>. The foreign key column has the same type as
the primary key of <em>CUBICLE</em>, and there is a unique key constraint on
it.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="bidirectional-manytoone-onetomany-relationships"><a class="anchor" href="#bidirectional-manytoone-onetomany-relationships"></a>2.10.2. Bidirectional ManyToOne / OneToMany Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a single instance of Entity B.</p>
</li>
<li>
<p>Entity B references a collection of Entity A<sup class="footnote">[<a id="_footnoteref_21" class="footnote" href="#_footnotedef_21" title="View footnote.">21</a>]</sup>.</p>
</li>
<li>
<p>Entity A must be the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <em>A</em>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <em>B</em>.</p>
</li>
<li>
<p>Table <em>A</em> contains a foreign key to table <em>B</em>.
The foreign key column name is formed as the concatenation of the
following: the name of the relationship property or field of entity A; "
<em>_</em> "; the name of the primary key column in table <em>B</em>. The foreign key
column has the same type as the primary key of table <em>B</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> Department department;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">public</span> Department getDepartment() {
        <span class="keyword">return</span> department;
    }

    <span class="directive">public</span> <span class="type">void</span> setDepartment(Department department) {
        <span class="local-variable">this</span>.department = department;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Employee&gt; employees = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="annotation">@OneToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">department</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Collection</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> references a single instance of Entity <em>Department</em>.</p>
</li>
<li>
<p>Entity <em>Department</em> references a collection of Entity <em>Employee</em>.</p>
</li>
<li>
<p>Entity <em>Employee</em> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> is mapped to a table named <em>EMPLOYEE</em>.</p>
</li>
<li>
<p>Entity <em>Department</em> is mapped to a table named <em>DEPARTMENT</em>.</p>
</li>
<li>
<p>Table <em>EMPLOYEE</em> contains a foreign key to
table <em>DEPARTMENT</em>. The foreign key column is named <em>DEPARTMENT_</em> &lt;PK
of DEPARTMENT&gt;, where &lt;PK of DEPARTMENT&gt; denotes the name of the primary
key column of table <em>DEPARTMENT</em>. The foreign key column has the same
type as the primary key of <em>DEPARTMENT</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="unidirectional-single-valued-relationships"><a class="anchor" href="#unidirectional-single-valued-relationships"></a>2.10.3. Unidirectional Single-Valued Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a single instance of Entity B.</p>
</li>
<li>
<p>Entity B does not reference Entity A.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A unidirectional relationship has only an owning side, which in this case must be Entity A.</p>
</div>
<div class="paragraph">
<p>The unidirectional single-valued relationship
modeling case can be specified as either a unidirectional <em>OneToOne</em> or
as a unidirectional <em>ManyToOne</em> relationship.</p>
</div>
<div class="sect4">
<h5 id="a640"><a class="anchor" href="#a640"></a>2.10.3.1. Unidirectional OneToOne Relationships</h5>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <em>A</em>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <em>B</em>.</p>
</li>
<li>
<p>Table <em>A</em> contains a foreign key to table <em>B</em>.
The foreign key column name is formed as the concatenation of the
following: the name of the relationship property or field of entity A; "
<em>_</em> "; the name of the primary key column in table <em>B</em>. The foreign key
column has the same type as the primary key of table <em>B</em> and there is a
unique key constraint on it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> TravelProfile profile;

    <span class="annotation">@OneToOne</span>
    <span class="directive">public</span> TravelProfile getProfile() {
        <span class="keyword">return</span> profile;
    }

    <span class="directive">public</span> <span class="type">void</span> setProfile(TravelProfile profile) {
        <span class="local-variable">this</span>.profile = profile;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TravelProfile</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> references a single instance of Entity <em>TravelProfile</em>.</p>
</li>
<li>
<p>Entity <em>TravelProfile</em> does not reference Entity <em>Employee</em>.</p>
</li>
<li>
<p>Entity <em>Employee</em> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> is mapped to a table named <em>EMPLOYEE</em>.</p>
</li>
<li>
<p>Entity <em>TravelProfile</em> is mapped to a table named <em>TRAVELPROFILE</em>.</p>
</li>
<li>
<p>Table <em>EMPLOYEE</em> contains a foreign key to
table <em>TRAVELPROFILE</em>. The foreign key column is named <em>PROFILE_</em> &lt;PK
of TRAVELPROFILE&gt;, where &lt;PK of TRAVELPROFILE&gt; denotes the name of the
primary key column of table <em>TRAVELPROFILE</em>. The foreign key column has
the same type as the primary key of <em>TRAVELPROFILE</em>, and there is a
unique key constraint on it.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="unidirectional-manytoone-relationships"><a class="anchor" href="#unidirectional-manytoone-relationships"></a>2.10.3.2. Unidirectional ManyToOne Relationships</h5>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <em>A</em>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <em>B</em>.</p>
</li>
<li>
<p>Table <em>A</em> contains a foreign key to table <em>B</em>. The foreign key column name is formed as the concatenation of the following: the name of the relationship property or field of entity A; "<em>"; the name of the primary key column in table _B</em>. The foreign key column has the same type as the primary key of table <em>B</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> Address address;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">public</span> Address getAddress() {
        <span class="keyword">return</span> address;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) {
        <span class="local-variable">this</span>.address = address;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> references a single instance of Entity <em>Address</em>.</p>
</li>
<li>
<p>Entity <em>Address</em> does not reference Entity <em>Employee</em>.</p>
</li>
<li>
<p>Entity <em>Employee</em> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> is mapped to a table named <em>EMPLOYEE</em>.</p>
</li>
<li>
<p>Entity <em>Address</em> is mapped to a table named <em>ADDRESS</em>.</p>
</li>
<li>
<p>Table <em>EMPLOYEE</em> contains a foreign key to
table <em>ADDRESS</em>. The foreign key column is named <em>ADDRESS_</em> &lt;PK of
ADDRESS&gt;, where &lt;PK of ADDRESS&gt; denotes the name of the primary key
column of table <em>ADDRESS</em>. The foreign key column has the same type as
the primary key of <em>ADDRESS</em>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a708"><a class="anchor" href="#a708"></a>2.10.4. Bidirectional ManyToMany Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a collection of Entity B.</p>
</li>
<li>
<p>Entity B references a collection of Entity A.</p>
</li>
<li>
<p>Entity A is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <em>A</em>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <em>B</em>.</p>
</li>
<li>
<p>There is a join table that is named <em>A_B</em>
(owner name first). This join table has two foreign key columns. One
foreign key column refers to table <em>A</em> and has the same type as the
primary key of table <em>A</em>. The name of this foreign key column is formed
as the concatenation of the following: the name of the relationship
property or field of entity B; " <em>_ "; the name of the primary key
column in table <em>A</em>. The other foreign key column refers to table <em>B</em>
and has the same type as the primary key of table <em>B</em>. The name of this
foreign key column is formed as the concatenation of the following: the
name of the relationship property or field of entity A; " </em>_ "; the
name of the primary key column in table <em>B</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Project</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Employee&gt; employees;

    <span class="annotation">@ManyToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Collection</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Project&gt; projects;

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">employees</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Project&gt; getProjects() {
        <span class="keyword">return</span> projects;
    }

    <span class="directive">public</span> <span class="type">void</span> setProjects(<span class="predefined-type">Collection</span>&lt;Project&gt; projects) {
        <span class="local-variable">this</span>.projects = projects;
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Project</em> references a collection of Entity <em>Employee</em>.</p>
</li>
<li>
<p>Entity <em>Employee</em> references a collection of Entity <em>Project</em>.</p>
</li>
<li>
<p>Entity <em>Project</em> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Project</em> is mapped to a table named <em>PROJECT</em>.</p>
</li>
<li>
<p>Entity <em>Employee</em> is mapped to a table named <em>EMPLOYEE</em>.</p>
</li>
<li>
<p>There is a join table that is named
<em>PROJECT_EMPLOYEE</em> (owner name first). This join table has two foreign
key columns. One foreign key column refers to table <em>PROJECT</em> and has
the same type as the primary key of <em>PROJECT</em>. The name of this foreign
key column is <em>PROJECTS<em> &lt;PK of PROJECT&gt;, where &lt;PK of PROJECT&gt; denotes
the name of the primary key column of table _PROJECT</em>. The other
foreign key column refers to table <em>EMPLOYEE</em> and has the same type as
the primary key of <em>EMPLOYEE</em>. The name of this foreign key column is
<em>EMPLOYEES</em> &lt;PK of EMPLOYEE&gt;, where &lt;PK of EMPLOYEE&gt; denotes the name
of the primary key column of table _EMPLOYEE</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a758"><a class="anchor" href="#a758"></a>2.10.5. Unidirectional Multi-Valued Relationships</h4>
<div class="paragraph">
<p>Assuming that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A references a collection of Entity B.</p>
</li>
<li>
<p>Entity B does not reference Entity A.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A unidirectional relationship has only an owning side, which in this case must be Entity A.</p>
</div>
<div class="paragraph">
<p>The unidirectional multi-valued relationship
modeling case can be specified as either a unidirectional <em>OneToMany</em> or
as a unidirectional <em>ManyToMany</em> relationship.</p>
</div>
<div class="sect4">
<h5 id="a764"><a class="anchor" href="#a764"></a>2.10.5.1. Unidirectional OneToMany Relationships</h5>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity A is mapped to a table named <em>A</em>.</p>
</li>
<li>
<p>Entity B is mapped to a table named <em>B</em>.</p>
</li>
<li>
<p>There is a join table that is named <em>A_B</em>
(owner name first). This join table has two foreign key columns. One
foreign key column refers to table <em>A</em> and has the same type as the
primary key of table <em>A</em>. The name of this foreign key column is formed
as the concatenation of the following: the name of entity A; " <em>_ ";
the name of the primary key column in table <em>A</em>. The other foreign key
column refers to table <em>B</em> and has the same type as the primary key of
table <em>B</em> and there is a unique key constraint on it. The name of this
foreign key column is formed as the concatenation of the following: the
name of the relationship property or field of entity A; " </em>_ "; the
name of the primary key column in table <em>B</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;AnnualReview&gt; annualReviews;

    <span class="annotation">@OneToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;AnnualReview&gt; getAnnualReviews() {
        <span class="keyword">return</span> annualReviews;
    }

    <span class="directive">public</span> <span class="type">void</span> setAnnualReviews(<span class="predefined-type">Collection</span>&lt;AnnualReview&gt; annualReviews) {
        <span class="local-variable">this</span>.annualReviews = annualReviews;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">AnnualReview</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> references a collection of Entity <em>AnnualReview</em>.</p>
</li>
<li>
<p>Entity <em>AnnualReview</em> does not reference Entity <em>Employee</em>.</p>
</li>
<li>
<p>Entity <em>Employee</em> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> is mapped to a table named <em>EMPLOYEE</em>.</p>
</li>
<li>
<p>Entity <em>AnnualReview</em> is mapped to a table named <em>ANNUALREVIEW</em>.</p>
</li>
<li>
<p>There is a join table that is named
<em>EMPLOYEE_ANNUALREVIEW</em> (owner name first). This join table has two
foreign key columns. One foreign key column refers to table <em>EMPLOYEE</em>
and has the same type as the primary key of <em>EMPLOYEE</em>. This foreign
key column is named <em>EMPLOYEE<em> &lt;PK of EMPLOYEE&gt;, where &lt;PK of EMPLOYEE&gt;
denotes the name of the primary key column of table _EMPLOYEE</em>. The
other foreign key column refers to table <em>ANNUALREVIEW</em> and has the same
type as the primary key of <em>ANNUALREVIEW</em>. This foreign key column is
named <em>ANNUALREVIEWS</em> &lt;PK of ANNUALREVIEW&gt;, where &lt;PK of ANNUALREVIEW&gt;
denotes the name of the primary key column of table _ANNUALREVIEW</em>.
There is a unique key constraint on the foreign key that refers to table
<em>ANNUALREVIEW</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="a800"><a class="anchor" href="#a800"></a>2.10.5.2. Unidirectional ManyToMany Relationships</h5>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>A</em> is mapped to a table named <em>A</em>.</p>
</li>
<li>
<p>Entity <em>B</em> is mapped to a table named <em>B</em>.</p>
</li>
<li>
<p>There is a join table that is named <em>A_B</em>
(owner name first). This join table has two foreign key columns. One
foreign key column refers to table <em>A</em> and has the same type as the
primary key of table A. The name of this foreign key column is formed as
the concatenation of the following: the name of entity <em>A</em>; " <em>_ ";
the name of the primary key column in table <em>A</em>. The other foreign key
column refers to table <em>B</em> and has the same type as the primary key of
table <em>B</em>. The name of this foreign key column is formed as the
concatenation of the following: the name of the relationship property or
field of entity <em>A</em>; " </em>_ "; the name of the primary key column in
table <em>B</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Patent&gt; patents;

    <span class="annotation">@ManyToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Patent&gt; getPatents() {
        <span class="keyword">return</span> patents;
    }

    <span class="directive">public</span> <span class="type">void</span> setPatents(<span class="predefined-type">Collection</span>&lt;Patent&gt; patents) {
        <span class="local-variable">this</span>.patents = patents;
    }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Patent</span> {
    <span class="comment">//...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> references a collection of Entity <em>Patent</em>.</p>
</li>
<li>
<p>Entity <em>Patent</em> does not reference Entity <em>Employee</em>.</p>
</li>
<li>
<p>Entity <em>Employee</em> is the owner of the relationship.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following mapping defaults apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity <em>Employee</em> is mapped to a table named <em>EMPLOYEE</em>.</p>
</li>
<li>
<p>Entity <em>Patent</em> is mapped to a table named <em>PATENT</em>.</p>
</li>
<li>
<p>There is a join table that is named
<em>EMPLOYEE_PATENT</em> (owner name first). This join table has two foreign
key columns. One foreign key column refers to table <em>EMPLOYEE</em> and has
the same type as the primary key of <em>EMPLOYEE</em>. This foreign key column
is named <em>EMPLOYEE<em> &lt;PK of EMPLOYEE&gt;, where &lt;PK of EMPLOYEE&gt; denotes
the name of the primary key column of table _EMPLOYEE</em>. The other
foreign key column refers to table <em>PATENT</em> and has the same type as the
primary key of <em>PATENT</em>. This foreign key column is named <em>PATENTS</em>
&lt;PK of PATENT&gt;, where &lt;PK of PATENT&gt; denotes the name of the primary key
column of table _PATENT</em>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="inheritance"><a class="anchor" href="#inheritance"></a>2.11. Inheritance</h3>
<div class="paragraph">
<p>An entity may inherit from another entity
class. Entities support inheritance, polymorphic associations, and
polymorphic queries.</p>
</div>
<div class="paragraph">
<p>Both abstract and concrete classes can be
entities. Both abstract and concrete classes can be annotated with the
<em>Entity</em> annotation, mapped as entities, and queried for as entities.</p>
</div>
<div class="paragraph">
<p>Entities can extend non-entity classes and
non-entity classes can extend entity classes.</p>
</div>
<div class="paragraph">
<p>These concepts are described further in the
following sections.</p>
</div>
<div class="sect3">
<h4 id="abstract-entity-classes"><a class="anchor" href="#abstract-entity-classes"></a>2.11.1. Abstract Entity Classes</h4>
<div class="paragraph">
<p>An abstract class can be specified as an
entity. An abstract entity differs from a concrete entity only in that
it cannot be directly instantiated. An abstract entity is mapped as an
entity and can be the target of queries (which will operate over and/or
retrieve instances of its concrete subclasses).</p>
</div>
<div class="paragraph">
<p>An abstract entity class is annotated with
the <em>Entity</em> annotation or denoted in the XML descriptor as an entity.</p>
</div>
<div class="paragraph">
<p>The following example shows the use of an
abstract entity class in the entity inheritance hierarchy.</p>
</div>
<div class="paragraph">
<p><strong>Example: Abstract class as an Entity</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Inheritance</span>(strategy=JOINED)
<span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> empId;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">protected</span> Address address;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FT_EMP</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">FT</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">FT_EMPID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">FullTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// Inherit empId, but mapped in this class to FT_EMP.FT_EMPID</span>
    <span class="comment">// Inherit version mapped to EMP.VERSION</span>
    <span class="comment">// Inherit address mapped to EMP.ADDRESS fk</span>

    <span class="comment">// Defaults to FT_EMP.SALARY</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> salary;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PT_EMP</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">PT</span><span class="delimiter">&quot;</span></span>)
<span class="comment">// PK column is PT_EMP.EMPID due to _PrimaryKeyJoinColumn_ default</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PartTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="directive">protected</span> <span class="predefined-type">Float</span> hourlyWage;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapped-superclasses"><a class="anchor" href="#mapped-superclasses"></a>2.11.2. Mapped Superclasses</h4>
<div class="paragraph">
<p>An entity may inherit from a superclass that
provides persistent entity state and mapping information, but which is
not itself an entity. Typically, the purpose of such a mapped superclass
is to define state and mapping information that is common to multiple
entity classes.</p>
</div>
<div class="paragraph">
<p>A mapped superclass, unlike an entity, is not
queryable and must not be passed as an argument to <em>EntityManager</em> or
<em>Query</em> operations. Persistent relationships defined by a mapped
superclass must be unidirectional.</p>
</div>
<div class="paragraph">
<p>Both abstract and concrete classes may be
specified as mapped superclasses. The <em>MappedSuperclass</em> annotation (or
<em>mapped-superclass</em> XML descriptor element) is used to designate a
mapped superclass.</p>
</div>
<div class="paragraph">
<p>A class designated as a mapped superclass has
no separate table defined for it. Its mapping information is applied to
the entities that inherit from it.</p>
</div>
<div class="paragraph">
<p>A class designated as a mapped superclass can
be mapped in the same way as an entity except that the mappings will
apply only to its subclasses since no table exists for the mapped
superclass itself. When applied to the subclasses, the inherited
mappings will apply in the context of the subclass tables. Mapping
information can be overridden in such subclasses by using the
<em>AttributeOverride</em> and <em>AssociationOverride</em> annotations or
corresponding XML elements.</p>
</div>
<div class="paragraph">
<p>All other entity mapping defaults apply
equally to a class designated as a mapped superclass.</p>
</div>
<div class="paragraph">
<p>The following example illustrates the
definition of a concrete class as a mapped superclass.</p>
</div>
<div class="paragraph">
<p><strong>Example: Concrete class as a mapped superclass</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MappedSuperclass</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> empId;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="annotation">@ManyToOne</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">protected</span> Address address;

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getEmpId() { ... }

    <span class="directive">public</span> <span class="type">void</span> setEmpId(<span class="predefined-type">Integer</span> id) { ... }

    <span class="directive">public</span> Address getAddress() { ... }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address addr) { ... }
}

<span class="comment">// Default table is FTEMPLOYEE table</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">FTEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// Inherited empId field mapped to FTEMPLOYEE.EMPID</span>
    <span class="comment">// Inherited version field mapped to FTEMPLOYEE.VERSION</span>
    <span class="comment">// Inherited address field mapped to FTEMPLOYEE.ADDR fk</span>

    <span class="comment">// Defaults to FTEMPLOYEE.SALARY</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> salary;

    <span class="directive">public</span> FTEmployee() {}

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getSalary() { ... }

    <span class="directive">public</span> <span class="type">void</span> setSalary(<span class="predefined-type">Integer</span> salary) { ... }
}

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PT_EMP</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, joincolumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">PartTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// Inherited empId field mapped to PT_EMP.EMPID</span>
    <span class="comment">// Inherited version field mapped to PT_EMP.VERSION</span>
    <span class="comment">// address field mapping overridden to PT_EMP.ADDR_ID fk</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WAGE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">protected</span> <span class="predefined-type">Float</span> hourlyWage;

    <span class="directive">public</span> PartTimeEmployee() {}

    <span class="directive">public</span> <span class="predefined-type">Float</span> getHourlyWage() { ... }

    <span class="directive">public</span> <span class="type">void</span> setHourlyWage(<span class="predefined-type">Float</span> wage) { ... }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="non-entity-classes-in-the-entity-inheritance-hierarchy"><a class="anchor" href="#non-entity-classes-in-the-entity-inheritance-hierarchy"></a>2.11.3. Non-Entity Classes in the Entity Inheritance Hierarchy</h4>
<div class="paragraph">
<p>An entity can have a non-entity
superclass, which may be either a concrete or abstract
class.<sup class="footnote">[<a id="_footnoteref_22" class="footnote" href="#_footnotedef_22" title="View footnote.">22</a>]</sup></p>
</div>
<div class="paragraph">
<p>The non-entity superclass serves for
inheritance of behavior only. The state of a non-entity superclass is
not persistent. Any state inherited from non-entity superclasses is
non-persistent in an inheriting entity class. This non-persistent state
is not managed by the entity manager<sup class="footnote">[<a id="_footnoteref_23" class="footnote" href="#_footnotedef_23" title="View footnote.">23</a>]</sup>. Any
annotations on such superclasses are ignored.</p>
</div>
<div class="paragraph">
<p>Non-entity classes cannot be passed as
arguments to methods of the <em>EntityManager</em> or <em>Query</em>
interfaces<sup class="footnote">[<a id="_footnoteref_24" class="footnote" href="#_footnotedef_24" title="View footnote.">24</a>]</sup> and cannot bear mapping information.</p>
</div>
<div class="paragraph">
<p>The following example illustrates the use of
a non-entity class as a superclass of an entity.</p>
</div>
<div class="paragraph">
<p><strong>Example: Non-entity superclass</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Cart</span> {
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> operationCount; <span class="comment">// transient state</span>

    <span class="directive">public</span> Cart() {
        operationCount = <span class="integer">0</span>;
    }

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getOperationCount() {
        <span class="keyword">return</span> operationCount;
    }

    <span class="directive">public</span> <span class="type">void</span> incrementOperationCount() {
        operationCount++;
    }
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCart</span> <span class="directive">extends</span> Cart {
    <span class="predefined-type">Collection</span>&lt;Item&gt; items = <span class="keyword">new</span> <span class="predefined-type">Vector</span>&lt;Item&gt;();

    <span class="directive">public</span> ShoppingCart() {
        <span class="local-variable">super</span>();
    }

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Item&gt; getItems() {
        <span class="keyword">return</span> items;
    }

    <span class="directive">public</span> <span class="type">void</span> addItem(Item item) {
        items.add(item);
        incrementOperationCount();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a966"><a class="anchor" href="#a966"></a>2.12. Inheritance Mapping Strategies</h3>
<div class="paragraph">
<p>The mapping of class hierarchies is specified through metadata.</p>
</div>
<div class="paragraph">
<p>There are three basic strategies that are
used when mapping a class or class hierarchy to a relational database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a single table per class hierarchy</p>
</li>
<li>
<p>a joined subclass strategy, in which fields
that are specific to a subclass are mapped to a separate table than the
fields that are common to the parent class, and a join is performed to
instantiate the subclass.</p>
</li>
<li>
<p>a table per concrete entity class</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An implementation is required to support the
single table per class hierarchy inheritance mapping strategy and the
joined subclass strategy.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Support for the table per concrete class
inheritance mapping strategy is optional in this release. Applications
that use this mapping strategy will not be portable.</p>
</div>
<div class="paragraph">
<p>Support for the combination of inheritance
strategies within a single entity inheritance hierarchy is not required
by this specification.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="single-table-per-class-hierarchy-strategy"><a class="anchor" href="#single-table-per-class-hierarchy-strategy"></a>2.12.1. Single Table per Class Hierarchy Strategy</h4>
<div class="paragraph">
<p>In this strategy, all the classes in a
hierarchy are mapped to a single table. The table has a column that
serves as a “discriminator column”, that is, a column whose value
identifies the specific subclass to which the instance that is
represented by the row belongs.</p>
</div>
<div class="paragraph">
<p>This mapping strategy provides good support
for polymorphic relationships between entities and for queries that
range over the class hierarchy.</p>
</div>
<div class="paragraph">
<p>It has the drawback, however, that it
requires that the columns that correspond to state specific to the
subclasses be nullable.</p>
</div>
</div>
<div class="sect3">
<h4 id="joined-subclass-strategy"><a class="anchor" href="#joined-subclass-strategy"></a>2.12.2. Joined Subclass Strategy</h4>
<div class="paragraph">
<p>In the joined subclass strategy, the root of
the class hierarchy is represented by a single table. Each subclass is
represented by a separate table that contains those fields that are
specific to the subclass (not inherited from its superclass), as well as
the column(s) that represent its primary key. The primary key column(s)
of the subclass table serves as a foreign key to the primary key of the
superclass table.</p>
</div>
<div class="paragraph">
<p>This strategy provides support for
polymorphic relationships between entities.</p>
</div>
<div class="paragraph">
<p>It has the drawback that it requires that one
or more join operations be performed to instantiate instances of a
subclass. In deep class hierarchies, this may lead to unacceptable
performance. Queries that range over the class hierarchy likewise
require joins.</p>
</div>
</div>
<div class="sect3">
<h4 id="table-per-concrete-class-strategy"><a class="anchor" href="#table-per-concrete-class-strategy"></a>2.12.3. Table per Concrete Class Strategy</h4>
<div class="paragraph">
<p>In this mapping strategy, each class is
mapped to a separate table. All properties of the class, including
inherited properties, are mapped to columns of the table for the class.</p>
</div>
<div class="paragraph">
<p>This strategy has the following drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It provides poor support for polymorphic relationships.</p>
</li>
<li>
<p>It typically requires that SQL UNION queries
(or a separate SQL query per subclass) be issued for queries that are
intended to range over the class hierarchy.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a988"><a class="anchor" href="#a988"></a>2.13. Naming of Database Objects</h3>
<div class="paragraph">
<p>Many annotations and annotation elements
contain names of database objects or assume default names for database
objects.</p>
</div>
<div class="paragraph">
<p>This specification requires the following
with regard to the interpretation of the names referencing database
objects. These names include the names of tables, columns, and other
database elements. Such names also include names that result from
defaulting (e.g., a table name that is defaulted from an entity name or
a column name that is defaulted from a field or property name).</p>
</div>
<div class="paragraph">
<p>By default, the names of database objects
must be treated as undelimited identifiers and passed to the database as
such.</p>
</div>
<div class="paragraph">
<p>For example, assuming the use of an English
locale, the following must be passed to the database as undelimited
identifers so that they will be treated as equivalent for all databases
that comply with the SQL Standard&#8217;s requirements for the treatment of
“regular identifiers” (undelimited identifiers) and “delimited
identifiers” <a href="#a19494">[2]</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">Customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">cUsTomer</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, the following must be treated as equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ManyToOne</span> Customer customer;

<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ManyToOne</span> Customer customer;

<span class="annotation">@ManyToOne</span> Customer customer;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To specify delimited identifiers, one of the
following approaches must be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is possible to specify that all database
identifiers in use for a persistence unit be treated as delimited
identifiers by specifying the <em>&lt;delimited-identifiers/&gt;</em> element within
the <em>persistence-unit-defaults</em> element of the object/relational xml
mapping file. If the <em>&lt;delimited-identifiers/&gt;</em> element is specified, it
cannot be overridden.</p>
</li>
<li>
<p>It is possible to specify on a per-name basis
that a name for a database object is to be interpreted as a delimited
identifier as follows:</p>
<div class="ulist">
<ul>
<li>
<p>Using annotations, a name is specified as a
delimited identifier by enclosing the name within double quotes, whereby
the inner quotes are escaped, e.g., <code>@Table(name="\"customer\"")</code>.</p>
</li>
<li>
<p>When using XML, a name is specified as
a delimited identifier by use of double quotes, e.g., <code>&lt;table name="&amp;quot;customer&amp;quot;"/&gt;</code> <sup class="footnote">[<a id="_footnoteref_25" class="footnote" href="#_footnotedef_25" title="View footnote.">25</a>]</sup></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following annotations contain elements
whose values correspond to names of database identifiers and for which
the above rules apply, including when their use is nested within that of
other annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EntityResult(discriminatorColumn <strong>element</strong>)</p>
</li>
<li>
<p>FieldResult(column <strong>element</strong>)</p>
</li>
<li>
<p>ColumnResult(name <strong>element</strong>)</p>
</li>
<li>
<p>CollectionTable(name, catalog, schema <strong>elements</strong>)</p>
</li>
<li>
<p>Column(name, columnDefinition, table <strong>elements</strong>)</p>
</li>
<li>
<p>DiscriminatorColumn(name, columnDefinition <strong>elements</strong>)</p>
</li>
<li>
<p>ForeignKey(name, foreignKeyDefinition <strong>elements</strong>)</p>
</li>
<li>
<p>Index(name, columnList <strong>elements</strong>)</p>
</li>
<li>
<p>JoinColumn(name, referencedColumnName, columnDefinition, table <strong>elements</strong>)</p>
</li>
<li>
<p>JoinTable(name, catalog, schema <strong>elements</strong>)</p>
</li>
<li>
<p>MapKeyColumn(name, columnDefinition, table <strong>elements</strong>)</p>
</li>
<li>
<p>MapKeyJoinColumn(name, referencedColumnName, columnDefinition, table <strong>elements</strong>)</p>
</li>
<li>
<p>NamedStoredProcedureQuery(procedureName <strong>element</strong>)</p>
</li>
<li>
<p>OrderColumn(name, columnDefinition <strong>elements</strong>)</p>
</li>
<li>
<p>PrimaryKeyJoinColumn(name, referencedColumnName, columnDefinition <strong>elements</strong>)</p>
</li>
<li>
<p>SecondaryTable(name, catalog, schema <strong>elements</strong>)</p>
</li>
<li>
<p>SequenceGenerator(sequenceName, catalog, schema <strong>elements</strong>)</p>
</li>
<li>
<p>StoredProcedureParameter(name <strong>element</strong>)</p>
</li>
<li>
<p>Table(name, catalog, schema <strong>elements</strong>)</p>
</li>
<li>
<p>TableGenerator(table, catalog, schema, pkColumnName, valueColumnName <strong>elements</strong>)</p>
</li>
<li>
<p>UniqueConstraint(name, columnNames <strong>elements</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following XML elements and types contain
elements or attributes whose values correspond to names of database
identifiers and for which the above rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>entity-mappings(schema, catalog <strong>elements</strong>)</p>
</li>
<li>
<p>persistence-unit-defaults(schema, catalog <strong>elements</strong>)</p>
</li>
<li>
<p>collection-table(name, catalog, schema <strong>attributes</strong>)</p>
</li>
<li>
<p>column(name, table, column-definition <strong>attributes</strong>)</p>
</li>
<li>
<p>column-result(name <strong>attribute</strong>)</p>
</li>
<li>
<p>discriminator-column(name, column-definition <strong>attributes</strong>)</p>
</li>
<li>
<p>entity-result(discriminator-column <strong>attribute</strong>)</p>
</li>
<li>
<p>field-result(column <strong>attribute</strong>)</p>
</li>
<li>
<p>foreign-key(name, foreign-key-definition <strong>attributes</strong>)</p>
</li>
<li>
<p>index(name <strong>attribute</strong>, column-list <strong>element</strong>)</p>
</li>
<li>
<p>join-column(name, referenced-column-name, column-definition, table <strong>attributes</strong>)</p>
</li>
<li>
<p>join-table(name, catalog, schema <strong>attributes</strong>)</p>
</li>
<li>
<p>map-key-column(name, column-definition, table <strong>attributes</strong>)</p>
</li>
<li>
<p>map-key-join-column(name, referenced-column-name, column-definition, table <strong>attributes</strong>)</p>
</li>
<li>
<p>named-stored-procedure-query(procedure-name <strong>attribute</strong>)</p>
</li>
<li>
<p>order-column(name, column-definition <strong>attributes</strong>)</p>
</li>
<li>
<p>primary-key-join-column(name, referenced-column-name, column-definition <strong>attributes</strong>)</p>
</li>
<li>
<p>secondary-table(name, catalog, schema <strong>attributes</strong>)</p>
</li>
<li>
<p>sequence-generator(sequence-name, catalog, schema <strong>attributes</strong>)</p>
</li>
<li>
<p>stored-procedure-parameter(name <strong>attribute</strong>)</p>
</li>
<li>
<p>table(name, catalog, schema <strong>attributes</strong>)</p>
</li>
<li>
<p>table-generator(table, catalog, schema, pk-column-name, value-column-name <strong>attributes</strong>)</p>
</li>
<li>
<p>unique-constraint(name <strong>attribute</strong>, column-name <strong>element</strong>)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a1060"><a class="anchor" href="#a1060"></a>3. Entity Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the use of the
<em>EntityManager</em> API to manage the entity instance lifecycle and the use
of the <em>Query</em> API to retrieve and query entities and their persistent
state.</p>
</div>
<div class="sect2">
<h3 id="a1062"><a class="anchor" href="#a1062"></a>3.1. EntityManager</h3>
<div class="paragraph">
<p>An EntityManager instance is associated with
a persistence context. A persistence context is a set of entity
instances in which for any persistent entity identity there is a unique
entity instance. Within the persistence context, the entity instances
and their lifecycle are managed. The <em>EntityManager</em> interface defines
the methods that are used to interact with the persistence context. The
<em>EntityManager</em> API is used to create and remove persistent entity
instances, to find persistent entities by primary key, and to query over
persistent entities.</p>
</div>
<div class="paragraph">
<p>The set of entities that can be managed by a
given <em>EntityManager</em> instance is defined by a persistence unit. A
persistence unit defines the set of all classes that are related or
grouped by the application, and which must be colocated in their mapping
to a single database.</p>
</div>
<div class="paragraph">
<p><a href="#a1062">Section 3.1</a> defines the <em>EntityManager</em> interface. The entity
instance lifecycle is described in <a href="#a1929">Section 3.2</a>. The
relationships between entity managers and persistence contexts are
described in <a href="#a2027">Section 3.3</a> and in further detail in <a href="#a11431">Chapter 7</a>.
<a href="#a2052">Section 3.4</a> describes mechanisms for concurrency control and locking.
<a href="#a2153">Section 3.5</a> describes entity listeners and lifecycle callback methods for
entities. <a href="#a2366">Section 3.6</a> describes support for automatic use of Bean Validation.
<a href="#a2397">Section 3.7</a> describes the use of
entity graphs to control the path and boundaries of find and query
operations. <a href="#a2397">Section 3.7</a> describes mechanisms for defining conversions between entity
and database representations for attributes of basic types. <a href="#a3061">Section 3.9</a> describes mechanisms for
portable second-level cache configuration. The <em>Query</em>, <em>TypedQuery</em>,
<em>StoredProcedureQuery</em>, and related interfaces are described in <a href="#a3125">Section 3.10</a>. <a href="#a4639">Section 3.11</a> provides a
summary of exceptions. The Jakarta Persistence query language is defined in <a href="#a4665">Chapter 4</a> and the APIs for
the construction of Criteria queries in <a href="#a6925">Chapter 6</a>. The definition of
persistence units is described in <a href="#a12229">Chapter 8</a>.</p>
</div>
<div class="sect3">
<h4 id="a1066"><a class="anchor" href="#a1066"></a>3.1.1. EntityManager Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Metamodel</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaBuilder</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaQuery</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaUpdate</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaDelete</span>;

<span class="comment">/**
 * Interface used to interact with the persistence context.
 *
 * &lt;p&gt; An &lt;code&gt;EntityManager&lt;/code&gt; instance is associated with
 * a persistence context. A persistence context is a set of entity
 * instances in which for any persistent entity identity there is
 * a unique entity instance. Within the persistence context, the
 * entity instances and their lifecycle are managed.
 * The &lt;code&gt;EntityManager&lt;/code&gt; API is used
 * to create and remove persistent entity instances, to find entities
 * by their primary key, and to query over entities.
 *
 * &lt;p&gt; The set of entities that can be managed by a given
 * &lt;code&gt;EntityManager&lt;/code&gt; instance is defined by a persistence
 * unit. A persistence unit defines the set of all classes that are
 * related or grouped by the application, and which must be
 * colocated in their mapping to a single database.
 *
 * @see Query
 * @see TypedQuery
 * @see CriteriaQuery
 * @see PersistenceContext
 * @see StoredProcedureQuery
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityManager</span> {

    <span class="comment">/**
     * Make an instance managed and persistent.
     * @param entity  entity instance
     * @throws EntityExistsException if the entity already exists.
     * (If the entity already exists, the &lt;code&gt;EntityExistsException&lt;/code&gt; may
     * be thrown when the persist operation is invoked, or the
     * &lt;code&gt;EntityExistsException&lt;/code&gt; or another &lt;code&gt;PersistenceException&lt;/code&gt; may be
     * thrown at flush or commit time.)
     * @throws IllegalArgumentException if the instance is not an
     *         entity
     * @throws TransactionRequiredException if there is no transaction when
     *         invoked on a container-managed entity manager of that is of type
     *         &lt;code&gt;PersistenceContextType.TRANSACTION&lt;/code&gt;
     */</span>
    <span class="directive">public</span> <span class="type">void</span> persist(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Merge the state of the given entity into the
     * current persistence context.
     * @param entity  entity instance
     * @return the managed instance that the state was merged to
     * @throws IllegalArgumentException if instance is not an
     *         entity or is a removed entity
     * @throws TransactionRequiredException if there is no transaction when
     *         invoked on a container-managed entity manager of that is of type
     *         &lt;code&gt;PersistenceContextType.TRANSACTION&lt;/code&gt;
     */</span>
    <span class="directive">public</span> &lt;T&gt; T merge(T entity);

    <span class="comment">/**
     * Remove the entity instance.
     * @param entity  entity instance
     * @throws IllegalArgumentException if the instance is not an
     *         entity or is a detached entity
     * @throws TransactionRequiredException if invoked on a
     *         container-managed entity manager of type
     *         &lt;code&gt;PersistenceContextType.TRANSACTION&lt;/code&gt; and there is
     *         no transaction
     */</span>
    <span class="directive">public</span> <span class="type">void</span> remove(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Find by primary key.
     * Search for an entity of the specified class and primary key.
     * If the entity instance is contained in the persistence context,
     * it is returned from there.
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or the second argument is
     *         is not a valid type for that entity's primary key or
     *         is null
     */</span>
    <span class="directive">public</span> &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey);

    <span class="comment">/**
     * Find by primary key, using the specified properties.
     * Search for an entity of the specified class and primary key.
     * If the entity instance is contained in the persistence
     * context, it is returned from there.
     * If a vendor-specific property or hint is not recognized,
     * it is silently ignored.
     * @param entityClass  entity class
     * @param primaryKey   primary key
     * @param properties  standard and vendor-specific properties
     *        and hints
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or the second argument is
     *         is not a valid type for that entity's primary key or
     *         is null
     * @since 2.0
     */</span>
    <span class="directive">public</span> &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey,
                      <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Find by primary key and lock.
     * Search for an entity of the specified class and primary key
     * and lock it with respect to the specified lock type.
     * If the entity instance is contained in the persistence context,
     * it is returned from there, and the effect of this method is
     * the same as if the lock method had been called on the entity.
     * &lt;p&gt; If the entity is found within the persistence context and the
     * lock mode type is pessimistic and the entity has a version
     * attribute, the persistence provider must perform optimistic
     * version checks when obtaining the database lock.  If these
     * checks fail, the &lt;code&gt;OptimisticLockException&lt;/code&gt; will be thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt; the &lt;code&gt;PessimisticLockException&lt;/code&gt; will be thrown if the database
     *    locking failure causes transaction-level rollback
     * &lt;li&gt; the &lt;code&gt;LockTimeoutException&lt;/code&gt; will be thrown if the database
     *    locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @param lockMode  lock mode
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or the second argument is
     *         not a valid type for that entity's primary key or
     *         is null
     * @throws TransactionRequiredException if there is no
     *         transaction and a lock mode other than &lt;code&gt;NONE&lt;/code&gt; is
     *         specified or if invoked on an entity manager which has
     *         not been joined to the current transaction and a lock
     *         mode other than &lt;code&gt;NONE&lt;/code&gt; is specified
     * @throws OptimisticLockException if the optimistic version
     *         check fails
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call
     *         is made
     * @since 2.0
     */</span>
    <span class="directive">public</span> &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey,
                      LockModeType lockMode);

    <span class="comment">/**
     * Find by primary key and lock, using the specified properties.
     * Search for an entity of the specified class and primary key
     * and lock it with respect to the specified lock type.
     * If the entity instance is contained in the persistence context,
     * it is returned from there.
     * &lt;p&gt; If the entity is found
     * within the persistence context and the lock mode type
     * is pessimistic and the entity has a version attribute, the
     * persistence provider must perform optimistic version checks
     * when obtaining the database lock.  If these checks fail,
     * the &lt;code&gt;OptimisticLockException&lt;/code&gt; will be thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt; the &lt;code&gt;PessimisticLockException&lt;/code&gt; will be thrown if the database
     *    locking failure causes transaction-level rollback
     * &lt;li&gt; the &lt;code&gt;LockTimeoutException&lt;/code&gt; will be thrown if the database
     *    locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific property or hint is not recognized,
     * it is silently ignored.
     * &lt;p&gt;Portable applications should not rely on the standard timeout
     * hint. Depending on the database in use and the locking
     * mechanisms used by the provider, the hint may or may not
     * be observed.
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @param lockMode  lock mode
     * @param properties  standard and vendor-specific properties
     *        and hints
     * @return the found entity instance or null if the entity does
     *         not exist
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or the second argument is
     *         not a valid type for that entity's primary key or
     *         is null
     * @throws TransactionRequiredException if there is no
     *         transaction and a lock mode other than &lt;code&gt;NONE&lt;/code&gt; is
     *         specified or if invoked on an entity manager which has
     *         not been joined to the current transaction and a lock
     *         mode other than &lt;code&gt;NONE&lt;/code&gt; is specified
     * @throws OptimisticLockException if the optimistic version
     *         check fails
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call
     *         is made
     * @since 2.0
     */</span>
    <span class="directive">public</span> &lt;T&gt; T find(<span class="predefined-type">Class</span>&lt;T&gt; entityClass, <span class="predefined-type">Object</span> primaryKey,
                      LockModeType lockMode,
                      <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Get an instance, whose state may be lazily fetched.
     * If the requested instance does not exist in the database,
     * the &lt;code&gt;EntityNotFoundException&lt;/code&gt; is thrown when the instance
     * state is first accessed. (The persistence provider runtime is
     * permitted to throw the &lt;code&gt;EntityNotFoundException&lt;/code&gt; when
     * &lt;code&gt;getReference&lt;/code&gt; is called.)
     * The application should not expect that the instance state will
     * be available upon detachment, unless it was accessed by the
     * application while the entity manager was open.
     * @param entityClass  entity class
     * @param primaryKey  primary key
     * @return the found entity instance
     * @throws IllegalArgumentException if the first argument does
     *         not denote an entity type or the second argument is
     *         not a valid type for that entity's primary key or
     *         is null
     * @throws EntityNotFoundException if the entity state
     *         cannot be accessed
     */</span>
    <span class="directive">public</span> &lt;T&gt; T getReference(<span class="predefined-type">Class</span>&lt;T&gt; entityClass,
                                  <span class="predefined-type">Object</span> primaryKey);

    <span class="comment">/**
     * Synchronize the persistence context to the
     * underlying database.
     * @throws TransactionRequiredException if there is
     *         no transaction or if the entity manager has not been
     *         joined to the current transaction
     * @throws PersistenceException if the flush fails
     */</span>
    <span class="directive">public</span> <span class="type">void</span> flush();

    <span class="comment">/**
     * Set the flush mode that applies to all objects contained
     * in the persistence context.
     * @param flushMode  flush mode
     */</span>
    <span class="directive">public</span> <span class="type">void</span> setFlushMode(FlushModeType flushMode);

    <span class="comment">/**
     * Get the flush mode that applies to all objects contained
     * in the persistence context.
     * @return flushMode
     */</span>
    <span class="directive">public</span> FlushModeType getFlushMode();

    <span class="comment">/**
     * Lock an entity instance that is contained in the persistence
     * context with the specified lock mode type.
     * &lt;p&gt;If a pessimistic lock mode type is specified and the entity
     * contains a version attribute, the persistence provider must
     * also perform optimistic version checks when obtaining the
     * database lock.  If these checks fail, the
     * &lt;code&gt;OptimisticLockException&lt;/code&gt; will be thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt; the &lt;code&gt;PessimisticLockException&lt;/code&gt; will be thrown if the database
     *    locking failure causes transaction-level rollback
     * &lt;li&gt; the &lt;code&gt;LockTimeoutException&lt;/code&gt; will be thrown if the database
     *    locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * @param entity  entity instance
     * @param lockMode  lock mode
     * @throws IllegalArgumentException if the instance is not an
     *         entity or is a detached entity
     * @throws TransactionRequiredException if there is no
     *         transaction or if invoked on an entity manager which
     *         has not been joined to the current transaction
     * @throws EntityNotFoundException if the entity does not exist
     *         in the database when pessimistic locking is
     *         performed
     * @throws OptimisticLockException if the optimistic version
     *         check fails
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call
     *         is made
     */</span>
    <span class="directive">public</span> <span class="type">void</span> lock(<span class="predefined-type">Object</span> entity, LockModeType lockMode);

    <span class="comment">/**
     * Lock an entity instance that is contained in the persistence
     * context with the specified lock mode type and with specified
     * properties.
     * &lt;p&gt;If a pessimistic lock mode type is specified and the entity
     * contains a version attribute, the persistence provider must
     * also perform optimistic version checks when obtaining the
     * database lock.  If these checks fail, the
     * &lt;code&gt;OptimisticLockException&lt;/code&gt; will be thrown.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt; the &lt;code&gt;PessimisticLockException&lt;/code&gt; will be thrown if the database
     *    locking failure causes transaction-level rollback
     * &lt;li&gt; the &lt;code&gt;LockTimeoutException&lt;/code&gt; will be thrown if the database
     *    locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific property or hint is not recognized,
     * it is silently ignored.
     * &lt;p&gt;Portable applications should not rely on the standard timeout
     * hint. Depending on the database in use and the locking
     * mechanisms used by the provider, the hint may or may not
     * be observed.
     * @param entity  entity instance
     * @param lockMode  lock mode
     * @param properties  standard and vendor-specific properties
     *        and hints
     * @throws IllegalArgumentException if the instance is not an
     *         entity or is a detached entity
     * @throws TransactionRequiredException if there is no
     *         transaction or if invoked on an entity manager which
     *         has not been joined to the current transaction
     * @throws EntityNotFoundException if the entity does not exist
     *         in the database when pessimistic locking is
     *         performed
     * @throws OptimisticLockException if the optimistic version
     *         check fails
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call
     *         is made
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="type">void</span> lock(<span class="predefined-type">Object</span> entity, LockModeType lockMode,
                     <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Refresh the state of the instance from the database,
     * overwriting changes made to the entity, if any.
     * @param entity  entity instance
     * @throws IllegalArgumentException if the instance is not
     *         an entity or the entity is not managed
     * @throws TransactionRequiredException if there is no
     *         transaction when invoked on a container-managed
     *         entity manager of type &lt;code&gt;PersistenceContextType.TRANSACTION&lt;/code&gt;
     * @throws EntityNotFoundException if the entity no longer
     *         exists in the database
     */</span>
    <span class="directive">public</span> <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Refresh the state of the instance from the database, using
     * the specified properties, and overwriting changes made to
     * the entity, if any.
     * &lt;p&gt; If a vendor-specific property or hint is not recognized,
     * it is silently ignored.
     * @param entity  entity instance
     * @param properties  standard and vendor-specific properties
     *        and hints
     * @throws IllegalArgumentException if the instance is not
     *         an entity or the entity is not managed
     * @throws TransactionRequiredException if there is no
     *         transaction when invoked on a container-managed
     *         entity manager of type &lt;code&gt;PersistenceContextType.TRANSACTION&lt;/code&gt;
     * @throws EntityNotFoundException if the entity no longer
     *         exists in the database
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity,
                            <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Refresh the state of the instance from the database,
     * overwriting changes made to the entity, if any, and
     * lock it with respect to given lock mode type.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt; the &lt;code&gt;PessimisticLockException&lt;/code&gt; will be thrown if the database
     *    locking failure causes transaction-level rollback
     * &lt;li&gt; the &lt;code&gt;LockTimeoutException&lt;/code&gt; will be thrown if the
     *    database locking failure causes only statement-level
     *    rollback.
     * &lt;/ul&gt;
     * @param entity  entity instance
     * @param lockMode  lock mode
     * @throws IllegalArgumentException if the instance is not
     *         an entity or the entity is not managed
     * @throws TransactionRequiredException if invoked on a
     *         container-managed entity manager of type
     *         &lt;code&gt;PersistenceContextType.TRANSACTION&lt;/code&gt; when there is
     *         no transaction; if invoked on an extended entity manager when
     *         there is no transaction and a lock mode other than &lt;code&gt;NONE&lt;/code&gt;
     *         has been specified; or if invoked on an extended entity manager
     *         that has not been joined to the current transaction and a
     *         lock mode other than &lt;code&gt;NONE&lt;/code&gt; has been specified
     * @throws EntityNotFoundException if the entity no longer exists
     *         in the database
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call
     *         is made
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity, LockModeType lockMode);

    <span class="comment">/**
     * Refresh the state of the instance from the database,
     * overwriting changes made to the entity, if any, and
     * lock it with respect to given lock mode type and with
     * specified properties.
     * &lt;p&gt;If the lock mode type is pessimistic and the entity instance
     * is found but cannot be locked:
     * &lt;ul&gt;
     * &lt;li&gt; the &lt;code&gt;PessimisticLockException&lt;/code&gt; will be thrown if the database
     *    locking failure causes transaction-level rollback
     * &lt;li&gt; the &lt;code&gt;LockTimeoutException&lt;/code&gt; will be thrown if the database
     *    locking failure causes only statement-level rollback
     * &lt;/ul&gt;
     * &lt;p&gt;If a vendor-specific property or hint is not recognized,
     *    it is silently ignored.
     * &lt;p&gt;Portable applications should not rely on the standard timeout
     * hint. Depending on the database in use and the locking
     * mechanisms used by the provider, the hint may or may not
     * be observed.
     * @param entity  entity instance
     * @param lockMode  lock mode
     * @param properties  standard and vendor-specific properties
     *        and hints
     * @throws IllegalArgumentException if the instance is not
     *         an entity or the entity is not managed
     * @throws TransactionRequiredException if invoked on a
     *         container-managed entity manager of type
     *         &lt;code&gt;PersistenceContextType.TRANSACTION&lt;/code&gt; when there is
     *         no transaction; if invoked on an extended entity manager when
     *         there is no transaction and a lock mode other than &lt;code&gt;NONE&lt;/code&gt;
     *         has been specified; or if invoked on an extended entity manager
     *         that has not been joined to the current transaction and a
     *         lock mode other than &lt;code&gt;NONE&lt;/code&gt; has been specified
     * @throws EntityNotFoundException if the entity no longer exists
     *         in the database
     * @throws PessimisticLockException if pessimistic locking fails
     *         and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking fails and
     *         only the statement is rolled back
     * @throws PersistenceException if an unsupported lock call
     *         is made
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="type">void</span> refresh(<span class="predefined-type">Object</span> entity, LockModeType lockMode,
                        <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; properties);

    <span class="comment">/**
     * Clear the persistence context, causing all managed
     * entities to become detached. Changes made to entities that
     * have not been flushed to the database will not be
     * persisted.
     */</span>
    <span class="directive">public</span> <span class="type">void</span> clear();

    <span class="comment">/**
     * Remove the given entity from the persistence context, causing
     * a managed entity to become detached.  Unflushed changes made
     * to the entity if any (including removal of the entity),
     * will not be synchronized to the database.  Entities which
     * previously referenced the detached entity will continue to
     * reference it.
     * @param entity  entity instance
     * @throws IllegalArgumentException if the instance is not an
     *         entity
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="type">void</span> detach(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Check if the instance is a managed entity instance belonging
     * to the current persistence context.
     * @param entity  entity instance
     * @return boolean indicating if entity is in persistence context
     * @throws IllegalArgumentException if not an entity
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> contains(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Get the current lock mode for the entity instance.
     * @param entity  entity instance
     * @return lock mode
     * @throws TransactionRequiredException if there is no
     *         transaction or if the entity manager has not been
     *         joined to the current transaction
     * @throws IllegalArgumentException if the instance is not a
     *         managed entity and a transaction is active
     * @since 2.0
     */</span>
    <span class="directive">public</span> LockModeType getLockMode(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     * Set an entity manager property or hint.
     * If a vendor-specific property or hint is not recognized, it is
     * silently ignored.
     * @param propertyName name of property or hint
     * @param value  value for property or hint
     * @throws IllegalArgumentException if the second argument is
     *         not valid for the implementation
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="type">void</span> setProperty(<span class="predefined-type">String</span> propertyName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Get the properties and hints and associated values that are in effect
     * for the entity manager. Changing the contents of the map does
     * not change the configuration in effect.
     * @return map of properties and hints in effect for entity manager
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getProperties();

    <span class="comment">/**
     * Create an instance of &lt;code&gt;Query&lt;/code&gt; for executing a
     * Jakarta Persistence query language statement.
     * @param qlString a Jakarta Persistence query string
     * @return the new query instance
     * @throws IllegalArgumentException if the query string is
     *         found to be invalid
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Query</span> createQuery(<span class="predefined-type">String</span> qlString);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;TypedQuery&lt;/code&gt; for executing a
     * criteria query.
     * @param criteriaQuery  a criteria query object
     * @return the new query instance
     * @throws IllegalArgumentException if the criteria query is
     *         found to be invalid
     * @since 2.0
     */</span>
    <span class="directive">public</span> &lt;T&gt; TypedQuery&lt;T&gt; createQuery(CriteriaQuery&lt;T&gt; criteriaQuery);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;Query&lt;/code&gt; for executing a criteria
     * update query.
     * @param updateQuery  a criteria update query object
     * @return the new query instance
     * @throws IllegalArgumentException if the update query is
     *         found to be invalid
     * @since 2.1
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Query</span> createQuery(CriteriaUpdate updateQuery);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;Query&lt;/code&gt; for executing a criteria
     * delete query.
     * @param deleteQuery  a criteria delete query object
     * @return the new query instance
     * @throws IllegalArgumentException if the delete query is
     *         found to be invalid
     * @since 2.1
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Query</span> createQuery(CriteriaDelete deleteQuery);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;TypedQuery&lt;/code&gt; for executing a
     * Jakarta Persistence query language statement.
     * The select list of the query must contain only a single
     * item, which must be assignable to the type specified by
     * the &lt;code&gt;resultClass&lt;/code&gt; argument.
     * @param qlString a Jakarta Persistence query string
     * @param resultClass the type of the query result
     * @return the new query instance
     * @throws IllegalArgumentException if the query string is found
     *         to be invalid or if the query result is found to
     *         not be assignable to the specified type
     * @since 2.0
     */</span>
    <span class="directive">public</span> &lt;T&gt; TypedQuery&lt;T&gt; createQuery(<span class="predefined-type">String</span> qlString, <span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;Query&lt;/code&gt; for executing a named query
     * (in the Jakarta Persistence query language or in native SQL).
     * @param name the name of a query defined in metadata
     * @return the new query instance
     * @throws IllegalArgumentException if a query has not been
     *         defined with the given name or if the query string is
     *         found to be invalid
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Query</span> createNamedQuery(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;TypedQuery&lt;/code&gt; for executing a
     * Jakarta Persistence query language named query.
     * The select list of the query must contain only a single
     * item, which must be assignable to the type specified by
     * the &lt;code&gt;resultClass&lt;/code&gt; argument.
     * @param name the name of a query defined in metadata
     * @param resultClass the type of the query result
     * @return the new query instance
     * @throws IllegalArgumentException if a query has not been
     *         defined with the given name or if the query string is
     *         found to be invalid or if the query result is found to
     *         not be assignable to the specified type
     * @since 2.0
     */</span>
    <span class="directive">public</span> &lt;T&gt; TypedQuery&lt;T&gt; createNamedQuery(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;Query&lt;/code&gt; for executing
     * a native SQL statement, e.g., for update or delete.
     * If the query is not an update or delete query, query
     * execution will result in each row of the SQL result
     * being returned as a result of type Object[] (or a result
     * of type Object if there is only one column in the select
     * list.)  Column values are returned in the order of their
     * appearance in the select list and default JDBC type
     * mappings are applied.
     * @param sqlString a native SQL query string
     * @return the new query instance
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Query</span> createNativeQuery(<span class="predefined-type">String</span> sqlString);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;Query&lt;/code&gt; for executing
     * a native SQL query.
     * @param sqlString a native SQL query string
     * @param resultClass the class of the resulting instance(s)
     * @return the new query instance
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Query</span> createNativeQuery(<span class="predefined-type">String</span> sqlString, <span class="predefined-type">Class</span> resultClass);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;Query&lt;/code&gt; for executing
     * a native SQL query.
     * @param sqlString a native SQL query string
     * @param resultSetMapping the name of the result set mapping
     * @return the new query instance
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Query</span> createNativeQuery(<span class="predefined-type">String</span> sqlString, <span class="predefined-type">String</span> resultSetMapping);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;StoredProcedureQuery&lt;/code&gt; for executing a
     * stored procedure in the database.
     * &lt;p&gt;Parameters must be registered before the stored procedure can
     * be executed.
     * &lt;p&gt;If the stored procedure returns one or more result sets,
     * any result set will be returned as a list of type Object[].
     * @param name name assigned to the stored procedure query
     * in metadata
     * @return the new stored procedure query instance
     * @throws IllegalArgumentException if a query has not been
     * defined with the given name
     * @since 2.1
     */</span>
    <span class="directive">public</span> StoredProcedureQuery createNamedStoredProcedureQuery(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;StoredProcedureQuery&lt;/code&gt; for executing a
     * stored procedure in the database.
     * &lt;p&gt;Parameters must be registered before the stored procedure can
     * be executed.
     * &lt;p&gt;If the stored procedure returns one or more result sets,
     * any result set will be returned as a list of type Object[].
     * @param procedureName name of the stored procedure in the
     * database
     * @return the new stored procedure query instance
     * @throws IllegalArgumentException if a stored procedure of the
     * given name does not exist (or the query execution will
     * fail)
     * @since 2.1
     */</span>
    <span class="directive">public</span> StoredProcedureQuery createStoredProcedureQuery(<span class="predefined-type">String</span> procedureName);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;StoredProcedureQuery&lt;/code&gt; for executing a
     * stored procedure in the database.
     * &lt;p&gt;Parameters must be registered before the stored procedure can
     * be executed.
     * &lt;p&gt;The &lt;code&gt;resultClass&lt;/code&gt; arguments must be specified in the order in
     * which the result sets will be returned by the stored procedure
     * invocation.
     * @param procedureName name of the stored procedure in the
     * database
     * @param resultClasses classes to which the result sets
     * produced by the stored procedure are to
     * be mapped
     * @return the new stored procedure query instance
     * @throws IllegalArgumentException if a stored procedure of the
     * given name does not exist (or the query execution will
     * fail)
     * @since 2.1
     */</span>
    <span class="directive">public</span> StoredProcedureQuery createStoredProcedureQuery(
               <span class="predefined-type">String</span> procedureName, <span class="predefined-type">Class</span>... resultClasses);

    <span class="comment">/**
     * Create an instance of &lt;code&gt;StoredProcedureQuery&lt;/code&gt; for executing a
     * stored procedure in the database.
     * &lt;p&gt;Parameters must be registered before the stored procedure can
     * be executed.
     * &lt;p&gt;The &lt;code&gt;resultSetMapping&lt;/code&gt; arguments must be specified in the order
     * in which the result sets will be returned by the stored
     * procedure invocation.
     * @param procedureName name of the stored procedure in the
     *        database
     * @param resultSetMappings the names of the result set mappings
     *        to be used in mapping result sets
     *        returned by the stored procedure
     * @return the new stored procedure query instance
     * @throws IllegalArgumentException if a stored procedure or
     *         result set mapping of the given name does not exist
     *         (or the query execution will fail)
     */</span>
    <span class="directive">public</span> StoredProcedureQuery createStoredProcedureQuery(
              <span class="predefined-type">String</span> procedureName, <span class="predefined-type">String</span>... resultSetMappings);

    <span class="comment">/**
     * Indicate to the entity manager that a JTA transaction is
     * active and join the persistence context to it.
     * &lt;p&gt;This method should be called on a JTA application
     * managed entity manager that was created outside the scope
     * of the active transaction or on an entity manager of type
     * &lt;code&gt;SynchronizationType.UNSYNCHRONIZED&lt;/code&gt; to associate
     * it with the current JTA transaction.
     * @throws TransactionRequiredException if there is
     *         no transaction
     */</span>
    <span class="directive">public</span> <span class="type">void</span> joinTransaction();

    <span class="comment">/**
     * Determine whether the entity manager is joined to the
     * current transaction. Returns false if the entity manager
     * is not joined to the current transaction or if no
     * transaction is active
     * @return boolean
     * @since 2.1
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isJoinedToTransaction();

    <span class="comment">/**
     * Return an object of the specified type to allow access to the
     * provider-specific API.   If the provider's &lt;code&gt;EntityManager&lt;/code&gt;
     * implementation does not support the specified class, the
     * &lt;code&gt;PersistenceException&lt;/code&gt; is thrown.
     * @param cls  the class of the object to be returned.  This is
     * normally either the underlying &lt;code&gt;EntityManager&lt;/code&gt; implementation
     * class or an interface that it implements.
     * @return an instance of the specified class
     * @throws PersistenceException if the provider does not
     *         support the call
     * @since 2.0
     */</span>
    <span class="directive">public</span> &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; cls);

    <span class="comment">/**
     * Return the underlying provider object for the &lt;code&gt;EntityManager&lt;/code&gt;,
     * if available. The result of this method is implementation
     * specific.
     * &lt;p&gt;The &lt;code&gt;unwrap&lt;/code&gt; method is to be preferred for new applications.
     * @return underlying provider object for EntityManager
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> getDelegate();

    <span class="comment">/**
     * Close an application-managed entity manager.
     * After the close method has been invoked, all methods
     * on the &lt;code&gt;EntityManager&lt;/code&gt; instance and any
     * &lt;code&gt;Query&lt;/code&gt;, &lt;code&gt;TypedQuery&lt;/code&gt;, and
     * &lt;code&gt;StoredProcedureQuery&lt;/code&gt; objects obtained from
     * it will throw the &lt;code&gt;IllegalStateException&lt;/code&gt;
     * except for &lt;code&gt;getProperties&lt;/code&gt;,
     * &lt;code&gt;getTransaction&lt;/code&gt;, and &lt;code&gt;isOpen&lt;/code&gt; (which will return false).
     * If this method is called when the entity manager is
     * joined to an active transaction, the persistence
     * context remains managed until the transaction completes.
     * @throws IllegalStateException if the entity manager
     *         is container-managed
     */</span>
    <span class="directive">public</span> <span class="type">void</span> close();

    <span class="comment">/**
     * Determine whether the entity manager is open.
     * @return true until the entity manager has been closed
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isOpen();

    <span class="comment">/**
     * Return the resource-level &lt;code&gt;EntityTransaction&lt;/code&gt; object.
     * The &lt;code&gt;EntityTransaction&lt;/code&gt; instance may be used serially to
     * begin and commit multiple transactions.
     * @return EntityTransaction instance
     * @throws IllegalStateException if invoked on a JTA
     *         entity manager
     */</span>
    <span class="directive">public</span> EntityTransaction getTransaction();

    <span class="comment">/**
     * Return the entity manager factory for the entity manager.
     * @return EntityManagerFactory instance
     * @throws IllegalStateException if the entity manager has
     *         been closed
     * @since 2.0
     */</span>
    <span class="directive">public</span> EntityManagerFactory getEntityManagerFactory();

    <span class="comment">/**
     * Return an instance of &lt;code&gt;CriteriaBuilder&lt;/code&gt; for the creation of
     * &lt;code&gt;CriteriaQuery&lt;/code&gt; objects.
     * @return CriteriaBuilder instance
     * @throws IllegalStateException if the entity manager has
     *         been closed
     * @since 2.0
     */</span>
    <span class="directive">public</span> CriteriaBuilder getCriteriaBuilder();

    <span class="comment">/**
     * Return an instance of &lt;code&gt;Metamodel&lt;/code&gt; interface for access to the
     * metamodel of the persistence unit.
     * @return Metamodel instance
     * @throws IllegalStateException if the entity manager has
     *         been closed
     * @since 2.0
     */</span>
    <span class="directive">public</span> Metamodel getMetamodel();

    <span class="comment">/**
     * Return a mutable EntityGraph that can be used to dynamically create an
     * EntityGraph.
     * @param rootType class of entity graph
     * @return entity graph
     * @since 2.1
     */</span>
    <span class="directive">public</span> &lt;T&gt; EntityGraph&lt;T&gt; createEntityGraph(<span class="predefined-type">Class</span>&lt;T&gt; rootType);

    <span class="comment">/**
     * Return a mutable copy of the named EntityGraph.  If there
     * is no entity graph with the specified name, null is returned.
     * @param graphName name of an entity graph
     * @return entity graph
     * @since 2.1
     */</span>
    <span class="directive">public</span> EntityGraph&lt;?&gt; createEntityGraph(<span class="predefined-type">String</span> graphName);

    <span class="comment">/**
     * Return a named EntityGraph. The returned EntityGraph
     * should be considered immutable.
     * @param graphName  name of an existing entity graph
     * @return named entity graph
     * @throws IllegalArgumentException if there is no EntityGraph of
     *         the given name
     * @since 2.1
     */</span>
    <span class="directive">public</span> EntityGraph&lt;?&gt; getEntityGraph(<span class="predefined-type">String</span> graphName);

    <span class="comment">/**
     * Return all named EntityGraphs that have been defined for the provided
     * class type.
     * @param entityClass  entity class
     * @return list of all entity graphs defined for the entity
     * @throws IllegalArgumentException if the class is not an entity
     * @since 2.1
     */</span>
    <span class="directive">public</span> &lt;T&gt; <span class="predefined-type">List</span>&lt;EntityGraph&lt;? <span class="local-variable">super</span> T&gt;&gt; getEntityGraphs(<span class="predefined-type">Class</span>&lt;T&gt; entityClass);

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The semantics of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>public &lt;T&gt; TypedQuery&lt;T&gt; createQuery(String qlString, Class&lt;T&gt; resultClass)</pre>
</div>
</div>
<div class="paragraph">
<p>method may be extended in a future release of this specification to
support other result types. Applications that specify other result types
(e.g., Tuple.class) will not be portable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The semantics</p>
</div>
<div class="literalblock">
<div class="content">
<pre>public &lt;T&gt; TypedQuery&lt;T&gt; createNamedQuery(String name, Class&lt;T&gt; resultClass)</pre>
</div>
</div>
<div class="paragraph">
<p>method may be extended in a future release of this specification to
support other result types. Applications that specify other result types
(e.g., Tuple.class) will not be portable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <em>persist</em>, <em>merge</em>, <em>remove</em>, and
<em>refresh</em> methods must be invoked within a transaction context when an
entity manager with a transaction-scoped persistence context is used. If
there is no transaction context, the
<em>jakarta.persistence.TransactionRequiredException</em> is thrown.</p>
</div>
<div class="paragraph">
<p>Methods that specify a lock mode other than
<em>LockModeType.NONE</em> must be invoked within a transaction. If there is no
transaction or if the entity manager has not been joined to the
transaction, the <em>jakarta.persistence.TransactionRequiredException</em> is
thrown.</p>
</div>
<div class="paragraph">
<p>The <em>find</em> method (provided it is invoked
without a lock or invoked with <em>LockModeType.NONE</em>) and the
<em>getReference</em> method are not required to be invoked within a
transaction. If an entity manager with transaction-scoped persistence
context is in use, the resulting entities will be detached; if an entity
manager with an extended persistence context is used, they will be
managed. See <a href="#a2027">Section 3.3</a> for entity manager use outside a
transaction.</p>
</div>
<div class="paragraph">
<p>The <em>Query</em>, <em>TypedQuery</em>,
<em>StoredProcedureQuery</em>, <em>CriteriaBuilder</em>, <em>Metamodel</em>, and
<em>EntityTransaction</em> objects obtained from an entity manager are valid
while that entity manager is open.</p>
</div>
<div class="paragraph">
<p>If the argument to the <em>createQuery</em> method
is not a valid Jakarta Persistence query string or a valid <em>CriteriaQuery</em>
object, the <em>IllegalArgumentException</em> may be thrown or the query
execution will fail and a <em>PersistenceException</em> will be thrown. If the
result class specification of a Jakarta Persistence query language query is
incompatible with the result of the query, the
<em>IllegalArgumentException</em> may be thrown when the <em>createQuery</em> method
is invoked or the query execution will fail and a <em>PersistenceException</em>
will be thrown when the query is executed. If a native query is not a
valid query for the database in use or if the result set specification
is incompatible with the result of the query, the query execution will
fail and a <em>PersistenceException</em> will be thrown when the query is
executed. The <em>PersistenceException</em> should wrap the underlying database
exception when possible.</p>
</div>
<div class="paragraph">
<p>Runtime exceptions thrown by the methods of
the <em>EntityManager</em> interface other than the <em>LockTimeoutException</em> will
cause the current transaction to be marked for rollback if the
persistence context is joined to that transaction.</p>
</div>
<div class="paragraph">
<p>The methods <em>close</em>, <em>isOpen</em>,
<em>joinTransaction</em>, and <em>getTransaction</em> are used to manage
application-managed entity managers and their lifecycle. See <a href="#a11465">Section 7.2.2</a>.</p>
</div>
<div class="paragraph">
<p>The <em>EntityManager</em> interface and other
interfaces defined by this specification contain methods that take
properties and/or hints as arguments. This specification distinguishes
between <em>properties</em> and <em>hints</em> as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A property defined by this specification must
be observed by the provider unless otherwise explicitly stated.</p>
</li>
<li>
<p>A hint specifies a preference on the part of
the application. While a hint defined by this specification should be
observed by the provider if possible, a hint may or may not always be
observed. A portable application must not depend on the observance of a
hint.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-of-use-of-entitymanager-api"><a class="anchor" href="#example-of-use-of-entitymanager-api"></a>3.1.2. Example of Use of EntityManager API</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">OrderEntryBean</span> <span class="directive">implements</span> OrderEntry {
    <span class="annotation">@PersistenceContext</span>
    EntityManager em;

    <span class="directive">public</span> <span class="type">void</span> enterOrder(<span class="type">int</span> custID, Order newOrder) {
        Customer cust = em.find(Customer.class, custID);
        cust.getOrders().add(newOrder);
        newOrder.setCustomer(cust);
        em.persist(newOrder);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a1929"><a class="anchor" href="#a1929"></a>3.2. Entity Instance&#8217;s Life Cycle</h3>
<div class="paragraph">
<p>This section describes the <em>EntityManager</em>
operations for managing an entity instance&#8217;s lifecycle. An entity
instance can be characterized as being new, managed, detached, or
removed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A new entity instance has no persistent
identity, and is not yet associated with a persistence context.</p>
</li>
<li>
<p>A managed entity instance is an instance with
a persistent identity that is currently associated with a persistence
context.</p>
</li>
<li>
<p>A detached entity instance is an instance
with a persistent identity that is not (or no longer) associated with a
persistence context.</p>
</li>
<li>
<p>A removed entity instance is an instance with
a persistent identity, associated with a persistence context, that will
be removed from the database upon transaction commit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following subsections describe the effect
of lifecycle operations upon entities. Use of the <em>cascade</em> annotation
element may be used to propagate the effect of an operation to
associated entities. The cascade functionality is most typically used in
parent-child relationships.</p>
</div>
<div class="sect3">
<h4 id="entity-instance-creation"><a class="anchor" href="#entity-instance-creation"></a>3.2.1. Entity Instance Creation</h4>
<div class="paragraph">
<p>Entity instances are created by means of the
<em>new</em> operation. An entity instance, when first created by <em>new</em> is not
yet persistent. An instance becomes persistent by means of the
<em>EntityManager</em> API.</p>
</div>
</div>
<div class="sect3">
<h4 id="persisting-an-entity-instance"><a class="anchor" href="#persisting-an-entity-instance"></a>3.2.2. Persisting an Entity Instance</h4>
<div class="paragraph">
<p>A new entity instance becomes both managed
and persistent by invoking the <em>persist</em> method on it or by cascading
the persist operation.</p>
</div>
<div class="paragraph">
<p>The semantics of the persist operation,
applied to an entity <em>X</em> are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a new entity, it becomes managed. The
entity X will be entered into the database at or before transaction
commit or as a result of the flush operation.</p>
</li>
<li>
<p>If X is a preexisting managed entity, it is
ignored by the persist operation. However, the persist operation is
cascaded to entities referenced by X, if the relationships from X to
these other entities are annotated with the <em>cascade=PERSIST</em> or
<em>cascade=ALL</em> annotation element value or specified with the equivalent
XML descriptor element.</p>
</li>
<li>
<p>If X is a removed entity, it becomes managed.</p>
</li>
<li>
<p>If X is a detached object, the
<em>EntityExistsException</em> may be thrown when the persist operation is
invoked, or the <em>EntityExistsException</em> or another
<em>PersistenceException</em> <em>may</em> be thrown at flush or commit time.</p>
</li>
<li>
<p>For all entities Y referenced by a
relationship from X, if the relationship to Y has been annotated with
the <em>cascade</em> element value <em>cascade=PERSIST</em> or <em>cascade=ALL</em>, the
persist operation is applied to Y.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a1946"><a class="anchor" href="#a1946"></a>3.2.3. Removal</h4>
<div class="paragraph">
<p>A managed entity instance becomes removed by
invoking the <em>remove</em> method on it or by cascading the remove operation.</p>
</div>
<div class="paragraph">
<p>The semantics of the remove operation,
applied to an entity X are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a new entity, it is ignored by the
remove operation. However, the remove operation is cascaded to entities
referenced by X, if the relationship from X to these other entities is
annotated with the <em>cascade=REMOVE</em> or <em>cascade=ALL</em> annotation element
value.</p>
</li>
<li>
<p>If X is a managed entity, the remove
operation causes it to become removed. The remove operation is cascaded
to entities referenced by X, if the relationships from X to these other
entities is annotated with the <em>cascade=REMOVE</em> or <em>cascade=ALL</em>
annotation element value.</p>
</li>
<li>
<p>If X is a detached entity, an
<em>IllegalArgumentException</em> will be thrown by the remove operation (or
the transaction commit will fail).</p>
</li>
<li>
<p>If X is a removed entity, it is ignored by the remove operation.</p>
</li>
<li>
<p>A removed entity X will be removed from the
database at or before transaction commit or as a result of the flush
operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After an entity has been removed, its state
(except for generated state) will be that of the entity at the point at
which the remove operation was called.</p>
</div>
</div>
<div class="sect3">
<h4 id="a1955"><a class="anchor" href="#a1955"></a>3.2.4. Synchronization to the Database</h4>
<div class="paragraph">
<p>In general, a persistence context will be
synchronized to the database as described below. However, a persistence
context of type <em>SynchronizationType.UNSYNCHRONIZED</em> or an
application-managed persistence context that has been created outside
the scope of the current transaction will only be synchronized to the
database if it has been joined to the current transaction by the
application&#8217;s use of the <em>EntityManager</em> <em>joinTransaction</em> method.</p>
</div>
<div class="paragraph">
<p>The state of persistent entities is
synchronized to the database at transaction commit. This synchronization
involves writing to the database any updates to persistent entities and
their relationships as specified above.</p>
</div>
<div class="paragraph">
<p>An update to the state of an entity includes
both the assignment of a new value to a persistent property or field of
the entity as well as the modification of a mutable value of a
persistent property or field<sup class="footnote">[<a id="_footnoteref_26" class="footnote" href="#_footnotedef_26" title="View footnote.">26</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>Synchronization to the database does not
involve a refresh of any managed entities unless the <em>refresh</em> operation
is explicitly invoked on those entities or cascaded to them as a result
of the specification of the <em>cascade=REFRESH</em> or <em>cascade=ALL</em>
annotation element value.</p>
</div>
<div class="paragraph">
<p>Bidirectional relationships between
managed entities will be persisted based on references held by the
owning side of the relationship. It is the developer&#8217;s responsibility to
keep the in-memory references held on the owning side and those held on
the inverse side consistent with each other when they change. In the
case of unidirectional one-to-one and one-to-many relationships, it is
the developer&#8217;s responsibility to insure that the semantics of the
relationships are adhered to.<sup class="footnote">[<a id="_footnoteref_27" class="footnote" href="#_footnotedef_27" title="View footnote.">27</a>]</sup></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is particularly important to ensure that
changes to the inverse side of a relationship result in appropriate
updates on the owning side, so as to ensure the changes are not lost
when they are synchronized to the database.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The persistence provider runtime is permitted
to perform synchronization to the database at other times as well when a
transaction is active and the persistence context is joined to the
transaction. The <em>flush</em> method can be used by the application to force
synchronization. It applies to entities associated with the persistence
context. The <em>setFlushMode</em> methods of the <em>EntityManager</em>, <em>Query</em>,
<em>TypedQuery</em>, and <em>StoredProcedureQuery</em> interfaces can be used to
control synchronization semantics. The effect of <em>FlushModeType.AUTO</em> is
defined in <a href="#a4374">Section 3.10.8</a>. If <em>FlushModeType.COMMIT</em> is specified, flushing will occur at
transaction commit; the persistence provider is permitted, but not
required, to perform to flush at other times. If there is no transaction
active or if the persistence context has not been joined to the current
transaction, the persistence provider must not flush to the database.</p>
</div>
<div class="paragraph">
<p>The semantics of the flush operation, applied
to an entity <em>X</em> are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a managed entity, it is synchronized
to the database.</p>
<div class="ulist">
<ul>
<li>
<p>For all entities Y referenced by a
relationship from X, if the relationship to Y has been annotated with
the <em>cascade</em> element value <em>cascade=PERSIST</em> or <em>cascade=ALL</em>, the
persist operation is applied to Y.</p>
</li>
<li>
<p>For any entity Y referenced by a relationship
from X, where the relationship to Y has not been annotated with the
<em>cascade</em> element value <em>cascade=PERSIST</em> or <em>cascade=ALL</em>:</p>
<div class="ulist">
<ul>
<li>
<p>If Y is new or removed, an
<em>IllegalStateException</em> will be thrown by the flush operation (and the
transaction marked for rollback) or the transaction commit will fail.</p>
</li>
<li>
<p>If Y is detached, the semantics depend upon
the ownership of the relationship. If X owns the relationship, any
changes to the relationship are synchronized with the database;
otherwise, if Y owns the relationships, the behavior is undefined.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>If X is a removed entity, it is removed from
the database. No cascade options are relevant.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="refreshing-an-entity-instance"><a class="anchor" href="#refreshing-an-entity-instance"></a>3.2.5. Refreshing an Entity Instance</h4>
<div class="paragraph">
<p>The state of a managed entity instance is
refreshed from the database by invoking the <em>refresh</em> method on it or by
cascading the refresh operation.</p>
</div>
<div class="paragraph">
<p>The semantics of the refresh operation,
applied to an entity X are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a managed entity, the state of X is
refreshed from the database, overwriting changes made to the entity, if
any. The refresh operation is cascaded to entities referenced by X if
the relationship from X to these other entities is annotated with the
<em>cascade=REFRESH</em> or <em>cascade=ALL</em> annotation element value.</p>
</li>
<li>
<p>If X is a new, detached, or removed entity,
the <em>IllegalArgumentException</em> is thrown.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="evicting-an-entity-instance-from-the-persistence-context"><a class="anchor" href="#evicting-an-entity-instance-from-the-persistence-context"></a>3.2.6. Evicting an Entity Instance from the Persistence Context</h4>
<div class="paragraph">
<p>An entity instance is removed from the
persistence context by invoking the <em>detach</em> method on it or cascading
the detach operation. Changes made to the entity, if any (including
removal of the entity), will not be synchronized to the database after
such eviction has taken place.</p>
</div>
<div class="paragraph">
<p>Applications must use the <em>flush</em> method
prior to the <em>detach</em> method to ensure portable semantics if changes
have been made to the entity (including removal of the entity). Because
the persistence provider may write to the database at times other than
the explicit invocation of the <em>flush</em> method, portable applications
must not assume that changes have not been written to the database if
the <em>flush</em> method has not been called prior to detach.</p>
</div>
<div class="paragraph">
<p>The semantics of the detach operation,
applied to an entity X are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a managed entity, the detach
operation causes it to become detached. The detach operation is cascaded
to entities referenced by X if the relationships from X to these other
entities is annotated with the <em>cascade=DETACH</em> or <em>cascade=ALL</em>
annotation element value. Entities which previously referenced X will
continue to reference X.</p>
</li>
<li>
<p>If X is a new or detached entity, it is
ignored by the detach operation.</p>
</li>
<li>
<p>If X is a removed entity, the detach
operation causes it to become detached. The detach operation is cascaded
to entities referenced by X if the relationships from X to these other
entities is annotated with the <em>cascade=DETACH</em> or <em>cascade=ALL</em>
annotation element value. Entities which previously referenced X will
continue to reference X. Portable applications should not pass removed
entities that have been detached from the persistence context to further
EntityManager operations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a1982"><a class="anchor" href="#a1982"></a>3.2.7. Detached Entities</h4>
<div class="paragraph">
<p>A detached entity results from transaction
commit if a transaction-scoped persistence context is used (see <a href="#a2027">Section 3.3</a>);
from transaction rollback (see <a href="#a2049">Section 3.3.3</a>); from detaching
the entity from the persistence context; from clearing the persistence
context; from closing an entity manager; or from serializing an entity
or otherwise passing an entity by value—e.g., to a separate application
tier, through a remote interface, etc.</p>
</div>
<div class="paragraph">
<p>Detached entity instances continue to live
outside of the persistence context in which they were persisted or
retrieved. Their state is no longer guaranteed to be synchronized with
the database state.</p>
</div>
<div class="paragraph">
<p>The application may access the available
state of available detached entity instances after the persistence
context ends. The available state includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any persistent field or property not marked <em>fetch=LAZY</em></p>
</li>
<li>
<p>Any persistent field or property that was
accessed by the application or fetched by means of an entity graph</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the persistent field or property is an
association, the available state of an associated instance may only be
safely accessed if the associated instance is available. The available
instances include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any entity instance retrieved using <em>find()</em>.</p>
</li>
<li>
<p>Any entity instances retrieved using a query or explicitly requested in a fetch join.</p>
</li>
<li>
<p>Any entity instance for which an instance
variable holding non-primary-key persistent state was accessed by the
application.</p>
</li>
<li>
<p>Any entity instance that can be reached from
another available instance by navigating associations marked <em>fetch=EAGER</em>.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="merging-detached-entity-state"><a class="anchor" href="#merging-detached-entity-state"></a>3.2.7.1. Merging Detached Entity State</h5>
<div class="paragraph">
<p>The merge operation allows for the
propagation of state from detached entities onto persistent entities
managed by the entity manager.</p>
</div>
<div class="paragraph">
<p>The semantics of the merge operation applied
to an entity X are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If X is a detached entity, the state of X is
copied onto a pre-existing managed entity instance X' of the same
identity or a new managed copy X' of X is created.</p>
</li>
<li>
<p>If X is a new entity instance, a new managed
entity instance X' is created and the state of X is <em>copied</em> into the
new managed entity instance X'.</p>
</li>
<li>
<p>If X is a removed entity instance, an
<em>IllegalArgumentException</em> will be thrown by the merge operation (or the
transaction commit will fail).</p>
</li>
<li>
<p>If X is a managed entity, it is ignored by
the merge operation, however, the merge operation is cascaded to
entities referenced by relationships from X if these relationships have
been annotated with the <em>cascade</em> element value <em>cascade=MERGE</em> or
<em>cascade=ALL</em> annotation.</p>
</li>
<li>
<p>For all entities Y referenced by
relationships from X having the <em>cascade</em> element value <em>cascade=MERGE</em>
or <em>cascade=ALL</em>, Y is merged recursively as Y'. For all such Y
referenced by X, X' is set to reference Y'. (Note that if X is managed
then X is the same object as X'.)</p>
</li>
<li>
<p>If X is an entity merged to X', with a
reference to another entity Y, where <em>cascade=MERGE</em> or <em>cascade=ALL</em> is
not specified, then navigation of the same association from X' yields a
reference to a managed object Y' with the same persistent identity as Y.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The persistence provider must not merge
fields marked LAZY that have not been fetched: it must ignore such
fields when merging.</p>
</div>
<div class="paragraph">
<p>Any <em>Version</em> columns used by the entity must
be checked by the persistence runtime implementation during the merge
operation and/or at flush or commit time. In the absence of <em>Version</em>
columns there is no additional version checking done by the persistence
provider runtime during the merge operation.</p>
</div>
</div>
<div class="sect4">
<h5 id="detached-entities-and-lazy-loading"><a class="anchor" href="#detached-entities-and-lazy-loading"></a>3.2.7.2. Detached Entities and Lazy Loading</h5>
<div class="paragraph">
<p>Serializing entities and merging those
entities back into a persistence context may not be interoperable across
vendors when lazy properties or fields and/or relationships are used.</p>
</div>
<div class="paragraph">
<p>A vendor is required to support the
serialization and subsequent deserialization and merging of detached
entity instances (which may contain lazy properties or fields and/or
relationships that have not been fetched) back into a separate JVM
instance of that vendor&#8217;s runtime, where both runtime instances have
access to the entity classes and any required vendor persistence
implementation classes.</p>
</div>
<div class="paragraph">
<p>When interoperability across vendors is
required, the application must not use lazy loading.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managed-instances"><a class="anchor" href="#managed-instances"></a>3.2.8. Managed Instances</h4>
<div class="paragraph">
<p>It is the responsibility of the application
to insure that an instance is managed in only a single persistence
context. The behavior is undefined if the same Java instance is made
managed in more than one persistence context.</p>
</div>
<div class="paragraph">
<p>The <em>contains()</em> method can be used to
determine whether an entity instance is managed in the current
persistence context.</p>
</div>
<div class="paragraph">
<p>The <em>contains</em> method returns true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the entity has been retrieved from the
database or has been returned by <em>getReference</em>, and has not been
removed or detached.</p>
</li>
<li>
<p>If the entity instance is new, and the
<em>persist</em> method has been called on the entity or the persist operation
has been cascaded to it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>contains</em> method returns false:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the instance is detached.</p>
</li>
<li>
<p>If the <em>remove</em> method has been called on the
entity, or the remove operation has been cascaded to it.</p>
</li>
<li>
<p>If the instance is new, and the <em>persist</em>
method has not been called on the entity or the persist operation has
not been cascaded to it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the effect of the cascading of
persist, merge, remove, or detach is immediately visible to the
<em>contains</em> method, whereas the actual insertion, modification, or
deletion of the database representation for the entity may be deferred
until the end of the transaction.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2019"><a class="anchor" href="#a2019"></a>3.2.9. Load State</h4>
<div class="paragraph">
<p>An entity is considered to be loaded if all
attributes with <em>FetchType.EAGER</em> —whether explictly specified or by
default—(including relationship and other collection-valued attributes)
have been loaded from the database or assigned by the application.
Attributes with <em>FetchType.LAZY</em> may or may not have been loaded. The
available state of the entity instance and associated instances is as
described in <a href="#a1982">Section 3.2.7</a>.</p>
</div>
<div class="paragraph">
<p>An attribute that is an embeddable is
considered to be loaded if the embeddable attribute was loaded from the
database or assigned by the application, and, if the attribute
references an embeddable instance (i.e., is not null), the embeddable
instance state is known to be loaded (i.e., all attributes of the
embeddable with <em>FetchType.EAGER</em> have been loaded from the database or
assigned by the application).</p>
</div>
<div class="paragraph">
<p>A collection-valued attribute is considered
to be loaded if the collection was loaded from the database or the value
of the attribute was assigned by the application, and, if the attribute
references a collection instance (i.e., is not null), each element of
the collection (e.g. entity or embeddable) is considered to be loaded.</p>
</div>
<div class="paragraph">
<p>A single-valued relationship attribute is
considered to be loaded if the relationship attribute was loaded from
the database or assigned by the application, and, if the attribute
references an entity instance (i.e., is not null), the entity instance
state is known to be loaded.</p>
</div>
<div class="paragraph">
<p>A basic attribute is considered to be loaded
if its state has been loaded from the database or assigned by the
application.</p>
</div>
<div class="paragraph">
<p>The <em>PersistenceUtil.isLoaded</em> methods can be
used to determine the load state of an entity and its attributes
regardless of the persistence unit with which the entity is associated.
The <em>PersistenceUtil.isLoaded</em> methods return true if the above
conditions hold, and false otherwise. If the persistence unit is known,
the <em>PersistenceUnitUtil.isLoaded</em> methods can be used instead. See <a href="#a12177">Section 7.11</a>.</p>
</div>
<div class="paragraph">
<p>Persistence provider contracts for
determining the load state of an entity or entity attribute are
described in <a href="#a13592">Section 9.8.1</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2027"><a class="anchor" href="#a2027"></a>3.3. Persistence Context Lifetime and Synchronization Type</h3>
<div class="paragraph">
<p>The lifetime of a container-managed
persistence context can either be scoped to a transaction
(transaction-scoped persistence context), or have a lifetime scope that
extends beyond that of a single transaction (extended persistence
context). The enum <em>PersistenceContextType</em> is used to define the
persistence context lifetime scope for container-managed entity
managers. The persistence context lifetime scope is defined when the
EntityManager instance is created (whether explicitly, or in conjunction
with injection or JNDI lookup). See <a href="#a11791">Section 7.6</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="directive">public</span> <span class="type">enum</span> PersistenceContextType {
    TRANSACTION,
    EXTENDED
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the lifetime of the persistence
context of a container-managed entity manager corresponds to the scope
of a transaction (i.e., it is of type
<em>PersistenceContextType.TRANSACTION</em>).</p>
</div>
<div class="paragraph">
<p>When an extended persistence context is used,
the extended persistence context exists from the time the EntityManager
instance is created until it is closed. This persistence context might
span multiple transactions and non-transactional invocations of the
EntityManager.</p>
</div>
<div class="paragraph">
<p>An EntityManager with an extended persistence
context maintains its references to the entity objects after a
transaction has committed. Those objects remain managed by the
EntityManager, and they can be updated as managed objects between
transactions.<sup class="footnote">[<a id="_footnoteref_28" class="footnote" href="#_footnotedef_28" title="View footnote.">28</a>]</sup> Navigation from a managed object in
an extended persistence context results in one or more other managed
objects regardless of whether a transaction is active.</p>
</div>
<div class="paragraph">
<p>When an EntityManager with an extended
persistence context is used, the persist, remove, merge, and refresh
operations can be called regardless of whether a transaction is active.
The effects of these operations will be committed to the database when
the extended persistence context is enlisted in a transaction and the
transaction commits.</p>
</div>
<div class="paragraph">
<p>The scope of the persistence context of an
application-managed entity manager is extended. It is the responsibility
of the application to manage the lifecycle of the persistence context.</p>
</div>
<div class="paragraph">
<p>Container-managed persistence contexts are
described further in <a href="#a11791">Section 7.6</a>. Persistence contexts managed by
the application are described further in <a href="#a11894">Section 7.7</a>.</p>
</div>
<div class="sect3">
<h4 id="synchronization-with-the-current-transaction"><a class="anchor" href="#synchronization-with-the-current-transaction"></a>3.3.1. Synchronization with the Current Transaction</h4>
<div class="paragraph">
<p>By default, a container-managed persistence
context is of <em>SynchronizationType.SYNCHRONIZED</em> and is automatically
joined to the current transaction. A persistence context of
<em>SynchronizationType.UNSYNCHRONIZED</em> will not be enlisted in the current
transaction, unless the <em>EntityManager</em> <em>joinTransaction</em> method is
invoked.</p>
</div>
<div class="paragraph">
<p>By default, an application-managed
persistence context that is associated with a JTA entity manager and
that is created within the scope of an active transaction is
automatically joined to that transaction. An application-managed JTA
persistence context that is created outside the scope of a transaction
or an application-managed persistence context of type
<em>SynchronizationType.UNSYNCHRONIZED</em> will not be joined to that
transaction unless the <em>EntityManager</em> <em>joinTransaction</em> method is
invoked.</p>
</div>
<div class="paragraph">
<p>An application-managed persistence context
associated with a resource-local entity manager is always automatically
joined to any resource-local transaction that is begun for that entity
manager.</p>
</div>
<div class="paragraph">
<p>Persistence context synchronization type is
described further in <a href="#a11797">Section 7.6.1</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="transaction-commit"><a class="anchor" href="#transaction-commit"></a>3.3.2. Transaction Commit</h4>
<div class="paragraph">
<p>The managed entities of a transaction-scoped
persistence context become detached when the transaction commits; the
managed entities of an extended persistence context remain managed.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2049"><a class="anchor" href="#a2049"></a>3.3.3. Transaction Rollback</h4>
<div class="paragraph">
<p>For both transaction-scoped
persistence contexts and for extended persistence contexts that are
joined to the current transaction, transaction rollback causes all
<em>pre-existing</em> managed instances and removed
instances<sup class="footnote">[<a id="_footnoteref_29" class="footnote" href="#_footnotedef_29" title="View footnote.">29</a>]</sup> to become detached. The instances'
state will be the state of the instances at the point at which the
transaction was rolled back. Transaction rollback typically causes the
persistence context to be in an inconsistent state at the point of
rollback. In particular, the state of version attributes and generated
state (e.g., generated primary keys) may be inconsistent. Instances that
were formerly managed by the persistence context (including new
instances that were made persistent in that transaction) may therefore
not be reusable in the same manner as other detached objects—for
example, they may fail when passed to the merge
operation.<sup class="footnote">[<a id="_footnoteref_30" class="footnote" href="#_footnotedef_30" title="View footnote.">30</a>]</sup></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because a transaction-scoped
persistence context&#8217;s lifetime is scoped to a transaction regardless of
whether it is joined to that transaction, the container closes the
persistence context upon transaction rollback. However, an extended
persistence context that is not joined to a transaction is unaffected by
transaction rollback.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2052"><a class="anchor" href="#a2052"></a>3.4. Locking and Concurrency</h3>
<div class="paragraph">
<p>This specification assumes the use of
optimistic concurrency control. It assumes that the databases to which
persistence units are mapped will be accessed by the implementation
using read-committed isolation (or a vendor equivalent in which
long-term read locks are not held), and that writes to the database will
typically occur only when the <em>flush</em> method has been invoked—whether
explicitly by the application, or by the persistence provider runtime in
accordance with the flush mode setting.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a transaction is active and the
persistence context is joined to the transaction, a compliant
implementation of this specification is permitted to write to the
database immediately (i.e., whenever a managed entity is updated,
created, and/or removed), however, the configuration of an
implementation to require such non-deferred database writes is outside
the scope of this specification.<sup class="footnote">[<a id="_footnoteref_31" class="footnote" href="#_footnotedef_31" title="View footnote.">31</a>]</sup></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In addition, both pessimistic and optimistic
locking are supported for selected entities by means of specified lock
modes. Optimistic locking is described in <a href="#a2056">Section 3.4.1</a> and <a href="#a2059">Section 3.4.2</a>; pessimistic locking
in <a href="#a2066">Section 3.4.3</a>. <a href="#a2084">Section 3.4.4</a> describes the setting of
optimistic and pessimistic lock modes. The configuration of the setting
of optimistic lock modes is described in <a href="#a2100">Section 3.4.4.1</a>,
and the configuration of the setting of pessimistic lock modes is
described in <a href="#a2113">Section 3.4.4.2</a>.</p>
</div>
<div class="sect3">
<h4 id="a2056"><a class="anchor" href="#a2056"></a>3.4.1. Optimistic Locking</h4>
<div class="paragraph">
<p>Optimistic locking is a technique that is
used to insure that updates to the database data corresponding to the
state of an entity are made only when no intervening transaction has
updated that data since the entity state was read. This insures that
updates or deletes to that data are consistent with the current state of
the database and that intervening updates are not lost. Transactions
that would cause this constraint to be violated result in an
<em>OptimisticLockException</em> being thrown and the transaction marked for
rollback.</p>
</div>
<div class="paragraph">
<p>Portable applications that wish to enable
optimistic locking for entities must specify <em>Version</em> attributes for
those entities—i.e., persistent properties or fields annotated with the
<em>Version</em> annotation or specified in the XML descriptor as version
attributes. Applications are strongly encouraged to enable optimistic
locking for all entities that may be concurrently accessed or that may
be merged from a disconnected state. Failure to use optimistic locking
may lead to inconsistent entity state, lost updates and other state
irregularities. If optimistic locking is not defined as part of the
entity state, the application must bear the burden of maintaining data
consistency.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2059"><a class="anchor" href="#a2059"></a>3.4.2. Version Attributes</h4>
<div class="paragraph">
<p>The <em>Version</em> field or property is used by
the persistence provider to perform optimistic locking. It is accessed
and/or set by the persistence provider in the course of performing
lifecycle operations on the entity instance. An entity is automatically
enabled for optimistic locking if it has a property or field mapped with
a <em>Version</em> mapping.</p>
</div>
<div class="paragraph">
<p>An entity may access the state of its version
field or property or export a method for use by the application to
access the version, but must not modify the version
value.<sup class="footnote">[<a id="_footnoteref_32" class="footnote" href="#_footnotedef_32" title="View footnote.">32</a>]</sup> With the exception noted in <a href="#a5636">Section 4.10</a>, only
the persistence provider is permitted to set or update the value of the
version attribute in the object.</p>
</div>
<div class="paragraph">
<p>The version attribute is updated by the
persistence provider runtime when the object is written to the database.
All non-relationship fields and properties and all relationships owned
by the entity are included in version checks.<sup class="footnote">[<a id="_footnoteref_33" class="footnote" href="#_footnotedef_33" title="View footnote.">33</a>]</sup></p>
</div>
<div class="paragraph">
<p>The persistence provider&#8217;s implementation of
the merge operation must examine the version attribute when an entity is
being merged and throw an <em>OptimisticLockException</em> if it is discovered
that the object being merged is a stale copy of the entity—i.e. that the
entity has been updated since the entity became detached. Depending on
the implementation strategy used, it is possible that this exception may
not be thrown until <em>flush</em> is called or commit time, whichever happens
first.</p>
</div>
<div class="paragraph">
<p>The persistence provider runtime is
required to use only the version attribute when performing optimistic
lock checking. Persistence provider implementations may provide
additional mechanisms beside version attributes to enable optimistic
lock checking. However, support for such mechanisms is not required of
an implementation of this specification.<sup class="footnote">[<a id="_footnoteref_34" class="footnote" href="#_footnotedef_34" title="View footnote.">34</a>]</sup></p>
</div>
<div class="paragraph">
<p>If only some entities contain version
attributes, the persistence provider runtime is required to check those
entities for which version attributes have been specified. The
consistency of the object graph is not guaranteed, but the absence of
version attributes on some of the entities will not stop operations from
completing.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2066"><a class="anchor" href="#a2066"></a>3.4.3. Pessimistic Locking</h4>
<div class="paragraph">
<p>While optimistic locking is typically
appropriate in dealing with moderate contention among concurrent
transactions, in some applications it may be useful to immediately
obtain long-term database locks for selected entities because of the
often late failure of optimistic transactions. Such immediately obtained
long-term database locks are referred to here as “pessimistic”
locks.<sup class="footnote">[<a id="_footnoteref_35" class="footnote" href="#_footnotedef_35" title="View footnote.">35</a>]</sup></p>
</div>
<div class="paragraph">
<p>Pessimistic locking guarantees that once a
transaction has obtained a pessimistic lock on an entity instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>no other transaction (whether a transaction
of an application using the Jakarta Persistence API or any other
transaction using the underlying resource) may successfully modify or
delete that instance until the transaction holding the lock has ended.</p>
</li>
<li>
<p>if the pessimistic lock is an exclusive
lock<sup class="footnote">[<a id="_footnoteref_36" class="footnote" href="#_footnotedef_36" title="View footnote.">36</a>]</sup>,
that same transaction may modify or delete
that entity instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When an entity instance is locked using
pessimistic locking, the persistence provider must lock the database
row(s) that correspond to the non-collection-valued persistent state of
that instance. If a joined inheritance strategy is used, or if the
entity is otherwise mapped to a secondary table, this entails locking
the row(s) for the entity instance in the additional table(s). Entity
relationships for which the locked entity contains the foreign key will
also be locked, but not the state of the referenced entities (unless
those entities are explicitly locked). Element collections and
relationships for which the entity does not contain the foreign key
(such as relationships that are mapped to join tables or unidirectional
one-to-many relationships for which the target entity contains the
foreign key) will not be locked by default.</p>
</div>
<div class="paragraph">
<p>Element collections and relationships owned
by the entity that are contained in join tables will be locked if the
<em>jakarta.persistence.lock.scope</em> property is specified with a value of
<em>PessimisticLockScope.EXTENDED</em>. The state of entities referenced by
such relationships will not be locked (unless those entities are
explicitly locked). This property may be passed as an argument to the
methods of the <em>EntityManager</em>, <em>Query</em>, and <em>TypedQuery</em> interfaces
that allow lock modes to be specified or used with the <em>NamedQuery</em>
annotation.</p>
</div>
<div class="paragraph">
<p>Locking such a relationship or element
collection generally locks only the rows in the join table or collection
table for that relationship or collection. This means that phantoms will
be possible.</p>
</div>
<div class="paragraph">
<p>The values of the
<em>jakarta.persistence.lock.scope</em> property are defined by the
<em>PessimisticLockScope</em> enum.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="directive">public</span> <span class="type">enum</span> PessimisticLockScope {
  NORMAL,
  EXTENDED
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This specification does not define the
mechanisms a persistence provider uses to obtain database locks, and a
portable application should not rely on how pessimistic locking is
achieved on the database.<sup class="footnote">[<a id="_footnoteref_37" class="footnote" href="#_footnotedef_37" title="View footnote.">37</a>]</sup> In particular, a
persistence provider or the underlying database management system may
lock more rows than the ones selected by the application.</p>
</div>
<div class="paragraph">
<p>Whenever a pessimistically locked entity
containing a version attribute is updated on the database, the
persistence provider must also update (increment) the entity&#8217;s version
column to enable correct interaction with applications using optimistic
locking. See <a href="#a2059">Section 3.4.2</a> and <a href="#a2084">Section 3.4.4</a>.</p>
</div>
<div class="paragraph">
<p>Pessimistic locking may be applied to
entities that do not contain version attributes. However, in this case
correct interaction with applications using optimistic locking cannot be
ensured.</p>
</div>
</div>
<div class="sect3">
<h4 id="a2084"><a class="anchor" href="#a2084"></a>3.4.4. Lock Modes</h4>
<div class="paragraph">
<p>Lock modes are intended to provide a facility
that enables the effect of “repeatable read” semantics for the items
read, whether “optimistically” (as described in <a href="#a2100">Section 3.4.4.1</a>)
or “pessimistically” (as described in <a href="#a2113">Section 3.4.4.2</a>).</p>
</div>
<div class="paragraph">
<p>Lock modes can be specified by means of the
EntityManager <em>lock</em> method, the methods of the <em>EntityManager</em>,
<em>Query</em>, and <em>TypedQuery</em> interfaces that allow lock modes to be
specified, and the <em>NamedQuery</em> annotation.</p>
</div>
<div class="paragraph">
<p>Lock mode values are defined by the
<em>LockModeType</em> enum. Six distinct lock modes are defined. The lock mode
type values <em>READ</em> and <em>WRITE</em> are synonyms of <em>OPTIMISTIC</em> and
<em>OPTIMISTIC_FORCE_INCREMENT</em> respectively.<sup class="footnote">[<a id="_footnoteref_38" class="footnote" href="#_footnotedef_38" title="View footnote.">38</a>]</sup> The
latter are to be preferred for new applications.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="directive">public</span> <span class="type">enum</span> LockModeType {
  READ,
  WRITE,
  OPTIMISTIC,
  OPTIMISTIC_FORCE_INCREMENT,
  PESSIMISTIC_READ,
  PESSIMISTIC_WRITE,
  PESSIMISTIC_FORCE_INCREMENT,
  NONE
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="a2100"><a class="anchor" href="#a2100"></a>3.4.4.1. OPTIMISTIC, OPTIMISTIC_FORCE_INCREMENT</h5>
<div class="paragraph">
<p>The lock modes <em>OPTIMISTIC</em> and
<em>OPTIMISTIC_FORCE_INCREMENT</em> are used for optimistic locking. The lock
mode type values <em>READ</em> and <em>WRITE</em> are synonymous with <em>OPTIMISTIC</em> and
<em>OPTIMISTIC_FORCE_INCREMENT</em> respectively.</p>
</div>
<div class="paragraph">
<p>The semantics of requesting locks of type
<em>LockModeType.OPTIMISTIC</em> and <em>LockModeType.OPTIMISTIC_FORCE_INCREMENT</em>
are the following.</p>
</div>
<div class="paragraph">
<p>If transaction T1 calls <em>lock(entity,</em>
<em>LockModeType.OPTIMISTIC)</em> on a versioned object, the entity manager
must ensure that neither of the following phenomena can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>P1 (Dirty read): Transaction T1 modifies a
row. Another transaction T2 then reads that row and obtains the modified
value, before T1 has committed or rolled back. Transaction T2 eventually
commits successfully; it does not matter whether T1 commits or rolls
back and whether it does so before or after T2 commits.</p>
</li>
<li>
<p>P2 (Non-repeatable read): Transaction T1
reads a row. Another transaction T2 then modifies or deletes that row,
before T1 has committed. Both transactions eventually commit
successfully.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This will generally be achieved by the entity
manager acquiring a lock on the underlying database row. While with
optimistic concurrency concurrency, long-term database read locks are
typically not obtained immediately, a compliant implementation is
permitted to obtain an immediate lock (so long as it is retained until
commit completes). If the lock is deferred until commit time, it must be
retained until the commit completes. Any implementation that supports
repeatable reads in a way that prevents the above phenomena is
permissible.</p>
</div>
<div class="paragraph">
<p>The persistence implementation is not
required to support calling <em>lock(entity,</em> <em>LockModeType.OPTIMISTIC)</em> on
a non-versioned object. When it cannot support such a lock call, it must
throw the <em>PersistenceException</em>. When supported, whether for versioned
or non-versioned objects, <em>LockModeType.OPTIMISTIC</em> must always prevent
the phenomena P1 and P2. Applications that call <em>lock(entity,
LockModeType.OPTIMISTIC)</em> on non-versioned objects will not be portable.</p>
</div>
<div class="paragraph">
<p>If transaction T1 calls <em>lock(entity,</em>
<em>LockModeType.OPTIMISTIC_FORCE_INCREMENT)</em> on a versioned object, the
entity manager must avoid the phenomena P1 and P2 (as with
<em>LockModeType.OPTIMISTIC</em>) and must also force an update (increment) to
the entity&#8217;s version column. A forced version update may be performed
immediately, or may be deferred until a flush or commit. If an entity is
removed before a deferred version update was to have been applied, the
forced version update is omitted.</p>
</div>
<div class="paragraph">
<p>The persistence implementation is not
required to support calling <em>lock(entity,</em>
<em>LockModeType.OPTIMISTIC_FORCE_INCREMENT)</em> on a non-versioned object.
When it cannot support such a lock call, it must throw the
<em>PersistenceException</em>. When supported, whether for versioned or
non-versioned objects, <em>LockModeType.OPTIMISTIC_FORCE_INCREMENT</em> must
always prevent the phenomena P1 and P2. For non-versioned objects,
whether or not <em>LockModeType.OPTIMISTIC_FORCE_INCREMENT</em> has any
additional behavior is vendor-specific. Applications that call
<em>lock(entity, LockModeType.OPTIMISTIC_FORCE_INCREMENT)</em> on non-versioned
objects will not be portable.</p>
</div>
<div class="paragraph">
<p>For versioned objects, it is permissible for
an implementation to use <em>LockModeType.OPTIMISTIC_FORCE_INCREMENT</em> where
<em>LockModeType.OPTIMISTIC</em> was requested, but not vice versa.</p>
</div>
<div class="paragraph">
<p>If a versioned object is otherwise updated or
removed, then the implementation must ensure that the requirements of
<em>LockModeType.OPTIMISTIC_FORCE_INCREMENT</em> are met, even if no explicit
call to <em>EntityManager.lock</em> was made.</p>
</div>
<div class="paragraph">
<p>For portability, an application should not
depend on vendor-specific hints or configuration to ensure repeatable
read for objects that are not updated or removed via any mechanism other
than the use of version attributes and the EntityManager <em>lock</em> method.
However, it should be noted that if an implementation has acquired
up-front pessimistic locks on some database rows, then it is free to
ignore <em>lock(entity, LockModeType.OPTIMISTIC)</em> calls on the entity
objects representing those rows.</p>
</div>
</div>
<div class="sect4">
<h5 id="a2113"><a class="anchor" href="#a2113"></a>3.4.4.2. PESSIMISTIC_READ, PESSIMISTIC_WRITE, PESSIMISTIC_FORCE_INCREMENT</h5>
<div class="paragraph">
<p>The lock modes <em>PESSIMISTIC_READ</em>,
<em>PESSIMISTIC_WRITE</em>, and <em>PESSIMISTIC_FORCE_INCREMENT</em> are used to
immediately obtain long-term database locks.<sup class="footnote">[<a id="_footnoteref_39" class="footnote" href="#_footnotedef_39" title="View footnote.">39</a>]</sup></p>
</div>
<div class="paragraph">
<p>The semantics of requesting locks of type
<em>LockModeType.PESSIMISTIC_READ</em>, <em>LockModeType.PESSIMISTIC_WRITE</em>, and
<em>LockModeType.PESSIMISTIC_FORCE_INCREMENT</em> are the following.</p>
</div>
<div class="paragraph">
<p>If transaction T1 calls <em>lock(entity,
LockModeType.PESSIMISTIC_READ)</em> or <em>lock(entity,
LockModeType.PESSIMISTIC_WRITE)</em> on an object, the entity manager must
ensure that neither of the following phenomena can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>P1 (Dirty read): Transaction T1 modifies a
row. Another transaction T2 then reads that row and obtains the modified
value, before T1 has committed or rolled back.</p>
</li>
<li>
<p>P2 (Non-repeatable read): Transaction T1
reads a row. Another transaction T2 then modifies or deletes that row,
before T1 has committed or rolled back.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any such lock must be obtained immediately
and retained until transaction T1 completes (commits or rolls back).</p>
</div>
<div class="paragraph">
<p>Avoidance of phenomena P1 and P2 is generally
achieved by the entity manager acquiring a long-term lock on the
underlying database row(s). Any implementation that supports pessimistic
repeatable reads as described above is permissible.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A lock with <em>LockModeType.PESSIMISTIC_WRITE</em>
can be obtained on an entity instance to force serialization among
transactions attempting to update the entity data. A lock with
<em>LockModeType.PESSIMISTIC_READ</em> can be used to query data using
repeatable-read semantics without the need to reread the data at the end
of the transaction to obtain a lock, and without blocking other
transactions reading the data. A lock with
<em>LockModeType.PESSIMISTIC_WRITE</em> can be used when querying data and
there is a high likelihood of deadlock or update failure among
concurrent updating transactions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The persistence implementation must support
calling <em>lock(entity, LockModeType.PESSIMISTIC_READ</em>) and <em>lock(entity,
LockModeType.PESSIMISTIC_WRITE)</em> on a non-versioned entity as well as on
a versioned entity.</p>
</div>
<div class="paragraph">
<p>It is permissible for an implementation to
use <em>LockModeType.PESSIMISTIC_WRITE</em> where
<em>LockModeType.PESSIMISTIC_READ</em> was requested, but not vice versa.</p>
</div>
<div class="paragraph">
<p>When the lock cannot be obtained, and the
database locking failure results in transaction-level rollback, the
provider must throw the <em>PessimisticLockException</em> and ensure that the
JTA transaction or EntityTransaction has been marked for rollback.</p>
</div>
<div class="paragraph">
<p>When the lock cannot be obtained, and the
database locking failure results in only statement-level rollback, the
provider must throw the <em>LockTimeoutException</em> (and must not mark the
transaction for rollback).</p>
</div>
<div class="paragraph">
<p>When an application locks an entity with
<em>LockModeType.PESSIMISTIC_READ</em> and later updates that entity, the lock
must be converted to an exclusive lock when the entity is flushed to the
database.<sup class="footnote">[<a id="_footnoteref_40" class="footnote" href="#_footnotedef_40" title="View footnote.">40</a>]</sup> If the lock conversion fails, and the
database locking failure results in transaction-level rollback, the
provider must throw the <em>PessimisticLockException</em> and ensure that the
JTA transaction or EntityTransaction has been marked for rollback. When
the lock conversion fails, and the database locking failure results in
only statement-level rollback, the provider must throw the
<em>LockTimeoutException</em> (and must not mark the transaction for
rollback).</p>
</div>
<div class="paragraph">
<p>When <em>lock(entity,
LockModeType.PESSIMISTIC_READ)</em>, <em>lock(entity,
LockModeType.PESSIMISTIC_WRITE)</em>, or <em>lock(entity,
LockModeType.PESSIMISTIC_FORCE_INCREMENT)</em> is invoked on a versioned
entity that is already in the persistence context, the provider must
also perform optimistic version checks when obtaining the lock. An
<em>OptimisticLockException</em> must be thrown if the version checks fail.
Depending on the implementation strategy used by the provider, it is
possible that this exception may not be thrown until flush is called or
commit time, whichever occurs first.</p>
</div>
<div class="paragraph">
<p>If transaction T1 calls <em>lock(entity,
LockModeType.PESSIMISTIC_FORCE_INCREMENT)</em> on a versioned object, the
entity manager must avoid the phenomenon P1 and P2 (as with
<em>LockModeType.PESSIMISTIC_READ</em> and <em>LockModeType.PESSIMISTIC_WRITE</em>)
and must also force an update (increment) to the entity&#8217;s version
column.</p>
</div>
<div class="paragraph">
<p>The persistence implementation is not
required to support calling <em>lock(entity,</em>
<em>LockModeType.PESSIMISTIC_FORCE_INCREMENT)</em> on a non-versioned object.
When it cannot support such a lock call, it must throw the
<em>PersistenceException</em>. When supported, whether for versioned or
non-versioned objects, <em>LockModeType.PESSIMISTIC_FORCE_INCREMENT</em> must
always prevent the phenomena P1 and P2. For non-versioned objects,
whether or not <em>LockModeType.PESSIMISTIC_FORCE_INCREMENT</em> has any
additional behavior is vendor-specific. Applications that call
<em>lock(entity, LockModeType.PESSIMISTIC_FORCE_INCREMENT)</em> on
non-versioned objects will not be portable.</p>
</div>
<div class="paragraph">
<p>For versioned objects, it is permissible for
an implementation to use <em>LockModeType.PESSIMISTIC_FORCE_INCREMENT</em>
where <em>LockModeType.PESSIMISTIC_READ</em> or
<em>LockModeType.PESSIMISTIC_WRITE</em> was requested, but not vice versa.</p>
</div>
<div class="paragraph">
<p>If a versioned object locked with
<em>LockModeType.PESSIMISTIC_READ</em> or <em>LockModeType.PESSIMISTIC_WRITE</em> is
updated, then the implementation must ensure that the requirements of
<em>LockModeType.PESSIMISTIC_FORCE_INCREMENT</em> are met.</p>
</div>
</div>
<div class="sect4">
<h5 id="a2132"><a class="anchor" href="#a2132"></a>3.4.4.3. Lock Mode Properties and Uses</h5>
<div class="paragraph">
<p>The following property is defined by this
specification for use in pessimistic locking, as described in <a href="#a2066">Section 3.4.3</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jakarta.persistence.lock.scope</code></pre>
</div>
</div>
<div class="paragraph">
<p>This property may be used with the methods of
the <em>EntityManager</em> interface that allow lock modes to be specified, the
<em>Query</em> and <em>TypedQuery</em> <em>setLockMode</em> methods, and the <em>NamedQuery</em>
annotation. When specified, this property must be observed. The provider
is permitted to lock more (but not fewer) rows than requested.</p>
</div>
<div class="paragraph">
<p>The following hint is defined by this
specification for use in pessimistic locking.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jakarta.persistence.lock.timeout <span class="comment">// time in milliseconds</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This hint may be used with the methods of the
<em>EntityManager</em> interface that allow lock modes to be specified, the
<em>Query.setLockMode</em> method and the <em>NamedQuery</em> annotation. It may also
be passed as a property to the <em>Persistence.createEntityManagerFactory</em>
method and used in the <em>properties</em> element of the <em>persistence.xml</em>
file. See <a href="#a1066">Section 3.1.1</a>, <a href="#a4385">Section 3.10.9</a>, <a href="#a12384">Section 8.2.1.9</a>, <a href="#a13443">Section 9.7</a>,
and <a href="#a13711">Section 10.4.1</a>. When used in
the <em>createEntityManagerFactory</em> method, the <em>persistence.xml</em> file, and
the <em>NamedQuery</em> annotation, the timeout hint serves as a default value
which can be selectively overridden by use in the methods of the
<em>EntityManager</em>, <em>Query</em>, and <em>TypedQuery</em> interfaces as specified
above. When this hint is not specified, database timeout values are
assumed to apply.</p>
</div>
<div class="paragraph">
<p>A timeout value of <em>0</em> is used to specify “no wait” locking.</p>
</div>
<div class="paragraph">
<p>Portable applications should not rely on this
hint. Depending on the database in use and the locking mechanisms used
by the persistence provider, the hint may or may not be observed.</p>
</div>
<div class="paragraph">
<p>Vendors are permitted to support the use of
additional, vendor-specific locking hints. Vendor-specific hints must
not use the <em>jakarta.persistence</em> namespace. Vendor-specific hints must be
ignored if they are not understood.</p>
</div>
<div class="paragraph">
<p>If the same property or hint is specified
more than once, the following order of overriding applies, in order of
decreasing precedence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>argument to method of <em>EntityManager</em>, <em>Query</em>, or <em>TypedQuery</em> interface</p>
</li>
<li>
<p>specification to <em>NamedQuery</em> (annotation or XML)</p>
</li>
<li>
<p>argument to <em>createEntityManagerFactory</em> method</p>
</li>
<li>
<p>specification in <em>persistence.xml</em></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="optimisticlockexception"><a class="anchor" href="#optimisticlockexception"></a>3.4.5. OptimisticLockException</h4>
<div class="paragraph">
<p>Provider implementations may defer writing to
the database until the end of the transaction, when consistent with the
lock mode and flush mode settings in effect. In this case, an optimistic
lock check may not occur until commit time, and the
<em>OptimisticLockException</em> may be thrown in the “before completion” phase
of the commit. If the <em>OptimisticLockException</em> must be caught or
handled by the application, the <em>flush</em> method should be used by the
application to force the database writes to occur. This will allow the
application to catch and handle optimistic lock exceptions.</p>
</div>
<div class="paragraph">
<p>The <em>OptimisticLockException</em> provides an API
to return the object that caused the exception to be thrown. The object
reference is not guaranteed to be present every time the exception is
thrown but should be provided whenever the persistence provider can
supply it. Applications cannot rely upon this object being available.</p>
</div>
<div class="paragraph">
<p>In some cases an <em>OptimisticLockException</em>
will be thrown and wrapped by another exception, such as a
<em>RemoteException</em>, when VM boundaries are crossed. Entities that may be
referenced in wrapped exceptions should implement <em>Serializable</em> so that
marshalling will not fail.</p>
</div>
<div class="paragraph">
<p>An <em>OptimisticLockException</em> always causes
the transaction to be marked for rollback.</p>
</div>
<div class="paragraph">
<p>Refreshing objects or reloading objects in a
new transaction context and then retrying the transaction is a potential
response to an <em>OptimisticLockException</em>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2153"><a class="anchor" href="#a2153"></a>3.5. Entity Listeners and Callback Methods</h3>
<div class="paragraph">
<p>A method may be designated as a lifecycle
callback method to receive notification of entity lifecycle events. A
lifecycle callback method can be defined on an entity class, a mapped
superclass, or an entity listener class associated with an entity or
mapped superclass. An entity listener class is a class whose methods are
invoked in response to lifecycle events on an entity. Any number of
entity listener classes can be defined for an entity class or mapped
superclass.</p>
</div>
<div class="paragraph">
<p>Default entity listeners—entity listener
classes whose callback methods apply to all entities in the persistence
unit—can be specified by means of the XML descriptor.</p>
</div>
<div class="paragraph">
<p>Lifecycle callback methods and entity
listener classes are defined by means of metadata annotations or the XML
descriptor. When annotations are used, one or more entity listener
classes are denoted using the <em>EntityListeners</em> annotation on the entity
class or mapped superclass. If multiple entity listeners are defined,
the order in which they are invoked is determined by the order in which
they are specified in the <em>EntityListeners</em> annotation. The XML
descriptor may be used as an alternative to specify the invocation order
of entity listeners or to override the order specified in metadata
annotations.</p>
</div>
<div class="paragraph">
<p>Any subset or combination of annotations may
be specified on an entity class, mapped superclass, or listener class. A
single class must not have more than one lifecycle callback method for
the same lifecycle event. The same method may be used for multiple
callback events.</p>
</div>
<div class="paragraph">
<p>Multiple entity classes and mapped
superclasses in an inheritance hierarchy may define listener classes
and/or lifecycle callback methods directly on the class. <a href="#a2251">Section 3.5.5</a>
describes the rules that apply to method invocation order in this case.</p>
</div>
<div class="sect3">
<h4 id="entity-listeners"><a class="anchor" href="#entity-listeners"></a>3.5.1. Entity Listeners</h4>
<div class="paragraph">
<p>The entity listener class must have a public no-arg constructor.</p>
</div>
<div class="paragraph">
<p>Entity listener classes in Jakarta EE
environments support dependency injection through the Contexts and
Dependency Injection API (CDI) <a href="#a19500">[7]</a> when CDI is
enabled<sup class="footnote">[<a id="_footnoteref_41" class="footnote" href="#_footnotedef_41" title="View footnote.">41</a>]</sup></a>.]. An entity listener class that makes use
of CDI injection may also define lifecycle callback methods annotated
with the <em>PostConstruct</em> and <em>PreDestroy</em> annotations. These methods
will be invoked after injection has taken place and before the entity
listener instance is destroyed respectively.</p>
</div>
<div class="paragraph">
<p>The persistence provider is responsible for
using the CDI SPI to create instances of the entity listener class; to
perform injection upon such instances; to invoke their <em>PostConstruct</em>
and <em>PreDestroy</em> methods, if any; and to dispose of the entity listener
instances.</p>
</div>
<div class="paragraph">
<p>The persistence provider is only required to
support CDI injection into entity listeners in Jakarta EE container
environments<sup class="footnote">[<a id="_footnoteref_42" class="footnote" href="#_footnotedef_42" title="View footnote.">42</a>]</sup>. If the CDI is not enabled, the
persistence provider must not invoke entity listeners that depend upon
CDI injection.</p>
</div>
<div class="paragraph">
<p>An entity listener is a noncontextual object.
In supporting injection into entity listeners, the persistence provider
must behave as if it carries out the following steps involving the use
of the CDI SPI. (See <a href="#a19500">[7]</a>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain a <em>BeanManager</em> instance. (See <a href="#a12802">Section 9.1</a>)</p>
</li>
<li>
<p>Create an <em>AnnotatedType</em> instance for the entity listener class.</p>
</li>
<li>
<p>Create an <em>InjectionTarget</em> instance for the annotated type.</p>
</li>
<li>
<p>Create a <em>CreationalContext</em>.</p>
</li>
<li>
<p>Instantiate the listener by calling the <em>InjectionTarget</em> <em>produce</em> method.</p>
</li>
<li>
<p>Inject the listener instance by calling the
<em>InjectionTarget</em> <em>inject</em> method on the instance.</p>
</li>
<li>
<p>Invoke the <em>PostConstruct</em> callback, if any,
by calling the <em>InjectionTarget</em> <em>postConstruct</em> method on the instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the listener instance is to be
destroyed, the persistence provider must behave as if it carries out the
following steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Call the <em>InjectionTarget</em> <em>preDestroy</em> method on the instance.</p>
</li>
<li>
<p>Call the <em>InjectionTarget</em> <em>dispose</em> method on the instance</p>
</li>
<li>
<p>Call the <em>CreationalContext</em> <em>release</em> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Persistence providers may optimize the steps
above, e.g. by avoiding calls to the actual CDI SPI and relying on
container-specific interfaces instead, as long as the outcome is the
same.</p>
</div>
<div class="paragraph">
<p>Entity listeners that do not make use of CDI
injection are stateless. The lifecycle of such entity listeners is
unspecified.</p>
</div>
<div class="paragraph">
<p>When invoked from within a Jakarta EE
environment, the callback listeners for an entity share the enterprise
naming context of the invoking component, and the entity callback
methods are invoked in the transaction and security contexts of the
calling component at the time at which the callback method is invoked.
<sup class="footnote">[<a id="_footnoteref_43" class="footnote" href="#_footnotedef_43" title="View footnote.">43</a>]</sup></p>
</div>
</div>
<div class="sect3">
<h4 id="lifecycle-callback-methods"><a class="anchor" href="#lifecycle-callback-methods"></a>3.5.2. Lifecycle Callback Methods</h4>
<div class="paragraph">
<p>Entity lifecycle callback methods can be
defined on an entity listener class and/or directly on an entity class
or mapped superclass.</p>
</div>
<div class="paragraph">
<p>Lifecycle callback methods are annotated with
annotations designating the callback events for which they are invoked
or are mapped to the callback event using the XML descriptor.</p>
</div>
<div class="paragraph">
<p>The annotations (and XML elements) used for
callback methods on the entity class or mapped superclass and for
callback methods on the entity listener class are the same. The
signatures of individual methods, however, differ.</p>
</div>
<div class="paragraph">
<p>Callback methods defined on an entity class
or mapped superclass have the following signature:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>void &lt;METHOD&gt;()</pre>
</div>
</div>
<div class="paragraph">
<p>Callback methods defined on an entity
listener class have the following signature:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>void &lt;METHOD&gt;(Object)</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>Object</em> argument is the entity instance
for which the callback method is invoked. It may be declared as the
actual entity type.</p>
</div>
<div class="paragraph">
<p>The callback methods can have public,
private, protected, or package level access, but must not be <em>static</em> or
<em>final</em>.</p>
</div>
<div class="paragraph">
<p>The following annotations designate lifecycle
event callback methods of the corresponding types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>PrePersist</em></p>
</li>
<li>
<p><em>PostPersist</em></p>
</li>
<li>
<p><em>PreRemove</em></p>
</li>
<li>
<p><em>PostRemove</em></p>
</li>
<li>
<p><em>PreUpdate</em></p>
</li>
<li>
<p><em>PostUpdate</em></p>
</li>
<li>
<p><em>PostLoad</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following rules apply to lifecycle callback methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lifecycle callback methods may throw
unchecked/runtime exceptions. A runtime exception thrown by a callback
method that executes within a transaction causes that transaction to be
marked for rollback if the persistence context is joined to the
transaction.</p>
</li>
<li>
<p>Lifecycle callbacks can invoke JNDI, JDBC,
JMS, and enterprise beans.</p>
</li>
<li>
<p>In general, the lifecycle method of a
portable application should not invoke <em>EntityManager</em> or query
operations, access other entity instances, or modify relationships
within the same persistence
context<sup class="footnote">[<a id="_footnoteref_44" class="footnote" href="#_footnotedef_44" title="View footnote.">44</a>]</sup><sup class="footnote">[<a id="_footnoteref_45" class="footnote" href="#_footnotedef_45" title="View footnote.">45</a>]</sup>. A lifecycle
callback method may modify the non-relationship state of the entity on
which it is invoked.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a2202"><a class="anchor" href="#a2202"></a>3.5.3. Semantics of the Life Cycle Callback Methods for Entities</h4>
<div class="paragraph">
<p>The <em>PrePersist</em> and <em>PreRemove</em> callback
methods are invoked for a given entity before the respective
EntityManager persist and remove operations for that entity are
executed. For entities to which the merge operation has been applied and
causes the creation of newly managed instances, the <em>PrePersist</em>
callback methods will be invoked for the managed instance after the
entity state has been copied to it. These <em>PrePersist</em> and <em>PreRemove</em>
callbacks will also be invoked on all entities to which these operations
are cascaded. The <em>PrePersist</em> and <em>PreRemove</em> methods will always be
invoked as part of the synchronous persist, merge, and remove
operations.</p>
</div>
<div class="paragraph">
<p>The <em>PostPersist</em> and <em>PostRemove</em> callback
methods are invoked for an entity after the entity has been made
persistent or removed. These callbacks will also be invoked on all
entities to which these operations are cascaded. The <em>PostPersist</em> and
<em>PostRemove</em> methods will be invoked after the database insert and
delete operations respectively. These database operations may occur
directly after the persist, merge, or remove operations have been
invoked or they may occur directly after a flush operation has occurred
(which may be at the end of the transaction). Generated primary key
values are available in the <em>PostPersist</em> method.</p>
</div>
<div class="paragraph">
<p>The <em>PreUpdate</em> and <em>PostUpdate</em> callbacks
occur before and after the database update operations to entity data
respectively. These database operations may occur at the time the entity
state is updated or they may occur at the time state is flushed to the
database (which may be at the end of the transaction).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that it is implementation-dependent as
to whether <em>PreUpdate</em> and <em>PostUpdate</em> callbacks occur when an entity
is persisted and subsequently modified in a single transaction or when
an entity is modified and subsequently removed within a single
transaction. Portable applications should not rely on such behavior.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <em>PostLoad</em> method for an entity is
invoked after the entity has been loaded into the current persistence
context from the database or after the refresh operation has been
applied to it. The <em>PostLoad</em> method is invoked before a query result is
returned or accessed or before an association is traversed.</p>
</div>
<div class="paragraph">
<p>It is implementation-dependent as to whether
callback methods are invoked before or after the cascading of the
lifecycle events to related entities. Applications should not depend on
this ordering.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-2"><a class="anchor" href="#example-2"></a>3.5.4. Example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@EntityListeners</span>(com.acme.AlertMonitor.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Account</span> {
    <span class="predefined-type">Long</span> accountId;
    <span class="predefined-type">Integer</span> balance;
    <span class="type">boolean</span> preferred;

    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">Long</span> getAccountId() { ... }

    <span class="comment">// ...</span>

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getBalance() { ... }

    <span class="comment">// ...</span>

    <span class="annotation">@Transient</span> <span class="comment">// because status depends upon non-persistent context</span>
    <span class="directive">public</span> <span class="type">boolean</span> isPreferred() { ... }

    <span class="comment">// ...</span>

    <span class="directive">public</span> <span class="type">void</span> deposit(<span class="predefined-type">Integer</span> amount) { ... }

    <span class="directive">public</span> <span class="predefined-type">Integer</span> withdraw(<span class="predefined-type">Integer</span> amount) <span class="directive">throws</span> NSFException { ... }

    <span class="annotation">@PrePersist</span>
    <span class="directive">protected</span> <span class="type">void</span> validateCreate() {
        <span class="keyword">if</span> (getBalance() &lt; MIN_REQUIRED_BALANCE)
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">AccountException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Insufficient balance to open an account</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@PostLoad</span>
    <span class="directive">protected</span> <span class="type">void</span> adjustPreferredStatus() {
        preferred = (getBalance() &gt;= AccountManager.getPreferredStatusLevel());
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">AlertMonitor</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">public</span> <span class="type">void</span> newAccountAlert(Account acct) {
        Alerts.sendMarketingInfo(acct.getAccountId(), acct.getBalance());
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a2251"><a class="anchor" href="#a2251"></a>3.5.5. Multiple Lifecycle Callback Methods for an Entity Lifecycle Event</h4>
<div class="paragraph">
<p>If multiple callback methods are defined for
an entity lifecycle event, the ordering of the invocation of these
methods is as follows.</p>
</div>
<div class="paragraph">
<p>Default listeners, if any, are invoked first,
in the order specified in the XML descriptor. Default listeners apply to
all entities in the persistence unit, unless explicitly excluded by
means of the <em>ExcludeDefaultListeners</em> annotation or
<em>exclude-default-listeners</em> XML element.</p>
</div>
<div class="paragraph">
<p>The lifecycle callback methods defined on the
entity listener classes for an entity class or mapped superclass are
invoked in the same order as the specification of the entity listener
classes in the <em>EntityListeners</em> annotation.</p>
</div>
<div class="paragraph">
<p>If multiple classes in an inheritance
hierarchy—entity classes and/or mapped superclasses—define entity
listeners, the listeners defined for a superclass are invoked before the
listeners defined for its subclasses in this order. The
<em>ExcludeSuperclassListeners</em> annotation or
<em>exclude-superclass-listeners</em> XML element may be applied to an entity
class or mapped superclass to exclude the invocation of the listeners
defined by the entity listener classes for the superclasses of the
entity or mapped superclass. The excluded listeners are excluded from
the class to which the <em>ExcludeSuperclassListeners</em> annotation or
element has been specified and its subclasses<sup class="footnote">[<a id="_footnoteref_46" class="footnote" href="#_footnotedef_46" title="View footnote.">46</a>]</sup>.
The <em>ExcludeSuperclassListeners</em> annotation (or
<em>exclude-superclass-listeners</em> XML element) does not cause default
entity listeners to be excluded from invocation.</p>
</div>
<div class="paragraph">
<p>If a lifecycle callback method for the
same lifecycle event is also specified on the entity class and/or one or
more of its entity or mapped superclasses, the callback methods on the
entity class and/or superclasses are invoked after the other lifecycle
callback methods, most general superclass first. A class is permitted to
override an inherited callback method of the same callback type, and in
this case, the overridden method is not invoked<sup class="footnote">[<a id="_footnoteref_47" class="footnote" href="#_footnotedef_47" title="View footnote.">47</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>Callback methods are invoked by the
persistence provider runtime in the order specified. If the callback
method execution terminates normally, the persistence provider runtime
then invokes the next callback method, if any.</p>
</div>
<div class="paragraph">
<p>The XML descriptor may be used to override
the lifecycle callback method invocation order specified in annotations.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-3"><a class="anchor" href="#example-3"></a>3.5.6. Example</h4>
<div class="paragraph">
<p>There are several entity classes and listeners for animals:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Animal</span> {

    <span class="comment">// ...</span>

    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistAnimal() {
        <span class="comment">// ...</span>
    }
}

<span class="annotation">@Entity</span>
<span class="annotation">@EntityListeners</span>(PetListener.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Pet</span> <span class="directive">extends</span> Animal {
    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@EntityListeners</span>({CatListener.class, CatListener2.class})
<span class="directive">public</span> <span class="type">class</span> <span class="class">Cat</span> <span class="directive">extends</span> Pet {
    <span class="comment">// ...</span>
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">PetListener</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistPetListenerMethod(<span class="predefined-type">Object</span> pet) {
        <span class="comment">// ...</span>
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">CatListener</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistCatListenerMethod(<span class="predefined-type">Object</span> cat) {
        <span class="comment">// ...</span>
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">CatListener2</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistCatListener2Method(<span class="predefined-type">Object</span> cat) {
        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <em>PostPersist</em> event occurs on an
instance of <em>Cat</em>, the following methods are called in order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>postPersistPetListenerMethod</p>
</li>
<li>
<p>postPersistCatListenerMethod</p>
</li>
<li>
<p>postPersistCatListener2Method</p>
</li>
<li>
<p>postPersistAnimal</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Assume that <em>SiameseCat</em> is defined as a
subclass of <em>Cat</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EntityListeners</span>(SiameseCatListener.class)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SiameseCat</span> <span class="directive">extends</span> Cat {
    <span class="comment">// ...</span>

    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistSiameseCat() {
        <span class="comment">// ...</span>
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">SiameseCatListener</span> {
    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistSiameseCatListenerMethod(<span class="predefined-type">Object</span> cat) {
        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <em>PostPersist</em> event occurs on an
instance of <em>SiameseCat</em>, the following methods are called in order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>postPersistPetListenerMethod</p>
</li>
<li>
<p>postPersistCatListenerMethod</p>
</li>
<li>
<p>postPersistCatListener2Method</p>
</li>
<li>
<p>postPersistSiameseCatListenerMethod</p>
</li>
<li>
<p>postPersistAnimal</p>
</li>
<li>
<p>postPersistSiameseCat</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Assume the definition of <em>SiameseCat</em> were instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EntityListeners</span>(SiameseCatListener.class)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SiameseCat</span> <span class="directive">extends</span> Cat {
    <span class="comment">// ...</span>

    <span class="annotation">@PostPersist</span>
    <span class="directive">protected</span> <span class="type">void</span> postPersistAnimal() {
        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the following methods would be
called in order, where <em>postPersistAnimal</em> is the <em>PostPersist</em> method
defined in the <em>SiameseCat</em> class:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>postPersistPetListenerMethod</p>
</li>
<li>
<p>postPersistCatListenerMethod</p>
</li>
<li>
<p>postPersistCatListener2Method</p>
</li>
<li>
<p>postPersistSiameseCatListenerMethod</p>
</li>
<li>
<p>postPersistAnimal</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="exceptions"><a class="anchor" href="#exceptions"></a>3.5.7. Exceptions</h4>
<div class="paragraph">
<p>Lifecycle callback methods may throw runtime
exceptions. A runtime exception thrown by a callback method that
executes within a transaction causes that transaction to be marked for
rollback if the persistence context is joined to the transaction. No
further lifecycle callback methods will be invoked after a runtime
exception is thrown.</p>
</div>
</div>
<div class="sect3">
<h4 id="specification-of-callback-listener-classes-and-lifecycle-methods-in-the-xml-descriptor"><a class="anchor" href="#specification-of-callback-listener-classes-and-lifecycle-methods-in-the-xml-descriptor"></a>3.5.8. Specification of Callback Listener Classes and Lifecycle Methods in the XML Descriptor</h4>
<div class="paragraph">
<p>The XML descriptor can be used as an
alternative to metadata annotations to specify entity listener classes
and their binding to entities or to override the invocation order of
lifecycle callback methods as specified in annotations.</p>
</div>
<div class="sect4">
<h5 id="specification-of-callback-listeners"><a class="anchor" href="#specification-of-callback-listeners"></a>3.5.8.1. Specification of Callback Listeners</h5>
<div class="paragraph">
<p>The <em>entity-listener</em> XML descriptor element
is used to specify the lifecycle listener methods of an entity listener
class. The lifecycle listener methods are specified by using the
<em>pre-persist</em>, <em>post-persist</em>, <em>pre-remove</em>, <em>post-remove</em>,
<em>pre-update</em>, <em>post-update</em>, and/or <em>post-load</em> elements.</p>
</div>
<div class="paragraph">
<p>An entity listener class can define multiple
callback methods. However, at most one method of an entity listener
class can be designated as a pre-persist method, post-persist method,
pre-remove method, post-remove method, pre-update method, post-update
method, and/or post-load method, regardless of whether the XML
descriptor is used to define entity listeners or whether some
combination of annotations and XML descriptor elements is used.</p>
</div>
</div>
<div class="sect4">
<h5 id="specification-of-the-binding-of-entity-listener-classes-to-entities"><a class="anchor" href="#specification-of-the-binding-of-entity-listener-classes-to-entities"></a>3.5.8.2. Specification of the Binding of Entity Listener Classes to Entities</h5>
<div class="paragraph">
<p>The <em>entity-listeners</em> subelement of the
<em>persistence-unit-defaults</em> element is used to specify the default
entity listeners for the persistence unit.</p>
</div>
<div class="paragraph">
<p>The <em>entity-listeners</em> subelement of the
<em>entity</em> or <em>mapped-superclass</em> element is used to specify the entity
listener classes for the respective entity or mapped superclass and its
subclasses.</p>
</div>
<div class="paragraph">
<p>The binding of entity listeners to entity
classes is additive. The entity listener classes bound to the
superclasses of an entity or mapped superclass are applied to it as
well.</p>
</div>
<div class="paragraph">
<p>The <em>exclude-superclass-listeners</em> element
specifies that the listener methods for superclasses are not to be
invoked for an entity class (or mapped superclass) and its subclasses.</p>
</div>
<div class="paragraph">
<p>The <em>exclude-default-listeners</em> element
specifies that default entity listeners are not to be invoked for an
entity class (or mapped superclass) and its subclasses.</p>
</div>
<div class="paragraph">
<p>Explicitly listing an excluded default or
superclass listener for a given entity class or mapped superclass causes
it to be applied to that entity or mapped superclass and its subclasses.</p>
</div>
<div class="paragraph">
<p>In the case of multiple callback methods for
a single lifecycle event, the invocation order rules described in <a href="#a2251">Section 3.5.5</a> apply.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2366"><a class="anchor" href="#a2366"></a>3.6. Bean Validation</h3>
<div class="paragraph">
<p>This specification defines support for use of
Bean Validation <a href="#a19498">[5]</a> within Jakarta Persistence
applications.</p>
</div>
<div class="paragraph">
<p>Managed classes (entities, mapped
superclasses, and embeddable classes) may be configured to include Bean
Validation constraints.</p>
</div>
<div class="paragraph">
<p>Automatic validation using these constraints
is achieved by specifying that Jakarta Persistence delegate validation to
the Bean Validation implementation upon the pre-persist, pre-update, and
pre-remove entity lifecycle events described in <a href="#a2202">Section 3.5.3</a>.</p>
</div>
<div class="paragraph">
<p>Validation can also be achieved by the
application calling the <em>validate</em> method of a <em>Validator</em> instance upon
an instance of a managed class, as described in the Bean Validation
specification <a href="#a19498">[5]</a>.</p>
</div>
<div class="sect3">
<h4 id="automatic-validation-upon-lifecycle-events"><a class="anchor" href="#automatic-validation-upon-lifecycle-events"></a>3.6.1. Automatic Validation Upon Lifecycle Events</h4>
<div class="paragraph">
<p>This specification supports the use of bean
validation for the automatic validation of entities upon the
pre-persist, pre-update, and pre-remove lifecycle validation events.
These lifecycle validation events occur immediately after the point at
which all the <em>PrePersist</em>, <em>PreUpdate</em>, and <em>PreRemove</em> lifecycle
callback method invocations respectively have been completed, or
immediately after the point at which such lifecycle callback methods
would have been completed (in the event that such callback methods are
not present).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the case where an entity is persisted and
subsequently modified in a single transaction or when an entity is
modified and subsequently removed in a single transaction, it is
implementation dependent as to whether the pre-update validation event
occurs. Portable applications should not rely on this behavior.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="a2374"><a class="anchor" href="#a2374"></a>3.6.1.1. Enabling Automatic Validation</h5>
<div class="paragraph">
<p>The <em>validation-mode</em> element of the
<em>persistence.xml</em> file determines whether the automatic lifecycle event
validation is in effect. The values of the <em>validation-mode</em> element are
<em>AUTO</em>, <em>CALLBACK</em>, <em>NONE</em>. The default validation mode is <em>AUTO</em>.</p>
</div>
<div class="paragraph">
<p>If the application creates the entity manager
factory using the <em>Persistence.createEntityManagerFactory</em> method, the
validation mode can be specified using the
<em>jakarta.persistence.validation.mode</em> map key, which will override the
value specified (or defaulted) in the <em>persistence.xml</em> file. The map
values for this key are <em>"auto"</em>, <em>"callback"</em>, <em>"none"</em>.</p>
</div>
<div class="paragraph">
<p>If the auto validation mode is specified by
the <em>validation-mode</em> element or the <em>jakarta.persistence.validation.mode</em>
property, or if neither the <em>validation-mode</em> element nor the
<em>jakarta.persistence.validation.mode</em> property is specified, and a Bean
Validation provider is present in the environment, the persistence
provider must perform the automatic validation of entities as described
in <a href="#a2380">Section 3.6.1.2</a>. If no Bean Validation provider is
present in the environment, no lifecycle event validation takes place.</p>
</div>
<div class="paragraph">
<p>If the callback validation mode is specified
by the <em>validation-mode</em> element or the
<em>jakarta.persistence.validation.mode</em> property, the persistence provider
must perform the lifecycle event validation as described in <a href="#a2380">Section 3.6.1.2</a>.
It is an error if there is no Bean Validation
provider present in the environment, and the provider must throw the
<em>PersistenceException</em> if the <em>jakarta.persistence.validation.mode</em>
property value <em>"callback"</em> has been passed to the
<em>Persistence.createEntityManagerFactory</em> method.</p>
</div>
<div class="paragraph">
<p>If the none validation mode is specified by
the <em>validation-mode</em> element or the <em>jakarta.persistence.validation.mode</em>
property, the persistence provider must not perform lifecycle event
validation.</p>
</div>
</div>
<div class="sect4">
<h5 id="a2380"><a class="anchor" href="#a2380"></a>3.6.1.2. Requirements for Automatic Validation upon Lifecycle Events</h5>
<div class="paragraph">
<p>For each event type, a list of groups is
targeted for validation. By default, the default Bean Validation group
(the group <em>Default</em>) will be validated upon the pre-persist and
pre-update lifecycle validation events, and no group will be validated
upon the pre-remove event.</p>
</div>
<div class="paragraph">
<p>This default validation behavior can be
overridden by specifying the target groups using the following
validation properties in the <em>persistence.xml</em> file or by passing these
properties in the configuration of the entity manager factory through
the <em>createEntityManagerFactory</em> method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.validation.group.pre-persist</em></p>
</li>
<li>
<p><em>jakarta.persistence.validation.group.pre-update</em></p>
</li>
<li>
<p><em>jakarta.persistence.validation.group.pre-remove</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The value of a validation property must be a
list of the targeted groups. A targeted group must be specified by its
fully qualified class name. Names must be separated by a comma.</p>
</div>
<div class="paragraph">
<p>When one of the above events occurs for an
entity, the persistence provider must validate that entity by obtaining
a <em>Validator</em> instance from the validator factory in use (see <a href="#a2394">Section 3.6.2</a>) and
invoking its <em>validate</em> method with the targeted groups. If the list of
targeted groups is empty, no validation is performed. If the set of
<em>ConstraintViolation</em> objects returned by the <em>validate</em> method is not
empty, the persistence provider must throw the
<em>jakarta.validation.ConstraintViolationException</em> containing a reference
to the returned set of <em>ConstraintViolation</em> objects, and must mark the
transaction for rollback if the persistence context is joined to the
transaction.</p>
</div>
<div class="paragraph">
<p>The validator instance that is used for
automatic validation upon lifecycle events must use a
<em>TraversableResolver</em> that has the following behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Attributes that have not been loaded must not
be loaded.</p>
</li>
<li>
<p>Validation cascade (<em>@Valid</em>) must not
occur for entity associations (single- or multi-valued).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These requirements guarantee that no unloaded
attribute or association will be loaded by side effect and that no
entity will be validated more than once during a given flush cycle.</p>
</div>
<div class="paragraph">
<p>Embeddable attributes must be validated only
if the <em>Valid</em> annotation has been specified on them.</p>
</div>
<div class="paragraph">
<p>It is the responsibility of the persistence
provider to pass an instance implementing the
<em>jakarta.validation.TraversableResolver</em> interface to the Bean Validation
provider by calling
<em>ValidatorFactory.usingContext().traversableResolver(tr).getValidator()</em> where <em>tr</em> is the resolver having the behavior described above.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a2394"><a class="anchor" href="#a2394"></a>3.6.2. Providing the ValidatorFactory</h4>
<div class="paragraph">
<p>In Jakarta EE environments, a <em>ValidatorFactory</em>
instance is made available by the Jakarta EE container. The container is
responsible for passing this validator factory to the persistence
provider via the map that is passed as an argument to the
<em>createContainerEntityManagerFactory</em> call. The map key used by the
container must be the standard property name
<em>jakarta.persistence.validation.factory</em>.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, the application can
pass the <em>ValidatorFactory</em> instance via the map that is passed as an
argument to the <em>Persistence.createEntityManagerFactory</em> call. The map
key used must be the standard property name
<em>jakarta.persistence.validation.factory</em>. If no <em>ValidatorFactory</em>
instance is provided by the application, and if a Bean Validation
provider is present in the classpath, the persistence provider must
instantiate the <em>ValidatorFactory</em> using the default bootstrapping
approach defined by the Bean Validation specification
<a href="#a19498">[5]</a>, namely <em>Validation.buildDefaultValidatorFactory()</em>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2397"><a class="anchor" href="#a2397"></a>3.7. Entity Graphs</h3>
<div class="paragraph">
<p>An entity graph is a template that captures
the path and boundaries for an operation or query. It is defined in the
form of metadata or an object created by the dynamic <em>EntityGraph</em> API.</p>
</div>
<div class="paragraph">
<p>Entity graphs are used in the specification
of “fetch plans” for query or <em>find</em> operations.</p>
</div>
<div class="paragraph">
<p>The <em>EntityGraph</em>, <em>AttributeNode</em>, and
<em>Subgraph</em> interfaces are used to dynamically construct entity graphs.
The annotations to statically define entity graphs, namely
<em>NamedEntityGraph</em>, <em>NamedAttributeNode</em>, and <em>NamedSubgraph</em>, are
described in <a href="#a13662">Section 10.3</a>.
The <em>named-entity-graph</em> XML element and its subelements may be used to
override these annotations or to define additional named entity graphs.</p>
</div>
<div class="paragraph">
<p>The semantics of entity graphs with regard to
find and query operations are described in <a href="#a2814">Section 3.7.4</a>.</p>
</div>
<div class="sect3">
<h4 id="entitygraph-interface"><a class="anchor" href="#entitygraph-interface"></a>3.7.1. EntityGraph Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Attribute</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * This type represents the root of an entity graph that will be used
 * as a template to define the attribute nodes and boundaries of a
 * graph of entities and entity relationships. The root must be an
 * entity type.
 * &lt;p&gt;
 * The methods to add subgraphs implicitly create the
 * corresponding attribute nodes as well; such attribute nodes
 * should not be redundantly specified.
 *
 * @param &lt;T&gt; The type of the root entity.
 *
 * @see AttributeNode
 * @see Subgraph
 * @see NamedEntityGraph
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityGraph</span>&lt;T&gt; {

    <span class="comment">/**
     * Return the name of a named EntityGraph (an entity graph
     * defined by means of the &lt;code&gt;NamedEntityGraph&lt;/code&gt;
     * annotation, XML descriptor element, or added by means of the
     * &lt;code&gt;addNamedEntityGraph&lt;/code&gt; method.  Returns null if the
     * EntityGraph is not a named EntityGraph.
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     * Add one or more attribute nodes to the entity graph.
     *
     * @param attributeName  name of the attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> <span class="type">void</span> addAttributeNodes(<span class="predefined-type">String</span> ... attributeName);

    <span class="comment">/**
     * Add one or more attribute nodes to the entity graph.
     *
     * @param attribute  attribute
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> <span class="type">void</span> addAttributeNodes(<span class="predefined-type">Attribute</span>&lt;T, ?&gt;... attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type. This allows for construction of multi-node entity graphs
     * that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target type
     *         is not a managed type
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">Attribute</span>&lt;T, X&gt; attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type with inheritance.  This allows for multiple subclass
     * subgraphs to be defined for this node of the entity
     * graph. Subclass subgraphs will automatically include the
     * specified attributes of superclass subgraphs.
     *
     * @param attribute  attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;? <span class="directive">extends</span> X&gt; addSubgraph(<span class="predefined-type">Attribute</span>&lt;T, X&gt; attribute, <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type. This allows for construction of multi-node entity graphs
     * that include related managed types.
     *
     * @param attributeName  name of the attribute
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target type
     *         is not a managed type
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type with inheritance.  This allows for multiple subclass
     * subgraphs to be defined for this node of the entity graph.
     * Subclass subgraphs will automatically include the specified
     * attributes of superclass subgraphs.
     *
     * @param attributeName  name of the attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this managed type.
     * @throws IllegalArgumentException if the attribute's target type
     *         is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute's target type
     *         is not an entity
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">Attribute</span>&lt;T, X&gt; attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type with inheritance. This allows for
     * construction of multi-node entity graphs that include related
     * managed types.  Subclass subgraphs will include the specified
     * attributes of superclass subgraphs.
     *
     * @param attribute  attribute
     * @param type  entity subclass
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute's target type
     *         is not an entity
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;? <span class="directive">extends</span> X&gt; addKeySubgraph(<span class="predefined-type">Attribute</span>&lt;T, X&gt; attribute, <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attributeName  name of the attribute
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target type
     *         is not an entity
     * @throws IllegalStateException if this EntityGraph has been
     *          statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type with inheritance. This allows for
     * construction of multi-node entity graphs that include related
     * managed types. Subclass subgraphs will automatically include
     * the specified attributes of superclass subgraphs
     *
     * @param attributeName  name of the attribute
     * @param type  entity subclass
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target type
     *         is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Class</span>&lt;X&gt; type);


    <span class="comment">/**
     * Add additional attributes to this entity graph that
     * correspond to attributes of subclasses of this EntityGraph's
     * entity type.  Subclass subgraphs will automatically include the
     * specified attributes of superclass subgraphs.
     *
     * @param type  entity subclass
     * @return subgraph for the subclass
     * @throws IllegalArgumentException if the type is not an entity type
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;T&gt; Subgraph&lt;? <span class="directive">extends</span> T&gt; addSubclassSubgraph(<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> T&gt; type);


    <span class="comment">/**
     * Return the attribute nodes of this entity that are included in
     * the entity graph.
     * @return attribute nodes for the annotated entity type or empty
     *         list if none have been defined
     */</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;AttributeNode&lt;?&gt;&gt; getAttributeNodes();

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="attributenode-interface"><a class="anchor" href="#attributenode-interface"></a>3.7.2. AttributeNode Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.Map</span>;

<span class="comment">/**
 * Represents an attribute node of an entity graph.
 *
 * @param &lt;T&gt; The type of the attribute.
 *
 * @see EntityGraph
 * @see Subgraph
 * @see NamedAttributeNode
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AttributeNode</span>&lt;T&gt; {

    <span class="comment">/**
     * Return the name of the attribute corresponding to the
     * attribute node.
     * @return name of the attribute
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getAttributeName();

    <span class="comment">/**
     * Return the Map&amp;#060;Class, Subgraph&amp;#062; of subgraphs associated
     * with this attribute node.
     * @return Map of subgraphs associated with this attribute node
     * or empty Map if none have been defined
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">Class</span>, Subgraph&gt; getSubgraphs();

    <span class="comment">/**
     * Return the Map&amp;#060;Class, Subgraph&amp;#062; of subgraphs associated
     * with this attribute node's map key.
     * @return Map of subgraphs associated with this attribute
     * node's map key or empty Map if none have been defined
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">Class</span>, Subgraph&gt; getKeySubgraphs();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="subgraph-interface"><a class="anchor" href="#subgraph-interface"></a>3.7.3. Subgraph Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Attribute</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * This type represents a subgraph for an attribute node that
 * corresponds to a Managed Type. Using this class, an entity subgraph
 * can be embedded within an EntityGraph.
 *
 * @param &lt;T&gt; The type of the attribute.
 *
 * @see EntityGraph
 * @see AttributeNode
 * @see NamedSubgraph
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Subgraph</span>&lt;T&gt; {

    <span class="comment">/**
     * Add one or more attribute nodes to the entity graph.
     *
     * @param attributeName  name of the attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this managed type.
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> <span class="type">void</span> addAttributeNodes(<span class="predefined-type">String</span> ... attributeName);

    <span class="comment">/**
     * Add one or more attribute nodes to the entity graph.
     * @param attribute  attribute
     *
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> <span class="type">void</span> addAttributeNodes(<span class="predefined-type">Attribute</span>&lt;T, ?&gt;... attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type. This allows for construction of multi-node entity graphs
     * that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if the EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">Attribute</span>&lt;T, X&gt; attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type with inheritance.  This allows for multiple subclass
     * subgraphs to be defined for this node of the entity
     * graph. Subclass subgraphs will automatically include the specified
     * attributes of superclass subgraphs
     *
     * @param attribute  attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;? <span class="directive">extends</span> X&gt; addSubgraph(<span class="predefined-type">Attribute</span>&lt;T, X&gt; attribute, <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type. This allows for construction of multi-node entity graphs
     * that include related managed types.
     *
     * @param attributeName  name of the attribute
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this managed type.
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a managed
     * type with inheritance.  This allows for multiple subclass
     * subgraphs to be defined for this node of the entity
     * graph. Subclass subgraphs will automatically include the
     * specified attributes of superclass subgraphs
     *
     * @param attributeName  name of the attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute is not
     *         an attribute of this managed type.
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addSubgraph(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type. This allows for construction of
     * multinode entity graphs that include related managed types.
     *
     * @param attribute  attribute
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type entity
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">Attribute</span>&lt;T, X&gt; attribute);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type with inheritance. This allows for
     * construction of multi-node entity graphs that include related
     * managed types.  Subclass subgraphs will automatically include
     * the specified attributes of superclass subgraphs
     *
     * @param attribute  attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type entity
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;? <span class="directive">extends</span> X&gt; addKeySubgraph(<span class="predefined-type">Attribute</span>&lt;T, X&gt; attribute, <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt; type);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type. This allows for construction of
     * multi-node entity graphs that include related managed types.
     *
     * @param attributeName  name of the attribute
     * @return subgraph for the key attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *          statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Add a node to the graph that corresponds to a map key
     * that is a managed type with inheritance. This allows for
     * construction of multi-node entity graphs that include related
     * managed types.  Subclass subgraphs will include the specified
     * attributes of superclass subgraphs
     *
     * @param attributeName  name of the attribute
     * @param type  entity subclass
     * @return subgraph for the attribute
     * @throws IllegalArgumentException if the attribute is not an
     *         attribute of this entity.
     * @throws IllegalArgumentException if the attribute's target
     *         type is not a managed type
     * @throws IllegalStateException if this EntityGraph has been
     *         statically defined
     */</span>
    <span class="directive">public</span> &lt;X&gt; Subgraph&lt;X&gt; addKeySubgraph(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Return the attribute nodes corresponding to the attributes of
     * this managed type that are included in the subgraph.
     * @return list of attribute nodes included in the subgraph or
     * empty List if none have been defined
     */</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;AttributeNode&lt;?&gt;&gt; getAttributeNodes();

    <span class="comment">/**
     * Return the type for which this subgraph was defined.
     * @return managed type referenced by the subgraph
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Class</span>&lt;T&gt; getClassType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a2814"><a class="anchor" href="#a2814"></a>3.7.4. Use of Entity Graphs in find and query operations</h4>
<div class="paragraph">
<p>An entity graph can be used with the <em>find</em>
method or as a query hint to override or augment <em>FetchType</em> semantics.</p>
</div>
<div class="paragraph">
<p>The standard properties
<em>jakarta.persistence.fetchgraph</em> and <em>jakarta.persistence.loadgraph</em> are
used to specify such graphs to queries and <em>find</em> operations.</p>
</div>
<div class="paragraph">
<p>The default fetch graph for an entity or
embeddable is defined to consist of the transitive closure of all of its
attributes that are specified as <em>FetchType.EAGER</em> (or defaulted as
such).</p>
</div>
<div class="paragraph">
<p>The persistence provider is permitted to
fetch additional entity state beyond that specified by a fetch graph or
load graph. It is required, however, that the persistence provider fetch
all state specified by the fetch or load graph.</p>
</div>
<div class="sect4">
<h5 id="fetch-graph-semantics"><a class="anchor" href="#fetch-graph-semantics"></a>3.7.4.1. Fetch Graph Semantics</h5>
<div class="paragraph">
<p>When the <em>jakarta.persistence.fetchgraph</em>
property is used to specify an entity graph, attributes that are
specified by attribute nodes of the entity graph are treated as
<em>FetchType.EAGER</em> and attributes that are not specified are treated as
<em>FetchType.LAZY</em>.</p>
</div>
<div class="paragraph">
<p>The following rules apply, depending on
attribute type. The rules of this section are applied recursively.</p>
</div>
<div class="paragraph">
<p>A primary key or version attribute never
needs to be specified in an attribute node of a fetch graph. (This
applies to composite primary keys as well, including embedded id primary
keys.) When an entity is fetched, its primary key and version attributes
are always fetched. It is not incorrect, however, to specify primary key
attributes or version attributes.</p>
</div>
<div class="paragraph">
<p>Attributes other than primary key and version
attributes are assumed not to be fetched unless the attribute is
specified. The following rules apply to the specification of attributes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the attribute is an embedded attribute,
and the attribute is specified in an attribute node, but a subgraph is
not specified for the attribute, the default fetch graph for the
embeddable is fetched. If a subgraph is specified for the attribute, the
attributes of the embeddable are fetched according to their
specification in the corresponding subgraph.</p>
</li>
<li>
<p>If the attribute is an element collection of
basic type, and the attribute is specified in an attribute node, the
element collection together with its basic elements is fetched.</p>
</li>
<li>
<p>If the attribute is an element collection of
embeddables, and the attribute is specified in an attribute node, but a
subgraph is not specified for the attribute, the element collection
together with the default fetch graph of its embeddable elements is
fetched. If a subgraph is specified for the attribute, the attributes of
the embeddable elements are fetched according to the corresponding
subgraph specification.</p>
</li>
<li>
<p>If the attribute is a one-to-one or
many-to-one relationship, and the attribute is specified in an attribute
node, but a subgraph is not specified for the attribute, the default
fetch graph of the target entity is fetched. If a subgraph is specified
for the attribute, the attributes of the target entity are fetched
according to the corresponding subgraph specification.</p>
</li>
<li>
<p>If the attribute is a one-to-many or
many-to-many relationship, and the attribute is specified in an
attribute node, but a subgraph is not specified, the collection is
fetched and the default fetch graphs of the referenced entities are
fetched. If a subgraph is specified for the attribute, the entities in
the collection are fetched according to the corresponding subgraph
specification.</p>
</li>
<li>
<p>If the key of a map which has been specified
in an attribute node is a basic type, it is fetched. If the key of a map
which has been specified in an attribute node is an embedded type, the
default fetch graph is fetched for the embeddable. Otherwise, if the key
of the map is an entity, and a map key subgraph is not specified for the
attribute node, the map key is fetched according to its default fetch
graph. If a key subgraph is specified for the map key attribute, the map
key attribute is fetched according to the map key subgraph
specification.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedEntityGraph</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Phonenumber</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> number;

    <span class="directive">protected</span> PhoneTypeEnum type;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, only the <em>number</em> attribute would be eagerly fetched.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedEntityGraph</span>(
    attributeNodes={<span class="annotation">@NamedAttributeNode</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">projects</span><span class="delimiter">&quot;</span></span>)}
)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="annotation">@Basic</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@Basic</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> employeeNumber;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Dependents&gt; dependents;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Project&gt; projects;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;PhoneNumber&gt; phoneNumbers;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@Inheritance</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Project</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="predefined-type">String</span> name;

    <span class="annotation">@OneToOne</span>(fetch=FetchType.EAGER)
    <span class="directive">protected</span> Requirements doc;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LargeProject</span> <span class="directive">extends</span> Project {
    <span class="annotation">@OneToOne</span>(fetch=FetchType.LAZY)
    <span class="directive">protected</span> Employee approver;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Requirements</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="annotation">@Lob</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> description;

    <span class="annotation">@OneToOne</span>(fetch=FetchType.LAZY)
    <span class="directive">protected</span> Approval approval

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the <em>Employee</em> entity&#8217;s
primary key will be fetched as well as the related <em>Project</em> instances,
whose default fetch graph (<em>id</em>, <em>name</em>, and <em>doc</em> attributes) will
be fetched. The related <em>Requirements</em> object will be fetched according
to its default fetch graph.</p>
</div>
<div class="paragraph">
<p>If the <em>approver</em> attribute of <em>LargeProject</em>
were <em>FetchType.EAGER</em>, and if any of the projects were instances of
<em>LargeProject</em>, their <em>approver</em> attributes would also be fetched.
Since the type of the <em>approver</em> attribute is <em>Employee</em>, the
approver&#8217;s default fetch graph (<em>id</em>, <em>name</em>, and <em>employeeNumber</em>
attributes) would also be fetched.</p>
</div>
</div>
<div class="sect4">
<h5 id="load-graph-semantics"><a class="anchor" href="#load-graph-semantics"></a>3.7.4.2. Load Graph Semantics</h5>
<div class="paragraph">
<p>When the <em>jakarta.persistence.loadgraph</em>
property is used to specify an entity graph, attributes that are
specified by attribute nodes of the entity graph are treated as
<em>FetchType.EAGER</em> and attributes that are not specified are treated
according to their specified or default FetchType.</p>
</div>
<div class="paragraph">
<p>The following rules apply. The rules of this
section are applied recursively.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A primary key or version attribute never
needs to be specified in an attribute node of a load graph. (This
applies to composite primary keys as well, including embedded id primary
keys.) When an entity is fetched, its primary key and version attributes
are always fetched. It is not incorrect, however, to specify primary key
attributes or version attributes.</p>
</li>
<li>
<p>If the attribute is an embedded attribute,
and the attribute is specified in an attribute node, but a subgraph is
not specified for the attribute, the default fetch graph for the
embeddable is fetched. If a subgraph is specified for the attribute,
attributes that are specified by the subgraph are also fetched.</p>
</li>
<li>
<p>If the attribute is an element collection of
basic type, and the attribute is specified in an attribute node, the
element collection together with its basic elements is fetched.</p>
</li>
<li>
<p>If the attribute is an element collection of
embeddables, and the attribute is specified in an attribute node, the
element collection together with the default fetch graph of its
embeddable elements is fetched. If a subgraph is specified for the
attribute, attributes that are specified by the subgraph are also
fetched.</p>
</li>
<li>
<p>If the attribute is a one-to-one or
many-to-one relationship, and the attribute is specified in an attribute
node, the default fetch graph of the target entity is fetched. If a
subgraph is specified for the attribute, attributes that are specified
by the subgraph are also fetched.</p>
</li>
<li>
<p>If the attribute is a one-to-many or
many-to-many relationship, and the attribute is specified in an
attribute node, the collection is fetched and the default fetch graphs
of the referenced entities are fetched. If a subgraph is specified for
the attribute, attributes that are specified by the subgraph are also
fetched.</p>
</li>
<li>
<p>If the key of a map which has been specified
in an attribute node is a basic type, it is fetched. If the key of a map
which has been specified in an attribute node is an embedded type, the
default fetch graph is fetched for the embeddable. Otherwise, if the key
of the map is an entity, the map key is fetched according to its default
fetch graph. If a key subgraph is specified for the map key attribute,
additional attributes are fetched as specified in the key subgraph.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedEntityGraph</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Phonenumber</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> number;

    <span class="directive">protected</span> PhoneTypeEnum type;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the <em>number</em> and <em>type</em> attributes are fetched.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedEntityGraph</span>(
    attributeNodes={<span class="annotation">@NamedAttributeNode</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">projects</span><span class="delimiter">&quot;</span></span>)}
)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="annotation">@Basic</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@Basic</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> employeeNumber;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Dependents&gt; dependents;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Project&gt; projects;

    <span class="annotation">@OneToMany</span>()
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;PhoneNumber&gt; phoneNumbers;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@Inheritance</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Project</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="predefined-type">String</span> name;

    <span class="annotation">@OneToOne</span>(fetch=FetchType.EAGER)
    <span class="directive">protected</span> Requirements doc;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LargeProject</span> <span class="directive">extends</span> Project {
    <span class="annotation">@OneToOne</span>(fetch=FetchType.LAZY)
    <span class="directive">protected</span> Employee approver;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Requirements</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="type">long</span> id;

    <span class="annotation">@Lob</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> description;

    <span class="annotation">@OneToOne</span>(fetch=FetchType.LAZY)
    <span class="directive">protected</span> Approval approval

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the default fetch graph
(<em>id</em>, <em>name</em>, <em>employeeNumber</em> attributes) of <em>Employee</em> is fetched.
The default fetch graphs of the related <em>Project</em> instances (<em>id</em>,
<em>name</em>, and <em>doc</em> attributes) and their <em>Requirements</em> instances (<em>id</em>
and <em>description</em> attributes) are also fetched.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a2999"><a class="anchor" href="#a2999"></a>3.8. Type Conversion of Basic Attributes</h3>
<div class="paragraph">
<p>The attribute conversion facility
allows the developer to specify methods to convert between the entity
attribute representation and the database representation for attributes
of basic types. Converters can be used to convert basic attributes
defined by entity classes, mapped superclasses, or embeddable
classes.<sup class="footnote">[<a id="_footnoteref_48" class="footnote" href="#_footnotedef_48" title="View footnote.">48</a>]</sup></p>
</div>
<div class="paragraph">
<p>An attribute converter must implement the
<em>jakarta.persistence.AttributeConverter</em> interface. A converter
implementation class must be annotated with the <em>Converter</em> annotation
or defined in the XML descriptor as a converter. If the value of the
<em>autoApply</em> element of the <em>Converter</em> annotation is <em>true</em>, the
converter will be applied to all attributes of the target type,
including to basic attribute values that are contained within other,
more complex attribute types. See <a href="#a13903">Section 10.6</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * A class that implements this interface can be used to convert
 * entity attribute state into database column representation
 * and back again.
 * Note that the X and Y types may be the same Java type.
 *
 * @param &lt;X&gt;  the type of the entity attribute
 * @param &lt;Y&gt;  the type of the database column
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AttributeConverter</span>&lt;X,Y&gt; {

    <span class="comment">/**
     * Converts the value stored in the entity attribute into the
     * data representation to be stored in the database.
     *
     * @param attribute  the entity attribute value to be converted
     * @return  the converted data to be stored in the database
     *          column
     */</span>
    <span class="directive">public</span> Y convertToDatabaseColumn (X attribute);

    <span class="comment">/**
     * Converts the data stored in the database column into the
     * value to be stored in the entity attribute.
     * Note that it is the responsibility of the converter writer to
     * specify the correct &lt;code&gt;dbData&lt;/code&gt; type for the corresponding
     * column for use by the JDBC driver: i.e., persistence providers are
     * not expected to do such type conversion.
     *
     * @param dbData  the data from the database column to be
     *                converted
     * @return  the converted value to be stored in the entity
     *          attribute
     */</span>
    <span class="directive">public</span> X convertToEntityAttribute (Y dbData);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attribute converter classes in Jakarta EE
environments support dependency injection through the Contexts and
Dependency Injection API (CDI) <a href="#a19500">[7]</a> when CDI is
enabled<sup class="footnote">[<a id="_footnoteref_49" class="footnote" href="#_footnotedef_49" title="View footnote.">49</a>]</sup></a>.]. An attribute converter class that makes
use of CDI injection may also define lifecycle callback methods
annotated with the <em>PostConstruct</em> and <em>PreDestroy</em> annotations. These
methods will be invoked after injection has taken place and before the
attribute converter instance is destroyed respectively.</p>
</div>
<div class="paragraph">
<p>The persistence provider is responsible for
using the CDI SPI to create instances of the attribute converter class;
to perform injection upon such instances; to invoke their
<em>PostConstruct</em> and <em>PreDestroy</em> methods, if any; and to dispose of the
attribute converter instances.</p>
</div>
<div class="paragraph">
<p>The persistence provider is only required to
support CDI injection into attribute converters in Jakarta EE container
environments<sup class="footnote">[<a id="_footnoteref_50" class="footnote" href="#_footnotedef_50" title="View footnote.">50</a>]</sup>. If CDI is not enabled, the
persistence provider must not invoke attribute converters that depend
upon CDI injection.</p>
</div>
<div class="paragraph">
<p>An attribute converter is a noncontextual
object. In supporting injection into attribute converters, the
persistence provider must behave as if it carries out the following
steps involving the use of the CDI SPI. (See
<a href="#a19500">[7]</a>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain a <em>BeanManager</em> instance. (See <a href="#a12802">Section 9.1</a>.)</p>
</li>
<li>
<p>Create an <em>AnnotatedType</em> instance for the attribute converter class.</p>
</li>
<li>
<p>Create an <em>InjectionTarget</em> instance for the annotated type.</p>
</li>
<li>
<p>Create a <em>CreationalContext</em>.</p>
</li>
<li>
<p>Instantiate the listener by calling the <em>InjectionTarget</em> <em>produce</em> method.</p>
</li>
<li>
<p>Inject the listener instance by calling the <em>InjectionTarget</em> <em>inject</em> method on the instance.</p>
</li>
<li>
<p>Invoke the <em>PostConstruct</em> callback, if any,
by calling the <em>InjectionTarget</em> <em>postConstruct</em> method on the instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the listener instance is to be
destroyed, the persistence provider must behave as if it carries out the
following steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Call the <em>InjectionTarget</em> <em>preDestroy</em> method on the instance.</p>
</li>
<li>
<p>Call the <em>InjectionTarget</em> <em>dispose</em> method on the instance.</p>
</li>
<li>
<p>Call the <em>CreationalContext</em> <em>release</em> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Persistence providers may optimize the steps
above, e.g. by avoiding calls to the actual CDI SPI and relying on
container-specific interfaces instead, as long as the outcome is the
same.</p>
</div>
<div class="paragraph">
<p>Attribute converters that do not make use of
CDI injection are stateless. The lifecycle of such attribute converters
is unspecified.</p>
</div>
<div class="paragraph">
<p>The conversion of all basic types is
supported except for the following: Id attributes (including the
attributes of embedded ids and derived identities), version attributes,
relationship attributes, and attributes explicitly annotated as
<em>Enumerated</em> or <em>Temporal</em> or designated as such in the XML descriptor.
Auto-apply converters will not be applied to such attributes, and
applications that apply converters to such attributes through use of the
<em>Convert</em> annotation will not be portable.</p>
</div>
<div class="paragraph">
<p>Type conversion may be specified at the level
of individual attributes by means of the <em>Convert</em> annotation. The
<em>Convert</em> annotation may also be used to override or disable an
auto-apply conversion. See <a href="#a14398">Section 11.1.10</a>.</p>
</div>
<div class="paragraph">
<p>The <em>Convert</em> annotation may be applied
directly to an attribute of an entity, mapped superclass, or embeddable
class to specify conversion of the attribute or to override the use of a
converter that has been specified as <em>autoApply=true</em>. When persistent
properties are used, the <em>Convert</em> annotation is applied to the getter
method.</p>
</div>
<div class="paragraph">
<p>The <em>Convert</em> annotation may be applied to an
entity that extends a mapped superclass to specify or override the
conversion mapping for an inherited basic or embedded attribute.</p>
</div>
<div class="paragraph">
<p>The persistence provider runtime is
responsible for invoking the specified conversion methods for the target
attribute type when loading the entity attribute from the database and
before storing the entity attribute state to the database. The
persistence provider must apply any conversion methods to instances of
attribute values in path expressions used within Jakarta Persistence query
language queries or criteria queries (such as in comparisons, bulk
updates, etc.) before sending them to the database for the query
execution. When such converted attributes are used in comparison
operations with literals or parameters, the value of the literal or
parameter to which they are compared must also be converted. If the
result of a Jakarta Persistence query language query or criteria query
includes one or more entity attributes for which conversion mappings
have been specified, the persistence provider must apply the specified
conversions to the corresponding values in the query result before
returning them to the application. The use of functions, including
aggregates, on converted attributes is undefined. If an exception is
thrown from a conversion method, the persistence provider must wrap the
exception in a PersistenceException and, if the persistence context is
joined to a transaction, mark the transaction for rollback.</p>
</div>
</div>
<div class="sect2">
<h3 id="a3061"><a class="anchor" href="#a3061"></a>3.9. Caching</h3>
<div class="paragraph">
<p>This specification supports the use of a
second-level cache by the persistence provider. The second-level cache,
if used, underlies the persistence context, and is largely transparent
to the application.</p>
</div>
<div class="paragraph">
<p>A second-level cache is typically used to
enhance performance. Use of a cache, however, may have consequences in
terms of the up-to-dateness of the data seen by the application,
resulting in “stale reads”. A stale read is defined as the reading of
entities or entity state that is older than the point at which the
persistence context was started.</p>
</div>
<div class="paragraph">
<p>This specification defines the following
portable configuration options that can be used by the application
developer to control caching behavior. Persistence providers may support
additional provider-specific options, but must observe all
specification-defined options.</p>
</div>
<div class="sect3">
<h4 id="a3065"><a class="anchor" href="#a3065"></a>3.9.1. The shared-cache-mode Element</h4>
<div class="paragraph">
<p>Whether the entities and entity-related state
of a persistence unit will be cached is determined by the value of the
<em>shared-cache-mode</em> element of the <em>persistence.xml</em> file.</p>
</div>
<div class="paragraph">
<p>The <em>shared-cache-mode</em> element has five
possible values: <em>ALL</em>, <em>NONE</em>, <em>ENABLE_SELECTIVE</em>,
<em>DISABLE_SELECTIVE</em>, <em>UNSPECIFIED</em>.</p>
</div>
<div class="paragraph">
<p>A value of <em>ALL</em> causes all entities and
entity-related state and data to be cached.</p>
</div>
<div class="paragraph">
<p>A value of <em>NONE</em> causes caching to be
disabled for the persistence unit. Persistence providers must not cache
if <em>NONE</em> is specified.</p>
</div>
<div class="paragraph">
<p>The values <em>ENABLE_SELECTIVE</em> and
<em>DISABLE_SELECTIVE</em> are used in conjunction with the <em>Cacheable</em>
annotation (or XML element). The <em>Cacheable</em> annotation specifies
whether an entity should be cached if such selective caching is enabled
by the <em>persistence.xml</em> <em>shared-cache-mode</em> element. The <em>Cacheable</em>
element is specified on the entity class. It applies to the given entity
and its subclasses unless subsequently overridden by a subclass.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Cacheable(false)</em> means that the entity and
its state must not be cached by the provider.</p>
</li>
<li>
<p>A value of <em>ENABLE_SELECTIVE</em> enables the
cache and causes entities for which <em>Cacheable(true)</em> (or its XML
equivalent) is specified to be cached. Entities for which
<em>Cacheable(true)</em> is not specified or for which <em>Cacheable(false)</em> is
specified must not be cached.</p>
</li>
<li>
<p>A value of <em>DISABLE_SELECTIVE</em> enables the
cache and causes all entities to be cached except those for which
<em>Cacheable(false)</em> is specified. Entities for which <em>Cacheable(false)</em>
is specified must not be cached.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If either the <em>shared-cache-mode</em> element is
not specified in the <em>persistence.xml</em> file or the value of the
<em>shared-cache-mode</em> element is <em>UNSPECIFIED</em>, and the
<em>jakarta.persistence.sharedCache.mode</em> property is not specified, the
behavior is not defined, and provider-specific defaults may apply. If
the <em>shared-cache-mode</em> element and the
<em>jakarta.persistence.sharedCache.mode</em> property are not specified, the
semantics of the <em>Cacheable</em> annotation (and XML equivalent) are
undefined.</p>
</div>
<div class="paragraph">
<p>The persistence provider is not required to
support use of a second-level cache. If the persistence provider does
not support use of a second-level cache or a second-level cache is not
installed, this element will be ignored and no caching will occur.</p>
</div>
<div class="paragraph">
<p>Further control over the second-level cache
is described in <a href="#a12124">Section 7.10</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="cache-retrieve-mode-and-cache-store-mode-properties"><a class="anchor" href="#cache-retrieve-mode-and-cache-store-mode-properties"></a>3.9.2. Cache Retrieve Mode and Cache Store Mode Properties</h4>
<div class="paragraph">
<p>Cache retrieve mode and cache store mode
properties may be specified at the level of the persistence context by
means of the EntityManager <em>setProperty</em> method. These properties may be
specified for the <em>EntityManager</em> <em>find</em> and <em>refresh</em> methods and the
<em>Query</em>, <em>TypedQuery</em>, <em>and</em> <em>StoredProcedureQuery</em> <em>setHint</em> methods.
Cache retrieve mode and/or cache store mode properties specified for the
<em>find</em>, <em>refresh</em>, and <em>Query</em>, <em>TypedQuery</em>, and
<em>StoredProcedureQuery setHint</em> methods override those specified for the
persistence context for the specified <em>find</em> and <em>refresh</em> invocations,
and for the execution of the specified queries respectively.</p>
</div>
<div class="paragraph">
<p>If caching is disabled by the <em>NONE</em> value of
the <em>shared-cache-mode</em> element, cache retrieve mode and cache store
mode properties must be ignored. Otherwise, if the <em>ENABLE_SELECTIVE</em>
value is specified, but <em>Cacheable(true)</em> is not specified for a
particular entity, they are ignored for that entity; if the
<em>DISABLE_SELECTIVE</em> value is specified, they are ignored for any
entities for which <em>Cacheable(false)</em> is specified.</p>
</div>
<div class="paragraph">
<p>Cache retrieve mode and cache store mode
properties must be observed when caching is enabled, regardless of
whether caching is enabled due to the specification of the
<em>shared-cache-mode</em> element or enabled due to provider-specific options.
Applications that make use of cache retrieve mode or cache store mode
properties but which do not specify the <em>shared-cache-mode</em> element will
not be portable.</p>
</div>
<div class="paragraph">
<p>The cache retrieve mode and cache store mode
properties are <em>jakarta.persistence.cache.retrieveMode</em> and
<em>jakarta.persistence.cache.storeMode</em> respectively. These properties have
the semantics defined below.</p>
</div>
<div class="paragraph">
<p>The <em>retrieveMode</em> property specifies the
behavior when data is retrieved by the <em>find</em> methods and by the
execution of queries. The <em>retrieveMode</em> property is ignored for the
<em>refresh</em> method, which always causes data to be retrieved from the
database, not the cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Used as the value of the
 * &lt;code&gt;jakarta.persistence.cache.retrieveMode&lt;/code&gt; property to
 * specify the behavior when data is retrieved by the
 * &lt;code&gt;find&lt;/code&gt; methods and by queries.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> CacheRetrieveMode {

    <span class="comment">/**
     * Read entity data from the cache: this is
     * the default behavior.
     */</span>
    USE,

    <span class="comment">/**
     * Bypass the cache: get data directly from
     * the database.
     */</span>
    BYPASS
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>storeMode</em> property specifies the
behavior when data is read from the database and when data is committed
into the database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Used as the value of the
 * &lt;code&gt;jakarta.persistence.cache.storeMode&lt;/code&gt; property to specify
 * the behavior when data is read from the database and when data is
 * committed into the database.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> CacheStoreMode {

    <span class="comment">/**
     * Insert entity data into cache when read from database
     * and insert/update entity data when committed into database:
     * this is the default behavior. Does not force refresh
     * of already cached items when reading from database.
     */</span>
    USE,

    <span class="comment">/**
     * Don't insert into cache.
     */</span>
    BYPASS,

    <span class="comment">/**
     * Insert/update entity data into cache when read
     * from database and when committed into database.
     * Forces refresh of cache for items read from database.
     */</span>
    REFRESH
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a3125"><a class="anchor" href="#a3125"></a>3.10. Query APIs</h3>
<div class="paragraph">
<p>The <em>Query</em> and <em>TypedQuery</em> APIs are used
for the execution of both static queries and dynamic queries. These APIs
also support parameter binding and pagination control. The
<em>StoredProcedureQuery</em> API is used for the execution of queries that
invoke stored procedures defined in the database.</p>
</div>
<div class="sect3">
<h4 id="a3127"><a class="anchor" href="#a3127"></a>3.10.1. Query Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.Calendar</span>;
<span class="keyword">import</span> <span class="include">java.util.Date</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.stream.Stream</span>;

<span class="comment">/**
 * Interface used to control query execution.
 *
 * @see TypedQuery
 * @see StoredProcedureQuery
 * @see Parameter
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Query</span> {

    <span class="comment">/**
     * Execute a SELECT query and return the query results
     * as an untyped List.
     * @return a list of the results
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         &lt;code&gt;NONE&lt;/code&gt; has been set and there is no transaction
     *         or the persistence context has not been joined to the transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">List</span> getResultList();

    <span class="comment">/**
     * Execute a SELECT query and return the query results
     * as an untyped &lt;code&gt;java.util.stream.Stream&lt;/code&gt;.
     * By default this method delegates to &lt;code&gt;getResultList().stream()&lt;/code&gt;,
     * however persistence provider may choose to override this method
     * to provide additional capabilities.
     *
     * @return a stream of the results
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         &lt;code&gt;NONE&lt;/code&gt; has been set and there is no transaction
     *         or the persistence context has not been joined to the transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     * @see Stream
     * @see #getResultList()
     * @since 2.2
     */</span>
    <span class="keyword">default</span> Stream getResultStream() {
        <span class="keyword">return</span> getResultList().stream();
    }

    <span class="comment">/**
     * Execute a SELECT query that returns a single untyped result.
     * @return the result
     * @throws NoResultException if there is no result
     * @throws NonUniqueResultException if more than one result
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         &lt;code&gt;NONE&lt;/code&gt; has been set and there is no transaction
     *         or the persistence context has not been joined to the transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">Object</span> getSingleResult();

    <span class="comment">/**
     * Execute an update or delete statement.
     * @return the number of entities updated or deleted
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language SELECT statement or for
     *         a criteria query
     * @throws TransactionRequiredException if there is
     *         no transaction or the persistence context has not
     *         been joined to the transaction
     * @throws QueryTimeoutException if the statement execution
     *         exceeds the query timeout value set and only
     *         the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">int</span> executeUpdate();

    <span class="comment">/**
     * Set the maximum number of results to retrieve.
     * @param maxResult  maximum number of results to retrieve
     * @return the same query instance
     * @throws IllegalArgumentException if the argument is negative
     */</span>
    <span class="predefined-type">Query</span> setMaxResults(<span class="type">int</span> maxResult);

    <span class="comment">/**
     * The maximum number of results the query object was set to
     * retrieve. Returns &lt;code&gt;Integer.MAX_VALUE&lt;/code&gt; if &lt;code&gt;setMaxResults&lt;/code&gt; was not
     * applied to the query object.
     * @return maximum number of results
     * @since 2.0
     */</span>
    <span class="type">int</span> getMaxResults();

    <span class="comment">/**
     * Set the position of the first result to retrieve.
     * @param startPosition position of the first result,
     * numbered from 0
     * @return the same query instance
     * @throws IllegalArgumentException if the argument is negative
     */</span>
    <span class="predefined-type">Query</span> setFirstResult(<span class="type">int</span> startPosition);

    <span class="comment">/**
     * The position of the first result the query object was set to
     * retrieve. Returns 0 if &lt;code&gt;setFirstResult&lt;/code&gt; was not applied to the
     * query object.
     * @return position of the first result
     * @since 2.0
     */</span>
    <span class="type">int</span> getFirstResult();

    <span class="comment">/**
     * Set a query property or hint. The hints elements may be used
     * to specify query properties and hints. Properties defined by
     * this specification must be observed by the provider.
     * Vendor-specific hints that are not recognized by a provider
     * must be silently ignored. Portable applications should not
     * rely on the standard timeout hint. Depending on the database
     * in use and the locking mechanisms used by the provider,
     * this hint may or may not be observed.
     * @param hintName  name of the property or hint
     * @param value  value for the property or hint
     * @return the same query instance
     * @throws IllegalArgumentException if the second argument is not
     *         valid for the implementation
     */</span>
    <span class="predefined-type">Query</span> setHint(<span class="predefined-type">String</span> hintName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Get the properties and hints and associated values that are
     * in effect for the query instance.
     * @return query properties and hints
     * @since 2.0
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getHints();

    <span class="comment">/**
     * Bind the value of a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param  parameter object
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter
     *         does not correspond to a parameter of the
     *         query
     * @since 2.0
     */</span>
    &lt;T&gt; <span class="predefined-type">Query</span> setParameter(Parameter&lt;T&gt; param, T value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     * @since 2.0
     */</span>
    <span class="predefined-type">Query</span> setParameter(Parameter&lt;<span class="predefined-type">Calendar</span>&gt; param, <span class="predefined-type">Calendar</span> value,
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     * @since 2.0
     */</span>
    <span class="predefined-type">Query</span> setParameter(Parameter&lt;<span class="predefined-type">Date</span>&gt; param, <span class="predefined-type">Date</span> value,
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if
     *         the argument is of incorrect type
     */</span>
    <span class="predefined-type">Query</span> setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if
     *         the value argument is of incorrect type
     */</span>
    <span class="predefined-type">Query</span> setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Calendar</span> value,
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if
     *         the value argument is of incorrect type
     */</span>
    <span class="predefined-type">Query</span> setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Date</span> value,
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the
     *         query or if the argument is of incorrect type
     */</span>
    <span class="predefined-type">Query</span> setParameter(<span class="type">int</span> position, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a positional
     * parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query or
     *         if the value argument is of incorrect type
     */</span>
    <span class="predefined-type">Query</span> setParameter(<span class="type">int</span> position, <span class="predefined-type">Calendar</span> value,
                       TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query or
     *         if the value argument is of incorrect type
     */</span>
    <span class="predefined-type">Query</span> setParameter(<span class="type">int</span> position, <span class="predefined-type">Date</span> value,
                       TemporalType temporalType);

    <span class="comment">/**
     * Get the parameter objects corresponding to the declared
     * parameters of the query.
     * Returns empty set if the query has no parameters.
     * This method is not required to be supported for native
     * queries.
     * @return set of the parameter objects
     * @throws IllegalStateException if invoked on a native
     *         query when the implementation does not support
     *         this use
     * @since 2.0
     */</span>
    <span class="predefined-type">Set</span>&lt;Parameter&lt;?&gt;&gt; getParameters();

    <span class="comment">/**
     * Get the parameter object corresponding to the declared
     * parameter of the given name.
     * This method is not required to be supported for native
     * queries.
     * @param name  parameter name
     * @return parameter object
     * @throws IllegalArgumentException if the parameter of the
     *         specified name does not exist
     * @throws IllegalStateException if invoked on a native
     *         query when the implementation does not support
     *         this use
     * @since 2.0
     */</span>
    Parameter&lt;?&gt; getParameter(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Get the parameter object corresponding to the declared
     * parameter of the given name and type.
     * This method is required to be supported for criteria queries
     * only.
     * @param name  parameter name
     * @param type  type
     * @return parameter object
     * @throws IllegalArgumentException if the parameter of the
     *         specified name does not exist or is not assignable
     *         to the type
     * @throws IllegalStateException if invoked on a native
     *         query or Jakarta Persistence query language query when
     *         the implementation does not support this use
     * @since 2.0
     */</span>
    &lt;T&gt; Parameter&lt;T&gt; getParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * Get the parameter object corresponding to the declared
     * positional parameter with the given position.
     * This method is not required to be supported for native
     * queries.
     * @param position  position
     * @return parameter object
     * @throws IllegalArgumentException if the parameter with the
     *         specified position does not exist
     * @throws IllegalStateException if invoked on a native
     *         query when the implementation does not support
     *         this use
     * @since 2.0
     */</span>
    Parameter&lt;?&gt; getParameter(<span class="type">int</span> position);

    <span class="comment">/**
     * Get the parameter object corresponding to the declared
     * positional parameter with the given position and type.
     * This method is not required to be supported by the provider.
     * @param position  position
     * @param type  type
     * @return parameter object
     * @throws IllegalArgumentException if the parameter with the
     *         specified position does not exist or is not assignable
     *         to the type
     * @throws IllegalStateException if invoked on a native
     *         query or Jakarta Persistence query language query when
     *         the implementation does not support this use
     * @since 2.0
     */</span>
    &lt;T&gt; Parameter&lt;T&gt; getParameter(<span class="type">int</span> position, <span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * Return a boolean indicating whether a value has been bound
     * to the parameter.
     * @param param parameter object
     * @return boolean indicating whether parameter has been bound
     * @since 2.0
     */</span>
    <span class="type">boolean</span> isBound(Parameter&lt;?&gt; param);

    <span class="comment">/**
     * Return the input value bound to the parameter.
     * (Note that OUT parameters are unbound.)
     * @param param parameter object
     * @return parameter value
     * @throws IllegalArgumentException if the parameter is not
     *         a parameter of the query
     * @throws IllegalStateException if the parameter has not been
     *         been bound
     * @since 2.0
     */</span>
    &lt;T&gt; T getParameterValue(Parameter&lt;T&gt; param);

    <span class="comment">/**
     * Return the input value bound to the named parameter.
     * (Note that OUT parameters are unbound.)
     * @param name  parameter name
     * @return parameter value
     * @throws IllegalStateException if the parameter has not been
     *         been bound
     * @throws IllegalArgumentException if the parameter of the
     *         specified name does not exist
     * @since 2.0
     */</span>
    <span class="predefined-type">Object</span> getParameterValue(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Return the input value bound to the positional parameter.
     * (Note that OUT parameters are unbound.)
     * @param position  position
     * @return parameter value
     * @throws IllegalStateException if the parameter has not been
     *         been bound
     * @throws IllegalArgumentException if the parameter with the
     *         specified position does not exist
     * @since 2.0
     */</span>
    <span class="predefined-type">Object</span> getParameterValue(<span class="type">int</span> position);

    <span class="comment">/**
     * Set the flush mode type to be used for the query execution.
     * The flush mode type applies to the query regardless of the
     * flush mode type in use for the entity manager.
     * @param flushMode  flush mode
     * @return the same query instance
     */</span>
    <span class="predefined-type">Query</span> setFlushMode(FlushModeType flushMode);

    <span class="comment">/**
     * Get the flush mode in effect for the query execution.
     * If a flush mode has not been set for the query object,
     * returns the flush mode in effect for the entity manager.
     * @return flush mode
     * @since 2.0
     */</span>
    FlushModeType getFlushMode();

    <span class="comment">/**
     * Set the lock mode type to be used for the query execution.
     * @param lockMode  lock mode
     * @return the same query instance
     * @throws IllegalStateException if the query is found not to be
     *         a Jakarta Persistence query language SELECT query
     *         or a CriteriaQuery query
     * @since 2.0
     */</span>
    <span class="predefined-type">Query</span> setLockMode(LockModeType lockMode);

    <span class="comment">/**
     * Get the current lock mode for the query.  Returns null if a lock
     * mode has not been set on the query object.
     * @return lock mode
     * @throws IllegalStateException if the query is found not to be
     *         a Jakarta Persistence query language SELECT query or
     *         a Criteria API query
     * @since 2.0
     */</span>
    LockModeType getLockMode();

    <span class="comment">/**
     * Return an object of the specified type to allow access to
     * the provider-specific API.  If the provider's query
     * implementation does not support the specified class, the
     * &lt;code&gt;PersistenceException&lt;/code&gt; is thrown.
     * @param cls  the class of the object to be returned.  This is
     *             normally either the underlying query
     *             implementation class or an interface that it
     *             implements.
     * @return an instance of the specified class
     * @throws PersistenceException if the provider does not support
     *         the call
     * @since 2.0
     */</span>
    &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; cls);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="typedquery-interface"><a class="anchor" href="#typedquery-interface"></a>3.10.2. TypedQuery Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Date</span>;
<span class="keyword">import</span> <span class="include">java.util.Calendar</span>;
<span class="keyword">import</span> <span class="include">java.util.stream.Stream</span>;

<span class="comment">/**
 * Interface used to control the execution of typed queries.
 * @param &lt;X&gt; query result type
 *
 * @see Query
 * @see Parameter
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TypedQuery</span>&lt;X&gt; <span class="directive">extends</span> <span class="predefined-type">Query</span> {

    <span class="comment">/**
     * Execute a SELECT query and return the query results
     * as a typed List.
     * @return a list of the results
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         &lt;code&gt;NONE&lt;/code&gt; has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">List</span>&lt;X&gt; getResultList();

    <span class="comment">/**
     * Execute a SELECT query and return the query results
     * as a typed &lt;code&gt;java.util.stream.Stream&lt;/code&gt;.
     * By default this method delegates to &lt;code&gt;getResultList().stream()&lt;/code&gt;,
     * however persistence provider may choose to override this method
     * to provide additional capabilities.
     *
     * @return a stream of the results
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         &lt;code&gt;NONE&lt;/code&gt; has been set and there is no transaction
     *         or the persistence context has not been joined to the transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     * @see Stream
     * @see #getResultList()
     * @since 2.2
     */</span>
    <span class="keyword">default</span> Stream&lt;X&gt; getResultStream() {
        <span class="keyword">return</span> getResultList().stream();
    }

    <span class="comment">/**
     * Execute a SELECT query that returns a single result.
     * @return the result
     * @throws NoResultException if there is no result
     * @throws NonUniqueResultException if more than one result
     * @throws IllegalStateException if called for a Jakarta
     *         Persistence query language UPDATE or DELETE statement
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws TransactionRequiredException if a lock mode other than
     *         &lt;code&gt;NONE&lt;/code&gt; has been set and there is no transaction
     *         or the persistence context has not been joined to the
     *         transaction
     * @throws PessimisticLockException if pessimistic locking
     *         fails and the transaction is rolled back
     * @throws LockTimeoutException if pessimistic locking
     *         fails and only the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    X getSingleResult();

    <span class="comment">/**
     * Set the maximum number of results to retrieve.
     * @param maxResult  maximum number of results to retrieve
     * @return the same query instance
     * @throws IllegalArgumentException if the argument is negative
     */</span>
    TypedQuery&lt;X&gt; setMaxResults(<span class="type">int</span> maxResult);

    <span class="comment">/**
     * Set the position of the first result to retrieve.
     * @param startPosition position of the first result,
     *        numbered from 0
     * @return the same query instance
     * @throws IllegalArgumentException if the argument is negative
     */</span>
    TypedQuery&lt;X&gt; setFirstResult(<span class="type">int</span> startPosition);

    <span class="comment">/**
     * Set a query property or hint. The hints elements may be used
     * to specify query properties and hints. Properties defined by
     * this specification must be observed by the provider.
     * Vendor-specific hints that are not recognized by a provider
     * must be silently ignored. Portable applications should not
     * rely on the standard timeout hint. Depending on the database
     * in use and the locking mechanisms used by the provider,
     * this hint may or may not be observed.
     * @param hintName  name of property or hint
     * @param value  value for the property or hint
     * @return the same query instance
     * @throws IllegalArgumentException if the second argument is not
     *         valid for the implementation
     */</span>
    TypedQuery&lt;X&gt; setHint(<span class="predefined-type">String</span> hintName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind the value of a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param  parameter object
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter
     *         does not correspond to a parameter of the
     *         query
     */</span>
     &lt;T&gt; TypedQuery&lt;X&gt; setParameter(Parameter&lt;T&gt; param, T value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param  parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     */</span>
    TypedQuery&lt;X&gt; setParameter(Parameter&lt;<span class="predefined-type">Calendar</span>&gt; param,
                               <span class="predefined-type">Calendar</span> value,
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param  parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     */</span>
    TypedQuery&lt;X&gt; setParameter(Parameter&lt;<span class="predefined-type">Date</span>&gt; param, <span class="predefined-type">Date</span> value,
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if
     *         the argument is of incorrect type
     */</span>
    TypedQuery&lt;X&gt; setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if
     *         the value argument is of incorrect type
     */</span>
    TypedQuery&lt;X&gt; setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Calendar</span> value,
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a named parameter.
     * @param name   parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if
     *         the value argument is of incorrect type
     */</span>
    TypedQuery&lt;X&gt; setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Date</span> value,
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the
     *         query or if the argument is of incorrect type
     */</span>
    TypedQuery&lt;X&gt; setParameter(<span class="type">int</span> position, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a positional
     * parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query
     *         or if the value argument is of incorrect type
     */</span>
    TypedQuery&lt;X&gt; setParameter(<span class="type">int</span> position, <span class="predefined-type">Calendar</span> value,
                               TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query
     *         or if the value argument is of incorrect type
     */</span>
    TypedQuery&lt;X&gt; setParameter(<span class="type">int</span> position, <span class="predefined-type">Date</span> value,
                               TemporalType temporalType);

     <span class="comment">/**
      * Set the flush mode type to be used for the query execution.
      * The flush mode type applies to the query regardless of the
      * flush mode type in use for the entity manager.
      * @param flushMode  flush mode
      * @return the same query instance
      */</span>
     TypedQuery&lt;X&gt; setFlushMode(FlushModeType flushMode);

     <span class="comment">/**
      * Set the lock mode type to be used for the query execution.
      * @param lockMode  lock mode
      * @return the same query instance
      * @throws IllegalStateException if the query is found not to
      *         be a Jakarta Persistence query language SELECT query
      *         or a CriteriaQuery query
      */</span>
     TypedQuery&lt;X&gt; setLockMode(LockModeType lockMode);

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a3868"><a class="anchor" href="#a3868"></a>3.10.3. Tuple Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * Interface for extracting the elements of a query result tuple.
 *
 * @see TupleElement
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Tuple</span> {

    <span class="comment">/**
     * Get the value of the specified tuple element.
     * @param tupleElement  tuple element
     * @return value of tuple element
     * @throws IllegalArgumentException if tuple element
     *         does not correspond to an element in the
     *         query result tuple
     */</span>
    &lt;X&gt; X get(TupleElement&lt;X&gt; tupleElement);

    <span class="comment">/**
     * Get the value of the tuple element to which the
     * specified alias has been assigned.
     * @param alias  alias assigned to tuple element
     * @param type of the tuple element
     * @return value of the tuple element
     * @throws IllegalArgumentException if alias
     *         does not correspond to an element in the
     *         query result tuple or element cannot be
     *         assigned to the specified type
     */</span>
    &lt;X&gt; X get(<span class="predefined-type">String</span> alias, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Get the value of the tuple element to which the
     * specified alias has been assigned.
     * @param alias  alias assigned to tuple element
     * @return value of the tuple element
     * @throws IllegalArgumentException if alias
     *         does not correspond to an element in the
     *         query result tuple
     */</span>
    <span class="predefined-type">Object</span> get(<span class="predefined-type">String</span> alias);

    <span class="comment">/**
     * Get the value of the element at the specified
     * position in the result tuple. The first position is 0.
     * @param i  position in result tuple
     * @param type  type of the tuple element
     * @return value of the tuple element
     * @throws IllegalArgumentException if i exceeds
     *         length of result tuple  or element cannot be
     *         assigned to the specified type
     */</span>
    &lt;X&gt; X get(<span class="type">int</span> i, <span class="predefined-type">Class</span>&lt;X&gt; type);

    <span class="comment">/**
     * Get the value of the element at the specified
     * position in the result tuple. The first position is 0.
     * @param i  position in result tuple
     * @return value of the tuple element
     * @throws IllegalArgumentException if i exceeds
     *         length of result tuple
     */</span>
    <span class="predefined-type">Object</span> get(<span class="type">int</span> i);

    <span class="comment">/**
     * Return the values of the result tuple elements as an array.
     * @return tuple element values
     */</span>
    <span class="predefined-type">Object</span><span class="type">[]</span> toArray();

    <span class="comment">/**
     * Return the tuple elements.
     * @return tuple elements
     */</span>
    <span class="predefined-type">List</span>&lt;TupleElement&lt;?&gt;&gt; getElements();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a3949"><a class="anchor" href="#a3949"></a>3.10.4. TupleElement Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * The &lt;code&gt;TupleElement&lt;/code&gt; interface defines an element that is returned in
 * a query result tuple.
 * @param &lt;X&gt; the type of the element
 *
 * @see Tuple
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TupleElement</span>&lt;X&gt; {

    <span class="comment">/**
     * Return the Java type of the tuple element.
     * @return the Java type of the tuple element
     */</span>
    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt; getJavaType();

    <span class="comment">/**
     * Return the alias assigned to the tuple element or null,
     * if no alias has been assigned.
     * @return alias
     */</span>
    <span class="predefined-type">String</span> getAlias();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="parameter-interface"><a class="anchor" href="#parameter-interface"></a>3.10.5. Parameter Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Type for query parameter objects.
 * @param &lt;T&gt; the type of the parameter
 *
 * @see Query
 * @see TypedQuery
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Parameter</span>&lt;T&gt; {

    <span class="comment">/**
     * Return the parameter name, or null if the parameter is
     * not a named parameter or no name has been assigned.
     * @return parameter name
     */</span>
    <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     * Return the parameter position, or null if the parameter
     * is not a positional parameter.
     * @return position of parameter
     */</span>
    <span class="predefined-type">Integer</span> getPosition();

    <span class="comment">/**
     * Return the Java type of the parameter. Values bound to the
     * parameter must be assignable to this type.
     * This method is required to be supported for criteria queries
     * only.   Applications that use this method for Jakarta
     * Persistence query language queries and native queries will
     * not be portable.
     * @return the Java type of the parameter
     * @throws IllegalStateException if invoked on a parameter
     *         obtained from a query language
     *         query or native query when the implementation does
     *         not support this use
     */</span>
     <span class="predefined-type">Class</span>&lt;T&gt; getParameterType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="storedprocedurequery-interface"><a class="anchor" href="#storedprocedurequery-interface"></a>3.10.6. StoredProcedureQuery Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.Calendar</span>;
<span class="keyword">import</span> <span class="include">java.util.Date</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * Interface used to control stored procedure query execution.
 *
 * &lt;p&gt;
 * Stored procedure query execution may be controlled in accordance with
 * the following:
 * &lt;ul&gt;
 * &lt;li&gt;The &lt;code&gt;setParameter&lt;/code&gt; methods are used to set the values of
 * all required &lt;code&gt;IN&lt;/code&gt; and &lt;code&gt;INOUT&lt;/code&gt; parameters.
 * It is not required to set the values of stored procedure parameters
 * for which default values have been defined by the stored procedure.&lt;/li&gt;
 * &lt;li&gt;
 * When &lt;code&gt;getResultList&lt;/code&gt; and &lt;code&gt;getSingleResult&lt;/code&gt; are
 * called on a &lt;code&gt;StoredProcedureQuery&lt;/code&gt; object, the provider
 * will call &lt;code&gt;execute&lt;/code&gt; on an unexecuted stored procedure
 * query before processing &lt;code&gt;getResultList&lt;/code&gt; or
 * &lt;code&gt;getSingleResult&lt;/code&gt;.&lt;/li&gt;
 * &lt;li&gt;
 * When &lt;code&gt;executeUpdate&lt;/code&gt; is called on a
 * &lt;code&gt;StoredProcedureQuery&lt;/code&gt; object, the provider will call
 * &lt;code&gt;execute&lt;/code&gt; on an unexecuted stored procedure query
 *  followed by &lt;code&gt;getUpdateCount&lt;/code&gt;.  The results of
 * &lt;code&gt;executeUpdate&lt;/code&gt; will be those of &lt;code&gt;getUpdateCount&lt;/code&gt;.&lt;/li&gt;
 * &lt;li&gt;
 * The &lt;code&gt;execute&lt;/code&gt; method supports both the simple case where
 * scalar results are passed back only via &lt;code&gt;INOUT&lt;/code&gt; and
 * &lt;code&gt;OUT&lt;/code&gt; parameters as well as the most general case
 * (multiple result sets and/or update counts, possibly also in
 * combination with output parameter values).&lt;/li&gt;
 * &lt;li&gt;
 * The &lt;code&gt;execute&lt;/code&gt; method returns true if the first result is a
 * result set, and false if it is an update count or there are no results
 * other than through &lt;code&gt;INOUT&lt;/code&gt; and &lt;code&gt;OUT&lt;/code&gt; parameters,
 * if any.&lt;/li&gt;
 * &lt;li&gt;
 * If the &lt;code&gt;execute&lt;/code&gt; method returns true, the pending result set
 * can be obtained by calling &lt;code&gt;getResultList&lt;/code&gt; or
 * &lt;code&gt;getSingleResult&lt;/code&gt;.&lt;/li&gt;
 * &lt;li&gt;
 * The &lt;code&gt;hasMoreResults&lt;/code&gt; method can then be used to test
 * for further results.&lt;/li&gt;
 * &lt;li&gt;
 * If &lt;code&gt;execute&lt;/code&gt; or &lt;code&gt;hasMoreResults&lt;/code&gt; returns false,
 * the &lt;code&gt;getUpdateCount&lt;/code&gt; method can be called to obtain the
 * pending result if it is an update count.  The &lt;code&gt;getUpdateCount&lt;/code&gt;
 * method will return either the update count (zero or greater) or -1
 * if there is no update count (i.e., either the next result is a result set
 * or there is no next update count).&lt;/li&gt;
 * &lt;li&gt;
 * For portability, results that correspond to JDBC result sets and
 * update counts need to be processed before the values of any
 * &lt;code&gt;INOUT&lt;/code&gt; or &lt;code&gt;OUT&lt;/code&gt; parameters are extracted.&lt;/li&gt;
 * &lt;li&gt;
 * After results returned through &lt;code&gt;getResultList&lt;/code&gt; and
 * &lt;code&gt;getUpdateCount&lt;/code&gt; have been exhausted, results returned through
 * &lt;code&gt;INOUT&lt;/code&gt; and &lt;code&gt;OUT&lt;/code&gt; parameters can be retrieved.&lt;/li&gt;
 * &lt;li&gt;
 * The &lt;code&gt;getOutputParameterValue&lt;/code&gt; methods are used to retrieve
 * the values passed back from the procedure through &lt;code&gt;INOUT&lt;/code&gt;
 * and &lt;code&gt;OUT&lt;/code&gt; parameters.&lt;/li&gt;
 * &lt;li&gt;
 * When using &lt;code&gt;REF_CURSOR&lt;/code&gt; parameters for result sets the
 * update counts should be exhausted before calling &lt;code&gt;getResultList&lt;/code&gt;
 * to retrieve the result set.  Alternatively, the &lt;code&gt;REF_CURSOR&lt;/code&gt;
 * result set can be retrieved through &lt;code&gt;getOutputParameterValue&lt;/code&gt;.
 * Result set mappings will be applied to results corresponding to
 * &lt;code&gt;REF_CURSOR&lt;/code&gt; parameters in the order the &lt;code&gt;REF_CURSOR&lt;/code&gt;
 * parameters were registered with the query.&lt;/li&gt;
 * &lt;li&gt;
 * In the simplest case, where results are returned only via
 * &lt;code&gt;INOUT&lt;/code&gt; and &lt;code&gt;OUT&lt;/code&gt; parameters, &lt;code&gt;execute&lt;/code&gt;
 * can be followed immediately by calls to
 * &lt;code&gt;getOutputParameterValue&lt;/code&gt;.&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * @see Query
 * @see Parameter
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">StoredProcedureQuery</span> <span class="directive">extends</span> <span class="predefined-type">Query</span> {

    <span class="comment">/**
     * Set a query property or hint. The hints elements may be used
     * to specify query properties and hints. Properties defined by
     * this specification must be observed by the provider.
     * Vendor-specific hints that are not recognized by a provider
     * must be silently ignored. Portable applications should not
     * rely on the standard timeout hint. Depending on the database
     * in use, this hint may or may not be observed.
     * @param hintName  name of the property or hint
     * @param value  value for the property or hint
     * @return the same query instance
     * @throws IllegalArgumentException if the second argument is not
     *         valid for the implementation
     */</span>
    StoredProcedureQuery setHint(<span class="predefined-type">String</span> hintName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind the value of a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param  parameter object
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     */</span>
    &lt;T&gt; StoredProcedureQuery setParameter(Parameter&lt;T&gt; param,
                                          T value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     */</span>
    StoredProcedureQuery setParameter(Parameter&lt;<span class="predefined-type">Calendar</span>&gt; param,
                                      <span class="predefined-type">Calendar</span> value,
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a &lt;code&gt;Parameter&lt;/code&gt; object.
     * @param param parameter object
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter does not
     *         correspond to a parameter of the query
     */</span>
    StoredProcedureQuery setParameter(Parameter&lt;<span class="predefined-type">Date</span>&gt; param,
                                      <span class="predefined-type">Date</span> value,
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if the
     *         argument is of incorrect type
     */</span>
    StoredProcedureQuery setParameter(<span class="predefined-type">String</span> name, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if the
     *         value argument is of incorrect type
     */</span>
    StoredProcedureQuery setParameter(<span class="predefined-type">String</span> name,
                                      <span class="predefined-type">Calendar</span> value,
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a named parameter.
     * @param name  parameter name
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if the parameter name does
     *         not correspond to a parameter of the query or if the
     *         value argument is of incorrect type
     */</span>
    StoredProcedureQuery setParameter(<span class="predefined-type">String</span> name,
                                      <span class="predefined-type">Date</span> value,
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an argument value to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query
     *         or if the argument is of incorrect type
     */</span>
    StoredProcedureQuery setParameter(<span class="type">int</span> position, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Calendar&lt;/code&gt; to a positional
     * parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query or
     *         if the value argument is of incorrect type
     */</span>
    StoredProcedureQuery setParameter(<span class="type">int</span> position,
                                      <span class="predefined-type">Calendar</span> value,
                                      TemporalType temporalType);

    <span class="comment">/**
     * Bind an instance of &lt;code&gt;java.util.Date&lt;/code&gt; to a positional parameter.
     * @param position  position
     * @param value  parameter value
     * @param temporalType  temporal type
     * @return the same query instance
     * @throws IllegalArgumentException if position does not
     *         correspond to a positional parameter of the query or
     *         if the value argument is of incorrect type
     */</span>
    StoredProcedureQuery setParameter(<span class="type">int</span> position,
                                      <span class="predefined-type">Date</span> value,
                                      TemporalType temporalType);

    <span class="comment">/**
     * Set the flush mode type to be used for the query execution.
     * The flush mode type applies to the query regardless of the
     * flush mode type in use for the entity manager.
     * @param flushMode  flush mode
     * @return the same query instance
     */</span>
    StoredProcedureQuery setFlushMode(FlushModeType flushMode);

    <span class="comment">/**
     * Register a positional parameter.
     * All parameters must be registered.
     * @param position  parameter position
     * @param type  type of the parameter
     * @param mode  parameter mode
     * @return the same query instance
     */</span>
    StoredProcedureQuery registerStoredProcedureParameter(
          <span class="type">int</span> position,
          <span class="predefined-type">Class</span> type,
          ParameterMode mode);

    <span class="comment">/**
     * Register a named parameter.
     * @param parameterName  name of the parameter as registered or
     *             specified in metadata
     * @param type  type of the parameter
     * @param mode  parameter mode
     * @return the same query instance
     */</span>
    StoredProcedureQuery registerStoredProcedureParameter(
          <span class="predefined-type">String</span> parameterName,
          <span class="predefined-type">Class</span> type,
          ParameterMode mode);

    <span class="comment">/**
     *  Retrieve a value passed back from the procedure
     *  through an INOUT or OUT parameter.
     *  For portability, all results corresponding to result sets
     *  and update counts must be retrieved before the values of
     *  output parameters.
     *  @param position  parameter position
     *  @return the result that is passed back through the parameter
     *  @throws IllegalArgumentException if the position does
     *          not correspond to a parameter of the query or is
     *          not an INOUT or OUT parameter
     */</span>
    <span class="predefined-type">Object</span> getOutputParameterValue(<span class="type">int</span> position);

    <span class="comment">/**
     *  Retrieve a value passed back from the procedure
     *  through an INOUT or OUT parameter.
     *  For portability, all results corresponding to result sets
     *  and update counts must be retrieved before the values of
     *  output parameters.
     *  @param parameterName  name of the parameter as registered or
     *              specified in metadata
     *  @return the result that is passed back through the parameter
     *  @throws IllegalArgumentException if the parameter name does
     *          not correspond to a parameter of the query or is
     *          not an INOUT or OUT parameter
     */</span>
    <span class="predefined-type">Object</span> getOutputParameterValue(<span class="predefined-type">String</span> parameterName);

    <span class="comment">/**
     * Return true if the first result corresponds to a result set,
     * and false if it is an update count or if there are no results
     * other than through INOUT and OUT parameters, if any.
     * @return  true if first result corresponds to result set
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">boolean</span> execute();

    <span class="comment">/**
     * Return the update count of -1 if there is no pending result or
     * if the first result is not an update count.  The provider will
     * call &lt;code&gt;execute&lt;/code&gt; on the query if needed.
     * @return the update count or -1 if there is no pending result
     * or if the next result is not an update count.
     * @throws TransactionRequiredException if there is
     *         no transaction or the persistence context has not
     *         been joined to the transaction
     * @throws QueryTimeoutException if the statement execution
     *         exceeds the query timeout value set and only
     *         the statement is rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">int</span> executeUpdate();

    <span class="comment">/**
     * Retrieve the list of results from the next result set.
     * The provider will call &lt;code&gt;execute&lt;/code&gt; on the query
     * if needed.
     * A &lt;code&gt;REF_CURSOR&lt;/code&gt; result set, if any, will be retrieved
     * in the order the &lt;code&gt;REF_CURSOR&lt;/code&gt; parameter was
     * registered with the query.
     * @return a list of the results or null is the next item is not
     * a result set
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">List</span> getResultList();

    <span class="comment">/**
     * Retrieve a single result from the next result set.
     * The provider will call &lt;code&gt;execute&lt;/code&gt; on the query
     * if needed.
     * A &lt;code&gt;REF_CURSOR&lt;/code&gt; result set, if any, will be retrieved
     * in the order the &lt;code&gt;REF_CURSOR&lt;/code&gt; parameter was
     * registered with the query.
     * @return the result or null if the next item is not a result set
     * @throws NoResultException if there is no result in the next
     *         result set
     * @throws NonUniqueResultException if more than one result
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="predefined-type">Object</span> getSingleResult();

    <span class="comment">/**
     * Return true if the next result corresponds to a result set,
     * and false if it is an update count or if there are no results
     * other than through INOUT and OUT parameters, if any.
     * @return  true if next result corresponds to result set
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">boolean</span> hasMoreResults();

    <span class="comment">/**
     * Return the update count or  -1 if there is no pending result
     * or if the next result is not an update count.
     * @return  update count or -1 if there is no pending result or if
     *          the next result is not an update count
     * @throws QueryTimeoutException if the query execution exceeds
     *         the query timeout value set and only the statement is
     *         rolled back
     * @throws PersistenceException if the query execution exceeds
     *         the query timeout value set and the transaction
     *         is rolled back
     */</span>
    <span class="type">int</span> getUpdateCount();

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="query-execution"><a class="anchor" href="#query-execution"></a>3.10.7. Query Execution</h4>
<div class="paragraph">
<p>Jakarta Persistence query language, Criteria
API, and native SQL select queries are executed using the
<em>getResultList</em> and <em>getSingleResult</em> methods. Update and delete
operations (update and delete “queries”) are executed using the
<em>executeUpdate</em> method.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <em>TypedQuery</em> instances, the query result
type is determined in the case of criteria queries by the type of the
query specified when the <em>CriteriaQuery</em> object is created, as described
in <a href="#a10621">Section 6.5.1</a>. In the case of Jakarta Persistence query language queries, the type of the
result is determined by the <em>resultClass</em> argument to the <em>createQuery</em>
or <em>createNamedQuery</em> method, and the select list of the query must
contain only a single item which must be assignable to the specified
type.</p>
</li>
<li>
<p>For <em>Query</em> instances, the elements of a
query result whose select list consists of more than one select
expression are of type <em>Object[]</em>. If the select list consists of only
one select expression, the elements of the query result are of type
<em>Object</em>. When native SQL queries are used, the SQL result set mapping
(see <a href="#a4427">Section 3.10.16</a>), determines
how many items (entities, scalar values, etc.) are returned. If multiple
items are returned, the elements of the query result are of type
<em>Object[]</em>. If only a single item is returned as a result of the SQL
result set mapping or if a result class is specified, the elements of
the query result are of type <em>Object</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Stored procedure queries can be executed
using the <em>getResultList</em>, <em>getSingleResult</em>, and <em>execute</em> methods.
Stored procedures that perform only updates or deletes can be executed
using the <em>executeUpdate</em> method. Stored procedure query execution is
described in detail in <a href="#a4625">Section 3.10.17.3</a>.</p>
</div>
<div class="paragraph">
<p>An <em>IllegalArgumentException</em> is thrown if a
parameter instance is specified that does not correspond to a parameter
of the query, if a parameter name is specified that does not correspond
to a named parameter of the query, if a positional value is specified
that does not correspond to a positional parameter of the query, or if
the type of the parameter is not valid for the query. This exception may
be thrown when the parameter is bound, or the execution of the query may
fail. See <a href="#a4397">Section 3.10.11</a>, <a href="#a4401">Section 3.10.12</a>, and <a href="#a4405">Section 3.10.13</a> for supported
parameter usage.</p>
</div>
<div class="paragraph">
<p>The effect of applying <em>setMaxResults</em> or
<em>setFirstResult</em> to a query involving fetch joins over collections is
undefined. The use of <em>setMaxResults</em> and <em>setFirstResult</em> is not
supported for stored procedure queries.</p>
</div>
<div class="paragraph">
<p><em>Query</em> and <em>TypedQuery</em> methods other than
the <em>executeUpdate</em> method are not required to be invoked within a
transaction context, unless a lock mode other than <em>LockModeType.NONE</em>
has been specified for the query. In particular, the <em>getResultList</em> and
<em>getSingleResult</em> methods are not required to be invoked within a
transaction context unless such a lock mode has been specified for the
query<sup class="footnote">[<a id="_footnoteref_51" class="footnote" href="#_footnotedef_51" title="View footnote.">51</a>]</sup>. If an entity manager with
transaction-scoped persistence context is in use, the resulting entities
will be detached; if an entity manager with an extended persistence
context is used, they will be managed. See <a href="#a11431">Chapter 7</a> for further
discussion of entity manager use outside a transaction and persistence context types.</p>
</div>
<div class="paragraph">
<p>Whether a <em>StoredProcedureQuery</em> should be
invoked in a transaction context should be determined by the
transactional semantics and/or requirements of the stored procedure
implementation and the database in use. In particular, problems may
occur if the stored procedure initiates a transaction and a transaction
is already in effect. The state of any entities returned by the stored
procedure query invocation is determined as decribed above.</p>
</div>
<div class="paragraph">
<p>Runtime exceptions other than the
<em>NoResultException</em>, <em>NonUniqueResultException</em>,
<em>QueryTimeoutException</em>, and <em>LockTimeoutException</em> thrown by the
methods of the <em>Query</em>, <em>TypedQuery</em>, and <em>StoredProcedureQuery</em>
interfaces other than those methods specified below cause the current
transaction to be marked for rollback if the persistence context is
joined to the transaction. On database platforms on which a query
timeout causes transaction rollback, the persistence provider must throw
the <em>PersistenceException</em> instead of the <em>QueryTimeoutException</em>.</p>
</div>
<div class="paragraph">
<p>Runtime exceptions thrown by the following
methods of the <em>Query</em>, <em>TypedQuery</em>, and <em>StoredProcedureQuery</em>
interfaces do not cause the current transaction to be marked for
rollback: <em>getParameters</em>, <em>getParameter</em>, <em>getParameterValue</em>,
<em>getOutputParameterValue</em>, <em>getLockMode</em>.</p>
</div>
<div class="paragraph">
<p>Runtime exceptions thrown by the methods of
the <em>Tuple</em>, <em>TupleElement</em>, and <em>Parameter</em> interfaces do not cause
the current transaction to be marked for rollback.</p>
</div>
<div class="sect4">
<h5 id="example-4"><a class="anchor" href="#example-4"></a>3.10.7.1. Example</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span> findWithName(<span class="predefined-type">String</span> name) {
    <span class="keyword">return</span> em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT c FROM Customer c WHERE c.name LIKE :custName</span><span class="delimiter">&quot;</span></span>)
        .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">custName</span><span class="delimiter">&quot;</span></span>, name)
        .setMaxResults(<span class="integer">10</span>)
        .getResultList();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a4374"><a class="anchor" href="#a4374"></a>3.10.8. Queries and Flush Mode</h4>
<div class="paragraph">
<p>The flush mode setting affects the result of
a query as follows.</p>
</div>
<div class="paragraph">
<p>When queries are executed within a
transaction, if <em>FlushModeType.AUTO</em> is set on the <em>Query</em>,
<em>TypedQuery</em>, or <em>StoredProcedureQuery</em> object, or if the flush mode
setting for the persistence context is <em>AUTO</em> (the default) and a flush
mode setting has not been specified for the query object, the
persistence provider is responsible for ensuring that all updates to the
state of all entities in the persistence context which could potentially
affect the result of the query are visible to the processing of the
query. The persistence provider implementation may achieve this by
flushing those entities to the database or by some other means. If
<em>FlushModeType.COMMIT</em> is set, the effect of updates made to entities in
the persistence context upon queries is unspecified.</p>
</div>
<div class="paragraph">
<p>If the persistence context has not been
joined to the current transaction, the persistence provider must not
flush to the database regardless of the flush mode setting.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="directive">public</span> <span class="type">enum</span> FlushModeType {

    <span class="comment">/**
     * Flushing to occur at transaction commit.  The provider may flush
     * at other times, but is not required to.
     */</span>
    COMMIT,

    <span class="comment">/**
     * (Default) Flushing to occur at query execution.
     */</span>
    AUTO
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If there is no transaction active, the
persistence provider must not flush to the database.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4385"><a class="anchor" href="#a4385"></a>3.10.9. Queries and Lock Mode</h4>
<div class="paragraph">
<p>The <em>setLockMode</em> method of the
<em>Query</em> or <em>TypedQuery</em> interface or the <em>lockMode</em> element of the
<em>NamedQuery</em> annotation may be used to lock the results of a query. A
lock is obtained for each entity specified in the query result
(including entities passed to constructors in the query SELECT
clause).<sup class="footnote">[<a id="_footnoteref_52" class="footnote" href="#_footnotedef_52" title="View footnote.">52</a>]</sup></p>
</div>
<div class="paragraph">
<p>If the lock mode type is <em>PESSIMISTIC_READ</em>,
<em>PESSIMISTIC_WRITE</em>, or <em>PESSIMISTIC_FORCE_INCREMENT</em>, and the query
returns scalar data (e.g., the values of entity field or properties,
including scalar data passed to constructors in the query SELECT
clause), the underlying database rows will be
locked<sup class="footnote">[<a id="_footnoteref_53" class="footnote" href="#_footnotedef_53" title="View footnote.">53</a>]</sup>, but the version columns (if any) for any
entities corresponding to such scalar data will not be updated unless
the entities themselves are also otherwise retrieved and updated.</p>
</div>
<div class="paragraph">
<p>If the lock mode type is <em>OPTIMISTIC</em> or
<em>OPTIMISTIC_FORCE_INCREMENT</em>, and the query returns scalar data, any
entities returned by the query will be locked, but no locking will occur
for scalar data that does not correspond to the state of any entity
instance in the query result.</p>
</div>
<div class="paragraph">
<p>If a lock mode other than <em>NONE</em> is specified
for a query, the query must be executed within a transaction (and the
persistence context must be joined to the transaction) or the
<em>TransactionRequiredException</em> will be thrown.</p>
</div>
<div class="paragraph">
<p>Locking is supported for Jakarta Persistence
query language queries and criteria queries only. If the <em>setLockMode</em>
or <em>getLockMode</em> method is invoked on a query that is not a Jakarta
Persistence query language select query or a criteria query, the
<em>IllegalStateException</em> may be thrown or the query execution will fail.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4391"><a class="anchor" href="#a4391"></a>3.10.10. Query Hints</h4>
<div class="paragraph">
<p>The following hint is defined by this specification for use in query configuration.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jakarta.persistence.query.timeout // time in milliseconds</pre>
</div>
</div>
<div class="paragraph">
<p>This hint may be used with the <em>Query</em>,
<em>TypedQuery</em>, or <em>StoredProcedureQuery</em> <em>setHint</em> method or the
<em>NamedQuery</em>, <em>NamedNativeQuery</em>, and <em>NamedStoredProcedureQuery</em>
annotations. It may also be passed as a property to the
<em>Persistence.createEntityManagerFactory</em> method and used in the
<em>properties</em> element of the <em>persistence.xml</em> file. See <a href="#a3127">Section 3.10.1</a>,
<a href="#a12384">Section 8.2.1.9</a>, <a href="#a13443">Section 9.7</a>, <a href="#a13710">Section 10.4</a>. When used in
the <em>createEntityManagerFactory</em> method, the <em>persistence.xml</em> file, and
annotations, the <em>timeout</em> hint serves as a default value which can be
selectively overridden by use in the <em>setHint</em> method.</p>
</div>
<div class="paragraph">
<p>Portable applications should not rely on this
hint. Depending on the persistence provider and database in use, the
hint may or may not be observed.</p>
</div>
<div class="paragraph">
<p>Vendors are permitted to support the use of
additional, vendor-specific hints. Vendor-specific hints must not use
the <em>jakarta.persistence</em> namespace. Vendor-specific hints must be ignored
if they are not understood.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4397"><a class="anchor" href="#a4397"></a>3.10.11. Parameter Objects</h4>
<div class="paragraph">
<p><em>Parameter</em> objects can be used for criteria
queries and for Jakarta Persistence query language queries.</p>
</div>
<div class="paragraph">
<p>Implementations may support the use of
<em>Parameter</em> objects for native queries, however support for <em>Parameter</em>
objects with native queries is not required by this specification. The
use of <em>Parameter</em> objects for native queries will not be portable. The
mixing of parameter objects with named or positional parameters is
undefined.</p>
</div>
<div class="paragraph">
<p>Portable applications should not attempt to
reuse a <em>Parameter</em> object obtained from a <em>Query</em> or <em>TypedQuery</em>
instance in the context of a different <em>Query</em> or <em>TypedQuery</em> instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4401"><a class="anchor" href="#a4401"></a>3.10.12. Named Parameters</h4>
<div class="paragraph">
<p>Named parameters can be used for Jakarta
Persistence query language queries, for criteria queries (although use
of <em>Parameter</em> objects is to be preferred), and for stored procedure
queries that support named parameters.</p>
</div>
<div class="paragraph">
<p>Named parameters follow the rules for
identifiers defined in <a href="#a4760">Section 4.4.1</a>.
Named parameters are case-sensitive. The mixing of named and positional
parameters is undefined.</p>
</div>
<div class="paragraph">
<p>A named parameter of a Jakarta Persistence query
language query is an identifier that is prefixed by the " <em>:</em> " symbol.
The parameter names passed to the <em>setParameter</em> methods of the <em>Query</em>
and <em>TypedQuery</em> interfaces do not include this " <em>:</em> " prefix.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4405"><a class="anchor" href="#a4405"></a>3.10.13. Positional Parameters</h4>
<div class="paragraph">
<p>Only positional parameter binding and
positional access to result items may be portably used for native
queries, except for stored procedure queries for which named parameters
have been defined. When binding the values of positional parameters, the
numbering starts as “ <em>1</em> ”. It is assumed that for native queries the
parameters themselves use the SQL syntax (i.e., “ <em>?</em> ”, rather than “
<em>?1</em> ”).</p>
</div>
<div class="paragraph">
<p>The use of positional parameters is not supported for criteria queries.</p>
</div>
</div>
<div class="sect3">
<h4 id="named-queries"><a class="anchor" href="#named-queries"></a>3.10.14. Named Queries</h4>
<div class="paragraph">
<p>Named queries are static queries expressed in
metadata or queries registered by means of the EntityManagerFactory
<em>addNamedQuery</em> method. Named queries can be defined in the Jakarta
Persistence query language or in SQL. Query names are scoped to the
persistence unit.</p>
</div>
<div class="paragraph">
<p>The following is an example of the definition
of a named query defined in metadata:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NamedQuery</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">findAllCustomersWithName</span><span class="delimiter">&quot;</span></span>,
    query=<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT c FROM Customer c WHERE c.name LIKE :custName</span><span class="delimiter">&quot;</span></span>
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is an example of the use of a named query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PersistenceContext</span>
<span class="directive">public</span> EntityManager em;
    <span class="comment">// ...</span>

    customers = em.createNamedQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">findAllCustomersWithName</span><span class="delimiter">&quot;</span></span>)
        .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">custName</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>)
        .getResultList();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="polymorphic-queries"><a class="anchor" href="#polymorphic-queries"></a>3.10.15. Polymorphic Queries</h4>
<div class="paragraph">
<p>By default, all queries are polymorphic. That
is, the FROM clause of a query designates not only instances of the
specific entity class(es) to which it explicitly refers, but subclasses
as well. The instances returned by a query include instances of the
subclasses that satisfy the query conditions.</p>
</div>
<div class="paragraph">
<p>For example, the following query returns the
average salary of all employees, including subtypes of <em>Employee</em>, such
as <em>Manager</em> and <em>Exempt</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">select</span> <span class="predefined">avg</span>(e.salary) <span class="keyword">from</span> Employee e <span class="keyword">where</span> e.salary &gt; <span class="integer">80000</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Entity type expressions, described in <a href="#a5381">Section 4.6.17.5</a>, as well as the
use of downcasting, described in <a href="#a4965">Section 4.4.9</a>, can be used to restrict query polymorphism.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4427"><a class="anchor" href="#a4427"></a>3.10.16. SQL Queries</h4>
<div class="paragraph">
<p>Queries may be expressed in native SQL. The
result of a native SQL query may consist of entities, unmanaged
instances created via constructors, scalar values, or some combination
of these.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The SQL query facility is intended to provide
support for those cases where it is necessary to use the native SQL of
the target database in use (and/or where the Jakarta Persistence query
language cannot be used). Native SQL queries are not expected to be
portable across databases.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="returning-managed-entities-from-native-queries"><a class="anchor" href="#returning-managed-entities-from-native-queries"></a>3.10.16.1. Returning Managed Entities from Native Queries</h5>
<div class="paragraph">
<p>The persistence provider is responsible for
performing the mapping between the values returned by the SQL query and
entity attributes in accordance with the object/relational mapping
metadata for the entity or entities. In particular, the names of the
columns in the SQL result are used to map to the entity attributes as
defined by this metadata. This mapping includes the mapping of the
attributes of any embeddable classes that are part of the
non-collection-valued entity state and attributes corresponding to
foreign keys contained as part of the entity
state<sup class="footnote">[<a id="_footnoteref_54" class="footnote" href="#_footnotedef_54" title="View footnote.">54</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>When an entity is to be returned from a
native query, the SQL statement should select all of the columns that
are mapped to the entity object. This should include foreign key columns
to related entities. The results obtained when insufficient data is
available are undefined.</p>
</div>
<div class="paragraph">
<p>In the simplest case—i.e., when the results
of the query are limited to entities of a single entity class and the
mapping information can be derived from the columns of the SQL result
and the object/relational mapping metadata—it is sufficient to specify
only the expected class of the entity result.</p>
</div>
<div class="paragraph">
<p>The following example illustrates the case
where a native SQL query is created dynamically using the
<em>createNativeQuery</em> method and the entity class that specifies the type
of the result is passed in as an argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id, o.quantity, o.item </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (o.item = i.id) AND (i.name = 'widget')</span><span class="delimiter">&quot;</span></span>,
    com.acme.Order.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When executed, this query will return a
collection of all <em>Order</em> entities for items named “widget”.</p>
</div>
<div class="paragraph">
<p>The <em>SqlResultSetMapping</em> metadata
annotation—which is designed to handle more complex cases—can be used as
an alternative here. See <a href="#a13797">Section 10.4.4</a> for the definition of the
<em>SqlResultSetMapping</em> metadata annotation and related annotations.</p>
</div>
<div class="paragraph">
<p>For the query shown above, the
<em>SqlResultSetMapping</em> metadata for the query result type might be
specified as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlResultSetMapping</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WidgetOrderResults</span><span class="delimiter">&quot;</span></span>,
    entities=<span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same results as produced by the query
above can then obtained by the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id, o.quantity, o.item </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (o.item = i.id) AND (i.name = 'widget')</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">WidgetOrderResults</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When multiple entities are returned by a SQL
query or when the column names of the SQL result do not correspond to
those of the object/relational mapping metadata, a <em>SqlResultSetMapping</em>
metadata definition must be provided to specify the entity mapping.</p>
</div>
<div class="paragraph">
<p>The following query and <em>SqlResultSetMapping</em>
metadata illustrates the return of multiple entity types. It assumes
default metadata and column name defaults.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id, o.quantity, o.item, i.id, i.name, i.description </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (o.quantity &gt; 25) AND (o.item = i.id)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class),
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Item.class)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the column names of the SQL result do
not correspond to those of the object/relational mapping metadata, more
explicit SQL result mapping metadata must be provided to enable the
persistence provider runtime to map the JDBC results into the expected
objects. This might arise, for example, when column aliases must be used
in the SQL SELECT clause when the SQL result would otherwise contain
multiple columns of the same name or when columns in the SQL result are
the results of operators or functions. The <em>FieldResult</em> annotation
element within the <em>EntityResult</em> annotation is used to specify the
mapping of such columns to entity attributes.</p>
</div>
<div class="paragraph">
<p>The following example combining multiple
entity types includes aliases in the SQL statement. This requires that
the column names be explicitly mapped to the entity fields corresponding
to those columns. The <em>FieldResult</em> annotation is used for this purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id AS order_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.quantity AS order_quantity, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item AS order_item, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.id, i.name, i.description </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (order_quantity &gt; 25) AND (order_item = i.id)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class, fields={
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_quantity</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item</span><span class="delimiter">&quot;</span></span>)}),
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Item.class)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the returned entity type contains an
embeddable class, the <em>FieldResult</em> element must use a dot (“ <em>.</em> ”)
notation to indicate which column maps to which field or property of the
contained embeddable.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT c.id AS customer_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">c.street AS customer_street, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">c.city AS customer_city, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">c.state AS customer_state, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">c.status AS customer_status </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Customer c </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE c.status = 'GOLD' </span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">CustomerResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="error">”</span>CustomerResults<span class="error">”</span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Customer.class, fields={
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address.street</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_street</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address.city</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_city</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address.state</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_state</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer_status</span><span class="delimiter">&quot;</span></span>)
    })
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the returned entity type is the owner of
a single-valued relationship and the foreign key is a composite foreign
key (composed of multiple columns), a <em>FieldResult</em> element should be
used for each of the foreign key columns. The <em>FieldResult</em> element must
use the dot (“ <em>.</em> ”) notation form to indicate the column that maps to
each property or field of the target entity primary key.</p>
</div>
<div class="paragraph">
<p>If the target entity has a primary key of
type <em>IdClass</em>, this specification takes the form of the name of the
field or property for the relationship, followed by a dot (“ <em>.</em> ”),
followed by the name of the field or property of the primary key in the
target entity. The latter will be annotated with <em>Id</em>, as specified in
<a href="#a14836">Section 11.1.22</a>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id AS order_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.quantity AS order_quantity, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item_id AS order_item_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item_name AS order_item_name, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.id, i.name, i.description </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (order_quantity &gt; 25) AND (order_item_id = i.id) </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">AND (order_item_name = i.name)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class, fields={
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_quantity</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item.id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item_id</span><span class="delimiter">&quot;</span></span>)}),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item.name</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item_name</span><span class="delimiter">&quot;</span></span>)}),
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Item.class)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the target entity has a primary key of
type <em>EmbeddedId</em>, this specification is composed of the name of the
field or property for the relationship, followed by a dot (“ <em>.</em> ”),
followed by the name or the field or property of the primary key (i.e.,
the name of the field or property annotated as <em>EmbeddedId</em>), followed
by the name of the corresponding field or property of the embedded
primary key class.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id AS order_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.quantity AS order_quantity, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item_id AS order_item_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item_name AS order_item_name, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.id, i.name, i.description </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (order_quantity &gt; 25) AND (order_item_id = i.id) AND (order_item_name = i.name)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderItemResults</span><span class="delimiter">&quot;</span></span>, entities={
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class, fields={
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_quantity</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item.itemPk.id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item_id</span><span class="delimiter">&quot;</span></span>)}),
        <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item.itemPk.name</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item_name</span><span class="delimiter">&quot;</span></span>)}),
    <span class="annotation">@EntityResult</span>(entityClass=com.acme.Item.class)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>FieldResult</em> elements for the composite
foreign key are combined to form the primary key <em>EmbeddedId</em> class for
the target entity. This may then be used to subsequently retrieve the
entity if the relationship is to be eagerly loaded.</p>
</div>
<div class="paragraph">
<p>The dot-notation form is not required to be
supported for any usage other than for embeddables, composite foreign
keys, or composite primary keys.</p>
</div>
</div>
<div class="sect4">
<h5 id="returning-unmanaged-instances"><a class="anchor" href="#returning-unmanaged-instances"></a>3.10.16.2. Returning Unmanaged Instances</h5>
<div class="paragraph">
<p>Instances of other classes (including
non-managed entity instances) as well as scalar results can be returned
by a native query. These can be used singly, or in combination,
including with entity results.</p>
</div>
<div class="sect5">
<h6 id="scalar-results"><a class="anchor" href="#scalar-results"></a>Scalar Results</h6>
<div class="paragraph">
<p>Scalar results can be included in the query
result by specifying the <em>ColumnResult</em> annotation element of the
<em>SqlResultSetMapping</em> annotation. The intended type of the result can be
specified using the <em>type</em> element of the <em>ColumnResult</em> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT o.id AS order_id, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.quantity AS order_quantity, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">o.item AS order_item, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.name AS item_name, </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">i.availabilityDate AS item_shipdate </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Order o, Item i </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE (order_quantity &gt; 25) AND (order_item = i.id)</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">OrderResults</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderResults</span><span class="delimiter">&quot;</span></span>,
    entities={
        <span class="annotation">@EntityResult</span>(entityClass=com.acme.Order.class, fields={
            <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_id</span><span class="delimiter">&quot;</span></span>),
            <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_quantity</span><span class="delimiter">&quot;</span></span>),
            <span class="annotation">@FieldResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item</span><span class="delimiter">&quot;</span></span>, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">order_item</span><span class="delimiter">&quot;</span></span>)}
        )},
    columns={
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item_name</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">item_shipdate</span><span class="delimiter">&quot;</span></span>, type=java.util.Date.class)
    })</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="constructor-results"><a class="anchor" href="#constructor-results"></a>Constructor Results</h6>
<div class="paragraph">
<p>The mapping to constructors is specified
using the <em>ConstructorResult</em> annotation element of the
<em>SqlResultSetMapping</em> annotation. The <em>targetClass</em> element of the
<em>ConstructorResult</em> annotation specifies the class whose constructor
corresponds to the specified columns. All columns corresponding to
arguments of the intended constructor must be specified using the
<em>columns</em> element of the <em>ConstructorResult</em> annotation in the same
order as that of the argument list of the constructor. Any entities
returned as constructor results will be in either the new or the
detached state, depending on whether a primary key is retrieved for the
constructed object.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Query</span> q = em.createNativeQuery(
    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT c.id, c.name, COUNT(o) as orderCount, AVG(o.price) AS avgOrder </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM Customer c, Orders o </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">WHERE o.cid = c.id </span><span class="delimiter">&quot;</span></span> +
        <span class="string"><span class="delimiter">&quot;</span><span class="content">GROUP BY c.id, c.name</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">CustomerDetailsResult</span><span class="delimiter">&quot;</span></span>);

<span class="annotation">@SqlResultSetMapping</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CustomerDetailsResult</span><span class="delimiter">&quot;</span></span>, classes={
    <span class="annotation">@ConstructorResult</span>(targetClass=com.acme.CustomerDetails.class, columns={
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">orderCount</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@ColumnResult</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">avgOrder</span><span class="delimiter">&quot;</span></span>, type=<span class="predefined-type">Double</span>.class)})
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="combinations-of-result-types"><a class="anchor" href="#combinations-of-result-types"></a>3.10.16.3. Combinations of Result Types</h5>
<div class="paragraph">
<p>When a <em>SqlResultSetMapping</em> specifies more
than one mapping type (i.e., more than one of <em>EntityResult</em>,
<em>ConstructorResult</em>, <em>ColumnResult</em>), then for each row in the SQL
result, the query execution will result in an <em>Object[]</em> instance whose
elements are as follows, in order: any entity results (in the order in
which they are defined in the <em>entities</em> element); any instances of
classes corresponding to constructor results (in the order defined in
the <em>classes</em> element); and any instances corresponding to column
results (in the order defined in the <em>columns</em> element). If there are
any columns whose result mappings have not been specified, they are
ignored.</p>
</div>
</div>
<div class="sect4">
<h5 id="restrictions"><a class="anchor" href="#restrictions"></a>3.10.16.4. Restrictions</h5>
<div class="paragraph">
<p>When an entity is being returned, the SQL
statement should select all of the columns that are mapped to the entity
object. This should include foreign key columns to related entities. The
results obtained when insufficient data is available are undefined. A
SQL result set mapping must not be used to map results to the
non-persistent state of an entity.</p>
</div>
<div class="paragraph">
<p>The use of named parameters is not defined
for native SQL queries. Only positional parameter binding for SQL
queries may be used by portable applications.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="stored-procedures"><a class="anchor" href="#stored-procedures"></a>3.10.17. Stored Procedures</h4>
<div class="paragraph">
<p>The <em>StoredProcedureQuery</em> interface supports
the use of database stored procedures.</p>
</div>
<div class="paragraph">
<p>Stored procedures can be specified either by
means of the <em>NamedStoredProcedureQuery</em> annotation or dynamically.
Annotations for the specification of stored procedures are described in
<a href="#a13759">Section 10.4.3</a>.</p>
</div>
<div class="sect4">
<h5 id="named-stored-procedure-queries"><a class="anchor" href="#named-stored-procedure-queries"></a>3.10.17.1. Named Stored Procedure Queries</h5>
<div class="paragraph">
<p>Unlike in the case of a named native query,
the <em>NamedStoredProcedureQuery</em> annotation names a stored procedure that
exists in the database rather than providing a stored procedure
definition. The <em>NamedStoredProcedureQuery</em> annotation specifies the
types of all parameters to the stored procedure, their corresponding
parameter modes (IN, OUT, INOUT, REF_CURSOR<sup class="footnote">[<a id="_footnoteref_55" class="footnote" href="#_footnotedef_55" title="View footnote.">55</a>]</sup>), and
how result sets, if any, are to be mapped. The name that is assigned to
the stored procedure in the <em>NamedStoredProcedureQuery</em> annotation is
passed as an argument to the <em>createNamedStoredProcedureQuery</em> method to
create an executable <em>StoredProcedureQuery</em> object.</p>
</div>
<div class="paragraph">
<p>A stored procedure may return more than one
result set. As with native queries, the mapping of result sets can be
specified either in terms of a <em>resultClasses</em> or as a
<em>resultSetMappings</em> annotation element. If there are multiple result
sets, it is assumed that they will be mapped using the same mechanism —
e.g., all via a set of result class mappings or all via a set of result
set mappings. The order of the specification of these mappings must be
the same as the order in which the result sets will be returned by the
stored procedure invocation. If the stored procedure returns one or more
result sets and no <em>resultClasses</em> or <em>resultSetMappings</em> element has
been specified, any result set will be returned as a list of type
<em>Object[]</em>. The combining of different strategies for the mapping of
stored procedure result sets is undefined.</p>
</div>
<div class="paragraph">
<p><em>StoredProcedureParameter</em> metadata needs to
be provided for all parameters. Parameters must be specified in the
order in which they occur in the parameter list of the stored procedure.
If parameter names are used, the parameter name is used to bind the
parameter value and to extract the output value (if the parameter is an
INOUT or OUT parameter). If parameter names are not specified, it is
assumed that positional parameters are used. The mixing of named and
positional parameters is undefined.</p>
</div>
</div>
<div class="sect4">
<h5 id="dynamically-specified-stored-procedure-queries"><a class="anchor" href="#dynamically-specified-stored-procedure-queries"></a>3.10.17.2. Dynamically-specified Stored Procedure Queries</h5>
<div class="paragraph">
<p>If the stored procedure is not defined using
metadata, parameter and result set information must be provided
dynamically.</p>
</div>
<div class="paragraph">
<p>All parameters of a dynamically-specified
stored procedure query must be registered using the
<em>registerStoredProcedureParameter</em> method of the <em>StoredProcedureQuery</em>
interface.</p>
</div>
<div class="paragraph">
<p>Result set mapping information can be
provided by means of the <em>createStoredProcedureQuery</em> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="a4625"><a class="anchor" href="#a4625"></a>3.10.17.3. Stored Procedure Query Execution</h5>
<div class="paragraph">
<p>Stored procedure query execution can be
controlled as described below.</p>
</div>
<div class="paragraph">
<p>The <em>setParameter</em> methods are used to set
the values of all required IN and INOUT parameters. It is not required
to set the values of stored procedure parameters for which default
values have been defined by the stored procedure.</p>
</div>
<div class="paragraph">
<p>When <em>getResultList</em> and <em>getSingleResult</em>
are called on a <em>StoredProcedureQuery</em> object, the persistence provider
will call <em>execute</em> on an unexecuted stored procedure query before
processing <em>getResultList</em> or <em>getSingleResult</em>.</p>
</div>
<div class="paragraph">
<p>When <em>executeUpdate</em> is called on a
<em>StoredProcedureQuery</em> object, the persistence provider will call
<em>execute</em> on an unexecuted stored procedure query followed by
<em>getUpdateCount</em>. The results of <em>executeUpdate</em> will be those of
<em>getUpdateCount</em>.</p>
</div>
<div class="paragraph">
<p>The <em>execute</em> method supports both the simple
case where scalar results are passed back only via INOUT and OUT
parameters as well as the most general case (multiple result sets and/or
update counts, possibly also in combination with output parameter
values).</p>
</div>
<div class="paragraph">
<p>The <em>execute</em> method returns <em>true</em> if the
first result is a result set, and <em>false</em> if it is an update count or
there are no results other than through INOUT and OUT parameters, if
any.</p>
</div>
<div class="paragraph">
<p>If the <em>execute</em> method returns <em>true</em>, the
pending result set can be obtained by calling <em>getResultList</em> or
<em>getSingleResult</em>. The <em>hasMoreResults</em> method can then be used to test
for further results.</p>
</div>
<div class="paragraph">
<p>If <em>execute</em> or <em>hasMoreResults</em> returns
<em>false</em>, the <em>getUpdateCount</em> method can be called to obtain the
pending result if it is an update count. The <em>getUpdateCount</em> method
will return either the update count (zero or greater) or -1 if there is
no update count (i.e., either the next result is a result set or there
is no next update count).</p>
</div>
<div class="paragraph">
<p>For portability, results that correspond to
JDBC result sets and update counts need to be processed before the
values of any INOUT or OUT parameters are extracted.</p>
</div>
<div class="paragraph">
<p>After results returned through
<em>getResultList</em> and <em>getUpdateCount</em> have been exhausted, results
returned through INOUT and OUT parameters can be retrieved.</p>
</div>
<div class="paragraph">
<p>The <em>getOutputParameterValue</em> methods are
used to retrieve the values passed back from the procedure through INOUT
and OUT parameters.</p>
</div>
<div class="paragraph">
<p>When using <em>REF_CURSOR</em> parameters for result
sets, the update counts should be exhausted before calling
<em>getResultList</em> to retrieve the result set. Alternatively, the
<em>REF_CURSOR</em> result set can be retrieved through
<em>getOutputParameterValue</em>. Result set mappings will be applied to
results corresponding to <em>REF_CURSOR</em> parameters in the order the
<em>REF_CURSOR</em> parameters were registered with the query.</p>
</div>
<div class="paragraph">
<p>In the simplest case, where results are
returned only via INOUT and OUT parameters, <em>execute</em> can be followed
immediately by calls to <em>getOutputParameterValue</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a4639"><a class="anchor" href="#a4639"></a>3.11. Summary of Exceptions</h3>
<div class="paragraph">
<p>The following is a summary of the exceptions defined by this specification:</p>
</div>
<div class="paragraph">
<p><strong>PersistenceException</strong></p>
</div>
<div class="paragraph">
<p>The <em>PersistenceException</em> is thrown by the
persistence provider when a problem occurs. It may be thrown to report
that the invoked operation could not complete because of an unexpected
error (e.g., failure of the persistence provider to open a database
connection).</p>
</div>
<div class="paragraph">
<p>All other exceptions defined by this
specification are subclasses of the <em>PersistenceException</em>. All
instances of <em>PersistenceException</em> except for instances of
<em>NoResultException</em>, <em>NonUniqueResultException,</em> <em>LockTimeoutException</em>
, and <em>QueryTimeoutException</em> will cause the current transaction, if one
is active and the persistence context has been joined to it, to be
marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>TransactionRequiredException</strong></p>
</div>
<div class="paragraph">
<p>The <em>TransactionRequiredException</em> is thrown
by the persistence provider when a transaction is required but is not
active.</p>
</div>
<div class="paragraph">
<p><strong>OptimisticLockException</strong></p>
</div>
<div class="paragraph">
<p>The <em>OptimisticLockException</em> is thrown by
the persistence provider when an optimistic locking conflict occurs.
This exception may be thrown as part of an API call, at flush, or at
commit time. The current transaction, if one is active, will be marked
for rollback.</p>
</div>
<div class="paragraph">
<p><strong>PessimisticLockException</strong></p>
</div>
<div class="paragraph">
<p>The <em>PessimisticLockException</em> is thrown by
the persistence provider when a pessimistic locking conflict occurs. The
current transaction will be marked for rollback. Typically the
<em>PessimisticLockException</em> occurs because the database transaction has
been rolled back due to deadlock or because the database uses
transaction-level rollback when a pessimistic lock cannot be granted.</p>
</div>
<div class="paragraph">
<p><strong>LockTimeoutException</strong></p>
</div>
<div class="paragraph">
<p>The <em>LockTimeoutException</em> is thrown by the
persistence provider when a pessimistic locking conflict occurs that
does not result in transaction rollback. Typically this occurs because
the database uses statement-level rollback when a pessimistic lock
cannot be granted (and there is no deadlock). The <em>LockTimeoutException</em>
does not cause the current transaction to be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>RollbackException</strong></p>
</div>
<div class="paragraph">
<p>The <em>RollbackException</em> is thrown by the
persistence provider when <em>EntityTransaction.commit</em> fails. __</p>
</div>
<div class="paragraph">
<p><strong>EntityExistsException</strong></p>
</div>
<div class="paragraph">
<p>The <em>EntityExistsException</em> may thrown by the
persistence provider when the <em>persist</em> operation is invoked and the
entity already exists. The <em>EntityExistsException</em> may be thrown when
the persist operation is invoked, or the <em>EntityExistsException</em> or
another <em>PersistenceException</em> may be thrown at commit time. The current
transaction, if one is active and the persistence context has been
joined to it, will be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>EntityNotFoundException</strong></p>
</div>
<div class="paragraph">
<p>The <em>EntityNotFoundException</em> is thrown by
the persistence provider when an entity reference obtained by
<em>getReference</em> is accessed but the entity does not exist. It is thrown
by the <em>refresh</em> operation when the entity no longer exists in the
database. It is also thrown by the <em>lock</em> operation when pessimistic
locking is used and the entity no longer exists in the database. The
current transaction, if one is active and the persistence context has
been joined to it, will be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>NoResultException</strong></p>
</div>
<div class="paragraph">
<p>The <em>NoResultException</em> is thrown by the
persistence provider when <em>Query.getSingleResult</em> or
<em>TypedQuery.getSingleResult</em> is invoked and there is no result to
return. This exception will not cause the current transaction, if one is
active, to be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>NonUniqueResultException</strong></p>
</div>
<div class="paragraph">
<p>The <em>NonUniqueResultException</em> is thrown by
the persistence provider when <em>Query.getSingleResult</em> or
<em>TypedQuery.getSingleResult</em> is invoked and there is more than one
result from the query. This exception will not cause the current
transaction, if one is active, to be marked for rollback.</p>
</div>
<div class="paragraph">
<p><strong>QueryTimeoutException</strong></p>
</div>
<div class="paragraph">
<p>The <em>QueryTimeoutException</em> is thrown by the
persistence provider when a query times out and only the statement is
rolled back. The <em>QueryTimeoutException</em> does not cause the current
transaction, if one is active, to be marked for rollback.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a4665"><a class="anchor" href="#a4665"></a>4. Query Language</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Jakarta Persistence query language is a
string-based query language used to define queries over entities and
their persistent state. It enables the application developer to specify
the semantics of queries in a portable way, independent of the
particular database schema in use in an enterprise environment. The full
range of the language may be used in both static and dynamic queries.</p>
</div>
<div class="paragraph">
<p>This chapter provides the full definition of
the Jakarta Persistence query language.</p>
</div>
<div class="sect2">
<h3 id="overview"><a class="anchor" href="#overview"></a>4.1. Overview</h3>
<div class="paragraph">
<p>The Jakarta Persistence query language is a
query specification language for string-based dynamic queries and static
queries expressed through metadata. It is used to define queries over
the persistent entities defined by this specification and their
persistent state and relationships.</p>
</div>
<div class="paragraph">
<p>The Jakarta Persistence query language can be
compiled to a target language, such as SQL, of a database or other
persistent store. This allows the execution of queries to be shifted to
the native language facilities provided by the database, instead of
requiring queries to be executed on the runtime representation of the
entity state. As a result, query methods can be optimizable as well as
portable.</p>
</div>
<div class="paragraph">
<p>The query language uses the abstract
persistence schema of entities, including their embedded objects and
relationships, for its data model, and it defines operators and
expressions based on this data model. It uses a SQL-like syntax to
select objects or values based on abstract schema types and
relationships. It is possible to parse and validate queries before
entities are deployed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The term abstract persistence schema refers
to the persistent schema abstraction (persistent entities, their state,
and their relationships) over which Jakarta Persistence queries operate.
Queries over this persistent schema abstraction are translated into
queries that are executed over the database schema to which entities are
mapped.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Queries may be defined in metadata
annotations or the XML descriptor. The abstract schema types of a set of
entities can be used in a query if the entities are defined in the same
persistence unit as the query. Path expressions allow for navigation
over relationships defined in the persistence unit.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A persistence unit defines the set of all
classes that are related or grouped by the application and which must be
colocated in their mapping to a single database.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="statement-types"><a class="anchor" href="#statement-types"></a>4.2. Statement Types</h3>
<div class="paragraph">
<p>A Jakarta Persistence query language statement
may be either a select statement, an update statement, or a delete
statement.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This chapter refers to all such statements as
“queries”. Where it is important to distinguish among statement types,
the specific statement type is referenced.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In BNF syntax, a query language statement is
defined as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>QL_statement :: = select_statement | update_statement | delete_statement</pre>
</div>
</div>
<div class="paragraph">
<p>Any Jakarta Persistence query language statement
may be constructed dynamically or may be statically defined in a
metadata annotation or XML descriptor element.</p>
</div>
<div class="paragraph">
<p>All statement types may have parameters.</p>
</div>
<div class="sect3">
<h4 id="select-statements"><a class="anchor" href="#select-statements"></a>4.2.1. Select Statements</h4>
<div class="paragraph">
<p>A select statement is a string which consists
of the following clauses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a SELECT clause, which determines the type of
the objects or values to be selected.</p>
</li>
<li>
<p>a FROM clause, which provides declarations
that designate the domain to which the expressions specified in the
other clauses of the query apply.</p>
</li>
<li>
<p>an optional WHERE clause, which may be used
to restrict the results that are returned by the query.</p>
</li>
<li>
<p>an optional GROUP BY clause, which allows
query results to be aggregated in terms of groups.</p>
</li>
<li>
<p>an optional HAVING clause, which allows
filtering over aggregated groups.</p>
</li>
<li>
<p>an optional ORDER BY clause, which may be
used to order the results that are returned by the query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In BNF syntax, a select statement is defined
as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>select_statement :: = select_clause from_clause [where_clause] [groupby_clause] [having_clause] [orderby_clause]</pre>
</div>
</div>
<div class="paragraph">
<p>A select statement must always have a SELECT
and a FROM clause. The square brackets [] indicate that the other
clauses are optional.</p>
</div>
</div>
<div class="sect3">
<h4 id="update-and-delete-statements"><a class="anchor" href="#update-and-delete-statements"></a>4.2.2. Update and Delete Statements</h4>
<div class="paragraph">
<p>Update and delete statements provide bulk
operations over sets of entities.</p>
</div>
<div class="paragraph">
<p>In BNF syntax, these operations are defined
as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>update_statement :: = update_clause [where_clause]
delete_statement :: = delete_clause [where_clause]</pre>
</div>
</div>
<div class="paragraph">
<p>The update and delete clauses determine the
type of the entities to be updated or deleted. The WHERE clause may be
used to restrict the scope of the update or delete operation.</p>
</div>
<div class="paragraph">
<p>Update and delete statements are described
further in <a href="#a5636">Section 4.10</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="abstract-schema-types-and-query-domains"><a class="anchor" href="#abstract-schema-types-and-query-domains"></a>4.3. Abstract Schema Types and Query Domains</h3>
<div class="paragraph">
<p>The Jakarta Persistence query language is a
typed language, and every expression has a type. The type of an
expression is derived from the structure of the expression, the abstract
schema types of the identification variable declarations, the types to
which the persistent attributes evaluate, and the types of literals.</p>
</div>
<div class="paragraph">
<p>The abstract schema type of an entity or
embeddable is derived from its class and the metadata information
provided by Java language annotations or in the XML descriptor.</p>
</div>
<div class="paragraph">
<p>Informally, the abstract schema type of an
entity or embeddable can be characterized as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For every non-relationship persistent field
or get accessor method (for a persistent property) of the class, there
is a field (“state field”) whose abstract schema type corresponds to
that of the field or the result type of the accessor method.</p>
</li>
<li>
<p>For every persistent relationship field or
get accessor method (for a persistent relationship property) of the
class, there is a field (“association field”) whose type is the abstract
schema type of the related entity (or, if the relationship is a
one-to-many or many-to-many, a collection of such).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Abstract schema types are specific to the
query language data model. The persistence provider is not required to
implement or otherwise materialize an abstract schema type.</p>
</div>
<div class="paragraph">
<p>The domain of a query consists of the
abstract schema types of all entities and embeddables that are defined
in the same persistence unit.</p>
</div>
<div class="paragraph">
<p>The domain of a query may be restricted by
the <em>navigability</em> of the relationships of the entity and associated
embeddable classes on which it is based. The association fields of an
entity&#8217;s or embeddable&#8217;s abstract schema type determine navigability.
Using the association fields and their values, a query can select
related entities and use their abstract schema types in the query.</p>
</div>
<div class="sect3">
<h4 id="naming"><a class="anchor" href="#naming"></a>4.3.1. Naming</h4>
<div class="paragraph">
<p>Entities are designated in query strings by
their entity names. The entity name is defined by the <em>name</em> element of
the <em>Entity</em> annotation (or the <em>entity-name</em> XML descriptor element),
and defaults to the unqualified name of the entity class. Entity names
are scoped within the persistence unit and must be unique within the
persistence unit.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4713"><a class="anchor" href="#a4713"></a>4.3.2. Example</h4>
<div class="paragraph">
<p>This example assumes that the application
developer provides several entity classes, representing orders,
products, and line items, and an embeddable address class representing
shipping addresses and billing addresses. The abstract schema types for
the entities are <em>Order</em>, <em>Product</em>, and <em>LineItem</em> respectively.
There is a one-to-many relationship between <em>Order</em> and <em>LineItem</em>. The
entity <em>LineItem</em> is related to <em>Product</em> in a many-to-one relationship.
The classes are logically in the same persistence unit, as shown in
<a href="#a4724">Figure 1</a>.</p>
</div>
<div class="paragraph">
<p>Queries to select orders can be defined by
navigating over the association fields and state fields defined by
<em>Order</em> and <em>LineItem</em>. A query to find all orders with pending line
items might be written as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> o <span class="keyword">JOIN</span> o.lineItems <span class="keyword">AS</span> l
<span class="keyword">WHERE</span> l.shipped = <span class="predefined-constant">FALSE</span></code></pre>
</div>
</div>
<div id="a4724" class="imageblock">
<div class="content">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAecAAAClCAMAAABRNMW1AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA2FBMVEX///8AAAD//9+XPwAAP5ff///flz8AAGe3//8AZ7e3ZwA/l9//35c/AABnt/+3lz/f/7dnAAD//7cAAD+X3///t2c/l7c/AD+Xt5dnAD8/P5eXPz9mAGY/Z5dnt7dnP5c/Z7eXl7e3t2cAZ5e3/7cAZmY/PwA/P2ffl2dnt9+XP2e335ff35dnl7eXl2eX37cAPz/f/9+3Z2eXlz/ft2e3l5c/AGcAP2dnPwCX398/Pz+XZwD/t5dnZz/fl5e3Zz//t7dnZwC3t7e3t/+Xl9+3/9/ft7c/l5duMwLXAAAAAWJLR0QAiAUdSAAAAAd0SU1FB+MEGggiB6HlUIwAAAlBSURBVHja7Z0LW9s2FIYjOzixk0B9yVoG61gLLesY0HVt125du/v//0eT5ABOItuSJcXnOOd7HlqIJfOd8yJfdRmNSCQSiUQikUgkEolEIpFIJBKJRCKRSKQhiZGs1Dc/bc59G8AtNOlDYxSm0KQPjVGYQpM+NEZhCk360BiFKTTpQ2MUptCkD41RmEKTPjRGYQpN+tAYhSk06UNjFKbQpA+NUZhCkz40RmEKTfrQGIUpNOnzYRTdyxyLUPs20IfRLbzD540mNBdGW3EOlzeakGyMGuMbHm80oXQ0aodrOLDRRNHFqBtIg0CNJgRjoy7x4EeNxr+hUedgkJNG497MqLJ0EIrT7fig+lk0mfpxAExozBsZVRaOWCz+S9js4bOE6XPGkyvM3q05zxdx+U3CDkfJ+IiNH6W8eXPOGf8/L8rPDgz3ikVovJsYVZZd3rXjiH3FD+AzDp5/kEym88eF+JCxakO39gBMaKwbGFUXnS9WjTXhbTfi38tT83IyXZbPRGZRY2M2NQFMaJxbt+e187NgKhv4kuVPRHselZ+58wBMaKzbX4dVrrcTeV6WDZk3bnF+lmq5JkOTK8zeHdxX7dQBMKExT89J7Oz3bcCbUadgkFMeMmeHcNBTHjbnFSDbEAdAeeic73sM7LwuNKGJorNRWVF/AgeEUz1oZwGD7DhXf1ZxVMNdirvrYWj/OFe2qOlWfsiOiTMWo8xiA3FGY5SZbyHOCI2yDpvuNxBnNEaJc1saYKnr/XOnjasN8wVjh30H7kbE2eVvgys0Afng3OFaHKvQBLRbzoot86+P2PjIpH8oJA2cM+u6eWtLELJZls6CE5xXZvvN2QR0djrlkIMQ54UZcdbdRJzhGm2vpN+gExYnrK0rP1gRZ7e/EarQBOOJ877cQ6MJptM4d7sybRfrmJagAG3O1qhWHSPQjVghMwdnyKVRh5w7zmSzq+y4SQUE9cG50resq2sosEGY8GRUs0pzg3aACQJpABa8GXXA2RGi/ht137/fp1HdKnXlhjRyZ8CctWuoCw5rJB5xrik5sJG1xHm0a87zb0L2NN3xe2zirC6pqhyE4iVGdroilKWtE9eo9hqEeRFNptFu33sNl7PdhCbK2tm3a++q5mej4DtzT7zacjYizo6MWnFWV5acs9Nnz8PJeZoXAhi7SPMn+gdisV/i7NSo3cQ19e05yl/wA+/LYhlzYEdnl4UYbad5IJZ7Tdj34u9kt++xB8vZct6aes7Bqx/O5LRy46sz3jYT/l2s20D7yzZxrimuqi84z3+UnF8W8gA85+1Z/0Dc4x00ca4prqgv5x/Lr/nXTXq74Gdm0QP0Qkw+pnkgZs2kg9DfzRZxrivu6XlY06Pu4BVxtuZmXsHX8+1a1MS5F84e31ep99vG2aKnEnFuqeHr/bOKkoqzo55KA+Xs8i2m9cpI9ds2Pqhy7rrmlruE9CPvnJs7EHWArdPK1gsk5SAAq85GNZWJs34dg/TrF90q5+KSgOncJsKUf8563b31zpZGv7Za3NU1/qaHYXL2M+hus7i7fvp3lf31VCLOtrVcxce89lQizvbV+ojQdJ+D5OxhDqpeAiwX9GCqobia6+gRZ7cVfQWYpYdieqstqIp19DY6u2zslTg7qegrPslZrKAnF8t7HcpFeeT6PJPzlMXyjlu2evEji+t3S5wd1fQT3qo95y/EYnlZOiuP5eU6ekEYi0W3rhayN+JPb9TvRVnPgTlKhGVRh1W9xFcurcWP0XJhNTkb+Jyt1tFbcf55dQRXL7M25PaMknPD+VlIUCzP0xFbraNXJHG5LmZ8X6J+r8TZXV3nAZYdWEQjTu4XtuUn5Lt19CL2cLrOi6Xq/Dzk622rkKA1aFf7JM5Oa9v9anoethec6fm2iVHbiHp++Envq1wX9FTfOlB6/+y2oKf6DkK1fce5F/1JrCMCkZJOL7QbKoEISisGx+V87sFZzO56KsEJqi0Ox+X87sJl4E56KsGKyYHRwXGuGqN++k7jQZOUAYZEnPcjpF1yxpOV4UVEnPcjIj2jrp4a9h2tc6GJyOTa0r4DPZq0DC6g1htEpwNiaocduhuDsVsNwajpYyOtcVSbddyOqdq5YLtrN9opwfrPj3z8CfUisMY0jHobgH63fVWiHBYxOT++OS4y8Y/FbvsSSFNaRiv5FGt8vr16N11bf11jLXbWdBqu/CgXG4zGB0leJHn7OqIQWYMzpGd0PZPLeBS9/6XL5Fvqd7Vb80lIzhfHH06K4EQ06tM3bHy1YA2LBEMjDcyOntHNJM4fF2J+1Tfs9jFn8IzD418XxzftOBQ7U80PIw7ccZJLzi/yD/zwEZxct6wRDKtRQ/KiaVSRvyzNC7E480IwiMU82aNMHD01cGzsUAmnbM/5R8mZ/yOXjv0Qti4pCog0HCe6RusGqDzlyQ9zwWCUiSFHEbvRxFEZtaDeueS8ZPka52udSdbBkIbiQ9+owvFSDCy748wvvzI2E9PW3+jjaEzG3TBkMRjiSPzzK4vlWAjVAMVa30DSB11NA4V++3Sf/PGjdIXko+Cgi4OZ5+L3qdZs+kASDMSGvtE2w/K4ffpw4aWHowPnZDX0Sdd4v4LhQt9om19xDfa6ekrWxMG8pQJGhmG4MDDqx7A/zEBSDMKEiVEvhnUO26vna5+L8svYeL+C4cLEaJ3jrhwe9tmciy9/iCt38UhGPpYx9t2vgNgwMVpzT9qRQ3WHjcn4cymnfBFPYtj7d+dp/mRx8XZx8Ze2714FxIaZUSXpLQ7FXA9E29OwUtnf/Co+mo0+f5oFi/HBZbHMiy/XxZe2mdH7zpsifaDV9B5DaJvD7LIdBNN4ul1KTBZxyE8Ilx+LUSImdGLPw8k/odGjczDpA6ym95JC2xzioA1EzUT3yrL/HoyWMf87ithslEwO+G3579N5Pp2f1e8cUm4heTE1uvaed5tDM4iGl8TqN1aH/G/ndsHY03Q1+cttyv5L2aH2PqClD6Ya+g0xNYf4qgZEewcfHyOQ+xU4Q12Muhs+ulHS5QjkfgXSVBejfjplOhyB3K/gOutu1HUna+rXu3dGqZ8+GQUtNOlDYxSm0KQPjVGYQpM+NEZhCk360BiFKTTpYyQr9c2PRCKRSCQSiUQikUgkEolEIpFIJBKJRCKRSKR6/Q+SQFF9sAhPkQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0wNC0yNlQxNTozNDowNy0wNzowMCTXmPoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMDQtMjZUMTU6MzQ6MDctMDc6MDBViiBGAAAAAElFTkSuQmCC" alt="Image">
</div>
<div class="title">Figure 1. Abstract Persistence Schema of Several Entities with Defined in the Same Persistence Unit.</div>
</div>
<div class="paragraph">
<p>This query navigates over the association
field <em>lineItems</em> of the abstract schema type <em>Order</em> to find line
items, and uses the state field <em>shipped</em> of <em>LineItem</em> to select those
orders that have at least one line item that has not yet shipped. (Note
that this query does not select orders that have no line items.)</p>
</div>
<div class="paragraph">
<p>Although reserved identifiers, such as
DISTINCT, FROM, AS, JOIN, WHERE, and FALSE appear in upper case in this
example, reserved identifiers are case
insensitive.<sup class="footnote">[<a id="_footnoteref_56" class="footnote" href="#_footnotedef_56" title="View footnote.">56</a>]</sup></p>
</div>
<div class="paragraph">
<p>The SELECT clause of this example designates
the return type of this query to be of type Order.</p>
</div>
<div class="paragraph">
<p>Because the same persistence unit defines the
abstract persistence schema of the related entities, the developer can
also specify a query over orders that utilizes the abstract schema type
for products, and hence the state fields and association fields of both
the abstract schema types <em>Order</em> and <em>Product</em>. For example, if the
abstract schema type <em>Product</em> has a state field named <em>productType</em>, a
query over orders can be specified using this state field. Such a query
might be to find all orders for products with product type office
supplies. A query for this might be as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> l.product p
<span class="keyword">WHERE</span> p.productType = <span class="string"><span class="delimiter">'</span><span class="content">office_supplies</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because <em>Order</em> is related to <em>Product</em> by
means of the relationships between <em>Order</em> and <em>LineItem</em> and between
<em>LineItem</em> and <em>Product</em>, navigation using the association fields
<em>lineItems</em> and <em>product</em> is used to express the query. This query is
specified by using the entity name <em>Order</em>, which designates the
abstract schema type over which the query ranges. The basis for the
navigation is provided by the association fields <em>lineItems</em> and
<em>product</em> of the abstract schema types Order and LineItem respectively.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-from-clause-and-navigational-declarations"><a class="anchor" href="#the-from-clause-and-navigational-declarations"></a>4.4. The FROM Clause and Navigational Declarations</h3>
<div class="paragraph">
<p>The FROM clause of a query defines the domain
of the query by declaring identification
variables. An identification variable is an identifier declared in the
FROM clause of a query. The domain of the
query may be constrained by path expressions. (See <a href="#a4792">[a4792]</a>.)</p>
</div>
<div class="paragraph">
<p>Identification variables designate instances
of a particular abstract schema type. The FROM clause can contain
multiple identification variable declarations separated by a comma (<em>,</em>
).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>from_clause ::=
    FROM identification_variable_declaration
        {, {identification_variable_declaration | collection_member_declaration}}*

identification_variable_declaration ::= range_variable_declaration {join | fetch_join}*

range_variable_declaration ::= entity_name [AS] identification_variable

join ::= join_spec join_association_path_expression [AS] identification_variable [join_condition]

fetch_join ::= join_spec FETCH join_association_path_expression

join_association_path_expression ::=
    join_collection_valued_path_expression |
    join_single_valued_path_expression |
    TREAT(join_collection_valued_path_expression AS subtype) |
    TREAT(join_single_valued_path_expression AS subtype)

join_collection_valued_path_expression ::= identification_variable.{single_valued_embeddable_object_field.}*collection_valued_field

join_single_valued_path_expression ::= identification_variable.{single_valued_embeddable_object_field.}*single_valued_object_field

join_spec ::= [LEFT [OUTER] | INNER] JOIN

join_condition ::= ON conditional_expression

collection_member_declaration ::= IN (collection_valued_path_expression) [AS] identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>The following subsections discuss the constructs used in the FROM clause.</p>
</div>
<div class="sect3">
<h4 id="a4760"><a class="anchor" href="#a4760"></a>4.4.1. Identifiers</h4>
<div class="paragraph">
<p>An identifier is a character sequence of
unlimited length. The character sequence must begin with a Java
identifier start character, and all other characters must be Java
identifier part characters. An identifier start character is any
character for which the method <em>Character.isJavaIdentifierStart</em> returns
true. This includes the underscore (<em>_</em>) character and the dollar sign
(<em>$</em>) character. An identifier part character is any character for
which the method <em>Character.isJavaIdentifierPart</em> returns true. The
question mark (<em>?</em>) character is reserved for use by the Jakarta
Persistence query language.</p>
</div>
<div class="paragraph">
<p>The following are reserved identifiers: ABS,
ALL, AND, ANY, AS, ASC, AVG, BETWEEN, BIT_LENGTH<sup class="footnote">[<a id="_footnoteref_57" class="footnote" href="#_footnotedef_57" title="View footnote.">57</a>]</sup>,
BOTH, BY, CASE, CHAR_LENGTH, CHARACTER_LENGTH, CLASS, COALESCE, CONCAT,
COUNT, CURRENT_DATE, CURRENT_TIME, CURRENT_TIMESTAMP, DELETE, DESC,
DISTINCT, ELSE, EMPTY, END, ENTRY, ESCAPE, EXISTS, FALSE, FETCH, FROM,
FUNCTION, GROUP, HAVING, IN, INDEX, INNER, IS, JOIN, KEY, LEADING, LEFT,
LENGTH, LIKE, LOCATE, LOWER, MAX, MEMBER, MIN, MOD, NEW, NOT, NULL,
NULLIF, OBJECT, OF, ON, OR, ORDER, OUTER, POSITION, SELECT, SET, SIZE,
SOME, SQRT, SUBSTRING, SUM, THEN, TRAILING, TREAT, TRIM, TRUE, TYPE,
UNKNOWN, UPDATE, UPPER, VALUE, WHEN, WHERE.</p>
</div>
<div class="paragraph">
<p>Reserved identifiers are case insensitive.
Reserved identifiers must not be used as identification variables or
result variables (see <a href="#a5438">Section 4.8</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is recommended that SQL key words other
than those listed above not be used as identification variables in
queries because they may be used as reserved identifiers in future
releases of this specification.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="a4765"><a class="anchor" href="#a4765"></a>4.4.2. Identification Variables</h4>
<div class="paragraph">
<p>An identification
variable is a valid identifier declared in the FROM clause of a query.</p>
</div>
<div class="paragraph">
<p>All identification variables must be declared
in the FROM clause. Identification variables cannot be declared in other
clauses.</p>
</div>
<div class="paragraph">
<p>An identification variable must not be a
reserved identifier or have the same name as any entity in the same
persistence unit.</p>
</div>
<div class="paragraph">
<p>Identification variables are case
insensitive.</p>
</div>
<div class="paragraph">
<p>An identification variable evaluates to a
value of the type of the expression used in declaring the variable. For
example, consider the previous query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> l.product p
<span class="keyword">WHERE</span> p.productType = <span class="string"><span class="delimiter">'</span><span class="content">office_supplies</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the FROM clause declaration <em>o.lineItems</em>
<em>l</em>, the identification variable <em>l</em> evaluates to any LineItem value
directly reachable from Order. The association field <em>lineItems</em> is a
collection of instances of the abstract schema type LineItem and the
identification variable <em>l</em> refers to an element of this collection. The
type of <em>l</em> is the abstract schema type of <em>LineItem</em>.</p>
</div>
<div class="paragraph">
<p>An identification variable can range over an
entity, embeddable, or basic abstract schema type. An identification
variable designates an instance of an abstract schema type or an element
of a collection of abstract schema type instances.</p>
</div>
<div class="paragraph">
<p>Note that for identification variables
referring to an instance of an association or collection represented as
a <em>java.util.Map</em>, the identification variable is of the abstract
schema type of the map <em>value</em>.</p>
</div>
<div class="paragraph">
<p>An identification variable always designates
a reference to a single value. It is declared in one of three ways: in a
range variable declaration, in a join clause, or in a collection member
declaration. The identification variable declarations are evaluated from
left to right in the FROM clause, and an identification variable
declaration can use the result of a preceding identification variable
declaration of the query string.</p>
</div>
<div class="paragraph">
<p>All identification variables used in the
SELECT, WHERE, ORDER BY, GROUP BY, or HAVING clause of a SELECT or
DELETE statement must be declared in the FROM clause. The identification
variables used in the WHERE clause of an UPDATE statement must be
declared in the UPDATE clause.</p>
</div>
<div class="paragraph">
<p>Identification variables are existentially
quantified in these clauses. This means that an identification variable
represents a member of a collection or an instance of an entity&#8217;s
abstract schema type. An identification variable never designates a
collection in its entirety.</p>
</div>
<div class="paragraph">
<p>An identification variable is scoped to the
query (or subquery) in which it is defined and is also visible to any
subqueries within that query scope that do not define an identification
variable of the same name.</p>
</div>
</div>
<div class="sect3">
<h4 id="range-variable-declarations"><a class="anchor" href="#range-variable-declarations"></a>4.4.3. Range Variable Declarations</h4>
<div class="paragraph">
<p>The syntax for declaring an
identification variable as a range variable is similar to that of SQL;
optionally, it uses the AS keyword. A range variable designates an
entity abstract schema type.<sup class="footnote">[<a id="_footnoteref_58" class="footnote" href="#_footnotedef_58" title="View footnote.">58</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>range_variable_declaration ::= entity_name [AS] identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>Range variable declarations allow the
developer to designate a “root” for objects which may not be reachable
by navigation.</p>
</div>
<div class="paragraph">
<p>In order to select values by comparing more
than one instance of an entity abstract schema type, more than one
identification variable ranging over the abstract schema type is needed
in the FROM clause.</p>
</div>
<div class="paragraph">
<p>The following query returns orders whose
quantity is greater than the order quantity for John Smith. This example
illustrates the use of two different identification variables in the
FROM clause, both of the abstract schema type Order. The SELECT clause
of this query determines that it is the orders with quantities larger
than John Smith&#8217;s that are returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o1
<span class="keyword">FROM</span> <span class="keyword">Order</span> o1, <span class="keyword">Order</span> o2
<span class="keyword">WHERE</span> o1.quantity &gt; o2.quantity <span class="keyword">AND</span>
 o2.customer.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span>
 o2.customer.firstname= <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="path-expressions"><a class="anchor" href="#path-expressions"></a>4.4.4. Path Expressions<a id="a4792"></a></h4>
<div class="paragraph">
<p>An identification variable followed by the
navigation operator (<em>.</em>) and a state field or association field is a
path expression. The type of the path expression is the type computed as
the result of navigation; that is, the type of the state field or
association field to which the expression navigates. The type of a path
expression that navigates to an association field may be specified as a
subtype of the declared type of the association field by means of the
TREAT operator. See <a href="#a4965">Section 4.4.9</a>.</p>
</div>
<div class="paragraph">
<p>An identification variable qualified
by the KEY, VALUE, or ENTRY operator is a path expression. The KEY,
VALUE, and ENTRY operators may only be applied to identification
variables that correspond to map-valued associations or map-valued
element collections. The type of the path expression is the type
computed as the result of the operation; that is, the abstract schema
type of the field that is the value of the KEY, VALUE, or ENTRY operator
(the map key, map value, or map entry
respectively).<sup class="footnote">[<a id="_footnoteref_59" class="footnote" href="#_footnotedef_59" title="View footnote.">59</a>]</sup></p>
</div>
<div class="paragraph">
<p>In the following query, photos is a map from photo label to filename.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> i.name, VALUE(p)
<span class="keyword">FROM</span> Item i <span class="keyword">JOIN</span> i.photos p
<span class="keyword">WHERE</span> <span class="type">KEY</span>(p) <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%egret</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above query the identification
variable <em>p</em> designates an abstract schema type corresponding to the map
<em>value</em>. The results of <em>VALUE(p)</em> and <em>KEY(p)</em> are the map value and
the map key associated with <em>p</em>, respectively. The following query is
equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> i.name, p
<span class="keyword">FROM</span> Item i <span class="keyword">JOIN</span> i.photos p
<span class="keyword">WHERE</span> <span class="type">KEY</span>(p) <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%egret</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A path expression using the KEY or VALUE
operator can be further composed. A path expression using the ENTRY
operator is terminal. It cannot be further composed and can only appear
in the SELECT list of a query.</p>
</div>
<div class="paragraph">
<p>The syntax for qualified identification variables is as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>qualified_identification_variable ::=
    map_field_identification_variable |
    ENTRY(identification_variable)

map_field_identification_variable ::=
    KEY(identification_variable) |
    VALUE(identification_variable)</pre>
</div>
</div>
<div class="paragraph">
<p>Depending on navigability, a path expression
that leads to an association field or to a field whose type is an
embeddable class may be further composed. Path expressions can be
composed from other path expressions if the original path expression
evaluates to a single-valued type (not a collection).</p>
</div>
<div class="paragraph">
<p>In the following example, <em>contactInfo</em>
denotes an embeddable class consisting of an address and set of phones.
<em>Phone</em> is an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo.phones p
<span class="keyword">WHERE</span> e.contactInfo.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Path expression navigability is composed
using “inner join” semantics. That is, if the value of a non-terminal
field in the path expression is null, the path is considered to have no
value, and does not participate in the determination of the result.</p>
</div>
<div class="paragraph">
<p>The following query is equivalent to the
query above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo c <span class="keyword">JOIN</span> c.phones p
<span class="keyword">WHERE</span> e.contactInfo.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="path-expression-syntax"><a class="anchor" href="#path-expression-syntax"></a>4.4.4.1. Path Expression Syntax</h5>
<div class="paragraph">
<p>The syntax for single-valued path expressions
and collection-valued path expressions is as follows.</p>
</div>
<div class="paragraph">
<p>An identification variable used in a
<em>single_valued_object_path_expression</em> or in a
<em>collection_valued_path_expression</em> may be an unqualified identification
variable or an identification variable to which the KEY or VALUE
function has been applied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>general_identification_variable ::=
    identification_variable |
    map_field_identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>The type of an entity-valued path expression
or an entity-valued subpath of a path expression used in a WHERE clause
may be specified as a subtype of the corresponding declared type by
means of the TREAT operator. See <a href="#a4965">Section 4.4.9</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>general_subpath ::= simple_subpath | treated_subpath{.single_valued_object_field}*

simple_subpath ::=
    general_identification_variable |
    general_identification_variable{.single_valued_object_field}*

treated_subpath ::= TREAT(general_subpath AS subtype)

single_valued_path_expression ::=
    qualified_identification_variable |
    TREAT(qualified_identification_variable AS subtype) |
    state_field_path_expression |
    single_valued_object_path_expression

state_field_path_expression ::= general_subpath.state_field

state_valued_path_expression ::= state_field_path_expression | general_identification_variable

single_valued_object_path_expression ::= general_subpath.single_valued_object_field

collection_valued_path_expression ::= general_subpath.collection_valued_field</pre>
</div>
</div>
<div class="paragraph">
<p>A <em>single_valued_object_field</em> is designated by the name of an association
field in a one-to-one or many-to-one relationship or a field of
embeddable class type. The type of a <em>single_valued_object_field</em>
is the abstract schema type of the related
entity or embeddable class.</p>
</div>
<div class="paragraph">
<p>A <em>state _field</em> is designated by the name of
an entity or embeddable class state field that corresponds to a basic
type.</p>
</div>
<div class="paragraph">
<p>A <em>collection_valued_field</em> is designated by the name of an association
field in a one-to-many or a many-to-many relationship or by the name of
an element collection field. The type of a <em>collection_valued_field</em> is
a collection of values of the abstract schema type of the related entity
or element type.</p>
</div>
<div class="paragraph">
<p>It is syntactically illegal to compose a path
expression from a path expression that evaluates to a collection. For
example, if o designates Order, the path expression o.lineItems.product
is illegal since navigation to <em>lineItems</em> results in a collection. This
case should produce an error when the query string is verified. To
handle such a navigation, an identification variable must be declared in
the FROM clause to range over the elements of the <em>lineItems</em>
collection. Another path expression must be used to navigate over each
such element in the WHERE clause of the query, as in the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> l.product
<span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> o <span class="keyword">JOIN</span> o.lineItems l</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is illegal to use a
<em>collection_valued_path_expression</em> other than in the FROM clause of a
query except in an <em>empty_collection_comparison_expression,</em> in a
<em>collection_member_expression</em>, or as an argument to the SIZE operator.
See <a href="#a5139">Section 4.6.12</a>, <a href="#a5150">Section 4.6.13</a>, and <a href="#a5284">Section 4.6.17.2.2</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="joins"><a class="anchor" href="#joins"></a>4.4.5. Joins</h4>
<div class="paragraph">
<p>An inner join may be implicitly specified by
the use of a cartesian product in the FROM clause and a join condition
in the WHERE clause. In the absence of a join condition, this reduces to
the cartesian product.</p>
</div>
<div class="paragraph">
<p>The main use case for this generalized style
of join is when a join condition does not involve a foreign key
relationship that is mapped to an entity relationship.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c, Employee e <span class="keyword">WHERE</span> c.hatsize = e.shoesize</code></pre>
</div>
</div>
<div class="paragraph">
<p>In general, use of this style of inner join
(also referred to as theta-join) is less typical than explicitly defined
joins over relationships.</p>
</div>
<div class="paragraph">
<p>The syntax for explicit join operations is as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>join ::= join_spec join_association_path_expression [AS] identification_variable [join_condition]

fetch_join ::= join_spec FETCH join_association_path_expression

join_association_path_expression ::=
    join_collection_valued_path_expression |
    join_single_valued_path_expression |
    TREAT(join_collection_valued_path_expression _AS_ subtype) |
    TREAT(join_single_valued_path_expression AS subtype)

join_collection_valued_path_expression ::=
    identification_variable.{single_valued_embeddable_object_field.}*collection_valued_field

join_single_valued_path_expression ::=
    identification_variable.{single_valued_embeddable_object_field.}*single_valued_object_field

join_spec ::= [LEFT [OUTER] | INNER] JOIN

join_condition ::= ON conditional_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The inner and outer join operation types
described in <a href="#a4884">Section 4.4.5.1</a>, <a href="#a4898">Section 4.4.5.2</a>, and <a href="#a4931">Section 4.4.5.3</a> are supported.</p>
</div>
<div class="sect4">
<h5 id="a4884"><a class="anchor" href="#a4884"></a>4.4.5.1. Inner Joins (Relationship Joins)</h5>
<div class="paragraph">
<p>The syntax for the inner join operation is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[INNER] JOIN join_association_path_expression [AS] identification_variable [join_condition]</pre>
</div>
</div>
<div class="paragraph">
<p>For example, the query below joins over the
relationship between customers and orders. This type of join typically
equates to a join over a foreign key relationship in the database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The keyword INNER may optionally be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c <span class="keyword">INNER</span> <span class="keyword">JOIN</span> c.orders o <span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is equivalent to the following query
using the earlier IN construct, defined in
<a href="#a19497">[4]</a>. It selects those customers of
status 1 for which at least one order exists:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> OBJECT(c) <span class="keyword">FROM</span> Customer c, <span class="keyword">IN</span>(c.orders) o <span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The query below joins over <em>Employee</em>,
<em>ContactInfo</em> and <em>Phone</em>. <em>ContactInfo</em> is an embeddable class that
consists of an address and set of phones. <em>Phone</em> is an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo c <span class="keyword">JOIN</span> c.phones p
<span class="keyword">WHERE</span> c.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A join condition may be specified for an
inner join. This is equivalent to specification of the same condition in
the WHERE clause.</p>
</div>
</div>
<div class="sect4">
<h5 id="a4898"><a class="anchor" href="#a4898"></a>4.4.5.2. Left Outer Joins</h5>
<div class="paragraph">
<p>LEFT JOIN and LEFT OUTER JOIN are synonymous.
They enable the retrieval of a set of entities where matching values in
the join condition may be absent.</p>
</div>
<div class="paragraph">
<p>The syntax for a left outer join is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>LEFT [OUTER] JOIN join_association_path_expression [AS] identification_variable [join_condition]</pre>
</div>
</div>
<div class="paragraph">
<p>An outer join without a specified join
condition has an implicit join condition over the foreign key
relationship corresponding to the join_association_path_expression. It
would typically be mapped to a SQL outer join with an ON condition on
the foreign key relationship as in the queries below:</p>
</div>
<div class="paragraph">
<p>Jakarta Persistence query language:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> s.products p
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p.id)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Products p
    <span class="keyword">ON</span> s.id = p.supplierId
<span class="keyword">GROUP</span> <span class="keyword">By</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>An outer join with an explicit ON condition
would cause an additional specified join condition to be added to the
generated SQL:</p>
</div>
<div class="paragraph">
<p>Jakarta Persistence query language:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> s.products p
    <span class="keyword">ON</span> p.status = <span class="string"><span class="delimiter">'</span><span class="content">inStock</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p.id)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Products p
    <span class="keyword">ON</span> s.id = p.supplierId <span class="keyword">AND</span> p.status = <span class="string"><span class="delimiter">'</span><span class="content">inStock</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the result of this query will be
different from that of the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> s.products p
<span class="keyword">WHERE</span> p.status = <span class="string"><span class="delimiter">'</span><span class="content">inStock</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of the latter query will exclude
suppliers who have no products in stock whereas the former query will
include them.</p>
</div>
<div class="paragraph">
<p>An important use case for LEFT JOIN is in
enabling the prefetching of related data items as a side effect of a
query. This is accomplished by specifying the LEFT JOIN as a FETCH JOIN
as described below.</p>
</div>
</div>
<div class="sect4">
<h5 id="a4931"><a class="anchor" href="#a4931"></a>4.4.5.3. Fetch Joins</h5>
<div class="paragraph">
<p>A FETCH JOIN enables the fetching of an
association or element collection as a side effect of the execution of a
query.</p>
</div>
<div class="paragraph">
<p>The syntax for a fetch join is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>fetch_join ::= [LEFT [OUTER] | INNER] JOIN FETCH join_association_path_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The association referenced by the right side
of the FETCH JOIN clause must be an association or element collection
that is referenced from an entity or embeddable that is returned as a
result of the query. It is not permitted to specify an identification
variable for the objects referenced by the right side of the FETCH JOIN
clause, and hence references to the implicitly fetched entities or
elements cannot appear elsewhere in the query.</p>
</div>
<div class="paragraph">
<p>The following query returns a set of
departments. As a side effect, the associated employees for those
departments are also retrieved, even though they are not part of the
explicit query result. The initialization of the persistent state or
relationship fields or properties of the objects that are retrieved as a
result of a fetch join is determined by the metadata for that class—in
this example, the <em>Employee</em> entity class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Department d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> FETCH d.employees
<span class="keyword">WHERE</span> d.deptno = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A fetch join has the same join semantics as
the corresponding inner or outer join, except that the related objects
specified on the right-hand side of the join operation are not returned
in the query result or otherwise referenced in the query. Hence, for
example, if department 1 has five employees, the above query returns
five references to the department 1 entity.</p>
</div>
<div class="paragraph">
<p>The FETCH JOIN construct must not be used in
the FROM clause of a subquery.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="collection-member-declarations"><a class="anchor" href="#collection-member-declarations"></a>4.4.6. Collection Member Declarations</h4>
<div class="paragraph">
<p>An identification variable declared by a
collection_member_declaration ranges over values of a collection
obtained by navigation using a path expression.</p>
</div>
<div class="paragraph">
<p>An identification variable of a collection
member declaration is declared using a special operator, the reserved
identifier IN. The argument to the IN operator is a collection-valued
path expression. The path expression evaluates to a collection type
specified as a result of navigation to a collection-valued association
field of an entity or embeddable class abstract schema type.</p>
</div>
<div class="paragraph">
<p>The syntax for declaring a collection member
identification variable is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>collection_member_declaration ::=
    IN (collection_valued_path_expression) [AS] identification_variable</pre>
</div>
</div>
<div class="paragraph">
<p>For example, the query</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l
<span class="keyword">WHERE</span> l.product.productType = <span class="string"><span class="delimiter">'</span><span class="content">office_supplies</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>can equivalently be expressed as follows, using the IN operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o, <span class="keyword">IN</span>(o.lineItems) l
<span class="keyword">WHERE</span> l.product.productType = <span class="string"><span class="delimiter">'</span><span class="content">office_supplies</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, lineItems is the name of an
association field whose value is a collection of instances of the
abstract schema type LineItem. The identification variable <em>l</em>
designates a member of this collection, a single LineItem abstract
schema type instance. In this example, <em>o</em> is an identification variable
of the abstract schema type Order.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4957"><a class="anchor" href="#a4957"></a>4.4.7. FROM Clause and SQL</h4>
<div class="paragraph">
<p>The Jakarta Persistence query language treats
the FROM clause similarly to SQL in that the declared identification
variables affect the results of the query even if they are not used in
the WHERE clause. Application developers should use caution in defining
identification variables because the domain of the query can depend on
whether there are any values of the declared type.</p>
</div>
<div class="paragraph">
<p>For example, the FROM clause below defines a
query over all orders that have line items and existing products. If
there are no <em>Product</em> instances in the database, the domain of the
query is empty and no order is selected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> l.product p</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="polymorphism"><a class="anchor" href="#polymorphism"></a>4.4.8. Polymorphism</h4>
<div class="paragraph">
<p>Jakarta Persistence queries are automatically
polymorphic. The FROM clause of a query designates not only instances of
the specific entity class(es) to which it explicitly refers but
instances of subclasses of those classes as well. The instances returned
by a query thus include instances of the subclasses that satisfy the
query criteria.</p>
</div>
<div class="paragraph">
<p>Non-polymorphic queries or queries whose
polymorphism is restricted can be specified using entity type
expressions in the WHERE clause to restrict the domain of the query. See
<a href="#a5381">Section 4.6.17.5</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="a4965"><a class="anchor" href="#a4965"></a>4.4.9. Downcasting</h4>
<div class="paragraph">
<p>The use of the TREAT operator is supported
for downcasting within path expressions in the FROM and WHERE clauses.
Use of the TREAT operator allows access to subclass-specific state.</p>
</div>
<div class="paragraph">
<p>If during query execution the first argument
to the TREAT operator is not a subtype (proper or improper) of the
target type, the path is considered to have no value, and does not
participate in the determination of the result. That is, in the case of
a join, the referenced object does not participate in the result, and in
the case of a restriction, the associated predicate is false. Use of the
TREAT operator therefore also has the effect of filtering on the
specified type (and its subtypes) as well as performing the downcast. If
the target type is not a subtype (proper or improper) of the static type
of the first argument, the query is invalid.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> b.name, b.ISBN
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> TREAT(o.product <span class="keyword">AS</span> Book) b

<span class="class">SELECT</span> e <span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> TREAT(e.projects <span class="keyword">AS</span> LargeProject) lp
<span class="keyword">WHERE</span> lp.budget &gt; <span class="integer">1000</span>

<span class="class">SELECT</span> e <span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.projects p
<span class="keyword">WHERE</span> TREAT(p <span class="keyword">AS</span> LargeProject).budget &gt; <span class="integer">1000</span>
    <span class="keyword">OR</span> TREAT(p <span class="keyword">AS</span> SmallProject).name <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">Persist%</span><span class="delimiter">'</span></span>
    <span class="keyword">OR</span> p.description <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">cost overrun</span><span class="delimiter">&quot;</span></span>

<span class="class">SELECT</span> e <span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TREAT(e <span class="keyword">AS</span> Exempt).vacationDays &gt; <span class="integer">10</span>
    <span class="keyword">OR</span> TREAT(e <span class="keyword">AS</span> Contractor).hours &gt; <span class="integer">100</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a4985"><a class="anchor" href="#a4985"></a>4.5. WHERE Clause</h3>
<div class="paragraph">
<p>The WHERE clause of a query consists of a
conditional expression used to select objects or values that satisfy the
expression. The WHERE clause restricts the result of a select statement
or the scope of an update or delete operation.</p>
</div>
<div class="paragraph">
<p>A WHERE clause is defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>where_clause ::= WHERE conditional_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The GROUP BY construct enables the
aggregation of values according to the properties of an entity class.
The HAVING construct enables conditions to be specified that further
restrict the query result as restrictions upon the groups.</p>
</div>
<div class="paragraph">
<p>The syntax of the HAVING clause is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>having_clause ::= HAVING conditional_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The GROUP BY and HAVING constructs are
further discussed in <a href="#a5410">Section 4.7</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a4994"><a class="anchor" href="#a4994"></a>4.6. Conditional Expressions</h3>
<div class="paragraph">
<p>The following sections describe language
constructs that can be used in a conditional expression of the WHERE
clause, the HAVING clause, or in an ON condition.</p>
</div>
<div class="paragraph">
<p>State fields that are mapped in serialized
form or as lobs cannot be portably used in conditional
<sup class="footnote">[<a id="_footnoteref_60" class="footnote" href="#_footnotedef_60" title="View footnote.">60</a>]</sup>.</p>
</div>
<div class="sect3">
<h4 id="literals"><a class="anchor" href="#literals"></a>4.6.1. Literals</h4>
<div class="paragraph">
<p>A string literal is enclosed in single
quotes—for example: 'literal'. A string literal that includes a single
quote is represented by two single quotes—for example: 'literal''s'.
String literals in queries, like Java <em>String</em> literals, use unicode
character encoding. The use of Java escape notation is not supported in
query string literals.</p>
</div>
<div class="paragraph">
<p>Exact numeric literals support the use of
Java integer literal syntax as well as SQL exact numeric literal syntax.</p>
</div>
<div class="paragraph">
<p>Approximate literals support the use Java
floating point literal syntax as well as SQL approximate numeric literal
syntax.</p>
</div>
<div class="paragraph">
<p>Appropriate suffixes can be used to indicate
the specific type of a numeric literal in accordance with the Java
Language Specification. Support for the use of hexadecimal and octal
numeric literals is not required by this specification.</p>
</div>
<div class="paragraph">
<p>Enum literals support the use of Java enum
literal syntax. The fully qualified enum class name must be specified.</p>
</div>
<div class="paragraph">
<p>The JDBC escape syntax may be used for the
specification of date, time, and timestamp literals. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> c.name = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> o.submissionDate &lt; {d <span class="string"><span class="delimiter">'</span><span class="content">2008-12-31</span><span class="delimiter">'</span></span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The portability of this syntax for date,
time, and timestamp literals is dependent upon the JDBC driver in use.
Persistence providers are not required to translate from this syntax
into the native syntax of the database or driver.</p>
</div>
<div class="paragraph">
<p>The boolean literals are <em>TRUE</em> and <em>FALSE</em>.</p>
</div>
<div class="paragraph">
<p>Entity type literals are specified by entity names—for example: <em>Customer</em>.</p>
</div>
<div class="paragraph">
<p>Although reserved literals appear in upper case, they are case insensitive.</p>
</div>
</div>
<div class="sect3">
<h4 id="identification-variables"><a class="anchor" href="#identification-variables"></a>4.6.2. Identification Variables</h4>
<div class="paragraph">
<p>All identification variables used in the
WHERE or HAVING clause of a SELECT or DELETE statement must be declared
in the FROM clause, as described in <a href="#a4765">Section 4.4.2</a>. The identification variables used in the
WHERE clause of an UPDATE statement must be declared in the UPDATE
clause.</p>
</div>
<div class="paragraph">
<p>Identification variables are existentially
quantified in the WHERE and HAVING clause.
This means that an identification variable represents a member of a
collection or an instance of an entity&#8217;s abstract schema type. An
identification variable never designates a collection in its entirety.</p>
</div>
</div>
<div class="sect3">
<h4 id="path-expressions-2"><a class="anchor" href="#path-expressions-2"></a>4.6.3. Path Expressions</h4>
<div class="paragraph">
<p>It is illegal to use a
<em>collection_valued_path_expression</em> within a WHERE or HAVING clause as
part of a conditional expression except in an
<em>empty_collection_comparison_expression,</em> in a
<em>collection_member_expression</em>, or as an argument to the SIZE operator.</p>
</div>
</div>
<div class="sect3">
<h4 id="input-parameters"><a class="anchor" href="#input-parameters"></a>4.6.4. Input Parameters</h4>
<div class="paragraph">
<p>Either positional or named parameters may be
used. Positional and named parameters must not be mixed in a single
query.</p>
</div>
<div class="paragraph">
<p>Input parameters can only be used in the
WHERE clause or HAVING clause of a query or
as the new value for an update item in the SET clause of an update
statement.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that if an input parameter value is
null, comparison operations or arithmetic operations involving the input
parameter will return an unknown value. See <a href="#a5676">Section 4.11</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All input parameters must be single-valued,
except in IN expressions (see <a href="#a5107">Section 4.6.9</a>), which support the use of collection-valued input
parameters.</p>
</div>
<div class="paragraph">
<p>The API for the binding of query parameters
is described in <a href="#a1060">Chapter 3</a>.</p>
</div>
<div class="sect4">
<h5 id="positional-parameters"><a class="anchor" href="#positional-parameters"></a>4.6.4.1. Positional Parameters</h5>
<div class="paragraph">
<p>The following rules apply to positional
parameters.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Input parameters are designated by the
question mark (<em>?</em>) prefix followed by an integer. For example: <em>?1</em>.</p>
</li>
<li>
<p>Input parameters are numbered starting from 1.</p>
</li>
<li>
<p>The same parameter can be used more than once in the query string.</p>
</li>
<li>
<p>The ordering of the use of parameters within
the query string need not conform to the order of the positional
parameters.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="named-parameters"><a class="anchor" href="#named-parameters"></a>4.6.4.2. Named Parameters</h5>
<div class="paragraph">
<p>A named parameter is denoted by an identifier
that is prefixed by the ":" symbol. It follows the rules for identifiers
defined in <a href="#a4760">Section 4.4.1</a>. Named parameters are case sensitive.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> c.status = :stat</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same named parameter can be used more than once in the query string.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="conditional-expression-composition"><a class="anchor" href="#conditional-expression-composition"></a>4.6.5. Conditional Expression Composition</h4>
<div class="paragraph">
<p>Conditional expressions are composed of other
conditional expressions, comparison operations, logical operations, path
expressions that evaluate to boolean values, boolean literals, and
boolean input parameters.</p>
</div>
<div class="paragraph">
<p>The scalar expressions described in <a href="#a5243">Section 4.6.17</a> can be used in
conditional expressions.</p>
</div>
<div class="paragraph">
<p>Aggregate functions can only be used in
conditional expressions in a HAVING clause. See <a href="#a5410">Section 4.7</a>.</p>
</div>
<div class="paragraph">
<p>Standard bracketing <em>()</em> for ordering expression evaluation is supported.</p>
</div>
<div class="paragraph">
<p>Conditional expressions are defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>conditional_expression ::= conditional_term | conditional_expression OR conditional_term
conditional_term ::= conditional_factor | conditional_term AND conditional_factor
conditional_factor ::= [NOT] conditional_primary
conditional_primary ::= simple_cond_expression | (conditional_expression)
simple_cond_expression ::=
    comparison_expression |
    between_expression |
    in_expression |
    like_expression |
    null_comparison_expression |
    empty_collection_comparison_expression |
    collection_member_expression |
    exists_expression</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="operators-and-operator-precedence"><a class="anchor" href="#operators-and-operator-precedence"></a>4.6.6. Operators and Operator Precedence</h4>
<div class="paragraph">
<p>The operators are listed below in order of decreasing precedence.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Navigation operator (<em>.</em>)</p>
</li>
<li>
<p>Arithmetic operators:</p>
<div class="ulist">
<ul>
<li>
<p>+, - unary</p>
</li>
<li>
<p>*, / multiplication and division</p>
</li>
<li>
<p>+, - addition and subtraction</p>
</li>
</ul>
</div>
</li>
<li>
<p>Comparison operators: <em>=</em>, <em>&gt;</em>, <em>&gt;=</em>, <em>&lt;</em>
, <em>&#8656;</em>, <em>&lt;&gt;</em> (not equal), <em>[NOT]</em> <em>BETWEEN</em>, <em>[NOT]</em> <em>LIKE</em>, <em>[NOT]</em>
<em>IN</em>, <em>IS</em> <em>[NOT]</em> <em>NULL</em>, <em>IS</em> <em>[NOT]</em> <em>EMPTY</em>, <em>[NOT]</em> <em>MEMBER</em>
<em>[OF]</em>, <em>[NOT]</em> <em>EXISTS</em></p>
</li>
<li>
<p>Logical operators:</p>
<div class="ulist">
<ul>
<li>
<p><em>NOT</em></p>
</li>
<li>
<p><em>AND</em></p>
</li>
<li>
<p><em>OR</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections describe operators used in specific expressions.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5066"><a class="anchor" href="#a5066"></a>4.6.7. Comparison Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of comparison
expressions in a conditional expression is as
follows<sup class="footnote">[<a id="_footnoteref_61" class="footnote" href="#_footnotedef_61" title="View footnote.">61</a>]</sup>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>comparison_expression ::=
    string_expression comparison_operator {string_expression | all_or_any_expression} |
    boolean_expression {= | &lt;&gt;} {boolean_expression | all_or_any_expression} |
    enum_expression {= | &lt;&gt;} {enum_expression | all_or_any_expression} |
    datetime_expression comparison_operator
        {datetime_expression | all_or_any_expression} |
    entity_expression {= | &lt;&gt;} {entity_expression | all_or_any_expression} |
    arithmetic_expression comparison_operator
        {arithmetic_expression | all_or_any_expression} |
    entity_type_expression {= | &lt;&gt;} entity_type_expression}

comparison_operator ::= = | &gt; | &gt;= | &lt; | &lt;= | &lt;&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>item.cost * 1.08 &lt;= 100.00
CONCAT(person.lastName, ', ', person.firstName)) = 'Jones, Sam'
TYPE(e) = ExemptEmployee</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="between-expressions"><a class="anchor" href="#between-expressions"></a>4.6.8. Between Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison operator [NOT] BETWEEN in a
conditional expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> between_expression ::=
    arithmetic_expression [NOT] BETWEEN arithmetic_expression AND arithmetic_expression |
    string_expression [NOT] BETWEEN string_expression AND string_expression |
    datetime_expression [NOT] BETWEEN datetime_expression AND datetime_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The BETWEEN expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x BETWEEN y AND z</pre>
</div>
</div>
<div class="paragraph">
<p>is semantically equivalent to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>y &lt;= x AND x &lt;= z</pre>
</div>
</div>
<div class="paragraph">
<p>The rules for unknown and NULL values in
comparison operations apply. See <a href="#a5676">Section 4.11</a>.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>p.age BETWEEN 15 and 19 is equivalent to p.age &gt;= 15 AND p.age &lt;= 19
p.age NOT BETWEEN 15 and 19 is equivalent to p.age &lt; 15 OR p.age &gt; 19</pre>
</div>
</div>
<div class="paragraph">
<p>In the following example,
<em>transactionHistory</em> is a list of credit card transactions defined using
an order column.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> t
<span class="keyword">FROM</span> CreditCard c <span class="keyword">JOIN</span> c.transactionHistory t
<span class="keyword">WHERE</span> c.holder.name = <span class="string"><span class="delimiter">'</span><span class="content">John Doe</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> <span class="type">INDEX</span>(t) <span class="keyword">BETWEEN</span> <span class="integer">0</span> <span class="keyword">AND</span> <span class="integer">9</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a5107"><a class="anchor" href="#a5107"></a>4.6.9. In Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator [NOT] IN in a conditional expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>in_expression ::=
    {state_valued_path_expression | type_discriminator} [NOT] IN
        {(in_item {, in_item}*) | (subquery) | collection_valued_input_parameter}
in_item ::= literal | single_valued_input_parameter</pre>
</div>
</div>
<div class="paragraph">
<p>The state_valued_path_expression must have
a string, numeric, date, time, timestamp, or enum value.</p>
</div>
<div class="paragraph">
<p>The literal and/or input parameter values
must be <em>like</em> the same abstract schema type of the
<em>state_valued_path_expression</em> in type. (See <a href="#a5735">Section 4.12</a>).</p>
</div>
<div class="paragraph">
<p>The results of the subquery must be <em>like</em>
the same abstract schema type of the state_valued_path_expression in
type. Subqueries are discussed in <a href="#a5196">Section 4.6.16</a>.</p>
</div>
<div class="paragraph">
<p>Example 1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">o.country <span class="keyword">IN</span> (<span class="string"><span class="delimiter">'</span><span class="content">UK</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">US</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">France</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>is true for <em>UK</em> and false for <em>Peru</em>, and is equivalent to the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">(o.country = <span class="string"><span class="delimiter">'</span><span class="content">UK</span><span class="delimiter">'</span></span>) <span class="keyword">OR</span> (o.country = <span class="string"><span class="delimiter">'</span><span class="content">US</span><span class="delimiter">'</span></span>) <span class="keyword">OR</span> (o.country = <span class="string"><span class="delimiter">'</span><span class="content">France</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 2:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">o.country <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="string"><span class="delimiter">'</span><span class="content">UK</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">US</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">France</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>is false for <em>UK</em> and true for <em>Peru</em>, and is equivalent to the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="keyword">NOT</span> ((o.country = <span class="string"><span class="delimiter">'</span><span class="content">UK</span><span class="delimiter">'</span></span>) <span class="keyword">OR</span> (o.country = <span class="string"><span class="delimiter">'</span><span class="content">US</span><span class="delimiter">'</span></span>) <span class="keyword">OR</span> (o.country = <span class="string"><span class="delimiter">'</span><span class="content">France</span><span class="delimiter">'</span></span>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>There must be at least one element in the
comma separated list that defines the set of values for the <em>IN</em>
expression.</p>
</div>
<div class="paragraph">
<p>If the value of a
state_valued_path_expression or <em>in_item</em> in an IN or NOT IN expression
is <em>NULL</em> or unknown, the value of the expression is unknown.</p>
</div>
<div class="paragraph">
<p>Note that use of a collection-valued input
parameter will mean that a static query cannot be precompiled.</p>
</div>
</div>
<div class="sect3">
<h4 id="like-expressions"><a class="anchor" href="#like-expressions"></a>4.6.10. Like Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator [NOT] LIKE in a conditional expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>like_expression ::=
    string_expression [NOT] LIKE pattern_value [ESCAPE escape_character]</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>string_expression</em> must have a string
value. The <em>pattern_value</em> is a string literal or a string-valued input
parameter in which an underscore (<em><em>) stands for any single
character, a percent (</em>%<em>) character stands for any sequence of
characters (including the empty sequence), and all other characters
stand for themselves. The optional _escape_character</em> </em> is a
single-character string literal or a character-valued input parameter
(i.e., <em>char</em> or <em>Character</em>) and is used to escape the special meaning
of the underscore and percent characters in <em>pattern_value</em>
_.<sup class="footnote">[<a id="_footnoteref_62" class="footnote" href="#_footnotedef_62" title="View footnote.">62</a>]</sup></a> for a more precise characterization of these rules.]</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>address.phone LIKE '12%3'</em> is true for '123', '12993' and false for '1234'</p>
</li>
<li>
<p><em>asentence.word LIKE 'l_se'</em> is true for 'lose' and false for 'loose'</p>
</li>
<li>
<p><em>aword.underscored LIKE '\</em>%' ESCAPE '\'_ is true for '_foo' and false for 'bar'</p>
</li>
<li>
<p><em>address.phone NOT LIKE '12%3'</em> is false for '123' and '12993' and true for '1234'</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the value of the <em>string_expression</em> or
<em>pattern_value</em> is <em>NULL</em> or unknown, the value of the LIKE expression
is unknown. If the <em>escape_character</em> is specified and is <em>NULL</em>, the
value of the LIKE expression is unknown.</p>
</div>
</div>
<div class="sect3">
<h4 id="null-comparison-expressions"><a class="anchor" href="#null-comparison-expressions"></a>4.6.11. Null Comparison Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator IS NULL in a conditional expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>null_comparison_expression ::=
    {single_valued_path_expression | input_parameter} IS [NOT] NULL</pre>
</div>
</div>
<div class="paragraph">
<p>A null comparison expression tests whether or
not the single-valued path expression or input parameter is a <em>NULL</em>
value.</p>
</div>
<div class="paragraph">
<p>Null comparisons over instances of embeddable
class types are not supported. Support for comparisons over embeddables
may be added in a future release of this specification.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5139"><a class="anchor" href="#a5139"></a>4.6.12. Empty Collection Comparison Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator IS EMPTY in an <em>empty_collection_comparison_expression</em> is as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>empty_collection_comparison_expression ::=
    collection_valued_path_expression IS [NOT] EMPTY</pre>
</div>
</div>
<div class="paragraph">
<p>This expression tests whether or not the
collection designated by the collection-valued path expression is empty
(i.e, has no elements).</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.lineItems <span class="keyword">IS</span> EMPTY</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the value of the collection-valued path
expression in an empty collection comparison expression is unknown, the
value of the empty comparison expression is unknown.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5150"><a class="anchor" href="#a5150"></a>4.6.13. Collection Member Expressions</h4>
<div class="paragraph">
<p>The syntax for the use of the comparison
operator MEMBER OF<sup class="footnote">[<a id="_footnoteref_63" class="footnote" href="#_footnotedef_63" title="View footnote.">63</a>]</sup> in an
<em>collection_member_expression</em> is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>collection_member_expression ::=
    entity_or_value_expression [NOT] MEMBER [OF] collection_valued_path_expression
entity_or_value_expression ::=
    single_valued_object_path_expression |
    state_valued_path_expression |
    simple_entity_or_value_expression
simple_entity_or_value_expression ::=
    identification_variable |
    input_parameter |
    literal</pre>
</div>
</div>
<div class="paragraph">
<p>This expression tests whether the designated
value is a member of the collection specified by the collection-valued
path expression.</p>
</div>
<div class="paragraph">
<p>Expressions that evaluate to embeddable types
are not supported in collection member expressions. Support for use of
embeddables in collection member expressions may be added in a future
release of this specification.</p>
</div>
<div class="paragraph">
<p>If the collection valued path expression
designates an empty collection, the value of the MEMBER OF expression is
FALSE and the value of the NOT MEMBER OF expression is TRUE. Otherwise,
if the value of the <em>collection_valued_path_expression</em>
or <em>entity_or_value_expression</em> in the
collection member expression is <em>NULL</em> or unknown, the value of the
collection member expression is unknown.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p
<span class="keyword">FROM</span> Person p
<span class="keyword">WHERE</span> <span class="string"><span class="delimiter">'</span><span class="content">Joe</span><span class="delimiter">'</span></span> MEMBER <span class="keyword">OF</span> p.nicknames</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="exists-expressions"><a class="anchor" href="#exists-expressions"></a>4.6.14. Exists Expressions</h4>
<div class="paragraph">
<p>An EXISTS expression is a predicate that is
true only if the result of the subquery consists of one or more values
and that is false otherwise.</p>
</div>
<div class="paragraph">
<p>The syntax of an exists expression is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>exists_expression ::= [NOT] EXISTS (subquery)</pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (
    <span class="class">SELECT</span> spouseEmp
    <span class="keyword">FROM</span> Employee spouseEmp
        <span class="keyword">WHERE</span> spouseEmp = emp.spouse)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of this query consists of all
employees whose spouses are also employees.</p>
</div>
</div>
<div class="sect3">
<h4 id="all-or-any-expressions"><a class="anchor" href="#all-or-any-expressions"></a>4.6.15. All or Any Expressions</h4>
<div class="paragraph">
<p>An ALL conditional expression is a predicate
over a subquery that is true if the comparison operation is true for all
values in the result of the subquery or the result of the subquery is
empty. An ALL conditional expression is false if the result of the
comparison is false for at least one value of the result of the
subquery, and is unknown if neither true nor false.</p>
</div>
<div class="paragraph">
<p>An ANY conditional expression is a predicate
over a subquery that is true if the comparison operation is true for
some value in the result of the subquery. An ANY conditional expression
is false if the result of the subquery is empty or if the comparison
operation is false for every value in the result of the subquery, and is
unknown if neither true nor false. The keyword SOME is synonymous with
ANY.</p>
</div>
<div class="paragraph">
<p>The comparison operators used with ALL or ANY
conditional expressions are =, &lt;, &#8656;, &gt;, &gt;=, &lt;&gt;. The result of the
subquery must be like that of the other argument to the comparison
operator in type. See <a href="#a5735">Section 4.12</a>.</p>
</div>
<div class="paragraph">
<p>The syntax of an ALL or ANY expression is
specified as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>all_or_any_expression ::= {ALL | ANY | SOME} (subquery)</pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> emp.salary &gt; <span class="keyword">ALL</span> (
    <span class="class">SELECT</span> m.salary
    <span class="keyword">FROM</span> Manager m
    <span class="keyword">WHERE</span> m.department = emp.department)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of this query consists of all
employees whose salaries exceed the salaries of all managers in their
department.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5196"><a class="anchor" href="#a5196"></a>4.6.16. Subqueries</h4>
<div class="paragraph">
<p>Subqueries may be used in the WHERE or HAVING clause.<sup class="footnote">[<a id="_footnoteref_64" class="footnote" href="#_footnotedef_64" title="View footnote.">64</a>]</sup></p>
</div>
<div class="paragraph">
<p>The syntax for subqueries is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>subquery ::= simple_select_clause subquery_from_clause [where_clause]
    [groupby_clause] [having_clause]
simple_select_clause ::= SELECT [DISTINCT] simple_select_expression
subquery_from_clause ::=
    FROM subselect_identification_variable_declaration
        {, subselect_identification_variable_declaration |
            collection_member_declaration}*
subselect_identification_variable_declaration ::=
    identification_variable_declaration |
    derived_path_expression [AS] identification_variable {join}* |
    derived_collection_member_declaration
simple_select_expression ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable
derived_path_expression ::=
    general_derived_path.single_valued_object_field |
    general_derived_path.collection_valued_field
general_derived_path ::=
    simple_derived_path |
    treated_derived_path{.single_valued_object_field}*
simple_derived_path ::= superquery_identification_variable{.single_valued_object_field}*
treated_derived_path ::= TREAT(general_derived_path AS subtype)
derived_collection_member_declaration ::=
    IN superquery_identification_variable.{single_valued_object_field.}*collection_valued_field</pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (
    <span class="class">SELECT</span> spouseEmp
    <span class="keyword">FROM</span> Employee spouseEmp
    <span class="keyword">WHERE</span> spouseEmp = emp.spouse)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that some contexts in which a subquery
can be used require that the subquery be a scalar subquery (i.e.,
produce a single result). This is illustrated in the following examples
using numeric comparisons.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> (<span class="class">SELECT</span> <span class="predefined">AVG</span>(o.price) <span class="keyword">FROM</span> c.orders o) &gt; <span class="integer">100</span>

<span class="class">SELECT</span> goodCustomer
<span class="keyword">FROM</span> Customer goodCustomer
<span class="keyword">WHERE</span> goodCustomer.balanceOwed &lt; (
    <span class="class">SELECT</span> <span class="predefined">AVG</span>(c.balanceOwed)/<span class="float">2.0</span> <span class="keyword">FROM</span> Customer c)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a5243"><a class="anchor" href="#a5243"></a>4.6.17. Scalar Expressions</h4>
<div class="paragraph">
<p>Numeric, string, datetime, case, and entity
type expressions result in scalar values.</p>
</div>
<div class="paragraph">
<p>Scalar expressions may be used in the SELECT
clause of a query as well as in the WHERE<sup class="footnote">[<a id="_footnoteref_65" class="footnote" href="#_footnotedef_65" title="View footnote.">65</a>]</sup> and
HAVING clauses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>scalar_expression::=
    arithmetic_expression |
    string_expression |
    enum_expression |
    datetime_expression |
    boolean_expression |
    case_expression |
    entity_type_expression</pre>
</div>
</div>
<div class="sect4">
<h5 id="arithmetic-expressions"><a class="anchor" href="#arithmetic-expressions"></a>4.6.17.1. Arithmetic Expressions</h5>
<div class="paragraph">
<p>The arithmetic operators are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>+, - unary</p>
</li>
<li>
<p>*, / multiplication and division</p>
</li>
<li>
<p>+, - addition and subtraction</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Arithmetic operations use numeric promotion.</p>
</div>
<div class="paragraph">
<p>Arithmetic functions are described in <a href="#a5284">Section 4.6.17.2.2</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="built-in-string-arithmetic-and-datetime-functional-expressions"><a class="anchor" href="#built-in-string-arithmetic-and-datetime-functional-expressions"></a>4.6.17.2. Built-in String, Arithmetic, and Datetime Functional Expressions</h5>
<div class="paragraph">
<p>The Jakarta Persistence query language includes
the built-in functions described in <a href="#a5264">Section 4.6.17.2.1</a>, <a href="#a5284">Section 4.6.17.2.2</a>,
<a href="#a5304">Section 4.6.17.2.3</a>, which may be used
in the SELECT, WHERE or HAVING clause of a query. The invocation of
predefined database functions and user-defined database functions is
described in <a href="#a5311">Section 4.6.17.3</a>.</p>
</div>
<div class="paragraph">
<p>If the value of any argument to a functional
expression is null or unknown, the value of the functional expression is
unknown.</p>
</div>
<div class="sect5">
<h6 id="a5264"><a class="anchor" href="#a5264"></a>String Functions</h6>
<div class="listingblock">
<div class="content">
<pre>functions_returning_strings ::=
    CONCAT(string_expression, string_expression {, string_expression}*) |
    SUBSTRING(string_expression,
              arithmetic_expression [, arithmetic_expression]) |
    TRIM([[trim_specification] [trim_character] FROM] string_expression) |
    LOWER(string_expression) |
    UPPER(string_expression)
trim_specification ::= LEADING | TRAILING | BOTH

functions_returning_numerics ::=
    LENGTH(string_expression) |
    LOCATE(string_expression, string_expression[, arithmetic_expression])</pre>
</div>
</div>
<div class="paragraph">
<p>The CONCAT function returns a string that is
a concatenation of its arguments.</p>
</div>
<div class="paragraph">
<p>The second and third arguments of the
SUBSTRING function denote the starting position and length of the
substring to be returned. These arguments are integers. The third
argument is optional. If it is not specified, the substring from the
start position to the end of the string is returned. The first position
of a string is denoted by 1. The SUBSTRING function returns a string.</p>
</div>
<div class="paragraph">
<p>The TRIM function trims the specified
character from a string. If the character to be trimmed is not
specified, it will be assumed to be space (or blank). The optional
<em>trim_character</em> <em>_ is a single-character string literal or a
character-valued input parameter (i.e., _char</em> or <em>Character</em>
)<sup class="footnote">[<a id="_footnoteref_66" class="footnote" href="#_footnotedef_66" title="View footnote.">66</a>]</sup>. If a trim specification is not provided, it
defaults to BOTH. The TRIM function returns the trimmed string.</p>
</div>
<div class="paragraph">
<p>The LOWER and UPPER functions convert a
string to lower and upper case, respectively, with regard to the locale
of the database. They return a string.</p>
</div>
<div class="paragraph">
<p>The LOCATE function returns the
position of a given string within a string, starting the search at a
specified position. It returns the first position at which the string
was found as an integer. The first argument is the string to be located;
the second argument is the string to be searched; the optional third
argument is an integer that represents the string position at which the
search is started (by default, the beginning of the string to be
searched). The first position in a string is denoted by 1. If the string
is not found, 0 is returned.<sup class="footnote">[<a id="_footnoteref_67" class="footnote" href="#_footnotedef_67" title="View footnote.">67</a>]</sup></p>
</div>
<div class="paragraph">
<p>The LENGTH function returns the length of the
string in characters as an integer.</p>
</div>
</div>
<div class="sect5">
<h6 id="a5284"><a class="anchor" href="#a5284"></a>Arithmetic Functions</h6>
<div class="listingblock">
<div class="content">
<pre>functions_returning_numerics ::=
    ABS(arithmetic_expression) |
    SQRT(arithmetic_expression) |
    MOD(arithmetic_expression, arithmetic_expression) |
    SIZE(collection_valued_path_expression) |
    INDEX(identification_variable)</pre>
</div>
</div>
<div class="paragraph">
<p>The ABS function takes a numeric argument and
returns a number (integer, float, or double) of the same type as the
argument to the function.</p>
</div>
<div class="paragraph">
<p>The SQRT function takes a numeric argument and returns a double.</p>
</div>
<div class="paragraph">
<p>The MOD function takes two integer arguments and returns an integer.</p>
</div>
<div class="paragraph">
<p>Numeric arguments to these functions may
correspond to the numeric Java object types as well as the primitive
numeric types.</p>
</div>
<div class="paragraph">
<p>The SIZE function returns an integer value,
the number of elements of the collection. If the collection is empty,
the SIZE function evaluates to zero.</p>
</div>
<div class="paragraph">
<p>The INDEX function returns an integer value
corresponding to the position of its argument in an ordered list. The
INDEX function can only be applied to identification variables denoting
types for which an order column has been specified.</p>
</div>
<div class="paragraph">
<p>In the following example, <em>studentWaitlist</em>
is a list of students for which an order column has been specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> w.name
<span class="keyword">FROM</span> Course c <span class="keyword">JOIN</span> c.studentWaitlist w
<span class="keyword">WHERE</span> c.name = <span class="string"><span class="delimiter">'</span><span class="content">Calculus</span><span class="delimiter">'</span></span>
<span class="keyword">AND</span> <span class="type">INDEX</span>(w) = <span class="integer">0</span></code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="a5304"><a class="anchor" href="#a5304"></a>Datetime Functions</h6>
<div class="listingblock">
<div class="content">
<pre>functions_returning_datetime :=
    CURRENT_DATE |
    CURRENT_TIME |
    CURRENT_TIMESTAMP</pre>
</div>
</div>
<div class="paragraph">
<p>The datetime functions return the value of
current date, time, and timestamp on the database server.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="a5311"><a class="anchor" href="#a5311"></a>4.6.17.3. Invocation of Predefined and User-defined Database Functions</h5>
<div class="paragraph">
<p>The invocation of functions other than the
built-in functions of the Jakarta Persistence query language is supported
by means of the <em>function_invocation</em> syntax. This includes the
invocation of predefined database functions and user-defined database
functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>function_invocation ::= FUNCTION(function_name {, function_arg}*)

function_arg ::=
    literal |
    state_valued_path_expression |
    input_parameter |
    scalar_expression</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>function_name</em> argument is a string that
denotes the database function that is to be invoked. The arguments must
be suitable for the database function that is to be invoked. The result
of the function must be suitable for the invocation context.</p>
</div>
<div class="paragraph">
<p>The function may be a database-defined
function or a user-defined function. The function may be a scalar
function or an aggregate function.</p>
</div>
<div class="paragraph">
<p>Applications that use the
<em>function_invocation</em> syntax will not be portable across databases.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> <span class="type">FUNCTION</span>(<span class="string"><span class="delimiter">'</span><span class="content">hasGoodCredit</span><span class="delimiter">'</span></span>, c.balance, c.creditLimit)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="case-expressions"><a class="anchor" href="#case-expressions"></a>4.6.17.4. Case Expressions</h5>
<div class="paragraph">
<p>The following forms of case
expressions are supported: general case expressions, simple case
expressions, coalesce expressions, and nullif
expressions.<sup class="footnote">[<a id="_footnoteref_68" class="footnote" href="#_footnotedef_68" title="View footnote.">68</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>case_expression ::=
    general_case_expression |
    simple_case_expression |
    coalesce_expression |
    nullif_expression

general_case_expression ::=
    CASE when_clause {when_clause}* ELSE scalar_expression END
when_clause ::= WHEN conditional_expression THEN scalar_expression

simple_case_expression ::=
    CASE case_operand simple_when_clause {simple_when_clause}*
    ELSE scalar_expression
    END
case_operand ::= state_valued_path_expression | type_discriminator
simple_when_clause ::= WHEN scalar_expression THEN scalar_expression

coalesce_expression ::= COALESCE(scalar_expression {, scalar_expression}+)

nullif_expression ::= NULLIF(scalar_expression, scalar_expression)</pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.salary =
    <span class="keyword">CASE</span> <span class="keyword">WHEN</span> e.rating = <span class="integer">1</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.1</span>
         <span class="keyword">WHEN</span> e.rating = <span class="integer">2</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.05</span>
         <span class="keyword">ELSE</span> e.salary * <span class="float">1.01</span>
    <span class="keyword">END</span>

<span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.salary =
    <span class="keyword">CASE</span> e.rating <span class="keyword">WHEN</span> <span class="integer">1</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.1</span>
                  <span class="keyword">WHEN</span> <span class="integer">2</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.05</span>
                  <span class="keyword">ELSE</span> e.salary * <span class="float">1.01</span>
    <span class="keyword">END</span>

<span class="class">SELECT</span> e.name,
    <span class="keyword">CASE</span> TYPE(e) <span class="keyword">WHEN</span> Exempt <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Exempt</span><span class="delimiter">'</span></span>
                 <span class="keyword">WHEN</span> Contractor <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Contractor</span><span class="delimiter">'</span></span>
                 <span class="keyword">WHEN</span> Intern <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Intern</span><span class="delimiter">'</span></span>
                 <span class="keyword">ELSE</span> <span class="string"><span class="delimiter">'</span><span class="content">NonExempt</span><span class="delimiter">'</span></span>
    <span class="keyword">END</span>
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> e.dept.name = <span class="string"><span class="delimiter">'</span><span class="content">Engineering</span><span class="delimiter">'</span></span>

<span class="class">SELECT</span> e.name,
       f.name,
       CONCAT(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> f.annualMiles &gt; <span class="integer">50000</span> <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Platinum </span><span class="delimiter">'</span></span>
                   <span class="keyword">WHEN</span> f.annualMiles &gt; <span class="integer">25000</span> <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Gold </span><span class="delimiter">'</span></span>
                   <span class="keyword">ELSE</span> <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
              <span class="keyword">END</span>,
       <span class="string"><span class="delimiter">'</span><span class="content">Frequent Flyer</span><span class="delimiter">'</span></span>)
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.frequentFlierPlan f</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="a5381"><a class="anchor" href="#a5381"></a>4.6.17.5. Entity Type Expressions</h5>
<div class="paragraph">
<p>An entity type expression can be used to
restrict query polymorphism. The TYPE operator returns the exact type of
the argument.</p>
</div>
<div class="paragraph">
<p>The syntax of an entity type expression is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>entity_type_expression ::=
    type_discriminator |
    entity_type_literal |
    input_parameter
type_discriminator ::=
    TYPE(general_identification_variable |
         single_valued_object_path_expression |
         input_parameter)</pre>
</div>
</div>
<div class="paragraph">
<p>An entity_type_literal is designated by the entity name.</p>
</div>
<div class="paragraph">
<p>The Java class of the entity is used as an
input parameter to specify the entity type.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) <span class="keyword">IN</span> (Exempt, Contractor)

<span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) <span class="keyword">IN</span> (:empType1, :empType2)

<span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) <span class="keyword">IN</span> :empTypes

<span class="class">SELECT</span> TYPE(e)
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) &lt;&gt; Exempt</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a5410"><a class="anchor" href="#a5410"></a>4.7. GROUP BY, HAVING</h3>
<div class="paragraph">
<p>The GROUP BY construct enables the
aggregation of result values according to a set of properties. The
HAVING construct enables conditions to be specified that further
restrict the query result. Such conditions are restrictions upon the
groups.</p>
</div>
<div class="paragraph">
<p>The syntax of the GROUP BY and HAVING clauses is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>groupby_clause ::= GROUP BY groupby_item {, groupby_item}*
groupby_item ::= single_valued_path_expression | identification_variable

having_clause ::= HAVING conditional_expression</pre>
</div>
</div>
<div class="paragraph">
<p>If a query contains both a WHERE clause and a
GROUP BY clause, the effect is that of first applying the where clause,
and then forming the groups and filtering them according to the HAVING
clause. The HAVING clause causes those groups to be retained that
satisfy the condition of the HAVING clause.</p>
</div>
<div class="paragraph">
<p>The requirements for the SELECT clause when
GROUP BY is used follow those of SQL: namely, any item that appears in
the SELECT clause (other than as an aggregate function or as an argument
to an aggregate function) must also appear in the GROUP BY clause. In
forming the groups, null values are treated as the same for grouping
purposes.</p>
</div>
<div class="paragraph">
<p>Grouping by an entity is permitted. In this
case, the entity must contain no serialized state fields or lob-valued
state fields that are eagerly fetched. Grouping by an entity that
contains serialized state fields or lob-valued state fields is not
portable, since the implementation is permitted to eagerly fetch fields
or properties that have been specified as LAZY.</p>
</div>
<div class="paragraph">
<p>Grouping by embeddables is not supported.</p>
</div>
<div class="paragraph">
<p>The HAVING clause is used to filter over the
groups, and can contain aggregate functions over attributes included in
the groups and/or functions or other query language operators over the
attributes that are used for grouping. It is not required that an
aggregate function used in the HAVING clause also be used in the SELECT
clause.</p>
</div>
<div class="paragraph">
<p>If there is no GROUP BY clause and the HAVING
clause is used, the result is treated as a single group, and the select
list can only consist of aggregate functions. The use of HAVING in the
absence of GROUP BY is not required to be supported by an implementation
of this specification. Portable applications should not rely on HAVING
without the use of GROUP BY.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.status, <span class="predefined">AVG</span>(c.filledOrderCount), <span class="predefined">COUNT</span>(c)
<span class="keyword">FROM</span> Customer c
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c.status
<span class="keyword">HAVING</span> c.status <span class="keyword">IN</span> (<span class="integer">1</span>, <span class="integer">2</span>)

<span class="class">SELECT</span> c.country, <span class="predefined">COUNT</span>(c)
<span class="keyword">FROM</span> Customer c
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c.country
<span class="keyword">HAVING</span> <span class="predefined">COUNT</span>(c) &gt; <span class="integer">30</span>

<span class="class">SELECT</span> c, <span class="predefined">COUNT</span>(o)
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c
<span class="keyword">HAVING</span> <span class="predefined">COUNT</span>(o) &gt;= <span class="integer">5</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a5438"><a class="anchor" href="#a5438"></a>4.8. SELECT Clause</h3>
<div class="paragraph">
<p>The SELECT clause denotes the query result.
More than one value may be returned from the SELECT clause of a query.</p>
</div>
<div class="paragraph">
<p>The SELECT clause can contain one or more of
the following elements: an identification variable that ranges over an
abstract schema type, a single-valued path expression, a scalar
expression, an aggregate expression, a constructor expression.</p>
</div>
<div class="paragraph">
<p>The SELECT clause has the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>select_clause ::= SELECT [DISTINCT] select_item {, select_item}*
select_item ::= select_expression [[AS] result_variable]
select_expression ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable |
    OBJECT(identification_variable) |
    constructor_expression
constructor_expression ::=
    NEW constructor_name (constructor_item {, constructor_item}*)
constructor_item ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable
aggregate_expression ::=
    {AVG | MAX | MIN | SUM} ([DISTINCT] state_valued_path_expression) |
     COUNT ([DISTINCT] identification_variable | state_valued_path_expression |
         single_valued_object_path_expression) |
     function_invocation</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.id, c.status
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> o.count &gt; <span class="integer">100</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the following example, <em>videoInventory</em> is
a Map from the entity <em>Movie</em> to the number of copies in stock:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> v.location.street, <span class="type">KEY</span>(i).title, VALUE(i)
<span class="keyword">FROM</span> VideoStore v <span class="keyword">JOIN</span> v.videoInventory i
<span class="keyword">WHERE</span> v.location.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">94301</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> VALUE(i) &gt; <span class="integer">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the SELECT clause must be specified
to return only single-valued expressions. The query below is therefore
not valid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o.lineItems <span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">AS</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>The DISTINCT
keyword is used to specify that duplicate values must be eliminated from
the query result.</p>
</div>
<div class="paragraph">
<p>If DISTINCT is not specified, duplicate
values are not eliminated.</p>
</div>
<div class="paragraph">
<p>The result of DISTINCT over embeddable
objects or map <em>entry</em> results is undefined.</p>
</div>
<div class="paragraph">
<p>Standalone identification variables in the
SELECT clause may optionally be qualified by the
OBJECT operator.<sup class="footnote">[<a id="_footnoteref_69" class="footnote" href="#_footnotedef_69" title="View footnote.">69</a>]</sup> The
SELECT clause must not use the OBJECT operator to qualify path
expressions.</p>
</div>
<div class="paragraph">
<p>A <em>result_variable</em> may be used to
name a <em>select_item</em> in the query result.<sup class="footnote">[<a id="_footnoteref_70" class="footnote" href="#_footnotedef_70" title="View footnote.">70</a>]</sup></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c, <span class="predefined">COUNT</span>(l) <span class="keyword">AS</span> itemCount
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.Orders o <span class="keyword">JOIN</span> o.lineItems l
<span class="keyword">WHERE</span> c.address.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c
<span class="keyword">ORDER</span> <span class="keyword">BY</span> itemCount</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="result-type-of-the-select-clause"><a class="anchor" href="#result-type-of-the-select-clause"></a>4.8.1. Result Type of the SELECT Clause</h4>
<div class="paragraph">
<p>The type of the query result specified by the
SELECT clause of a query is an entity
abstract schema type, a state field type,
the result of a scalar expression, the result of an aggregate function,
the result of a construction operation, or some sequence of these.</p>
</div>
<div class="paragraph">
<p>The result type of the SELECT clause is
defined by the the result types of the select expressions contained in
it. When multiple select expressions are used in the SELECT clause, the
elements in this result correspond in order to the order of their
specification in the SELECT clause and in type to the result types of
each of the select expressions.</p>
</div>
<div class="paragraph">
<p>The type of the result of a select_expression
is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The result type of an identification_variable
is the type of the entity object or embeddable object to which the
identification variable corresponds. The type of an
identification_variable that refers to an entity abstract schema type is
the type of the entity to which that identification variable corresponds
or a subtype as determined by the object/relational mapping.</p>
</li>
<li>
<p>The result type of a
single_valued_path_expression that is a state_field_path_expression is
the same type as the corresponding state field of the entity or
embeddable class. If the state field of the entity is a primitive type,
the result type is the corresponding object type.</p>
</li>
<li>
<p>The result type of a
single_valued_path_expression that is a
single_valued_object_path_expression is the type of the entity object or
embeddable object to which the path expression corresponds. A
single_valued_object_path_expression that results in an entity object
will result in an entity of the type of the relationship field or the
subtype of the relationship field of the entity object as determined by
the object/relational mapping.</p>
</li>
<li>
<p>The result type of a
single_valued_path_expression that is an <em>identification_variable</em> to
which the KEY or VALUE function has been applied is determined by the
type of the map key or value respectively, as defined by the above
rules.</p>
</li>
<li>
<p>The result type of a
single_valued_path_expression that is an <em>identification_variable</em> to
which the ENTRY function has been applied is <em>java.util.Map.Entry</em>,
where the key and value types of the map entry are determined by the
above rules as applied to the map key and map value respectively.</p>
</li>
<li>
<p>The result type of a <em>scalar_expression</em> is
the type of the scalar value to which the expression evaluates. The
result type of a numeric <em>scalar_expression</em> is defined in <a href="#a5574">Section 4.8.6</a>.</p>
</li>
<li>
<p>The result type of an
<em>entity_type_expression</em> scalar expression is the Java class to which
the resulting abstract schema type corresponds.</p>
</li>
<li>
<p>The result type of aggregate_expression is
defined in <a href="#a5538">Section 4.8.5</a>.</p>
</li>
<li>
<p>The result type of a constructor_expression
is the type of the class for which the constructor is defined. The types
of the arguments to the constructor are defined by the above rules.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="a5500"><a class="anchor" href="#a5500"></a>4.8.2. Constructor Expressions in the SELECT Clause</h4>
<div class="paragraph">
<p>A constructor may be used in the SELECT list
to return an instance of a Java class. The specified class is not
required to be an entity or to be mapped to the database. The
constructor name must be fully qualified.</p>
</div>
<div class="paragraph">
<p>If an entity class name is specified as the
constructor name in the SELECT NEW clause, the resulting entity
instances will be in either the new or the detached state, depending on
whether a primary key is retrieved for the constructed object.</p>
</div>
<div class="paragraph">
<p>If a <em>single_valued_path_expression</em> or
<em>identification_variable</em> that is an argument to the constructor
references an entity, the resulting entity instance referenced by that
<em>single_valued_path_expression</em> or <em>identification_variable</em> will be in
the managed state.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> NEW com.acme.example.CustomerDetails(c.id, c.status, o.count)
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> o.count &gt; <span class="integer">100</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="null-values-in-the-query-result"><a class="anchor" href="#null-values-in-the-query-result"></a>4.8.3. Null Values in the Query Result</h4>
<div class="paragraph">
<p>If the result of a query corresponds to an
association field or state field whose value is null, that null value is
returned in the result of the query method. The IS NOT NULL construct
can be used to eliminate such null values from the result set of the
query.</p>
</div>
<div class="paragraph">
<p>Note, however, that state field types defined
in terms of Java numeric primitive types cannot produce NULL values in
the query result. A query that returns such a state field type as a
result type must not return a null value.</p>
</div>
</div>
<div class="sect3">
<h4 id="a5511"><a class="anchor" href="#a5511"></a>4.8.4. Embeddables in the Query Result</h4>
<div class="paragraph">
<p>If the result of a query corresponds to an
identification variable or state field whose value is an embeddable, the
embeddable instance returned by the query will not be in the managed
state (i.e., it will not be part of the state of any managed entity).</p>
</div>
<div class="paragraph">
<p>In the following example, the <em>Address</em>
instances returned by the query will reference <em>Phone</em> instances. While
the <em>Phone</em> instances will be managed, the <em>Address</em> instances
referenced by the <em>addr</em> result variable will not be. Modifications to
these embeddable instances will have no effect on persistent state.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    Address address;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="predefined-type">String</span> street;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToOne</span>
    Phone phone; <span class="comment">// fetch=EAGER</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Phone</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToOne</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">address.phone</span><span class="delimiter">&quot;</span></span>)
    Employee emp; <span class="comment">// fetch=EAGER</span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e.address <span class="keyword">AS</span> addr
<span class="keyword">FROM</span> Employee e</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a5538"><a class="anchor" href="#a5538"></a>4.8.5. Aggregate Functions in the SELECT Clause</h4>
<div class="paragraph">
<p>The result of a query may be the result of an
aggregate function applied to a path expression.</p>
</div>
<div class="paragraph">
<p>The following aggregate functions can be used
in the SELECT clause of a query: AVG, COUNT, MAX, MIN, SUM, aggregate
functions defined in the database.</p>
</div>
<div class="paragraph">
<p>For all aggregate functions except COUNT, the
path expression that is the argument to the aggregate function must
terminate in a state field. The path expression argument to COUNT may
terminate in either a state field or a association field, or the
argument to COUNT may be an identification variable.</p>
</div>
<div class="paragraph">
<p>Arguments to the functions SUM and AVG must
be numeric. Arguments to the functions MAX and MIN must correspond to
orderable state field types (i.e., numeric types, string types,
character types, or date types).</p>
</div>
<div class="paragraph">
<p>The Java type that is contained in the result
of a query using an aggregate function is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>COUNT returns Long.</p>
</li>
<li>
<p>MAX, MIN return the type of the state field to which they are applied.</p>
</li>
<li>
<p>AVG returns Double.</p>
</li>
<li>
<p>SUM returns Long when applied to state fields
of integral types (other than BigInteger); Double when applied to state
fields of floating point types; BigInteger when applied to state fields
of type BigInteger; and BigDecimal when applied to state fields of type
BigDecimal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Null values are eliminated before the
aggregate function is applied, regardless of whether the keyword
DISTINCT is specified.</p>
</div>
<div class="paragraph">
<p>If SUM, AVG, MAX, or MIN is used, and there
are no values to which the aggregate function can be applied, the result
of the aggregate function is NULL.</p>
</div>
<div class="paragraph">
<p>If COUNT is used, and there are no values to
which COUNT can be applied, the result of the aggregate function is 0.</p>
</div>
<div class="paragraph">
<p>The argument to an aggregate function
may be preceded by the keyword DISTINCT to specify that duplicate values
are to be eliminated before the aggregate function is
applied.<sup class="footnote">[<a id="_footnoteref_71" class="footnote" href="#_footnotedef_71" title="View footnote.">71</a>]</sup></p>
</div>
<div class="paragraph">
<p>The use of DISTINCT with COUNT is not
supported for arguments of embeddable types or map entry types.</p>
</div>
<div class="paragraph">
<p>The invocation of aggregate database
functions, including user defined functions, is supported by means of
the FUNCTION operator. See <a href="#a5311">Section 4.6.17.3</a>.</p>
</div>
<div class="sect4">
<h5 id="examples"><a class="anchor" href="#examples"></a>4.8.5.1. Examples</h5>
<div class="paragraph">
<p>The following query returns the average order quantity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">AVG</span>(o.quantity) <span class="keyword">FROM</span> <span class="keyword">Order</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following query returns the total cost of
the items that John Smith has ordered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">SUM</span>(l.price)
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following query returns the total number of orders.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">COUNT</span>(o) <span class="keyword">FROM</span> <span class="keyword">Order</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following query counts the number of
items in John Smith&#8217;s order for which prices have been specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">COUNT</span>(l.price)
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this is equivalent to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">COUNT</span>(l)
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> l.price <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a5574"><a class="anchor" href="#a5574"></a>4.8.6. Numeric Expressions in the SELECT Clause</h4>
<div class="paragraph">
<p>The type of a numeric expression in the query
result is determined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An operand that corresponds to a persistent
state field is of the same type as that persistent state field.</p>
</li>
<li>
<p>An operand that corresponds to one of
arithmetic functions described in <a href="#a5284">Section 4.6.17.2.2</a> is of the type
defined by <a href="#a5284">Section 4.6.17.2.2</a>.</p>
</li>
<li>
<p>An operand that corresponds to one of an
aggregate functions described in <a href="#a5538">Section 4.8.5</a> is of the type defined by
<a href="#a5538">Section 4.8.5</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The result of a case expression, coalesce
expression, nullif expression, or arithmetic expression (+, -, *, /) is
determined by applying the following rule to its
operands<sup class="footnote">[<a id="_footnoteref_72" class="footnote" href="#_footnotedef_72" title="View footnote.">72</a>]</sup>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is an operand of type Double or
double, the result of the operation is of type Double;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
Float or float, the result of the operation is of type Float;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
BigDecimal, the result of the operation is of type BigDecimal;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
BigInteger, the result of the operation is of type BigInteger, unless
the operator is / (division), in which case the numeric result type is
not further defined;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
Long or long, the result of the operation is of type Long, unless the
operator is / (division), in which case the numeric result type is not
further defined;</p>
</li>
<li>
<p>otherwise, if there is an operand of integral
type, the result of the operation is of type Integer, unless the
operator is / (division), in which case the numeric result type is not
further defined.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Users should note that the semantics of the
SQL division operation are not standard across databases. In particular,
when both operands are of integral types, the result of the division
operation will be an integral type in some databases, and an
non-integral type in others. Portable applications should not assume a
particular result type.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a5587"><a class="anchor" href="#a5587"></a>4.9. ORDER BY Clause</h3>
<div class="paragraph">
<p>The ORDER BY clause allows the objects or
values that are returned by the query to be ordered.</p>
</div>
<div class="paragraph">
<p>The syntax of the ORDER BY clause is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>orderby_clause ::= ORDER BY orderby_item {, orderby_item}*
orderby_item ::=
    {state_field_path_expression | general_identification_variable | result_variable}
        [ASC | DESC]</pre>
</div>
</div>
<div class="paragraph">
<p>An orderby_item must be one of the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A <em>state_field_path_expression</em> that
evaluates to an orderable state field of an entity or embeddable class
abstract schema type designated in the SELECT clause by one of the
following:</p>
<div class="ulist">
<ul>
<li>
<p>a <em>general_identification_variable</em></p>
</li>
<li>
<p>a <em>single_valued_object_path_expression</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>A <em>state_field_path_expression</em> that
evaluates to the same state field of the same entity or embeddable
abstract schema type as a <em>state_field_path_expression</em> in the SELECT
clause</p>
</li>
<li>
<p>A general_identification_variable that
evaluates to the same map field of the same entity or embeddable
abstract schema type as a general_identification_variable in the SELECT
clause</p>
</li>
<li>
<p>A <em>result_variable</em> that refers to an
orderable item in the SELECT clause for which the same <em>result_variable</em>
has been specified. This may be the result of an <em>aggregate_expression</em>
, a <em>scalar_expression</em>, or a <em>state_field_path_expression</em> in the
SELECT clause.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, the four queries below are legal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity <span class="directive">DESC</span>, o.totalcost

<span class="class">SELECT</span> o.quantity, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity, a.zipcode

<span class="class">SELECT</span> o.quantity, o.cost*<span class="float">1.08</span> <span class="keyword">AS</span> taxedCost, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> a.county = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity, taxedCost, a.zipcode

<span class="class">SELECT</span> <span class="predefined">AVG</span>(o.quantity) <span class="keyword">as</span> q, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> a.zipcode
<span class="keyword">ORDER</span> <span class="keyword">BY</span> q <span class="directive">DESC</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following two queries are <em>not</em> legal
because the <em>orderby_item</em> is not reflected in the SELECT clause of the
query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.product_name
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l <span class="keyword">JOIN</span> l.product p <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> p.price

<span class="class">SELECT</span> p.product_name
<span class="keyword">FROM</span> <span class="keyword">Order</span> o, <span class="keyword">IN</span>(o.lineItems) l <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastname = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstname = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity</code></pre>
</div>
</div>
<div class="paragraph">
<p>If more than one <em>orderby_item</em> is specified,
the left-to-right sequence of the <em>orderby_item</em> elements determines the
precedence, whereby the leftmost <em>orderby_item</em> has highest precedence.</p>
</div>
<div class="paragraph">
<p>The keyword ASC specifies that ascending
ordering be used for the associated <em>orderby_item</em>; the keyword DESC
specifies that descending ordering be used. Ascending ordering is the
default.</p>
</div>
<div class="paragraph">
<p>SQL rules for the ordering of null values
apply: that is, all null values must appear before all non-null values
in the ordering or all null values must appear after all non-null values
in the ordering, but it is not specified which.</p>
</div>
<div class="paragraph">
<p>The ordering of the query result is preserved
in the result of the query execution method if the ORDER BY clause is
used.</p>
</div>
</div>
<div class="sect2">
<h3 id="a5636"><a class="anchor" href="#a5636"></a>4.10. Bulk Update and Delete Operations</h3>
<div class="paragraph">
<p>Bulk update and delete operations apply to
entities of a single entity class (together with its subclasses, if
any). Only one entity abstract schema type may be specified in the FROM
or UPDATE clause.</p>
</div>
<div class="paragraph">
<p>The syntax of these operations is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>update_statement ::= update_clause [where_clause]
update_clause ::= UPDATE entity_name [[AS] identification_variable]
                  SET update_item {, update_item}*
update_item ::= [identification_variable.]{single_valued_embeddable_object_field.}*
    {state_field | single_valued_object_field} = new_value
new_value ::=
    scalar_expression |
    simple_entity_expression |
    NULL

delete_statement ::= delete_clause [where_clause]
delete_clause ::= DELETE FROM entity_name [[AS] identification_variable]</pre>
</div>
</div>
<div class="paragraph">
<p>The syntax of the WHERE clause is described
in <a href="#a4985">Section 4.5</a>.</p>
</div>
<div class="paragraph">
<p>A delete operation only applies to entities
of the specified class and its subclasses. It does not cascade to
related entities.</p>
</div>
<div class="paragraph">
<p>The new_value specified for an update
operation must be compatible in type with the field to which it is
assigned.</p>
</div>
<div class="paragraph">
<p>Bulk update maps directly to a database
update operation, bypassing optimistic locking checks. Portable
applications must manually update the value of the version column, if
desired, and/or manually validate the value of the version column.</p>
</div>
<div class="paragraph">
<p>The persistence context is not synchronized
with the result of the bulk update or delete.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Caution should be used when executing bulk
update or delete operations because they may result in inconsistencies
between the database and the entities in the active persistence context.
In general, bulk update and delete operations should only be performed
within a transaction in a new persistence context or before fetching or
accessing entities whose state might be affected by such operations._</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DELETE</span>
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">inactive</span><span class="delimiter">'</span></span>

<span class="class">DELETE</span>
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">inactive</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> c.orders <span class="keyword">IS</span> EMPTY

<span class="class">UPDATE</span> Customer c
<span class="class">SET</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">outstanding</span><span class="delimiter">'</span></span>
<span class="keyword">WHERE</span> c.balance &lt; <span class="integer">10000</span>

<span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.address.building = <span class="integer">22</span>
<span class="keyword">WHERE</span> e.address.building = <span class="integer">14</span>
    <span class="keyword">AND</span> e.address.city = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> e.project = <span class="string"><span class="delimiter">'</span><span class="content">Jakarta EE</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a5676"><a class="anchor" href="#a5676"></a>4.11. Null Values</h3>
<div class="paragraph">
<p>When the target of a reference does not exist
in the database, its value is regarded as <em>NULL</em>. SQL <em>NULL</em> semantics
<a href="#a19494">[2]</a> defines the evaluation of
conditional expressions containing <em>NULL</em> values.</p>
</div>
<div class="paragraph">
<p>The following is a brief description of these semantics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Comparison or arithmetic operations with a
NULL value always yield an unknown value.</p>
</li>
<li>
<p>Two NULL values are not considered to be
equal, the comparison yields an unknown value.</p>
</li>
<li>
<p>Comparison or arithmetic operations with an
unknown value always yield an unknown value.</p>
</li>
<li>
<p>The IS NULL and IS NOT NULL operators convert
a <em>NULL</em> state field or single-valued object field value into the
respective TRUE or FALSE value.</p>
</li>
<li>
<p>Boolean operators use three valued logic,
defined by <a href="#a5686">Table 1</a>, <a href="#a5705">Table 2</a>, and <a href="#a5724">Table 3</a>.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Definition of the AND Operator <a id="a5686"></a></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">AND</th>
<th class="tableblock halign-left valign-top">T</th>
<th class="tableblock halign-left valign-top">F</th>
<th class="tableblock halign-left valign-top">U</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Definition of the OR Operator <a id="a5705"></a></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">OR</th>
<th class="tableblock halign-left valign-top">T</th>
<th class="tableblock halign-left valign-top">F</th>
<th class="tableblock halign-left valign-top">U</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Definition of the NOT Operator <a id="a5724"></a></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">NOT</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Jakarta Persistence query language
defines the empty string, '', as a string
with 0 length, which is not equal to a NULL value. However, NULL values
and empty strings may not always be distinguished when queries are
mapped to some databases. Application developers should therefore not
rely on the semantics of query comparisons involving the empty string
and NULL value.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="a5735"><a class="anchor" href="#a5735"></a>4.12. Equality and Comparison Semantics</h3>
<div class="paragraph">
<p>Only the values of <em>like</em> types are permitted
to be compared. A type is <em>like</em> another type if they correspond to the
same Java language type, or if one is a primitive Java language type and
the other is the wrapped Java class type equivalent (e.g., <em>int</em> and
<em>Integer</em> are like types in this sense). There is one exception to this
rule: it is valid to compare numeric values for which the rules of
numeric promotion apply. Conditional expressions attempting to compare
non-like type values are disallowed except for this numeric case.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the arithmetic operators and
comparison operators are permitted to be applied to state fields and
input parameters of the wrapped Java class equivalents to the primitive
numeric Java types.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Two entities of the same abstract schema type
are equal if and only if they have the same primary key value.</p>
</div>
<div class="paragraph">
<p>Only equality/inequality comparisons over
enums are required to be supported.</p>
</div>
<div class="paragraph">
<p>Comparisons over instances of embeddable
class or map entry types are not supported.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-2"><a class="anchor" href="#examples-2"></a>4.13. Examples</h3>
<div class="paragraph">
<p>The following examples illustrate the syntax
and semantics of the Jakarta Persistence query language. These examples are
based on the example presented in <a href="#a4713">Section 4.3.2</a>.</p>
</div>
<div class="sect3">
<h4 id="simple-queries"><a class="anchor" href="#simple-queries"></a>4.13.1. Simple Queries</h4>
<div class="paragraph">
<p>Find all orders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all orders that need to be shipped to California:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.shippingAddress.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all states for which there are orders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o.shippingAddress.state
<span class="keyword">FROM</span> <span class="keyword">Order</span> o</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="queries-with-relationships"><a class="anchor" href="#queries-with-relationships"></a>4.13.2. Queries with Relationships</h4>
<div class="paragraph">
<p>Find all orders that have line items:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the result of this query does not
include orders with no associated line items. This query can also be
written as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.lineItems <span class="keyword">IS</span> <span class="keyword">NOT</span> EMPTY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all orders that have no line items:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.lineItems <span class="keyword">IS</span> EMPTY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all pending orders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l
<span class="keyword">WHERE</span> l.shipped = <span class="predefined-constant">FALSE</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Find all orders in which the shipping address
differs from the billing address. This example assumes that the
application developer uses two distinct <em>entity</em> types to designate
shipping and billing addresses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span>
    <span class="keyword">NOT</span> (o.shippingAddress.state = o.billingAddress.state <span class="keyword">AND</span>
         o.shippingAddress.city = o.billingAddress.city <span class="keyword">AND</span>
         o.shippingAddress.street = o.billingAddress.street)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the application developer uses a single
<em>entity</em> type in two different relationships for both the shipping
address and the billing address, the above expression can be simplified
based on the equality rules defined in <a href="#a5735">Section 4.12</a>. The
query can then be written as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.shippingAddress &lt;&gt; o.billingAddress</code></pre>
</div>
</div>
<div class="paragraph">
<p>The query checks whether the same entity
abstract schema type instance (identified by its primary key) is related
to an order through two distinct relationships.</p>
</div>
</div>
<div class="sect3">
<h4 id="queries-using-input-parameters"><a class="anchor" href="#queries-using-input-parameters"></a>4.13.3. Queries Using Input Parameters</h4>
<div class="paragraph">
<p>The following query finds the orders for a
product whose name is designated by an input parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems l
<span class="keyword">WHERE</span> l.product.name = <span class="error">?</span><span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For this query, the input parameter must be
of the type of the state field name, i.e., a string.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bnf"><a class="anchor" href="#bnf"></a>4.14. BNF</h3>
<div class="paragraph">
<p>BNF notation summary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{ &#8230;&#8203; } grouping</p>
</li>
<li>
<p>[ &#8230;&#8203; ] optional constructs</p>
</li>
<li>
<p>* zero or more</p>
</li>
<li>
<p>+ one or more</p>
</li>
<li>
<p>| alternates</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is the BNF for the Jakarta Persistence query language.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>QL_statement ::= select_statement | update_statement | delete_statement
select_statement ::= select_clause from_clause [where_clause] [groupby_clause]
    [having_clause] [orderby_clause]
update_statement ::= update_clause [where_clause]
delete_statement ::= delete_clause [where_clause]
from_clause ::=
    FROM  identification_variable_declaration
        {, {identification_variable_declaration | collection_member_declaration}}*
identification_variable_declaration ::= range_variable_declaration {join | fetch_join}*
range_variable_declaration ::= entity_name [AS] identification_variable
join ::= join_spec join_association_path_expression [AS] identification_variable
    [join_condition]
fetch_join ::= join_spec FETCH join_association_path_expression
join_spec ::= [LEFT [OUTER] | INNER] JOIN
join_condition ::= ON conditional_expression
join_association_path_expression ::=
    join_collection_valued_path_expression |
    join_single_valued_path_expression |
    TREAT(join_collection_valued_path_expression AS subtype) |
    TREAT(join_single_valued_path_expression AS subtype)
join_collection_valued_path_expression ::=
    identification_variable.{single_valued_embeddable_object_field.}* collection_valued_field
join_single_valued_path_expression ::=
    identification_variable.{single_valued_embeddable_object_field.}* single_valued_object_field
collection_member_declaration ::=
    IN (collection_valued_path_expression) [AS] identification_variable
qualified_identification_variable ::=
    map_field_identification_variable |
    ENTRY(identification_variable)
map_field_identification_variable ::=
    KEY(identification_variable) |
    VALUE(identification_variable)
single_valued_path_expression ::=
    qualified_identification_variable |
    TREAT(qualified_identification_variable AS subtype) |
    state_field_path_expression |
    single_valued_object_path_expression
general_identification_variable ::=
    identification_variable |
    map_field_identification_variable
general_subpath ::= simple_subpath | treated_subpath{.single_valued_object_field}*
simple_subpath ::=
    general_identification_variable |
    general_identification_variable{.single_valued_object_field}*
treated_subpath ::= TREAT(general_subpath AS subtype)
state_field_path_expression ::= general_subpath.state_field
state_valued_path_expression ::=
    state_field_path_expression | general_identification_variable
single_valued_object_path_expression ::=
    general_subpath.single_valued_object_field
collection_valued_path_expression ::= general_subpath.{collection_valued_field}
update_clause ::= UPDATE entity_name [[AS] identification_variable]
    SET update_item {, update_item}*
update_item ::= [identification_variable.]{single_valued_embeddable_object_field.}*
    {state_field | single_valued_object_field} = new_value
new_value ::=
    scalar_expression |
    simple_entity_expression |
    NULL
delete_clause ::= DELETE FROM entity_name [[AS] identification_variable]
select_clause ::= SELECT [DISTINCT] select_item {, select_item}*
select_item ::= select_expression [[AS] result_variable]
select_expression ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable |
    OBJECT(identification_variable) |
    constructor_expression
constructor_expression ::=
    NEW constructor_name (constructor_item {, constructor_item}*)
constructor_item ::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable
aggregate_expression ::=
    {AVG | MAX | MIN | SUM} ([DISTINCT] state_valued_path_expression) |
    COUNT ([DISTINCT] identification_variable | state_valued_path_expression |
        single_valued_object_path_expression) |
    function_invocation
where_clause ::= WHERE conditional_expression
groupby_clause ::= GROUP BY groupby_item {, groupby_item}*
groupby_item ::= single_valued_path_expression | identification_variable
having_clause ::= HAVING conditional_expression
orderby_clause ::= ORDER BY orderby_item {, orderby_item}*
orderby_item ::=
    state_field_path_expression |
    general_identification_variable |
    result_variable
    [ASC | DESC]
subquery ::= simple_select_clause subquery_from_clause [where_clause]
    [groupby_clause] [having_clause]
subquery_from_clause ::=
    FROM subselect_identification_variable_declaration
        {, subselect_identification_variable_declaration | collection_member_declaration}*
subselect_identification_variable_declaration ::=
    identification_variable_declaration |
    derived_path_expression [AS] identification_variable {join}* |
    derived_collection_member_declaration
derived_path_expression ::=
    general_derived_path.single_valued_object_field |
    general_derived_path.collection_valued_field
general_derived_path ::=
    simple_derived_path |
    treated_derived_path{.single_valued_object_field}*
simple_derived_path ::= superquery_identification_variable{.single_valued_object_field}*
treated_derived_path ::= TREAT(general_derived_path AS subtype)
derived_collection_member_declaration ::=
    IN superquery_identification_variable.{single_valued_object_field.}*collection_valued_field
simple_select_clause ::= SELECT [DISTINCT] simple_select_expression
simple_select_expression::=
    single_valued_path_expression |
    scalar_expression |
    aggregate_expression |
    identification_variable
scalar_expression ::=
    arithmetic_expression |
    string_expression |
    enum_expression |
    datetime_expression |
    boolean_expression |
    case_expression |
    entity_type_expression
conditional_expression ::= conditional_term | conditional_expression OR conditional_term
conditional_term ::= conditional_factor | conditional_term AND conditional_factor
conditional_factor ::= [NOT] conditional_primary
conditional_primary ::= simple_cond_expression | (conditional_expression)
simple_cond_expression ::=
    comparison_expression |
    between_expression |
    in_expression |
    like_expression |
    null_comparison_expression |
    empty_collection_comparison_expression |
    collection_member_expression |
    exists_expression
between_expression ::=
    arithmetic_expression [NOT] BETWEEN
        arithmetic_expression AND arithmetic_expression |
    string_expression [NOT] BETWEEN string_expression AND string_expression |
    datetime_expression [NOT] BETWEEN datetime_expression AND datetime_expression
in_expression ::=
    {state_valued_path_expression | type_discriminator} [NOT] IN
        {(in_item{, in_item}*) | (subquery) | collection_valued_input_parameter}
in_item ::= literal | single_valued_input_parameter
like_expression ::=
    string_expression [NOT] LIKE pattern_value [ESCAPE escape_character]
null_comparison_expression ::=
    {single_valued_path_expression | input_parameter} IS [NOT] NULL
empty_collection_comparison_expression ::=
    collection_valued_path_expression IS [NOT] EMPTY
collection_member_expression ::= entity_or_value_expression
    [NOT] MEMBER [OF] collection_valued_path_expression
entity_or_value_expression ::=
    single_valued_object_path_expression |
    state_field_path_expression |
    simple_entity_or_value_expression
simple_entity_or_value_expression ::=
    identification_variable |
    input_parameter |
    literal
exists_expression ::= [NOT] EXISTS (subquery)
all_or_any_expression ::= {ALL | ANY | SOME} (subquery)
comparison_expression ::=
    string_expression comparison_operator {string_expression | all_or_any_expression} |
    boolean_expression {= | &lt;&gt;} {boolean_expression | all_or_any_expression} |
    enum_expression {= | &lt;&gt;} {enum_expression | all_or_any_expression} |
    datetime_expression comparison_operator
        {datetime_expression | all_or_any_expression} |
    entity_expression {= | &lt;&gt;_} {entity_expression | all_or_any_expression} |
    arithmetic_expression comparison_operator {arithmetic_expression | all_or_any_expression} |
    entity_type_expression {= | &lt;&gt;} entity_type_expression}
comparison_operator ::= = | &gt; | &gt;= | &lt; | &lt;= | &lt;&gt;
arithmetic_expression ::=
    arithmetic_term | arithmetic_expression {+ | -} arithmetic_term
arithmetic_term ::= arithmetic_factor | arithmetic_term {* | /} arithmetic_factor
arithmetic_factor ::= [{+ | -}] arithmetic_primary
arithmetic_primary ::=
    state_valued_path_expression |
    numeric_literal |
    (arithmetic_expression) |
    input_parameter |
    functions_returning_numerics |
    aggregate_expression |
    case_expression |
    function_invocation |
    (subquery)
string_expression ::=
    state_valued_path_expression |
    string_literal |
    input_parameter |
    functions_returning_strings |
    aggregate_expression |
    case_expression |
    function_invocation |
    (subquery)
datetime_expression ::=
    state_valued_path_expression |
    input_parameter |
    functions_returning_datetime |
    aggregate_expression |
    case_expression |
    function_invocation |
    date_time_timestamp_literal |
    (subquery)
boolean_expression ::=
    state_valued_path_expression |
    boolean_literal |
    input_parameter |
    case_expression |
    function_invocation |
    (subquery)
enum_expression ::=
    state_valued_path_expression |
    enum_literal |
    input_parameter |
    case_expression |
    (subquery)
entity_expression ::= single_valued_object_path_expression | simple_entity_expression
simple_entity_expression ::= identification_variable | input_parameter
entity_type_expression ::=
    type_discriminator |
    entity_type_literal |
    input_parameter
type_discriminator ::=
    TYPE(general_identification_variable |
        single_valued_object_path_expression |
        input_parameter)
functions_returning_numerics ::=
    LENGTH(string_expression) |
    LOCATE(string_expression, string_expression[, arithmetic_expression]) |
    ABS(arithmetic_expression) |
    SQRT(arithmetic_expression) |
    MOD(arithmetic_expression, arithmetic_expression) |
    SIZE(collection_valued_path_expression) |
    INDEX(identification_variable)
functions_returning_datetime ::=
    CURRENT_DATE |
    CURRENT_TIME |
    CURRENT_TIMESTAMP
functions_returning_strings ::=
    CONCAT(string_expression, string_expression{, string_expression}*) |
    SUBSTRING(string_expression, arithmetic_expression[, arithmetic_expression]) |
    TRIM([[trim_specification] [trim_character] FROM] string_expression) |
    LOWER(string_expression) |
    UPPER(string_expression)
trim_specification ::= LEADING | TRAILING | BOTH
function_invocation ::= FUNCTION(function_name{, function_arg}*)
function_arg ::=
    literal |
    state_valued_path_expression |
    input_parameter |
    scalar_expression
_case_expression ::=_
    general_case_expression |
    simple_case_expression |
    coalesce_expression |
    nullif_expression
general_case_expression::= CASE when_clause {when_clause}* ELSE scalar_expression END
when_clause ::= WHEN conditional_expression THEN scalar_expression
simple_case_expression ::=
    CASE case_operand simple_when_clause {simple_when_clause}*
    ELSE scalar_expression
    END
case_operand ::= state_valued_path_expression | type_discriminator
simple_when_clause ::= WHEN scalar_expression THEN scalar_expression
coalesce_expression ::= COALESCE(scalar_expression{, scalar_expression}+)
nullif_expression::= NULLIF(scalar_expression, scalar_expression)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a6072"><a class="anchor" href="#a6072"></a>5. Metamodel API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This specification provides a set of
interfaces for dynamically accessing the metamodel corresponding to the
managed classes of a persistence unit.</p>
</div>
<div class="sect2">
<h3 id="metamodel-api-interfaces"><a class="anchor" href="#metamodel-api-interfaces"></a>5.1. Metamodel API Interfaces</h3>
<div class="paragraph">
<p>The <em>jakarta.persistence.metamodel</em> interfaces
provide __ for dynamically accessing the metamodel of the persistent
state and relationships of the managed classes of a persistence unit.</p>
</div>
<div class="paragraph">
<p>The metamodel can be accessed through the
<em>EntityManagerFactory</em> or <em>EntityManager getMetamodel</em> methods.</p>
</div>
<div class="paragraph">
<p>The metamodel API may be extended to cover
object/relational mapping information in a future release of this
specification.</p>
</div>
<div class="sect3">
<h4 id="metamodel-interface"><a class="anchor" href="#metamodel-interface"></a>5.1.1. Metamodel Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * Provides access to the metamodel of persistent
 * entities in the persistence unit.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Metamodel</span> {

    <span class="comment">/**
     *  Return the metamodel entity type representing the entity.
     *  @param cls  the type of the represented entity
     *  @return the metamodel entity type
     *  @throws IllegalArgumentException if not an entity
     */</span>
    &lt;X&gt; EntityType&lt;X&gt; entity(<span class="predefined-type">Class</span>&lt;X&gt; cls);

    <span class="comment">/**
     *  Return the metamodel managed type representing the
     *  entity, mapped superclass, or embeddable class.
     *  @param cls  the type of the represented managed class
     *  @return the metamodel managed type
     *  @throws IllegalArgumentException if not a managed class
     */</span>
    &lt;X&gt; ManagedType&lt;X&gt; managedType(<span class="predefined-type">Class</span>&lt;X&gt; cls);

    <span class="comment">/**
     *  Return the metamodel embeddable type representing the
     *  embeddable class.
     *  @param cls  the type of the represented embeddable class
     *  @return the metamodel embeddable type
     *  @throws IllegalArgumentException if not an embeddable class
     */</span>
    &lt;X&gt; EmbeddableType&lt;X&gt; embeddable(<span class="predefined-type">Class</span>&lt;X&gt; cls);

    <span class="comment">/**
     *  Return the metamodel managed types.
     *  @return the metamodel managed types
     */</span>
    <span class="predefined-type">Set</span>&lt;ManagedType&lt;?&gt;&gt; getManagedTypes();

    <span class="comment">/**
     * Return the metamodel entity types.
     * @return the metamodel entity types
     */</span>
    <span class="predefined-type">Set</span>&lt;EntityType&lt;?&gt;&gt; getEntities();

    <span class="comment">/**
     * Return the metamodel embeddable types.  Returns empty set
     * if there are no embeddable types.
     * @return the metamodel embeddable types
     */</span>
    <span class="predefined-type">Set</span>&lt;EmbeddableType&lt;?&gt;&gt; getEmbeddables();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="type-interface"><a class="anchor" href="#type-interface"></a>5.1.2. Type Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;Type&lt;/code&gt; represent persistent object
 * or attribute types.
 *
 * @param &lt;X&gt;  The type of the represented object or attribute
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Type</span>&lt;X&gt; {

       <span class="directive">public</span> <span class="directive">static</span> <span class="type">enum</span> PersistenceType {

       <span class="comment">/** Entity */</span>
           ENTITY,

       <span class="comment">/** Embeddable class */</span>
       EMBEDDABLE,

       <span class="comment">/** Mapped superclass */</span>
       MAPPED_SUPERCLASS,

       <span class="comment">/** Basic type */</span>
       BASIC
       }

    <span class="comment">/**
     *  Return the persistence type.
     *  @return persistence type
     */</span>
    PersistenceType getPersistenceType();

    <span class="comment">/**
     *  Return the represented Java type.
     *  @return Java type
     */</span>
    <span class="predefined-type">Class</span>&lt;X&gt; getJavaType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managedtype-interface"><a class="anchor" href="#managedtype-interface"></a>5.1.3. ManagedType Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 *  Instances of the type &lt;code&gt;ManagedType&lt;/code&gt; represent entity, mapped
 *  superclass, and embeddable types.
 *
 *  @param &lt;X&gt; The represented type.
 *
 *  @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ManagedType</span>&lt;X&gt; <span class="directive">extends</span> <span class="predefined-type">Type</span>&lt;X&gt; {

    <span class="comment">/**
     *  Return the attributes of the managed type.
     *  @return attributes of the managed type
     */</span>
     <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> X, ?&gt;&gt; getAttributes();

    <span class="comment">/**
     *  Return the attributes declared by the managed type.
     *  Returns empty set if the managed type has no declared
     *  attributes.
     *  @return declared attributes of the managed type
     */</span>
     <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Attribute</span>&lt;X, ?&gt;&gt; getDeclaredAttributes();

    <span class="comment">/**
     *  Return the single-valued attribute of the managed
     *  type that corresponds to the specified name and Java type.
     *  @param name  the name of the represented attribute
     *  @param type  the type of the represented attribute
     *  @return single-valued attribute with given name and type
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not present in the managed type
     */</span>
    &lt;Y&gt; SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; getSingularAttribute(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     *  Return the single-valued attribute declared by the
     *  managed type that corresponds to the specified name and
     *  Java type.
     *  @param name  the name of the represented attribute
     *  @param type  the type of the represented attribute
     *  @return declared single-valued attribute of the given
     *          name and type
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not declared in the managed type
     */</span>
    &lt;Y&gt; SingularAttribute&lt;X, Y&gt; getDeclaredSingularAttribute(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     *  Return the single-valued attributes of the managed type.
     *  Returns empty set if the managed type has no single-valued
     *  attributes.
     *  @return single-valued attributes
     */</span>
    <span class="predefined-type">Set</span>&lt;SingularAttribute&lt;? <span class="local-variable">super</span> X, ?&gt;&gt; getSingularAttributes();

    <span class="comment">/**
     *  Return the single-valued attributes declared by the managed
     *  type.
     *  Returns empty set if the managed type has no declared
     *  single-valued attributes.
     *  @return declared single-valued attributes
     */</span>
    <span class="predefined-type">Set</span>&lt;SingularAttribute&lt;X, ?&gt;&gt; getDeclaredSingularAttributes();

    <span class="comment">/**
     *  Return the Collection-valued attribute of the managed type
     *  that corresponds to the specified name and Java element type.
     *  @param name  the name of the represented attribute
     *  @param elementType  the element type of the represented
     *                      attribute
     *  @return CollectionAttribute of the given name and element
     *          type
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not present in the managed type
     */</span>
    &lt;E&gt; CollectionAttribute&lt;? <span class="local-variable">super</span> X, E&gt; getCollection(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     *  Return the Collection-valued attribute declared by the
     *  managed type that corresponds to the specified name and Java
     *  element type.
     *  @param name  the name of the represented attribute
     *  @param elementType  the element type of the represented
     *                      attribute
     *  @return declared &lt;code&gt;CollectionAttribute&lt;/code&gt; of the given name and
     *          element type
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not declared in the managed type
     */</span>
    &lt;E&gt; CollectionAttribute&lt;X, E&gt; getDeclaredCollection(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     *  Return the Set-valued attribute of the managed type that
     *  corresponds to the specified name and Java element type.
     *  @param name  the name of the represented attribute
     *  @param elementType  the element type of the represented
     *                      attribute
     *  @return SetAttribute of the given name and element type
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not present in the managed type
     */</span>
    &lt;E&gt; SetAttribute&lt;? <span class="local-variable">super</span> X, E&gt; getSet(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     *  Return the Set-valued attribute declared by the managed type
     *  that corresponds to the specified name and Java element type.
     *  @param name  the name of the represented attribute
     *  @param elementType  the element type of the represented
     *                      attribute
     *  @return declared SetAttribute of the given name and
     *          element type
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not declared in the managed type
     */</span>
    &lt;E&gt; SetAttribute&lt;X, E&gt; getDeclaredSet(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     *  Return the List-valued attribute of the managed type that
     *  corresponds to the specified name and Java element type.
     *  @param name  the name of the represented attribute
     *  @param elementType  the element type of the represented
     *                      attribute
     *  @return ListAttribute of the given name and element type
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not present in the managed type
     */</span>
    &lt;E&gt; ListAttribute&lt;? <span class="local-variable">super</span> X, E&gt; getList(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     *  Return the List-valued attribute declared by the managed
     *  type that corresponds to the specified name and Java
     *  element type.
     *  @param name  the name of the represented attribute
     *  @param elementType  the element type of the represented
     *                      attribute
     *  @return declared ListAttribute of the given name and
     *          element type
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not declared in the managed type
     */</span>
    &lt;E&gt; ListAttribute&lt;X, E&gt; getDeclaredList(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;E&gt; elementType);

    <span class="comment">/**
     *  Return the Map-valued attribute of the managed type that
     *  corresponds to the specified name and Java key and value
     *  types.
     *  @param name  the name of the represented attribute
     *  @param keyType  the key type of the represented attribute
     *  @param valueType  the value type of the represented attribute
     *  @return MapAttribute of the given name and key and value
     *  types
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not present in the managed type
     */</span>
    &lt;K, V&gt; MapAttribute&lt;? <span class="local-variable">super</span> X, K, V&gt; getMap(<span class="predefined-type">String</span> name,
                                                <span class="predefined-type">Class</span>&lt;K&gt; keyType,
                                                <span class="predefined-type">Class</span>&lt;V&gt; valueType);

    <span class="comment">/**
     *  Return the Map-valued attribute declared by the managed
     *  type that corresponds to the specified name and Java key
     *  and value types.
     *  @param name  the name of the represented attribute
     *  @param keyType  the key type of the represented attribute
     *  @param valueType  the value type of the represented attribute
     *  @return declared MapAttribute of the given name and key
     *          and value types
     *  @throws IllegalArgumentException if attribute of the given
     *          name and type is not declared in the managed type
     */</span>
    &lt;K, V&gt; MapAttribute&lt;X, K, V&gt; getDeclaredMap(<span class="predefined-type">String</span> name,
                                                <span class="predefined-type">Class</span>&lt;K&gt; keyType,
                                                <span class="predefined-type">Class</span>&lt;V&gt; valueType);

    <span class="comment">/**
     *  Return all multi-valued attributes (Collection-, Set-,
     *  List-, and Map-valued attributes) of the managed type.
     *  Returns empty set if the managed type has no multi-valued
     *  attributes.
     *  @return Collection-, Set-, List-, and Map-valued attributes
     */</span>
    <span class="predefined-type">Set</span>&lt;PluralAttribute&lt;? <span class="local-variable">super</span> X, ?, ?&gt;&gt; getPluralAttributes();

    <span class="comment">/**
     *  Return all multi-valued attributes (Collection-, Set-,
     *  List-, and Map-valued attributes) declared by the
     *  managed type.
     *  Returns empty set if the managed type has no declared
     *  multi-valued attributes.
     *  @return declared Collection-, Set-, List-, and Map-valued
     *          attributes
     */</span>
    <span class="predefined-type">Set</span>&lt;PluralAttribute&lt;X, ?, ?&gt;&gt; getDeclaredPluralAttributes();


<span class="comment">//String-based:</span>

    <span class="comment">/**
     *  Return the attribute of the managed
     *  type that corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return attribute with given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not present in the managed type
     */</span>
    <span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> X, ?&gt; getAttribute(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the attribute declared by the managed
     *  type that corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return attribute with given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not declared in the managed type
     */</span>
    <span class="predefined-type">Attribute</span>&lt;X, ?&gt; getDeclaredAttribute(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the single-valued attribute of the managed type that
     *  corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return single-valued attribute with the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not present in the managed type
     */</span>
    SingularAttribute&lt;? <span class="local-variable">super</span> X, ?&gt; getSingularAttribute(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the single-valued attribute declared by the managed
     *  type that corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return declared single-valued attribute of the given
     *          name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not declared in the managed type
     */</span>
    SingularAttribute&lt;X, ?&gt; getDeclaredSingularAttribute(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the Collection-valued attribute of the managed type
     *  that corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return CollectionAttribute of the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not present in the managed type
     */</span>
    CollectionAttribute&lt;? <span class="local-variable">super</span> X, ?&gt; getCollection(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the Collection-valued attribute declared by the
     *  managed type that corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return declared CollectionAttribute of the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not declared in the managed type
     */</span>
    CollectionAttribute&lt;X, ?&gt; getDeclaredCollection(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the Set-valued attribute of the managed type that
     *  corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return SetAttribute of the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not present in the managed type
     */</span>
    SetAttribute&lt;? <span class="local-variable">super</span> X, ?&gt; getSet(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the Set-valued attribute declared by the managed type
     *  that corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return declared SetAttribute of the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not declared in the managed type
     */</span>
    SetAttribute&lt;X, ?&gt; getDeclaredSet(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the List-valued attribute of the managed type that
     *  corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return ListAttribute of the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not present in the managed type
     */</span>
    ListAttribute&lt;? <span class="local-variable">super</span> X, ?&gt; getList(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the List-valued attribute declared by the managed
     *  type that corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return declared ListAttribute of the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not declared in the managed type
     */</span>
    ListAttribute&lt;X, ?&gt; getDeclaredList(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the Map-valued attribute of the managed type that
     *  corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return MapAttribute of the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not present in the managed type
     */</span>
    MapAttribute&lt;? <span class="local-variable">super</span> X, ?, ?&gt; getMap(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     *  Return the Map-valued attribute declared by the managed
     *  type that corresponds to the specified name.
     *  @param name  the name of the represented attribute
     *  @return declared MapAttribute of the given name
     *  @throws IllegalArgumentException if attribute of the given
     *          name is not declared in the managed type
     */</span>
    MapAttribute&lt;X, ?, ?&gt; getDeclaredMap(<span class="predefined-type">String</span> name);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="identifiabletype-interface"><a class="anchor" href="#identifiabletype-interface"></a>5.1.4. IdentifiableType Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 *  Instances of the type &lt;code&gt;IdentifiableType&lt;/code&gt; represent entity or
 *  mapped superclass types.
 *
 *  @param &lt;X&gt; The represented entity or mapped superclass type.
 *
 *  @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">IdentifiableType</span>&lt;X&gt; <span class="directive">extends</span> ManagedType&lt;X&gt; {

    <span class="comment">/**
     *  Return the attribute that corresponds to the id attribute of
     *  the entity or mapped superclass.
     *  @param type  the type of the represented id attribute
     *  @return id attribute
     *  @throws IllegalArgumentException if id attribute of the given
     *          type is not present in the identifiable type or if
     *          the identifiable type has an id class
     */</span>
    &lt;Y&gt; SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; getId(<span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     *  Return the attribute that corresponds to the id attribute
     *  declared by the entity or mapped superclass.
     *  @param type  the type of the represented declared
     *               id attribute
     *  @return declared id attribute
     *  @throws IllegalArgumentException if id attribute of the given
     *          type is not declared in the identifiable type or if
     *          the identifiable type has an id class
     */</span>
    &lt;Y&gt; SingularAttribute&lt;X, Y&gt; getDeclaredId(<span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     *  Return the attribute that corresponds to the version
     *  attribute of the entity or mapped superclass.
     *  @param type  the type of the represented version attribute
     *  @return version attribute
     *  @throws IllegalArgumentException if version attribute of the
     *          given type is not present in the identifiable type
     */</span>
    &lt;Y&gt; SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; getVersion(<span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     *  Return the attribute that corresponds to the version
     *  attribute declared by the entity or mapped superclass.
     *  @param type  the type of the represented declared version
     *               attribute
     *  @return declared version attribute
     *  @throws IllegalArgumentException if version attribute of the
     *          type is not declared in the identifiable type
     */</span>
    &lt;Y&gt; SingularAttribute&lt;X, Y&gt; getDeclaredVersion(<span class="predefined-type">Class</span>&lt;Y&gt; type);

    <span class="comment">/**
     *  Return the identifiable type that corresponds to the most
     *  specific mapped superclass or entity extended by the entity
     *  or mapped superclass.
     *  @return supertype of identifiable type or null if no
     *          such supertype
     */</span>
    IdentifiableType&lt;? <span class="local-variable">super</span> X&gt; getSupertype();

    <span class="comment">/**
     *  Whether the identifiable type has a single id attribute.
     *  Returns true for a simple id or embedded id; returns false
     *  for an idclass.
     *  @return boolean indicating whether the identifiable
     *          type has a single id attribute
     */</span>
    <span class="type">boolean</span> hasSingleIdAttribute();

    <span class="comment">/**
     *  Whether the identifiable type has a version attribute.
     *  @return boolean indicating whether the identifiable
     *          type has a version attribute
     */</span>
    <span class="type">boolean</span> hasVersionAttribute();

    <span class="comment">/**
     *   Return the attributes corresponding to the id class of the
     *   identifiable type.
     *   @return id attributes
     *   @throws IllegalArgumentException if the identifiable type
     *           does not have an id class
     */</span>
     <span class="predefined-type">Set</span>&lt;SingularAttribute&lt;? <span class="local-variable">super</span> X, ?&gt;&gt; getIdClassAttributes();

    <span class="comment">/**
     *  Return the type that represents the type of the id.
     *  @return type of id
     */</span>
    <span class="predefined-type">Type</span>&lt;?&gt; getIdType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="entitytype-interface"><a class="anchor" href="#entitytype-interface"></a>5.1.5. EntityType Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 *  Instances of the type &lt;code&gt;EntityType&lt;/code&gt; represent entity types.
 *
 *  @param &lt;X&gt; The represented entity type.
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityType</span>&lt;X&gt;
            <span class="directive">extends</span> IdentifiableType&lt;X&gt;, Bindable&lt;X&gt;{

    <span class="comment">/**
     *  Return the entity name.
     *  @return entity name
     */</span>
    <span class="predefined-type">String</span> getName();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="embeddabletype-interface"><a class="anchor" href="#embeddabletype-interface"></a>5.1.6. EmbeddableType Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 *  Instances of the type &lt;code&gt;EmbeddableType&lt;/code&gt; represent embeddable types.
 *
 *  @param &lt;X&gt; The represented type.
 *
 *  @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EmbeddableType</span>&lt;X&gt; <span class="directive">extends</span> ManagedType&lt;X&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mappedsuperclasstype-interface"><a class="anchor" href="#mappedsuperclasstype-interface"></a>5.1.7. MappedSuperclassType Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 *  Instances of the type &lt;code&gt;MappedSuperclassType&lt;/code&gt; represent mapped
 *  superclass types.
 *
 *  @param &lt;X&gt; The represented entity type
 *  @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MappedSuperclassType</span>&lt;X&gt; <span class="directive">extends</span> IdentifiableType&lt;X&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="basictype-interface"><a class="anchor" href="#basictype-interface"></a>5.1.8. BasicType Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;BasicType&lt;/code&gt; represent basic types (including
 * temporal and enumerated types).
 *
 * @param &lt;X&gt; The type of the represented basic type
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BasicType</span>&lt;X&gt; <span class="directive">extends</span> <span class="predefined-type">Type</span>&lt;X&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bindable-interface"><a class="anchor" href="#bindable-interface"></a>5.1.9. Bindable Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.Path</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;Bindable&lt;/code&gt; represent object or attribute types
 * that can be bound into a {@link Path Path}.
 *
 * @param &lt;T&gt;  The type of the represented object or attribute
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Bindable</span>&lt;T&gt; {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">enum</span> BindableType {

        <span class="comment">/** Single-valued attribute type */</span>
        SINGULAR_ATTRIBUTE,

        <span class="comment">/** Multi-valued attribute type */</span>
        PLURAL_ATTRIBUTE,

        <span class="comment">/** Entity type */</span>
        ENTITY_TYPE
    }

    <span class="comment">/**
     *  Return the bindable type of the represented object.
     *  @return bindable type
     */</span>
    BindableType getBindableType();

    <span class="comment">/**
     * Return the Java type of the represented object.
     * If the bindable type of the object is &lt;code&gt;PLURAL_ATTRIBUTE&lt;/code&gt;,
     * the Java element type is returned. If the bindable type is
     * &lt;code&gt;SINGULAR_ATTRIBUTE&lt;/code&gt; or &lt;code&gt;ENTITY_TYPE&lt;/code&gt;,
     * the Java type of the
     * represented entity or attribute is returned.
     * @return Java type
     */</span>
    <span class="predefined-type">Class</span>&lt;T&gt; getBindableJavaType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="attribute-interface"><a class="anchor" href="#attribute-interface"></a>5.1.10. Attribute Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Represents an attribute of a Java type.
 *
 * @param &lt;X&gt; The represented type that contains the attribute
 * @param &lt;Y&gt; The type of the represented attribute
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Attribute</span>&lt;X, Y&gt; {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">enum</span> PersistentAttributeType {

         <span class="comment">/** Many-to-one association */</span>
         MANY_TO_ONE,

         <span class="comment">/** One-to-one association */</span>
         ONE_TO_ONE,

         <span class="comment">/** Basic attribute */</span>
         BASIC,

         <span class="comment">/** Embeddable class attribute */</span>
         EMBEDDED,

         <span class="comment">/** Many-to-many association */</span>
         MANY_TO_MANY,

         <span class="comment">/** One-to-many association */</span>
         ONE_TO_MANY,

         <span class="comment">/** Element collection */</span>
         ELEMENT_COLLECTION
    }

    <span class="comment">/**
     * Return the name of the attribute.
     * @return name
     */</span>
    <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     *  Return the persistent attribute type for the attribute.
     *  @return persistent attribute type
     */</span>
    PersistentAttributeType getPersistentAttributeType();

    <span class="comment">/**
     *  Return the managed type representing the type in which
     *  the attribute was declared.
     *  @return declaring type
     */</span>
    ManagedType&lt;X&gt; getDeclaringType();

    <span class="comment">/**
     *  Return the Java type of the represented attribute.
     *  @return Java type
     */</span>
    <span class="predefined-type">Class</span>&lt;Y&gt; getJavaType();

    <span class="comment">/**
     *  Return the &lt;code&gt;java.lang.reflect.Member&lt;/code&gt; for the represented
     *  attribute.
     *  @return corresponding &lt;code&gt;java.lang.reflect.Member&lt;/code&gt;
     */</span>
    java.lang.reflect.Member getJavaMember();

    <span class="comment">/**
     *  Is the attribute an association.
     *  @return boolean indicating whether the attribute
     *          corresponds to an association
     */</span>
    <span class="type">boolean</span> isAssociation();

    <span class="comment">/**
     *  Is the attribute collection-valued (represents a Collection,
     *  Set, List, or Map).
     *  @return boolean indicating whether the attribute is
     *          collection-valued
     */</span>
    <span class="type">boolean</span> isCollection();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="singularattribute-interface"><a class="anchor" href="#singularattribute-interface"></a>5.1.11. SingularAttribute Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;SingularAttribute&lt;/code&gt; represents persistent
 * single-valued properties or fields.
 *
 * @param &lt;X&gt; The type containing the represented attribute
 * @param &lt;T&gt; The type of the represented attribute
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">SingularAttribute</span>&lt;X, T&gt;
        <span class="directive">extends</span> <span class="predefined-type">Attribute</span>&lt;X, T&gt;, Bindable&lt;T&gt; {

    <span class="comment">/**
     *  Is the attribute an id attribute.  This method will return
     *  true if the attribute is an attribute that corresponds to
     *  a simple id, an embedded id, or an attribute of an id class.
     *  @return boolean indicating whether the attribute is an id
     */</span>
    <span class="type">boolean</span> isId();

    <span class="comment">/**
     *  Is the attribute a version attribute.
     *  @return boolean indicating whether the attribute is
     *          a version attribute
     */</span>
    <span class="type">boolean</span> isVersion();

    <span class="comment">/**
     *  Can the attribute be null.
     *  @return boolean indicating whether the attribute can
     *          be null
     */</span>
    <span class="type">boolean</span> isOptional();

    <span class="comment">/**
     * Return the type that represents the type of the attribute.
     * @return type of attribute
     */</span>
    <span class="predefined-type">Type</span>&lt;T&gt; getType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="pluralattribute-interface"><a class="anchor" href="#pluralattribute-interface"></a>5.1.12. PluralAttribute Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;PluralAttribute&lt;/code&gt; represent
 * persistent collection-valued attributes.
 *
 * @param &lt;X&gt; The type the represented collection belongs to
 * @param &lt;C&gt; The type of the represented collection
 * @param &lt;E&gt; The element type of the represented collection
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PluralAttribute</span>&lt;X, C, E&gt;
        <span class="directive">extends</span> <span class="predefined-type">Attribute</span>&lt;X, C&gt;, Bindable&lt;E&gt; {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">enum</span> CollectionType {

        <span class="comment">/** Collection-valued attribute */</span>
        COLLECTION,

        <span class="comment">/** Set-valued attribute */</span>
        SET,

        <span class="comment">/** List-valued attribute */</span>
        LIST,

        <span class="comment">/** Map-valued attribute */</span>
        MAP
    }

    <span class="comment">/**
     * Return the collection type.
     * @return collection type
     */</span>
    CollectionType getCollectionType();

    <span class="comment">/**
     * Return the type representing the element type of the
     * collection.
     * @return element type
     */</span>
    <span class="predefined-type">Type</span>&lt;E&gt; getElementType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="collectionattribute-interface"><a class="anchor" href="#collectionattribute-interface"></a>5.1.13. CollectionAttribute Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;CollectionAttribute&lt;/code&gt; represent persistent
 * &lt;code&gt;java.util.Collection&lt;/code&gt;-valued attributes.
 *
 * @param &lt;X&gt; The type the represented Collection belongs to
 * @param &lt;E&gt; The element type of the represented Collection
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CollectionAttribute</span>&lt;X, E&gt;
    <span class="directive">extends</span> PluralAttribute&lt;X, java.util.Collection&lt;E&gt;, E&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="setattribute-interface"><a class="anchor" href="#setattribute-interface"></a>5.1.14. SetAttribute Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;SetAttribute&lt;/code&gt; represent
 * persistent &lt;code&gt;java.util.Set&lt;/code&gt;-valued attributes.
 *
 * @param &lt;X&gt; The type the represented Set belongs to
 * @param &lt;E&gt; The element type of the represented Set
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">SetAttribute</span>&lt;X, E&gt;
    <span class="directive">extends</span> PluralAttribute&lt;X, java.util.Set&lt;E&gt;, E&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="listattribute-interface"><a class="anchor" href="#listattribute-interface"></a>5.1.15. ListAttribute Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;ListAttribute&lt;/code&gt; represent persistent
 * &lt;code&gt;java.util.List&lt;/code&gt;-valued attributes.
 *
 * @param &lt;X&gt; The type the represented List belongs to
 * @param &lt;E&gt; The element type of the represented List
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ListAttribute</span>&lt;X, E&gt;
        <span class="directive">extends</span> PluralAttribute&lt;X, java.util.List&lt;E&gt;, E&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapattribute-interface"><a class="anchor" href="#mapattribute-interface"></a>5.1.16. MapAttribute Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="comment">/**
 * Instances of the type &lt;code&gt;MapAttribute&lt;/code&gt; represent
 * persistent &lt;code&gt;java.util.Map&lt;/code&gt;-valued attributes.
 *
 * @param &lt;X&gt; The type the represented Map belongs to
 * @param &lt;K&gt; The type of the key of the represented Map
 * @param &lt;V&gt; The type of the value of the represented Map
 *
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MapAttribute</span>&lt;X, K, V&gt;
    <span class="directive">extends</span> PluralAttribute&lt;X, java.util.Map&lt;K, V&gt;, V&gt; {

    <span class="comment">/**
     * Return the Java type of the map key.
     * @return Java key type
     */</span>
    <span class="predefined-type">Class</span>&lt;K&gt; getKeyJavaType();

    <span class="comment">/**
     * Return the type representing the key type of the map.
     * @return type representing key type
     */</span>
    <span class="predefined-type">Type</span>&lt;K&gt; getKeyType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="staticmetamodel-annotation"><a class="anchor" href="#staticmetamodel-annotation"></a>5.1.17. StaticMetamodel Annotation</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.metamodel</span>;

<span class="keyword">import</span> <span class="include">java.lang.annotation.ElementType</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Retention</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.RetentionPolicy</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Target</span>;

<span class="comment">/**
 * The &lt;code&gt;StaticMetamodel&lt;/code&gt; annotation specifies that the class
 * is a metamodel class that represents the entity, mapped
 * superclass, or embeddable class designated by the value
 * element.
 *
 * @since 2.0
 */</span>
<span class="annotation">@Target</span>(<span class="predefined-type">ElementType</span>.TYPE)
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> StaticMetamodel {

    <span class="comment">/**
     * Class being modelled by the annotated class.
     */</span>
    <span class="predefined-type">Class</span>&lt;?&gt; value();
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a6925"><a class="anchor" href="#a6925"></a>6. Criteria API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Jakarta Persistence Criteria API is used to
define queries through the construction of object-based query definition
objects, rather than use of the string-based approach of the Jakarta
Persistence query language described in <a href="#a4665">Chapter 4</a>.</p>
</div>
<div class="paragraph">
<p>This chapter provides the full definition of the Criteria API.</p>
</div>
<div class="sect2">
<h3 id="overview-2"><a class="anchor" href="#overview-2"></a>6.1. Overview</h3>
<div class="paragraph">
<p>The Jakarta Persistence Criteria API, like the
Jakarta Persistence query language is based on the abstract persistence
schema of entities, their embedded objects, and their relationships as
its data model. This abstract persistence schema is materialized in the
form of metamodel objects over which the Criteria API operates. The
semantics of criteria queries are designed to reflect those of Jakarta
Persistence query language queries.</p>
</div>
<div class="paragraph">
<p>The syntax of the Criteria API is designed to
allow the construction of an object-based query “graph”, whose nodes
correspond to the semantic query elements.</p>
</div>
<div class="paragraph">
<p>Java language variables can be used to
reference individual nodes in a criteria query object as it is
constructed and/or modified. Such variables, when used to refer to the
entities and embeddable types that constitute the query domain, play a
role analogous to that of the identification variables of the Jakarta
Persistence query language.</p>
</div>
<div class="paragraph">
<p>These concepts are further described in the
sections that follow. The metamodel on which criteria queries are based
is presented in <a href="#a6072">Chapter 5</a>.
The static metamodel classes that can be used in constructing
strongly-typed criteria queries are described in <a href="#a6933">Section 6.2</a>. The
<em>jakarta.persistence.criteria</em> interfaces are presented in <a href="#a6997">Section 6.3</a>. Sections
<a href="#a10608">Section 6.4</a> through <a href="#a11413">Section 6.8</a> describe the
construction and modification of criteria query objects. Additional
requirements on the persistence provider are described in <a href="#a11427">Section 6.9</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a6933"><a class="anchor" href="#a6933"></a>6.2. Metamodel</h3>
<div class="paragraph">
<p>Jakarta Persistence criteria queries are based
on a metamodel of the managed classes of the persistence unit. Static
metamodel classes corresponding to the managed classes of the
persistence unit can be generated by means of an annotation processor or
can be created by the application developer, or the metamodel can be
accessed dynamically by use of the
<em>jakarta.persistence.metamodel.Metamodel</em> interface. The <em>getMetamodel</em>
method of the <em>EntityManagerFactory</em> or <em>EntityManager</em> interface can be
used to obtain a <em>Metamodel</em> instance.</p>
</div>
<div class="sect3">
<h4 id="static-metamodel-classes"><a class="anchor" href="#static-metamodel-classes"></a>6.2.1. Static Metamodel Classes</h4>
<div class="paragraph">
<p>In the typical case, an annotation processor
is expected to be used to produce static metamodel classes corresponding
to the entities, mapped superclasses, and embeddable classes in the
persistence unit. A static metamodel class models the persistent state
and relationships of the corresponding managed class. For portability,
an annotation processor should generate a canonical metamodel as defined
below.</p>
</div>
<div class="sect4">
<h5 id="canonical-metamodel"><a class="anchor" href="#canonical-metamodel"></a>6.2.1.1. Canonical Metamodel</h5>
<div class="paragraph">
<p>This specification defines as follows a
canonical metamodel and the structure of canonical metamodel classes.</p>
</div>
<div class="paragraph">
<p>For every managed class in the persistence
unit, a corresponding metamodel class is produced as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For each managed class <em>X</em> in package
<em>p</em>, a metamodel class <em>X_</em> in package <em>p</em> is
created.<sup class="footnote">[<a id="_footnoteref_73" class="footnote" href="#_footnotedef_73" title="View footnote.">73</a>]</sup></p>
</li>
<li>
<p>The name of the metamodel class is derived
from the name of the managed class by appending " <em>_</em> " to the name of
the managed class.</p>
</li>
<li>
<p>The metamodel class <em>X_</em> must be annotated
with the <em>jakarta.persistence.StaticMetamodel</em>
annotation<sup class="footnote">[<a id="_footnoteref_74" class="footnote" href="#_footnotedef_74" title="View footnote.">74</a>]</sup>.</p>
</li>
<li>
<p>If class <em>X</em> extends another class <em>S</em>,
where <em>S</em> is the most derived managed class (i.e., entity or mapped
superclass) extended by <em>X</em>, then class <em>X<em> must extend class _S</em>,
where _S_</em> is the metamodel class created for <em>S</em>.</p>
</li>
<li>
<p>For every persistent non-collection-valued
attribute <em>y</em> declared by class <em>X</em>, where the type of <em>y</em> is <em>Y</em>, the
metamodel class must contain a declaration as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;X, Y&gt; y;</code></pre>
</div>
</div>
</li>
<li>
<p>For every persistent collection-valued
attribute <em>z</em> declared by class <em>X</em>, where the element type of <em>z</em> is
<em>Z</em>, the metamodel class must contain a declaration as follows:</p>
<div class="ulist">
<ul>
<li>
<p>if the collection type of <em>z</em> is <em>java.util.Collection</em>, then</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> CollectionAttribute&lt;X, Z&gt; z;</code></pre>
</div>
</div>
</li>
<li>
<p>if the collection type of <em>z</em> is <em>java.util.Set</em>, then</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SetAttribute&lt;X, Z&gt; z;</code></pre>
</div>
</div>
</li>
<li>
<p>if the collection type of <em>z</em> is <em>java.util.List</em>, then</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> ListAttribute&lt;X, Z&gt; z;</code></pre>
</div>
</div>
</li>
<li>
<p>if the collection type of <em>z</em> is <em>java.util.Map</em>, then</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> MapAttribute&lt;X, K, Z&gt; z;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <em>K</em> is the type of the key of the map in class <em>X</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Import statements must be included for the
needed <em>jakarta.persistence.metamodel</em> types as appropriate (e.g.,
<em>jakarta.persistence.metamodel.SingularAttribute</em>,
<em>jakarta.persistence.metamodel.CollectionAttribute</em>,
<em>jakarta.persistence.metamodel.SetAttribute</em>,
<em>jakarta.persistence.metamodel.ListAttribute</em>,
<em>jakarta.persistence.metamodel.MapAttribute</em>) and all classes <em>X</em>, <em>Y</em>,
<em>Z</em>, and <em>K</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Implementations of this specification are
not required to support the use of non-canonical metamodel classes.
Applications that use non-canonical metamodel classes will not be
portable.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="a6961"><a class="anchor" href="#a6961"></a>6.2.1.2. Example</h5>
<div class="paragraph">
<p>Assume the <em>Order</em> entity below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example</span>;

<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">java.math.BigDecimal</span>;

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">Integer</span> orderId;

    <span class="annotation">@ManyToOne</span>
    Customer customer;

    <span class="annotation">@OneToMany</span>
    <span class="predefined-type">Set</span>&lt;Item&gt; lineItems;

    Address shippingAddress;

    <span class="predefined-type">BigDecimal</span> totalCost;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The corresponding canonical metamodel class,
<em>Order</em>, is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example</span>;

<span class="keyword">import</span> <span class="include">java.math.BigDecimal</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SetAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.StaticMetamodel</span>;

<span class="annotation">@StaticMetamodel</span>(Order.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;Order, <span class="predefined-type">Integer</span>&gt; orderId;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;Order, Customer&gt; customer;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SetAttribute&lt;Order, Item&gt; lineItems;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;Order, Address&gt; shippingAddress;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">volatile</span> SingularAttribute&lt;Order, <span class="predefined-type">BigDecimal</span>&gt; totalCost;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bootstrapping"><a class="anchor" href="#bootstrapping"></a>6.2.2. Bootstrapping</h4>
<div class="paragraph">
<p>When the entity manager factory for a
persistence unit is created, it is the responsibility of the persistence
provider to initialize the state of the metamodel classes of the
persistence unit. Any generated metamodel classes must be accessible on
the classpath.</p>
</div>
<div class="paragraph">
<p>Persistence providers must support the use of
canonical metamodel classes. Persistence providers may, but are not
required to, support the use of non-canonical metamodel classes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a6997"><a class="anchor" href="#a6997"></a>6.3. Criteria API Interfaces</h3>
<div class="sect3">
<h4 id="criteriabuilder-interface"><a class="anchor" href="#criteriabuilder-interface"></a>6.3.1. CriteriaBuilder Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.math.BigDecimal</span>;
<span class="keyword">import</span> <span class="include">java.math.BigInteger</span>;
<span class="keyword">import</span> <span class="include">java.util.Collection</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.Tuple</span>;

<span class="comment">/**
 * Used to construct criteria queries, compound selections,
 * expressions, predicates, orderings.
 *
 * &lt;p&gt; Note that &lt;code&gt;Predicate&lt;/code&gt; is used instead of &lt;code&gt;Expression&amp;#060;Boolean&amp;#062;&lt;/code&gt;
 * in this API in order to work around the fact that Java
 * generics are not compatible with varags.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaBuilder</span> {

    <span class="comment">/**
     *  Create a &lt;code&gt;CriteriaQuery&lt;/code&gt; object.
     *  @return criteria query object
     */</span>
    CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; createQuery();

    <span class="comment">/**
     *  Create a &lt;code&gt;CriteriaQuery&lt;/code&gt; object with the specified result
     *  type.
     *  @param resultClass  type of the query result
     *  @return criteria query object
     */</span>
    &lt;T&gt; CriteriaQuery&lt;T&gt; createQuery(<span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">/**
     *  Create a &lt;code&gt;CriteriaQuery&lt;/code&gt; object that returns a tuple of
     *  objects as its result.
     *  @return criteria query object
     */</span>
    CriteriaQuery&lt;Tuple&gt; createTupleQuery();

    <span class="comment">// methods to construct queries for bulk updates and deletes:</span>

    <span class="comment">/**
     *  Create a &lt;code&gt;CriteriaUpdate&lt;/code&gt; query object to perform a bulk update operation.
     *  @param targetEntity  target type for update operation
     *  @return the query object
     *  @since 2.1
     */</span>
    &lt;T&gt; CriteriaUpdate&lt;T&gt; createCriteriaUpdate(<span class="predefined-type">Class</span>&lt;T&gt; targetEntity);

    <span class="comment">/**
     *  Create a &lt;code&gt;CriteriaDelete&lt;/code&gt; query object to perform a bulk delete operation.
     *  @param targetEntity  target type for delete operation
     *  @return the query object
     *  @since 2.1
     */</span>
    &lt;T&gt; CriteriaDelete&lt;T&gt; createCriteriaDelete(<span class="predefined-type">Class</span>&lt;T&gt; targetEntity);


    <span class="comment">// selection construction methods:</span>

    <span class="comment">/**
     * Create a selection item corresponding to a constructor.
     * This method is used to specify a constructor that will be
     * applied to the results of the query execution. If the
     * constructor is for an entity class, the resulting entities
     * will be in the new state after the query is executed.
     * @param resultClass  class whose instance is to be constructed
     * @param selections  arguments to the constructor
     * @return compound selection item
     * @throws IllegalArgumentException if an argument is a
     *         tuple- or array-valued selection item
     */</span>
    &lt;Y&gt; CompoundSelection&lt;Y&gt; construct(<span class="predefined-type">Class</span>&lt;Y&gt; resultClass, Selection&lt;?&gt;... selections);

    <span class="comment">/**
     * Create a tuple-valued selection item.
     * @param selections  selection items
     * @return tuple-valued compound selection
     * @throws IllegalArgumentException if an argument is a
     *         tuple- or array-valued selection item
     */</span>
    CompoundSelection&lt;Tuple&gt; tuple(Selection&lt;?&gt;... selections);

    <span class="comment">/**
     * Create an array-valued selection item.
     * @param selections  selection items
     * @return array-valued compound selection
     * @throws IllegalArgumentException if an argument is a
     *         tuple- or array-valued selection item
     */</span>
    CompoundSelection&lt;<span class="predefined-type">Object</span><span class="type">[]</span>&gt; array(Selection&lt;?&gt;... selections);


    <span class="comment">//ordering:</span>

    <span class="comment">/**
     * Create an ordering by the ascending value of the expression.
     * @param x  expression used to define the ordering
     * @return ascending ordering corresponding to the expression
     */</span>
    Order asc(<span class="predefined-type">Expression</span>&lt;?&gt; x);

    <span class="comment">/**
     * Create an ordering by the descending value of the expression.
     * @param x  expression used to define the ordering
     * @return descending ordering corresponding to the expression
     */</span>
    Order desc(<span class="predefined-type">Expression</span>&lt;?&gt; x);


    <span class="comment">//aggregate functions:</span>

    <span class="comment">/**
     * Create an aggregate expression applying the avg operation.
     * @param x  expression representing input value to avg operation
     * @return avg expression
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; avg(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the sum operation.
     * @param x  expression representing input value to sum operation
     * @return sum expression
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; sum(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the sum operation to an
     * Integer-valued expression, returning a Long result.
     * @param x  expression representing input value to sum operation
     * @return sum expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Long</span>&gt; sumAsLong(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the sum operation to a
     * Float-valued expression, returning a Double result.
     * @param x  expression representing input value to sum operation
     * @return sum expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; sumAsDouble(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Float</span>&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the numerical max
     * operation.
     * @param x  expression representing input value to max operation
     * @return max expression
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; max(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the numerical min
     * operation.
     * @param x  expression representing input value to min operation
     * @return min expression
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; min(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an aggregate expression for finding the greatest of
     * the values (strings, dates, etc).
     * @param x  expression representing input value to greatest
     *           operation
     * @return greatest expression
     */</span>
    &lt;X <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> X&gt;&gt; <span class="predefined-type">Expression</span>&lt;X&gt; greatest(<span class="predefined-type">Expression</span>&lt;X&gt; x);

    <span class="comment">/**
     * Create an aggregate expression for finding the least of
     * the values (strings, dates, etc).
     * @param x  expression representing input value to least
     *           operation
     * @return least expression
     */</span>
    &lt;X <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> X&gt;&gt; <span class="predefined-type">Expression</span>&lt;X&gt; least(<span class="predefined-type">Expression</span>&lt;X&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the count operation.
     * @param x  expression representing input value to count
     *           operation
     * @return count expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Long</span>&gt; count(<span class="predefined-type">Expression</span>&lt;?&gt; x);

    <span class="comment">/**
     * Create an aggregate expression applying the count distinct
     * operation.
     * @param x  expression representing input value to
     *        count distinct operation
     * @return count distinct expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Long</span>&gt; countDistinct(<span class="predefined-type">Expression</span>&lt;?&gt; x);



    <span class="comment">//subqueries:</span>

    <span class="comment">/**
     * Create a predicate testing the existence of a subquery result.
     * @param subquery  subquery whose result is to be tested
     * @return exists predicate
     */</span>
    <span class="predefined-type">Predicate</span> exists(Subquery&lt;?&gt; subquery);

    <span class="comment">/**
     * Create an all expression over the subquery results.
     * @param subquery  subquery
     * @return all expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; all(Subquery&lt;Y&gt; subquery);

    <span class="comment">/**
     * Create a some expression over the subquery results.
     * This expression is equivalent to an &lt;code&gt;any&lt;/code&gt; expression.
     * @param subquery  subquery
     * @return some expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; some(Subquery&lt;Y&gt; subquery);

    <span class="comment">/**
     * Create an any expression over the subquery results.
     * This expression is equivalent to a &lt;code&gt;some&lt;/code&gt; expression.
     * @param subquery  subquery
     * @return any expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; any(Subquery&lt;Y&gt; subquery);


    <span class="comment">//boolean functions:</span>

    <span class="comment">/**
     * Create a conjunction of the given boolean expressions.
     * @param x  boolean expression
     * @param y  boolean expression
     * @return and predicate
     */</span>
    <span class="predefined-type">Predicate</span> and(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; y);

    <span class="comment">/**
     * Create a conjunction of the given restriction predicates.
     * A conjunction of zero predicates is true.
     * @param restrictions  zero or more restriction predicates
     * @return and predicate
     */</span>
    <span class="predefined-type">Predicate</span> and(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Create a disjunction of the given boolean expressions.
     * @param x  boolean expression
     * @param y  boolean expression
     * @return or predicate
     */</span>
    <span class="predefined-type">Predicate</span> or(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; y);

    <span class="comment">/**
     * Create a disjunction of the given restriction predicates.
     * A disjunction of zero predicates is false.
     * @param restrictions  zero or more restriction predicates
     * @return or predicate
     */</span>
    <span class="predefined-type">Predicate</span> or(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Create a negation of the given restriction.
     * @param restriction  restriction expression
     * @return not predicate
     */</span>
    <span class="predefined-type">Predicate</span> not(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Create a conjunction (with zero conjuncts).
     * A conjunction with zero conjuncts is true.
     * @return and predicate
     */</span>
    <span class="predefined-type">Predicate</span> conjunction();

    <span class="comment">/**
     * Create a disjunction (with zero disjuncts).
     * A disjunction with zero disjuncts is false.
     * @return or predicate
     */</span>
    <span class="predefined-type">Predicate</span> disjunction();


    <span class="comment">//turn Expression&lt;Boolean&gt; into a Predicate</span>
    <span class="comment">//useful for use with varargs methods</span>

    <span class="comment">/**
     * Create a predicate testing for a true value.
     * @param x  expression to be tested
     * @return predicate
     */</span>
    <span class="predefined-type">Predicate</span> isTrue(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; x);

    <span class="comment">/**
     * Create a predicate testing for a false value.
     * @param x  expression to be tested
     * @return predicate
     */</span>
    <span class="predefined-type">Predicate</span> isFalse(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; x);


    <span class="comment">//null tests:</span>

    <span class="comment">/**
     * Create a predicate to test whether the expression is null.
     * @param x expression
     * @return is-null predicate
     */</span>
    <span class="predefined-type">Predicate</span> isNull(<span class="predefined-type">Expression</span>&lt;?&gt; x);

    <span class="comment">/**
     * Create a predicate to test whether the expression is not null.
     * @param x expression
     * @return is-not-null predicate
     */</span>
    <span class="predefined-type">Predicate</span> isNotNull(<span class="predefined-type">Expression</span>&lt;?&gt; x);

    <span class="comment">//equality:</span>

    <span class="comment">/**
     * Create a predicate for testing the arguments for equality.
     * @param x  expression
     * @param y  expression
     * @return equality predicate
     */</span>
    <span class="predefined-type">Predicate</span> equal(<span class="predefined-type">Expression</span>&lt;?&gt; x, <span class="predefined-type">Expression</span>&lt;?&gt; y);

    <span class="comment">/**
     * Create a predicate for testing the arguments for equality.
     * @param x  expression
     * @param y  object
     * @return equality predicate
     */</span>
    <span class="predefined-type">Predicate</span> equal(<span class="predefined-type">Expression</span>&lt;?&gt; x, <span class="predefined-type">Object</span> y);

    <span class="comment">/**
     * Create a predicate for testing the arguments for inequality.
     * @param x  expression
     * @param y  expression
     * @return inequality predicate
     */</span>
    <span class="predefined-type">Predicate</span> notEqual(<span class="predefined-type">Expression</span>&lt;?&gt; x, <span class="predefined-type">Expression</span>&lt;?&gt; y);

    <span class="comment">/**
     * Create a predicate for testing the arguments for inequality.
     * @param x  expression
     * @param y  object
     * @return inequality predicate
     */</span>
    <span class="predefined-type">Predicate</span> notEqual(<span class="predefined-type">Expression</span>&lt;?&gt; x, <span class="predefined-type">Object</span> y);


    <span class="comment">//comparisons for generic (non-numeric) operands:</span>

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * greater than the second.
     * @param x  expression
     * @param y  expression
     * @return greater-than predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> greaterThan(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * greater than the second.
     * @param x  expression
     * @param y  value
     * @return greater-than predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> greaterThan(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * greater than or equal to the second.
     * @param x  expression
     * @param y  expression
     * @return greater-than-or-equal predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> greaterThanOrEqualTo(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * greater than or equal to the second.
     * @param x  expression
     * @param y  value
     * @return greater-than-or-equal predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> greaterThanOrEqualTo(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * less than the second.
     * @param x  expression
     * @param y  expression
     * @return less-than predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> lessThan(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * less than the second.
     * @param x  expression
     * @param y  value
     * @return less-than predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> lessThan(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * less than or equal to the second.
     * @param x  expression
     * @param y  expression
     * @return less-than-or-equal predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> lessThanOrEqualTo(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * less than or equal to the second.
     * @param x  expression
     * @param y  value
     * @return less-than-or-equal predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> lessThanOrEqualTo(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * between the second and third arguments in value.
     * @param v  expression
     * @param x  expression
     * @param y  expression
     * @return between predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> between(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; v, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * between the second and third arguments in value.
     * @param v  expression
     * @param x  value
     * @param y  value
     * @return between predicate
     */</span>
    &lt;Y <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;? <span class="local-variable">super</span> Y&gt;&gt; <span class="predefined-type">Predicate</span> between(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; v, Y x, Y y);


    <span class="comment">//comparisons for numeric operands:</span>

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * greater than the second.
     * @param x  expression
     * @param y  expression
     * @return greater-than predicate
     */</span>
    <span class="predefined-type">Predicate</span> gt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * greater than the second.
     * @param x  expression
     * @param y  value
     * @return greater-than predicate
     */</span>
    <span class="predefined-type">Predicate</span> gt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * greater than or equal to the second.
     * @param x  expression
     * @param y  expression
     * @return greater-than-or-equal predicate
     */</span>
    <span class="predefined-type">Predicate</span> ge(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * greater than or equal to the second.
     * @param x  expression
     * @param y  value
     * @return greater-than-or-equal predicate
     */</span>
    <span class="predefined-type">Predicate</span> ge(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * less than the second.
     * @param x  expression
     * @param y  expression
     * @return less-than predicate
     */</span>
    <span class="predefined-type">Predicate</span> lt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * less than the second.
     * @param x  expression
     * @param y  value
     * @return less-than predicate
     */</span>
    <span class="predefined-type">Predicate</span> lt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * less than or equal to the second.
     * @param x  expression
     * @param y  expression
     * @return less-than-or-equal predicate
     */</span>
    <span class="predefined-type">Predicate</span> le(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create a predicate for testing whether the first argument is
     * less than or equal to the second.
     * @param x  expression
     * @param y  value
     * @return less-than-or-equal predicate
     */</span>
    <span class="predefined-type">Predicate</span> le(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);


    <span class="comment">//numerical operations:</span>

    <span class="comment">/**
     * Create an expression that returns the arithmetic negation
     * of its argument.
     * @param x expression
     * @return arithmetic negation
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; neg(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an expression that returns the absolute value
     * of its argument.
     * @param x expression
     * @return absolute value
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; abs(<span class="predefined-type">Expression</span>&lt;N&gt; x);

    <span class="comment">/**
     * Create an expression that returns the sum
     * of its arguments.
     * @param x expression
     * @param y expression
     * @return sum
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; sum(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the sum
     * of its arguments.
     * @param x expression
     * @param y value
     * @return sum
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; sum(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, N y);

    <span class="comment">/**
     * Create an expression that returns the sum
     * of its arguments.
     * @param x value
     * @param y expression
     * @return sum
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; sum(N x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the product
     * of its arguments.
     * @param x expression
     * @param y expression
     * @return product
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; prod(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the product
     * of its arguments.
     * @param x expression
     * @param y value
     * @return product
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; prod(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, N y);

    <span class="comment">/**
     * Create an expression that returns the product
     * of its arguments.
     * @param x value
     * @param y expression
     * @return product
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; prod(N x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the difference
     * between its arguments.
     * @param x expression
     * @param y expression
     * @return difference
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; diff(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the difference
     * between its arguments.
     * @param x expression
     * @param y value
     * @return difference
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; diff(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; x, N y);

    <span class="comment">/**
     * Create an expression that returns the difference
     * between its arguments.
     * @param x value
     * @param y expression
     * @return difference
     */</span>
    &lt;N <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="predefined-type">Expression</span>&lt;N&gt; diff(N x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> N&gt; y);

    <span class="comment">/**
     * Create an expression that returns the quotient
     * of its arguments.
     * @param x expression
     * @param y expression
     * @return quotient
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Number</span>&gt; quot(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create an expression that returns the quotient
     * of its arguments.
     * @param x expression
     * @param y value
     * @return quotient
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Number</span>&gt; quot(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x, <span class="predefined-type">Number</span> y);

    <span class="comment">/**
     * Create an expression that returns the quotient
     * of its arguments.
     * @param x value
     * @param y expression
     * @return quotient
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Number</span>&gt; quot(<span class="predefined-type">Number</span> x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; y);

    <span class="comment">/**
     * Create an expression that returns the modulus
     * of its arguments.
     * @param x expression
     * @param y expression
     * @return modulus
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; mod(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; y);

    <span class="comment">/**
     * Create an expression that returns the modulus
     * of its arguments.
     * @param x expression
     * @param y value
     * @return modulus
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; mod(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; x, <span class="predefined-type">Integer</span> y);

    <span class="comment">/**
     * Create an expression that returns the modulus
     * of its arguments.
     * @param x value
     * @param y expression
     * @return modulus
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; mod(<span class="predefined-type">Integer</span> x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; y);

    <span class="comment">/**
     * Create an expression that returns the square root
     * of its argument.
     * @param x expression
     * @return square root
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; sqrt(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; x);


    <span class="comment">//typecasts:</span>

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return Expression&amp;#060;Long&amp;#062;
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Long</span>&gt; toLong(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return Expression&amp;#060;Integer&amp;#062;
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; toInteger(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast. Returns same expression object.
     * @param number  numeric expression
     * @return Expression&amp;#060;Float&amp;#062;
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Float</span>&gt; toFloat(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return Expression&amp;#060;Double&amp;#062;
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Double</span>&gt; toDouble(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return Expression&amp;#060;BigDecimal&amp;#062;
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">BigDecimal</span>&gt; toBigDecimal(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param number  numeric expression
     * @return Expression&amp;#060;BigInteger&amp;#062;
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">BigInteger</span>&gt; toBigInteger(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; number);

    <span class="comment">/**
     * Typecast.  Returns same expression object.
     * @param character expression
     * @return Expression&amp;#060;String&amp;#062;
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; toString(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; character);


    <span class="comment">//literals:</span>

    <span class="comment">/**
     * Create an expression for a literal.
     * @param value  value represented by the expression
     * @return expression literal
     * @throws IllegalArgumentException if value is null
     */</span>
    &lt;T&gt; <span class="predefined-type">Expression</span>&lt;T&gt; literal(T value);

    <span class="comment">/**
     * Create an expression for a null literal with the given type.
     * @param resultClass  type of the null literal
     * @return null expression literal
     */</span>
    &lt;T&gt; <span class="predefined-type">Expression</span>&lt;T&gt; nullLiteral(<span class="predefined-type">Class</span>&lt;T&gt; resultClass);

    <span class="comment">//parameters:</span>

    <span class="comment">/**
     * Create a parameter expression.
     * @param paramClass parameter class
     * @return parameter expression
     */</span>
    &lt;T&gt; ParameterExpression&lt;T&gt; parameter(<span class="predefined-type">Class</span>&lt;T&gt; paramClass);

    <span class="comment">/**
     * Create a parameter expression with the given name.
     * @param paramClass parameter class
     * @param name  name that can be used to refer to
     *              the parameter
     * @return parameter expression
     */</span>
    &lt;T&gt; ParameterExpression&lt;T&gt; parameter(<span class="predefined-type">Class</span>&lt;T&gt; paramClass, <span class="predefined-type">String</span> name);


    <span class="comment">//collection operations:</span>

    <span class="comment">/**
     *  Create a predicate that tests whether a collection is empty.
     *  @param collection expression
     *  @return is-empty predicate
     */</span>
    &lt;C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;?&gt;&gt; <span class="predefined-type">Predicate</span> isEmpty(<span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     *  Create a predicate that tests whether a collection is
     *  not empty.
     *  @param collection expression
     *  @return is-not-empty predicate
     */</span>
    &lt;C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;?&gt;&gt; <span class="predefined-type">Predicate</span> isNotEmpty(<span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     * Create an expression that tests the size of a collection.
     * @param collection expression
     * @return size expression
     */</span>
    &lt;C <span class="directive">extends</span> java.util.Collection&lt;?&gt;&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; size(<span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     * Create an expression that tests the size of a collection.
     * @param collection collection
     * @return size expression
     */</span>
    &lt;C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;?&gt;&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; size(C collection);

    <span class="comment">/**
     *  Create a predicate that tests whether an element is
     *  a member of a collection.
     *  If the collection is empty, the predicate will be false.
     *  @param elem element expression
     *  @param collection expression
     *  @return is-member predicate
     */</span>
    &lt;E, C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;E&gt;&gt; <span class="predefined-type">Predicate</span> isMember(<span class="predefined-type">Expression</span>&lt;E&gt; elem, <span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     *  Create a predicate that tests whether an element is
     *  a member of a collection.
     *  If the collection is empty, the predicate will be false.
     *  @param elem element
     *  @param collection expression
     *  @return is-member predicate
     */</span>
    &lt;E, C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;E&gt;&gt; <span class="predefined-type">Predicate</span> isMember(E elem, <span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     *  Create a predicate that tests whether an element is
     *  not a member of a collection.
     *  If the collection is empty, the predicate will be true.
     *  @param elem element expression
     *  @param collection expression
     *  @return is-not-member predicate
     */</span>
    &lt;E, C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;E&gt;&gt; <span class="predefined-type">Predicate</span> isNotMember(<span class="predefined-type">Expression</span>&lt;E&gt; elem, <span class="predefined-type">Expression</span>&lt;C&gt; collection);

    <span class="comment">/**
     *  Create a predicate that tests whether an element is
     *  not a member of a collection.
     *  If the collection is empty, the predicate will be true.
     *  @param elem element
     *  @param collection expression
     *  @return is-not-member predicate
     */</span>
    &lt;E, C <span class="directive">extends</span> <span class="predefined-type">Collection</span>&lt;E&gt;&gt; <span class="predefined-type">Predicate</span> isNotMember(E elem, <span class="predefined-type">Expression</span>&lt;C&gt; collection);


    <span class="comment">//get the values and keys collections of the Map, which may then</span>
    <span class="comment">//be passed to size(), isMember(), isEmpty(), etc</span>

    <span class="comment">/**
     * Create an expression that returns the values of a map.
     * @param map  map
     * @return collection expression
     */</span>
    &lt;V, M <span class="directive">extends</span> <span class="predefined-type">Map</span>&lt;?, V&gt;&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Collection</span>&lt;V&gt;&gt; values(M map);

    <span class="comment">/**
     * Create an expression that returns the keys of a map.
     * @param map  map
     * @return set expression
     */</span>
    &lt;K, M <span class="directive">extends</span> <span class="predefined-type">Map</span>&lt;K, ?&gt;&gt; <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Set</span>&lt;K&gt;&gt; keys(M map);


    <span class="comment">//string functions:</span>

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @param escapeChar  escape character expression
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @param escapeChar  escape character
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="type">char</span> escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string
     * @param escapeChar  escape character expression
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * satisfies the given pattern.
     * @param x  string expression
     * @param pattern  string
     * @param escapeChar  escape character
     * @return like predicate
     */</span>
    <span class="predefined-type">Predicate</span> like(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="type">char</span> escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @param escapeChar  escape character expression
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string expression
     * @param escapeChar  escape character
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="type">char</span> escapeChar);

    <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string
     * @param escapeChar  escape character expression
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; escapeChar);

   <span class="comment">/**
     * Create a predicate for testing whether the expression
     * does not satisfy the given pattern.
     * @param x  string expression
     * @param pattern  string
     * @param escapeChar  escape character
     * @return not-like predicate
     */</span>
    <span class="predefined-type">Predicate</span> notLike(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="type">char</span> escapeChar);

    <span class="comment">/**
     *  Create an expression for string concatenation.
     *  @param x  string expression
     *  @param y  string expression
     *  @return expression corresponding to concatenation
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; concat(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; y);

    <span class="comment">/**
     *  Create an expression for string concatenation.
     *  @param x  string expression
     *  @param y  string
     *  @return expression corresponding to concatenation
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; concat(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> y);

    <span class="comment">/**
     *  Create an expression for string concatenation.
     *  @param x  string
     *  @param y  string expression
     *  @return expression corresponding to concatenation
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; concat(<span class="predefined-type">String</span> x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; y);

    <span class="comment">/**
     *  Create an expression for substring extraction.
     *  Extracts a substring starting at the specified position
     *  through to end of the string.
     *  First position is 1.
     *  @param x  string expression
     *  @param from  start position expression
     *  @return expression corresponding to substring extraction
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; from);

    <span class="comment">/**
     *  Create an expression for substring extraction.
     *  Extracts a substring starting at the specified position
     *  through to end of the string.
     *  First position is 1.
     *  @param x  string expression
     *  @param from  start position
     *  @return expression corresponding to substring extraction
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="type">int</span> from);

    <span class="comment">/**
     *  Create an expression for substring extraction.
     *  Extracts a substring of given length starting at the
     *  specified position.
     *  First position is 1.
     *  @param x  string expression
     *  @param from  start position expression
     *  @param len  length expression
     *  @return expression corresponding to substring extraction
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; from, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; len);

    <span class="comment">/**
     *  Create an expression for substring extraction.
     *  Extracts a substring of given length starting at the
     *  specified position.
     *  First position is 1.
     *  @param x  string expression
     *  @param from  start position
     *  @param len  length
     *  @return expression corresponding to substring extraction
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; substring(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="type">int</span> from, <span class="type">int</span> len);

    <span class="comment">/**
     *  Used to specify how strings are trimmed.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">enum</span> Trimspec {

        <span class="comment">/**
         * Trim from leading end.
         */</span>
        LEADING,

        <span class="comment">/**
         * Trim from trailing end.
         */</span>
        TRAILING,

        <span class="comment">/**
         * Trim from both ends.
         */</span>
        BOTH
    }

    <span class="comment">/**
     * Create expression to trim blanks from both ends of
     * a string.
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression to trim blanks from a string.
     * @param ts  trim specification
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(Trimspec ts, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression to trim character from both ends of
     * a string.
     * @param t  expression for character to be trimmed
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; t, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression to trim character from a string.
     * @param ts  trim specification
     * @param t  expression for character to be trimmed
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(Trimspec ts, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Character</span>&gt; t, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression to trim character from both ends of
     * a string.
     * @param t  character to be trimmed
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(<span class="type">char</span> t, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression to trim character from a string.
     * @param ts  trim specification
     * @param t  character to be trimmed
     * @param x  expression for string to trim
     * @return trim expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; trim(Trimspec ts, <span class="type">char</span> t, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression for converting a string to lowercase.
     * @param x  string expression
     * @return expression to convert to lowercase
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; lower(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression for converting a string to uppercase.
     * @param x  string expression
     * @return expression to convert to uppercase
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; upper(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);

    <span class="comment">/**
     * Create expression to return length of a string.
     * @param x  string expression
     * @return length expression
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; length(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x);


    <span class="comment">/**
     * Create expression to locate the position of one string
     * within another, returning position of first character
     * if found.
     * The first position in a string is denoted by 1.  If the
     * string to be located is not found, 0 is returned.
     * @param x  expression for string to be searched
     * @param pattern  expression for string to be located
     * @return expression corresponding to position
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; locate(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern);

    <span class="comment">/**
     * Create expression to locate the position of one string
     * within another, returning position of first character
     * if found.
     * The first position in a string is denoted by 1.  If the
     * string to be located is not found, 0 is returned.
     * @param x  expression for string to be searched
     * @param pattern  string to be located
     * @return expression corresponding to position
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; locate(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern);

    <span class="comment">/**
     * Create expression to locate the position of one string
     * within another, returning position of first character
     * if found.
     * The first position in a string is denoted by 1.  If the
     * string to be located is not found, 0 is returned.
     * @param x  expression for string to be searched
     * @param pattern  expression for string to be located
     * @param from  expression for position at which to start search
     * @return expression corresponding to position
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; locate(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; pattern, <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; from);

    <span class="comment">/**
     * Create expression to locate the position of one string
     * within another, returning position of first character
     * if found.
     * The first position in a string is denoted by 1.  If the
     * string to be located is not found, 0 is returned.
     * @param x  expression for string to be searched
     * @param pattern  string to be located
     * @param from  position at which to start search
     * @return expression corresponding to position
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; locate(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">String</span>&gt; x, <span class="predefined-type">String</span> pattern, <span class="type">int</span> from);


    <span class="comment">// Date/time/timestamp functions:</span>

    <span class="comment">/**
     *  Create expression to return current date.
     *  @return expression for current date
     */</span>
    <span class="predefined-type">Expression</span>&lt;java.sql.Date&gt; currentDate();

    <span class="comment">/**
     *  Create expression to return current timestamp.
     *  @return expression for current timestamp
     */</span>
    <span class="predefined-type">Expression</span>&lt;java.sql.Timestamp&gt; currentTimestamp();

    <span class="comment">/**
     *  Create expression to return current time.
     *  @return expression for current time
     */</span>
    <span class="predefined-type">Expression</span>&lt;java.sql.Time&gt; currentTime();


    <span class="comment">//in builders:</span>

    <span class="comment">/**
     *  Interface used to build in predicates.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">interface</span> <span class="class">In</span>&lt;T&gt; <span class="directive">extends</span> <span class="predefined-type">Predicate</span> {

         <span class="comment">/**
          * Return the expression to be tested against the
          * list of values.
          * @return expression
          */</span>
         <span class="predefined-type">Expression</span>&lt;T&gt; getExpression();

         <span class="comment">/**
          *  Add to list of values to be tested against.
          *  @param value value
          *  @return in predicate
          */</span>
         In&lt;T&gt; value(T value);

         <span class="comment">/**
          *  Add to list of values to be tested against.
          *  @param value expression
          *  @return in predicate
          */</span>
         In&lt;T&gt; value(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> T&gt; value);
     }

    <span class="comment">/**
     *  Create predicate to test whether given expression
     *  is contained in a list of values.
     *  @param  expression to be tested against list of values
     *  @return  in predicate
     */</span>
    &lt;T&gt; In&lt;T&gt; in(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> T&gt; expression);


    <span class="comment">// coalesce, nullif:</span>

    <span class="comment">/**
     * Create an expression that returns null if all its arguments
     * evaluate to null, and the value of the first non-null argument
     * otherwise.
     * @param x expression
     * @param y expression
     * @return coalesce expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; coalesce(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; y);

    <span class="comment">/**
     * Create an expression that returns null if all its arguments
     * evaluate to null, and the value of the first non-null argument
     * otherwise.
     * @param x expression
     * @param y value
     * @return coalesce expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; coalesce(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; x, Y y);

    <span class="comment">/**
     * Create an expression that tests whether its argument are
     * equal, returning null if they are and the value of the
     * first expression if they are not.
     * @param x expression
     * @param y expression
     * @return nullif expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; nullif(<span class="predefined-type">Expression</span>&lt;Y&gt; x, <span class="predefined-type">Expression</span>&lt;?&gt; y);

    <span class="comment">/**
     * Create an expression that tests whether its argument are
     * equal, returning null if they are and the value of the
     * first expression if they are not.
     * @param x expression
     * @param y value
     * @return nullif expression
     */</span>
    &lt;Y&gt; <span class="predefined-type">Expression</span>&lt;Y&gt; nullif(<span class="predefined-type">Expression</span>&lt;Y&gt; x, Y y);


    <span class="comment">// coalesce builder:</span>

    <span class="comment">/**
     *  Interface used to build coalesce expressions.
     *
     * A coalesce expression is equivalent to a case expression
     * that returns null if all its arguments evaluate to null,
     * and the value of its first non-null argument otherwise.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">interface</span> <span class="class">Coalesce</span>&lt;T&gt; <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;T&gt; {

         <span class="comment">/**
          * Add an argument to the coalesce expression.
          * @param value  value
          * @return coalesce expression
          */</span>
         Coalesce&lt;T&gt; value(T value);

         <span class="comment">/**
          * Add an argument to the coalesce expression.
          * @param value expression
          * @return coalesce expression
          */</span>
         Coalesce&lt;T&gt; value(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> T&gt; value);
    }

    <span class="comment">/**
     * Create a coalesce expression.
     * @return coalesce expression
     */</span>
    &lt;T&gt; Coalesce&lt;T&gt; coalesce();


    <span class="comment">//case builders:</span>

    <span class="comment">/**
     *  Interface used to build simple case expressions.
     *  Case conditions are evaluated in the order in which
     *  they are specified.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">interface</span> <span class="class">SimpleCase</span>&lt;C,R&gt; <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;R&gt; {

        <span class="comment">/**
         * Return the expression to be tested against the
         * conditions.
         * @return expression
         */</span>
        <span class="predefined-type">Expression</span>&lt;C&gt; getExpression();

        <span class="comment">/**
         * Add a when/then clause to the case expression.
         * @param condition  &quot;when&quot; condition
         * @param result  &quot;then&quot; result value
         * @return simple case expression
         */</span>
        SimpleCase&lt;C, R&gt; when(C condition, R result);

        <span class="comment">/**
         * Add a when/then clause to the case expression.
         * @param condition  &quot;when&quot; condition
         * @param result  &quot;then&quot; result expression
         * @return simple case expression
         */</span>
        SimpleCase&lt;C, R&gt; when(C condition, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);

        <span class="comment">/**
         * Add an &quot;else&quot; clause to the case expression.
         * @param result  &quot;else&quot; result
         * @return expression
         */</span>
        <span class="predefined-type">Expression</span>&lt;R&gt; otherwise(R result);

        <span class="comment">/**
         * Add an &quot;else&quot; clause to the case expression.
         * @param result  &quot;else&quot; result expression
         * @return expression
         */</span>
        <span class="predefined-type">Expression</span>&lt;R&gt; otherwise(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);
    }

    <span class="comment">/**
     *  Create a simple case expression.
     *  @param expression  to be tested against the case conditions
     *  @return simple case expression
     */</span>
    &lt;C, R&gt; SimpleCase&lt;C,R&gt; selectCase(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> C&gt; expression);


    <span class="comment">/**
     *  Interface used to build general case expressions.
     *  Case conditions are evaluated in the order in which
     *  they are specified.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">interface</span> <span class="class">Case</span>&lt;R&gt; <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;R&gt; {

        <span class="comment">/**
         * Add a when/then clause to the case expression.
         * @param condition  &quot;when&quot; condition
         * @param result  &quot;then&quot; result value
         * @return general case expression
         */</span>
        Case&lt;R&gt; when(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; condition, R result);

        <span class="comment">/**
         * Add a when/then clause to the case expression.
         * @param condition  &quot;when&quot; condition
         * @param result  &quot;then&quot; result expression
         * @return general case expression
         */</span>
        Case&lt;R&gt; when(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; condition, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);

        <span class="comment">/**
         * Add an &quot;else&quot; clause to the case expression.
         * @param result  &quot;else&quot; result
         * @return expression
         */</span>
        <span class="predefined-type">Expression</span>&lt;R&gt; otherwise(R result);

        <span class="comment">/**
         * Add an &quot;else&quot; clause to the case expression.
         * @param result  &quot;else&quot; result expression
         * @return expression
         */</span>
        <span class="predefined-type">Expression</span>&lt;R&gt; otherwise(<span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> R&gt; result);
    }

    <span class="comment">/**
     *  Create a general case expression.
     *  @return general case expression
     */</span>
    &lt;R&gt; Case&lt;R&gt; selectCase();

    <span class="comment">/**
     * Create an expression for the execution of a database
     * function.
     * @param name  function name
     * @param type  expected result type
     * @param args  function arguments
     * @return expression
     */</span>
   &lt;T&gt; <span class="predefined-type">Expression</span>&lt;T&gt; function(<span class="predefined-type">String</span> name, <span class="predefined-type">Class</span>&lt;T&gt; type,
<span class="predefined-type">Expression</span>&lt;?&gt;... args);


    <span class="comment">// methods for downcasting:</span>

    <span class="comment">/**
     *  Downcast Join object to the specified type.
     *  @param join  Join object
     *  @param type type to be downcast to
     *  @return  Join object of the specified type
     *  @since 2.1
     */</span>
    &lt;X, T, V <span class="directive">extends</span> T&gt; Join&lt;X, V&gt; treat(Join&lt;X, T&gt; join, <span class="predefined-type">Class</span>&lt;V&gt; type);

    <span class="comment">/**
     *  Downcast CollectionJoin object to the specified type.
     *  @param join  CollectionJoin object
     *  @param type type to be downcast to
     *  @return  CollectionJoin object of the specified type
     *  @since 2.1
     */</span>
    &lt;X, T, E <span class="directive">extends</span> T&gt; CollectionJoin&lt;X, E&gt; treat(CollectionJoin&lt;X, T&gt; join, <span class="predefined-type">Class</span>&lt;E&gt; type);

    <span class="comment">/**
     *  Downcast SetJoin object to the specified type.
     *  @param join  SetJoin object
     *  @param type type to be downcast to
     *  @return  SetJoin object of the specified type
     *  @since 2.1
     */</span>
    &lt;X, T, E <span class="directive">extends</span> T&gt; SetJoin&lt;X, E&gt; treat(SetJoin&lt;X, T&gt; join, <span class="predefined-type">Class</span>&lt;E&gt; type);

    <span class="comment">/**
     *  Downcast ListJoin object to the specified type.
     *  @param join  ListJoin object
     *  @param type type to be downcast to
     *  @return  ListJoin object of the specified type
     *  @since 2.1
     */</span>
    &lt;X, T, E <span class="directive">extends</span> T&gt; ListJoin&lt;X, E&gt; treat(ListJoin&lt;X, T&gt; join, <span class="predefined-type">Class</span>&lt;E&gt; type);

    <span class="comment">/**
     *  Downcast MapJoin object to the specified type.
     *  @param join  MapJoin object
     *  @param type type to be downcast to
     *  @return  MapJoin object of the specified type
     *  @since 2.1
     */</span>
    &lt;X, K, T, V <span class="directive">extends</span> T&gt; MapJoin&lt;X, K, V&gt; treat(MapJoin&lt;X, K, T&gt; join, <span class="predefined-type">Class</span>&lt;V&gt; type);


    <span class="comment">/**
     *  Downcast Path object to the specified type.
     *  @param path  path
     *  @param type type to be downcast to
     *  @return  Path object of the specified type
     *  @since 2.1
     */</span>
    &lt;X, T <span class="directive">extends</span> X&gt; Path&lt;T&gt; treat(Path&lt;X&gt; path, <span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     *  Downcast Root object to the specified type.
     *  @param root  root
     *  @param type type to be downcast to
     *  @return  Root object of the specified type
     *  @since 2.1
     */</span>
    &lt;X, T <span class="directive">extends</span> X&gt; Root&lt;T&gt; treat(Root&lt;X&gt; root, <span class="predefined-type">Class</span>&lt;T&gt; type);

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="commonabstractcriteria-interface"><a class="anchor" href="#commonabstractcriteria-interface"></a>6.3.2. CommonAbstractCriteria Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="comment">/**
 * The &lt;code&gt;CommonAbstractCriteria&lt;/code&gt; interface defines functionality
 * that is common to both top-level criteria queries and subqueries as
 * well as to update and delete criteria operations.
 * It is not intended to be used directly in query construction.
 *
 * &lt;p&gt; Note that criteria queries and criteria update and delete operations
 * are typed differently.
 * Criteria queries are typed according to the query result type.
 * Update and delete operations are typed according to the target of the
 * update or delete.
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CommonAbstractCriteria</span> {

    <span class="comment">/**
     * Create a subquery of the query.
     * @param type  the subquery result type
     * @return subquery
     */</span>
    &lt;U&gt; Subquery&lt;U&gt; subquery(<span class="predefined-type">Class</span>&lt;U&gt; type);

    <span class="comment">/**
     * Return the predicate that corresponds to the where clause
     * restriction(s), or null if no restrictions have been
     * specified.
     * @return where clause predicate
     */</span>
    <span class="predefined-type">Predicate</span> getRestriction();

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="abstractquery-interface"><a class="anchor" href="#abstractquery-interface"></a>6.3.3. AbstractQuery Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="comment">/**
 * The &lt;code&gt;AbstractQuery&lt;/code&gt; interface defines functionality that is common
 * to both top-level queries and subqueries.
 * It is not intended to be used directly in query construction.
 *
 * &lt;p&gt; All queries must have:
 *         a set of root entities (which may in turn own joins).
 * &lt;p&gt; All queries may have:
 *         a conjunction of restrictions.
 *
 * @param &lt;T&gt;  the type of the result
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AbstractQuery</span>&lt;T&gt; <span class="directive">extends</span> CommonAbstractCriteria {

    <span class="comment">/**
     * Create and add a query root corresponding to the given entity,
     * forming a cartesian product with any existing roots.
     * @param entityClass  the entity class
     * @return query root corresponding to the given entity
     */</span>
    &lt;X&gt; Root&lt;X&gt; from(<span class="predefined-type">Class</span>&lt;X&gt; entityClass);

    <span class="comment">/**
     * Create and add a query root corresponding to the given entity,
     * forming a cartesian product with any existing roots.
     * @param entity  metamodel entity representing the entity
     *                of type X
     * @return query root corresponding to the given entity
     */</span>
    &lt;X&gt; Root&lt;X&gt; from(EntityType&lt;X&gt; entity);

    <span class="comment">/**
     * Modify the query to restrict the query results according
     * to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the query to restrict the query results according
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  zero or more restriction predicates
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the query results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously
     * added grouping expressions are simply removed.
     * @param grouping  zero or more grouping expressions
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; groupBy(<span class="predefined-type">Expression</span>&lt;?&gt;... grouping);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the query results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously
     * added grouping expressions are simply removed.
     * @param grouping  list of zero or more grouping expressions
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; groupBy(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;?&gt;&gt; grouping);

    <span class="comment">/**
     * Specify a restriction over the groups of the query.
     * Replaces the previous having restriction(s), if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; having(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Specify restrictions over the groups of the query
     * according the conjunction of the specified restriction
     * predicates.
     * Replaces the previously having added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  zero or more restriction predicates
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; having(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify whether duplicate query results will be eliminated.
     * A true value will cause duplicates to be eliminated.
     * A false value will cause duplicates to be retained.
     * If distinct has not been specified, duplicate results must
     * be retained.
     * @param distinct  boolean value specifying whether duplicate
     *        results must be eliminated from the query result or
     *        whether they must be retained
     * @return the modified query
     */</span>
    AbstractQuery&lt;T&gt; distinct(<span class="type">boolean</span> distinct);

    <span class="comment">/**
     * Return the query roots.  These are the roots that have
     * been defined for the &lt;code&gt;CriteriaQuery&lt;/code&gt; or &lt;code&gt;Subquery&lt;/code&gt; itself,
     * including any subquery roots defined as a result of
     * correlation. Returns empty set if no roots have been defined.
     * Modifications to the set do not affect the query.
     * @return the set of query roots
     */</span>
    <span class="predefined-type">Set</span>&lt;Root&lt;?&gt;&gt; getRoots();

    <span class="comment">/**
     *  Return the selection of the query, or null if no selection
     *  has been set.
     *  @return selection item
     */</span>
    Selection&lt;T&gt; getSelection();

    <span class="comment">/**
     * Return a list of the grouping expressions.  Returns empty
     * list if no grouping expressions have been specified.
     * Modifications to the list do not affect the query.
     * @return the list of grouping expressions
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;?&gt;&gt; getGroupList();

    <span class="comment">/**
     * Return the predicate that corresponds to the restriction(s)
     * over the grouping items, or null if no restrictions have
     * been specified.
     * @return having clause predicate
     */</span>
    <span class="predefined-type">Predicate</span> getGroupRestriction();

    <span class="comment">/**
     * Return whether duplicate query results must be eliminated or
     * retained.
     * @return boolean indicating whether duplicate query results
     *         must be eliminated
     */</span>
    <span class="type">boolean</span> isDistinct();

    <span class="comment">/**
     * Return the result type of the query or subquery.  If a result
     * type was specified as an argument to the
     * &lt;code&gt;createQuery&lt;/code&gt; or &lt;code&gt;subquery&lt;/code&gt; method, that
     * type will be returned.  If the query was created using the
     * &lt;code&gt;createTupleQuery&lt;/code&gt; method, the result type is
     * &lt;code&gt;Tuple&lt;/code&gt;.  Otherwise, the result type is
     * &lt;code&gt;Object&lt;/code&gt;.
     * @return result type
     */</span>
    <span class="predefined-type">Class</span>&lt;T&gt; getResultType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a8857"><a class="anchor" href="#a8857"></a>6.3.4. CriteriaQuery Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * The &lt;code&gt;CriteriaQuery&lt;/code&gt; interface defines functionality that is specific
 * to top-level queries.
 *
 * @param &lt;T&gt;  the type of the defined result
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaQuery</span>&lt;T&gt; <span class="directive">extends</span> AbstractQuery&lt;T&gt; {

    <span class="comment">/**
     * Specify the item that is to be returned in the query result.
     * Replaces the previously specified selection(s), if any.
     *
     * &lt;p&gt; Note: Applications using the string-based API may need to
     * specify the type of the select item when it results from
     * a get or join operation and the query result type is
     * specified.
     *
     * &lt;pre&gt;
     *     For example:
     *
     *     CriteriaQuery&amp;#060;String&amp;#062; q = cb.createQuery(String.class);
     *     Root&amp;#060;Order&amp;#062; order = q.from(Order.class);
     *     q.select(order.get(&quot;shippingAddress&quot;).&amp;#060;String&amp;#062;get(&quot;state&quot;));
     *
     *     CriteriaQuery&amp;#060;Product&amp;#062; q2 = cb.createQuery(Product.class);
     *     q2.select(q2.from(Order.class)
     *                 .join(&quot;items&quot;)
     *                 .&amp;#060;Item,Product&amp;#062;join(&quot;product&quot;));
     *
     * &lt;/pre&gt;
     * @param selection  selection specifying the item that
     *        is to be returned in the query result
     * @return the modified query
     * @throws IllegalArgumentException if the selection is
     *         a compound selection and more than one selection
     *         item has the same assigned alias
     */</span>
    CriteriaQuery&lt;T&gt; select(Selection&lt;? <span class="directive">extends</span> T&gt; selection);

    <span class="comment">/**
     * Specify the selection items that are to be returned in the
     * query result.
     * Replaces the previously specified selection(s), if any.
     *
     * The type of the result of the query execution depends on
     * the specification of the type of the criteria query object
     * created as well as the arguments to the multiselect method.
     * &lt;p&gt; An argument to the multiselect method must not be a tuple-
     * or array-valued compound selection item.
     *
     * &lt;p&gt;The semantics of this method are as follows:
     * &lt;ul&gt;
     * &lt;li&gt;
     * If the type of the criteria query is
     * &lt;code&gt;CriteriaQuery&amp;#060;Tuple&amp;#062;&lt;/code&gt; (i.e., a criteria
     * query object created by either the
     * &lt;code&gt;createTupleQuery&lt;/code&gt; method or by passing a
     * &lt;code&gt;Tuple&lt;/code&gt; class argument to the
     * &lt;code&gt;createQuery&lt;/code&gt; method), a &lt;code&gt;Tuple&lt;/code&gt; object
     * corresponding to the arguments of the &lt;code&gt;multiselect&lt;/code&gt;
     * method, in the specified order, will be instantiated and
     * returned for each row that results from the query execution.
     *
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;X&amp;#062;&lt;/code&gt; for
     * some user-defined class X (i.e., a criteria query object
     * created by passing a X class argument to the &lt;code&gt;createQuery&lt;/code&gt;
     * method), the arguments to the &lt;code&gt;multiselect&lt;/code&gt; method will be
     * passed to the X constructor and an instance of type X will be
     * returned for each row.
     *
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;X[]&amp;#062;&lt;/code&gt; for
     * some class X, an instance of type X[] will be returned for
     * each row.   The elements of the array will correspond to the
     * arguments of the &lt;code&gt;multiselect&lt;/code&gt; method, in the
     * specified order.
     *
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;Object&amp;#062;&lt;/code&gt;
     * or if the criteria query was created without specifying a
     * type, and only a single argument is passed to the &lt;code&gt;multiselect&lt;/code&gt;
     * method, an instance of type &lt;code&gt;Object&lt;/code&gt; will be returned for
     * each row.
     *
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;Object&amp;#062;&lt;/code&gt;
     * or if the criteria query was created without specifying a
     * type, and more than one argument is passed to the &lt;code&gt;multiselect&lt;/code&gt;
     * method, an instance of type &lt;code&gt;Object[]&lt;/code&gt; will be instantiated
     * and returned for each row.  The elements of the array will
     * correspond to the arguments to the &lt;code&gt; multiselect&lt;/code&gt;  method,
     * in the specified order.
     * &lt;/ul&gt;
     *
     * @param selections  selection items corresponding to the
     *        results to be returned by the query
     * @return the modified query
     * @throws IllegalArgumentException if a selection item is
     *         not valid or if more than one selection item has
     *         the same assigned alias
     */</span>
    CriteriaQuery&lt;T&gt; multiselect(Selection&lt;?&gt;... selections);


    <span class="comment">/**
     * Specify the selection items that are to be returned in the
     * query result.
     * Replaces the previously specified selection(s), if any.
     *
     * &lt;p&gt; The type of the result of the query execution depends on
     * the specification of the type of the criteria query object
     * created as well as the argument to the &lt;code&gt;multiselect&lt;/code&gt; method.
     * An element of the list passed to the &lt;code&gt;multiselect&lt;/code&gt; method
     * must not be a tuple- or array-valued compound selection item.
     *
     * &lt;p&gt; The semantics of this method are as follows:
     * &lt;ul&gt;
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;Tuple&amp;#062;&lt;/code&gt;
     * (i.e., a criteria query object created by either the
     * &lt;code&gt;createTupleQuery&lt;/code&gt; method or by passing a &lt;code&gt;Tuple&lt;/code&gt; class argument
     * to the &lt;code&gt;createQuery&lt;/code&gt; method), a &lt;code&gt;Tuple&lt;/code&gt; object corresponding to
     * the elements of the list passed to the &lt;code&gt;multiselect&lt;/code&gt; method,
     * in the specified order, will be instantiated and returned for each
     * row that results from the query execution.
     *
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;X&amp;#062;&lt;/code&gt; for
     * some user-defined class X (i.e., a criteria query object
     * created by passing a X class argument to the &lt;code&gt;createQuery&lt;/code&gt;
     * method), the elements of the list passed to the &lt;code&gt;multiselect&lt;/code&gt;
     * method will be passed to the X constructor and an instance
     * of type X will be returned for each row.
     *
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;X[]&amp;#062;&lt;/code&gt; for
     * some class X, an instance of type X[] will be returned for
     * each row.   The elements of the array will correspond to the
     * elements of the list passed to the &lt;code&gt;multiselect&lt;/code&gt; method,
     * in the specified order.
     *
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;Object&amp;#062;&lt;/code&gt;
     * or if the criteria query was created without specifying a
     * type, and the list passed to the &lt;code&gt;multiselect&lt;/code&gt; method contains
     * only a single element, an instance of type &lt;code&gt;Object&lt;/code&gt; will be
     * returned for each row.
     *
     * &lt;li&gt; If the type of the criteria query is &lt;code&gt;CriteriaQuery&amp;#060;Object&amp;#062;&lt;/code&gt;
     * or if the criteria query was created without specifying a
     * type, and the list passed to the &lt;code&gt;multiselect&lt;/code&gt; method contains
     * more than one element, an instance of type &lt;code&gt;Object[]&lt;/code&gt; will be
     * instantiated and returned for each row.  The elements of the
     * array will correspond to the elements of the list passed to
     * the &lt;code&gt;multiselect&lt;/code&gt; method, in the specified order.
     * &lt;/ul&gt;
     *
     * @param selectionList  list of selection items corresponding
     *        to the results to be returned by the query
     * @return the modified query
     * @throws IllegalArgumentException if a selection item is
     *         not valid or if more than one selection item has
     *         the same assigned alias
     */</span>
    CriteriaQuery&lt;T&gt; multiselect(<span class="predefined-type">List</span>&lt;Selection&lt;?&gt;&gt; selectionList);

    <span class="comment">/**
     * Modify the query to restrict the query result according
     * to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param restriction  a simple or compound boolean expression
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the query to restrict the query result according
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param restrictions  zero or more restriction predicates
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the query results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously
     * added grouping expressions are simply removed.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param grouping  zero or more grouping expressions
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; groupBy(<span class="predefined-type">Expression</span>&lt;?&gt;... grouping);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the query results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously
     * added grouping expressions are simply removed.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param grouping  list of zero or more grouping expressions
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; groupBy(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;?&gt;&gt; grouping);

    <span class="comment">/**
     * Specify a restriction over the groups of the query.
     * Replaces the previous having restriction(s), if any.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param restriction  a simple or compound boolean expression
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; having(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Specify restrictions over the groups of the query
     * according the conjunction of the specified restriction
     * predicates.
     * Replaces the previously added having restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param restrictions  zero or more restriction predicates
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; having(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify the ordering expressions that are used to
     * order the query results.
     * Replaces the previous ordering expressions, if any.
     * If no ordering expressions are specified, the previous
     * ordering, if any, is simply removed, and results will
     * be returned in no particular order.
     * The left-to-right sequence of the ordering expressions
     * determines the precedence, whereby the leftmost has highest
     * precedence.
     * @param o  zero or more ordering expressions
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; orderBy(Order... o);

    <span class="comment">/**
     * Specify the ordering expressions that are used to
     * order the query results.
     * Replaces the previous ordering expressions, if any.
     * If no ordering expressions are specified, the previous
     * ordering, if any, is simply removed, and results will
     * be returned in no particular order.
     * The order of the ordering expressions in the list
     * determines the precedence, whereby the first element in the
     * list has highest precedence.
     * @param o  list of zero or more ordering expressions
     * @return the modified query
     */</span>
    CriteriaQuery&lt;T&gt; orderBy(<span class="predefined-type">List</span>&lt;Order&gt; o);

    <span class="comment">/**
     * Specify whether duplicate query results will be eliminated.
     * A true value will cause duplicates to be eliminated.
     * A false value will cause duplicates to be retained.
     * If distinct has not been specified, duplicate results must
     * be retained.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param distinct  boolean value specifying whether duplicate
     *        results must be eliminated from the query result or
     *        whether they must be retained
     * @return the modified query.
     */</span>
    CriteriaQuery&lt;T&gt; distinct(<span class="type">boolean</span> distinct);

    <span class="comment">/**
     * Return the ordering expressions in order of precedence.
     * Returns empty list if no ordering expressions have been
     * specified.
     * Modifications to the list do not affect the query.
     * @return the list of ordering expressions
     */</span>
    <span class="predefined-type">List</span>&lt;Order&gt; getOrderList();

    <span class="comment">/**
     * Return the parameters of the query.  Returns empty set if
     * there are no parameters.
     * Modifications to the set do not affect the query.
     * @return the query parameters
     */</span>
    <span class="predefined-type">Set</span>&lt;ParameterExpression&lt;?&gt;&gt; getParameters();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="criteriaupdate-interface"><a class="anchor" href="#criteriaupdate-interface"></a>6.3.5. CriteriaUpdate Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="comment">/**
 * The &lt;code&gt;CriteriaUpdate&lt;/code&gt; interface defines functionality for performing
 * bulk update operations using the Criteria API.
 *
 * &lt;p&gt;Criteria API bulk update operations map directly to database update
 * operations, bypassing any optimistic locking checks.  Portable
 * applications using bulk update operations must manually update the
 * value of the version column, if desired, and/or manually validate
 * the value of the version column.
 * The persistence context is not synchronized with the result of the
 * bulk update.
 *
 * &lt;p&gt; A &lt;code&gt;CriteriaUpdate&lt;/code&gt; object must have a single root.
 *
 * @param &lt;T&gt;  the entity type that is the target of the update
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaUpdate</span>&lt;T&gt; <span class="directive">extends</span> CommonAbstractCriteria {

   <span class="comment">/**
    * Create and add a query root corresponding to the entity
    * that is the target of the update.
    * A &lt;code&gt;CriteriaUpdate&lt;/code&gt; object has a single root, the entity that
    * is being updated.
    * @param entityClass  the entity class
    * @return query root corresponding to the given entity
    */</span>
   Root&lt;T&gt; from(<span class="predefined-type">Class</span>&lt;T&gt; entityClass);

   <span class="comment">/**
    * Create and add a query root corresponding to the entity
    * that is the target of the update.
    * A &lt;code&gt;CriteriaUpdate&lt;/code&gt; object has a single root, the entity that
    * is being updated.
    * @param entity  metamodel entity representing the entity
    *                of type X
    * @return query root corresponding to the given entity
    */</span>
   Root&lt;T&gt; from(EntityType&lt;T&gt; entity);

   <span class="comment">/**
    * Return the query root.
    * @return the query root
    */</span>
   Root&lt;T&gt; getRoot();

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attribute  attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   &lt;Y, X <span class="directive">extends</span> Y&gt; CriteriaUpdate&lt;T&gt; set(SingularAttribute&lt;? <span class="local-variable">super</span> T, Y&gt; attribute, X value);

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attribute  attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   &lt;Y&gt; CriteriaUpdate&lt;T&gt; set(SingularAttribute&lt;? <span class="local-variable">super</span> T, Y&gt; attribute, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; value);

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attribute  attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   &lt;Y, X <span class="directive">extends</span> Y&gt; CriteriaUpdate&lt;T&gt; set(Path&lt;Y&gt; attribute, X value);

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attribute  attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   &lt;Y&gt; CriteriaUpdate&lt;T&gt; set(Path&lt;Y&gt; attribute, <span class="predefined-type">Expression</span>&lt;? <span class="directive">extends</span> Y&gt; value);

   <span class="comment">/**
    * Update the value of the specified attribute.
    * @param attributeName  name of the attribute to be updated
    * @param value  new value
    * @return  the modified update query
    */</span>
   CriteriaUpdate&lt;T&gt; set(<span class="predefined-type">String</span> attributeName, <span class="predefined-type">Object</span> value);

    <span class="comment">/**
     * Modify the update query to restrict the target of the update
     * according to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified update query
     */</span>
   CriteriaUpdate&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the update query to restrict the target of the update
     * according to the conjunction of the specified restriction
     * predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  zero or more restriction predicates
     * @return the modified update query
     */</span>
   CriteriaUpdate&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="criteriadelete-interface"><a class="anchor" href="#criteriadelete-interface"></a>6.3.6. CriteriaDelete Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="comment">/**
 * The &lt;code&gt;CriteriaDelete&lt;/code&gt; interface defines functionality for performing
 * bulk delete operations using the Criteria API
 *
 * &lt;p&gt;Criteria API bulk delete operations map directly to database
 * delete operations.  The persistence context is not synchronized
 * with the result of the bulk delete.
 *
 * &lt;p&gt; A &lt;code&gt;CriteriaDelete&lt;/code&gt; object must have a single root.
 *
 * @param &lt;T&gt;  the entity type that is the target of the delete
 *
 * @since 2.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CriteriaDelete</span>&lt;T&gt; <span class="directive">extends</span> CommonAbstractCriteria {


    <span class="comment">/**
     * Create and add a query root corresponding to the entity
     * that is the target of the delete.
     * A &lt;code&gt;CriteriaDelete&lt;/code&gt; object has a single root, the entity that
     * is being deleted.
     * @param entityClass  the entity class
     * @return query root corresponding to the given entity
     */</span>
    Root&lt;T&gt; from(<span class="predefined-type">Class</span>&lt;T&gt; entityClass);

    <span class="comment">/**
     * Create and add a query root corresponding to the entity
     * that is the target of the delete.
     * A &lt;code&gt;CriteriaDelete&lt;/code&gt; object has a single root, the entity that
     * is being deleted.
     * @param entity  metamodel entity representing the entity
     *                of type X
     * @return query root corresponding to the given entity
     */</span>
    Root&lt;T&gt; from(EntityType&lt;T&gt; entity);

   <span class="comment">/**
    * Return the query root.
    * @return the query root
    */</span>
   Root&lt;T&gt; getRoot();

    <span class="comment">/**
     * Modify the delete query to restrict the target of the deletion
     * according to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * @param restriction  a simple or compound boolean expression
     * @return the modified delete query
     */</span>
   CriteriaDelete&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the delete query to restrict the target of the deletion
     * according to the conjunction of the specified restriction
     * predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * @param restrictions  zero or more restriction predicates
     * @return the modified delete query
     */</span>
   CriteriaDelete&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="subquery-interface"><a class="anchor" href="#subquery-interface"></a>6.3.7. Subquery Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * The &lt;code&gt;Subquery&lt;/code&gt; interface defines functionality that is
 * specific to subqueries.
 *
 * A subquery has an expression as its selection item.
 *
 * @param &lt;T&gt; the type of the selection item.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Subquery</span>&lt;T&gt; <span class="directive">extends</span> AbstractQuery&lt;T&gt;, <span class="predefined-type">Expression</span>&lt;T&gt; {

    <span class="comment">/**
     * Specify the item that is to be returned as the subquery
     * result.
     * Replaces the previously specified selection, if any.
     * @param expression  expression specifying the item that
     *        is to be returned as the subquery result
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; select(<span class="predefined-type">Expression</span>&lt;T&gt; expression);

    <span class="comment">/**
     * Modify the subquery to restrict the result according
     * to the specified boolean expression.
     * Replaces the previously added restriction(s), if any.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param restriction  a simple or compound boolean expression
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; where(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Modify the subquery to restrict the result according
     * to the conjunction of the specified restriction predicates.
     * Replaces the previously added restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param restrictions  zero or more restriction predicates
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; where(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the subquery results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously
     * added grouping expressions are simply removed.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param grouping  zero or more grouping expressions
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; groupBy(<span class="predefined-type">Expression</span>&lt;?&gt;... grouping);

    <span class="comment">/**
     * Specify the expressions that are used to form groups over
     * the subquery results.
     * Replaces the previous specified grouping expressions, if any.
     * If no grouping expressions are specified, any previously
     * added grouping expressions are simply removed.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param grouping  list of zero or more grouping expressions
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; groupBy(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;?&gt;&gt; grouping);

    <span class="comment">/**
     * Specify a restriction over the groups of the subquery.
     * Replaces the previous having restriction(s), if any.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param restriction  a simple or compound boolean expression
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; having(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     * Specify restrictions over the groups of the subquery
     * according the conjunction of the specified restriction
     * predicates.
     * Replaces the previously added having restriction(s), if any.
     * If no restrictions are specified, any previously added
     * restrictions are simply removed.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param restrictions  zero or more restriction predicates
     * @return the modified subquery
     */</span>
    Subquery&lt;T&gt; having(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Specify whether duplicate query results will be eliminated.
     * A true value will cause duplicates to be eliminated.
     * A false value will cause duplicates to be retained.
     * If distinct has not been specified, duplicate results must
     * be retained.
     * This method only overrides the return type of the
     * corresponding &lt;code&gt;AbstractQuery&lt;/code&gt; method.
     * @param distinct  boolean value specifying whether duplicate
     *        results must be eliminated from the subquery result or
     *        whether they must be retained
     * @return the modified subquery.
     */</span>
    Subquery&lt;T&gt; distinct(<span class="type">boolean</span> distinct);

    <span class="comment">/**
     * Create a subquery root correlated to a root of the
     * enclosing query.
     * @param parentRoot  a root of the containing query
     * @return subquery root
     */</span>
    &lt;Y&gt; Root&lt;Y&gt; correlate(Root&lt;Y&gt; parentRoot);

    <span class="comment">/**
     * Create a subquery join object correlated to a join object
     * of the enclosing query.
     * @param parentJoin  join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, Y&gt; Join&lt;X, Y&gt; correlate(Join&lt;X, Y&gt; parentJoin);

    <span class="comment">/**
     * Create a subquery collection join object correlated to a
     * collection join object of the enclosing query.
     * @param parentCollection  join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, Y&gt; CollectionJoin&lt;X, Y&gt; correlate(CollectionJoin&lt;X, Y&gt; parentCollection);

    <span class="comment">/**
     * Create a subquery set join object correlated to a set join
     * object of the enclosing query.
     * @param parentSet  join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, Y&gt; SetJoin&lt;X, Y&gt; correlate(SetJoin&lt;X, Y&gt; parentSet);

    <span class="comment">/**
     * Create a subquery list join object correlated to a list join
     * object of the enclosing query.
     * @param parentList join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, Y&gt; ListJoin&lt;X, Y&gt; correlate(ListJoin&lt;X, Y&gt; parentList);

    <span class="comment">/**
     * Create a subquery map join object correlated to a map join
     * object of the enclosing query.
     * @param parentMap join object of the containing query
     * @return subquery join
     */</span>
    &lt;X, K, V&gt; MapJoin&lt;X, K, V&gt; correlate(MapJoin&lt;X, K, V&gt; parentMap);

    <span class="comment">/**
     * Return the query of which this is a subquery.
     * This must be a CriteriaQuery or a Subquery.
     * @return the enclosing query or subquery
     */</span>
    AbstractQuery&lt;?&gt; getParent();

    <span class="comment">/**
     * Return the query of which this is a subquery.
     * This may be a CriteriaQuery, CriteriaUpdate, CriteriaDelete,
     * or a Subquery.
     * @return the enclosing query or subquery
     * @since 2.1
     */</span>
    CommonAbstractCriteria getContainingQuery();

    <span class="comment">/**
     * Return the selection expression.
     * @return the item to be returned in the subquery result
     */</span>
    <span class="predefined-type">Expression</span>&lt;T&gt; getSelection();

    <span class="comment">/**
     *  Return the correlated joins of the subquery.
     *  Returns empty set if the subquery has no correlated
     *  joins.
     *  Modifications to the set do not affect the query.
     *  @return the correlated joins of the subquery
     */</span>
    <span class="predefined-type">Set</span>&lt;Join&lt;?, ?&gt;&gt; getCorrelatedJoins();

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="selection-interface"><a class="anchor" href="#selection-interface"></a>6.3.8. Selection Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.TupleElement</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * The &lt;code&gt;Selection&lt;/code&gt; interface defines an item that is to be
 * returned in a query result.
 *
 * @param &lt;X&gt; the type of the selection item
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Selection</span>&lt;X&gt; <span class="directive">extends</span> TupleElement&lt;X&gt; {

    <span class="comment">/**
     * Assigns an alias to the selection item.
     * Once assigned, an alias cannot be changed or reassigned.
     * Returns the same selection item.
     * @param name  alias
     * @return selection item
     */</span>
    Selection&lt;X&gt; alias(<span class="predefined-type">String</span> name);

    <span class="comment">/**
     * Whether the selection item is a compound selection.
     * @return boolean indicating whether the selection is a compound
     *         selection
     */</span>
    <span class="type">boolean</span> isCompoundSelection();

    <span class="comment">/**
     * Return the selection items composing a compound selection.
     * Modifications to the list do not affect the query.
     * @return list of selection items
     * @throws IllegalStateException if selection is not a
     *         compound selection
     */</span>
    <span class="predefined-type">List</span>&lt;Selection&lt;?&gt;&gt; getCompoundSelectionItems();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="compoundselection-interface"><a class="anchor" href="#compoundselection-interface"></a>6.3.9. CompoundSelection Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="comment">/**
 * The &lt;code&gt;CompoundSelection&lt;/code&gt; interface defines a compound selection item
 * (tuple, array, or result of constructor).
 *
 * @param &lt;X&gt; the type of the selection item
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CompoundSelection</span>&lt;X&gt; <span class="directive">extends</span> Selection&lt;X&gt; {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="expression-interface"><a class="anchor" href="#expression-interface"></a>6.3.10. Expression Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.Collection</span>;

<span class="comment">/**
 * Type for query expressions.
 *
 * @param &lt;T&gt; the type of the expression
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Expression</span>&lt;T&gt; <span class="directive">extends</span> Selection&lt;T&gt; {

    <span class="comment">/**
     *  Create a predicate to test whether the expression is null.
     *  @return predicate testing whether the expression is null
     */</span>
    <span class="predefined-type">Predicate</span> isNull();

    <span class="comment">/**
     *  Create a predicate to test whether the expression is
     *  not null.
     *  @return predicate testing whether the expression is not null
     */</span>
    <span class="predefined-type">Predicate</span> isNotNull();

    <span class="comment">/**
     * Create a predicate to test whether the expression is a member
     * of the argument list.
     * @param values  values to be tested against
     * @return predicate testing for membership
     */</span>
    <span class="predefined-type">Predicate</span> in(<span class="predefined-type">Object</span>... values);

    <span class="comment">/**
     * Create a predicate to test whether the expression is a member
     * of the argument list.
     * @param values  expressions to be tested against
     * @return predicate testing for membership
     */</span>
    <span class="predefined-type">Predicate</span> in(<span class="predefined-type">Expression</span>&lt;?&gt;... values);

    <span class="comment">/**
     * Create a predicate to test whether the expression is a member
     * of the collection.
     * @param values  collection of values to be tested against
     * @return predicate testing for membership
     */</span>
    <span class="predefined-type">Predicate</span> in(<span class="predefined-type">Collection</span>&lt;?&gt; values);

    <span class="comment">/**
     * Create a predicate to test whether the expression is a member
     * of the collection.
     * @param values expression corresponding to collection to be
     *        tested against
     * @return predicate testing for membership
     */</span>
    <span class="predefined-type">Predicate</span> in(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Collection</span>&lt;?&gt;&gt; values);

    <span class="comment">/**
     * Perform a typecast upon the expression, returning a new
     * expression object.
     * This method does not cause type conversion:
     * the runtime type is not changed.
     * Warning: may result in a runtime failure.
     * @param type  intended type of the expression
     * @return new expression of the given type
     */</span>
    &lt;X&gt; <span class="predefined-type">Expression</span>&lt;X&gt; as(<span class="predefined-type">Class</span>&lt;X&gt; type);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="predicate-interface"><a class="anchor" href="#predicate-interface"></a>6.3.11. Predicate Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * The type of a simple or compound predicate: a conjunction or
 * disjunction of restrictions.
 * A simple predicate is considered to be a conjunction with a
 * single conjunct.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Predicate</span> <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; {

        <span class="directive">public</span> <span class="directive">static</span> <span class="type">enum</span> BooleanOperator {
              AND, OR
        }

    <span class="comment">/**
     * Return the boolean operator for the predicate.
     * If the predicate is simple, this is &lt;code&gt;AND&lt;/code&gt;.
     * @return boolean operator for the predicate
     */</span>
    BooleanOperator getOperator();

    <span class="comment">/**
     * Whether the predicate has been created from another
     * predicate by applying the &lt;code&gt;Predicate.not()&lt;/code&gt; method
     * or the &lt;code&gt;CriteriaBuilder.not()&lt;/code&gt; method.
     * @return boolean indicating if the predicate is
     *                 a negated predicate
     */</span>
    <span class="type">boolean</span> isNegated();

    <span class="comment">/**
     * Return the top-level conjuncts or disjuncts of the predicate.
     * Returns empty list if there are no top-level conjuncts or
     * disjuncts of the predicate.
     * Modifications to the list do not affect the query.
     * @return list of boolean expressions forming the predicate
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt;&gt; getExpressions();

    <span class="comment">/**
     * Create a negation of the predicate.
     * @return negated predicate
     */</span>
    <span class="predefined-type">Predicate</span> not();

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="path-interface"><a class="anchor" href="#path-interface"></a>6.3.12. Path Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.PluralAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Bindable</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.MapAttribute</span>;

<span class="comment">/**
 * Represents a simple or compound attribute path from a
 * bound type or collection, and is a &quot;primitive&quot; expression.
 *
 * @param &lt;X&gt;  the type referenced by the path
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Path</span>&lt;X&gt; <span class="directive">extends</span> <span class="predefined-type">Expression</span>&lt;X&gt; {

    <span class="comment">/**
     * Return the bindable object that corresponds to the
     * path expression.
     * @return bindable object corresponding to the path
     */</span>
    Bindable&lt;X&gt; getModel();

    <span class="comment">/**
     *  Return the parent &quot;node&quot; in the path or null if no parent.
     *  @return parent
     */</span>
    Path&lt;?&gt; getParentPath();

    <span class="comment">/**
     *  Create a path corresponding to the referenced
     *  single-valued attribute.
     *  @param attribute single-valued attribute
     *  @return path corresponding to the referenced attribute
     */</span>
    &lt;Y&gt; Path&lt;Y&gt; get(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute);

    <span class="comment">/**
     *  Create a path corresponding to the referenced
     *  collection-valued attribute.
     *  @param collection collection-valued attribute
     *  @return expression corresponding to the referenced attribute
     */</span>
    &lt;E, C <span class="directive">extends</span> java.util.Collection&lt;E&gt;&gt; <span class="predefined-type">Expression</span>&lt;C&gt; get(PluralAttribute&lt;X, C, E&gt; collection);

    <span class="comment">/**
     *  Create a path corresponding to the referenced
     *  map-valued attribute.
     *  @param map map-valued attribute
     *  @return expression corresponding to the referenced attribute
     */</span>
    &lt;K, V, M <span class="directive">extends</span> java.util.Map&lt;K, V&gt;&gt; <span class="predefined-type">Expression</span>&lt;M&gt; get(MapAttribute&lt;X, K, V&gt; map);

    <span class="comment">/**
     *  Create an expression corresponding to the type of the path.
     *  @return expression corresponding to the type of the path
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> X&gt;&gt; type();


    <span class="comment">//String-based:</span>

    <span class="comment">/**
     *  Create a path corresponding to the referenced attribute.
     *
     *  &lt;p&gt; Note: Applications using the string-based API may need to
     *  specify the type resulting from the &lt;code&gt;get&lt;/code&gt; operation in order
     *  to avoid the use of &lt;code&gt;Path&lt;/code&gt; variables.
     *
     *  &lt;pre&gt;
     *     For example:
     *
     *     CriteriaQuery&amp;#060;Person&amp;#062; q = cb.createQuery(Person.class);
     *     Root&amp;#060;Person&amp;#062; p = q.from(Person.class);
     *     q.select(p)
     *      .where(cb.isMember(&quot;joe&quot;,
     *                         p.&amp;#060;Set&amp;#060;String&amp;#062;&amp;#062;get(&quot;nicknames&quot;)));
     *
     *     rather than:
     *
     *     CriteriaQuery&amp;#060;Person&amp;#062; q = cb.createQuery(Person.class);
     *     Root&amp;#060;Person&amp;#062; p = q.from(Person.class);
     *     Path&amp;#060;Set&amp;#060;String&amp;#062;&amp;#062; nicknames = p.get(&quot;nicknames&quot;);
     *     q.select(p)
     *      .where(cb.isMember(&quot;joe&quot;, nicknames));
     *  &lt;/pre&gt;
     *
     *  @param attributeName  name of the attribute
     *  @return path corresponding to the referenced attribute
     *  @throws IllegalStateException if invoked on a path that
     *          corresponds to a basic type
     *  @throws IllegalArgumentException if attribute of the given
     *           name does not otherwise exist
     */</span>
    &lt;Y&gt; Path&lt;Y&gt; get(<span class="predefined-type">String</span> attributeName);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="fetchparent-interface"><a class="anchor" href="#fetchparent-interface"></a>6.3.13. FetchParent Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.PluralAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;

<span class="comment">/**
 * Represents an element of the from clause which may
 * function as the parent of Fetches.
 *
 * @param &lt;Z&gt;  the source type
 * @param &lt;X&gt;  the target type
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">FetchParent</span>&lt;Z, X&gt; {

    <span class="comment">/**
     *  Return the fetch joins that have been made from this type.
     *  Returns empty set if no fetch joins have been made from
     *  this type.
     *  Modifications to the set do not affect the query.
     *  @return fetch joins made from this type
     */</span>
    java.util.Set&lt;Fetch&lt;X, ?&gt;&gt; getFetches();

    <span class="comment">/**
     *  Create a fetch join to the specified single-valued attribute
     *  using an inner join.
     *  @param attribute  target of the join
     *  @return the resulting fetch join
     */</span>
    &lt;Y&gt; Fetch&lt;X, Y&gt; fetch(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute);

    <span class="comment">/**
     *  Create a fetch join to the specified single-valued attribute
     *  using the given join type.
     *  @param attribute  target of the join
     *  @param jt  join type
     *  @return the resulting fetch join
     */</span>
    &lt;Y&gt; Fetch&lt;X, Y&gt; fetch(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute, JoinType jt);

    <span class="comment">/**
     *  Create a fetch join to the specified collection-valued
     *  attribute using an inner join.
     *  @param attribute  target of the join
     *  @return the resulting join
     */</span>
    &lt;Y&gt; Fetch&lt;X, Y&gt; fetch(PluralAttribute&lt;? <span class="local-variable">super</span> X, ?, Y&gt; attribute);

    <span class="comment">/**
     *  Create a fetch join to the specified collection-valued
     *  attribute using the given join type.
     *  @param attribute  target of the join
     *  @param jt  join type
     *  @return the resulting join
     */</span>
    &lt;Y&gt; Fetch&lt;X, Y&gt; fetch(PluralAttribute&lt;? <span class="local-variable">super</span> X, ?, Y&gt; attribute, JoinType jt);


    <span class="comment">//String-based:</span>

    <span class="comment">/**
     *  Create a fetch join to the specified attribute using an
     *  inner join.
     *  @param attributeName  name of the attribute for the
     *         target of the join
     *  @return the resulting fetch join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hiding</span><span class="delimiter">&quot;</span></span>)
    &lt;X, Y&gt; Fetch&lt;X, Y&gt; fetch(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     *  Create a fetch join to the specified attribute using
     *  the given join type.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @param jt  join type
     *  @return the resulting fetch join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hiding</span><span class="delimiter">&quot;</span></span>)
    &lt;X, Y&gt; Fetch&lt;X, Y&gt; fetch(<span class="predefined-type">String</span> attributeName, JoinType jt);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="fetch-interface"><a class="anchor" href="#fetch-interface"></a>6.3.14. Fetch Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Attribute</span>;

<span class="comment">/**
 * Represents a join-fetched association or attribute.
 *
 * @param &lt;Z&gt;  the source type of the fetch
 * @param &lt;X&gt;  the target type of the fetch
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Fetch</span>&lt;Z, X&gt; <span class="directive">extends</span> FetchParent&lt;Z, X&gt; {

    <span class="comment">/**
     * Return the metamodel attribute corresponding to the
     * fetch join.
     * @return metamodel attribute for the join
     */</span>
    <span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> Z, ?&gt; getAttribute();

    <span class="comment">/**
     * Return the parent of the fetched item.
     * @return fetch parent
     */</span>
    FetchParent&lt;?, Z&gt; getParent();

    <span class="comment">/**
     * Return the join type used in the fetch join.
     * @return join type
     */</span>
    JoinType getJoinType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="from-interface"><a class="anchor" href="#from-interface"></a>6.3.15. From Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SingularAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.CollectionAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.ListAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.MapAttribute</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SetAttribute</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * Represents a bound type, usually an entity that appears in
 * the from clause, but may also be an embeddable belonging to
 * an entity in the from clause.
 * &lt;p&gt; Serves as a factory for Joins of associations, embeddables, and
 * collections belonging to the type, and for Paths of attributes
 * belonging to the type.
 *
 * @param &lt;Z&gt;  the source type
 * @param &lt;X&gt;  the target type
 *
 * @since 2.0
 */</span>
<span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hiding</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">From</span>&lt;Z, X&gt; <span class="directive">extends</span> Path&lt;X&gt;, FetchParent&lt;Z, X&gt; {

    <span class="comment">/**
     *  Return the joins that have been made from this bound type.
     *  Returns empty set if no joins have been made from this
     *  bound type.
     *  Modifications to the set do not affect the query.
     *  @return joins made from this type
     */</span>
    <span class="predefined-type">Set</span>&lt;Join&lt;X, ?&gt;&gt; getJoins();

    <span class="comment">/**
     *  Whether the &lt;code&gt;From&lt;/code&gt; object has been obtained as a result of
     *  correlation (use of a &lt;code&gt;Subquery&lt;/code&gt; &lt;code&gt;correlate&lt;/code&gt;
     *  method).
     *  @return boolean indicating whether the object has been
     *          obtained through correlation
     */</span>
    <span class="type">boolean</span> isCorrelated();

    <span class="comment">/**
     *  Returns the parent &lt;code&gt;From&lt;/code&gt; object from which the correlated
     *  &lt;code&gt;From&lt;/code&gt; object has been obtained through correlation (use
     *  of a &lt;code&gt;Subquery&lt;/code&gt; &lt;code&gt;correlate&lt;/code&gt; method).
     *  @return  the parent of the correlated From object
     *  @throws IllegalStateException if the From object has
     *          not been obtained through correlation
     */</span>
    From&lt;Z, X&gt; getCorrelationParent();

    <span class="comment">/**
     *  Create an inner join to the specified single-valued
     *  attribute.
     *  @param attribute  target of the join
     *  @return the resulting join
     */</span>
    &lt;Y&gt; Join&lt;X, Y&gt; join(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute);

    <span class="comment">/**
     *  Create a join to the specified single-valued attribute
     *  using the given join type.
     *  @param attribute  target of the join
     *  @param jt  join type
     *  @return the resulting join
     */</span>
    &lt;Y&gt; Join&lt;X, Y&gt; join(SingularAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; attribute, JoinType jt);

    <span class="comment">/**
     *  Create an inner join to the specified Collection-valued
     *  attribute.
     *  @param collection  target of the join
     *  @return the resulting join
     */</span>
    &lt;Y&gt; CollectionJoin&lt;X, Y&gt; join(CollectionAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; collection);

    <span class="comment">/**
     *  Create an inner join to the specified Set-valued attribute.
     *  @param set  target of the join
     *  @return the resulting join
     */</span>
    &lt;Y&gt; SetJoin&lt;X, Y&gt; join(SetAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; set);

    <span class="comment">/**
     *  Create an inner join to the specified List-valued attribute.
     *  @param list  target of the join
     *  @return the resulting join
     */</span>
    &lt;Y&gt; ListJoin&lt;X, Y&gt; join(ListAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; list);

    <span class="comment">/**
     *  Create an inner join to the specified Map-valued attribute.
     *  @param map  target of the join
     *  @return the resulting join
     */</span>
    &lt;K, V&gt; MapJoin&lt;X, K, V&gt; join(MapAttribute&lt;? <span class="local-variable">super</span> X, K, V&gt; map);

    <span class="comment">/**
     *  Create a join to the specified Collection-valued attribute
     *  using the given join type.
     *  @param collection  target of the join
     *  @param jt  join type
     *  @return the resulting join
     */</span>
    &lt;Y&gt; CollectionJoin&lt;X, Y&gt; join(CollectionAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; collection, JoinType jt);

    <span class="comment">/**
     *  Create a join to the specified Set-valued attribute using
     *  the given join type.
     *  @param set  target of the join
     *  @param jt  join type
     *  @return the resulting join
     */</span>
    &lt;Y&gt; SetJoin&lt;X, Y&gt; join(SetAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; set, JoinType jt);

    <span class="comment">/**
     *  Create a join to the specified List-valued attribute using
     *  the given join type.
     *  @param list  target of the join
     *  @param jt  join type
     *  @return the resulting join
     */</span>
    &lt;Y&gt; ListJoin&lt;X, Y&gt; join(ListAttribute&lt;? <span class="local-variable">super</span> X, Y&gt; list, JoinType jt);

    <span class="comment">/**
     *  Create a join to the specified Map-valued attribute using
     *  the given join type.
     *  @param map  target of the join
     *  @param jt  join type
     *  @return the resulting join
     */</span>
    &lt;K, V&gt; MapJoin&lt;X, K, V&gt; join(MapAttribute&lt;? <span class="local-variable">super</span> X, K, V&gt; map, JoinType jt);


    <span class="comment">//String-based:</span>

    <span class="comment">/**
     *  Create an inner join to the specified attribute.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, Y&gt; Join&lt;X, Y&gt; join(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     *  Create an inner join to the specified Collection-valued
     *  attribute.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, Y&gt; CollectionJoin&lt;X, Y&gt; joinCollection(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     *  Create an inner join to the specified Set-valued attribute.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, Y&gt; SetJoin&lt;X, Y&gt; joinSet(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     *  Create an inner join to the specified List-valued attribute.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, Y&gt; ListJoin&lt;X, Y&gt; joinList(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     *  Create an inner join to the specified Map-valued attribute.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, K, V&gt; MapJoin&lt;X, K, V&gt; joinMap(<span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     *  Create a join to the specified attribute using the given
     *  join type.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @param jt  join type
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, Y&gt; Join&lt;X, Y&gt; join(<span class="predefined-type">String</span> attributeName, JoinType jt);

    <span class="comment">/**
     *  Create a join to the specified Collection-valued attribute
     *  using the given join type.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @param jt  join type
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, Y&gt; CollectionJoin&lt;X, Y&gt; joinCollection(<span class="predefined-type">String</span> attributeName, JoinType jt);

    <span class="comment">/**
     *  Create a join to the specified Set-valued attribute using
     *  the given join type.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @param jt  join type
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, Y&gt; SetJoin&lt;X, Y&gt; joinSet(<span class="predefined-type">String</span> attributeName, JoinType jt);

    <span class="comment">/**
     *  Create a join to the specified List-valued attribute using
     *  the given join type.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @param jt  join type
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, Y&gt; ListJoin&lt;X, Y&gt; joinList(<span class="predefined-type">String</span> attributeName, JoinType jt);

    <span class="comment">/**
     *  Create a join to the specified Map-valued attribute using
     *  the given join type.
     *  @param attributeName  name of the attribute for the
     *               target of the join
     *  @param jt  join type
     *  @return the resulting join
     *  @throws IllegalArgumentException if attribute of the given
     *          name does not exist
     */</span>
    &lt;X, K, V&gt; MapJoin&lt;X, K, V&gt; joinMap(<span class="predefined-type">String</span> attributeName, JoinType jt);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="root-interface"><a class="anchor" href="#root-interface"></a>6.3.16. Root Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.EntityType</span>;

<span class="comment">/**
 * A root type in the from clause.
 * Query roots always reference entities.
 *
 * @param &lt;X&gt; the entity type referenced by the root
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Root</span>&lt;X&gt; <span class="directive">extends</span> From&lt;X, X&gt; {

    <span class="comment">/**
     * Return the metamodel entity corresponding to the root.
     * @return metamodel entity corresponding to the root
     */</span>
    EntityType&lt;X&gt; getModel();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="join-interface"><a class="anchor" href="#join-interface"></a>6.3.17. Join Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Attribute</span>;

<span class="comment">/**
 * A join to an entity, embeddable, or basic type.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;X&gt; the target type of the join
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Join</span>&lt;Z, X&gt; <span class="directive">extends</span> From&lt;Z, X&gt; {

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restriction  a simple or compound boolean expression
     *  @return the modified join object
     *  @since 2.1
     */</span>
    Join&lt;Z, X&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restrictions  zero or more restriction predicates
     *  @return the modified join object
     *  @since 2.1
     */</span>
    Join&lt;Z, X&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     *  Return the predicate that corresponds to the ON
     *  restriction(s) on the join, or null if no ON condition
     *  has been specified.
     *  @return the ON restriction predicate
     *  @since 2.1
     */</span>
    <span class="predefined-type">Predicate</span> getOn();

    <span class="comment">/**
     * Return the metamodel attribute corresponding to the join.
     * @return metamodel attribute corresponding to the join
     */</span>
    <span class="predefined-type">Attribute</span>&lt;? <span class="local-variable">super</span> Z, ?&gt; getAttribute();

    <span class="comment">/**
     * Return the parent of the join.
     * @return join parent
     */</span>
    From&lt;?, Z&gt; getParent();

    <span class="comment">/**
     * Return the join type.
     * @return join type
     */</span>
    JoinType getJoinType();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="jointype"><a class="anchor" href="#jointype"></a>6.3.18. JoinType</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="comment">/**
 * Defines the three types of joins.
 *
 * Right outer joins and right outer fetch joins are not required
 * to be supported. Applications that use &lt;code&gt;RIGHT&lt;/code&gt; join
 * types will not be portable.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> JoinType {

    <span class="comment">/** Inner join. */</span>
    INNER,

    <span class="comment">/** Left outer join. */</span>
    LEFT,

    <span class="comment">/** Right outer join. */</span>
    RIGHT
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="pluraljoin-interface"><a class="anchor" href="#pluraljoin-interface"></a>6.3.19. PluralJoin Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.PluralAttribute</span>;

<span class="comment">/**
 * The &lt;code&gt;PluralJoin&lt;/code&gt; interface defines functionality
 * that is common to joins to all collection types.  It is
 * not intended to be used directly in query construction.
 *
 * @param &lt;Z&gt; the source type
 * @param &lt;C&gt; the collection type
 * @param &lt;E&gt; the element type of the collection
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PluralJoin</span>&lt;Z, C, E&gt; <span class="directive">extends</span> Join&lt;Z, E&gt; {

    <span class="comment">/**
     * Return the metamodel representation for the collection-valued
     * attribute corresponding to the join.
     * @return metamodel collection-valued attribute corresponding
     *         to the target of the join
     */</span>
    PluralAttribute&lt;? <span class="local-variable">super</span> Z, C, E&gt; getModel();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="collectionjoin-interface"><a class="anchor" href="#collectionjoin-interface"></a>6.3.20. CollectionJoin Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.Collection</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.CollectionAttribute</span>;

<span class="comment">/**
 * The &lt;code&gt;CollectionJoin&lt;/code&gt; interface is the type of the result of
 * joining to a collection over an association or element
 * collection that has been specified as a &lt;code&gt;java.util.Collection&lt;/code&gt;.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;E&gt; the element type of the target &lt;code&gt;Collection&lt;/code&gt;
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CollectionJoin</span>&lt;Z, E&gt;
        <span class="directive">extends</span> PluralJoin&lt;Z, <span class="predefined-type">Collection</span>&lt;E&gt;, E&gt; {

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restriction  a simple or compound boolean expression
     *  @return the modified join object
     *  @since 2.1
     */</span>
    CollectionJoin&lt;Z, E&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restrictions  zero or more restriction predicates
     *  @return the modified join object
     *  @since 2.1
     */</span>
    CollectionJoin&lt;Z, E&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Return the metamodel representation for the collection
     * attribute.
     * @return metamodel type representing the &lt;code&gt;Collection&lt;/code&gt; that is
     *         the target of the join
     */</span>
    CollectionAttribute&lt;? <span class="local-variable">super</span> Z, E&gt; getModel();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="setjoin-interface"><a class="anchor" href="#setjoin-interface"></a>6.3.21. SetJoin Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.SetAttribute</span>;

<span class="comment">/**
 * The &lt;code&gt;SetJoin&lt;/code&gt; interface is the type of the result of
 * joining to a collection over an association or element
 * collection that has been specified as a &lt;code&gt;java.util.Set&lt;/code&gt;.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;E&gt; the element type of the target &lt;code&gt;Set&lt;/code&gt;
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">SetJoin</span>&lt;Z, E&gt; <span class="directive">extends</span> PluralJoin&lt;Z, <span class="predefined-type">Set</span>&lt;E&gt;, E&gt; {

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restriction  a simple or compound boolean expression
     *  @return the modified join object
     *  @since 2.1
     */</span>
    SetJoin&lt;Z, E&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restrictions  zero or more restriction predicates
     *  @return the modified join object
     *  @since 2.1
     */</span>
    SetJoin&lt;Z, E&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Return the metamodel representation for the set attribute.
     * @return metamodel type representing the &lt;code&gt;Set&lt;/code&gt; that is
     *         the target of the join
     */</span>
    SetAttribute&lt;? <span class="local-variable">super</span> Z, E&gt; getModel();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="listjoin-interface"><a class="anchor" href="#listjoin-interface"></a>6.3.22. ListJoin Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.ListAttribute</span>;

<span class="comment">/**
 * The &lt;code&gt;ListJoin&lt;/code&gt; interface is the type of the result of
 * joining to a collection over an association or element
 * collection that has been specified as a &lt;code&gt;java.util.List&lt;/code&gt;.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;E&gt; the element type of the target List
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ListJoin</span>&lt;Z, E&gt;
        <span class="directive">extends</span> PluralJoin&lt;Z, <span class="predefined-type">List</span>&lt;E&gt;, E&gt; {

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restriction  a simple or compound boolean expression
     *  @return the modified join object
     *  @since 2.1
     */</span>
    ListJoin&lt;Z, E&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restrictions  zero or more restriction predicates
     *  @return the modified join object
     *  @since 2.1
     */</span>
    ListJoin&lt;Z, E&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Return the metamodel representation for the list attribute.
     * @return metamodel type representing the &lt;code&gt;List&lt;/code&gt; that is
     *         the target of the join
     */</span>
    ListAttribute&lt;? <span class="local-variable">super</span> Z, E&gt; getModel();

    <span class="comment">/**
     * Create an expression that corresponds to the index of
     * the object in the referenced association or element
     * collection.
     * This method must only be invoked upon an object that
     * represents an association or element collection for
     * which an order column has been defined.
     * @return expression denoting the index
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Integer</span>&gt; index();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapjoin-interface"><a class="anchor" href="#mapjoin-interface"></a>6.3.23. MapJoin Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.MapAttribute</span>;

<span class="comment">/**
 * The &lt;code&gt;MapJoin&lt;/code&gt; interface is the type of the result of
 * joining to a collection over an association or element
 * collection that has been specified as a &lt;code&gt;java.util.Map&lt;/code&gt;.
 *
 * @param &lt;Z&gt; the source type of the join
 * @param &lt;K&gt; the type of the target Map key
 * @param &lt;V&gt; the type of the target Map value
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MapJoin</span>&lt;Z, K, V&gt;
        <span class="directive">extends</span> PluralJoin&lt;Z, <span class="predefined-type">Map</span>&lt;K, V&gt;, V&gt; {

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restriction  a simple or compound boolean expression
     *  @return the modified join object
     *  @since 2.1
     */</span>
    MapJoin&lt;Z, K, V&gt; on(<span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Boolean</span>&gt; restriction);

    <span class="comment">/**
     *  Modify the join to restrict the result according to the
     *  specified ON condition and return the join object.
     *  Replaces the previous ON condition, if any.
     *  @param restrictions  zero or more restriction predicates
     *  @return the modified join object
     *  @since 2.1
     */</span>
    MapJoin&lt;Z, K, V&gt; on(<span class="predefined-type">Predicate</span>... restrictions);

    <span class="comment">/**
     * Return the metamodel representation for the map attribute.
     * @return metamodel type representing the &lt;code&gt;Map&lt;/code&gt; that is
     *         the target of the join
     */</span>
    MapAttribute&lt;? <span class="local-variable">super</span> Z, K, V&gt; getModel();

    <span class="comment">/**
     * Create a path expression that corresponds to the map key.
     * @return path corresponding to map key
     */</span>
    Path&lt;K&gt; key();

    <span class="comment">/**
     * Create a path expression that corresponds to the map value.
     * This method is for stylistic use only: it just returns this.
     * @return path corresponding to the map value
     */</span>
    Path&lt;V&gt; value();

    <span class="comment">/**
     * Create an expression that corresponds to the map entry.
     * @return expression corresponding to the map entry
     */</span>
    <span class="predefined-type">Expression</span>&lt;<span class="predefined-type">Map</span>.Entry&lt;K, V&gt;&gt; entry();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="order-interface"><a class="anchor" href="#order-interface"></a>6.3.24. Order Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="comment">/**
 * An object that defines an ordering over the query results.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Order</span> {

   <span class="comment">/**
    * Switch the ordering.
    * @return a new &lt;code&gt;Order&lt;/code&gt; instance with the reversed ordering
    */</span>
    Order reverse();

   <span class="comment">/**
    * Whether ascending ordering is in effect.
    * @return boolean indicating whether ordering is ascending
    */</span>
    <span class="type">boolean</span> isAscending();

   <span class="comment">/**
    * Return the expression that is used for ordering.
    * @return expression used for ordering
    */</span>
   <span class="predefined-type">Expression</span>&lt;?&gt; getExpression();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="parameterexpression-interface"><a class="anchor" href="#parameterexpression-interface"></a>6.3.25. ParameterExpression Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.criteria</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.Parameter</span>;

<span class="comment">/**
 * Type of criteria query parameter expressions.
 *
 * @param &lt;T&gt; the type of the parameter expression
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ParameterExpression</span>&lt;T&gt; <span class="directive">extends</span> Parameter&lt;T&gt;, <span class="predefined-type">Expression</span>&lt;T&gt; {}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a10608"><a class="anchor" href="#a10608"></a>6.4. Criteria Query API Usage</h3>
<div class="paragraph">
<p>The <em>jakarta.persistence.criteria</em> API
interfaces are designed both to allow criteria queries to be constructed
in a strongly-typed manner, using metamodel objects to provide type
safety, and to allow for string-based use as an alternative:</p>
</div>
<div class="paragraph">
<p>Metamodel objects are used to specify
navigation through joins and through path
expressions<sup class="footnote">[<a id="_footnoteref_75" class="footnote" href="#_footnotedef_75" title="View footnote.">75</a>]</sup>. Typesafe navigation is achieved by
specification of the source and target types of the navigation.</p>
</div>
<div class="paragraph">
<p>Strings may be used as an alternative to
metamodel objects, whereby joins and navigation are specified by use of
strings that correspond to attribute names.</p>
</div>
<div class="paragraph">
<p>Using either the approach based on metamodel
objects or the string-based approach, queries can be constructed both
statically and dynamically. Both approaches are equivalent in terms of
the range of queries that can be expressed and operational semantics.</p>
</div>
<div class="paragraph">
<p><a href="#a10614">Section 6.5</a> provides a description of the use of the
criteria API interfaces. This section is illustrated on the basis of the
construction of strongly-typed queries using static metamodel classes.
<a href="#a11305">Section 6.6</a> describes how
the <em>jakarta.persistence.metamodel</em> API can be used to construct
strongly-typed queries in the absence of such classes. String-based use
of the criteria API is described in <a href="#a11349">Section 6.7</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="a10614"><a class="anchor" href="#a10614"></a>6.5. Constructing Criteria Queries</h3>
<div class="paragraph">
<p>A criteria query is constructed through the
creation and modification of a
<em>jakarta.persistence.criteria.CriteriaQuery</em> object.</p>
</div>
<div class="paragraph">
<p>The <em>CriteriaBuilder</em> interface is used to
construct <em>CriteriaQuery</em>, <em>CriteriaUpdate</em>, and <em>CriteriaDelete</em>
objects. The <em>CriteriaBuilder</em> implementation is accessed through the
<em>getCriteriaBuilder</em> method of the <em>EntityManager</em> or
<em>EntityManagerFactory</em> interface.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PersistenceUnit</span>
EntityManagerFactory emf;

CriteriaBuilder cb = emf.getCriteriaBuilder();</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="a10621"><a class="anchor" href="#a10621"></a>6.5.1. CriteriaQuery Creation</h4>
<div class="paragraph">
<p>A <em>CriteriaQuery</em> object is created by means
of one of the <em>createQuery</em> methods or the <em>createTupleQuery</em> method of
the <em>CriteriaBuilder</em> interface. A <em>CriteriaQuery</em> object is typed
according to its expected result type when the <em>CriteriaQuery</em> object is
created. A <em>TypedQuery</em> instance created from the <em>CriteriaQuery</em> object
by means of the <em>EntityManager</em> <em>createQuery</em> method will result in
instances of this type when the resulting query is executed.</p>
</div>
<div class="paragraph">
<p>The following methods are provided for the
creation of <em>CriteriaQuery</em> objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;T&gt; CriteriaQuery&lt;T&gt; createQuery(<span class="predefined-type">Class</span>&lt;T&gt; resultClass);

CriteriaQuery&lt;Tuple&gt; createTupleQuery();

CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; createQuery();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Methods for the creation of update and delete
queries are described in <a href="#a11239">Section 6.5.15</a>.</p>
</div>
<div class="paragraph">
<p>The methods &lt;T&gt; CriteriaQuery&lt;T&gt;
createQuery(Class&lt;T&gt; resultClass) and <em>createTupleQuery</em> provide for
typing of criteria query results and for typesafe query execution using
the <em>TypedQuery</em> API.</p>
</div>
<div class="paragraph">
<p>The effect of the <em>createTupleQuery</em> method
is semantically equivalent to invoking the <em>createQuery</em> method with the
<em>Tuple.class</em> argument. The <em>Tuple</em> interface supports the extraction of
multiple selection items in a strongly typed manner. See <a href="#a3868">Section 3.10.3</a> and
<a href="#a3949">Section 3.10.4</a>.</p>
</div>
<div class="paragraph">
<p>The CriteriaQuery&lt;Object&gt; createQuery()
method supports both the case where the <em>select</em> or <em>multiselect</em> method
specifies only a single selection item and where the <em>multiselect</em>
method specifies multiple selection items. If only a single item is
specified, an instance of type <em>Object</em> will be returned for each result
of the query execution. If multiple selection items are specified, an
instance of type <em>Object[]</em> will be instantiated and returned for each
result of the execution.</p>
</div>
<div class="paragraph">
<p>See <a href="#a10945">Section 6.5.11</a> for further discussion of the specification
of selection items.</p>
</div>
</div>
<div class="sect3">
<h4 id="query-roots"><a class="anchor" href="#query-roots"></a>6.5.2. Query Roots</h4>
<div class="paragraph">
<p>A <em>CriteriaQuery</em> object defines a query over
one or more entity, embeddable, or basic abstract schema types. The root
objects of the query are entities, from which the other types are
reached by navigation. A query root plays a role analogous to that of a
range variable in the Jakarta Persistence query language and forms the
basis for defining the domain of the query.</p>
</div>
<div class="paragraph">
<p>A query root is created and added to the
query by use of the <em>from</em> method of the <em>AbstractQuery</em> interface (from
which both the <em>CriteriaQuery</em> and <em>Subquery</em> interfaces inherit). The
argument to the <em>from</em> method is the entity class or <em>EntityType</em>
instance for the entity. The result of the <em>from</em> method is a <em>Root</em>
object. The <em>Root</em> interface extends the <em>From</em> interface, which
represents objects that may occur in the from clause of a query.</p>
</div>
<div class="paragraph">
<p>A <em>CriteriaQuery</em> object may have more than
one root. The addition of a query root has the semantic effect of
creating a cartesian product between the entity type referenced by the
added root and those of the other roots.</p>
</div>
<div class="paragraph">
<p>The following query illustrates the
definition of a query root. When executed, this query causes all
instances of the <em>Customer</em> entity to be returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaBuilder cb = ...
CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
q.select(customer);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a10643"><a class="anchor" href="#a10643"></a>6.5.3. Joins</h4>
<div class="paragraph">
<p>The <em>join</em> methods of the <em>From</em> interface
extend the query domain by creating a join with a related class that can
be navigated to or that is an element of the given class of the query
domain.</p>
</div>
<div class="paragraph">
<p>The target of the join is specified by
the corresponding <em>SingularAttribute</em> or collection-valued attribute (
<em>CollectionAttribute</em>, <em>SetAttribute</em>, <em>ListAttribute</em>, or
<em>MapAttribute</em>) of the corresponding metamodel
class.<sup class="footnote">[<a id="_footnoteref_76" class="footnote" href="#_footnotedef_76" title="View footnote.">76</a>]</sup> <sup class="footnote">[<a id="_footnoteref_77" class="footnote" href="#_footnotedef_77" title="View footnote.">77</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <em>join</em> methods may be applied to
instances of the <em>Root</em> and <em>Join</em> types.</p>
</div>
<div class="paragraph">
<p>The result of a <em>join</em> method is a <em>Join</em>
object (instance of the <em>Join</em>, <em>CollectionJoin</em>, <em>SetJoin</em>,
<em>ListJoin</em>, or <em>MapJoin</em> types) that captures the source and target
types of the join.</p>
</div>
<div class="paragraph">
<p>For example, given the <em>Order</em> entity and
corresponding <em>Order_</em> metamodel class shown in <a href="#a6961">Section 6.2.1.2</a>, a join to the lineItems of the
order would be expressed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Order&gt; order = q.from(Order.class);
Join&lt;Order, Item&gt; item = order.join(Order_.lineItems);
q.select(order);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The argument to the <em>join</em> method,
<em>Order</em>.lineItems_, is of type
<em>jakarta.persistence.metamodel.SetAttribute&lt;Order, Item&gt;</em>.</p>
</div>
<div class="paragraph">
<p>The <em>join</em> methods have the same semantics as
the corresponding Jakarta Persistence query language operations, as
described in <a href="#a4957">Section 4.4.7</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaBuilder cb = ...
CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Join&lt;Customer, Order&gt; order = customer.join(Customer_.orders);
Join&lt;Order, Item&gt; item = order.join(Order_.lineItems);
q.select(customer.get(Customer_.name))
    .where(cb.equal(item.get(Item_.product).get(Product_.productType), <span class="string"><span class="delimiter">&quot;</span><span class="content">printer</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.name
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> o.lineItems i
<span class="keyword">WHERE</span> i.product.productType = <span class="string"><span class="delimiter">'</span><span class="content">printer</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Joins can be chained, thus allowing this
query to be written more concisely:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Join&lt;Order, Item&gt; item = customer.join(Customer_.orders).join(Order_.lineItems);
q.select(customer.get(Customer_.name))
    .where(cb.equal(item.get(Item_.product).get(Product_.productType), <span class="string"><span class="delimiter">&quot;</span><span class="content">printer</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the <em>join</em> method defines an
inner join. Outer joins are defined by specifying a <em>JoinType</em> argument.
Only left outer joins and left outer fetch joins are required to be
supported. Applications that make use of right outer joins or right
outer fetch joins will not be portable.</p>
</div>
<div class="paragraph">
<p>The following query uses a left outer join:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Join&lt;Customer,Order&gt; order = customer.join(Customer_.orders, JoinType.LEFT);
q.where(cb.equal(customer.get(Customer_.status), <span class="integer">1</span>))
    .select(customer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> c.orders o <span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>On-conditions can be specified for joins. The
following query uses an on-condition with a left outer join:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Supplier&gt; s = q.from(Supplier.class);
Join&lt;Supplier, Product&gt; p = s.join(Supplier_.products, JoinType.LEFT);
p.on(cb.equal(p.get(Product_.status), <span class="string"><span class="delimiter">&quot;</span><span class="content">inStock</span><span class="delimiter">&quot;</span></span>));
q.groupBy(s.get(Supplier_.name));
q.multiselect(s.get(Supplier_.name), cb.count(p));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> s.name, <span class="predefined">COUNT</span>(p)
<span class="keyword">FROM</span> Suppliers s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> s.products p <span class="keyword">ON</span> p.status = <span class="string"><span class="delimiter">'</span><span class="content">inStock</span><span class="delimiter">'</span></span>
<span class="keyword">GROUP</span> <span class="keyword">BY</span> s.name</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="fetch-joins"><a class="anchor" href="#fetch-joins"></a>6.5.4. Fetch Joins</h4>
<div class="paragraph">
<p>Fetch joins are specified by means of the
<em>fetch</em> method. The <em>fetch</em> method specifies that the referenced
association or attribute is to be fetched as a side effect of the
execution of the query. The <em>fetch</em> method can be applied to a <em>Root</em> or
<em>Join</em> instance.</p>
</div>
<div class="paragraph">
<p>An association or attribute referenced by the
<em>fetch</em> method must be referenced from an entity or embeddable that is
returned as the result of the query. A fetch join has the same join
semantics as the corresponding inner or outer join, except that the
related objects are not top-level objects in the query result and cannot
be referenced elsewhere by the query. See <a href="#a4931">Section 4.4.5.3</a>.</p>
</div>
<div class="paragraph">
<p>The <em>fetch</em> method must not be used in a subquery.</p>
</div>
<div class="paragraph">
<p>Multiple levels of fetch joins are not
required to be supported by an implementation of this specification.
Applications that use multi-level fetch joins will not be portable.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Department&gt; q = cb.createQuery(Department.class);
Root&lt;Department&gt; d = q.from(Department.class);
d.fetch(Department.employees, JoinType.LEFT);
q.where(cb.equal(d.get(Department_.deptno), <span class="integer">1</span>)).select(d);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> d
<span class="keyword">FROM</span> Department d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> FETCH d.employees
<span class="keyword">WHERE</span> d.deptno = <span class="integer">1</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16277"><a class="anchor" href="#a16277"></a>6.5.5. Path Navigation</h4>
<div class="paragraph">
<p>A <em>Path</em> instance can be a <em>Root</em> instance, a
<em>Join</em> instance, a <em>Path</em> instance that has been derived from another
<em>Path</em> instance by means of the <em>get</em> navigation method, or a <em>Path</em>
instance derived from a map-valued association or element collection by
use of the <em>key</em> or <em>value</em> method.</p>
</div>
<div class="paragraph">
<p>When a criteria query is executed, path
navigation—like path navigation using the Jakarta Persistence query
language—is obtained using “inner join” semantics. That is, if the value
of a non-terminal <em>Path</em> instance is null, the path is considered to
have no value, and does not participate in the determination of the
query result. See <a href="#a4792">[a4792]</a>.</p>
</div>
<div class="paragraph">
<p>The <em>get</em> method is used for path navigation.
The argument to the <em>get</em> method is specified by the corresponding
<em>SingularAttribute</em> or collection-valued attribute
<em>(CollectionAttribute</em>, <em>SetAttribute</em>, <em>ListAttribute</em>, or
<em>MapAttribute</em>) of the corresponding metamodel
class<sup class="footnote">[<a id="_footnoteref_78" class="footnote" href="#_footnotedef_78" title="View footnote.">78</a>]</sup>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>In the following example, <em>ContactInfo</em> is an
embeddable class consisting of an address and set of phones. <em>Phone</em> is
an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Vendor&gt; q = cb.createQuery(Vendor.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
Join&lt;ContactInfo, Phone&gt; phone =
    emp.join(Employee_.contactInfo).join(ContactInfo_.phones);
q.where(cb.equal(emp.get(Employee_.contactInfo)
        .get(ContactInfo_.address)
        .get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">95054</span><span class="delimiter">&quot;</span></span>))
    .select(phone.get(Phone_.vendor));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo.phones p
<span class="keyword">WHERE</span> e.contactInfo.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>In this example, the <em>photos</em> attribute
corresponds to a map from photo label to filename. The map key is a
string, the value an object. The result of this query will be returned
as a <em>Tuple</em> object whose elements are of types <em>String</em> and <em>Object</em>.
The <em>multiselect</em> method, described further in <a href="#a10945">Section 6.5.11</a>, is used to
specify that the query returns multiple selection items.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Item&gt; item = q.from(Item.class);
MapJoin&lt;Item, <span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; photo = item.join(Item_.photos);
q.multiselect(item.get(Item_.name), photo)
    .where(cb.like(photo.key(), <span class="string"><span class="delimiter">&quot;</span><span class="content">%egret%</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> i.name, p
<span class="keyword">FROM</span> Item i <span class="keyword">JOIN</span> i.photos p
<span class="keyword">WHERE</span> <span class="type">KEY</span>(p) <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%egret%</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="restricting-the-query-result"><a class="anchor" href="#restricting-the-query-result"></a>6.5.6. Restricting the Query Result</h4>
<div class="paragraph">
<p>The result of a query can be restricted by
specifying one or more predicate conditions. Restriction predicates are
applied to the <em>CriteriaQuery</em> object by means of the <em>where</em> method.
Invocation of the <em>where</em> method results in the modification of the
<em>CriteriaQuery</em> object with the specified restriction(s).</p>
</div>
<div class="paragraph">
<p>The argument to the <em>where</em> method can be
either an <em>Expression&lt;Boolean&gt;</em> instance or zero or more <em>Predicate</em>
instances. A predicate can be either simple or compound.</p>
</div>
<div class="paragraph">
<p>A simple predicate is created by invoking one
of the conditional methods of the <em>CriteriaBuilder</em> interface, or by the
<em>isNull</em>, <em>isNotNull</em>, and <em>in</em> methods of the <em>Expression</em> interface.
The semantics of the conditional methods—e.g., <em>equal</em>, <em>notEqual</em>,
<em>gt</em>, <em>ge</em>, <em>lt</em>, <em>le</em>, <em>between</em>, and <em>like</em> — mirror those of the
corresponding Jakarta Persistence query language operators as described in
<a href="#a4665">Chapter 4</a>.</p>
</div>
<div class="paragraph">
<p>Compound predicates are constructed by means
of the <em>and</em>, <em>or</em>, and <em>not</em> methods of the <em>CriteriaBuilder</em>
interface.</p>
</div>
<div class="paragraph">
<p>The restrictions upon the types to which
conditional operations are permitted to be applied are the same as the
respective operators of the Jakarta Persistence query language as described
in subsections <a href="#a5066">Section 4.6.7</a> through <a href="#a5243">Section 4.6.17</a>. The same
null value semantics as described in <a href="#a5676">Section 4.11</a> and the subsections of
<a href="#a4994">Section 4.6</a> apply.
The equality and comparison semantics described in <a href="#a5735">Section 4.12</a> likewise apply.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;TransactionHistory&gt; q = cb.createQuery(TransactionHistory.class);
Root&lt;CreditCard&gt; cc = q.from(CreditCard.class);
ListJoin&lt;CreditCard,TransactionHistory&gt; t = cc.join(CreditCard_.transactionHistory);
q.select(t)
    .where(cb.equal(cc.get(CreditCard_.customer)
             .get(Customer_.accountNum), <span class="integer">321987</span>),
           cb.between (t.index(), <span class="integer">0</span>, <span class="integer">9</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> t
<span class="keyword">FROM</span> CreditCard c <span class="keyword">JOIN</span> c.transactionHistory t
<span class="keyword">WHERE</span> c.customer.accountNum = <span class="integer">321987</span> <span class="keyword">AND</span> <span class="type">INDEX</span>(t) <span class="keyword">BETWEEN</span> <span class="integer">0</span> <span class="keyword">AND</span> <span class="integer">9</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Order&gt; order = q.from(Order.class);
q.where(cb.isEmpty(order.get(Order_.lineItems)))
    .select(order);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> o.lineItems <span class="keyword">IS</span> EMPTY</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="downcasting"><a class="anchor" href="#downcasting"></a>6.5.7. Downcasting</h4>
<div class="paragraph">
<p>Downcasting by means of the <em>treat</em> method is
supported in joins and in the construction of <em>where</em> conditions.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Order&gt; order = q.from(Order.class);
Join&lt;Order,<span class="predefined-type">Book</span>&gt; book = cb.treat(order.join(Order_.product), <span class="predefined-type">Book</span>.class);
q.select(book.get(Book_.isbn));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> b.ISBN
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> TREAT(o.product <span class="keyword">AS</span> Book) b</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Join&lt;Customer, Order&gt; order = customer.join(Customer_.orders);
q.where(
    cb.equal(cb.treat(order.get(Order_.product), <span class="predefined-type">Book</span>.class).get(Book_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Iliad</span><span class="delimiter">&quot;</span></span>));
q.select(customer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> TREAT(o.product <span class="keyword">AS</span> Book).name = <span class="string"><span class="delimiter">'</span><span class="content">Iliad</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Employee&gt; q = cb.createQuery(Employee.class);
Root&lt;Employee&gt; e = q.from(Employee.class);
q.where(
    cb.or(cb.gt(cb.treat(e, Exempt.class).get(Exempt_.vacationDays), <span class="integer">10</span>),
    cb.gt(cb.treat(e, Contractor.class).get(Contractor_.hours), <span class="integer">100</span>)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TREAT(e <span class="keyword">AS</span> Exempt).vacationDays &gt; <span class="integer">10</span>
    <span class="keyword">OR</span> TREAT(e <span class="keyword">AS</span> Contractor).hours &gt; <span class="integer">100</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="expressions"><a class="anchor" href="#expressions"></a>6.5.8. Expressions</h4>
<div class="paragraph">
<p>An <em>Expression</em> or one of its subtypes can be
used in the construction of the query&#8217;s select list or in the
construction of <em>where</em> or <em>having</em> method conditions.</p>
</div>
<div class="paragraph">
<p>Paths and boolean predicates are expressions.</p>
</div>
<div class="paragraph">
<p>Other expressions are created by means of the
methods of the <em>CriteriaBuilder</em> interface. The <em>CriteriaBuilder</em>
interface provides methods corresponding to the built-in arthmetic,
string, datetime, and case operators and functions of the Jakarta
Persistence query language.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; cust = q.from(Customer.class);
Join&lt;Customer, Order&gt; order = cust.join(Customer_.orders);
Join&lt;Customer, Address&gt; addr = cust.join(Customer_.address);
q.where(cb.equal(addr.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>),
        cb.equal(addr.get(Address_.county), <span class="string"><span class="delimiter">&quot;</span><span class="content">Santa Clara</span><span class="delimiter">&quot;</span></span>));

q.multiselect(order.get(Order_.quantity),
        cb.prod(order.get(Order_.totalCost), <span class="float">1.08</span>),
        addr.get(Address_.zipcode));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o.quantity, o.totalCost*<span class="float">1.08</span>, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> a.county = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Employee&gt; q = cb.createQuery(Employee.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
q.select(emp)
    .where(cb.notEqual(emp.type(), Exempt.class));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>type</em> method can only be applied to a
path expression. Its result denotes the type navigated to by the path.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e
<span class="keyword">FROM</span> Employee e
<span class="keyword">WHERE</span> TYPE(e) &lt;&gt; Exempt</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Course&gt; c = q.from(Course.class);
ListJoin&lt;Course, Student&gt; w = c.join(Course_.studentWaitlist);
q.where(cb.equal(c.get(Course_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Calculus</span><span class="delimiter">&quot;</span></span>),
        cb.equal(w.index(), <span class="integer">0</span>))
 .select(w.get(Student_.name));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>index</em> method can be applied to a
<em>ListJoin</em> object that corresponds to a list for which an order column
has been specified. Its result denotes the position of the item in the
list.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> w.name
<span class="keyword">FROM</span> Course c <span class="keyword">JOIN</span> c.studentWaitlist w
<span class="keyword">WHERE</span> c.name = <span class="string"><span class="delimiter">'</span><span class="content">Calculus</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> <span class="type">INDEX</span>(w) = <span class="integer">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">BigDecimal</span>&gt; q = cb.createQuery(<span class="predefined-type">BigDecimal</span>.class);
Root&lt;Order&gt; order = q.from(Order.class);
Join&lt;Order, Item&gt; item = order.join(Order_.lineItems);
Join&lt;Order, Customer&gt; cust = order.join(Order_.customer);

q.where(
    cb.equal(cust.get(Customer_.lastName), <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>),
    cb.equal(cust.get(Customer_.firstName), <span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>));
q.select(cb.sum(item.get(Item_.price)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The aggregation methods <em>avg</em>, <em>max</em>, <em>min</em>
, <em>sum</em>, <em>count</em> can only be used in the construction of the select
list or in <em>having</em> method conditions.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">SUM</span>(i.price)
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.lineItems i <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> c.lastName = <span class="string"><span class="delimiter">'</span><span class="content">Smith</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> c.firstName = <span class="string"><span class="delimiter">'</span><span class="content">John</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Integer</span>&gt; q = cb.createQuery(<span class="predefined-type">Integer</span>.class);
Root&lt;Department&gt; d = q.from(Department.class);
q
    .where(cb.equal(d.get(Department_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Sales</span><span class="delimiter">&quot;</span></span>))
    .select(cb.size(d.get(Department_.employees)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>size</em> method can be applied to a path
expression that corresponds to an association or element collection. Its
result denotes the number of elements in the association or element
collection.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> SIZE(d.employees)
<span class="keyword">FROM</span> Department d
<span class="keyword">WHERE</span> d.name = <span class="string"><span class="delimiter">'</span><span class="content">Sales</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong></p>
</div>
<div class="paragraph">
<p>Both simple and general case expressions are
supported. The query below illustrates use of a general case expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Employee&gt; e = q.from(Employee.class);
q.where(
    cb.equal(e.get(Employee_.department).get(Department_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Engineering</span><span class="delimiter">&quot;</span></span>));
q.multiselect(
    e.get(Employee_.name),
    cb.selectCase()
        .when(
            cb.equal(e.get(Employee_.rating), <span class="integer">1</span>),
            cb.prod(e.get(Employee_.salary), <span class="float">1.1</span>))
        .when(
            cb.equal(e.get(Employee_.rating), <span class="integer">2</span>),
            cb.prod(e.get(Employee_.salary), <span class="float">1.2</span>))
        .otherwise(cb.prod(e.get(Employee_.salary), <span class="float">1.01</span>)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> e.name,
    <span class="keyword">CASE</span>
        <span class="keyword">WHEN</span> e.rating = <span class="integer">1</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.1</span>
        <span class="keyword">WHEN</span> e.rating = <span class="integer">2</span> <span class="keyword">THEN</span> e.salary * <span class="float">1.2</span>
        <span class="keyword">ELSE</span> e.salary * <span class="float">1.01</span>
    <span class="keyword">END</span>
<span class="keyword">FROM</span> EMPLOYEE e
<span class="keyword">WHERE</span> e.department.name = <span class="string"><span class="delimiter">'</span><span class="content">Engineering</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="result-types-of-expressions"><a class="anchor" href="#result-types-of-expressions"></a>6.5.8.1. Result Types of Expressions</h5>
<div class="paragraph">
<p>The <em>getJavaType</em> method, as defined in the
<em>TupleElement</em> interface, returns the runtime type of the object on
which it is invoked.</p>
</div>
<div class="paragraph">
<p>In the case of the <em>In</em>, <em>Case</em>,
<em>SimpleCase</em>, and <em>Coalesce</em> builder interfaces, the runtime results of
the <em>getJavaType</em> method may differ from the <em>Expression</em> type and may
vary as the expression is incrementally constructed. For non-numerical
operands, the implementation must return the most specific common
superclass of the types of the operands used to form the result.</p>
</div>
<div class="paragraph">
<p>In the case of the two-argument <em>sum</em>,
<em>prod</em>, <em>diff</em>, <em>quot</em>, <em>coalesce</em>, and <em>nullif</em> methods, and the
<em>In</em>, <em>Case</em>, <em>SimpleCase</em>, and <em>Coalesce</em> builder methods, the
runtime result types will differ from the <em>Expression</em> type when the
latter is <em>Number</em>. The following rules must be observed by the
implementation when materializing the results of numeric expressions
involving these methods. These rules correspond to those specified for
the Jakarta Persistence query language as defined in <a href="#a5574">Section 4.8.6</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is an operand of type Double, the
result of the operation is of type Double;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
Float, the result of the operation is of type Float;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
BigDecimal, the result of the operation is of type BigDecimal;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
BigInteger, the result of the operation is of type BigInteger, unless
the method is <em>quot</em>, in which case the numeric result type is not
further defined;</p>
</li>
<li>
<p>otherwise, if there is an operand of type
Long, the result of the operation is of type Long, unless the method is
<em>quot</em>, in which case the numeric result type is not further defined;</p>
</li>
<li>
<p>otherwise, if there is an operand of integral
type, the result of the operation is of type Integer, unless the method
is <em>quot</em>, in which case the numeric result type is not further
defined.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Users should note that the semantics of the
SQL division operation are not standard across databases. In particular,
when both operands are of integral types, the result of the division
operation will be an integral type in some databases, and an
non-integral type in others. Portable applications should not assume a
particular result type.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="literals-2"><a class="anchor" href="#literals-2"></a>6.5.9. Literals</h4>
<div class="paragraph">
<p>An <em>Expression</em> literal instance is obtained
by passing a value to the <em>literal</em> method of the <em>CriteriaBuilder</em>
interface. An <em>Expression</em> instance representing a null is created by
the <em>nullLiteral</em> method of the <em>CriteriaBuilder</em> interface.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
Join&lt;Employee, FrequentFlierPlan&gt; fp = emp.join(Employee_.frequentFlierPlan);

q.select(
    cb.&lt;<span class="predefined-type">String</span>&gt;selectCase()
        .when(
            cb.gt(fp.get(FrequentFlierPlan_.annualMiles), <span class="integer">50000</span>),
            cb.literal(<span class="string"><span class="delimiter">&quot;</span><span class="content">Platinum</span><span class="delimiter">&quot;</span></span>))
        .when(
            cb.gt(fp.get(FrequentFlierPlan_.annualMiles), <span class="integer">25000</span>),
            cb.literal(<span class="string"><span class="delimiter">&quot;</span><span class="content">Silver</span><span class="delimiter">&quot;</span></span>))
        .otherwise(cb.nullLiteral(<span class="predefined-type">String</span>.class)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span>
    <span class="keyword">CASE</span>
        <span class="keyword">WHEN</span> fp.annualMiles &gt; <span class="integer">50000</span> <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Platinum</span><span class="delimiter">'</span></span>
        <span class="keyword">WHEN</span> fp.annualMiles &gt; <span class="integer">25000</span> <span class="keyword">THEN</span> <span class="string"><span class="delimiter">'</span><span class="content">Gold</span><span class="delimiter">'</span></span>
        <span class="keyword">ELSE</span> <span class="predefined-constant">NULL</span>
    <span class="keyword">END</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="parameter-expressions"><a class="anchor" href="#parameter-expressions"></a>6.5.10. Parameter Expressions</h4>
<div class="paragraph">
<p>A <em>ParameterExpression</em> instance is an
expression that corresponds to a parameter whose value will be supplied
before the query is executed. Parameter expressions can only be used in
the construction of conditional predicates.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; c = q.from(Customer.class);
ParameterExpression&lt;<span class="predefined-type">Integer</span>&gt; param = cb.parameter(<span class="predefined-type">Integer</span>.class);

q.select(c)
    .where(cb.equal(c.get(Customer_.status), param));</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a name is supplied when the
<em>ParameterExpression</em> instance is created, the parameter may also be
treated as a named parameter when the query is executed:</p>
</div>
<div class="paragraph">
<p>CriteriaQuery&lt;Customer&gt; q =
cb.createQuery(Customer.class);</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Root&lt;Customer&gt; c = q.from(Customer.class);
ParameterExpression&lt;<span class="predefined-type">Integer</span>&gt; param = cb.parameter(<span class="predefined-type">Integer</span>.class, <span class="string"><span class="delimiter">&quot;</span><span class="content">stat</span><span class="delimiter">&quot;</span></span>);
q.select(c).where(cb.equal(c.get(Customer_.status), param));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is equivalent to the following query in
the Jakarta Persistence query language:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c <span class="keyword">WHERE</span> c.status = :stat</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a10945"><a class="anchor" href="#a10945"></a>6.5.11. Specifying the Select List</h4>
<div class="paragraph">
<p>The select list of a query is specified by
use of the <em>select</em> or <em>multiselect</em> methods of the <em>CriteriaQuery</em>
interface. The arguments to the <em>select</em> and <em>multiselect</em> methods are
<em>Selection</em> instances.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Portable applications should use the <em>select</em>
or <em>multiselect</em> method to specify the query&#8217;s selection list.
Applications that do not use one of these methods will not be portable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <em>select</em> method takes a single
<em>Selection</em> argument, which can be either an <em>Expression</em> instance or a
<em>CompoundSelection</em> instance. The type of the <em>Selection</em> item must be
assignable to the defined <em>CriteriaQuery</em> result type, as described in
<a href="#a10621">Section 6.5.1</a>.</p>
</div>
<div class="paragraph">
<p>The <em>construct</em>, <em>tuple</em> and <em>array</em> methods
of the <em>CriteriaBuilder</em> interface are used to aggregate multiple
selection items into a <em>CompoundSelection</em> instance.</p>
</div>
<div class="paragraph">
<p>The <em>multiselect</em> method also supports the
specification and aggregation of multiple selection items. When the
<em>multiselect</em> method is used, the aggregation of the selection items is
determined by the result type of the <em>CriteriaQuery</em> object as described
in <a href="#a10621">Section 6.5.1</a> and <a href="#a8857">Section 6.3.4</a>.</p>
</div>
<div class="paragraph">
<p>A <em>Selection</em> instance passed to the
<em>construct</em>, <em>tuple</em>, <em>array</em>, or <em>multiselect</em> methods can be one of
the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <em>Expression</em> instance.</p>
</li>
<li>
<p>A <em>Selection</em> instance obtained as the result
of the invocation of the <em>CriteriaBuilder construct</em> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>distinct</em> method of the <em>CriteriaQuery</em>
interface is used to specify that duplicate values must be eliminated
from the query result. If the <em>distinct</em> method is not used or
<em>distinct(false)</em> is invoked on the criteria query object, duplicate
values are not eliminated. When <em>distinct(true)</em> is used, and the select
items include embeddable objects or map entry results, the elimination
of duplicates is undefined.</p>
</div>
<div class="paragraph">
<p>The semantics of the <em>construct</em> method used
in the selection list is as described in <a href="#a5500">Section 4.8.2</a>. The semantics of embeddables returned by the selection list areas described in <a href="#a5511">Section 4.8.4</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>In the following example, <em>videoInventory</em> is
a Map from the entity <em>Movie</em> to the number of copies in stock.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;VideoStore&gt; v = q.from(VideoStore.class);
MapJoin&lt;VideoStore, Movie, <span class="predefined-type">Integer</span>&gt; inv = v.join(VideoStore_.videoInventory);

q.multiselect(
    v.get(VideoStore_.location).get(Address_.street),
    inv.key().get(Movie_.title),
    inv);
q.where(cb.equal(v.get(VideoStore_.location).get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">94301</span><span class="delimiter">&quot;</span></span>),
        cb.gt(inv, <span class="integer">0</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following, in
which the <em>tuple</em> method is used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;VideoStore&gt; v = q.from(VideoStore.class);
MapJoin&lt;VideoStore, Movie, <span class="predefined-type">Integer</span>&gt; inv = v.join(VideoStore_.videoInventory);

q.select(cb.tuple(
        v.get(VideoStore_.location).get(Address_.street),
        inv.key().get(Movie_.title),
        inv));
q.where(cb.equal(v.get(VideoStore_.location).get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">94301</span><span class="delimiter">&quot;</span></span>),
        cb.gt(inv, <span class="integer">0</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both are equivalent to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> v.location.street, <span class="type">KEY</span>(i).title, VALUE(i)
<span class="keyword">FROM</span> VideoStore v <span class="keyword">JOIN</span> v.videoInventory i
<span class="keyword">WHERE</span> v.location.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">94301</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> VALUE(i) &gt; <span class="integer">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 2:</p>
</div>
<div class="paragraph">
<p>The following two queries are equivalent to
the Jakarta Persistence query language query above. Because the result type
is not specified by the_ <em>createQuery</em> <em>method, an</em> <em>Object[]</em> _is
returned as a result of the query execution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; q = cb.createQuery();
Root&lt;VideoStore&gt; v = q.from(VideoStore.class);
MapJoin&lt;VideoStore, Movie, <span class="predefined-type">Integer</span>&gt; inv = v.join(VideoStore_.videoInventory);

q.multiselect(
    v.get(VideoStore_.location).get(Address_.street),
    inv.key().get(Movie_.title),
    inv);

q.where(cb.equal(v.get(VideoStore_.location).get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">94301</span><span class="delimiter">&quot;</span></span>),
        cb.gt(inv, <span class="integer">0</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Equivalently:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; q = cb.createQuery();
Root&lt;VideoStore&gt; v = q.from(VideoStore.class);
MapJoin&lt;VideoStore, Movie, <span class="predefined-type">Integer</span>&gt; inv = v.join(VideoStore_.videoInventory);

q.select(cb.array(
        v.get(VideoStore_.location).get(Address_.street),
        inv.key().get(Movie_.title),
        inv));
q.where(cb.equal(v.get(VideoStore_.location).get(Address_.zipcode), <span class="string"><span class="delimiter">&quot;</span><span class="content">94301</span><span class="delimiter">&quot;</span></span>),
        cb.gt(inv, <span class="integer">0</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 3:</p>
</div>
<div class="paragraph">
<p>The following example illustrates the
specification of a constructor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;CustomerDetails&gt; q = cb.createQuery(CustomerDetails.class);
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);

q.where(cb.gt(o.get(Order_.quantity), <span class="integer">100</span>));
q.select(cb.construct(
        CustomerDetails.class,
        c.get(Customer_.id),
        c.get(Customer_.status),
        o.get(Order_.quantity)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> NEW com.acme.example.CustomerDetails(c.id, c.status, o.quantity)
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> o.quantity &gt; <span class="integer">100</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="assigning-aliases-to-selection-items"><a class="anchor" href="#assigning-aliases-to-selection-items"></a>6.5.11.1. Assigning Aliases to Selection Items</h5>
<div class="paragraph">
<p>The <em>alias</em> method of the <em>Selection</em>
interface can be used to assign an alias to a selection item. The alias
may then later be used to extract the corresponding item from the query
result when the query is executed. The <em>alias</em> method assigns the given
alias to the <em>Selection</em> item. Once assigned, the alias cannot be
changed.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer, Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(c.get(Customer_.id), <span class="integer">97510</span>));
q.multiselect(
        o.get(Order_.quantity).alias(<span class="string"><span class="delimiter">&quot;</span><span class="content">quantity</span><span class="delimiter">&quot;</span></span>),
        cb.prod(o.get(Order_.totalCost), <span class="float">1.08</span>).alias(<span class="string"><span class="delimiter">&quot;</span><span class="content">taxedCost</span><span class="delimiter">&quot;</span></span>),
        a.get(Address_.zipcode).alias(<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode</span><span class="delimiter">&quot;</span></span>));

TypedQuery&lt;Tuple&gt; typedQuery = em.createQuery(q);
Tuple result = typedQuery.getSingleResult();
<span class="predefined-type">Double</span> cost = (<span class="predefined-type">Double</span>)result.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">taxedCost</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="subqueries"><a class="anchor" href="#subqueries"></a>6.5.12. Subqueries</h4>
<div class="paragraph">
<p>Both correlated and non-correlated subqueries
can be used in restriction predicates. A subquery is constructed through
the creation and modification of a <em>Subquery</em> object.</p>
</div>
<div class="paragraph">
<p>A <em>Subquery</em> instance can be passed as an
argument to the <em>all</em>, <em>any</em>, or <em>some</em> methods of the
<em>CriteriaBuilder</em> interface for use in conditional expressions.</p>
</div>
<div class="paragraph">
<p>A <em>Subquery</em> instance can be passed to the
<em>CriteriaBuilder</em> <em>exists</em> method to create a conditional predicate.</p>
</div>
<div class="paragraph">
<p><strong>Example 1: Non-correlated subquery</strong></p>
</div>
<div class="paragraph">
<p>The query below contains a non-correlated
subquery. A non-correlated subquery does not reference objects of the
query of which it is a subquery. In particular, <em>Root</em>, <em>Join</em>, and
<em>Path</em> instances are not shared between the subquery and the criteria
query instance of which it is a subquery.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// create criteria query instance, with root Customer</span>
CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; goodCustomer = q.from(Customer.class);

<span class="comment">// create subquery instance, with root Customer</span>
<span class="comment">// the Subquery object is typed according to its return type</span>
Subquery&lt;<span class="predefined-type">Double</span>&gt; sq = q.subquery(<span class="predefined-type">Double</span>.class);
Root&lt;Customer&gt; customer = sq.from(Customer.class);

<span class="comment">// the result of the first query depends on the subquery</span>
q.where(cb.lt(
    goodCustomer.get(Customer_.balanceOwed),
    sq.select(cb.avg(customer.get(Customer_.balanceOwed)))));
q.select(goodCustomer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> goodCustomer
<span class="keyword">FROM</span> Customer goodCustomer
<span class="keyword">WHERE</span> goodCustomer.balanceOwed &lt; (<span class="class">SELECT</span> <span class="predefined">AVG</span>(c.balanceOwed) <span class="keyword">FROM</span> Customer c)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2: Correlated subquery</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// create CriteriaQuery instance, with root Employee</span>
CriteriaQuery&lt;Employee&gt; q = cb.createQuery(Employee.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);

<span class="comment">// create Subquery instance, with root Employee</span>
Subquery&lt;Employee&gt; sq = q.subquery(Employee.class);
Root&lt;Employee&gt; spouseEmp = sq.from(Employee.class);

<span class="comment">// the subquery references the root of the containing query</span>
sq.where(cb.equal(spouseEmp, emp.get(Employee_.spouse)))
    .select(spouseEmp);

<span class="comment">// an exists condition is applied to the subquery result:</span>
q.where(cb.exists(sq));
q.select(emp).distinct(<span class="predefined-constant">true</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above query corresponds to the following
Jakarta Persistence query language query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="keyword">DISTINCT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (
    <span class="class">SELECT</span> spouseEmp
    <span class="keyword">FROM</span> Employee spouseEmp
    <span class="keyword">WHERE</span> spouseEmp = emp.spouse)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3: Subquery qualified by all()</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// create CriteriaQuery instance, with root Employee</span>
CriteriaQuery&lt;Employee&gt; q = cb.createQuery(Employee.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);

<span class="comment">// create Subquery instance, with root Manager</span>
Subquery&lt;<span class="predefined-type">BigDecimal</span>&gt; sq = q.subquery(<span class="predefined-type">BigDecimal</span>.class);
Root&lt;Manager&gt; manager = sq.from(Manager.class);

sq.select(manager.get(Manager_.salary));
sq.where(cb.equal(
    manager.get(Manager_.department),
    emp.get(Employee_.department)));

<span class="comment">// an all expression is applied to the subquery result</span>
q.select(emp)
    .where(cb.gt(emp.get(Employee_.salary), cb.all(sq)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> emp
<span class="keyword">FROM</span> Employee emp
<span class="keyword">WHERE</span> emp.salary &gt; <span class="keyword">ALL</span> (
    <span class="class">SELECT</span> m.salary
    <span class="keyword">FROM</span> Manager m
    <span class="keyword">WHERE</span> m.department = emp.department)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4: A Special case</strong></p>
</div>
<div class="paragraph">
<p>In order to express some correlated
subqueries involving unidirectional relationships, it may be useful to
correlate the domain of the subquery with the domain of the containing
query. This is performed by using the <em>correlate</em> method of the
<em>Subquery</em> interface.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; customer = q.from(Customer.class);
Subquery&lt;<span class="predefined-type">Long</span>&gt; sq = q.subquery(<span class="predefined-type">Long</span>.class);
Root&lt;Customer&gt; customerSub = sq.correlate(customer);
Join&lt;Customer,Order&gt; order = customerSub.join(Customer_.orders);

q.where(cb.gt(sq.select(cb.count(order)), <span class="integer">10</span>))
    .select(customer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> (<span class="class">SELECT</span> <span class="predefined">COUNT</span>(o) <span class="keyword">FROM</span> c.orders o) &gt; <span class="integer">10</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that joins involving the derived
subquery root do not affect the join conditions of the containing query.
The following two query definitions thus differ in semantics:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Order&gt; order = q.from(Order.class);
Subquery&lt;<span class="predefined-type">Integer</span>&gt; sq = q.subquery(<span class="predefined-type">Integer</span>.class);
Root&lt;Order&gt; orderSub = sq.correlate(order);
Join&lt;Order,Customer&gt; customer = orderSub.join(Order_.customer);
Join&lt;Customer,Account&gt; account = customer.join(Customer_.accounts);

sq.select(account.get(Account_.balance));
q.where(cb.lt(cb.literal(<span class="integer">10000</span>), cb.all(sq)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Order&gt; order = q.from(Order.class);
Join&lt;Order,Customer&gt; customer = order.join(Order_.customer);
Subquery&lt;<span class="predefined-type">Integer</span>&gt; sq = q.subquery(<span class="predefined-type">Integer</span>.class);
Join&lt;Order,Customer&gt; customerSub = sq.correlate(customer);
Join&lt;Customer,Account&gt; account = customerSub.join(Customer_.accounts);

sq.select(account.get(Account_.balance));
q.where(cb.lt(cb.literal(<span class="integer">10000</span>), cb.all(sq)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first of these queries will return orders
that are not associated with customers, whereas the second will not. The
corresponding Jakarta Persistence query language queries are the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o
<span class="keyword">WHERE</span> <span class="integer">10000</span> &lt; <span class="keyword">ALL</span> (
    <span class="class">SELECT</span> a.balance
    <span class="keyword">FROM</span> o.customer c <span class="keyword">JOIN</span> c.accounts a)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> <span class="keyword">Order</span> o <span class="keyword">JOIN</span> o.customer c
<span class="keyword">WHERE</span> <span class="integer">10000</span> &lt; <span class="keyword">ALL</span> (
    <span class="class">SELECT</span> a.balance
    <span class="keyword">FROM</span> c.accounts a)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="groupby-and-having"><a class="anchor" href="#groupby-and-having"></a>6.5.13. GroupBy and Having</h4>
<div class="paragraph">
<p>The <em>groupBy</em> method of the <em>CriteriaQuery</em>
interface is used to define a partitioning of the query results into
groups. The <em>having</em> method of the <em>CriteriaQuery</em> interface can be used
to filter over the groups.</p>
</div>
<div class="paragraph">
<p>The arguments to the <em>groupBy</em> method are
<em>Expression</em> instances.</p>
</div>
<div class="paragraph">
<p>When the <em>groupBy</em> method is used, each
selection item that is not the result of applying an aggregate method
must correspond to a path expression that is used for defining the
grouping. Requirements on the types that correspond to the elements of
the grouping and having constructs and their relationship to the select
items are as specified in <a href="#a5410">Section 4.7</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; customer = q.from(Customer.class);

q.groupBy(customer.get(Customer_.status));
q.having(cb.in(customer.get(Customer_.status)).value(<span class="integer">1</span>).value(<span class="integer">2</span>));
q.select(cb.tuple(
        customer.get(Customer_.status),
        cb.avg(customer.get(Customer_.filledOrderCount)),
        cb.count(customer)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.status, <span class="predefined">AVG</span>(c.filledOrderCount), <span class="predefined">COUNT</span>(c)
<span class="keyword">FROM</span> Customer c
<span class="keyword">GROUP</span> <span class="keyword">BY</span> c.status
<span class="keyword">HAVING</span> c.status <span class="keyword">IN</span> (<span class="integer">1</span>, <span class="integer">2</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ordering-the-query-results"><a class="anchor" href="#ordering-the-query-results"></a>6.5.14. Ordering the Query Results</h4>
<div class="paragraph">
<p>The ordering of the results of a query is
defined by use of the <em>orderBy</em> method of the <em>CriteriaQuery</em> instance.
The arguments to the <em>orderBy</em> method are <em>Order</em> instances.</p>
</div>
<div class="paragraph">
<p>An <em>Order</em> instance is created by means of
the <em>asc</em> and <em>desc</em> methods of the <em>CriteriaBuilder</em> interface. An
argument to either of these methods must be one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any <em>Expression</em> instance that corresponds to
an orderable state field of an entity or embeddable class abstract
schema type that is specified as an argument to the <em>select</em> or
<em>multiselect</em> method or that is an argument to a tuple or array
constructor that is passed as an argument to the <em>select</em> method.</p>
</li>
<li>
<p>Any <em>Expression</em> instance that corresponds to
the same state field of the same entity or embeddable abstract schema
type as an <em>Expression</em> instance that is specified as an argument to the
<em>select</em> or <em>multiselect</em> method or that is an argument to a tuple or
array constructor that is passed as an argument to the <em>select</em> method.</p>
</li>
<li>
<p>An <em>Expression</em> instance that is specified as
an argument to the <em>select</em> or <em>multiselect</em> method or that is an
argument to a tuple or array constructor that is passed as an argument
to the <em>select</em> method or that is semantically equivalent to such an
<em>Expression</em> instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If more than one <em>Order</em> instance is
specified, the order in which they appear in the argument list of the
<em>orderBy</em> method determines the precedence, whereby the first item has
highest precedence.</p>
</div>
<div class="paragraph">
<p>SQL rules for the ordering of null values
apply, as described in <a href="#a5587">Section 4.9</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Order&gt; q = cb.createQuery(Order.class);
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer,Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer,Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(a.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>));
q.select(o);
q.orderBy(cb.desc(o.get(Order_.quantity)),
    cb.asc(o.get(Order_.totalCost)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity <span class="directive">DESC</span>, o.totalcost</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer, Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(a.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>));
q.orderBy(cb.asc(o.get(Order_.quantity)),
    cb.asc(a.get(Address_.zipcode)));
q.multiselect(o.get(Order_.quantity),
    a.get(Address_.zipcode));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o.quantity, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity, a.zipcode</code></pre>
</div>
</div>
<div class="paragraph">
<p>It can be equivalently expressed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer, Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(a.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>));
q.orderBy(cb.asc(o.get(Order_.quantity)),
    cb.asc(a.get(Address_.zipcode)));
q.select(cb.tuple(o.get(Order_.quantity),
    a.get(Address_.zipcode)));</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Object</span><span class="type">[]</span>&gt; q = cb.createQuery(<span class="predefined-type">Object</span><span class="type">[]</span>.class);
Root&lt;Customer&gt; c = q.from(Customer.class);
Join&lt;Customer, Order&gt; o = c.join(Customer_.orders);
Join&lt;Customer, Address&gt; a = c.join(Customer_.address);

q.where(cb.equal(a.get(Address_.state), <span class="string"><span class="delimiter">&quot;</span><span class="content">CA</span><span class="delimiter">&quot;</span></span>),
    cb.equal(a.get(Address_.county), <span class="string"><span class="delimiter">&quot;</span><span class="content">Santa Clara</span><span class="delimiter">&quot;</span></span>));
q.select(cb.array(o.get(Order_.quantity),
    cb.prod(o.get(Order_.totalCost), <span class="float">1.08</span>),
    a.get(Address_.zipcode)));
q.orderBy(cb.asc(o.get(Order_.quantity)),
    cb.asc(cb.prod(o.get(Order_.totalCost), <span class="float">1.08</span>)),
    cb.asc(a.get(Address_.zipcode)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query corresponds to the following Jakarta
Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> o.quantity, o.totalCost * <span class="float">1.08</span> <span class="keyword">AS</span> taxedCost, a.zipcode
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> c.address a
<span class="keyword">WHERE</span> a.state = <span class="string"><span class="delimiter">'</span><span class="content">CA</span><span class="delimiter">'</span></span> <span class="keyword">AND</span> a.county = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> o.quantity, taxedCost, a.zipcode</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a11239"><a class="anchor" href="#a11239"></a>6.5.15. Bulk Update and Delete Operations</h4>
<div class="paragraph">
<p>A bulk update query is constructed through
the creation and modification of a
<em>jakarta.persistence.criteria.CriteriaUpdate</em> object.</p>
</div>
<div class="paragraph">
<p>A <em>CriteriaUpdate</em> object is created by means
of one of the <em>createCriteriaUpdate</em> methods of the <em>CriteriaBuilder</em>
interface. A <em>CriteriaUpdate</em> object is typed according to the entity
type that is the target of the update. A <em>CriteriaUpdate</em> object has a
single root, the entity that is being updated.</p>
</div>
<div class="paragraph">
<p>A bulk delete query is constructed through
the creation and modification of a
<em>jakarta.persistence.criteria.CriteriaDelete</em> object.</p>
</div>
<div class="paragraph">
<p>A <em>CriteriaDelete</em> object is created by means
of one of the <em>createCriteriaDelete</em> methods of the <em>CriteriaBuilder</em>
interface. A <em>CriteriaDelete</em> object is typed according to the entity
type that is the target of the delete. A <em>CriteriaDelete</em> object has a
single root, the entity that is being deleted.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaUpdate&lt;Customer&gt; q = cb.createCriteriaUpdate(Customer.class);
Root&lt;Customer&gt; c = q.from(Customer.class);

q.set(c.get(Customer_.status), <span class="string"><span class="delimiter">&quot;</span><span class="content">outstanding</span><span class="delimiter">&quot;</span></span>)
    .where(cb.lt(c.get(Customer_.balance), <span class="integer">10000</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
update statement is equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">UPDATE</span> Customer c
<span class="class">SET</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">outstanding</span><span class="delimiter">'</span></span>
<span class="keyword">WHERE</span> c.balance &lt; <span class="integer">10000</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaUpdate&lt;Employee&gt; q = cb.createCriteriaUpdate(Employee.class);
Root&lt;Employee&gt; e = q.from(Employee.class);

q.set(e.get(Employee_.address).get(Address_.building), <span class="integer">22</span>)
    .where(
        cb.equal(e.get(Employee_.address).get(Address_.building), <span class="integer">14</span>),
        cb.equal(e.get(Employee_.address).get(Address_.city), <span class="string"><span class="delimiter">&quot;</span><span class="content">Santa Clara</span><span class="delimiter">&quot;</span></span>),
        cb.equal(e.get(Employee_.project).get(Project_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Jakarta EE</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Address</em> is an embeddable class. Note that
updating across implicit joins is not supported.</p>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
update statement is equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.address.building = <span class="integer">22</span>
<span class="keyword">WHERE</span> e.address.building = <span class="integer">14</span>
    <span class="keyword">AND</span> e.address.city = <span class="string"><span class="delimiter">'</span><span class="content">Santa Clara</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> e.project.name = <span class="string"><span class="delimiter">'</span><span class="content">Jakarta EE</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>The following update query causes multiple
attributes to be updated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaUpdate&lt;Employee&gt; q = cb.createCriteriaUpdate(Employee.class);
Root&lt;Employee&gt; e = q.from(Employee.class);

q.set(e.get(Employee_.salary), cb.prod(e.get(Employee_.salary), <span class="float">1.1f</span>))
    .set(e.get(Employee_.commission), cb.prod(e.get(Employee_.commission), <span class="float">1.1f</span>))
    .set(e.get(Employee_.bonus), cb.sum(e.get(Employee_.bonus), <span class="integer">5000</span>))
    .where(cb.equal(e.get(Employee_.dept).get(Department_.name), <span class="string"><span class="delimiter">&quot;</span><span class="content">Sales</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
update statement is equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">UPDATE</span> Employee e
<span class="class">SET</span> e.salary = e.salary * <span class="float">1.1</span>,
    e.commission = e.commission * <span class="float">1.1</span>,
    e.bonus = e.bonus + <span class="integer">5000</span>
<span class="keyword">WHERE</span> e.dept.name = <span class="string"><span class="delimiter">'</span><span class="content">Sales</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaDelete&lt;Customer&gt; q = cb.createCriteriaDelete(Customer.class);
Root&lt;Customer&gt; c = q.from(Customer.class);

q.where(
    cb.equal(c.get(Customer_.status), <span class="string"><span class="delimiter">&quot;</span><span class="content">inactive</span><span class="delimiter">&quot;</span></span>),
    cb.isEmpty(c.get(Customer_.orders)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
delete statement is equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DELETE</span>
<span class="keyword">FROM</span> Customer c
<span class="keyword">WHERE</span> c.status = <span class="string"><span class="delimiter">'</span><span class="content">inactive</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> c.orders <span class="keyword">IS</span> EMPTY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Like bulk update and delete operations made
through the Jakarta Persistence query language, criteria API bulk update
and delete operations map directly to database operations, bypassing any
optimistic locking checks. Portable applications using bulk update
operations must manually update the value of the version column, if
desired, and/or manually validate the value of the version column.</p>
</div>
<div class="paragraph">
<p>The persistence context is not synchronized
with the result of the bulk update or delete. See <a href="#a5636">Section 4.10</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11305"><a class="anchor" href="#a11305"></a>6.6. Constructing Strongly-typed Queries using the jakarta.persistence.metamodel Interfaces</h3>
<div class="paragraph">
<p>Strongly-typed queries can also be
constructed, either statically or dynamically, in the absence of
generated metamodel classes. The <em>jakarta.persistence.metamodel</em>
interfaces are used to access the metamodel objects that correspond to
the managed classes.</p>
</div>
<div class="paragraph">
<p>The following examples illustrate this
approach. These are equivalent to the example queries shown in <a href="#a16277">Section 6.5.5</a>.</p>
</div>
<div class="paragraph">
<p>The <em>Metamodel</em> interface is obtained from
the EntityManager or EntityManagerFactory for the persistence unit, and
then used to obtain the corresponding metamodel objects for the managed
types referenced by the queries.</p>
</div>
<div class="paragraph">
<p>Example 1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">EntityManager em = ...;

Metamodel mm = em.getMetamodel();
EntityType&lt;Employee&gt; emp_ =mm.entity(Employee.class);
EmbeddableType&lt;ContactInfo&gt; cinfo_ = mm.embeddable(ContactInfo.class);
EntityType&lt;Phone&gt; phone_ = mm.entity(Phone.class);
EmbeddableType&lt;Address&gt; addr_ = mm.embeddable(Address.class);

CriteriaQuery&lt;Vendor&gt; q = cb.createQuery(Vendor.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
Join&lt;Employee, ContactInfo&gt; cinfo =
    emp.join(emp_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo</span><span class="delimiter">&quot;</span></span>, ContactInfo.class));
Join&lt;ContactInfo, Phone&gt; p =
    cinfo.join(cinfo_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>, Phone.class));
q.where(
    cb.equal(emp.get(emp_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo</span><span class="delimiter">&quot;</span></span>, ContactInfo.class))
        .get(cinfo_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, Address.class))
        .get(addr_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class)), <span class="string"><span class="delimiter">&quot;</span><span class="content">95054</span><span class="delimiter">&quot;</span></span>))
    .select(p.get(phone_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">vendor</span><span class="delimiter">&quot;</span></span>,Vendor.class)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 2:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">EntityManager em = ...;
Metamodel mm = em.getMetamodel();

EntityType&lt;Item&gt; item_ = mm.entity(Item.class);
CriteriaQuery&lt;Tuple&gt; q = cb.createTupleQuery();
Root&lt;Item&gt; item = q.from(Item.class);
MapJoin&lt;Item, <span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; photo =
    item.join(item_.getMap(<span class="string"><span class="delimiter">&quot;</span><span class="content">photos</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class, <span class="predefined-type">Object</span>.class));
q.multiselect(
    item.get(item_.getSingularAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class)), photo)
        .where(cb.like(photo.key(), <span class="string"><span class="delimiter">&quot;</span><span class="content">%egret%</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11349"><a class="anchor" href="#a11349"></a>6.7. Use of the Criteria API with Strings to Reference Attributes</h3>
<div class="paragraph">
<p>The Criteria API provides the option of
specifying the attribute references used in joins and navigation by
attribute names used as arguments to the various <em>join</em>, <em>fetch</em>, and
<em>get</em> methods.</p>
</div>
<div class="paragraph">
<p>The resulting queries have the same semantics
as described in <a href="#a10614">Section 6.5</a>, but do not provide the same level of type safety.</p>
</div>
<div class="paragraph">
<p>The examples in this section illustrate this
approach. These examples are derived from among those of sections
<a href="#a10643">Section 6.5.3</a> and <a href="#a16277">Section 6.5.5</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaBuilder cb = ...
CriteriaQuery&lt;<span class="predefined-type">String</span>&gt; q = cb.createQuery(<span class="predefined-type">String</span>.class);
Root&lt;Customer&gt; cust = q.from(Customer.class);
Join&lt;Order, Item&gt; item = cust.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>).join(<span class="string"><span class="delimiter">&quot;</span><span class="content">lineItems</span><span class="delimiter">&quot;</span></span>);
q.select(cust.&lt;<span class="predefined-type">String</span>&gt;get(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>))
    .where(cb.equal(item.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">product</span><span class="delimiter">&quot;</span></span>).get(<span class="string"><span class="delimiter">&quot;</span><span class="content">productType</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">printer</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c.name
<span class="keyword">FROM</span> Customer c <span class="keyword">JOIN</span> c.orders o <span class="keyword">JOIN</span> o.lineItems i
<span class="keyword">WHERE</span> i.product.productType = <span class="string"><span class="delimiter">'</span><span class="content">printer</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is not required that type parameters be
used. However, their omission may result in compiler warnings, as with
the below version of the same query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaBuilder cb = ...
CriteriaQuery q = cb.createQuery();
Root cust = q.from(Customer.class);
Join item = cust.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>).join(<span class="string"><span class="delimiter">&quot;</span><span class="content">lineItems</span><span class="delimiter">&quot;</span></span>);
q.select(cust.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)).where(
    cb.equal(item.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">product</span><span class="delimiter">&quot;</span></span>).get(<span class="string"><span class="delimiter">&quot;</span><span class="content">productType</span><span class="delimiter">&quot;</span></span>),<span class="string"><span class="delimiter">&quot;</span><span class="content">printer</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>The following query uses an outer join:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; cust = q.from(Customer.class);
Join&lt;Customer,Order&gt; order = cust.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>, JoinType.LEFT);
q.where(cb.equal(cust.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>), <span class="integer">1</span>))
    .select(cust);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> c <span class="keyword">FROM</span> Customer c <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> c.orders o
<span class="keyword">WHERE</span> c.status = <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>In the following example, <em>ContactInfo</em> is an
embeddable class consisting of an address and set of phones. <em>Phone</em> is
an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Vendor&gt; q = cb.createQuery(Vendor.class);
Root&lt;Employee&gt; emp = q.from(Employee.class);
Join&lt;ContactInfo, Phone&gt; phone = emp.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo</span><span class="delimiter">&quot;</span></span>).join(<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>);
q.where(cb.equal(emp.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo</span><span class="delimiter">&quot;</span></span>)
    .get(<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>)
    .get(<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">95054</span><span class="delimiter">&quot;</span></span>));
q.select(phone.&lt;Vendor&gt;get(<span class="string"><span class="delimiter">&quot;</span><span class="content">vendor</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Jakarta Persistence query language
query is equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> p.vendor
<span class="keyword">FROM</span> Employee e <span class="keyword">JOIN</span> e.contactInfo.phones p
<span class="keyword">WHERE</span> e.contactInfo.address.zipcode = <span class="string"><span class="delimiter">'</span><span class="content">95054</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="paragraph">
<p>In this example, the <em>photos</em> attribute
corresponds to a map from photo label to filename. The map key is a
string, the value an object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;<span class="predefined-type">Object</span>&gt; q = cb.createQuery();
Root&lt;Item&gt; item = q.from(Item.class);
MapJoin&lt;Item, <span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; photo = item.joinMap(<span class="string"><span class="delimiter">&quot;</span><span class="content">photos</span><span class="delimiter">&quot;</span></span>);
q.multiselect(item.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>), photo)
    .where(cb.like(photo.key(), <span class="string"><span class="delimiter">&quot;</span><span class="content">%egret%</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query is equivalent to the following
Jakarta Persistence query language query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> i.name, p
<span class="keyword">FROM</span> Item i <span class="keyword">JOIN</span> i.photos p
<span class="keyword">WHERE</span> <span class="type">KEY</span>(p) <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%egret%</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11413"><a class="anchor" href="#a11413"></a>6.8. Query Modification</h3>
<div class="paragraph">
<p>A <em>CriteriaQuery</em>, <em>CriteriaUpdate</em>, or
<em>CriteriaDelete</em> object may be modified, either before or after <em>Query</em>
or <em>TypedQuery</em> objects have been created and executed from it. For
example, such modification may entail replacement of the <em>where</em>
predicate or the <em>select</em> list. Modifications may thus result in the
same query object “base” being reused for several query instances.</p>
</div>
<div class="paragraph">
<p>For example, the user might create and
execute a query from the following <em>CriteriaQuery</em> object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CriteriaQuery&lt;Customer&gt; q = cb.createQuery(Customer.class);
Root&lt;Customer&gt; c = q.from(Customer.class);

<span class="predefined-type">Predicate</span> pred = cb.equal(c.get(Customer_.address).get(Address_.city),<span class="string"><span class="delimiter">&quot;</span><span class="content">Chicago</span><span class="delimiter">&quot;</span></span>);

q.select(c);
q.where(pred);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>CriteriaQuery</em> object might then be
modified to reflect a different predicate condition, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Predicate</span> pred2 = cb.gt(c.get(Customer_.balanceOwed), <span class="integer">1000</span>);
q.where(pred2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note, however, that query elements—-in this
example, predicate conditions—are dependent on the <em>CriteriaQuery</em>,
<em>CriteriaUpdate</em>, or <em>CriteriaDelete</em> instance, and are thus not
portably reusable with different instances.</p>
</div>
</div>
<div class="sect2">
<h3 id="a11427"><a class="anchor" href="#a11427"></a>6.9. Query Execution</h3>
<div class="paragraph">
<p>A criteria query is executed by passing the
<em>CriteriaQuery</em>, <em>CriteriaUpdate</em>, or <em>CriteriaDelete</em> object to the
<em>createQuery</em> method of the <em>EntityManager</em> interface to create an
executable <em>TypedQuery</em> object (or, in the case of <em>CriteriaUpdate</em> and
<em>CriteriaDelete</em>, a <em>Query</em> object), which can then be passed to one of
the query execution methods of the <em>TypedQuery</em> or <em>Query</em> interface.</p>
</div>
<div class="paragraph">
<p>A <em>CriteriaQuery</em>, <em>CriteriaUpdate</em>, or
<em>CriteriaDelete</em> object may be further modified after an executable
query object has been created from it. The modification of the
<em>CriteriaQuery</em>, <em>CriteriaUpdate</em>, or <em>CriteriaDelete</em> object does not
have any impact on the already created executable query object. If the
modified <em>CriteriaQuery</em>, <em>CriteriaUpdate</em>, or <em>CriteriaDelete</em> object
is passed to the <em>createQuery</em> method, the persistence provider must
insure that a new executable query object is created and returned that
reflects the semantics of the changed query definition.</p>
</div>
<div class="paragraph">
<p><em>CriteriaQuery</em>, <em>CriteriaUpdate</em>, and
<em>CriteriaDelete</em> objects must be serializable. A persistence vendor is
required to support the subsequent deserialization of such an object
into a separate JVM instance of that vendor&#8217;s runtime, where both
runtime instances have access to any required vendor implementation
classes. <em>CriteriaQuery</em>, <em>CriteriaUpdate</em>, and <em>CriteriaDelete</em>
objects are not required to be interoperable across vendors.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a11431"><a class="anchor" href="#a11431"></a>7. Entity Managers and Persistence Contexts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="a11432"><a class="anchor" href="#a11432"></a>7.1. Persistence Contexts</h3>
<div class="paragraph">
<p>A persistence context is a set of managed
entity instances in which for any persistent entity identity there is a
unique entity instance. Within the persistence context, the entity
instances and their lifecycle are managed by the entity manager.</p>
</div>
<div class="paragraph">
<p>In Jakarta EE environments, a JTA transaction
typically involves calls across multiple components. Such components may
often need to access the same persistence context within a single
transaction. To facilitate such use of entity managers in Jakarta EE
environments, when an entity manager is injected into a component or
looked up directly in the JNDI naming context, its persistence context
will automatically be propagated with the current JTA transaction, and
the EntityManager references that are mapped to the same persistence
unit will provide access to this same persistence context within the JTA
transaction. This propagation of persistence contexts by the Jakarta EE
container avoids the need for the application to pass references to
EntityManager instances from one component to another. An entity manager
for which the container manages the persistence context in this manner
is termed a <em>container-managed entity manager</em>. A container-managed
entity manager&#8217;s lifecycle is managed by the Jakarta EE container.</p>
</div>
<div class="paragraph">
<p>In less common use cases within Jakarta EE
environments, applications may need to access a persistence context that
is “stand-alone”—i.e. not propagated along with the JTA transaction
across the EntityManager references for the given persistence unit.
Instead, each instance of creating an entity manager causes a new
isolated persistence context to be created that is not accessible
through other EntityManager references within the same transaction.
These use cases are supported through the <em>createEntityManager</em> methods
of the <em>EntityManagerFactory</em> interface. An entity manager that is used
by the application to create and destroy a persistence context in this
manner is termed an <em>application-managed entity manager</em>. An
application-managed entity manager&#8217;s lifecycle is managed by the
application.</p>
</div>
<div class="paragraph">
<p>Both container-managed entity managers and
application-managed entity managers and their persistence contexts are
required to be supported in Jakarta EE web containers and EJB containers.
Within an EJB environment, container-managed entity managers are
typically used.</p>
</div>
<div class="paragraph">
<p>In Java SE environments and in Jakarta EE
application client containers, only application-managed entity managers
are required to be <sup class="footnote">[<a id="_footnoteref_79" class="footnote" href="#_footnotedef_79" title="View footnote.">79</a>]</sup>.</p>
</div>
</div>
<div class="sect2">
<h3 id="obtaining-an-entitymanager"><a class="anchor" href="#obtaining-an-entitymanager"></a>7.2. Obtaining an EntityManager</h3>
<div class="paragraph">
<p>The entity manager for a persistence context
is obtained from an entity manager factory.</p>
</div>
<div class="paragraph">
<p>When container-managed entity managers are
used (in Jakarta EE environments), the application does not interact with
the entity manager factory. The entity managers are obtained directly
through dependency injection or from JNDI, and the container manages
interaction with the entity manager factory transparently to the
application.</p>
</div>
<div class="paragraph">
<p>When application-managed entity managers are
used, the application must use the entity manager factory to manage the
entity manager and persistence context lifecycle.</p>
</div>
<div class="paragraph">
<p>An entity manager must not be shared among
multiple concurrently executing threads, as the entity manager and
persistence context are not required to be threadsafe. Entity managers
must only be accessed in a single-threaded manner.</p>
</div>
<div class="sect3">
<h4 id="obtaining-an-entity-manager-in-the-jakarta-ee-environment"><a class="anchor" href="#obtaining-an-entity-manager-in-the-jakarta-ee-environment"></a>7.2.1. Obtaining an Entity Manager in the Jakarta EE Environment</h4>
<div class="paragraph">
<p>A container-managed entity manager is
obtained by the application through dependency injection or through
direct lookup of the entity manager in the JNDI namespace. The container
manages the persistence context lifecycle and the creation and the
closing of the entity manager instance transparently to the application.</p>
</div>
<div class="paragraph">
<p>The <em>PersistenceContext</em> annotation is used
for entity manager injection. The <em>type</em> element specifies whether a
transaction-scoped or extended persistence context is to be used, as
described in <a href="#a11791">Section 7.6</a>. The <em>synchronization</em> element specifies whether
the persistence context is always automatically joined to the current
transaction (the default) or is not joined to the current transaction
unless the <em>joinTransaction</em> method is invoked by the application. The
<em>unitName</em> element may optionally be specified to designate the
persistence unit whose entity manager factory is used by the container.
The semantics of the persistence context synchronization type are
further described in <a href="#a11797&gt;. Section &lt;&lt;a13887">[a11797&gt;. Section &lt;&lt;a13887]</a> provides further
information about the <em>unitName</em> element.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PersistenceContext</span>
EntityManager em;

<span class="annotation">@PersistenceContext</span>(type=PersistenceContextType.EXTENDED)
EntityManager orderEM;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JNDI lookup of an entity manager is illustrated below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Stateless</span>
<span class="annotation">@PersistenceContext</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderEM</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MySessionBean</span> <span class="directive">implements</span> MyInterface {
    <span class="annotation">@Resource</span>
    SessionContext ctx;

    <span class="directive">public</span> <span class="type">void</span> doSomething() {
        EntityManager em = (EntityManager)ctx.lookup(<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderEM</span><span class="delimiter">&quot;</span></span>);

        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a11465"><a class="anchor" href="#a11465"></a>7.2.2. Obtaining an Application-managed Entity Manager</h4>
<div class="paragraph">
<p>An application-managed entity manager is
obtained by the application from an entity manager factory.</p>
</div>
<div class="paragraph">
<p>The <em>EntityManagerFactory</em> API used to obtain
an application-managed entity manager is the same independent of whether
this API is used in Jakarta EE or Java SE environments.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="obtaining-an-entity-manager-factory"><a class="anchor" href="#obtaining-an-entity-manager-factory"></a>7.3. Obtaining an Entity Manager Factory</h3>
<div class="paragraph">
<p>The <em>EntityManagerFactory</em> interface is used
by the application to create an application-managed entity
manager<sup class="footnote">[<a id="_footnoteref_80" class="footnote" href="#_footnotedef_80" title="View footnote.">80</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>Each entity manager factory provides entity
manager instances that are all configured in the same manner (e.g.,
configured to connect to the same database, use the same initial
settings as defined by the implementation, etc.)</p>
</div>
<div class="paragraph">
<p>More than one entity manager factory
instance may be available simultaneously in the
JVM.<sup class="footnote">[<a id="_footnoteref_81" class="footnote" href="#_footnotedef_81" title="View footnote.">81</a>]</sup></p>
</div>
<div class="paragraph">
<p>Methods of the <em>EntityManagerFactory</em> interface are threadsafe.</p>
</div>
<div class="sect3">
<h4 id="obtaining-an-entity-manager-factory-in-a-jakarta-ee-container"><a class="anchor" href="#obtaining-an-entity-manager-factory-in-a-jakarta-ee-container"></a>7.3.1. Obtaining an Entity Manager Factory in a Jakarta EE Container</h4>
<div class="paragraph">
<p>Within a Jakarta EE environment, an entity
manager factory can be injected using the <em>PersistenceUnit</em> annotation
or obtained through JNDI lookup. The <em>unitName</em> element may optionally
be specified to designate the persistence unit whose entity manager
factory is used. (See <a href="#a13887">Section 10.5.2</a>).</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PersistenceUnit</span>
EntityManagerFactory emf;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="obtaining-an-entity-manager-factory-in-a-java-se-environment"><a class="anchor" href="#obtaining-an-entity-manager-factory-in-a-java-se-environment"></a>7.3.2. Obtaining an Entity Manager Factory in a Java SE Environment</h4>
<div class="paragraph">
<p>Outside a Jakarta EE container environment, the
<em>jakarta.persistence.Persistence</em> class is the bootstrap class that
provides access to an entity manager factory. The application creates an
entity manager factory by calling the <em>createEntityManagerFactory</em>
method of the <em>jakarta.persistence.Persistence</em> class, described in
<a href="#a13443">Section 9.7</a>.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">EntityManagerFactory emf =
    jakarta.persistence.Persistence.createEntityManagerFactory(<span class="string"><span class="delimiter">&quot;</span><span class="content">Order</span><span class="delimiter">&quot;</span></span>);
EntityManager em = emf.createEntityManager();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="entitymanagerfactory-interface"><a class="anchor" href="#entitymanagerfactory-interface"></a>7.4. EntityManagerFactory Interface</h3>
<div class="paragraph">
<p>The <em>EntityManagerFactory</em> interface is used
by the application to obtain an application-managed entity manager. When
the application has finished using the entity manager factory, and/or at
application shutdown, the application should close the entity manager
factory. Once an entity manager factory has been closed, all its entity
managers are considered to be in the closed state.</p>
</div>
<div class="paragraph">
<p>The <em>EntityManagerFactory</em> interface provides
access to information and services that are global to the persistence
unit. This includes access to the second level cache that is maintained
by the persistence provider and to the <em>PersistenceUnitUtil</em> interface.
The <em>Cache</em> interface is described in <a href="#a12124">Section 7.10</a>; the
<em>PersistenceUnitUtil</em> interface in <a href="#a12177">Section 7.11</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.metamodel.Metamodel</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.criteria.CriteriaBuilder</span>;

<span class="comment">/**
 * Interface used to interact with the entity manager factory
 * for the persistence unit.
 *
 * &lt;p&gt;When the application has finished using the entity manager
 * factory, and/or at application shutdown, the application should
 * close the entity manager factory.  Once an
 * &lt;code&gt;EntityManagerFactory&lt;/code&gt; has been closed, all its entity managers
 * are considered to be in the closed state.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityManagerFactory</span> {

    <span class="comment">/**
     * Create a new application-managed &lt;code&gt;EntityManager&lt;/code&gt;.
     * This method returns a new &lt;code&gt;EntityManager&lt;/code&gt; instance each time
     * it is invoked.
     * The &lt;code&gt;isOpen&lt;/code&gt; method will return true on the returned instance.
     * @return entity manager instance
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     */</span>
    <span class="directive">public</span> EntityManager createEntityManager();

    <span class="comment">/**
     * Create a new application-managed &lt;code&gt;EntityManager&lt;/code&gt; with the
     * specified Map of properties.
     * This method returns a new &lt;code&gt;EntityManager&lt;/code&gt; instance each time
     * it is invoked.
     * The &lt;code&gt;isOpen&lt;/code&gt; method will return true on the returned instance.
     * @param map properties for entity manager
     * @return entity manager instance
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     */</span>
    <span class="directive">public</span> EntityManager createEntityManager(<span class="predefined-type">Map</span> map);

    <span class="comment">/**
     * Create a new JTA application-managed &lt;code&gt;EntityManager&lt;/code&gt; with the
     * specified synchronization type.
     * This method returns a new &lt;code&gt;EntityManager&lt;/code&gt; instance each time
     * it is invoked.
     * The &lt;code&gt;isOpen&lt;/code&gt; method will return true on the returned instance.
     * @param synchronizationType  how and when the entity manager should be
     * synchronized with the current JTA transaction
     * @return entity manager instance
     * @throws IllegalStateException if the entity manager factory
     * has been configured for resource-local entity managers or is closed
     *
     * @since 2.1
     */</span>
    <span class="directive">public</span> EntityManager createEntityManager(SynchronizationType synchronizationType);

    <span class="comment">/**
     * Create a new JTA application-managed &lt;code&gt;EntityManager&lt;/code&gt; with the
     * specified synchronization type and map of properties.
     * This method returns a new &lt;code&gt;EntityManager&lt;/code&gt; instance each time
     * it is invoked.
     * The &lt;code&gt;isOpen&lt;/code&gt; method will return true on the returned instance.
     * @param synchronizationType  how and when the entity manager should be
     * synchronized with the current JTA transaction
     * @param map properties for entity manager
     * @return entity manager instance
     * @throws IllegalStateException if the entity manager factory
     * has been configured for resource-local entity managers or is closed
     *
     * @since 2.1
     */</span>
    <span class="directive">public</span> EntityManager createEntityManager(SynchronizationType synchronizationType, <span class="predefined-type">Map</span> map);

    <span class="comment">/**
     * Return an instance of &lt;code&gt;CriteriaBuilder&lt;/code&gt; for the creation of
     * &lt;code&gt;CriteriaQuery&lt;/code&gt; objects.
     * @return CriteriaBuilder instance
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> CriteriaBuilder getCriteriaBuilder();

    <span class="comment">/**
     * Return an instance of &lt;code&gt;Metamodel&lt;/code&gt; interface for access to the
     * metamodel of the persistence unit.
     * @return Metamodel instance
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> Metamodel getMetamodel();

    <span class="comment">/**
     * Indicates whether the factory is open. Returns true
     * until the factory has been closed.
     * @return boolean indicating whether the factory is open
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isOpen();

    <span class="comment">/**
     * Close the factory, releasing any resources that it holds.
     * After a factory instance has been closed, all methods invoked
     * on it will throw the &lt;code&gt;IllegalStateException&lt;/code&gt;, except
     * for &lt;code&gt;isOpen&lt;/code&gt;, which will return false. Once an
     * &lt;code&gt;EntityManagerFactory&lt;/code&gt; has been closed, all its
     * entity managers are considered to be in the closed state.
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     */</span>
    <span class="directive">public</span> <span class="type">void</span> close();

    <span class="comment">/**
     * Get the properties and associated values that are in effect
     * for the entity manager factory. Changing the contents of the
     * map does not change the configuration in effect.
     * @return properties
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getProperties();

    <span class="comment">/**
     * Access the cache that is associated with the entity manager
     * factory (the &quot;second level cache&quot;).
     * @return instance of the &lt;code&gt;Cache&lt;/code&gt; interface or null if
     * no cache is in use
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> Cache getCache();

    <span class="comment">/**
     * Return interface providing access to utility methods
     * for the persistence unit.
     * @return &lt;code&gt;PersistenceUnitUtil&lt;/code&gt; interface
     * @throws IllegalStateException if the entity manager factory
     * has been closed
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> PersistenceUnitUtil getPersistenceUnitUtil();

    <span class="comment">/**
     * Define the query, typed query, or stored procedure query as
     * a named query such that future query objects can be created
     * from it using the &lt;code&gt;createNamedQuery&lt;/code&gt; or
     * &lt;code&gt;createNamedStoredProcedureQuery&lt;/code&gt; method.
     * &lt;p&gt;Any configuration of the query object (except for actual
     * parameter binding) in effect when the named query is added
     * is retained as part of the named query definition.
     * This includes configuration information such as max results,
     * hints, flush mode, lock mode, result set mapping information,
     * and information about stored procedure parameters.
     * &lt;p&gt;When the query is executed, information that can be set
     * by means of the query APIs can be overridden. Information
     * that is overridden does not affect the named query as
     * registered with the entity manager factory, and thus does
     * not affect subsequent query objects created from it by
     * means of the &lt;code&gt;createNamedQuery&lt;/code&gt; or
     * &lt;code&gt;createNamedStoredProcedureQuery&lt;/code&gt; method.
     * &lt;p&gt;If a named query of the same name has been previously
     * defined, either statically via metadata or via this method,
     * that query definition is replaced.
     *
     * @param name name for the query
     * @param query Query, TypedQuery, or StoredProcedureQuery object
     *
     * @since 2.1
     */</span>
    <span class="directive">public</span> <span class="type">void</span> addNamedQuery(<span class="predefined-type">String</span> name, <span class="predefined-type">Query</span> query);

    <span class="comment">/**
     * Return an object of the specified type to allow access to the
     * provider-specific API. If the provider's EntityManagerFactory
     * implementation does not support the specified class, the
     * PersistenceException is thrown.
     * @param cls the class of the object to be returned. This is
     * normally either the underlying EntityManagerFactory
     * implementation class or an interface that it implements.
     * @return an instance of the specified class
     * @throws PersistenceException if the provider does not
     * support the call
     * @since 2.1
     */</span>
    <span class="directive">public</span> &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; cls);

    <span class="comment">/**
     * Add a named copy of the EntityGraph to the
     * EntityManagerFactory.  If an entity graph with the same name
     * already exists, it is replaced.
     * @param graphName  name for the entity graph
     * @param entityGraph  entity graph
     * @since 2.1
     */</span>
    <span class="directive">public</span> &lt;T&gt; <span class="type">void</span> addNamedEntityGraph(<span class="predefined-type">String</span> graphName, EntityGraph&lt;T&gt; entityGraph);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any number of vendor-specific properties may
be included in the map passed to the <em>createEntityManager</em> methods.
Properties that are not recognized by a vendor must be ignored.</p>
</div>
<div class="paragraph">
<p>Note that the policies of the installation
environment may restrict some information from being made available
through the <em>EntityManagerFactory</em> <em>getProperties</em> method (for example,
JDBC user, password, URL).</p>
</div>
<div class="paragraph">
<p>Vendors should use vendor namespaces for
properties (e.g., <em>com.acme.persistence.logging</em>). Entries that make
use of the namespace <em>jakarta.persistence</em> and its subnamespaces must not
be used for vendor-specific information. The namespace
<em>jakarta.persistence</em> is reserved for use by this specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="controlling-transactions"><a class="anchor" href="#controlling-transactions"></a>7.5. Controlling Transactions</h3>
<div class="paragraph">
<p>Depending on the transactional type of the
entity manager, transactions involving EntityManager operations may be
controlled either through JTA or through use of the resource-local
<em>EntityTransaction</em> API, which is mapped to a resource transaction over
the resource that underlies the entities managed by the entity manager.</p>
</div>
<div class="paragraph">
<p>An entity manager whose underlying
transactions are controlled through JTA is termed a <em>JTA entity manager</em>.</p>
</div>
<div class="paragraph">
<p>An entity manager whose underlying
transactions are controlled by the application through the
<em>EntityTransaction</em> API is termed a <em>resource-local entity manager</em>.</p>
</div>
<div class="paragraph">
<p>A container-managed entity manager must be a
JTA entity manager. JTA entity managers are only specified for use in
Jakarta EE containers.</p>
</div>
<div class="paragraph">
<p>An application-managed entity manager may be
either a JTA entity manager or a resource-local entity manager.</p>
</div>
<div class="paragraph">
<p>An entity manager is defined to be of a given
transactional type—either JTA or resource-local—at the time its
underlying entity manager factory is configured and created. See
sections <a href="#a12296">Section 8.2.1.2</a> and <a href="#a12802">Section 9.1</a>.</p>
</div>
<div class="paragraph">
<p>Both JTA entity managers and resource-local
entity managers are required to be supported in Jakarta EE web containers
and EJB containers. Within an EJB environment, a JTA entity manager is
typically used. In general, in Java SE environments only resource-local
entity managers are supported.</p>
</div>
<div class="sect3">
<h4 id="jta-entitymanagers"><a class="anchor" href="#jta-entitymanagers"></a>7.5.1. JTA EntityManagers</h4>
<div class="paragraph">
<p>An entity manager whose transactions are
controlled through JTA is a JTA entity manager. In general, a JTA entity
manager participates in the current JTA transaction, which is begun and
committed external to the entity manager and propagated to the
underlying resource manager.</p>
</div>
</div>
<div class="sect3">
<h4 id="resource-local-entitymanagers"><a class="anchor" href="#resource-local-entitymanagers"></a>7.5.2. Resource-local EntityManagers</h4>
<div class="paragraph">
<p>An entity manager whose transactions are
controlled by the application through the <em>EntityTransaction</em> API is a
resource-local entity manager. A resource-local entity manager
transaction is mapped to a resource transaction over the resource by the
persistence provider. Resource-local entity managers may use server or
local resources to connect to the database and are unaware of the
presence of JTA transactions that may or may not be active.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-entitytransaction-interface"><a class="anchor" href="#the-entitytransaction-interface"></a>7.5.3. The EntityTransaction Interface</h4>
<div class="paragraph">
<p>The <em>EntityTransaction</em> interface is used to
control resource transactions on resource-local entity managers. The
<em>EntityManager.getTransaction()</em> method returns an instance of the
<em>EntityTransaction</em> interface.</p>
</div>
<div class="paragraph">
<p>When a resource-local entity manager is used,
and the persistence provider runtime throws an exception defined to
cause transaction rollback, the persistence provider must mark the
transaction for rollback.</p>
</div>
<div class="paragraph">
<p>If the <em>EntityTransaction.commit</em> operation
fails, the persistence provider must roll back the transaction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Interface used to control transactions on resource-local entity
 * managers.  The {@link EntityManager#getTransaction
 * EntityManager.getTransaction()} method returns the
 * &lt;code&gt;EntityTransaction&lt;/code&gt; interface.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">EntityTransaction</span> {

     <span class="comment">/**
      * Start a resource transaction.
      * @throws IllegalStateException if &lt;code&gt;isActive()&lt;/code&gt; is true
      */</span>
     <span class="directive">public</span> <span class="type">void</span> begin();

     <span class="comment">/**
      * Commit the current resource transaction, writing any
      * unflushed changes to the database.
      * @throws IllegalStateException if &lt;code&gt;isActive()&lt;/code&gt; is false
      * @throws RollbackException if the commit fails
      */</span>
     <span class="directive">public</span> <span class="type">void</span> commit();

     <span class="comment">/**
      * Roll back the current resource transaction.
      * @throws IllegalStateException if &lt;code&gt;isActive()&lt;/code&gt; is false
      * @throws PersistenceException if an unexpected error
      *         condition is encountered
      */</span>
     <span class="directive">public</span> <span class="type">void</span> rollback();

     <span class="comment">/**
      * Mark the current resource transaction so that the only
      * possible outcome of the transaction is for the transaction
      * to be rolled back.
      * @throws IllegalStateException if &lt;code&gt;isActive()&lt;/code&gt; is false
      */</span>
     <span class="directive">public</span> <span class="type">void</span> setRollbackOnly();

     <span class="comment">/**
      * Determine whether the current resource transaction has been
      * marked for rollback.
      * @return boolean indicating whether the transaction has been
      *         marked for rollback
      * @throws IllegalStateException if &lt;code&gt;isActive()&lt;/code&gt; is false
      */</span>
     <span class="directive">public</span> <span class="type">boolean</span> getRollbackOnly();

     <span class="comment">/**
      * Indicate whether a resource transaction is in progress.
      * @return boolean indicating whether transaction is
      *         in progress
      * @throws PersistenceException if an unexpected error
      *         condition is encountered
      */</span>
     <span class="directive">public</span> <span class="type">boolean</span> isActive();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="example-5"><a class="anchor" href="#example-5"></a>7.5.4. Example</h4>
<div class="paragraph">
<p>The following example illustrates the
creation of an entity manager factory in a Java SE environment, and its
use in creating and using a resource-local entity manager.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.persistence</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">PasswordChanger</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main (<span class="predefined-type">String</span><span class="type">[]</span> args) {
        EntityManagerFactory emf =
            Persistence.createEntityManagerFactory(<span class="string"><span class="delimiter">&quot;</span><span class="content">Order</span><span class="delimiter">&quot;</span></span>);
        EntityManager em = emf.createEntityManager();
        em.getTransaction().begin();

        User user = (User)em.createQuery
            (<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT u FROM User u WHERE u.name=:name AND u.pass=:pass</span><span class="delimiter">&quot;</span></span>)
            .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, args[<span class="integer">0</span>])
            .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>, args[<span class="integer">1</span>])
            .getSingleResult();

        <span class="keyword">if</span> (user!=<span class="predefined-constant">null</span>)
            user.setPassword(args[<span class="integer">2</span>]);

        em.getTransaction().commit();
        em.close();
        emf.close();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11791"><a class="anchor" href="#a11791"></a>7.6. Container-managed Persistence Contexts</h3>
<div class="paragraph">
<p>When a container-managed entity manager is
used, the lifecycle of the persistence context is always managed
automatically, transparently to the application, and the persistence
context is propagated with the JTA transaction.</p>
</div>
<div class="paragraph">
<p>A container-managed persistence context may
be defined to have either a lifetime that is scoped to a single
transaction or an extended lifetime that spans multiple transactions,
depending on the <em>PersistenceContextType</em> that is specified when its
entity manager is created. This specification refers to such persistence
contexts as <em>transaction-scoped persistence contexts</em> and <em>extended
persistence contexts</em> respectively.</p>
</div>
<div class="paragraph">
<p>The lifetime of the persistence context is
declared using the <em>PersistenceContext</em> annotation or the
<em>persistence-context-ref</em> deployment descriptor element. By default, a
transaction-scoped persistence context is used.</p>
</div>
<div class="paragraph">
<p>Sections <a href="#a11805">Section 7.6.2</a> and <a href="#a11810">Section 7.6.3</a> describe transaction-scoped and extended persistence contexts
in the absence of persistence context propagation. Persistence context
propagation is described in <a href="#a11816">Section 7.6.4</a>.</p>
</div>
<div class="paragraph">
<p>Persistence contexts are always associated
with an entity manager factory. In the following sections, “the
persistence context” should be understood to mean “the persistence
context associated with a particular entity manager factory”.</p>
</div>
<div class="sect3">
<h4 id="a11797"><a class="anchor" href="#a11797"></a>7.6.1. Persistence Context Synchronization Type</h4>
<div class="paragraph">
<p>By default, a container-managed persistence
context is of type <em>SynchronizationType.SYNCHRONIZED</em>. Such a
persistence context is automatically joined to the current JTA
transaction, and updates made to the persistence context are propagated
to the underlying resource manager.</p>
</div>
<div class="paragraph">
<p>A container-managed persistence context may
be specified to be of type <em>SynchronizationType.UNSYNCHRONIZED</em>. A
persistence context of type <em>SynchronizationType.UNSYNCHRONIZED</em> is not
enlisted in any JTA transaction unless explicitly joined to that
transaction by the application. A persistence context of type
<em>SynchronizationType.UNSYNCHRONIZED</em> is enlisted in a JTA transaction
and registered for subsequent transaction notifications against that
transaction by the invocation of the <em>EntityManager</em> <em>joinTransaction</em>
method. The persistence context remains joined to the transaction until
the transaction commits or rolls back. After the transaction commits or
rolls back, the persistence context will not be joined to any subsequent
transaction unless the <em>joinTransaction</em> method is invoked in the scope
of that subsequent transaction.</p>
</div>
<div class="paragraph">
<p>A persistence context of type
<em>SynchronizationType.UNSYNCHRONIZED</em> must not be flushed to the database
unless it is joined to a transaction. The application&#8217;s use of queries
with pessimistic locks, bulk update or delete queries, etc. result in
the provider throwing the <em>TransactionRequiredException</em>. After the
persistence context has been joined to the JTA transaction, these
operations are again allowed.</p>
</div>
<div class="paragraph">
<p>The application is permitted to invoke the
persist, merge, remove, and refresh entity lifecycle operations on an
entity manager of type <em>SynchronizationType.UNSYNCHRONIZED</em> independent
of whether the persistence context is joined to the current transaction.
After the persistence context has been joined to a transaction, changes
in a persistence context can be flushed to the database either
explicitly by the application or by the provider. If the <em>flush</em> method
is not explicitly invoked, the persistence provider may defer flushing
until commit time depending on the operations invoked and the flush mode
setting in effect.</p>
</div>
<div class="paragraph">
<p>If an extended persistence context of type
<em>SynchronizationType.UNSYNCHRONIZED</em> has not been joined to the current
JTA transaction, rollback of the JTA transaction will have no effect
upon the persistence context. In general, it is recommended that a
non-JTA datasource be specified for use by the persistence provider for
a persistence context of type <em>SynchronizationType.UNSYNCHRONIZED</em> that
has not been joined to a JTA transaction in order to alleviate the risk
of integrating uncommitted changes into the persistence context in the
event that the transaction is later rolled back.</p>
</div>
<div class="paragraph">
<p>If a persistence context of type
<em>SynchronizationType.UNSYNCHRONIZED</em> has been joined to the JTA
transaction, transaction rollback will cause the persistence context to
be cleared and all pre-existing managed and removed instances to become
detached. (See <a href="#a2049">Section 3.3.3</a>.)</p>
</div>
<div class="paragraph">
<p>When a JTA transaction exists, a persistence
context of type <em>SynchronizationType.UNSYNCHRONIZED</em> is propagated with
that transaction according to the rules in <a href="#a11820">Section 7.6.4.1</a> regardless of whether the persistence context has been
joined to that transaction.</p>
</div>
</div>
<div class="sect3">
<h4 id="a11805"><a class="anchor" href="#a11805"></a>7.6.2. Container-managed Transaction-scoped Persistence Context</h4>
<div class="paragraph">
<p>The application can obtain a
container-managed entity manager with transaction-scoped persistence
context by injection or direct lookup in the JNDI namespace. The
persistence context type for the entity manager is defaulted or defined
as <em>PersistenceContextType.TRANSACTION</em>.</p>
</div>
<div class="paragraph">
<p>A new persistence context begins when the
container-managed entity manager is invoked<sup class="footnote">[<a id="_footnoteref_82" class="footnote" href="#_footnotedef_82" title="View footnote.">82</a>]</sup> in
the scope of an active JTA transaction, and there is no current
persistence context already associated with the JTA transaction. The
persistence context is created and then associated with the JTA
transaction. This association of the persistence context with the JTA
transaction is independent of the synchronization type of the
persistence context and whether the persistence context has been joined
to the transaction.</p>
</div>
<div class="paragraph">
<p>The persistence context ends when the
associated JTA transaction commits or rolls back, and all entities that
were managed by the EntityManager become detached.<sup class="footnote">[<a id="_footnoteref_83" class="footnote" href="#_footnotedef_83" title="View footnote.">83</a>]</sup></p>
</div>
<div class="paragraph">
<p>If the entity manager is invoked outside the
scope of a transaction, any entities loaded from the database will
immediately become detached at the end of the method call.</p>
</div>
</div>
<div class="sect3">
<h4 id="a11810"><a class="anchor" href="#a11810"></a>7.6.3. Container-managed Extended Persistence Context</h4>
<div class="paragraph">
<p>A container-managed extended persistence
context can only be initiated within the scope of a stateful session
bean. It exists from the point at which the stateful session bean that
declares a dependency on an entity manager of type
<em>PersistenceContextType.EXTENDED</em> is created, and is said to be <em>bound</em>
to the stateful session bean. The dependency on the extended persistence
context is declared by means of the <em>PersistenceContext</em> annotation or
<em>persistence-context-ref</em> deployment descriptor element. The association
of the extended persistence context with the JTA transaction is
independent of the synchronization type of the persistence context and
whether the persistence context has been joined to the transaction.</p>
</div>
<div class="paragraph">
<p>The persistence context is closed by the
container when the <em>@Remove</em> method of the stateful session bean
completes (or the stateful session bean instance is otherwise
destroyed).</p>
</div>
<div class="sect4">
<h5 id="inheritance-of-extended-persistence-context"><a class="anchor" href="#inheritance-of-extended-persistence-context"></a>7.6.3.1. Inheritance of Extended Persistence Context</h5>
<div class="paragraph">
<p>If a stateful session bean instantiates a
stateful session bean (executing in the same EJB container instance)
which also has such an extended persistence context with the same
synchronization type, the extended persistence context of the first
stateful session bean is inherited by the second stateful session bean
and bound to it, and this rule recursively applies—independently of
whether transactions are active or not at the point of the creation of
the stateful session beans. If the stateful session beans differ in
declared synchronization type, the EJBException is thrown by the
container.</p>
</div>
<div class="paragraph">
<p>If the persistence context has been inherited
by any stateful session beans, the container does not close the
persistence context until all such stateful session beans have been
removed or otherwise destroyed.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a11816"><a class="anchor" href="#a11816"></a>7.6.4. Persistence Context Propagation</h4>
<div class="paragraph">
<p>As described in <a href="#a11432">Section 7.1</a>, a single
persistence context may correspond to one or more JTA entity manager
instances (all associated with the same entity manager
factory<sup class="footnote">[<a id="_footnoteref_84" class="footnote" href="#_footnotedef_84" title="View footnote.">84</a>]</sup>).</p>
</div>
<div class="paragraph">
<p>The persistence context is propagated across
the entity manager instances as the JTA transaction is propagated. A
persistence context of type <em>SynchronizationType.UNSYNCHRONIZED</em> is
propagated with the JTA transaction regardless of whether it has been
joined to the transaction.</p>
</div>
<div class="paragraph">
<p>Propagation of persistence contexts only
applies within a local environment. Persistence contexts are not
propagated to remote tiers.</p>
</div>
<div class="sect4">
<h5 id="a11820"><a class="anchor" href="#a11820"></a>7.6.4.1. Requirements for Persistence Context Propagation</h5>
<div class="paragraph">
<p>Persistence contexts are propagated by the
container across component invocations as follows.</p>
</div>
<div class="paragraph">
<p>If a component is called and there is no JTA
transaction or the JTA transaction is not propagated, the persistence
context is not propagated.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If an entity manager is then invoked from
within the component:</p>
<div class="ulist">
<ul>
<li>
<p>Invocation of an entity manager defined with
<em>PersistenceContextType.TRANSACTION</em> will result in use of a new
persistence context (as described in <a href="#a11805">Section 7.6.2</a>).</p>
</li>
<li>
<p>Invocation of an entity manager defined with
<em>PersistenceContextType.EXTENDED</em> will result in the use of the existing
extended persistence context bound to that component.</p>
</li>
<li>
<p>If the entity manager is invoked within a JTA
transaction, the persistence context will be associated with the JTA
transaction.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a component is called and the JTA
transaction is propagated into that component:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the component is a stateful session bean
to which an extended persistence context has been bound and there is a
different persistence context associated with the JTA transaction, an
<em>EJBException</em> is thrown by the container.</p>
</li>
<li>
<p>If there is a persistence context of type
<em>SynchronizationType.UNSYNCHRONIZED</em> associated with the JTA transaction
and the target component specifies a persistence context of type
<em>SynchronizationType.SYNCHRONIZED</em>, the <em>IllegalStateException</em> is
thrown by the container.</p>
</li>
<li>
<p>Otherwise, if there is a persistence context
associated with the JTA transaction, that persistence context is
propagated and used.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that a component with a persistence
context of type <em>SynchronizationType.UNSYNCHRONIZED</em> may be called by a
component propagating either a persistence context of type
<em>SynchronizationType.UNSYNCHRONIZED</em> or a persistence context of type
<em>SynchronizationType.SYNCHRONIZED</em> into it.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="examples-3"><a class="anchor" href="#examples-3"></a>7.6.5. Examples</h4>
<div class="sect4">
<h5 id="container-managed-transaction-scoped-persistence-context"><a class="anchor" href="#container-managed-transaction-scoped-persistence-context"></a>7.6.5.1. Container-managed Transaction-scoped Persistence Context</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceContext</span>
    EntityManager em;

    <span class="directive">public</span> Order getOrder(<span class="predefined-type">Long</span> id) {
        Order order = em.find(Order.class, id);
        order.getLineItems();
        <span class="keyword">return</span> order;
    }

    <span class="directive">public</span> Product getProduct(<span class="predefined-type">String</span> name) {
        <span class="keyword">return</span> (Product) em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = : name</span><span class="delimiter">&quot;</span></span>)
               .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
               .getSingleResult();
    }

    <span class="directive">public</span> LineItem createLineItem(Order order, Product product, <span class="type">int</span> quantity) {
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        <span class="keyword">return</span> li;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="container-managed-extended-persistence-context"><a class="anchor" href="#container-managed-extended-persistence-context"></a>7.6.5.2. Container-managed Extended Persistence Context</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/*
 * An extended transaction context is used. The entities remain
 * managed in the persistence context across multiple transactions.
 */</span>
<span class="annotation">@Stateful</span>
<span class="annotation">@Transaction</span>(REQUIRES_NEW)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceContext</span>(type = EXTENDED)
    EntityManager em;

    <span class="directive">private</span> Order order;
    <span class="directive">private</span> Product product;

    <span class="directive">public</span> <span class="type">void</span> initOrder(<span class="predefined-type">Long</span> id) {
        order = em.find(Order.class, id);
    }

    <span class="directive">public</span> <span class="type">void</span> initProduct(<span class="predefined-type">String</span> name) {
        product = (Product) em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = : name</span><span class="delimiter">&quot;</span></span>)
                  .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                  .getSingleResult();
    }

    <span class="directive">public</span> LineItem createLineItem(<span class="type">int</span> quantity) {
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        <span class="keyword">return</span> li;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a11894"><a class="anchor" href="#a11894"></a>7.7. Application-managed Persistence Contexts</h3>
<div class="paragraph">
<p>When an application-managed entity manager is
used, the application interacts directly with the persistence provider&#8217;s
entity manager factory to manage the entity manager lifecycle and to
obtain and destroy persistence contexts.</p>
</div>
<div class="paragraph">
<p>All such application-managed persistence
contexts are extended in scope, and can span multiple transactions.</p>
</div>
<div class="paragraph">
<p>The <em>EntityManagerFactory</em> .
<em>createEntityManager</em> method and the <em>EntityManager</em> <em>close</em> and
<em>isOpen</em> methods are used to manage the lifecycle of an
application-managed entity manager and its associated persistence
context.</p>
</div>
<div class="paragraph">
<p>The extended persistence context exists from
the point at which the entity manager has been created using
<em>EntityManagerFactory.createEntityManager</em> until the entity manager is
closed by means of <em>EntityManager.close</em>.</p>
</div>
<div class="paragraph">
<p>An extended persistence context obtained from
the application-managed entity manager is a stand-alone persistence
context—it is not propagated with the transaction.</p>
</div>
<div class="paragraph">
<p>When a JTA application-managed entity manager
is used, an application-managed persistence context may be specified to
be of type <em>SynchronizationType.UNSYNCHRONIZED</em>. A persistence context
of type <em>SynchronizationType.UNSYNCHRONIZED</em> is not enlisted in any JTA
transaction unless explicitly joined to that transaction by the
application. A persistence context of type
<em>SynchronizationType.UNSYNCHRONIZED</em> is enlisted in a JTA transaction
and registered for subsequent transaction notifications against that
transaction by the invocation of the <em>EntityManager</em> <em>joinTransaction</em>
method. The persistence context remains joined to the transaction until
the transaction commits or rolls back. After the transaction commits or
rolls back, the persistence context will not be joined to any subsequent
transaction unless the <em>joinTransaction</em> method is invoked in the scope
of that subsequent transaction.</p>
</div>
<div class="paragraph">
<p>When a JTA application-managed entity manager
is used, if the entity manager is created outside the scope of the
current JTA transaction, it is the responsibility of the application to
join the entity manager to the transaction (if desired) by calling
<em>EntityManager.joinTransaction</em>. If the entity manager is created
outside the scope of a JTA transaction, it is not joined to the
transaction unless <em>EntityManager.joinTransaction</em> is called.</p>
</div>
<div class="paragraph">
<p>The <em>EntityManager.close</em> method closes an
entity manager to release its persistence context and other resources.
After calling <em>close</em>, the application must not invoke any further
methods on the <em>EntityManager</em> instance except for <em>getTransaction</em> and
<em>isOpen</em>, or the <em>IllegalStateException</em> will be thrown. If the <em>close</em>
method is invoked when a transaction is active, the persistence context
remains managed until the transaction completes.</p>
</div>
<div class="paragraph">
<p>The <em>EntityManager.isOpen</em> method indicates
whether the entity manager is open. The <em>isOpen</em> method returns true
until the entity manager has been closed.</p>
</div>
<div class="sect3">
<h4 id="examples-4"><a class="anchor" href="#examples-4"></a>7.7.1. Examples</h4>
<div class="sect4">
<h5 id="application-managed-persistence-context-used-in-stateless-session-bean"><a class="anchor" href="#application-managed-persistence-context-used-in-stateless-session-bean"></a>7.7.1.1. Application-managed Persistence Context used in Stateless Session Bean</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/*
 * Container-managed transaction demarcation is used.
 * The session bean creates and closes an entity manager
 * in each business method.
 */</span>
<span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceUnit</span>
    <span class="directive">private</span> EntityManagerFactory emf;

    <span class="directive">public</span> Order getOrder(<span class="predefined-type">Long</span> id) {
        EntityManager em = emf.createEntityManager();
        Order order = em.find(Order.class, id);
        order.getLineItems();
        em.close();
        <span class="keyword">return</span> order;
    }

    <span class="directive">public</span> Product getProduct() {
        EntityManager em = emf.createEntityManager();
        Product product = (Product)
                          em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = :name</span><span class="delimiter">&quot;</span></span>)
                          .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                          .getSingleResult();
        em.close();
        <span class="keyword">return</span> product;
    }

    <span class="directive">public</span> LineItem createLineItem(Order order, Product product, <span class="type">int</span> quantity) {
        EntityManager em = emf.createEntityManager();
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        em.close();
        <span class="keyword">return</span> li; <span class="comment">// remains managed until JTA transaction ends</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="application-managed-persistence-context-used-in-stateless-session-bean-2"><a class="anchor" href="#application-managed-persistence-context-used-in-stateless-session-bean-2"></a>7.7.1.2. Application-managed Persistence Context used in Stateless Session Bean</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/*
 * Container-managed transaction demarcation is used.
 * The session bean creates entity manager in PostConstruct
 * method and clears persistence context at the end of each
 * business method.
 */</span>
<span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceUnit</span>
    <span class="directive">private</span> EntityManagerFactory emf;

    <span class="directive">private</span> EntityManager em;

    <span class="annotation">@PostConstruct</span>
    <span class="directive">public</span> <span class="type">void</span> init() {
        em = emf.createEntityManager();
    }

    <span class="directive">public</span> Order getOrder(<span class="predefined-type">Long</span> id) {
        Order order = em.find(Order.class, id);
        order.getLineItems();
        em.clear(); <span class="comment">// entities are detached</span>
        <span class="keyword">return</span> order;
    }

    <span class="directive">public</span> Product getProduct() {
        Product product = (Product)
                          em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = :name</span><span class="delimiter">&quot;</span></span>)
                          .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                          .getSingleResult();
        em.clear();
        <span class="keyword">return</span> product;
    }

    <span class="directive">public</span> LineItem createLineItem(Order order, Product product, <span class="type">int</span> quantity) {
        em.joinTransaction();
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        <span class="comment">// persistence context is flushed to database;</span>
        <span class="comment">// all updates will be committed to database on tx commit</span>
        em.flush();
        <span class="comment">// entities in persistence context are detached</span>
        em.clear();
        <span class="keyword">return</span> li;
    }

    <span class="annotation">@PreDestroy</span>
    <span class="directive">public</span> <span class="type">void</span> destroy() {
        em.close();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="application-managed-persistence-context-used-in-stateful-session-bean"><a class="anchor" href="#application-managed-persistence-context-used-in-stateful-session-bean"></a>7.7.1.3. Application-managed Persistence Context used in Stateful Session Bean</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/*
 * Container-managed transaction demarcation is used.
 * Entities remain managed until the entity manager is closed.
 */</span>
<span class="annotation">@Stateful</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingCartImpl</span> <span class="directive">implements</span> ShoppingCart {
    <span class="annotation">@PersistenceUnit</span>
    <span class="directive">private</span> EntityManagerFactory emf;

    <span class="directive">private</span> EntityManager em;

    <span class="directive">private</span> Order order;

    <span class="directive">private</span> Product product;

    <span class="annotation">@PostConstruct</span>
    <span class="directive">public</span> <span class="type">void</span> init() {
        em = emf.createEntityManager();
    }

    <span class="directive">public</span> <span class="type">void</span> initOrder(<span class="predefined-type">Long</span> id) {
        order = em.find(Order.class, id);
    }

    <span class="directive">public</span> <span class="type">void</span> initProduct(<span class="predefined-type">String</span> name) {
        product = (Product) em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = : name</span><span class="delimiter">&quot;</span></span>)
                  .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                  .getSingleResult();
    }

    <span class="directive">public</span> LineItem createLineItem(<span class="type">int</span> quantity) {
        em.joinTransaction();
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        <span class="keyword">return</span> li;
    }

    <span class="annotation">@Remove</span>
    <span class="directive">public</span> <span class="type">void</span> destroy() {
        em.close();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="application-managed-persistence-context-with-resource-transaction"><a class="anchor" href="#application-managed-persistence-context-with-resource-transaction"></a>7.7.1.4. Application-managed Persistence Context with Resource Transaction</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Usage in an ordinary Java class</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingImpl</span> {
    <span class="directive">private</span> EntityManager em;
    <span class="directive">private</span> EntityManagerFactory emf;

    <span class="directive">public</span> ShoppingCart() {
        emf = Persistence.createEntityManagerFactory(<span class="string"><span class="delimiter">&quot;</span><span class="content">orderMgt</span><span class="delimiter">&quot;</span></span>);
        em = emf.createEntityManager();
    }

    <span class="directive">private</span> Order order;
    <span class="directive">private</span> Product product;

    <span class="directive">public</span> <span class="type">void</span> initOrder(<span class="predefined-type">Long</span> id) {
        order = em.find(Order.class, id);
    }

    <span class="directive">public</span> <span class="type">void</span> initProduct(<span class="predefined-type">String</span> name) {
        product = (Product) em.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select p from Product p where p.name = : name</span><span class="delimiter">&quot;</span></span>)
                  .setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name)
                  .getSingleResult();
    }

    <span class="directive">public</span> LineItem createLineItem(<span class="type">int</span> quantity) {
        em.getTransaction().begin();
        LineItem li = <span class="keyword">new</span> LineItem(order, product, quantity);
        order.getLineItems().add(li);
        em.persist(li);
        em.getTransaction().commit();
        <span class="keyword">return</span> li;
    }

    <span class="directive">public</span> <span class="type">void</span> destroy() {
        em.close();
        emf.close();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="requirements-on-the-container"><a class="anchor" href="#requirements-on-the-container"></a>7.8. Requirements on the Container</h3>
<div class="sect3">
<h4 id="application-managed-persistence-contexts"><a class="anchor" href="#application-managed-persistence-contexts"></a>7.8.1. Application-managed Persistence Contexts</h4>
<div class="paragraph">
<p>When application-managed persistence contexts
are used, the container must instantiate the entity manager factory and
expose it to the application via JNDI. The container might use internal
APIs to create the entity manager factory, or it might use the
<em>PersistenceProvider.createContainerEntityManagerFactory</em> method.
However, the container is required to support third-party persistence
providers, and in this case the container must use the
<em>PersistenceProvider.createContainerEntityManagerFactory</em> method to
create the entity manager factory and the <em>EntityManagerFactory.close</em>
method to destroy the entity manager factory prior to shutdown (if it
has not been previously closed by the application).</p>
</div>
</div>
<div class="sect3">
<h4 id="container-managed-persistence-contexts"><a class="anchor" href="#container-managed-persistence-contexts"></a>7.8.2. Container Managed Persistence Contexts</h4>
<div class="paragraph">
<p>The container is responsible for managing the
lifecycle of container-managed persistence contexts, for injecting
<em>EntityManager</em> references into web components and session bean and
message-driven bean components, and for making <em>EntityManager</em>
references available to direct lookups in JNDI.</p>
</div>
<div class="paragraph">
<p>When operating with a third-party persistence
provider, the container uses the contracts defined in <a href="#a12100">Section 7.9</a>
to create and destroy container-managed
persistence contexts. It is undefined whether a new entity manager
instance is created for every persistence context, or whether entity
manager instances are sometimes reused. Exactly how the container
maintains the association between persistence context and JTA
transaction is not defined.</p>
</div>
<div class="paragraph">
<p>If a persistence context is already
associated with a JTA transaction, the container uses that persistence
context for subsequent invocations within the scope of that transaction,
according to the semantics for persistence context propagation defined
in <a href="#a11816">Section 7.6.4</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a12100"><a class="anchor" href="#a12100"></a>7.9. Runtime Contracts between the Container and Persistence Provider</h3>
<div class="paragraph">
<p>This section describes contracts
between the container and the persistence provider for the pluggability
of third-party persistence providers. Containers are required to support
these pluggability contracts.<sup class="footnote">[<a id="_footnoteref_85" class="footnote" href="#_footnotedef_85" title="View footnote.">85</a>]</sup></p>
</div>
<div class="sect3">
<h4 id="container-responsibilities"><a class="anchor" href="#container-responsibilities"></a>7.9.1. Container Responsibilities</h4>
<div class="paragraph">
<p>For the management of a transaction-scoped
persistence context, if there is no EntityManager already associated
with the JTA transaction:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The container creates a new entity manager by
calling <em>EntityManagerFactory.createEntityManager</em> when the first
invocation of an entity manager with
<em>PersistenceContextType.TRANSACTION</em> occurs within the scope of a
business method executing in the JTA transaction.</p>
</li>
<li>
<p>After the JTA transaction has completed
(either by transaction commit or rollback), the container closes the
entity manager by calling <em>EntityManager.close</em>.
<sup class="footnote">[<a id="_footnoteref_86" class="footnote" href="#_footnotedef_86" title="View footnote.">86</a>]</sup>
Note that the JTA transaction may rollback in a
background thread (e.g., as a result of transaction timeout), in which
case the container should arrange for the entity manager to be closed
but the <em>EntityManager.close</em> method should not be concurrently invoked
while the application is in an EntityManager invocation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The container must throw the
<em>TransactionRequiredException</em> if a transaction-scoped persistence
context is used and the <em>EntityManager</em> <em>persist</em>, <em>remove</em>, <em>merge</em>,
or <em>refresh</em> method is invoked when no transaction is active.</p>
</div>
<div class="paragraph">
<p>For stateful session beans with extended
persistence contexts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The container creates an entity manager by
calling <em>EntityManagerFactory.createEntityManager</em> when a stateful
session bean is created that declares a dependency on an entity manager
with <em>PersistenceContextType.EXTENDED</em>. (See <a href="#a11810">Section 7.6.3</a>).</p>
</li>
<li>
<p>The container closes the entity manager by
calling <em>EntityManager.close</em> after the stateful session bean and all
other stateful session beans that have inherited the same persistence
context as the entity manager have been removed.</p>
</li>
<li>
<p>When a business method of the stateful
session bean is invoked, if the stateful session bean uses container
managed transaction demarcation, and the entity manager is not already
associated with the current JTA transaction, the container associates
the entity manager with the current JTA transaction and, if the
persistence context is of type <em>SynchronizationType.SYNCHRONIZED</em>, the
container calls <em>EntityManager.joinTransaction</em>. If there is a
different persistence context already associated with the JTA
transaction, the container throws the <em>EJBException</em>.</p>
</li>
<li>
<p>When a business method of the stateful
session bean is invoked, if the stateful session bean uses bean managed
transaction demarcation and a UserTransaction is begun within the
method, the container associates the persistence context with the JTA
transaction and, if the persistence context is of type
<em>SynchronizationType.SYNCHRONIZED</em>, the container calls
<em>EntityManager.joinTransaction</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The container must throw the
<em>IllegalStateException</em> if the application calls <em>EntityManager.close</em>
on a container-managed entity manager.</p>
</div>
<div class="paragraph">
<p>When the container creates an entity manager,
it may pass a map of properties to the persistence provider by using the
<em>EntityManagerFactory.createEntityManager(Map map)</em> method. If
properties have been specified in the <em>PersistenceContext</em> annotation or
the <em>persistence-context-ref</em> deployment descriptor element, this method
must be used and the map must include the specified properties.</p>
</div>
<div class="paragraph">
<p>If the application invokes
<em>EntityManager.unwrap(Class&lt;T&gt; cls)</em>, and the container cannot satisfy
the request, the container must delegate the <em>unwrap</em> invocation to the
provider&#8217;s entity manager instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="provider-responsibilities"><a class="anchor" href="#provider-responsibilities"></a>7.9.2. Provider Responsibilities</h4>
<div class="paragraph">
<p>The Provider has no knowledge of the
distinction between transaction-scoped and extended persistence
contexts. It provides entity managers to the container when requested
and registers for transaction synchronization notifications.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When
<em>EntityManagerFactory.createEntityManager</em> is invoked, the provider must
create and return a new entity manager. If a JTA transaction is active
and the persistence context is of type
<em>SynchronizationType.SYNCHRONIZED</em>, the provider must register for
synchronization notifications against the JTA transaction.</p>
</li>
<li>
<p>When <em>EntityManager.joinTransaction</em> is
invoked, the provider must register for synchronization notifications
against the current JTA transaction if a previous <em>joinTransaction</em>
invocation for the transaction has not already been processed.</p>
</li>
<li>
<p>When the JTA transaction commits, if the
persistence context is of type <em>SynchronizationType.SYNCHRONIZED</em> or has
otherwise been joined to the transaction, the provider must flush all
modified entity state to the database.</p>
</li>
<li>
<p>When the JTA transaction rolls back, the
provider must detach all managed entities if the persistence context is
of type <em>SynchronizationType.SYNCHRONIZED</em> or has otherwise been joined
to the transaction. Note that the JTA transaction may rollback in a
background thread (e.g., as a result of transaction timeout), in which
case the provider should arrange for the managed entities to be detached
from the persistence context but not concurrently while the application
is in an EntityManager invocation.</p>
</li>
<li>
<p>When the provider throws an exception defined
to cause transaction rollback, the provider must mark the transaction
for rollback if the persistence context is of type
<em>SynchronizationType.SYNCHRONIZED</em> or has otherwise been joined to the
transaction.</p>
</li>
<li>
<p>When <em>EntityManager.close</em> is invoked, the
provider should release all resources that it may have allocated after
any outstanding transactions involving the entity manager have
completed. If the entity manager was already in a closed state, the
provider must throw the <em>IllegalStateException</em>.</p>
</li>
<li>
<p>When <em>EntityManager.clear</em> is invoked, the
provider must detach all managed entities.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a12124"><a class="anchor" href="#a12124"></a>7.10. Cache Interface</h3>
<div class="paragraph">
<p>The <em>Cache</em> interface provides basic
functionality over the persistence provider&#8217;s second level cache, if
used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Interface used to interact with the second-level cache.
 * If a cache is not in use, the methods of this interface have
 * no effect, except for &lt;code&gt;contains&lt;/code&gt;, which returns false.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Cache</span> {

    <span class="comment">/**
     * Whether the cache contains data for the given entity.
     * @param cls  entity class
     * @param primaryKey  primary key
     * @return boolean indicating whether the entity is in the cache
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> contains(<span class="predefined-type">Class</span> cls, <span class="predefined-type">Object</span> primaryKey);

    <span class="comment">/**
     * Remove the data for the given entity from the cache.
     * @param cls  entity class
     * @param primaryKey  primary key
     */</span>
    <span class="directive">public</span> <span class="type">void</span> evict(<span class="predefined-type">Class</span> cls, <span class="predefined-type">Object</span> primaryKey);

    <span class="comment">/**
     * Remove the data for entities of the specified class (and its
     * subclasses) from the cache.
     * @param cls  entity class
     */</span>
    <span class="directive">public</span> <span class="type">void</span> evict(<span class="predefined-type">Class</span> cls);

    <span class="comment">/**
     * Clear the cache.
     */</span>
    <span class="directive">public</span> <span class="type">void</span> evictAll();

    <span class="comment">/**
     * Return an object of the specified type to allow access to the
     * provider-specific API.  If the provider's Cache
     * implementation does not support the specified class, the
     * PersistenceException is thrown.
     * @param cls  the class of the object to be returned.  This is
     * normally either the underlying Cache implementation
     * class or an interface that it implements.
     * @return an instance of the specified class
     * @throws PersistenceException if the provider does not
     * support the call
     * @since 2.1
     */</span>
    <span class="directive">public</span> &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; cls);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a12177"><a class="anchor" href="#a12177"></a>7.11. PersistenceUnitUtil Interface</h3>
<div class="paragraph">
<p>The <em>PersistenceUnitUtil</em> interface provides
access to utility methods that can be invoked on entities associated
with the persistence unit. The behavior is undefined if these methods
are invoked on an entity instance that is not associated with the
persistence unit from whose entity manager factory this interface has
been obtained.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Utility interface between the application and the persistence
 * provider managing the persistence unit.
 *
 * &lt;p&gt;The methods of this interface should only be invoked on entity
 * instances obtained from or managed by entity managers for this
 * persistence unit or on new entity instances.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceUnitUtil</span> <span class="directive">extends</span> PersistenceUtil {

    <span class="comment">/**
     * Determine the load state of a given persistent attribute
     * of an entity belonging to the persistence unit.
     * @param entity  entity instance containing the attribute
     * @param attributeName name of attribute whose load state is
     *        to be determined
     * @return false if entity's state has not been loaded or if
     *         the attribute state has not been loaded, else true
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Determine the load state of an entity belonging to the
     * persistence unit.  This method can be used to determine the
     * load state of an entity passed as a reference.  An entity is
     * considered loaded if all attributes for which
     * &lt;code&gt;FetchType.EAGER&lt;/code&gt; has been specified have been
     * loaded.
     * &lt;p&gt; The &lt;code&gt;isLoaded(Object, String)&lt;/code&gt; method
     * should be used to determine the load state of an attribute.
     * Not doing so might lead to unintended loading of state.
     * @param entity   entity instance whose load state is to be determined
     * @return false if the entity has not been loaded, else true
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity);

    <span class="comment">/**
     *  Return the id of the entity.
     *  A generated id is not guaranteed to be available until after
     *  the database insert has occurred.
     *  Returns null if the entity does not yet have an id.
     *  @param entity  entity instance
     *  @return id of the entity
     *  @throws IllegalArgumentException if the object is found not
     *          to be an entity
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> getIdentifier(<span class="predefined-type">Object</span> entity);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a12229"><a class="anchor" href="#a12229"></a>8. Entity Packaging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the packaging of
persistence units.</p>
</div>
<div class="sect2">
<h3 id="persistence-unit"><a class="anchor" href="#persistence-unit"></a>8.1. Persistence Unit</h3>
<div class="paragraph">
<p>A persistence unit is a logical grouping that
includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An entity manager factory and its entity
managers, together with their configuration information.</p>
</li>
<li>
<p>The set of managed classes included in the
persistence unit and managed by the entity managers of the entity
manager factory.</p>
</li>
<li>
<p>Mapping metadata (in the form of metadata
annotations and/or XML metadata) that specifies the mapping of the
classes to the database.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="a12236"><a class="anchor" href="#a12236"></a>8.2. Persistence Unit Packaging</h3>
<div class="paragraph">
<p>Within Jakarta EE environments, an EJB-JAR, WAR,
EAR, or application client JAR can define a persistence unit. Any number
of persistence units may be defined within these scopes.</p>
</div>
<div class="paragraph">
<p>A persistence unit may be packaged within one
or more jar files contained within a WAR or EAR, as a set of classes
within an EJB-JAR file or in the WAR <em>classes</em> directory, or as a
combination of these as defined below.</p>
</div>
<div class="paragraph">
<p>A persistence unit is defined by a
<em>persistence.xml</em> file. The jar file or directory whose <em>META-INF</em>
directory contains the <em>persistence.xml</em> file is termed the <em>root</em> of
the persistence unit. In Jakarta EE environments, the root of a persistence
unit must be one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an EJB-JAR file</p>
</li>
<li>
<p>the <em>WEB-INF/classes</em> directory of a WAR file<sup class="footnote">[<a id="_footnoteref_87" class="footnote" href="#_footnotedef_87" title="View footnote.">87</a>]</sup></p>
</li>
<li>
<p>a jar file in the <em>WEB-INF/lib</em> directory of</p>
</li>
<li>
<p>a WAR file</p>
</li>
<li>
<p>a jar file in the EAR library directory</p>
</li>
<li>
<p>an application client jar file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is not required that an EJB-JAR or WAR
file containing a persistence unit be packaged in an EAR unless the
persistence unit contains persistence classes in addition to those
contained within the EJB-JAR or WAR. See <a href="#a12305">Section 8.2.1.6</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Java Persistence 1.0 supported use of a
jar file in the root of the EAR as the root of a persistence unit. This
use is no longer supported. Portable applications should use the EAR
library directory for this case instead. See
<a href="#a19499">[6]</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A persistence unit must have a name. Only one
persistence unit of any given name must be defined within a single
EJB-JAR file, within a single WAR file, within a single application
client jar, or within an EAR. See <a href="#a12459">Section 8.2.2</a>.</p>
</div>
<div class="paragraph">
<p>The <em>persistence.xml</em> file may be used to
designate more than one persistence unit within the same scope.</p>
</div>
<div class="paragraph">
<p>All persistence classes defined at the level
of the Jakarta EE EAR must be accessible to other Jakarta EE components in the
application—i.e. loaded by the application classloader—such that if the
same entity class is referenced by two different Jakarta EE components
(which may be using different persistence units), the referenced class
is the same identical class.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, the metadata mapping
files, jar files, and classes described in the following sections can be
used. To insure the portability of a Java SE application, it is
necessary to explicitly list the managed persistence classes that are
included in the persistence unit using the <em>class</em> element of the
<em>persistence.xml</em> file. See <a href="#a12305">Section 8.2.1.6</a>.</p>
</div>
<div class="sect3">
<h4 id="persistence-xml-file"><a class="anchor" href="#persistence-xml-file"></a>8.2.1. persistence.xml file</h4>
<div class="paragraph">
<p>A <em>persistence.xml</em> file defines a
persistence unit. The <em>persistence.xml</em> file is located in the
<em>META-INF</em> directory of the root of the persistence unit. It may be used
to specify managed persistence classes included in the persistence unit,
object/relational mapping information for those classes, scripts for use
in schema generation and the bulk loading of data, and other
configuration information for the persistence unit and for the entity
manager(s) and entity manager factory for the persistence unit. This
information may be defined by containment or by reference, as described
below.</p>
</div>
<div class="paragraph">
<p>The object/relational mapping information can
take the form of annotations on the managed persistence classes included
in the persistence unit, an <em>orm.xml</em> file contained in the <em>META-INF</em>
directory of the root of the persistence unit, one or more XML files on
the classpath and referenced from the <em>persistence.xml</em> file, or a
combination of these.</p>
</div>
<div class="paragraph">
<p>The managed persistence classes may either be
contained within the root of the persistence unit; or they may be
specified by reference—i.e., by naming the classes, class archives, or
XML mapping files (which in turn reference classes) that are accessible
on the application classpath; or they may be specified by some
combination of these means. See <a href="#a12305">Section 8.2.1.6</a>.</p>
</div>
<div class="paragraph">
<p>The root element of the <em>persistence.xml</em>
file is the <em>persistence</em> element. The <em>persistence</em> element consists of
one or more <em>persistence-unit</em> elements.</p>
</div>
<div class="paragraph">
<p>The <em>persistence-unit</em> element consists of
the <em>name</em> and <em>transaction-type</em> attributes and the following
sub-elements: <em>description</em>, <em>provider</em>, <em>jta-data-source</em>,
<em>non-jta-data-source</em>, <em>mapping-file</em>, <em>jar-file</em>, <em>class</em>,
<em>exclude-unlisted-classes</em>, <em>shared-cache-mode</em>, <em>validation-mode</em>,
and <em>properties</em>.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> attribute is required; the other
attributes and elements are optional. Their semantics are described in
the following subsections.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence&gt;</span>
    <span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;description&gt;</span>
            This unit manages orders and customers.
            It does not rely on any vendor-specific features and can
            therefore be deployed to any persistence provider.
        <span class="tag">&lt;/description&gt;</span>
        <span class="tag">&lt;jta-data-source&gt;</span>jdbc/MyOrderDB<span class="tag">&lt;/jta-data-source&gt;</span>
        <span class="tag">&lt;mapping-file&gt;</span>ormap.xml<span class="tag">&lt;/mapping-file&gt;</span>
        <span class="tag">&lt;jar-file&gt;</span>MyOrderApp.jar<span class="tag">&lt;/jar-file&gt;</span>
        <span class="tag">&lt;class&gt;</span>com.widgets.Order<span class="tag">&lt;/class&gt;</span>
        <span class="tag">&lt;class&gt;</span>com.widgets.Customer<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;/persistence-unit&gt;</span>
<span class="tag">&lt;/persistence&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence&gt;</span>
    <span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;description&gt;</span>
            This unit manages inventory for auto parts.
            It depends on features provided by the
            com.acme.persistence implementation.
        <span class="tag">&lt;/description&gt;</span>
        <span class="tag">&lt;provider&gt;</span>com.acme.AcmePersistence<span class="tag">&lt;/provider&gt;</span>
        <span class="tag">&lt;jta-data-source&gt;</span>jdbc/MyPartDB<span class="tag">&lt;/jta-data-source&gt;</span>
        <span class="tag">&lt;mapping-file&gt;</span>ormap2.xml<span class="tag">&lt;/mapping-file&gt;</span>
        <span class="tag">&lt;jar-file&gt;</span>MyPartsApp.jar<span class="tag">&lt;/jar-file&gt;</span>
        <span class="tag">&lt;properties&gt;</span>
            <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.acme.persistence.sql-logging</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">on</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/properties&gt;</span>
    <span class="tag">&lt;/persistence-unit&gt;</span>
<span class="tag">&lt;/persistence&gt;</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="name"><a class="anchor" href="#name"></a>8.2.1.1. name</h5>
<div class="paragraph">
<p>The <em>name</em> attribute defines the name for the
persistence unit. This name may be used to identify a persistence unit
referred to by the <em>PersistenceContext</em> and <em>PersistenceUnit</em>
annotations and in the programmatic API for creating an entity manager
factory.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12296"><a class="anchor" href="#a12296"></a>8.2.1.2. transaction-type</h5>
<div class="paragraph">
<p>The <em>transaction-type</em> attribute is used to
specify whether the entity managers provided by the entity manager
factory for the persistence unit must be JTA entity managers or
resource-local entity managers. The value of this element is <em>JTA</em> or
<em>RESOURCE_LOCAL</em>. A <em>transaction-type</em> of <em>JTA</em> assumes that a JTA data
source will be provided—either as specified by the <em>jta-data-source</em>
element or provided by the container. In general, in Jakarta EE
environments, a <em>transaction-type</em> of <em>RESOURCE_LOCAL</em> assumes that a
non-JTA datasource will be provided. In a Jakarta EE environment, if this
element is not specified, the default is <em>JTA</em>. In a Java SE
environment, if this element is not specified, the default is
<em>RESOURCE_LOCAL</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="description"><a class="anchor" href="#description"></a>8.2.1.3. description</h5>
<div class="paragraph">
<p>The <em>description</em> element provides optional
descriptive information about the persistence unit.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12300"><a class="anchor" href="#a12300"></a>8.2.1.4. provider</h5>
<div class="paragraph">
<p>The <em>provider</em> element specifies the name of
the persistence provider&#8217;s <em>jakarta.persistence.spi.PersistenceProvider</em>
class. The <em>provider</em> element is optional, but should be specified if
the application is dependent upon a particular persistence provider
being used.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12302"><a class="anchor" href="#a12302"></a>8.2.1.5. jta-data-source, non-jta-data-source</h5>
<div class="paragraph">
<p>In Jakarta EE environments, the
<em>jta-data-source</em> and <em>non-jta-data-source</em> elements are used to specify
the JNDI name of the JTA and/or non-JTA data source to be used by the
persistence provider. If neither is specified, the deployer must specify
a JTA data source at deployment or the default JTA data source must be
provided by the container, and a JTA EntityManagerFactory will be
created to correspond to it.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, these elements may
be used or the data source information may be specified by other
means—depending upon the requirements of the provider.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12305"><a class="anchor" href="#a12305"></a>8.2.1.6. mapping-file, jar-file, class, exclude-unlisted-classes</h5>
<div class="paragraph">
<p>The following classes must be implicitly or
explicitly denoted as managed persistence classes to be included within
a persistence unit: entity classes; embeddable classes; mapped
superclasses; converter classes.</p>
</div>
<div class="paragraph">
<p>The set of managed persistence classes
that are managed by a persistence unit is defined by using one or more
of the following:<sup class="footnote">[<a id="_footnoteref_88" class="footnote" href="#_footnotedef_88" title="View footnote.">88</a>]</sup></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Annotated managed persistence classes
contained in the root of the persistence unit (unless the
<em>exclude-unlisted-classes</em> element is specified)</p>
</li>
<li>
<p>One or more object/relational mapping XML
files</p>
</li>
<li>
<p>One or more jar files that will be searched
for classes</p>
</li>
<li>
<p>An explicit list of classes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The set of entities managed by the
persistence unit is the union of these sources, with the mapping
metadata annotations (or annotation defaults) for any given class being
overridden by the XML mapping information file if there are both
annotations as well as XML mappings for that class. The minimum portable
level of overriding is at the level of the persistent field or property.</p>
</div>
<div class="paragraph">
<p>The classes and/or jars that are named as
part of a persistence unit must be on the classpath; referencing them
from the <em>persistence.xml</em> file does not cause them to be placed on the
classpath.</p>
</div>
<div class="paragraph">
<p>All classes must be on the classpath to
ensure that entity managers from different persistence units that map
the same class will be accessing the same identical class.</p>
</div>
<div class="sect5">
<h6 id="annotated-classes-in-the-root-of-the-persistence-unit"><a class="anchor" href="#annotated-classes-in-the-root-of-the-persistence-unit"></a>Annotated Classes in the Root of the Persistence Unit</h6>
<div class="paragraph">
<p>All classes contained in the root of the
persistence unit are searched for annotated managed persistence
classes—classes with the <em>Entity</em>, <em>Embeddable</em>, <em>MappedSuperclass</em>,
or <em>Converter</em> annotation—and any mapping metadata annotations found on
these classes will be processed, or they will be mapped using the
mapping annotation defaults. If it is not intended that the annotated
persistence classes contained in the root of the persistence unit be
included in the persistence unit, the <em>exclude-unlisted-classes</em> element
must be specified as <em>true</em>. The <em>exclude-unlisted-classes</em> element is
not intended for use in Java SE environments.</p>
</div>
</div>
<div class="sect5">
<h6 id="objectrelational-mapping-files"><a class="anchor" href="#objectrelational-mapping-files"></a>Object/relational Mapping Files</h6>
<div class="paragraph">
<p>An object/relational mapping XML file
contains mapping information for the classes listed in it.</p>
</div>
<div class="paragraph">
<p>An object/relational mapping XML file named
<em>orm.xml</em> may be specified in the <em>META-INF</em> directory in the root of
the persistence unit or in the <em>META-INF</em> directory of any jar file
referenced by the <em>persistence.xml</em>. Alternatively, or in addition, one
or more mapping files may be referenced by the <em>mapping-file</em> elements
of the <em>persistence-unit</em> element. These mapping files may be present
anywhere on the class path.</p>
</div>
<div class="paragraph">
<p>An <em>orm.xml</em> mapping file or other mapping
file is loaded as a resource by the persistence provider. If a mapping
file is specified, the classes and mapping information specified in the
mapping file will be used as described in <a href="#a16944">Chapter 12</a>. If multiple mapping files are specified (possibly including
one or more <em>orm.xml</em> files), the resulting mappings are obtained by
combining the mappings from all of the files. The result is undefined if
multiple mapping files (including any <em>orm.xml</em> file) referenced within
a single persistence unit contain overlapping mapping information for
any given class. The object/relational mapping information contained in
any mapping file referenced within the persistence unit must be disjoint
at the class-level from object/relational mapping information contained
in any other such mapping file.</p>
</div>
</div>
<div class="sect5">
<h6 id="jar-files"><a class="anchor" href="#jar-files"></a>Jar Files</h6>
<div class="paragraph">
<p>One or more JAR files may be specified
using the <em>jar-file</em> elements instead of, or in addition to the mapping
files specified in the <em>mapping-file</em> elements. If specified, these JAR
files will be searched for managed persistence classes, and any mapping
metadata annotations found on them will be processed, or they will be
mapped using the mapping annotation defaults defined by this
specification. Such JAR files are specified relative to the directory or
jar file that <em>contains</em> the root of the
persistence unit.<sup class="footnote">[<a id="_footnoteref_89" class="footnote" href="#_footnotedef_89" title="View footnote.">89</a>]</sup></p>
</div>
<div class="paragraph">
<p>The following examples illustrate the use of
the <em>jar-file</em> element to reference additional persistence classes.
These examples use the convention that a jar file with a name
terminating in “ <em>PUnit</em> ” contains the <em>persistence.xml</em> file and that
a jar file with a name terminating in “ <em>Entities</em> ” contains additional
persistence classes.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    earRootPUnit.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><em>persistence.xml</em> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>lib/earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    lib/earLibPUnit.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><em>persistence.xml</em> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    ejbjar.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><em>persistence.xml</em> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>lib/earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    war1.war
        WEB-INF/lib/warEntities.jar
        WEB-INF/lib/warPUnit.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><em>persistence.xml</em> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>warEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    war2.war
        WEB-INF/lib/warEntities.jar
        WEB-INF/classes/META-INF/persistence.xml</pre>
</div>
</div>
<div class="paragraph">
<p><em>persistence.xml</em> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>lib/warEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    war2.war
        WEB-INF/classes/META-INF/persistence.xml</pre>
</div>
</div>
<div class="paragraph">
<p><em>persistence.xml</em> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>../../lib/earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 7:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.ear
    lib/earEntities.jar
    war1.war
        WEB-INF/lib/warPUnit.jar (with META-INF/persistence.xml)</pre>
</div>
</div>
<div class="paragraph">
<p><em>persistence.xml</em> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jar-file&gt;</span>../../../lib/earEntities.jar<span class="tag">&lt;/jar-file&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="list-of-managed-classes"><a class="anchor" href="#list-of-managed-classes"></a>List of Managed Classes</h6>
<div class="paragraph">
<p>A list of named managed persistence
classes—entity classes, embeddable classes, mapped superclasses, and
converter classes—may be specified instead of, or in addition to, the
JAR files and mapping files. Any mapping metadata annotations found on
these classes will be processed, or they will be mapped using the
mapping annotation defaults. The <em>class</em> element is used to list a
managed persistence class.</p>
</div>
<div class="paragraph">
<p>A list of all named managed persistence
classes must be specified in Java SE environments to insure portability.
Portable Java SE applications should not rely on the other mechanisms
described here to specify the managed persistence classes of a
persistence unit. Persistence providers may require that the set of
entity classes and classes that are to be managed must be fully
enumerated in each of the <em>persistence.xml</em> files in Java SE
environments.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="a12380"><a class="anchor" href="#a12380"></a>8.2.1.7. shared-cache-mode</h5>
<div class="paragraph">
<p>The <em>shared-cache-mode</em> element determines
whether second-level caching is in effect for the persistence unit. See
<a href="#a3065">Section 3.9.1</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12382"><a class="anchor" href="#a12382"></a>8.2.1.8. validation-mode</h5>
<div class="paragraph">
<p>The <em>validation-mode</em> element determines
whether automatic lifecycle event time validation is in effect. See
<a href="#a2374">Section 3.6.1.1</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="a12384"><a class="anchor" href="#a12384"></a>8.2.1.9. properties</h5>
<div class="paragraph">
<p>The <em>properties</em> element is used to specify
both standard and vendor-specific properties and hints that apply to the
persistence unit and its entity manager factory configuration.</p>
</div>
<div class="paragraph">
<p>The following properties and hints defined by
this specification are intended for use in both Jakarta EE and Java SE
environments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.lock.timeout</em> — value in
milliseconds for pessimistic lock timeout. This is a hint only.</p>
</li>
<li>
<p><em>jakarta.persistence.query.timeout</em> — value in
milliseconds for query timeout. This is a hint only.</p>
</li>
<li>
<p><em>jakarta.persistence.validation.group.pre-persist</em> — groups that are
targeted for validation upon the pre-persist event (overrides the
default behavior).</p>
</li>
<li>
<p><em>jakarta.persistence.validation.group.pre-update</em> — groups that are
targeted for validation upon the pre-update event (overrides the default
behavior).</p>
</li>
<li>
<p><em>jakarta.persistence.validation.group.pre-remove</em> — groups that are
targeted for validation upon the pre-remove event (overrides the default
behavior).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following properties defined by this
specification are intended for use in Java SE environments.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.jdbc.driver</em> — fully
qualified name of the driver class</p>
</li>
<li>
<p><em>jakarta.persistence.jdbc.url</em> — driver-specific URL</p>
</li>
<li>
<p><em>jakarta.persistence.jdbc.user</em> — username
used by database connection</p>
</li>
<li>
<p><em>jakarta.persistence.jdbc.password</em> — password
for database connection validation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Scripts for use in schema generation may be
specified using the
<em>jakarta.persistence.schema-generation.create-script-source</em> and
<em>jakarta.persistence.schema-generation.drop-script-source</em> properties. A
script to specify SQL for the bulk loading of data may be specified by
the <em>jakarta.persistence.sql-load-script-source</em> property. These
properties are intended for use in both Jakarta EE and Java SE
environments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.schema-generation.create-script-source</em> — <em>name of a
script packaged as part of the persistence application or a string
corresponding to a file URL string that designates a script.</em></p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.drop-script-source</em> — <em>name of a
script packaged as part of the persistence application or a string
corresponding to a file URL string that designates a script.</em></p>
</li>
<li>
<p><em>jakarta.persistence.sql-load-script-source</em> —
<em>name of a script packaged as part of the persistence unit or a string
corresponding to a file URL string that designates a script.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When scripts are packaged as part of the
persistence application, these properties must specify locations
relative to the root of the persistence unit. When scripts are provided
externally (or when schema generation is to occur into script files, as
described below), strings corresponding to file URLs must be specified.
In Jakarta EE environments, such file URL specifications must be absolute
paths (not relative). In Jakarta EE environments, all source and target
file locations must be accessible to the application server deploying
the persistence unit.</p>
</div>
<div class="paragraph">
<p>In general, it is expected that schema
generation will be initiated by means of the APIs described in
<a href="#a12917">Section 9.4</a>. However, schema
generation actions may also be specified by means of the following
properties used in the <em>persistence.xml</em> file.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.schema-generation.database.action</em><br>
The <em>jakarta.persistence.schema-generation.database.action</em> property specifies
the action to be taken by the persistence provider with regard to the
database artifacts. The values for this property are <em>none</em>, <em>create</em>,
<em>drop-and-create</em>, <em>drop</em>. If this property is not specified, it is
assumed that schema generation is not needed or will be initiated by
other means, and, by default, no schema generation actions will be taken
on the database. (See <a href="#a12917">Section 9.4</a>.)</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.scripts.action</em><br>
The <em>jakarta.persistence.schema-generation.scripts.action</em> property specifies
which scripts are to be generated by the persistence provider. The
values for this property are <em>none</em>, <em>create</em>, <em>drop-and-create</em>,
<em>drop</em>. A script will only be generated if the script target is
specified. If this property is not specified, it is assumed that script
generation is not needed or will be initiated by other means, and, by
default, no scripts will be generated. (See <a href="#a12917">Section 9.4</a>.)</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.create-source</em><br>
The <em>jakarta.persistence.schema-generation.create-source</em> property specifies
whether the creation of database artifacts is to occur on the basis of
the object/relational mapping metadata, DDL script, or a combination of
the two. The values for this property are <em>metadata</em>, <em>script</em>,
<em>metadata-then-script</em>, <em>script-then-metadata</em>. If this property is
not specified, and a script is specified by the
<em>jakarta.persistence.schema-generation.create-script-source</em> property, the
script (only) will be used for schema generation; otherwise if this
property is not specified, schema generation will occur on the basis of
the object/relational mapping metadata (only). The
<em>metadata-then-script</em> and <em>script-then-metadata</em> values specify that a
combination of metadata and script is to be used and the order in which
this use is to occur. If either of these values is specified and the
resulting database actions are not disjoint, the results are undefined
and schema generation may fail.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.drop-source</em><br>
The <em>jakarta.persistence.schema-generation.drop-source</em> property specifies
whether the dropping of database artifacts is to occur on the basis of
the object/relational mapping metadata, DDL script, or a combination of
the two. The values for this property are <em>metadata</em>, <em>script</em>,
<em>metadata-then-script</em>, <em>script-then-metadata</em>. If this property is
not specified, and a script is specified by the
<em>jakarta.persistence.schema-generation.drop-script-source</em> property, the
script (only) will be used for the dropping of database artifacts;
otherwise if this property is not specified, the dropping of database
artifacts will occur on the basis of the object/relational mapping
metadata (only). The <em>metadata-then-script</em> and <em>script-then-metadata</em>
values specify that a combination of metadata and script is to be used
and the order in which this use is to occur. If either of these values
is specified and the resulting database actions are not disjoint, the
results are undefined and the dropping of database artifacts may fail.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.scripts.create-target</em>,<br>
<em>jakarta.persistence.schema-generation.scripts.drop-target</em><br>
If scripts are to be generated, the target
locations for the writing of these scripts must be specified. These
targets are specified as strings corresponding to file URLs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a persistence provider does not recognize
a property (other than a property defined by this specification), the
provider must ignore it.</p>
</div>
<div class="paragraph">
<p>Vendors should use vendor namespaces for
properties (e.g., <em>com.acme.persistence.logging</em>). Entries that make
use of the namespace <em>jakarta.persistence</em> and its subnamespaces must not
be used for vendor-specific information. The namespace
<em>jakarta.persistence</em> is reserved for use by this specification.</p>
</div>
</div>
<div class="sect4">
<h5 id="examples-5"><a class="anchor" href="#examples-5"></a>8.2.1.10. Examples</h5>
<div class="paragraph">
<p>The following are sample contents of a <em>persistence.xml</em> file.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <em>OrderManagement</em> is created.</p>
</div>
<div class="paragraph">
<p>Any annotated managed persistence classes
found in the root of the persistence unit are added to the list of
managed persistence classes. If a <em>META-INF/orm.xml</em> file exists, any
classes referenced by it and mapping information contained in it are
used as specified above. Because no provider is specified, the
persistence unit is assumed to be portable across providers. Because the
transaction type is not specified, JTA is assumed for Jakarta EE
environments. The container must provide the data source (it may be
specified at application deployment, for example). In Java SE
environments, the data source may be specified by other means and a
transaction type of <em>RESOURCE_LOCAL</em> is assumed.</p>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;mapping-file&gt;</span>mappings.xml<span class="tag">&lt;/mapping-file&gt;</span>
<span class="tag">&lt;/persistence-unit&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <em>OrderManagement2</em>
is created. Any annotated managed persistence classes found in the root
of the persistence unit are added to the list of managed persistence
classes. The <em>mappings.xml</em> resource exists on the classpath and any
classes and mapping information contained in it are used as specified
above. If a <em>META-INF/orm.xml</em> file exists, any classes and mapping
information contained in it are used as well. The transaction type, data
source, and provider are as described above.</p>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;jar-file&gt;</span>order.jar<span class="tag">&lt;/jar-file&gt;</span>
    <span class="tag">&lt;jar-file&gt;</span>order-supplemental.jar<span class="tag">&lt;/jar-file&gt;</span>
<span class="tag">&lt;/persistence-unit&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <em>OrderManagement3</em>
is created. Any annotated managed persistence classes found in the root
of the persistence unit are added to the list of managed persistence
classes. If a <em>META-INF/orm.xml</em> file exists, any classes and mapping
information contained in it are used as specified above. The <em>order.jar</em>
and <em>order-supplemental.jar</em> files are searched for managed persistence
classes and any annotated managed persistence classes found in them
and/or any classes specified in the <em>orm.xml</em> files of these jar files
are added. The transaction-type, data source and provider are as
described above.</p>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement4</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">transaction-type</span>=<span class="attribute-value">RESOURCE_LOCAL</span><span class="tag">&gt;</span>
    <span class="tag">&lt;non-jta-data-source&gt;</span>java:app/jdbc/MyDB<span class="tag">&lt;/non-jta-data-source&gt;</span>
    <span class="tag">&lt;mapping-file&gt;</span>order-mappings.xml<span class="tag">&lt;/mapping-file&gt;</span>
    <span class="tag">&lt;class&gt;</span>com.acme.Order<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;class&gt;</span>com.acme.Customer<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;class&gt;</span>com.acme.Item<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;exclude-unlisted-classes</span><span class="tag">/&gt;</span>
<span class="tag">&lt;/persistence-unit&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <em>OrderManagement4</em>
is created. The file <em>order-mappings.xml</em> is read as a resource and any
classes referenced by it and mapping information contained in it are
used<sup class="footnote">[<a id="_footnoteref_90" class="footnote" href="#_footnotedef_90" title="View footnote.">90</a>]</sup>.
The annotated <em>Order</em>, <em>Customer</em> and
<em>Item</em> classes are loaded and are added. No (other) classes contained in
the root of the persistence unit are added to the list of managed
persistence classes. The persistence unit assumed to be portable across
providers. A entity manager factory supplying resource-local entity
managers will be created. The data source <em>java:app/jdbc/MyDB</em> must be
used.</p>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OrderManagement5</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;provider&gt;</span>com.acme.AcmePersistence<span class="tag">&lt;/provider&gt;</span>
    <span class="tag">&lt;mapping-file&gt;</span>order1.xml<span class="tag">&lt;/mapping-file&gt;</span>
    <span class="tag">&lt;mapping-file&gt;</span>order2.xml<span class="tag">&lt;/mapping-file&gt;</span>
    <span class="tag">&lt;jar-file&gt;</span>order.jar<span class="tag">&lt;/jar-file&gt;</span>
    <span class="tag">&lt;jar-file&gt;</span>order-supplemental.jar<span class="tag">&lt;/jar-file&gt;</span>
<span class="tag">&lt;/persistence-unit&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A persistence unit named <em>OrderManagement5</em>
is created. Any annotated managed persistence classes found in the root
of the persistence unit are added to the list of managed classes. The
<em>order1.xml</em> and <em>order2.xml</em> files are read as resources and any
classes referenced by them and mapping information contained in them are
also used as specified above. The <em>order.jar</em> is a jar file on the
classpath containing another persistence unit, while
<em>order-supplemental.jar</em> is just a library of classes. Both of these jar
files are searched for annotated managed persistence classes and any
annotated managed persistence classes found in them and any classes
specified in the <em>orm.xml</em> files (if any) of these jar files are added.
The provider <em>com.acme.AcmePersistence</em> must be used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the <em>persistence.xml</em> file
contained in <em>order.jar</em> is not used to augment the persistence unit
<em>OrderManagement5</em> with the classes of the persistence unit whose root
is <em>order.jar</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a12459"><a class="anchor" href="#a12459"></a>8.2.2. Persistence Unit Scope</h4>
<div class="paragraph">
<p>An EJB-JAR, WAR, application client jar, or
EAR can define a persistence unit.</p>
</div>
<div class="paragraph">
<p>When referencing a persistence unit using the
<em>unitName</em> annotation element or <em>persistence-unit-name</em> deployment
descriptor element, the visibility scope of the persistence unit is
determined by its point of definition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A persistence unit that is defined at the
level of an EJB-JAR, WAR, or application client jar is scoped to that
EJB-JAR, WAR, or application jar respectively and is visible to the
components defined in that jar or war.</p>
</li>
<li>
<p>A persistence unit that is defined at the
level of the EAR is generally visible to all components in the
application. However, if a persistence unit of the same name is defined
by an EJB-JAR, WAR, or application jar file within the EAR, the
persistence unit of that name defined at EAR level will not be visible
to the components defined by that EJB-JAR, WAR, or application jar file
unless the persistence unit reference uses the persistence unit name #
syntax to specify a path name to disambiguate the reference. When the #
syntax is used, the path name is relative to the referencing application
component jar file. For example, the syntax
<em>../lib/persistenceUnitRoot.jar#myPersistenceUnit</em> refers to a
persistence unit whose name, as specified in the name element of the
<em>persistence.xml</em> file, is <em>myPersistenceUnit</em> and for which the
relative path name of the root of the persistence unit is
<em>../lib/persistenceUnitRoot.jar</em>. The # syntax may be used with both
the <em>unitName</em> annotation element or <em>persistence-unit-name</em> deployment
descriptor element to reference a persistence unit defined at EAR level.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="persistence-xml-schema"><a class="anchor" href="#persistence-xml-schema"></a>8.3. persistence.xml Schema</h3>
<div class="paragraph">
<p>This section provides the XML schema for the
<em>persistence.xml</em> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="comment">&lt;!-- persistence.xml schema --&gt;</span>
<span class="tag">&lt;xsd:schema</span> <span class="attribute-name">targetNamespace</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/persistence</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:xsd</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:persistence</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/persistence</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">elementFormDefault</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">qualified</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">attributeFormDefault</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unqualified</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

   <span class="tag">&lt;xsd:annotation&gt;</span>
     <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

     This is the XML Schema for the persistence configuration file.
     The file must be named &quot;META-INF/persistence.xml&quot; in the
     persistence archive.

     Persistence configuration files must indicate
     the persistence schema by using the persistence namespace:

     https://jakarta.ee/xml/ns/persistence

     and indicate the version of the schema by
     using the version element as shown below:

      &lt;persistence xmlns=&quot;https://jakarta.ee/xml/ns/persistence&quot;
        xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
        xsi:schemaLocation=&quot;https://jakarta.ee/xml/ns/persistence
          https://jakarta.ee/xml/ns/persistence/persistence_3_0.xsd&quot;
        version=&quot;3.0&quot;&gt;
          ...
      &lt;/persistence&gt;

    <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
  <span class="tag">&lt;/xsd:annotation&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">versionType</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:pattern</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">[0-9]+(\.[0-9]+)*</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:complexType&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>

        <span class="comment">&lt;!-- **************************************************** --&gt;</span>

        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;xsd:complexType&gt;</span>
            <span class="tag">&lt;xsd:annotation&gt;</span>
              <span class="tag">&lt;xsd:documentation&gt;</span>

                Configuration of a persistence unit.

              <span class="tag">&lt;/xsd:documentation&gt;</span>
            <span class="tag">&lt;/xsd:annotation&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>

            <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Description of this persistence unit.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">provider</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Provider class that supplies EntityManagers for this
                    persistence unit.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jta-data-source</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    The container-specific name of the JTA datasource to use.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">non-jta-data-source</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    The container-specific name of a non-JTA datasource to use.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapping-file</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    File containing mapping information. Loaded as a resource
                    by the persistence provider.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jar-file</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Jar file that is to be scanned for managed classes.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Managed class to be included in the persistence unit and
                    to scan for annotations.  It should be annotated
                    with either @Entity, @Embeddable or @MappedSuperclass.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-unlisted-classes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">default</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    When set to true then only listed classes and jars will
                    be scanned for persistent classes, otherwise the
                    enclosing jar or directory will also be scanned.
                    Not applicable to Java SE persistence units.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">shared-cache-mode</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence:persistence-unit-caching-type</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    Defines whether caching is enabled for the
                    persistence unit if caching is supported by the
                    persistence provider. When set to ALL, all entities
                    will be cached. When set to NONE, no entities will
                    be cached. When set to ENABLE_SELECTIVE, only entities
                    specified as cacheable will be cached. When set to
                    DISABLE_SELECTIVE, entities specified as not cacheable
                    will not be cached. When not specified or when set to
                    UNSPECIFIED, provider defaults may apply.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">validation-mode</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence:persistence-unit-validation-mode-type</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    The validation mode to be used for the persistence unit.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>


              <span class="comment">&lt;!-- **************************************************** --&gt;</span>

              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">properties</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xsd:annotation&gt;</span>
                  <span class="tag">&lt;xsd:documentation&gt;</span>

                    A list of standard and vendor-specific properties
                    and hints.

                  <span class="tag">&lt;/xsd:documentation&gt;</span>
                <span class="tag">&lt;/xsd:annotation&gt;</span>
                <span class="tag">&lt;xsd:complexType&gt;</span>
                  <span class="tag">&lt;xsd:sequence&gt;</span>
                    <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">property</span><span class="delimiter">&quot;</span></span>
                                 <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                      <span class="tag">&lt;xsd:annotation&gt;</span>
                        <span class="tag">&lt;xsd:documentation&gt;</span>
                          A name-value pair.
                        <span class="tag">&lt;/xsd:documentation&gt;</span>
                      <span class="tag">&lt;/xsd:annotation&gt;</span>
                      <span class="tag">&lt;xsd:complexType&gt;</span>
                        <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                                       <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                        <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                                       <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                      <span class="tag">&lt;/xsd:complexType&gt;</span>
                    <span class="tag">&lt;/xsd:element&gt;</span>
                  <span class="tag">&lt;/xsd:sequence&gt;</span>
                <span class="tag">&lt;/xsd:complexType&gt;</span>
              <span class="tag">&lt;/xsd:element&gt;</span>

            <span class="tag">&lt;/xsd:sequence&gt;</span>

            <span class="comment">&lt;!-- **************************************************** --&gt;</span>

            <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
              <span class="tag">&lt;xsd:annotation&gt;</span>
                <span class="tag">&lt;xsd:documentation&gt;</span>

                  Name used in code to reference this persistence unit.

                <span class="tag">&lt;/xsd:documentation&gt;</span>
              <span class="tag">&lt;/xsd:annotation&gt;</span>
            <span class="tag">&lt;/xsd:attribute&gt;</span>

            <span class="comment">&lt;!-- **************************************************** --&gt;</span>

            <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transaction-type</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence:persistence-unit-transaction-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
              <span class="tag">&lt;xsd:annotation&gt;</span>
                <span class="tag">&lt;xsd:documentation&gt;</span>

                  Type of transactions used by EntityManagers from this
                  persistence unit.

                <span class="tag">&lt;/xsd:documentation&gt;</span>
              <span class="tag">&lt;/xsd:annotation&gt;</span>
            <span class="tag">&lt;/xsd:attribute&gt;</span>

          <span class="tag">&lt;/xsd:complexType&gt;</span>
        <span class="tag">&lt;/xsd:element&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence:versionType</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:complexType&gt;</span>
  <span class="tag">&lt;/xsd:element&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-transaction-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum PersistenceUnitTransactionType {JTA, RESOURCE_LOCAL};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">JTA</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">RESOURCE_LOCAL</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-caching-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum SharedCacheMode { ALL, NONE, ENABLE_SELECTIVE, DISABLE_SELECTIVE, UNSPECIFIED};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ENABLE_SELECTIVE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DISABLE_SELECTIVE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UNSPECIFIED</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-validation-mode-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum ValidationMode { AUTO, CALLBACK, NONE};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">AUTO</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CALLBACK</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="tag">&lt;/xsd:schema&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="container-and-provider-contracts-for-deployment-and-bootstrapping"><a class="anchor" href="#container-and-provider-contracts-for-deployment-and-bootstrapping"></a>9. Container and Provider Contracts for Deployment and Bootstrapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter defines requirements on the Jakarta EE container and on
the persistence provider for deployment and bootstrapping.</p>
</div>
<div class="sect2">
<h3 id="a12802"><a class="anchor" href="#a12802"></a>9.1. Jakarta EE Deployment</h3>
<div class="paragraph">
<p>Each persistence unit deployed into a Jakarta EE
container consists of a single <em>persistence.xml</em> file, any number of
mapping files, and any number of class files.</p>
</div>
<div class="paragraph">
<p>At deployment time the container is
responsible for scanning the locations specified in <a href="#a12236">Section 8.2</a> and
discovering the <em>persistence.xml</em> files and processing them.</p>
</div>
<div class="paragraph">
<p>When the container finds a <em>persistence.xml</em>
file, it must process the persistence unit definitions that it contains.
The container must validate the <em>persistence.xml</em> file against the
<em>persistence_3_0.xsd</em> or <em>persistence_2_2.xsd</em> schema in accordance with
the version specified by the <em>persistence.xml</em> file and report any validation errors.
Provider or data source information not specified in the <em>persistence.xml</em> file
must be provided at deployment time or defaulted by the container. The
container may optionally add any container-specific properties to be
passed to the provider when creating the entity manager factory for the
persistence unit.</p>
</div>
<div class="paragraph">
<p>Once the container has read the persistence
metadata, it determines the <em>jakarta.persistence.spi.PersistenceProvider</em>
implementation class for each deployed named persistence unit. The
container then creates an instance of the <em>PersistenceProvider</em>
implementation class for each deployed named persistence unit and
invokes the <em>createContainerEntityManagerFactory</em> method on that
instance.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The container must implement the
<em>PersistenceUnitInfo</em> interface described in <a href="#a13160">Section 9.6</a> and pass the
metadata—in the form of a <em>PersistenceUnitInfo</em> instance—to the
persistence provider as part of this call.</p>
</li>
<li>
<p>If a Bean Validation provider exists in the
container environment and the <em>validation-mode</em> <em>NONE</em> is not specified,
a <em>ValidatorFactory</em> instance must be made available by the container.
The container is responsible for passing this <em>ValidatorFactory</em>
instance via the map that is passed as an argument to the
<em>createContainerEntityManagerFactory</em> call. The map key used must be the
standard property name <em>jakarta.persistence.validation.factory</em>.</p>
</li>
<li>
<p>If CDI is enabled, a <em>BeanManager</em> instance
must be made available by the container. The container is responsible
for passing this <em>BeanManager</em> instance via the map that is passed as an
argument to the <em>createContainerEntityManagerFactory</em> call. The map key
used must be the standard property name <em>jakarta.persistence.bean.manager</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>EntityManagerFactory</em> instance obtained
as a result will be used by the container to create container-managed
entity managers. Only one EntityManagerFactory is permitted to be
created for each deployed persistence unit configuration. Any number of
EntityManager instances may be created from a given factory.</p>
</div>
<div class="paragraph">
<p>In a Jakarta EE environment, the classes of the
persistence unit should not be loaded by the application class loader or
any of its parent class loaders until after the entity manager factory
for the persistence unit has been created.</p>
</div>
<div class="paragraph">
<p>When a persistence unit is redeployed, the
container should call the <em>close</em> method on the previous
<em>EntityManagerFactory</em> instance and call the
<em>createContainerEntityManagerFactory</em> method again, with the required
<em>PersistenceUnitInfo</em> metadata, to achieve the redeployment.</p>
</div>
</div>
<div class="sect2">
<h3 id="bootstrapping-in-java-se-environments"><a class="anchor" href="#bootstrapping-in-java-se-environments"></a>9.2. Bootstrapping in Java SE Environments</h3>
<div class="paragraph">
<p>In Java SE environments, the
<em>Persistence.createEntityManagerFactory</em> method is used by the
application to create an entity manager factory<sup class="footnote">[<a id="_footnoteref_91" class="footnote" href="#_footnotedef_91" title="View footnote.">91</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>A persistence provider implementation running
in a Java SE environment should also act as a service provider by
supplying a service provider configuration file as defined by the Java
SE platform.</p>
</div>
<div class="paragraph">
<p>The provider configuration file serves to
export the provider implementation class to the <em>Persistence</em> bootstrap
class, positioning the provider as a candidate for backing named
persistence units. The provider supplies the provider configuration file
by creating a text file named
<em>jakarta.persistence.spi.PersistenceProvider</em> and placing it in the
<em>META-INF/services</em> directory of one of its JAR files. The contents of
the file should be the name of the provider implementation class of the
<em>jakarta.persistence.spi.PersistenceProvider</em> interface.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="paragraph">
<p>A persistence vendor called ACME persistence
products ships a JAR called <em>acme.jar</em> that contains its persistence
provider implementation. The JAR includes the provider configuration
file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>acme.jar
    META-INF/services/jakarta.persistence.spi.PersistenceProvider
    com.acme.PersistenceProvider
    ...</pre>
</div>
</div>
<div class="paragraph">
<p>The contents of the
<em>META-INF/services/jakarta.persistence.spi.PersistenceProvider</em> file is
nothing more than the name of the implementation class:
<em>com.acme.PersistenceProvider</em>.</p>
</div>
<div class="paragraph">
<p>Persistence provider jars may be installed or
made available in the same ways as other service providers, e.g. as
extensions or added to the application classpath.</p>
</div>
<div class="paragraph">
<p>The <em>Persistence</em> bootstrap class must locate
all of the persistence providers using the <em>PersistenceProviderResolver</em>
mechanism described in <a href="#a12837">Section 9.3</a> and call
<em>createEntityManagerFactory</em> on them in turn until an appropriate
backing provider returns an <em>EntityManagerFactory</em> instance. A provider
may deem itself as appropriate for the persistence unit if any of the
following are true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Its implementation class has been specified
in the <em>provider</em> element for that persistence unit in the
<em>persistence.xml</em> file and has not been overridden by a different
<em>jakarta.persistence.provider</em> property value included in the Map passed
to the <em>createEntityManagerFactory</em> method.</p>
</li>
<li>
<p>The <em>jakarta.persistence.provider</em> property was
included in the Map passed to <em>createEntityManagerFactory</em> and the value
of the property is the provider&#8217;s implementation class.</p>
</li>
<li>
<p>No provider was specified for the persistence
unit in either the <em>persistence.xml</em> or the property map.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a provider does not qualify as the
provider for the named persistence unit, it must return <em>null</em> when
<em>createEntityManagerFactory</em> is invoked on it.</p>
</div>
<div class="sect3">
<h4 id="schema-generation"><a class="anchor" href="#schema-generation"></a>9.2.1. Schema Generation</h4>
<div class="paragraph">
<p>In Java SE environments, the
<em>Persistence.generateSchema</em> method may be used by the application to
cause schema generation to occur as a separate phase from entity manager
factory creation.</p>
</div>
<div class="paragraph">
<p>In this case, the <em>Persistence</em> bootstrap
class must locate all of the persistence providers using the
<em>PersistenceProviderResolver</em> mechanism described in <a href="#a12837">Section 9.3</a>
and call <em>generateSchema</em> on them in turn until an
appropriate backing provider returns <em>true</em>. A provider may deem itself
as appropriate for the persistence unit if any of the following are
true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Its implementation class has been specified
in the <em>provider</em> element for that persistence unit in the
<em>persistence.xml</em> file and has not been overridden by a different
<em>jakarta.persistence.provider</em> property value included in the Map passed
to the <em>generateSchema</em> method.</p>
</li>
<li>
<p>The <em>jakarta.persistence.provider</em> property was
included in the Map passed to <em>generateSchema</em> and the value of the
property is the provider&#8217;s implementation class.</p>
</li>
<li>
<p>No provider was specified for the persistence
unit in either the <em>persistence.xml</em> or the property map.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a provider does not qualify as the
provider for the named persistence unit, it must return <em>false</em> when
<em>generateSchema</em> is invoked on it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a12837"><a class="anchor" href="#a12837"></a>9.3. Determining the Available Persistence Providers</h3>
<div class="paragraph">
<p>The <em>PersistenceProviderResolver</em> and
<em>PersistenceProviderResolverHolder</em> mechanism supports the dynamic
discovery of persistence providers.<sup class="footnote">[<a id="_footnoteref_92" class="footnote" href="#_footnotedef_92" title="View footnote.">92</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <em>PersistenceProviderResolver</em> instance is
responsible for returning the list of providers available in the
environment.</p>
</div>
<div class="paragraph">
<p>The <em>PersistenceProviderResolverHolder</em> class
holds the <em>PersistenceProviderResolver</em> instance that is in use. The
implementation of <em>PersistenceProviderResolverHolder</em> must be
threadsafe, but no guarantee is made against multiple threads setting
the resolver.</p>
</div>
<div class="paragraph">
<p>The container is allowed to implement
and set a specific <em>PersistenceProviderResolver</em> provided that it
respects the <em>PersistenceProviderResolver</em> contract. The
<em>PersistenceProviderResolver</em> instance to be used is set by the
container using the
<em>PersistenceProviderResolverHolder.setPersistenceProviderResolver</em>
method.<sup class="footnote">[<a id="_footnoteref_93" class="footnote" href="#_footnotedef_93" title="View footnote.">93</a>]</sup></p>
</div>
<div class="paragraph">
<p>If no <em>PersistenceProviderResolver</em> is set,
the <em>PersistenceProviderResolverHolder</em> must return a
<em>PersistenceProviderResolver</em> that returns the providers whose
persistence provider jars have been installed or made available as
service providers or extensions. This default
<em>PersistenceProviderResolver</em> instance does not guarantee the order in
which persistence providers are returned.</p>
</div>
<div class="paragraph">
<p>A <em>PersistenceProviderResolver</em> must be threadsafe.</p>
</div>
<div class="paragraph">
<p>The
<em>PersistenceProviderResolver.getPersistenceProviders()</em> method must be
used to determine the list of available persistence providers.</p>
</div>
<div class="paragraph">
<p>The results of calling the
<em>PersistenceProviderResolverHolder.getPersistenceProviderResolver</em> and
the <em>PersistenceProviderResolver.getPersistenceProviders</em> methods must
not be cached. In particular, the following methods must use the
<em>PersistenceProviderResolver</em> instance returned by the
<em>PersistenceProviderResolverHolder.getPersistenceProviderResolver</em>
method to determine the list of available providers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Persistence.createEntityManagerFactory(String)</em></p>
</li>
<li>
<p><em>Persistence.createEntityManagerFactory(String, Map)</em></p>
</li>
<li>
<p><em>PersistenceUtil.isLoaded(Object)</em></p>
</li>
<li>
<p><em>PersistenceUtil.isLoaded(Object, String)</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These methods must not cache the list of
providers and must not cache the <em>PersistenceProviderResolver</em> instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the
<em>PersistenceProviderResolver.getPersistenceProviders()</em> method can
potentially be called many times. It is therefore recommended that the
implementation of this method make use of caching.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that only a single
<em>PersistenceProviderResolver</em> instance can be defined in a given
classloader hierarchy at a given time.</p>
</div>
<div class="sect3">
<h4 id="persistenceproviderresolver-interface"><a class="anchor" href="#persistenceproviderresolver-interface"></a>9.3.1. PersistenceProviderResolver interface</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * Determine the list of persistence providers available in the
 * runtime environment.
 *
 * &lt;p&gt; Implementations must be thread-safe.
 *
 * &lt;p&gt; Note that the &lt;code&gt;getPersistenceProviders&lt;/code&gt; method can potentially
 * be called many times: it is recommended that the implementation
 * of this method make use of caching.
 *
 * @see PersistenceProvider
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceProviderResolver</span> {

    <span class="comment">/**
     * Returns a list of the &lt;code&gt;PersistenceProvider&lt;/code&gt; implementations
     * available in the runtime environment.
     *
     * @return list of the persistence providers available
     *         in the environment
     */</span>
    <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; getPersistenceProviders();

    <span class="comment">/**
     * Clear cache of providers.
     *
     */</span>
    <span class="type">void</span> clearCachedProviders();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="persistenceproviderresolverholder-class"><a class="anchor" href="#persistenceproviderresolverholder-class"></a>9.3.2. PersistenceProviderResolverHolder class</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="comment">/**
 * Holds the global {@link PersistenceProviderResolver}
 * instance. If no &lt;code&gt;PersistenceProviderResolver&lt;/code&gt; is set by the
 * environment, the default &lt;code&gt;PersistenceProviderResolver&lt;/code&gt; is used.
 * Enable &quot;jakarta.persistence.spi&quot; logger to show diagnostic information.
 *
 * Implementations must be thread-safe.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PersistenceProviderResolverHolder</span> {

    <span class="directive">private</span> <span class="directive">static</span> PersistenceProviderResolver singleton = <span class="keyword">new</span> DefaultPersistenceProviderResolver();

    <span class="comment">/**
     * Returns the current persistence provider resolver.
     *
     * @return the current persistence provider resolver
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> PersistenceProviderResolver getPersistenceProviderResolver() {
        <span class="keyword">return</span> singleton;
    }

    <span class="comment">/**
     * Defines the persistence provider resolver used.
     *
     * @param resolver persistence provider resolver to be used.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> setPersistenceProviderResolver(PersistenceProviderResolver resolver) {
        <span class="keyword">if</span> (resolver == <span class="predefined-constant">null</span>) {
            singleton = <span class="keyword">new</span> DefaultPersistenceProviderResolver();
        } <span class="keyword">else</span> {
            singleton = resolver;
        }
    }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a12917"><a class="anchor" href="#a12917"></a>9.4. Schema Generation</h3>
<div class="paragraph">
<p>In cases where a preconfigured database (or a
“legacy” database) is not used or is not available, the Jakarta Persistence
schema generation facility may be used to generate the tables and other
database artifacts required by the persistence application. Whether
schema generation entails the creation of schemas proper in the database
is determined by the environment and the configuration of the schema
generation process, as described below.</p>
</div>
<div class="paragraph">
<p>Schema generation may happen either prior to
application deployment or when the entity manager factory is created as
part of the application deployment and initialization process.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In Jakarta EE environments, the container may
call the <em>PersistenceProvider</em> <em>generateSchema</em> method separately from
and/or prior to the creation of the entity manager factory for the
persistence unit, or the container may pass additional information to
the <em>createContainerEntityManagerFactory</em> call to cause schema
generation to happen as part of the entity manager factory creation and
application initialization process. The information passed to these
methods controls whether the generation occurs directly in the target
database, whether DDL scripts for schema generation are created, or
both.</p>
</li>
<li>
<p>In Java SE environments, the application may
call the <em>Persistence</em> <em>generateSchema</em> method separately from and/or
prior to the creation of the entity manager factory or may pass
information to the <em>createEntityManagerFactory</em> method to cause schema
generation to occur as part of the entity manager factory creation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application may provide DDL scripts to be
used for schema generation as described in <a href="#a12384">Section 8.2.1.9</a>. The application developer
may package these scripts as part of the persistence unit or may specify
strings corresponding to file URLs for the location of such scripts. In
Jakarta EE environments, such scripts may be executed by the container, or
the container may direct the persistence provider to execute the
scripts. In Java SE environments, the execution of the scripts is the
responsibility of the persistence provider. In the absence of the
specification of scripts, schema generation, if requested, will be
determined by the object/relational metadata of the persistence unit.</p>
</div>
<div class="paragraph">
<p>The following standard properties are defined
for configuring the schema generation process. In Jakarta EE environments
these properties are passed by the container in the <em>Map</em> argument to
either the <em>PersistenceProvider</em> <em>generateSchema</em> method or the
<em>createContainerEntityManagerFactory</em> method. In Java SE environments,
they are passed in the <em>Map</em> argument to either the <em>Persistence</em>
<em>generateSchema</em> method or <em>createEntityManagerFactory</em> method.</p>
</div>
<div class="paragraph">
<p>In Jakarta EE environments, any strings
corresponding to file URLs for script sources or targets must specify
absolute paths (not relative). In Jakarta EE environments, all source and
target file locations must be accessible to the application server
deploying the persistence unit</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.schema-generation.database.action</em><br>
The <em>jakarta.persistence.schema-generation.database.action</em> property specifies
the action to be taken by the persistence provider with regard to the
database artifacts. The values for this property are <em>"none"</em>,
<em>"create"</em>, <em>"drop-and-create"</em>, <em>"drop"</em>. If the
<em>jakarta.persistence.schema-generation.database.action</em> property is not
specified, no schema generation actions must be taken on the database.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.scripts.action</em><br>
The <em>jakarta.persistence.schema-generation.scripts.action</em> property specifies
which scripts are to be generated by the persistence provider. The
values for this property are <em>"none"</em>, <em>"create"</em>, <em>"drop-and-create"</em>
, <em>"drop"</em>. A script will only be generated if the script target is
specified. If this property is not specified, no scripts will be
generated.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.create-source</em><br>
The <em>jakarta.persistence.schema-generation.create-source</em> property specifies
whether the creation of database artifacts is to occur on the basis of
the object/relational mapping metadata, DDL script, or a combination of
the two. The values for this property are <em>"metadata"</em>, <em>"script"</em>,
<em>"metadata-then-script"</em>, <em>"script-then-metadata"</em>. If this property
is not specified, and a script is specified by the
<em>jakarta.persistence.schema-generation.create-script-source</em> property, the
script (only) will be used for schema generation; otherwise if this
property is not specified, schema generation will occur on the basis of
the object/relational mapping metadata (only). The
<em>"metadata-then-script"</em> and <em>"script-then-metadata"</em> values specify
that a combination of metadata and script is to be used and the order in
which this use is to occur. If either of these values is specified and
the resulting database actions are not disjoint, the results are
undefined and schema generation may fail.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.drop-source</em><br>
The <em>jakarta.persistence.schema-generation.drop-source</em> property specifies
whether the dropping of database artifacts is to occur on the basis of
the object/relational mapping metadata, DDL script, or a combination of
the two. The values for this property are <em>"metadata"</em>, <em>"script"</em>,
<em>"metadata-then-script"</em>, <em>"script-then-metadata"</em>. If this property
is not specified, and a script is specified by the
<em>jakarta.persistence.schema-generation.drop-script-source</em> property, the
script (only) will be used for the dropping of database artifacts;
otherwise if this property is not specified, the dropping of database
artifacts will occur on the basis of the object/relational mapping
metadata (only). The <em>"metadata-then-script"</em> and
<em>"script-then-metadata"</em> values specify that a combination of metadata
and script is to be used and the order in which this use is to occur. If
either of these values is specified and the resulting database actions
are not disjoint, the results are undefined and the dropping of database
artifacts may fail.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.create-database-schemas</em><br>
In Jakarta EE environments, it is anticipated
that the Jakarta EE platform provider may wish to control the creation of
database schemas rather than delegate this task to the persistence
provider. The
<em>jakarta.persistence.schema-generation.create-database-schemas</em> property
specifies whether the persistence provider is to create the database
schema(s) in addition to creating database objects such as tables,
sequences, constraints, etc. The value of this boolean property should
be set to true if the persistence provider is to create schemas in the
database or to generate DDL that contains “CREATE SCHEMA” commands. If
this property is not supplied, the provider should not attempt to create
database schemas. This property may also be specified in Java SE
environments.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.scripts.create-target</em>,<br>
<em>jakarta.persistence.schema-generation.scripts.drop-target</em><br>
If scripts are to be generated, the target
locations for the writing of these scripts must be specified.<br>
The <em>jakarta.persistence.schema-generation.scripts.create-target</em> property
specifies a <em>java.IO.Writer</em> configured for use by the persistence
provider for output of the DDL script or a string specifying the file
URL for the DDL script. This property should only be specified if
scripts are to be generated.<br>
The <em>jakarta.persistence.schema-generation.scripts.drop-target</em> property
specifies a <em>java.IO.Writer</em> configured for use by the persistence
provider for output of the DDL script or a string specifying the file
URL for the DDL script. This property should only be specified if
scripts are to be generated.</p>
</li>
<li>
<p><em>jakarta.persistence.database-product-name</em>,<br>
<em>jakarta.persistence.database-major-version</em>,<br>
<em>jakarta.persistence.database-minor-version</em><br>
If scripts are to be generated by the
persistence provider and a connection to the target database is not
supplied, the <em>jakarta.persistence.database-product-name</em> property must be
specified. The value of this property should be the value returned for
the target database by the JDBC <em>DatabaseMetaData</em> method
<em>getDatabaseProductName</em>. If sufficient database version information is
not included in the result of this method, the
<em>jakarta.persistence.database-major-version</em> and
<em>jakarta.persistence.database-minor-version</em> properties should be
specified as needed. These should contain the values returned by the
JDBC <em>getDatabaseMajorVersion</em> and <em>getDatabaseMinorVersion</em> methods
respectively.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.create-script-source</em>,<br>
<em>jakarta.persistence.schema-generation.drop-script-source</em><br>
The <em>jakarta.persistence.schema-generation.create-script-source</em> and
<em>jakarta.persistence.schema-generation.drop-script-source</em> properties are
used for script execution. In Jakarta EE container environments, it is
generally expected that the container will be responsible for executing
DDL scripts, although the container is permitted to delegate this task
to the persistence provider. If DDL scripts are to be used in Java SE
environments or if the Jakarta EE container delegates the execution of
scripts to the persistence provider, these properties must be specified.<br>
The
<em>jakarta.persistence.schema-generation.create-script-source</em> property
specifies a <em>java.IO.Reader</em> configured for reading of the DDL script or
a string designating a file URL for the DDL script.<br>
The
<em>jakarta.persistence.schema-generation.drop-script-source</em> property
specifies a <em>java.IO.Reader</em> configured for reading of the DDL script or
a string designating a file URL for the DDL script.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.connection</em><br>
The <em>jakarta.persistence.schema-generation.connection</em> property specifies the
JDBC connection to be used for schema generation. This is intended for
use in Jakarta EE environments, where the platform provider may want to
control the database privileges that are available to the persistence
provider. This connection is provided by the container, and should be
closed by the container when the schema generation request or entity
manager factory creation completes. The connection provided must have
credentials sufficient for the persistence provider to carry out the
requested actions. If this property is not specified, the persistence
provider should use the DataSource that has otherwise been provided.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="data-loading"><a class="anchor" href="#data-loading"></a>9.4.1. Data Loading</h4>
<div class="paragraph">
<p>Data loading, by means of the use of SQL
scripts, may occur as part of the schema generation process after the
creation of the database artifacts or independently of schema
generation. The specification of the
<em>jakarta.persistence.sql-load-script-source</em> controls whether data loading
will occur.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.sql-load-script-source</em><br>
In Jakarta EE container environments, it is
generally expected that the container will be responsible for executing
data load scripts, although the container is permitted to delegate this
task to the persistence provider. If a load script is to be used in Java
SE environments or if the Jakarta EE container delegates the execution of
the load script to the persistence provider, this property must be
specified. + The
<em>jakarta.persistence.sql-load-script-source</em> property specifies a
<em>java.IO.Reader</em> configured for reading of the SQL load script for
database initialization or a string designating a file URL for the
script.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="responsibilities-of-the-persistence-provider"><a class="anchor" href="#responsibilities-of-the-persistence-provider"></a>9.5. Responsibilities of the Persistence Provider</h3>
<div class="paragraph">
<p>The persistence provider must implement the
<em>PersistenceProvider</em> SPI.</p>
</div>
<div class="paragraph">
<p>In Jakarta EE environments, the persistence
provider must process the metadata that is passed to it at the time
<em>createContainerEntityManagerFactory</em> method is called and create an
instance of <em>EntityManagerFactory</em> using the <em>PersistenceUnitInfo</em>
metadata for the factory. The factory is then returned to the container.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, the persistence
provider must validate the <em>persistence.xml</em> file against the
<em>persistence</em> schema that corresponds to the version specified by the
<em>persistence.xml</em> file and report any validation errors.</p>
</div>
<div class="paragraph">
<p>The persistence provider processes the
metadata annotations on the managed classes of the persistence unit.</p>
</div>
<div class="paragraph">
<p>When the entity manager factory for a
persistence unit is created, it is the responsibility of the persistence
provider to initialize the state of the metamodel classes of the
persistence unit.</p>
</div>
<div class="paragraph">
<p>When the persistence provider obtains an
object/relational mapping file, it processes the definitions that it
contains. The persistence provider must validate any object/relational
mapping files against the object/relational mapping schema version
specified by the object/relational mapping file and report any
validation errors. The object relational mapping file must specify the
object/relational mapping schema that it is written against by
indicating the <em>version</em> element.</p>
</div>
<div class="paragraph">
<p>In Java SE environments, the application can
pass the <em>ValidatorFactory</em> instance via the map that is passed as an
argument to the <em>Persistence.createEntityManagerFactory</em> call. The map
key used must be the standard property name
<em>jakarta.persistence.validation.factory</em>. If no <em>ValidatorFactory</em>
instance is provided by the application, and if a Bean Validation
provider is present in the classpath, the persistence provider must
instantiate the <em>ValidatorFactory</em> using the default bootstrapping
approach as defined by the Bean Validation specification
<a href="#a19498">[5]</a>, namely
<em>Validation.buildDefaultValidatorFactory()</em>.</p>
</div>
<div class="sect3">
<h4 id="jakarta-persistence-spi-persistenceprovider"><a class="anchor" href="#jakarta-persistence-spi-persistenceprovider"></a>9.5.1. jakarta.persistence.spi.PersistenceProvider</h4>
<div class="paragraph">
<p>The interface
<em>jakarta.persistence.spi.PersistenceProvider</em> must be implemented by the
persistence provider.</p>
</div>
<div class="paragraph">
<p>It is invoked by the container in Jakarta EE
environments and by the <em>jakarta.persistence.Persistence</em> class in Java SE
environments. The <em>jakarta.persistence.spi.PersistenceProvider</em>
implementation is not intended to be used by the application.</p>
</div>
<div class="paragraph">
<p>The <em>PersistenceProvider</em> implementation
class must have a public no-arg constructor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.EntityManagerFactory</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.Persistence</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.PersistenceException</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;

<span class="comment">/**
 * Interface implemented by the persistence provider.
 *
 * &lt;p&gt; It is invoked by the container in Jakarta EE environments and
 * by the {@link Persistence} class in Java SE environments to
 * create an {@link EntityManagerFactory} and/or to cause
 * schema generation to occur.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceProvider</span> {

    <span class="comment">/**
     * Called by &lt;code&gt;Persistence&lt;/code&gt; class when an
     * &lt;code&gt;EntityManagerFactory&lt;/code&gt; is to be created.
     *
     * @param emName  the name of the persistence unit
     * @param map  a Map of properties for use by the
     * persistence provider. These properties may be used to
     * override the values of the corresponding elements in
     * the &lt;code&gt;persistence.xml&lt;/code&gt; file or specify values for
     * properties not specified in the &lt;code&gt;persistence.xml&lt;/code&gt;
     * (and may be null if no properties are specified).
     * @return EntityManagerFactory for the persistence unit,
     * or null if the provider is not the right provider
     */</span>
    <span class="directive">public</span> EntityManagerFactory createEntityManagerFactory(<span class="predefined-type">String</span> emName, <span class="predefined-type">Map</span> map);

    <span class="comment">/**
     * Called by the container when an &lt;code&gt;EntityManagerFactory&lt;/code&gt;
     * is to be created.
     *
     * @param info  metadata for use by the persistence provider
     * @param map  a Map of integration-level properties for use
     * by the persistence provider (may be null if no properties
     * are specified).  These properties may include properties to
     * control schema generation.
     * If a Bean Validation provider is present in the classpath,
     * the container must pass the &lt;code&gt;ValidatorFactory&lt;/code&gt; instance in
     * the map with the key &lt;code&gt;&quot;jakarta.persistence.validation.factory&quot;&lt;/code&gt;.
     * If the containing archive is a bean archive, the container
     * must pass the BeanManager instance in the map with the key
     * &lt;code&gt;&quot;jakarta.persistence.bean.manager&quot;&lt;/code&gt;.
     * @return EntityManagerFactory for the persistence unit
     * specified by the metadata
     */</span>
    <span class="directive">public</span> EntityManagerFactory createContainerEntityManagerFactory(PersistenceUnitInfo info, <span class="predefined-type">Map</span> map);


    <span class="comment">/**
     * Create database schemas and/or tables and/or create DDL
     * scripts as determined by the supplied properties.
     * &lt;p&gt;
     * Called by the container when schema generation is to
     * occur as a separate phase from creation of the entity
     * manager factory.
     * &lt;p&gt;
     * @param info metadata for use by the persistence provider
     * @param map properties for schema generation;  these may
     *             also include provider-specific properties
     * @throws PersistenceException if insufficient or inconsistent
     *         configuration information is provided of if schema
     *         generation otherwise fails
     *
     * @since 2.1
     */</span>
    <span class="directive">public</span> <span class="type">void</span> generateSchema(PersistenceUnitInfo info, <span class="predefined-type">Map</span> map);

    <span class="comment">/**
     * Create database schemas and/or tables and/or create DDL
     * scripts as determined by the supplied properties.
     * &lt;p&gt;
     * Called by the Persistence class when schema generation is to
     * occur as a separate phase from creation of the entity
     * manager factory.
     * &lt;p&gt;
     * @param persistenceUnitName the name of the persistence unit
     * @param map properties for schema generation;  these may
     *             also contain provider-specific properties.  The
     *             value of these properties override any values that
     *             may have been configured elsewhere.
     * @return true  if schema was generated, otherwise false
     * @throws PersistenceException if insufficient or inconsistent
     *         configuration information is provided or if schema
     *         generation otherwise fails
     *
     * @since 2.1
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> generateSchema(<span class="predefined-type">String</span> persistenceUnitName, <span class="predefined-type">Map</span> map);

    <span class="comment">/**
     * Return the utility interface implemented by the persistence
     * provider.
     * @return ProviderUtil interface
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> ProviderUtil getProviderUtil();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The properties used in the
<em>createEntityManagerFactory</em> method in Java SE environments are
described further in <a href="#a13443">Section 9.7</a> below.</p>
</div>
</div>
<div class="sect3">
<h4 id="jakarta-persistence-spi-providerutil"><a class="anchor" href="#jakarta-persistence-spi-providerutil"></a>9.5.2. jakarta.persistence.spi.ProviderUtil</h4>
<div class="paragraph">
<p>The <em>ProviderUtil</em> interface is invoked by
the <em>PersistenceUtil</em> implementation to determine the load status of an
entity or entity attribute. It is not intended to be invoked by the
application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.PersistenceUtil</span>;

<span class="comment">/**
 * Utility interface implemented by the persistence provider.  This
 * interface is invoked by the {@link
 * PersistenceUtil} implementation to determine
 * the load status of an entity or entity attribute.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ProviderUtil</span> {

    <span class="comment">/**
     * If the provider determines that the entity has been provided
     * by itself and that the state of the specified attribute has
     * been loaded, this method returns &lt;code&gt;LoadState.LOADED&lt;/code&gt;.
     * &lt;p&gt; If the provider determines that the entity has been provided
     * by itself and that either entity attributes with &lt;code&gt;FetchType.EAGER&lt;/code&gt;
     * have not been loaded or that the state of the specified
     * attribute has not been loaded, this methods returns
     * &lt;code&gt;LoadState.NOT_LOADED&lt;/code&gt;.
     * &lt;p&gt; If a provider cannot determine the load state, this method
     * returns &lt;code&gt;LoadState.UNKNOWN&lt;/code&gt;.
     * &lt;p&gt; The provider's implementation of this method must not obtain
     * a reference to an attribute value, as this could trigger the
     * loading of entity state if the entity has been provided by a
     * different provider.
     * @param entity  entity instance
     * @param attributeName  name of attribute whose load status is
     *        to be determined
     * @return load status of the attribute
     */</span>
    <span class="directive">public</span> LoadState isLoadedWithoutReference(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * If the provider determines that the entity has been provided
     * by itself and that the state of the specified attribute has
     * been loaded, this method returns &lt;code&gt;LoadState.LOADED&lt;/code&gt;.
     * &lt;p&gt; If a provider determines that the entity has been provided
     * by itself and that either the entity attributes with &lt;code&gt;FetchType.EAGER&lt;/code&gt;
     * have not been loaded or that the state of the specified
     * attribute has not been loaded, this method returns
     * return &lt;code&gt;LoadState.NOT_LOADED&lt;/code&gt;.
     * &lt;p&gt; If the provider cannot determine the load state, this method
     * returns &lt;code&gt;LoadState.UNKNOWN&lt;/code&gt;.
     * &lt;p&gt; The provider's implementation of this method is permitted to
     * obtain a reference to the attribute value.  (This access is
     * safe because providers which might trigger the loading of the
     * attribute state will have already been determined by
     * &lt;code&gt;isLoadedWithoutReference&lt;/code&gt;. )
     *
     * @param entity  entity instance
     * @param attributeName  name of attribute whose load status is
     *        to be determined
     * @return load status of the attribute
     */</span>
    <span class="directive">public</span> LoadState isLoadedWithReference(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * If the provider determines that the entity has been provided
     * by itself and that the state of all attributes for which
     * &lt;code&gt;FetchType.EAGER&lt;/code&gt; has been specified have been loaded, this
     * method returns &lt;code&gt;LoadState.LOADED&lt;/code&gt;.
     * &lt;p&gt; If the provider determines that the entity has been provided
     * by itself and that not all attributes with &lt;code&gt;FetchType.EAGER&lt;/code&gt;
     * have been loaded, this method returns &lt;code&gt;LoadState.NOT_LOADED&lt;/code&gt;.
     * &lt;p&gt; If the provider cannot determine if the entity has been
     * provided by itself, this method returns &lt;code&gt;LoadState.UNKNOWN&lt;/code&gt;.
     * &lt;p&gt; The provider's implementation of this method must not obtain
     * a reference to any attribute value, as this could trigger the
     * loading of entity state if the entity has been provided by a
     * different provider.
     * @param entity whose loaded status is to be determined
     * @return load status of the entity
     */</span>
    <span class="directive">public</span> LoadState isLoaded(<span class="predefined-type">Object</span> entity);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="comment">/**
 * Load states returned by the {@link ProviderUtil} SPI methods.
 * @since 2.0
 *
 */</span>
<span class="directive">public</span> <span class="type">enum</span> LoadState {
    <span class="comment">/** The state of the element is known to have been loaded. */</span>
    LOADED,
    <span class="comment">/** The state of the element is known not to have been loaded. */</span>
    NOT_LOADED,
    <span class="comment">/** The load state of the element cannot be determined. */</span>
    UNKNOWN
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13160"><a class="anchor" href="#a13160"></a>9.6. jakarta.persistence.spi.PersistenceUnitInfo Interface</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">javax.sql.DataSource</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Properties</span>;
<span class="keyword">import</span> <span class="include">java.net.URL</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.SharedCacheMode</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.ValidationMode</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.EntityManagerFactory</span>;

<span class="comment">/**
 * Interface implemented by the container and used by the
 * persistence provider when creating an {@link EntityManagerFactory}.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceUnitInfo</span> {

    <span class="comment">/**
     * Returns the name of the persistence unit. Corresponds to the
     * &lt;code&gt;name&lt;/code&gt; attribute in the &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return  the name of the persistence unit
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getPersistenceUnitName();

    <span class="comment">/**
     * Returns the fully qualified name of the persistence provider
     * implementation class. Corresponds to the &lt;code&gt;provider&lt;/code&gt; element in
     * the &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return  the fully qualified name of the persistence provider
     * implementation class
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getPersistenceProviderClassName();

    <span class="comment">/**
     * Returns the transaction type of the entity managers created by
     * the &lt;code&gt;EntityManagerFactory&lt;/code&gt;. The transaction type corresponds to
     * the &lt;code&gt;transaction-type&lt;/code&gt; attribute in the &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return  transaction type of the entity managers created
     * by the EntityManagerFactory
     */</span>
    <span class="directive">public</span> PersistenceUnitTransactionType getTransactionType();

    <span class="comment">/**
     * Returns the JTA-enabled data source to be used by the
     * persistence provider. The data source corresponds to the
     * &lt;code&gt;jta-data-source&lt;/code&gt; element in the &lt;code&gt;persistence.xml&lt;/code&gt; file or is
     * provided at deployment or by the container.
     * @return the JTA-enabled data source to be used by the
     * persistence provider
     */</span>
    <span class="directive">public</span> <span class="predefined-type">DataSource</span> getJtaDataSource();

    <span class="comment">/**
     * Returns the non-JTA-enabled data source to be used by the
     * persistence provider for accessing data outside a JTA
     * transaction. The data source corresponds to the named
     * &lt;code&gt;non-jta-data-source&lt;/code&gt; element in the &lt;code&gt;persistence.xml&lt;/code&gt; file or
     * provided at deployment or by the container.
     * @return the non-JTA-enabled data source to be used by the
     * persistence provider for accessing data outside a JTA
     * transaction
     */</span>
    <span class="directive">public</span> <span class="predefined-type">DataSource</span> getNonJtaDataSource();

    <span class="comment">/**
     * Returns the list of the names of the mapping files that the
     * persistence provider must load to determine the mappings for
     * the entity classes. The mapping files must be in the standard
     * XML mapping format, be uniquely named and be resource-loadable
     * from the application classpath.  Each mapping file name
     * corresponds to a &lt;code&gt;mapping-file&lt;/code&gt; element in the
     * &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return the list of mapping file names that the persistence
     * provider must load to determine the mappings for the entity
     * classes
     */</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getMappingFileNames();

    <span class="comment">/**
     * Returns a list of URLs for the jar files or exploded jar
     * file directories that the persistence provider must examine
     * for managed classes of the persistence unit. Each URL
     * corresponds to a &lt;code&gt;jar-file&lt;/code&gt; element in the
     * &lt;code&gt;persistence.xml&lt;/code&gt; file. A URL will either be a
     * file: URL referring to a jar file or referring to a directory
     * that contains an exploded jar file, or some other URL from
     * which an InputStream in jar format can be obtained.
     * @return a list of URL objects referring to jar files or
     * directories
     */</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">URL</span>&gt; getJarFileUrls();

    <span class="comment">/**
     * Returns the URL for the jar file or directory that is the
     * root of the persistence unit. (If the persistence unit is
     * rooted in the WEB-INF/classes directory, this will be the
     * URL of that directory.)
     * The URL will either be a file: URL referring to a jar file
     * or referring to a directory that contains an exploded jar
     * file, or some other URL from which an InputStream in jar
     * format can be obtained.
     * @return a URL referring to a jar file or directory
     */</span>
    <span class="directive">public</span> <span class="predefined-type">URL</span> getPersistenceUnitRootUrl();

    <span class="comment">/**
     * Returns the list of the names of the classes that the
     * persistence provider must add to its set of managed
     * classes. Each name corresponds to a named &lt;code&gt;class&lt;/code&gt; element in the
     * &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return the list of the names of the classes that the
     * persistence provider must add to its set of managed
     * classes
     */</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getManagedClassNames();

    <span class="comment">/**
     * Returns whether classes in the root of the persistence unit
     * that have not been explicitly listed are to be included in the
     * set of managed classes. This value corresponds to the
     * &lt;code&gt;exclude-unlisted-classes&lt;/code&gt; element in the &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return whether classes in the root of the persistence
     * unit that have not been explicitly listed are to be
     * included in the set of managed classes
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> excludeUnlistedClasses();

    <span class="comment">/**
     * Returns the specification of how the provider must use
     * a second-level cache for the persistence unit.
     * The result of this method corresponds to the &lt;code&gt;shared-cache-mode&lt;/code&gt;
     * element in the &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return the second-level cache mode that must be used by the
     * provider for the persistence unit
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> SharedCacheMode getSharedCacheMode();

    <span class="comment">/**
     * Returns the validation mode to be used by the persistence
     * provider for the persistence unit.  The validation mode
     * corresponds to the &lt;code&gt;validation-mode&lt;/code&gt; element in the
     * &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return the validation mode to be used by the
     * persistence provider for the persistence unit
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> ValidationMode getValidationMode();

    <span class="comment">/**
     * Returns a properties object. Each property corresponds to a
     * &lt;code&gt;property&lt;/code&gt; element in the &lt;code&gt;persistence.xml&lt;/code&gt; file
     * or to a property set by the container.
     * @return Properties object
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Properties</span> getProperties();

    <span class="comment">/**
     * Returns the schema version of the &lt;code&gt;persistence.xml&lt;/code&gt; file.
     * @return persistence.xml schema version
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getPersistenceXMLSchemaVersion();

    <span class="comment">/**
     * Returns ClassLoader that the provider may use to load any
     * classes, resources, or open URLs.
     * @return ClassLoader that the provider may use to load any
     * classes, resources, or open URLs
     */</span>
    <span class="directive">public</span> <span class="predefined-type">ClassLoader</span> getClassLoader();

    <span class="comment">/**
     * Add a transformer supplied by the provider that will be
     * called for every new class definition or class redefinition
     * that gets loaded by the loader returned by the
     * {@link PersistenceUnitInfo#getClassLoader} method. The transformer
     * has no effect on the result returned by the
     * {@link PersistenceUnitInfo#getNewTempClassLoader} method.
     * Classes are only transformed once within the same classloading
     * scope, regardless of how many persistence units they may be
     * a part of.
     * @param transformer   provider-supplied transformer that the
     * container invokes at class-(re)definition time
     */</span>
    <span class="directive">public</span> <span class="type">void</span> addTransformer(ClassTransformer transformer);

    <span class="comment">/**
     * Return a new instance of a ClassLoader that the provider may
     * use to temporarily load any classes, resources, or open
     * URLs. The scope and classpath of this loader is exactly the
     * same as that of the loader returned by {@link
     * PersistenceUnitInfo#getClassLoader}. None of the classes loaded
     * by this class loader will be visible to application
     * components. The provider may only use this ClassLoader within
     * the scope of the {@link
     * PersistenceProvider#createContainerEntityManagerFactory} call.
     * @return temporary ClassLoader with same visibility as current
     * loader
     */</span>
    <span class="directive">public</span> <span class="predefined-type">ClassLoader</span> getNewTempClassLoader();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The enum
<em>jakarta.persistence.spi.PersistenceUnitTransactionType</em> defines whether
the entity managers created by the factory will be JTA or resource-local
entity managers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.EntityManagerFactory</span>;

<span class="comment">/**
 * Specifies whether entity managers created by the {@link
 * EntityManagerFactory} will be JTA or
 * resource-local entity managers.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> PersistenceUnitTransactionType {

    <span class="comment">/** JTA entity managers will be created. */</span>
    JTA,

    <span class="comment">/** Resource-local entity managers will be created. */</span>
    RESOURCE_LOCAL
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The enum <em>jakarta.persistence.SharedCacheMode</em>
defines the use of caching. The <em>persistence.xml</em> <em>shared-cache-mode</em>
element has no default value. The <em>getSharedCacheMode</em> method must
return <em>UNSPECIFIED</em> if the <em>shared-cache-mode</em> element has not been
specified for the persistence unit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.PersistenceUnitInfo</span>;

<span class="comment">/**
 * Specifies how the provider must use a second-level cache for the
 * persistence unit.  Corresponds to the value of the &lt;code&gt;persistence.xml&lt;/code&gt;
 * &lt;code&gt;shared-cache-mode&lt;/code&gt; element, and returned as the result of
 * {@link PersistenceUnitInfo#getSharedCacheMode()}.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> SharedCacheMode {

    <span class="comment">/**
     * All entities and entity-related state and data are cached.
     */</span>
    ALL,

    <span class="comment">/**
     * Caching is disabled for the persistence unit.
     */</span>
    NONE,

    <span class="comment">/**
     * Caching is enabled for all entities for &lt;code&gt;Cacheable(true)&lt;/code&gt;
     * is specified.  All other entities are not cached.
     */</span>
    ENABLE_SELECTIVE,

    <span class="comment">/**
     * Caching is enabled for all entities except those for which
     * &lt;code&gt;Cacheable(false)&lt;/code&gt; is specified.  Entities for which
     * &lt;code&gt;Cacheable(false)&lt;/code&gt; is specified are not cached.
     */</span>
    DISABLE_SELECTIVE,

    <span class="comment">/**
     *
     * Caching behavior is undefined: provider-specific defaults may apply.
     */</span>
    UNSPECIFIED
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The enum <em>jakarta.persistence.ValidationMode</em>
defines the validation mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * The validation mode to be used by the provider for the persistence
 * unit.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">enum</span> ValidationMode {

    <span class="comment">/**
     * If a Bean Validation provider is present in the environment,
     * the persistence provider must perform the automatic validation
     * of entities.  If no Bean Validation provider is present in the
     * environment, no lifecycle event validation takes place.
     * This is the default behavior.
     */</span>
    AUTO,

    <span class="comment">/**
     * The persistence provider must perform the lifecycle event
     * validation.  It is an error if there is no Bean Validation
     * provider present in the environment.
     */</span>
    CALLBACK,

    <span class="comment">/**
     * The persistence provider must not perform lifecycle event validation.
     */</span>
    NONE
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="jakarta-persistence-spi-classtransformer-interface"><a class="anchor" href="#jakarta-persistence-spi-classtransformer-interface"></a>9.6.1. jakarta.persistence.spi.ClassTransformer Interface</h4>
<div class="paragraph">
<p>The <em>jakarta.persistence.spi.ClassTransformer</em>
interface is implemented by a persistence provider that wants to
transform entities and managed classes at class load time or at class
redefinition time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence.spi</span>;

<span class="keyword">import</span> <span class="include">java.security.ProtectionDomain</span>;
<span class="keyword">import</span> <span class="include">java.lang.instrument.IllegalClassFormatException</span>;

<span class="comment">/**
 * A persistence provider supplies an instance of this
 * interface to the {@link PersistenceUnitInfo#addTransformer
 * PersistenceUnitInfo.addTransformer}
 * method. The supplied transformer instance will get
 * called to transform entity class files when they are
 * loaded or redefined. The transformation occurs before
 * the class is defined by the JVM.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ClassTransformer</span> {

    <span class="comment">/**
     * Invoked when a class is being loaded or redefined.
     * The implementation of this method may transform the
     * supplied class file and return a new replacement class
     * file.
     *
     * @param loader  the defining loader of the class to be
     *        transformed, may be null if the bootstrap loader
     * @param className  the name of the class in the internal form
     *        of fully qualified class and interface names
     * @param classBeingRedefined  if this is a redefine, the
     *        class being redefined, otherwise null
     * @param protectionDomain  the protection domain of the
     *        class being defined or redefined
     * @param classfileBuffer  the input byte buffer in class
     *        file format - must not be modified
     * @return a well-formed class file buffer (the result of
     *         the transform), or null if no transform is performed
     * @throws IllegalClassFormatException  if the input does
     *         not represent a well-formed class file
     */</span>
    <span class="type">byte</span><span class="type">[]</span> transform(<span class="predefined-type">ClassLoader</span> loader,
                     <span class="predefined-type">String</span> className,
                     <span class="predefined-type">Class</span>&lt;?&gt; classBeingRedefined,
                     <span class="predefined-type">ProtectionDomain</span> protectionDomain,
                     <span class="type">byte</span><span class="type">[]</span> classfileBuffer)
        <span class="directive">throws</span> <span class="exception">IllegalClassFormatException</span>;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13443"><a class="anchor" href="#a13443"></a>9.7. jakarta.persistence.Persistence Class</h3>
<div class="paragraph">
<p>The <em>Persistence</em> class is used to obtain an
<em>EntityManagerFactory</em> instance in Java SE environments. It may also be
used for schema generation— i.e., to create database schemas and/or
tables and/or to create DDL scripts.</p>
</div>
<div class="paragraph">
<p>The <em>Persistence</em> class is available in a
Jakarta EE container environment as well; however, support for the Java SE
bootstrapping APIs is not required in container environments.</p>
</div>
<div class="paragraph">
<p>The <em>Persistence</em> class is used to obtain a
<em>PersistenceUtil</em> instance in both Jakarta EE and Java SE environments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">java.util.HashSet</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.PersistenceProvider</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.PersistenceProviderResolver</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.PersistenceProviderResolverHolder</span>;
<span class="keyword">import</span> <span class="include">jakarta.persistence.spi.LoadState</span>;

<span class="comment">/**
 * Bootstrap class that is used to obtain an {@link EntityManagerFactory}
 * in Java SE environments.  It may also be used to cause schema
 * generation to occur.
 *
 * &lt;p&gt; The &lt;code&gt;Persistence&lt;/code&gt; class is available in a Jakarta EE
 * container environment as well; however, support for the Java SE
 * bootstrapping APIs is not required in container environments.
 *
 * &lt;p&gt; The &lt;code&gt;Persistence&lt;/code&gt; class is used to obtain a {@link
 * PersistenceUtil PersistenceUtil} instance in both
 * Jakarta EE and Java SE environments.
 *
 * @since 1.0
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Persistence</span> {

    <span class="comment">/**
     * Create and return an EntityManagerFactory for the named
     * persistence unit.
     *
     * @param persistenceUnitName
     *            the name of the persistence unit
     * @return the factory that creates EntityManagers configured according to
     *         the specified persistence unit
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> EntityManagerFactory createEntityManagerFactory(<span class="predefined-type">String</span> persistenceUnitName) {
        <span class="keyword">return</span> createEntityManagerFactory(persistenceUnitName, <span class="predefined-constant">null</span>);
    }

    <span class="comment">/**
     * Create and return an EntityManagerFactory for the named persistence unit
     * using the given properties.
     *
     * @param persistenceUnitName
     *            the name of the persistence unit
     * @param properties
     *            Additional properties to use when creating the factory.
     *            These properties may include properties to control
     *            schema generation.  The values of these properties override
     *            any values that may have been configured elsewhere.
     * @return the factory that creates EntityManagers configured according to
     *         the specified persistence unit.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> EntityManagerFactory createEntityManagerFactory(<span class="predefined-type">String</span> persistenceUnitName, <span class="predefined-type">Map</span> properties) {

        EntityManagerFactory emf = <span class="predefined-constant">null</span>;
        PersistenceProviderResolver resolver = PersistenceProviderResolverHolder.getPersistenceProviderResolver();

        <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; providers = resolver.getPersistenceProviders();

        <span class="keyword">for</span> (PersistenceProvider provider : providers) {
            emf = provider.createEntityManagerFactory(persistenceUnitName, properties);
            <span class="keyword">if</span> (emf != <span class="predefined-constant">null</span>) {
                <span class="keyword">break</span>;
            }
        }
        <span class="keyword">if</span> (emf == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> PersistenceException(<span class="string"><span class="delimiter">&quot;</span><span class="content">No Persistence provider for EntityManager named </span><span class="delimiter">&quot;</span></span> + persistenceUnitName);
        }
        <span class="keyword">return</span> emf;
    }


    <span class="comment">/**
     * Create database schemas and/or tables and/or create DDL
     * scripts as determined by the supplied properties.
     * &lt;p&gt;
     * Called when schema generation is to occur as a separate phase
     * from creation of the entity manager factory.
     * &lt;p&gt;
     * @param persistenceUnitName the name of the persistence unit
     * @param map properties for schema generation;  these may
     *             also contain provider-specific properties.  The
     *             value of these properties override any values that
     *             may have been configured elsewhere..
     * @throws PersistenceException if insufficient or inconsistent
     *         configuration information is provided or if schema
     *         generation otherwise fails.
     *
     * @since 2.1
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> generateSchema(<span class="predefined-type">String</span> persistenceUnitName, <span class="predefined-type">Map</span> map) {
        PersistenceProviderResolver resolver = PersistenceProviderResolverHolder.getPersistenceProviderResolver();
        <span class="predefined-type">List</span>&lt;PersistenceProvider&gt; providers = resolver.getPersistenceProviders();

        <span class="keyword">for</span> (PersistenceProvider provider : providers) {
            <span class="keyword">if</span> (provider.generateSchema(persistenceUnitName, map)) {
                <span class="keyword">return</span>;
            }
        }

        <span class="keyword">throw</span> <span class="keyword">new</span> PersistenceException(<span class="string"><span class="delimiter">&quot;</span><span class="content">No Persistence provider to generate schema named </span><span class="delimiter">&quot;</span></span> + persistenceUnitName);
    }


    <span class="comment">/**
     * Return the PersistenceUtil instance
     * @return PersistenceUtil instance
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> PersistenceUtil getPersistenceUtil() {
       <span class="comment">// ...</span>
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>properties</em> argument passed to the
<em>createEntityManagerFactory</em> method is used to specify both standard and
vendor-specific properties and hints intended for use in creating the
entity manager factory.</p>
</div>
<div class="paragraph">
<p>The following properties correspond to the
elements and properties in the <em>persistence.xml</em> file. When any of these
properties are specified in the Map parameter passed to the
<em>createEntityManagerFactory</em> method, their values override the values of
the corresponding elements and properties in the <em>persistence.xml</em> file
for the named persistence unit. They also override any defaults that the
persistence provider might have applied.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.lock.timeout</em> — integer
value in milliseconds for pessimistic lock timeout or string
corresponding to integer value. This corresponds to the property of the
same name in the <em>persistence.xml</em>, and is a hint only. See <a href="#a2132">Section 3.4.4.3</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.query.timeout</em> — integer
value in milliseconds for query timeout or string corresponding to
integer value. This corresponds to the property of the same name in the
<em>persistence.xml</em>, and is a hint only. See <a href="#a4391">Section 3.10.10</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.provider</em> — string
corresponding to the <em>provider</em> element in the pe <em>rsistence.xml</em>. See
<a href="#a12300">Section 8.2.1.4</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.transactionType</em> — string
corresponding to the <em>transaction-type</em> attribute in the
<em>persistence.xml</em>. See <a href="#a12296">Section 8.2.1.2</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.jtaDataSource</em> — string
corresponding to the <em>jta-data-source</em> element in the <em>persistence.xml</em>.
See <a href="#a12302">Section 8.2.1.5</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.nonJtaDataSource</em> —
string corresponding to the <em>non-jta-data-source</em> element in the
<em>persistence.xml</em>. See <a href="#a12302">Section 8.2.1.5</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.sharedCache.mode</em>
— string corresponding to the <em>shared-cache-mode</em> element in the
<em>persistence.xml</em>. See <a href="#a12380">Section 8.2.1.7</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.validation.mode</em> — string
corresponding to the <em>validation-mode</em> element in the <em>persistence.xml</em></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The value is " <em>auto</em> ", " <em>callback</em> ", or " <em>none</em> ". See
<a href="#a12382">Section 8.2.1.8</a> and <a href="#a2374">Section 3.6.1.1</a>.</p>
</li>
</ol>
</div>
</li>
<li>
<p><em>jakarta.persistence.validation.group.pre-persist</em> — string corresponding
to the <em>jakarta.persistence.validation.group.pre-persist</em> property in the
<em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a> and <a href="#a2380">Section 3.6.1.2</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.validation.group.pre-update</em> — string corresponding
to the <em>jakarta.persistence.validation.group.pre-update</em> property in the
<em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a> and <a href="#a2380">Section 3.6.1.2</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.validation.group.pre-remove</em> — string corresponding
to the <em>jakarta.persistence.validation.group.pre-remove</em> property in the
<em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a> and <a href="#a2380">Section 3.6.1.2</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.create-script-source</em> — string
corresponding to the
<em>jakarta.persistence.schema-generation.create-script-source</em> property in
the <em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.drop-script-source</em> — string
corresponding to the
<em>jakarta.persistence.schema-generation.drop-script-source</em> property in
the <em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.sql-load-script-source</em> —
string corresponding to the <em>jakarta.persistence.sql-load-script-source</em>
property in the <em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.database.action</em> — string
corresponding to the
<em>jakarta.persistence.schema-generation.database.action</em> property in the
<em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.scripts.action</em> — string
corresponding to the
<em>jakarta.persistence.schema-generation.scripts.action</em> property in the
<em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.create-source</em> — string
corresponding to the <em>jakarta.persistence.schema-generation.create-source</em>
property in the <em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.drop-source</em> — string corresponding
to the <em>jakarta.persistence.schema-generation.drop-source</em> property in
the <em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.scripts.create-target</em> —string
corresponding to the
<em>jakarta.persistence.schema-generation.scripts.create-target</em> property in
the <em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
<li>
<p><em>jakarta.persistence.schema-generation.scripts.drop-target</em> — string
corresponding to the
<em>jakarta.persistence.schema-generation.scripts.drop-target</em> property in
the <em>persistence.xml</em>. See <a href="#a12384">Section 8.2.1.9</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following additional standard properties
are defined by this specification for the configuration of the entity
manager factory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>jakarta.persistence.jdbc.driver</em> — value is
the fully qualified name of the driver class.</p>
</li>
<li>
<p><em>jakarta.persistence.jdbc.url</em> — string
corresponding to the driver-specific URL.</p>
</li>
<li>
<p><em>jakarta.persistence.jdbc.user</em> — value is the
username used by database connection.</p>
</li>
<li>
<p><em>jakarta.persistence.jdbc.password</em> — value is
the password for database connection validation.</p>
</li>
<li>
<p><em>jakarta.persistence.dataSource</em> — value is
instance of <em>javax.sql.DataSource</em> to be used for the specified
persistence unit.</p>
</li>
<li>
<p><em>jakarta.persistence.validation.factory</em> —
value is instance of <em>jakarta.validation.ValidatorFactory</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any number of vendor-specific properties may
also be included in the map. If a persistence provider does not
recognize a property (other than a property defined by this
specification), the provider must ignore it.</p>
</div>
<div class="paragraph">
<p>Vendors should use vendor namespaces for
properties (e.g., <em>com.acme.persistence.logging</em>). Entries that make
use of the namespace <em>jakarta.persistence</em> and its subnamespaces must not
be used for vendor-specific information. The namespace
<em>jakarta.persistence</em> is reserved for use by this specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="persistenceutil-interface"><a class="anchor" href="#persistenceutil-interface"></a>9.8. PersistenceUtil Interface</h3>
<div class="paragraph">
<p>This interface is used to determine load
state. The semantics of the methods of this interface are defined in
<a href="#a13592">Section 9.8.1</a> below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jakarta.persistence</span>;

<span class="comment">/**
 * Utility interface between the application and the persistence
 * provider(s).
 *
 * &lt;p&gt; The &lt;code&gt;PersistenceUtil&lt;/code&gt; interface instance obtained from the
 * {@link Persistence} class is used to determine the load state of an
 * entity or entity attribute regardless of which persistence
 * provider in the environment created the entity.
 *
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceUtil</span> {

    <span class="comment">/**
     * Determine the load state of a given persistent attribute.
     * @param entity  entity containing the attribute
     * @param attributeName name of attribute whose load state is
     *        to be determined
     * @return false if entity's state has not been loaded or
     *  if the attribute state has not been loaded, else true
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity, <span class="predefined-type">String</span> attributeName);

    <span class="comment">/**
     * Determine the load state of an entity.
     * This method can be used to determine the load state
     * of an entity passed as a reference.  An entity is
     * considered loaded if all attributes for which
     * &lt;code&gt;FetchType.EAGER&lt;/code&gt; has been specified have been loaded.
     * &lt;p&gt; The &lt;code&gt;isLoaded(Object, String)&lt;/code&gt; method should be used to
     * determine the load state of an attribute.
     * Not doing so might lead to unintended loading of state.
     * @param entity whose load state is to be determined
     * @return false if the entity has not been loaded, else true
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isLoaded(<span class="predefined-type">Object</span> entity);
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="a13592"><a class="anchor" href="#a13592"></a>9.8.1. Contracts for Determining the Load State of an Entity or Entity Attribute</h4>
<div class="paragraph">
<p>The implementation of the
<em>PersistenceUtil.isLoaded(Object)</em> method must determine the list of
persistence providers available in the runtime
environment<sup class="footnote">[<a id="_footnoteref_94" class="footnote" href="#_footnotedef_94" title="View footnote.">94</a>]</sup> and call the
<em>ProviderUtil.isLoaded(Object)</em> method on each of them until either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one provider returns <em>LoadState.LOADED</em>. In
this case <em>PersistenceUtil.isLoaded</em> returns <em>true</em>.</p>
</li>
<li>
<p>one provider returns <em>LoadState.NOT_LOADED</em>.
In this case <em>PersistenceUtil.isLoaded</em> returns <em>false</em>.</p>
</li>
<li>
<p>all providers return <em>LoadState.UNKNOWN</em>. In
this case <em>PersistenceUtil.isLoaded</em> returns <em>true</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>PersistenceUtil</em> implementation
determines that only a single provider is available in the environment,
it is permitted to use provider-specific methods to determine the result
of <em>isLoaded(Object)</em> as long as the semantics defined in <a href="#a2019">Section 3.2.9</a> are observed.</p>
</div>
<div class="paragraph">
<p>The implementation of the
<em>PersistenceUtil.isLoaded(Object,String)</em> method must determine the list
of persistence providers available in the environment and call the
<em>ProviderUtil.isLoadedWithoutReference</em> method on each of them until
either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one provider returns <em>LoadState.LOADED</em>. In
this case <em>PersistenceUtil.isLoaded</em> returns <em>true</em>.</p>
</li>
<li>
<p>one provider returns <em>LoadState.NOT_LOADED</em>.
In this case <em>PersistenceUtil.isLoaded</em> returns <em>false</em>.</p>
</li>
<li>
<p>all providers return <em>LoadState.UNKNOWN</em>. In
this case, the <em>PersistenceUtil.isLoaded</em> method then calls
<em>ProviderUtil.isLoadedWithReference</em> on each of the providers until:</p>
<div class="ulist">
<ul>
<li>
<p>one provider returns <em>LoadState.LOADED</em>. In
this case <em>PersistenceUtil.isLoaded</em> return <em>true</em>.</p>
</li>
<li>
<p>one provider returns <em>LoadState.NOT_LOADED</em>.
In this case, <em>PersistenceUtil.isLoaded</em> returns <em>false</em>.</p>
</li>
<li>
<p>all providers return <em>LoadState.UNKNOWN</em>. In
this case, <em>PersistenceUtil.isLoaded</em> returns <em>true</em>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>PersistenceUtil</em> implementation
determines that only a single provider is available in the environment,
it is permitted to use provider specific methods to determine the result
of <em>isLoaded(Object, String)</em> as long as the semantics defined in
<a href="#a2019">Section 3.2.9</a> are observed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The rationale for splitting the
determination of load state between the methods isLoadedWithoutReference
and isLoadedWithReference is the following.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><em>It is assumed that the provider that loaded
the entity is present in the environment.</em></p>
</li>
<li>
<p><em>Providers that use bytecode enhancement
don&#8217;t need to access an attribute reference to determine its load state,
and can determine if the entity has been provided by them.</em></p>
</li>
<li>
<p><em>By first querying all providers using
bytecode enhancement, it is insured that no attribute will be loaded by
side effect.</em></p>
</li>
<li>
<p><em>Proxy-based providers do need to access an
attribute reference to determine load state, but will not trigger
attribute loading as a side effect.</em></p>
</li>
<li>
<p><em>If no provider recognizes an entity as
provided by it, it is assumed to be an object that is not instrumented
and is considered loaded.</em></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="metadata-annotations"><a class="anchor" href="#metadata-annotations"></a>10. Metadata Annotations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter and chapter <a href="#a13915">Chapter 11</a>
define the metadata annotations introduced by this specification.</p>
</div>
<div class="paragraph">
<p>The XML schema defined in chapter
<a href="#a16944">Chapter 12</a> provides an alternative to the use of metadata annotations.</p>
</div>
<div class="paragraph">
<p>These annotations and types are in the package <em>jakarta.persistence</em>.</p>
</div>
<div class="sect2">
<h3 id="entity"><a class="anchor" href="#entity"></a>10.1. Entity</h3>
<div class="paragraph">
<p>The <em>Entity</em> annotation specifies that the
class is an entity. This annotation is applied to the entity class.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> annotation element specifies the
entity name. If the <em>name</em> element is not specified, the entity name
defaults to the unqualified name of the entity class. This name is used
to refer to the entity in queries.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Documented</span>
<span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">Entity</span> {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="callback-annotations"><a class="anchor" href="#callback-annotations"></a>10.2. Callback Annotations</h3>
<div class="paragraph">
<p>The <em>EntityListeners</em> annotation specifies
the callback listener classes to be used for an entity or mapped
superclass. The <em>EntityListeners</em> annotation may be applied to an entity
class or mapped superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> EntityListeners {
    <span class="predefined-type">Class</span><span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ExcludeSuperclassListeners annotation
specifies that the invocation of superclass listeners is to be excluded
for the entity class (or mapped superclass) and its subclasses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ExcludeSuperclassListeners {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ExcludeDefaultListeners annotation
specifies that the invocation of default listeners is to be excluded for
the entity class (or mapped superclass) and its subclasses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ExcludeDefaultListeners {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following annotations are used to specify
callback methods for the corresponding lifecycle events. These
annotations may be applied to methods of an entity class, of a mapped
superclass, or of an entity listener class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PrePersist {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PostPersist {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PreRemove {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PostRemove {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PreUpdate {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PostUpdate {}

<span class="annotation">@Target</span>({METHOD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PostLoad {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13662"><a class="anchor" href="#a13662"></a>10.3. EntityGraph Annotations</h3>
<div class="sect3">
<h4 id="namedentitygraph-and-namedentitygraphs-annotations"><a class="anchor" href="#namedentitygraph-and-namedentitygraphs-annotations"></a>10.3.1. NamedEntityGraph and NamedEntityGraphs Annotations</h4>
<div class="paragraph">
<p>The <em>NamedEntityGraph</em> annotation is used to
define a named entity graph. The entity graph may be retrieved by name
using the <em>EntityManagerFactory</em> interface. The entity graph may be used
to specify the path and boundaries for <em>find</em> operations or queries.</p>
</div>
<div class="paragraph">
<p>The <em>NamedEntityGraph</em> annotation must be
applied to the entity class that forms the root of the corresponding
graph of entities.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> element is used to refer to the
entity graph. It defaults to the entity name of the root entity to which
the annotation is applied. Entity graph names must be unique within the
persistence unit.</p>
</div>
<div class="paragraph">
<p>The <em>attributeNodes</em> element lists attributes
of the annotated entity class that are to be included in the entity
graph.</p>
</div>
<div class="paragraph">
<p>The <em>includeAllAttributes</em> element specifies
that all attributes of the annotated entity class are to be included in
the entity graph. An <em>attributeNode</em> element may still be used in
conjunction with this element to specify a subgraph for the attribute.</p>
</div>
<div class="paragraph">
<p>The <em>subgraphs</em> element specifies a list of
subgraphs, further specifying attributes that are managed types. These
subgraphs are referenced by name from <em>NamedAttributeNode</em> definitions.</p>
</div>
<div class="paragraph">
<p>The <em>subclassSubgraphs</em> element specifies a
list of subgraphs that add additional attributes for subclasses of the
root entity to which the annotation is applied.</p>
</div>
<div class="paragraph">
<p>The <em>NamedEntityGraphs</em> annotation can be
used to specify multiple named entity graphs for the entity to which it
is applied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(NamedEntityGraphs.class)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedEntityGraph {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    NamedAttributeNode<span class="type">[]</span> attributeNodes() <span class="keyword">default</span> {};
    <span class="type">boolean</span> includeAllAttributes() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    NamedSubgraph<span class="type">[]</span> subgraphs() <span class="keyword">default</span> {};
    NamedSubgraph<span class="type">[]</span> subclassSubgraphs() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedEntityGraphs {
    NamedEntityGraph<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="namedattributenode-annotation"><a class="anchor" href="#namedattributenode-annotation"></a>10.3.2. NamedAttributeNode Annotation</h4>
<div class="paragraph">
<p>The <em>NamedAttributeNode</em> annotation is used
to specify an attribute node of within an entity graph or subgraph.</p>
</div>
<div class="paragraph">
<p>The <em>value</em> element specifies the name of the
corresponding attribute.</p>
</div>
<div class="paragraph">
<p>The <em>subgraph</em> element is used to refer to a
<em>NamedSubgraph</em> specification that further characterizes an attribute
node corresponding to a managed type (entity or embeddable). The value
of the <em>subgraph</em> element must correspond to the <em>name</em> used for the
subgraph in the <em>NamedSubgraph</em> element. If the referenced attribute is
an entity which has entity subclasses, there may be more than one
<em>NamedSubgraph</em> element with this name, and the <em>subgraph</em> element is
considered to refer to all of these.</p>
</div>
<div class="paragraph">
<p>The <em>keySubgraph</em> element is used to refer to
a <em>NamedSubgraph</em> specification that further characterizes an attribute
node corresponding to the key of a Map-valued attribute. The value of
the the <em>keySubgraph</em> element must correspond to the <em>name</em> used for the
subgraph in the <em>NamedSubgraph</em> element. If the referenced attribute is
an entity which has entity subclasses, there may be more than one
<em>NamedSubgraph</em> element with this name, and the <em>keySubgraph</em> element is
considered to refer to all of these.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedAttributeNode {
    <span class="predefined-type">String</span> value();
    <span class="predefined-type">String</span> subgraph() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> keySubgraph() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="namedsubgraph-annotation"><a class="anchor" href="#namedsubgraph-annotation"></a>10.3.3. NamedSubgraph Annotation</h4>
<div class="paragraph">
<p>The <em>NamedSubgraph</em> annotation is used to
further define an attribute node. It is referenced by its name from the
<em>subgraph</em> or <em>keySubgraph</em> element of a <em>NamedAttributeNode</em> element.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> element is the name used to
reference the subgraph from a <em>NamedAttributeNode</em> definition. In the
case of entity inheritance, multiple subgraph elements have the same
name.</p>
</div>
<div class="paragraph">
<p>The <em>type</em> element must be specified when the
subgraph corresponds to a subclass of the entity type corresponding to
the referencing attribute node.</p>
</div>
<div class="paragraph">
<p>The <em>attributeNodes</em> element lists attributes
of the class that must be included. If the subgraph corresponds to a
subclass of the class referenced by the corresponding attribute node,
only subclass-specific attributes are listed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedSubgraph {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">Class</span> type() <span class="keyword">default</span> <span class="type">void</span>.class;
    NamedAttributeNode<span class="type">[]</span> attributeNodes();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13710"><a class="anchor" href="#a13710"></a>10.4. Annotations for Queries</h3>
<div class="sect3">
<h4 id="a13711"><a class="anchor" href="#a13711"></a>10.4.1. NamedQuery Annotation</h4>
<div class="paragraph">
<p>The <em>NamedQuery</em> annotation is used to
specify a named query in the Jakarta Persistence query language.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> element is used to refer to the
query when using the <em>EntityManager</em> methods that create query objects.</p>
</div>
<div class="paragraph">
<p>The <em>query</em> element must specify a query
string in the Jakarta Persistence query language.</p>
</div>
<div class="paragraph">
<p>The <em>lockMode</em> element specifies a lock mode
for the results returned by the query. If a lock mode other than <em>NONE</em>
is specified, the query must be executed within a transaction and the
persistence context joined to the transaction.</p>
</div>
<div class="paragraph">
<p>The <em>hints</em> elements may be used to specify
query properties and hints. Properties defined by this specification
must be observed by the provider; hints defined by this specification
should be observed by the provider when possible. Vendor-specific hints
that are not recognized by a provider must be ignored.</p>
</div>
<div class="paragraph">
<p>The <em>NamedQuery</em> and <em>NamedQueries</em>
annotations can be applied to an entity or mapped superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(NamedQueries.class)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedQuery {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> query();
    LockModeType lockMode() <span class="keyword">default</span> NONE;
    QueryHint<span class="type">[]</span> hints() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> QueryHint {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> value();
}

<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedQueries {
    NamedQuery<span class="type">[]</span> value ();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="namednativequery-annotation"><a class="anchor" href="#namednativequery-annotation"></a>10.4.2. NamedNativeQuery Annotation</h4>
<div class="paragraph">
<p>The <em>NamedNativeQuery</em> annotation is used to
specify a native SQL named query.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> element is used to refer to the
query when using the <em>EntityManager</em> methods that create query objects.</p>
</div>
<div class="paragraph">
<p>The <em>query</em> element specifies the native
query.</p>
</div>
<div class="paragraph">
<p>The <em>resultClass</em> element refers to the class
of the result; the value of the <em>resultSetMapping</em> element is the name
of a <em>SqlResultSetMapping</em> specification, as defined in metadata.</p>
</div>
<div class="paragraph">
<p>The <em>hints</em> elements may be used to specify
query properties and hints. Hints defined by this specification should
be observed by the provider when possible. Vendor-specific hints that
are not recognized by a provider must be ignored.</p>
</div>
<div class="paragraph">
<p>The <em>NamedNativeQuery</em> and
<em>NamedNativeQueries</em> annotations can be applied to an entity or mapped
superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(NamedNativeQueries.class)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedNativeQuery {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> query();
    QueryHint<span class="type">[]</span> hints() <span class="keyword">default</span> {};
    <span class="predefined-type">Class</span> resultClass() <span class="keyword">default</span> <span class="type">void</span>.class;
    <span class="predefined-type">String</span> resultSetMapping() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}

<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedNativeQueries {
    NamedNativeQuery<span class="type">[]</span> value ();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a13759"><a class="anchor" href="#a13759"></a>10.4.3. NamedStoredProcedureQuery Annotation</h4>
<div class="paragraph">
<p>The <em>NamedStoredProcedureQuery</em> annotation is
used to specify a stored procedure, its parameters, and its result type.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> element is the name that is passed
as an argument to the <em>createNamedStoredProcedureQuery</em> method to create
an executable <em>StoredProcedureQuery</em> object.</p>
</div>
<div class="paragraph">
<p>The <em>procedureName</em> element is the name of
the stored procedure in the database.</p>
</div>
<div class="paragraph">
<p>The parameters of the stored procedure are
specified by the <em>parameters</em> element. All parameters must be specified
in the order in which they occur in the parameter list of the stored
procedure.</p>
</div>
<div class="paragraph">
<p>The <em>resultClasses</em> element refers to the
class (or classes) that are used to map the results. The
<em>resultSetMappings</em> element names one or more result set mappings, as
defined by the <em>SqlResultSetMapping</em> annotation.</p>
</div>
<div class="paragraph">
<p>If there are multiple result sets, it is
assumed that they will be mapped using the same mechanism—e.g., either
all via a set of result class mappings or all via a set of result set
mappings. The order of the specification of these mappings must be the
same as the order in which the result sets will be returned by the
stored procedure invocation. If the stored procedure returns one or more
result sets and no <em>resultClasses</em> or <em>resultSetMappings</em> element is
specified, any result set will be returned as a list of type <em>Object[]</em>
. The combining of different strategies for the mapping of stored
procedure result sets is undefined.</p>
</div>
<div class="paragraph">
<p>The <em>hints</em> element may be used to specify
query properties and hints. Properties defined by this specification
must be observed by the provider. Vendor-specific hints that are not
recognized by a provider must be ignored.</p>
</div>
<div class="paragraph">
<p>The <em>NamedStoredProcedureQuery</em> and
<em>NamedStoredProcedureQueries</em> annotations can be applied to an entity or
mapped superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(NamedStoredProcedureQueries.class)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedStoredProcedureQuery {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> procedureName();
    StoredProcedureParameter<span class="type">[]</span> parameters() <span class="keyword">default</span> {};
    <span class="predefined-type">Class</span><span class="type">[]</span> resultClasses() <span class="keyword">default</span> {};
    <span class="predefined-type">String</span><span class="type">[]</span> resultSetMappings() <span class="keyword">default</span> {};
    QueryHint<span class="type">[]</span> hints() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NamedStoredProcedureQueries {
    NamedStoredProcedureQuery <span class="type">[]</span> value;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All parameters of a named stored procedure
query must be specified using the <em>StoredProcedureParameter</em> annotation.
The <em>name</em> element refers to the name of the parameter as defined by the
stored procedure in the database. If a parameter name is not specified,
it is assumed that the stored procedure uses positional parameters. The
<em>mode</em> element specifies whether the parameter is an IN, INOUT, OUT, or
REF_CURSOR parameter. REF_CURSOR parameters are used by some databases
to return result sets from stored procedures. The <em>type</em> element refers
to the JDBC type for the parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> StoredProcedureParameter {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ParameterMode mode() <span class="keyword">default</span> ParameterMode.IN;
    <span class="predefined-type">Class</span> type();
}

<span class="directive">public</span> <span class="type">enum</span> ParameterMode {
    IN,
    INOUT,
    OUT,
    REF_CURSOR
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a13797"><a class="anchor" href="#a13797"></a>10.4.4. Annotations for SQL Result Set Mappings</h4>
<div class="paragraph">
<p>The <em>SqlResultSetMapping</em> annotation is used
to specify the mapping of the result of a native SQL query or stored
procedure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(SqlResultSetMappings.class)
<span class="directive">public</span> <span class="annotation">@interface</span> SqlResultSetMapping {
    <span class="predefined-type">String</span> name();
    EntityResult<span class="type">[]</span> entities() <span class="keyword">default</span> {};
    ConstructorResult<span class="type">[]</span> classes() <span class="keyword">default</span> {};
    ColumnResult<span class="type">[]</span> columns() <span class="keyword">default</span> {};
}

<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> SqlResultSetMappings {
    SqlResultSetMapping<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>name</em> element is the name given to the
result set mapping, and is used to refer to it in the methods of the
<em>Query</em> and <em>StoredProcedureQuery</em> APIs. The <em>entities</em>, <em>classes</em>,
and <em>columns</em> elements are used to specify the mapping to entities,
constructors, and to scalar values respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> EntityResult {
    <span class="predefined-type">Class</span> entityClass();
    FieldResult<span class="type">[]</span> fields() <span class="keyword">default</span> {};
    <span class="predefined-type">String</span> discriminatorColumn() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>entityClass</em> element specifies the class
of the result.</p>
</div>
<div class="paragraph">
<p>The <em>fields</em> element is used to map the
columns specified in the SELECT list of the query to the properties or
fields of the entity class.</p>
</div>
<div class="paragraph">
<p>The <em>discriminatorColumn</em> element is used to
specify the column name (or alias) of the column in the SELECT list that
is used to determine the type of the entity instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> FieldResult {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> column();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>name</em> element is the name of the
persistent field or property of the class.</p>
</div>
<div class="paragraph">
<p>The <em>column</em> element specifies the name of
the corresponding column in the SELECT list—i.e., column alias, if
applicable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>(value={})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ConstructorResult {
    <span class="predefined-type">Class</span> targetClass();
    ColumnResult<span class="type">[]</span> columns();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>targetClass</em> element specifies the class
whose constructor is to be invoked.</p>
</div>
<div class="paragraph">
<p>The <em>columns</em> element specifies the mapping
of columns in the SELECT list to the arguments of the intended
constructor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ColumnResult {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">Class</span> type() <span class="keyword">default</span> <span class="type">void</span>.class;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>name</em> element specifies the name of the
column in the SELECT list.</p>
</div>
<div class="paragraph">
<p>The <em>type</em> element specifies the Java type to
which the column type is to be mapped. If the <em>type</em> element is not
specified, the default JDBC type mapping for the column will be used.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-to-entitymanager-and-entitymanagerfactory"><a class="anchor" href="#references-to-entitymanager-and-entitymanagerfactory"></a>10.5. References to EntityManager and EntityManagerFactory</h3>
<div class="paragraph">
<p>These annotations are used to express
dependencies on entity managers and entity manager factories.</p>
</div>
<div class="sect3">
<h4 id="persistencecontext-annotation"><a class="anchor" href="#persistencecontext-annotation"></a>10.5.1. PersistenceContext Annotation</h4>
<div class="paragraph">
<p>The <em>PersistenceContext</em> annotation is used
to express a dependency on a container-managed entity manager and its
associated persistence context.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> element refers to the name by
which the entity manager is to be accessed in the environment
referencing context, and is not needed when dependency injection is
used.</p>
</div>
<div class="paragraph">
<p>The optional <em>unitName</em> element refers to the
name of the persistence unit. If the <em>unitName</em> element is specified,
the persistence unit for the entity manager that is accessible in JNDI
must have the same name.</p>
</div>
<div class="paragraph">
<p>The <em>type</em> element specifies whether a
transaction-scoped or extended persistence context is to be used. If the
<em>type</em> element is not specified, a transaction-scoped persistence
context is used.</p>
</div>
<div class="paragraph">
<p>The <em>synchronizationType</em> element specifies
whether the persistence context is always automatically synchronized
with the current transaction or whether the persistence context must be
explicitly joined to the current transaction by means of the
EntityManager <em>joinTransaction</em> method.</p>
</div>
<div class="paragraph">
<p>The optional <em>properties</em> element may be used
to specify properties for the container or persistence provider.
Properties defined by this specification must be observed by the
provider. Vendor specific properties may be included in the set of
properties, and are passed to the persistence provider by the container
when the entity manager is created. Properties that are not recognized
by a vendor must be ignored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(PersistenceContexts.class)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceContext {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> unitName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    PersistenceContextType type() <span class="keyword">default</span> TRANSACTION;
    SynchronizationType synchronization() <span class="keyword">default</span> SYNCHRONIZED;
    PersistenceProperty<span class="type">[]</span> properties() <span class="keyword">default</span> {};
}

<span class="directive">public</span> <span class="type">enum</span> PersistenceContextType {
    TRANSACTION,
    EXTENDED
}

<span class="directive">public</span> <span class="type">enum</span> SynchronizationType {
    SYNCHRONIZED,
    UNSYNCHRONIZED
}

<span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceProperty {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>PersistenceContexts</em> annotation declares
one or more <em>PersistenceContext</em> annotations. It is used to express a
dependency on multiple persistence contexts<sup class="footnote">[<a id="_footnoteref_95" class="footnote" href="#_footnotedef_95" title="View footnote.">95</a>]</sup>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceContexts {
    PersistenceContext<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a13887"><a class="anchor" href="#a13887"></a>10.5.2. PersistenceUnit Annotation</h4>
<div class="paragraph">
<p>The <em>PersistenceUnit</em> annotation is used to
express a dependency on an entity manager factory and its associated
persistence unit.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> element refers to the name by
which the entity manager factory is to be accessed in the environment
referencing context, and is not needed when dependency injection is
used.</p>
</div>
<div class="paragraph">
<p>The optional <em>unitName</em> element refers to the
name of the persistence unit as defined in the <em>persistence.xml</em> file.
If the <em>unitName</em> element is specified, the persistence unit for the
entity manager factory that is accessible in JNDI must have the same
name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(PersistenceUnits.class)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceUnit {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> unitName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>PersistenceUnits</em> annotation declares
one or more <em>PersistenceUnit</em> annotations. It is used to express a
dependency on multiple persistence units<sup class="footnote">[<a id="_footnoteref_96" class="footnote" href="#_footnotedef_96" title="View footnote.">96</a>]</sup>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PersistenceUnits {
    PersistenceUnit<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a13903"><a class="anchor" href="#a13903"></a>10.6. Annotations for Type Converter Classes</h3>
<div class="paragraph">
<p>The <em>Converter</em> annotation specifies that the
annotated class is a converter and defines its scope. A converter class
must be annotated with the <em>Converter</em> annotation or defined in the XML
descriptor as a converter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Converter {
    <span class="type">boolean</span> autoApply() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <em>autoApply</em> element is specified as
<em>true</em>, the persistence provider must automatically apply the converter
to all mapped attributes of the specified target type for all entities
in the persistence unit except for attributes for which conversion is
overridden by means of the <em>Convert</em> annotation (or XML equivalent). The
<em>Convert</em> annotation is described in <a href="#a14398">Section 11.1.10</a>.</p>
</div>
<div class="paragraph">
<p>In determining whether a converter is
applicable to an attribute, the provider must treat primitive types and
wrapper types as equivalent.</p>
</div>
<div class="paragraph">
<p>Note that Id attributes, version attributes,
relationship attributes, and attributes explicitly annotated as
<em>Enumerated</em> or <em>Temporal</em> (or designated as such via XML) will not be
converted.</p>
</div>
<div class="paragraph">
<p>If <em>autoApply</em> is <em>false</em>, only those
attributes of the target type for which the <em>Convert</em> annotation (or
corresponding XML element) has been specified will be converted.</p>
</div>
<div class="paragraph">
<p>Note that if <em>autoApply</em> is <em>true</em>, the
<em>Convert</em> annotation may be used to override or disable auto-apply
conversion on a per-attribute basis.</p>
</div>
<div class="paragraph">
<p>If there is more than one converter defined
for the same target type, the <em>Convert</em> annotation should be used to
explicitly specify which converter to use.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a13915"><a class="anchor" href="#a13915"></a>11. Metadata for Object/Relational Mapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The object/relational mapping metadata is
part of the application domain model contract. It expresses requirements
and expectations on the part of the application as to the mapping of the
entities and relationships of the application domain to a database.
Queries (and, in particular, SQL queries) written against the database
schema that corresponds to the application domain model are dependent
upon the mappings expressed by means of the object/relational mapping
metadata. The implementation of this specification must assume this
application dependency upon the object/relational mapping metadata and
insure that the semantics and requirements expressed by that mapping are
observed.</p>
</div>
<div class="paragraph">
<p>The use of object/relational mapping metadata
to control schema generation is specified in <a href="#a16444">Section 11.2</a>.</p>
</div>
<div class="sect2">
<h3 id="annotations-for-objectrelational-mapping"><a class="anchor" href="#annotations-for-objectrelational-mapping"></a>11.1. Annotations for Object/Relational Mapping</h3>
<div class="paragraph">
<p>These annotations and types are in the
package <em>jakarta.persistence</em>.</p>
</div>
<div class="paragraph">
<p>XML metadata may be used as an alternative to
these annotations, or to override or augment annotations, as described
in <a href="#a16944">Chapter 12</a>.</p>
</div>
<div class="sect3">
<h4 id="access-annotation"><a class="anchor" href="#access-annotation"></a>11.1.1. Access Annotation</h4>
<div class="paragraph">
<p>The <em>Access</em> annotation is used to specify an
access type to be applied to an entity class, mapped superclass, or
embeddable class, or to a specific attribute of such a class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Access {
    AccessType value();
}

<span class="directive">public</span> <span class="type">enum</span> AccessType {
    FIELD,
    PROPERTY
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a13935">Table 4</a> lists the annotation elements that may be specified
for the <em>Access</em> annotation.</p>
</div>
<table id="a13935" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Access Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AccessType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The access type to be applied to the class or attribute.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a13942"><a class="anchor" href="#a13942"></a>11.1.2. AssociationOverride Annotation</h4>
<div class="paragraph">
<p>The <em>AssociationOverride</em> annotation is used
to override a mapping for an entity relationship.</p>
</div>
<div class="paragraph">
<p>The <em>AssociationOverride</em> annotation may be
applied to an entity that extends a mapped superclass to override a
relationship mapping defined by the mapped superclass. If the
<em>AssociationOverride</em> annotation is not specified, the association is
mapped the same as in the original mapping. When used to override a
mapping defined by a mapped superclass, the <em>AssociationOverride</em>
annotation is applied to the entity class.</p>
</div>
<div class="paragraph">
<p>The <em>AssociationOverride</em> annotation may be
used to override a relationship mapping from an embeddable within an
entity to another entity when the embeddable is on the owning side of
the relationship. When used to override a relationship mapping defined
by an embeddable class (including an embeddable class embedded within
another embeddable class), the <em>AssociationOverride</em> annotation is
applied to the field or property containing the embeddable.</p>
</div>
<div class="paragraph">
<p>When the <em>AssociationOverride</em>
annotation is used to override a relationship mapping from an embeddable
class, the <em>name</em> element specifies the referencing relationship field
or property within the embeddable class. To override mappings at
multiple levels of embedding, a dot (".") notation syntax must be used
in the <em>name</em> element to indicate an attribute within an embedded
attribute. The value of each identifier used with the dot notation is
the name of the respective embedded field or property. When the
<em>AssociationOverride</em> annotation is applied to override the mappings of
an embeddable class used as a map value, " <em>value.</em> " must be used to
prefix the name of the attribute within the embeddable class that is
being overridden in order to specify it as part of the map
value.<sup class="footnote">[<a id="_footnoteref_97" class="footnote" href="#_footnotedef_97" title="View footnote.">97</a>]</sup></p>
</div>
<div class="paragraph">
<p>If the relationship mapping is a
foreign key mapping, the <em>joinColumns</em> element of the
<em>AssociationOverride</em> annotation is used. If the relationship mapping
uses a join table, the <em>joinTable</em> element of the <em>AssociationOverride</em>
element must be specified to override the mapping of the join table
and/or its join columns.<sup class="footnote">[<a id="_footnoteref_98" class="footnote" href="#_footnotedef_98" title="View footnote.">98</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <em>joinColumns</em> element refers to the table
for the class that contains the annotation.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <em>joinColumns</em> element when table generation is in
effect. If both this element and the <em>foreignKey</em> element of any of the
<em>joinColumns</em> elements are specified, the behavior is undefined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(AssociationOverrides.class)
<span class="directive">public</span> <span class="annotation">@interface</span> AssociationOverride {
    <span class="predefined-type">String</span> name();

    JoinColumn<span class="type">[]</span> joinColumns() <span class="keyword">default</span> {};

    ForeignKey foreignKey() <span class="keyword">default</span>

    <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    JoinTable joinTable() <span class="keyword">default</span> <span class="annotation">@JoinTable</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a13960">Table 5</a> lists the annotation elements
that may be specified for the <em>AssociationOverride</em> annotation.</p>
</div>
<table id="a13960" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. AssociationOverride Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The name of the relationship
property whose mapping is being overridden if property-based access is
being used, or the name of the relationship field if field-based access
is used.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
join column(s) being mapped to the persistent attribute(s). The
joinColumns element must be specified if a foreign key mapping is used
in the overriding of the mapping of the relationship. The joinColumns
element must not be specified if a join table is used in the overriding
of the mapping of the relationship</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinTable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joinTable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
join table that maps the relationship. The joinTable element must be
specified if a join table is used in the overriding of the mapping of
the relationship. The joinTable element must not be specified if a
foreign key mapping is used in the overriding of the mapping of the
relationship.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MappedSuperclass</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">protected</span> Address address;

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() { ... }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) { ... }

    <span class="directive">public</span> Address getAddress() { ... }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) { ... }
}

<span class="annotation">@Entity</span>
<span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">PartTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// address field mapping overridden to ADDR_ID foreign key</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WAGE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">protected</span> <span class="predefined-type">Float</span> hourlyWage;

    <span class="directive">public</span> <span class="predefined-type">Float</span> getHourlyWage() { ... }

    <span class="directive">public</span> <span class="type">void</span> setHourlyWage(<span class="predefined-type">Float</span> wage) { ... }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Overriding of the mapping for
the <em>phoneNumbers</em> relationship defined in the <em>ContactInfo</em> embeddable
class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@AssociationOverride</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">phoneNumbers</span><span class="delimiter">&quot;</span></span>,
        joinTable=<span class="annotation">@JoinTable</span>(
            name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPPHONES</span><span class="delimiter">&quot;</span></span>,
            joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP</span><span class="delimiter">&quot;</span></span>),
            inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PHONE</span><span class="delimiter">&quot;</span></span>)
        )
    )
    <span class="annotation">@Embedded</span>
    ContactInfo contactInfo;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContactInfo</span> {
    <span class="annotation">@ManyToOne</span> Address address; <span class="comment">// Unidirectional</span>
    <span class="annotation">@ManyToMany</span>(targetEntity=PhoneNumber.class)
    <span class="predefined-type">List</span> phoneNumbers;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneNumber</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> number;

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo.phoneNumbers</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Employee&gt; employees;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="associationoverrides-annotation"><a class="anchor" href="#associationoverrides-annotation"></a>11.1.3. AssociationOverrides Annotation</h4>
<div class="paragraph">
<p>The mappings of multiple relationship
properties or fields may be overridden. The <em>AssociationOverrides</em>
annotation can be used for this purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> AssociationOverrides {
    AssociationOverride<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14040">Table 6</a> lists the annotation elements
that may be specified for the <em>AssociationOverrides</em> annotation.</p>
</div>
<table id="a14040" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. AssociationOverrides Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AssociationOverride[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required)
The association override mappings that are to be applied to the
relationship field or property.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MappedSuperclass</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="annotation">@ManyToOne</span>
    <span class="directive">protected</span> Address address;

    <span class="annotation">@OneToOne</span>
    <span class="directive">protected</span> Locker locker;

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() { ... }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) { ... }

    <span class="directive">public</span> Address getAddress() { ... }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) { ... }

    <span class="directive">public</span> Locker getLocker() { ... }

    <span class="directive">public</span> <span class="type">void</span> setLocker(Locker locker) { ... }
}

<span class="annotation">@Entity</span>
<span class="annotation">@AssociationOverrides</span>({
    <span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>)),
    <span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">locker</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">LCKR_ID</span><span class="delimiter">&quot;</span></span>))})
<span class="directive">public</span> PartTimeEmployee { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>))
<span class="annotation">@AssociationOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">locker</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">LCKR_ID</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> PartTimeEmployee { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14084"><a class="anchor" href="#a14084"></a>11.1.4. AttributeOverride Annotation</h4>
<div class="paragraph">
<p>The <em>AttributeOverride</em> annotation is used to
override the mapping of a <em>Basic</em> (whether explicit or default) property
or field or <em>Id</em> property or field.</p>
</div>
<div class="paragraph">
<p>The <em>AttributeOverride</em> annotation may be
applied to an entity that extends a mapped superclass or to an embedded
field or property to override a <em>Basic</em> mapping or <em>Id</em> mapping defined
by the mapped superclass or embeddable class (or embeddable class of one
of its attributes).</p>
</div>
<div class="paragraph">
<p>The <em>AttributeOverride</em> annotation may be
applied to an element collection containing instances of an embeddable
class or to a map collection whose key and/or value is an embeddable
class. When the <em>AttributeOverride</em> annotation is applied to a map, "
<em>key.</em> " or " <em>value.</em> " must be used to prefix the name of the
attribute that is being overridden in order to specify it as part of the
map key or map value.</p>
</div>
<div class="paragraph">
<p>To override mappings at multiple levels of
embedding, a dot (".") notation form must be used in the <em>name</em> element
to indicate an attribute within an embedded attribute. The value of each
identifier used with the dot notation is the name of the respective
embedded field or property.</p>
</div>
<div class="paragraph">
<p>If the <em>AttributeOverride</em> annotation is not
specified, the column is mapped the same as in the original mapping.</p>
</div>
<div class="paragraph">
<p><a href="#a14100">Table 7</a> lists the annotation elements
that may be specified for the <em>AttributeOverride</em> annotation.</p>
</div>
<div class="paragraph">
<p>The <em>column</em> element refers to the table for
the class that contains the annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(AttributeOverrides.class)
<span class="directive">public</span> <span class="annotation">@interface</span> AttributeOverride {
    <span class="predefined-type">String</span> name();
    Column column();
}</code></pre>
</div>
</div>
<table id="a14100" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. AttributeOverride Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The name of the property whose
mapping is being overridden if property-based access is being used, or
the name of the field if field-based access is used.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The column that is being mapped
to the persistent attribute. The mapping type will remain the same as is
defined in the embeddable class or mapped superclass.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MappedSuperclass</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> version;

    <span class="directive">protected</span> <span class="predefined-type">String</span> address;

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() { ... }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) { ... }

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddress() { ... }

    <span class="directive">public</span> <span class="type">void</span> setAddress(<span class="predefined-type">String</span> address) { ... }
}

<span class="annotation">@Entity</span>
<span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">PartTimeEmployee</span> <span class="directive">extends</span> Employee {
    <span class="comment">// address field mapping overridden to ADDR</span>
    <span class="directive">protected</span> <span class="predefined-type">Float</span> wage();

    <span class="directive">public</span> <span class="predefined-type">Float</span> getHourlyWage() { ... }

    <span class="directive">public</span> <span class="type">void</span> setHourlyWage(<span class="predefined-type">Float</span> wage) { ... }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span> <span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> street;

    <span class="directive">protected</span> <span class="predefined-type">String</span> city;

    <span class="directive">protected</span> <span class="predefined-type">String</span> state;

    <span class="annotation">@Embedded</span>
    <span class="directive">protected</span> Zipcode zipcode;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Zipcode</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> zip;
    <span class="directive">protected</span> <span class="predefined-type">String</span> plusFour;
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">Integer</span> id;

    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">state</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_STATE</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode.zip</span><span class="delimiter">&quot;</span></span>, column= <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ZIP</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@Embedded</span>
    <span class="directive">protected</span> Address address;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PropertyRecord</span> {
    <span class="annotation">@EmbeddedId</span>
    PropertyOwner owner;

    <span class="annotation">@AttributeOverrides</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">key.street</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">STREET_NAME</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">value.size</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">SQUARE_FEET</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">value.tax</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ASSESSMENT</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@ElementCollection</span>
    <span class="predefined-type">Map</span>&lt;Address, PropertyInfo&gt; parcels;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PropertyInfo</span> {
    <span class="predefined-type">Integer</span> parcelNumber;
    <span class="predefined-type">Integer</span> size;
    <span class="predefined-type">BigDecimal</span> tax;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14178"><a class="anchor" href="#a14178"></a>11.1.5. AttributeOverrides Annotation</h4>
<div class="paragraph">
<p>The mappings of multiple properties or fields
may be overridden. The <em>AttributeOverrides</em> annotation can be used for
this purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> AttributeOverrides {
    AttributeOverride<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14187">Table 8</a> lists the annotation elements
that may be specified for the <em>AttributeOverrides</em> annotation.</p>
</div>
<table id="a14187" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. AttributeOverrides Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AttributeOverride[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required)
The AttributeOverride mappings that are to be applied to the field or
property.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@AttributeOverrides</span>({
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_START</span><span class="delimiter">&quot;</span></span>)),
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_END</span><span class="delimiter">&quot;</span></span>))
})
<span class="directive">public</span> EmploymentPeriod getEmploymentPeriod() { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14205"><a class="anchor" href="#a14205"></a>11.1.6. Basic Annotation</h4>
<div class="paragraph">
<p>The <em>Basic</em> annotation is the simplest type
of mapping to a database column. The <em>Basic</em> annotation can be applied
to a persistent property or instance variable of any of the following
types: Java primitive types, wrappers of the primitive types,
<em>java.lang.String</em>, <em>java.math.BigInteger</em>, <em>java.math.BigDecimal</em>,
<em>java.util.Date</em>, <em>java.util.Calendar</em>, <em>java.sql.Date</em>,
<em>java.sql.Time</em>, <em>java.sql.Timestamp</em>, <em>java.time.LocalDate</em>,
<em>java.time.LocalTime</em>, <em>java.time.LocalDateTime</em>,
<em>java.time.OffsetTime</em>, <em>java.time.OffsetDateTime</em>, <em>byte[]</em>,
<em>Byte[]</em>, <em>char[]</em>, <em>Character[]</em>, enums, and any other type that
implements <em>Serializable</em>.<sup class="footnote">[<a id="_footnoteref_99" class="footnote" href="#_footnotedef_99" title="View footnote.">99</a>]</sup></a>.] As described in <a href="#a511">Section 2.8</a>, the use of the <em>Basic</em>
annotation is optional for persistent fields and properties of these
types. If the <em>Basic</em> annotation is not specified for such a field or
property, the default values of the <em>Basic</em> annotation will apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Basic {
    FetchType fetch() <span class="keyword">default</span> EAGER;
    <span class="type">boolean</span> optional() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14218">Table 9</a> lists the annotation elements that may be specified
for the <em>Basic</em> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>The <em>FetchType</em> enum defines strategies for
fetching data from the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> FetchType { LAZY, EAGER };</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>EAGER</em> strategy is a requirement on the
persistence provider runtime that data must be eagerly fetched. The
<em>LAZY</em> strategy is a <em>hint</em> to the persistence provider runtime that
data should be fetched lazily when it is first accessed. The
implementation is permitted to eagerly fetch data for which the <em>LAZY</em>
strategy hint has been specified. In particular, lazy fetching might
only be available for <em>Basic</em> mappings for which property-based access
is used.</p>
</div>
<div class="paragraph">
<p>The <em>optional</em> element is a hint as to
whether the value of the field or property may be null. It is
disregarded for primitive types.</p>
</div>
<table id="a14218" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Basic Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the value of the field or
property should be lazily loaded or must be eagerly fetched. The EAGER
strategy is a requirement on the persistence provider runtime that the
value must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAGER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the value of the field or
property may be null. This is a hint and is disregarded for primitive
types; it may be used in schema generation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Basic</span>
<span class="directive">protected</span> <span class="predefined-type">String</span> name;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Basic</span>(fetch=LAZY)
<span class="directive">protected</span> <span class="predefined-type">String</span> getName() { <span class="keyword">return</span> name; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cacheable-annotation"><a class="anchor" href="#cacheable-annotation"></a>11.1.7. Cacheable Annotation</h4>
<div class="paragraph">
<p>The <em>Cacheable</em> annotation
specifies whether an entity should be cached if caching is enabled when
the value of the <em>persistence.xml</em> <em>shared-cache-mode</em> element is
<em>ENABLE_SELECTIVE</em> or <em>DISABLE_SELECTIVE</em>. The value of the <em>Cacheable</em>
annotation is inherited by subclasses; it can be overridden by
specifying <em>Cacheable</em> on a subclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Cacheable {
    <span class="type">boolean</span> value() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Cacheable(false)</em> means that the entity and
its state must not be cached by the provider.</p>
</div>
<div class="paragraph">
<p>If the <em>shared-cache-mode</em> element is not
specified in the <em>persistence.xml</em> file and the
<em>jakarta.persistence.sharedCache.mode</em> property is not specified when the
entity manager factory for the persistence unit is created, the
semantics of the <em>Cacheable</em> annotation are undefined.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Cacheable Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether or not the entity should
be cached.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a14250"><a class="anchor" href="#a14250"></a>11.1.8. CollectionTable Annotation</h4>
<div class="paragraph">
<p>The <em>CollectionTable</em> annotation is used in
the mapping of collections of basic or embeddable types. The
<em>CollectionTable</em> annotation specifies the table that is used for the
mapping of the collection and is specified on the collection-valued
field or property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> CollectionTable {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    JoinColumn<span class="type">[]</span> joinColumns() <span class="keyword">default</span> {};
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the columns of the collection
table that correspond to the embeddable class or basic type are derived
from the attributes of the embeddable class or from the basic type
according to the default values of the <em>Column</em> annotation, as described
in <a href="#a14330">Section 11.1.9</a>. In the
case of a basic type, the column name is derived from the name of the
collection-valued field or property. In the case of an embeddable class,
the column names are derived from the field or property names of the
embeddable class.</p>
</div>
<div class="paragraph">
<p>To override the default properties of the
column used for a basic type, the <em>Column</em> annotation is used on the
collection-valued attribute in addition to the <em>ElementCollection</em>
annotation. The value of the <em>table</em> element of the <em>Column</em> annotation
defaults to the name of the collection table.</p>
</div>
<div class="paragraph">
<p>To override these defaults for an embeddable
class, the <em>AttributeOverride</em> and/or <em>AttributeOverrides</em> annotations
must be used in addition to the <em>ElementCollection</em> annotation. The
value of the <em>table</em> element of the <em>Column</em> annotation used in the
<em>AttributeOverride</em> annotation defaults to the name of the collection
table. If the embeddable class contains references to other entities,
the default values for the columns corresponding to those references may
be overridden by means of the <em>AssociationOverride</em> and/or
<em>AssociationOverrides</em> annotations.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <em>joinColumns</em> element when table generation is in
effect. If both this element and the <em>foreignKey</em> element of any of the
<em>joinColumns</em> elements are specified, the behavior is undefined. If no
<em>foreignKey</em> annotation element is specified in either location, the
persistence provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="paragraph">
<p>If the <em>CollectionTable</em> annotation is
missing, the default values of the <em>CollectionTable</em> annotation elements
apply.</p>
</div>
<div class="paragraph">
<p><a href="#a14269">Table 11</a> lists the annotation elements that
may be specified for the <em>CollectionTable</em> annotation and their default
values.</p>
</div>
<table id="a14269" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. CollectionTable Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the collection table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concatenation of the name of the
containing entity and the name of the collection attribute, separated by
an underscore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key columns of the
collection table which reference the primary table of the entity.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default only applies if a single join
column is used.) The same defaults as for JoinColumn (i.e., the
concatenation of the following: the name of the entity; "_"; the name of
the referenced primary key column.) However, if there is more than one
join column, a JoinColumn annotation must be specified for each join
column using the JoinColumns annotation. Both the name and the
referencedColumnName elements must be specified in each such JoinColumn
annotation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are only used if table generation is in
effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> street;
    <span class="directive">protected</span> <span class="predefined-type">String</span> city;
    <span class="directive">protected</span> <span class="predefined-type">String</span> state;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span> <span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> ssn;

    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="directive">protected</span> Address home;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span> <span class="comment">// use default table (PERSON_NICKNAMES)</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, length=<span class="integer">50</span>)
    <span class="directive">protected</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; nickNames = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">WealthyPerson</span> <span class="directive">extends</span> Person {
    <span class="annotation">@ElementCollection</span>
    <span class="annotation">@CollectionTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOMES</span><span class="delimiter">&quot;</span></span>) <span class="comment">// use default join column name</span>
    <span class="annotation">@AttributeOverrides</span>({
        <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">street</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOME_STREET</span><span class="delimiter">&quot;</span></span>)),
        <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">city</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOME_CITY</span><span class="delimiter">&quot;</span></span>)),
        <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">state</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOME_STATE</span><span class="delimiter">&quot;</span></span>))
    })
    <span class="directive">protected</span> <span class="predefined-type">Set</span>&lt;Address&gt; vacationHomes = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14330"><a class="anchor" href="#a14330"></a>11.1.9. Column Annotation</h4>
<div class="paragraph">
<p>The <em>Column</em> annotation is used to specify a
mapped column for a persistent property or field.</p>
</div>
<div class="paragraph">
<p><a href="#a14349">Table 12</a> lists the annotation elements that may be specified
for the <em>Column</em> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If no <em>Column</em> annotation is specified, the
default values in <a href="#a14349">Table 12</a> apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Column {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> length() <span class="keyword">default</span> <span class="integer">255</span>;
    <span class="type">int</span> precision() <span class="keyword">default</span> <span class="integer">0</span>; <span class="comment">// decimal precision</span>
    <span class="type">int</span> scale() <span class="keyword">default</span> <span class="integer">0</span>; <span class="comment">// decimal scale</span>
}</code></pre>
</div>
</div>
<table id="a14349" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Column Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The property or field name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is a unique
key. This is a shortcut for the UniqueConstraint annotation at the table
level and is useful for when the unique key constraint corresponds to
only a single column. This constraint applies in addition to any
constraint entailed by primary key mapping and to constraints specified
at the table level.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the database column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL to create a column of the
inferred type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table that
contains the column. If absent the column is assumed to be in the
primary table for the mapped object.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column
is in primary table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The column length. (Applies only
if a string-valued column is used.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">255</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">precision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The precision for a decimal
(exact numeric) column. (Applies only if a decimal column is used.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 (Value must be set by developer.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The scale for a decimal (exact
numeric) column. (Applies only if a decimal column is used.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DESC</span><span class="delimiter">&quot;</span></span>, nullable=<span class="predefined-constant">false</span>, length=<span class="integer">512</span>)
<span class="directive">public</span> <span class="predefined-type">String</span> getDescription() {
    <span class="keyword">return</span> description;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DESC</span><span class="delimiter">&quot;</span></span>, columnDefinition=<span class="string"><span class="delimiter">&quot;</span><span class="content">CLOB NOT NULL</span><span class="delimiter">&quot;</span></span>, table=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_DETAIL</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Lob</span>
<span class="directive">public</span> <span class="predefined-type">String</span> getDescription() {
    <span class="keyword">return</span> description;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ORDER_COST</span><span class="delimiter">&quot;</span></span>, updatable=<span class="predefined-constant">false</span>, precision=<span class="integer">12</span>, scale=<span class="integer">2</span>)
<span class="directive">public</span> <span class="predefined-type">BigDecimal</span> getCost() {
    <span class="keyword">return</span> cost;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14398"><a class="anchor" href="#a14398"></a>11.1.10. Convert Annotation</h4>
<div class="paragraph">
<p>The <em>Convert</em> annotation is applied directly
to an attribute of an entity, mapped superclass, or embeddable class to
specify conversion of a Basic attribute or to override the use of a
converter that has been specified as <em>autoApply=true</em>. When persistent
properties are used, the <em>Convert</em> annotation is applied to the getter
method. It is not necessary to use the <em>Basic</em> annotation or
corresponding XML element to specify the basic type</p>
</div>
<div class="paragraph">
<p>The <em>Convert</em> annotation may be applied to an
entity that extends a mapped superclass to specify or override the
conversion mapping for an inherited basic attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD, TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(Converts.class)
<span class="directive">public</span> <span class="annotation">@interface</span> Convert {
    <span class="predefined-type">Class</span> converter() <span class="keyword">default</span> <span class="type">void</span>.class;
    <span class="predefined-type">String</span> attributeName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> disableConversion() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14410">Table 13</a> lists the annotation elements that may be specified
for the <em>Convert</em> annotation.</p>
</div>
<table id="a14410" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Convert Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">converter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The converter to be applied.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No converter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the attribute to
convert. Must be specified unless the Convert annotation is applied to
an attribute of basic type or to an element collection of basic type.
Must not be specified otherwise.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The basic
attribute or basic element collection attribute to which the annotation
is applied</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">disableConversion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether conversion of the
attribute is to be disabled.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <em>converter</em> element is used to specify
the converter that is to be applied. If an autoApply converter is
applicable to the given field or property, the converter specified by
the <em>converter</em> element will be applied instead.</p>
</div>
<div class="paragraph">
<p>The <em>disableConversion</em> element specifies
that any applicable autoApply converter must not be applied.</p>
</div>
<div class="paragraph">
<p>The behavior is undefined if neither the
<em>converter</em> element nor the <em>disableConversion</em> element has been
specified.</p>
</div>
<div class="paragraph">
<p>The <em>Convert</em> annotation should not be used
to specify conversion of the following: Id attributes (including the
attributes of embedded ids and derived identities), version attributes,
relationship attributes, and attributes explicitly annotated (or
designated via XML) as <em>Enumerated</em> or <em>Temporal</em>. Applications that
specify such conversions will not be portable.</p>
</div>
<div class="paragraph">
<p>The <em>Convert</em> annotation may be applied to a
basic attribute or to an element collection of basic type (in which case
the converter is applied to the elements of the collection). In these
cases, the <em>attributeName</em> element must not be specified.</p>
</div>
<div class="paragraph">
<p>The <em>Convert</em> annotation may be applied to an
embedded attribute or to a map collection attribute whose key or value
is of embeddable type (in which case the converter is applied to the
specified attribute of the embeddable instances contained in the
collection). In these cases, the <em>attributeName</em> element must be
specified.</p>
</div>
<div class="paragraph">
<p>To override conversion mappings at multiple
levels of embedding, a dot (<em>"."</em>) notation form must be used in the
<em>attributeName</em> element to indicate an attribute within an embedded
attribute. The value of each identifier used with the dot notation is
the name of the respective embedded field or property.</p>
</div>
<div class="paragraph">
<p>When the <em>Convert</em> annotation is applied to a
map containing instances of embeddable classes, the <em>attributeName</em>
element must be specified, and <em>"key."</em> or <em>"value."</em> must be used to
prefix the name of the attribute that is to be converted in order to
specify it as part of the map key or map value.</p>
</div>
<div class="paragraph">
<p>When the <em>Convert</em> annotation is applied to a
map to specify conversion of a map key of basic type, <em>"key"</em> must be
used as the value of the <em>attributeName</em> element to specify that it is
the map key that is to be converted.</p>
</div>
<div class="paragraph">
<p>The <em>Convert</em> annotation may be applied to an
entity class that extends a mapped superclass to specify or override a
conversion mapping for an inherited basic or embedded attribute.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong> Convert a basic attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Converter</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">BooleanToIntegerConverter</span> <span class="directive">implements</span> AttributeConverter&lt;<span class="predefined-type">Boolean</span>, <span class="predefined-type">Integer</span>&gt; { ... }

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> id;

    <span class="annotation">@Convert</span>(converter=BooleanToIntegerConverter.class)
    <span class="type">boolean</span> fullTime;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Auto-apply conversion of a basic attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Converter</span>(autoApply=<span class="predefined-constant">true</span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeDateConverter</span> <span class="directive">implements</span>
    AttributeConverter&lt;com.acme.EmployeeDate, java.sql.Date&gt; { ... }

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> id;

    <span class="comment">// ...</span>

    <span class="comment">// EmployeeDateConverter is applied automatically</span>
    EmployeeDate startDate;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong> Disable conversion in the presence of an auto-apply converter</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Convert</span>(disableConversion=<span class="predefined-constant">true</span>)
EmployeeDate lastReview;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong> Apply a converter to an element collection of basic type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ElementCollection</span>
<span class="comment">// applies to each element in the collection</span>
<span class="annotation">@Convert</span>(converter=NameConverter.class)
<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; names;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong> Apply a converter to an element collection that is a map of basic values. The converter is applied to the map <em>value</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ElementCollection</span>
<span class="annotation">@Convert</span>(converter=EmployeeNameConverter.class)
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; responsibilities;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong> Apply a converter to a map key of basic type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>
<span class="annotation">@Convert</span>(converter=ResponsibilityCodeConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Employee&gt; responsibilities;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 7:</strong> Apply a converter to an embeddable attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@Convert</span>(converter=CountryConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">country</span><span class="delimiter">&quot;</span></span>)
Address address;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 8:</strong> Apply a converter to a nested embeddable attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@Convert</span>(converter=CityConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">region.city</span><span class="delimiter">&quot;</span></span>)
Address address;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 9:</strong> Apply a converter to a nested
attribute of an embeddable that is a map key of an element collection</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PropertyRecord</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@Convert</span>(converter=CityConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">key.region.city</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@ElementCollection</span>
    <span class="predefined-type">Map</span>&lt;Address, PropertyInfo&gt; parcels;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 10:</strong> Apply a converter to an embeddable that is a map key for a relationship</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>
<span class="annotation">@Convert</span>(converter=ResponsibilityCodeConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">key.jobType</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">Map</span>&lt;Responsibility, Employee&gt; responsibilities;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 11:</strong> Override conversion mappings for attributes inherited from a mapped superclass</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Convert</span>(converter=DateConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Convert</span>(converter=DateConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">FullTimeEmployee</span> <span class="directive">extends</span> GenericEmployee { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="converts-annotation"><a class="anchor" href="#converts-annotation"></a>11.1.11. Converts Annotation</h4>
<div class="paragraph">
<p>The <em>Converts</em> annotation can be used to
group <em>Convert</em> annotations. Multiple converters must not be applied to
the same basic attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD, TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Converts {
    Convert<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14515">Table 14</a> lists the annotation elements that may be
specified for the <em>Converts</em> annotation.</p>
</div>
<table id="a14515" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Converts Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convert[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The Convert mappings that are to
be applied to the entity or the field or property.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong> Multiple converters applied to an embedded attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@Converts</span>({
    <span class="annotation">@Convert</span>(converter=CountryConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">country</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@Convert</span>(converter=CityConverter.class, attributeName=<span class="string"><span class="delimiter">&quot;</span><span class="content">region.city</span><span class="delimiter">&quot;</span></span>)
})
Address address;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14530"><a class="anchor" href="#a14530"></a>11.1.12. DiscriminatorColumn Annotation</h4>
<div class="paragraph">
<p>For the SINGLE_TABLE mapping strategy, and
typically also for the JOINED strategy, the persistence provider will
use a type discriminator column. The <em>DiscriminatorColumn</em> annotation is
used to define the discriminator column for the SINGLE_TABLE and JOINED
inheritance mapping strategies.</p>
</div>
<div class="paragraph">
<p>The strategy and the discriminator
column are only specified in the root of an entity class hierarchy or
subhierarchy in which a different inheritance strategy is
applied.<sup class="footnote">[<a id="_footnoteref_100" class="footnote" href="#_footnotedef_100" title="View footnote.">100</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <em>DiscriminatorColumn</em> annotation can be
specified on an entity class (including on an abstract entity class).</p>
</div>
<div class="paragraph">
<p>If the <em>DiscriminatorColumn</em> annotation is
missing, and a discriminator column is required, the name of the
discriminator column defaults to "DTYPE" and the discriminator type to
STRING.</p>
</div>
<div class="paragraph">
<p><a href="#a14548">Table 15</a> lists the annotation elements
that may be specified for the <em>DiscriminatorColumn</em> annotation and their
default values.</p>
</div>
<div class="paragraph">
<p>The supported discriminator types are defined
by the <em>DiscriminatorType</em> enum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> DiscriminatorType { STRING, CHAR, INTEGER };</code></pre>
</div>
</div>
<div class="paragraph">
<p>The type of the discriminator column, if
specified in the optional <em>columnDefinition</em> element, must be consistent
with the discriminator type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> DiscriminatorColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">DTYPE</span><span class="delimiter">&quot;</span></span>;
    DiscriminatorType discriminatorType() <span class="keyword">default</span> STRING;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> length() <span class="keyword">default</span> <span class="integer">31</span>;
}</code></pre>
</div>
</div>
<table id="a14548" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. DiscriminatorColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of column to be used for
the discriminator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"DTYPE"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DiscriminatorType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">discriminatorType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The type of object/column to use
as a class discriminator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DiscriminatorType.STRING</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the discriminator column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider-generated SQL to create a column of
the specified discriminator type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The column length for
String-based discriminator types. Ignored for other discriminator types.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DISC</span><span class="delimiter">&quot;</span></span>, discriminatorType=STRING, length=<span class="integer">20</span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="discriminatorvalue-annotation"><a class="anchor" href="#discriminatorvalue-annotation"></a>11.1.13. DiscriminatorValue Annotation</h4>
<div class="paragraph">
<p>The <em>DiscriminatorValue</em> annotation is used
to specify the value of the discriminator column for entities of the
given type. The <em>DiscriminatorValue</em> annotation can only be specified on
a concrete entity class. If the <em>DiscriminatorValue</em> annotation is not
specified and a discriminator column is used, a provider-specific
function will be used to generate a value representing the entity type.</p>
</div>
<div class="paragraph">
<p>The inheritance strategy and the
discriminator column are only specified in the root of an entity class
hierarchy or subhierarchy in which a different inheritance strategy is
applied. The discriminator value, if not defaulted, should be specified
for each entity class in the hierarchy.</p>
</div>
<div class="paragraph">
<p><a href="#a14585">Table 16</a> lists the annotation elements
that may be specified for the <em>DiscriminatorValue</em> annotation and their
default values.</p>
</div>
<div class="paragraph">
<p>The discriminator value must be consistent in
type with the discriminator type of the specified or defaulted
discriminator column. If the discriminator type is an integer, the value
specified must be able to be converted to an integer value (e.g., "<em>1</em>").</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> DiscriminatorValue {
    <span class="predefined-type">String</span> value();
}</code></pre>
</div>
</div>
<table id="a14585" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. DiscriminatorValue Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The value that indicates that the
row is an entity of the annotated entity type.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the DiscriminatorValue annotation is not
specified, a provider-specific function to generate a value representing
the entity type is used for the value of the discriminator column. If
the DiscriminatorType is STRING, the discriminator value default is the
entity name.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Inheritance</span>(strategy=SINGLE_TABLE)
<span class="annotation">@DiscriminatorColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DISC</span><span class="delimiter">&quot;</span></span>, discriminatorType=STRING,length=<span class="integer">20</span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }

<span class="annotation">@Entity</span>
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="elementcollection-annotation"><a class="anchor" href="#elementcollection-annotation"></a>11.1.14. ElementCollection Annotation</h4>
<div class="paragraph">
<p>The <em>ElementCollection</em> annotation
defines a collection of instances of a basic type or embeddable class.
The <em>ElementCollection</em> annotation (or equivalent XML element) must be
specified if the collection is to be mapped by means of a collection
table.<sup class="footnote">[<a id="_footnoteref_101" class="footnote" href="#_footnotedef_101" title="View footnote.">101</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ElementCollection {
    <span class="predefined-type">Class</span> targetClass() <span class="keyword">default</span> <span class="type">void</span>.class;
    FetchType fetch() <span class="keyword">default</span> LAZY;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14614">Table 17</a> lists the annotation elements
that may be specified for the <em>ElementCollection</em> annotation and their
default values.</p>
</div>
<table id="a14614" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. ElementCollection Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetClass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The basic or embeddable class
that is the element type of the collection. Optional only if the
collection field or property is defined using Java generics. Must be
specified otherwise.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The parameterized type
of the collection when defined using generics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the collection should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the collection
elements must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAZY</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span> <span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> ssn;

    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@ElementCollection</span>
    <span class="directive">protected</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; nickNames = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14634"><a class="anchor" href="#a14634"></a>11.1.15. Embeddable Annotation</h4>
<div class="paragraph">
<p>The <em>Embeddable</em> annotation is used to
specify a class whose instances are stored as an intrinsic part of an
owning entity and share the identity of the entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Embeddable {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmploymentPeriod</span> {
    <span class="annotation">@Temporal</span>(DATE)
    java.util.Date startDate;

    <span class="annotation">@Temporal</span>(DATE)
    java.util.Date endDate;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneNumber</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> areaCode;
    <span class="directive">protected</span> <span class="predefined-type">String</span> localNumber;

    <span class="annotation">@ManyToOne</span>
    PhoneServiceProvider provider;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneServiceProvider</span> {
    <span class="annotation">@Id</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> name;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> street;
    <span class="directive">protected</span> <span class="predefined-type">String</span> city;
    <span class="directive">protected</span> <span class="predefined-type">String</span> state;

    <span class="annotation">@Embedded</span>
    <span class="directive">protected</span> Zipcode zipcode;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Zipcode</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> zip;
    <span class="directive">protected</span> <span class="predefined-type">String</span> plusFour;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14672"><a class="anchor" href="#a14672"></a>11.1.16. Embedded Annotation</h4>
<div class="paragraph">
<p>The <em>Embedded</em> annotation is used to
specify a persistent field or property of an entity or embeddable class
whose value is an instance of an embeddable
class.<sup class="footnote">[<a id="_footnoteref_102" class="footnote" href="#_footnotedef_102" title="View footnote.">102</a>]</sup> Each of the persistent properties or
fields of the embedded object is mapped to the database table for the
entity or embeddable class. The embeddable class must be annotated as
<em>Embeddable</em>.<sup class="footnote">[<a id="_footnoteref_103" class="footnote" href="#_footnotedef_103" title="View footnote.">103</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <em>AttributeOverride</em>,
<em>AttributeOverrides</em>, <em>AssociationOverride</em>, and
<em>AssociationOverrides</em> annotations may be used to override mappings
declared or defaulted by the embeddable class.</p>
</div>
<div class="paragraph">
<p>Implementations are not required to support
embedded objects that are mapped across more than one table (e.g., split
across primary and secondary tables or multiple secondary tables).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Embedded {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embedded</span>
<span class="annotation">@AttributeOverrides</span>({
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_START</span><span class="delimiter">&quot;</span></span>)),
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>, column=<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_END</span><span class="delimiter">&quot;</span></span>))
})
<span class="directive">public</span> EmploymentPeriod getEmploymentPeriod() { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14687"><a class="anchor" href="#a14687"></a>11.1.17. EmbeddedId Annotation</h4>
<div class="paragraph">
<p>The <em>EmbeddedId</em> annotation is applied to a
persistent field or property of an entity class or mapped superclass to
denote a composite primary key that is an embeddable class. The
embeddable class must be annotated as <em>Embeddable</em>.<sup class="footnote">[<a id="_footnoteref_104" class="footnote" href="#_footnotedef_104" title="View footnote.">104</a>]</sup> Relationship mappings defined within an
embedded id class are not supported.</p>
</div>
<div class="paragraph">
<p>There must be only one <em>EmbeddedId</em>
annotation and no <em>Id</em> annotation when the <em>EmbeddedId</em> annotation is
used.</p>
</div>
<div class="paragraph">
<p>The <em>AttributeOverride</em> annotation may be
used to override the column mappings declared within the embeddable
class.</p>
</div>
<div class="paragraph">
<p>The <em>MapsId</em> annotation may be used in
conjunction with the <em>EmbeddedId</em> annotation to specify a derived
primary key. See <a href="#a149">Section 2.4.1</a> and <a href="#a15583">Section 11.1.37</a>.</p>
</div>
<div class="paragraph">
<p>If the entity has a derived primary key, the
<em>AttributeOverride</em> annotation may only be used to override those
attributes of the embedded id that do not correspond to the relationship
to the parent entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> EmbeddedId {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span> <span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@EmbeddedId</span>
    <span class="directive">protected</span> EmployeePK empPK;

    <span class="predefined-type">String</span> name;

    <span class="annotation">@ManyToOne</span>
    <span class="predefined-type">Set</span>&lt;Department&gt; dept;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    EmployeeId empPK; <span class="comment">// corresponds to PK type of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="comment">// default column name for &quot;name&quot; attribute is overridden</span>
    <span class="annotation">@AttributeOverride</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dep_name</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@EmbeddedId</span>
    DependentId id;

    <span class="comment">// ...</span>

    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empPK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@ManyToOne</span>
    Employee emp;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14719"><a class="anchor" href="#a14719"></a>11.1.18. Enumerated Annotation</h4>
<div class="paragraph">
<p>An <em>Enumerated</em> annotation specifies that a
persistent property or field should be persisted as a enumerated type.
The <em>Enumerated</em> annotation may be used in conjunction with the <em>Basic</em>
annotation. The <em>Enumerated</em> annotation may be used in conjunction with
the _ElementCollection_<sup class="footnote">[<a id="_footnoteref_105" class="footnote" href="#_footnotedef_105" title="View footnote.">105</a>]</sup> annotation when the
element collection value is of basic type.</p>
</div>
<div class="paragraph">
<p>An enum can be mapped as either a string or
an integer<sup class="footnote">[<a id="_footnoteref_106" class="footnote" href="#_footnotedef_106" title="View footnote.">106</a>]</sup>. The <em>EnumType</em> enum defines the
mapping for enumerated types.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> EnumType {
    ORDINAL,
    STRING
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the enumerated type is not specified or
the <em>Enumerated</em> annotation is not used, the enumerated type is assumed
to be <em>ORDINAL</em> unless a converter is being applied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Enumerated {
    EnumType value() <span class="keyword">default</span> ORDINAL;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14733">Table 18</a> lists the annotation elements that may be specified
for the <em>Enumerated</em> annotation and their default values.</p>
</div>
<table id="a14733" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Enumerated Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnumType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The type used in mapping an enum type.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ORDINAL</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> EmployeeStatus {FULL_TIME, PART_TIME, CONTRACT}
<span class="directive">public</span> <span class="type">enum</span> SalaryRate {JUNIOR, SENIOR, MANAGER, EXECUTIVE}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="comment">// ...</span>

    <span class="directive">public</span> EmployeeStatus getStatus() {...}

    <span class="annotation">@Enumerated</span>(STRING)
    <span class="directive">public</span> SalaryRate getPayScale() {...}

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the status property is mapped to a column
of integer type, and the payscale property to a column of varchar type,
an instance that has a status of <em>PART_TIME</em> and a pay rate of <em>JUNIOR</em>
will be stored with <em>STATUS</em> set to 1 and <em>PAYSCALE</em> set to <em>"JUNIOR"</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="a14754"><a class="anchor" href="#a14754"></a>11.1.19. ForeignKey Annotation</h4>
<div class="paragraph">
<p>The <em>ForeignKey</em> annotation is used to
specify the handling of foreign key constraints when schema generation
is in effect. If this annotation is not specified, the persistence
provider&#8217;s default foreign key strategy will be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ForeignKey {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ConstraintMode value() <span class="keyword">default</span> CONSTRAINT;
    <span class="predefined-type">String</span> foreignKeyDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>name</em> element specifies a name for the
foreign key constraint.</p>
</div>
<div class="paragraph">
<p>The <em>ConstraintMode</em> enum is used to control
the application of constraints.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> ConstraintMode {CONSTRAINT, NO_CONSTRAINT, PROVIDER_DEFAULT}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The enum values have the following semantics:
A value of <em>CONSTRAINT</em> will cause the persistence provider to generate
a foreign key constraint. A value of <em>NO_CONSTRAINT</em> will result in no
constraint being generated. A value of <em>PROVIDER_DEFAULT</em> will result in
the provider&#8217;s default behavior (which may or may not result in the
generation of a constraint for any given join column or set of join
columns).</p>
</div>
<div class="paragraph">
<p>The syntax used in the <em>foreignKeyDefinition</em>
element should follow the SQL syntax used by the target database for
foreign key constraints. For example, this may be similar to the
following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FOREIGN KEY (&lt;COLUMN expression&gt; {, &lt;COLUMN expression&gt;}... )
REFERENCES &lt;TABLE identifier&gt; [ (&lt;COLUMN expression&gt; {, &lt;COLUMN expression&gt;}... ) ]
[ ON UPDATE &lt;referential action&gt; ]
[ ON DELETE &lt;referential action&gt; ]</pre>
</div>
</div>
<div class="paragraph">
<p>If the <em>ForeignKey</em> annotation is specified
with a <em>ConstraintMode</em> value of <em>CONSTRAINT</em>, but the
<em>foreignKeyDefinition</em> element is not specified, the provider will
generate a foreign key constraint whose update and delete actions it
determines most appropriate for the join column(s) to which the foreign
key constraint is applied</p>
</div>
<div class="paragraph">
<p><a href="#a14776">Table 19</a> lists the annotation elements that may be specified
for the <em>ForeignKey</em> annotation.</p>
</div>
<table id="a14776" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. ForeignKey Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the foreign key constraint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-generated name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConstraintMode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether to generate a constraint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSTRAINT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKeyDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint definition.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider-default. If the value of the ConstraintMode element is NO_CONSTRAINT,
the provider must not generate a foreign key constraint.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a14790"><a class="anchor" href="#a14790"></a>11.1.20. GeneratedValue Annotation</h4>
<div class="paragraph">
<p>The <em>GeneratedValue</em> annotation provides for
the specification of generation strategies for the values of primary
keys. The <em>GeneratedValue</em> annotation may be applied to a primary key
property or field of an entity or mapped superclass in conjunction with
the <em>Id</em> annotation.<sup class="footnote">[<a id="_footnoteref_107" class="footnote" href="#_footnotedef_107" title="View footnote.">107</a>]</sup> The use of the
<em>GeneratedValue</em> annotation is only required to be supported for simple
primary keys. Use of the <em>GeneratedValue</em> annotation is not supported
for derived primary keys.</p>
</div>
<div class="paragraph">
<p><a href="#a14806">Table 20</a> lists the annotation elements that
may be specified for the <em>GeneratedValue</em> annotation and their default
values.</p>
</div>
<div class="paragraph">
<p>The types of primary key generation are
defined by the <em>GenerationType</em> enum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> GenerationType { TABLE, SEQUENCE, IDENTITY, AUTO };</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>TABLE</em> generator type value indicates
that the persistence provider must assign primary keys for the entity
using an underlying database table to ensure uniqueness.</p>
</div>
<div class="paragraph">
<p>The <em>SEQUENCE</em> and <em>IDENTITY</em> values
specify the use of a database sequence or identity column,
respectively.<sup class="footnote">[<a id="_footnoteref_108" class="footnote" href="#_footnotedef_108" title="View footnote.">108</a>]</sup></p>
</div>
<div class="paragraph">
<p>The further specification of table generators
and sequence generators is described in <a href="#a16164">Section 11.1.48</a> and <a href="#a16256">Section 11.1.51</a>.</p>
</div>
<div class="paragraph">
<p>The <em>AUTO</em> value indicates that the
persistence provider should pick an appropriate strategy for the
particular database. The <em>AUTO</em> generation strategy may expect a
database resource to exist, or it may attempt to create one. A vendor
may provide documentation on how to create such resources in the event
that it does not support schema generation or cannot create the schema
resource at runtime.</p>
</div>
<div class="paragraph">
<p>This specification does not define the exact
behavior of these strategies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> GeneratedValue {
    GenerationType strategy() <span class="keyword">default</span> AUTO;
    <span class="predefined-type">String</span> generator() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<table id="a14806" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. GeneratedValue Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GenerationType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The primary key generation
strategy that the persistence provider must use to generate the
annotated entity primary key.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GenerationType.AUTO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">generator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the primary key
generator to use as specified in the SequenceGenerator or TableGenerator
annotation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default primary key generator supplied by persistence provider.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Id</span>
<span class="annotation">@GeneratedValue</span>(strategy=SEQUENCE, generator=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_SEQ</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Long</span> getId() { <span class="keyword">return</span> id; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Id</span>
<span class="annotation">@GeneratedValue</span>(strategy=TABLE, generator=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_GEN</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">Long</span> id;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14827"><a class="anchor" href="#a14827"></a>11.1.21. Id Annotation</h4>
<div class="paragraph">
<p>The <em>Id</em> annotation specifies the primary key
property or field of an entity. The <em>Id</em> annotation may be applied in an
entity or mapped superclass.</p>
</div>
<div class="paragraph">
<p>The field or property to which the <em>Id</em>
annotation is applied should be one of the following types: any Java
primitive type; any primitive wrapper type; <em>java.lang.String</em>;
<em>java.util.Date</em>; <em>java.sql.Date</em>; <em>java.math.BigDecimal</em>;
_java.math.BigInteger_<sup class="footnote">[<a id="_footnoteref_109" class="footnote" href="#_footnotedef_109" title="View footnote.">109</a>]</sup>. See <a href="#a132">Section 2.4</a>.</p>
</div>
<div class="paragraph">
<p>The mapped column for the primary key of the
entity is assumed to be the primary key of the primary table. If no
<em>Column</em> annotation is specified, the primary key column name is assumed
to be the name of the primary key property or field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Id {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Id</span>
<span class="directive">public</span> <span class="predefined-type">Long</span> getId() { <span class="keyword">return</span> id; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14836"><a class="anchor" href="#a14836"></a>11.1.22. IdClass Annotation</h4>
<div class="paragraph">
<p>The <em>IdClass</em> annotation is applied to an
entity class or a mapped superclass to specify a composite primary key
class that is mapped to multiple fields or properties of the entity.</p>
</div>
<div class="paragraph">
<p>The names of the fields or properties in the
primary key class and the primary key fields or properties of the entity
must correspond and their types must match according to the rules
specified in <a href="#a132">Section 2.4</a> and <a href="#a149">Section 2.4.1</a>.</p>
</div>
<div class="paragraph">
<p>The <em>Id</em> annotation must also be applied to
the corresponding fields or properties of the entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> IdClass {
    <span class="predefined-type">Class</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a14847">Table 21</a> lists the annotation elements that may be specified
for the <em>IdClass</em> annotation.</p>
</div>
<table id="a14847" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. IdClass Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The composite primary key class.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@IdClass</span>(com.acme.EmployeePK.class)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> empName;

    <span class="annotation">@Id</span>
    <span class="predefined-type">Date</span> birthDay;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14862"><a class="anchor" href="#a14862"></a>11.1.23. Index Annotation</h4>
<div class="paragraph">
<p>The <em>Index</em> annotation is used in schema
generation. Note that it is not necessary to specify an index for a
primary key, as the primary key index will be created automatically,
however, the Index annotation may be used to specify the ordering of the
columns in the index for the primary key.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Index {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> columnList();
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax of the <em>columnList</em> element is a
<em>column_list</em>, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>column::= index_column [,index_column]*
index_column::= column_name [ASC | DESC]</pre>
</div>
</div>
<div class="paragraph">
<p>The persistence provider must observe the specified ordering of the columns.</p>
</div>
<div class="paragraph">
<p>If <em>ASC</em> or <em>DESC</em> is not specified, <em>ASC</em>
(ascending order) is assumed.</p>
</div>
<div class="paragraph">
<p><a href="#a14877">Table 22</a> lists the annotation elements that may be specified
for the <em>Index</em> annotation.</p>
</div>
<table id="a14877" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Index Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the index.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-generated name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnList</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The names of the columns to be
included in the index.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the index is unique.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a14891"><a class="anchor" href="#a14891"></a>11.1.24. Inheritance Annotation</h4>
<div class="paragraph">
<p>The <em>Inheritance</em> annotation defines the
inheritance strategy to be used for an entity class hierarchy. It is
specified on the entity class that is the root of the entity class
hierarchy.</p>
</div>
<div class="paragraph">
<p>If the <em>Inheritance</em> annotation is not
specified or if no inheritance type is specified for an entity class
hierarchy, the SINGLE_TABLE mapping strategy is used.</p>
</div>
<div class="paragraph">
<p>Support for the combination of inheritance
strategies is not required by this specification. Portable applications
should only use a single inheritance strategy within an entity
hierarchy.</p>
</div>
<div class="paragraph">
<p>The three inheritance mapping strategies are
the single table per class hierarchy, joined subclass, and table per
concrete class strategies. See <a href="#a966">Section 2.12</a> for a more detailed discussion of
inheritance strategies.</p>
</div>
<div class="paragraph">
<p>The inheritance strategy options are defined
by the <em>InheritanceType</em> enum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> InheritanceType { SINGLE_TABLE, JOINED, TABLE_PER_CLASS };</code></pre>
</div>
</div>
<div class="paragraph">
<p>Support for the TABLE_PER_CLASS mapping
strategy is optional in this release.</p>
</div>
<div class="paragraph">
<p><a href="#a14907">Table 23</a> lists the annotation elements that may be specified
for the <em>Inheritance</em> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Inheritance {
    InheritanceType strategy() <span class="keyword">default</span> SINGLE_TABLE;
}</code></pre>
</div>
</div>
<table id="a14907" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Inheritance Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">InheritanceType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The inheritance strategy to use for the entity inheritance hierarchy.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">InheritanceType.SINGLE_TABLE</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Inheritance</span>(strategy=JOINED)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a14922"><a class="anchor" href="#a14922"></a>11.1.25. JoinColumn Annotation</h4>
<div class="paragraph">
<p>The <em>JoinColumn</em> annotation is used to
specify a column for joining an entity association or element
collection.</p>
</div>
<div class="paragraph">
<p><a href="#a14945">Table 24</a> lists the annotation elements that may be specified
for the <em>JoinColumn</em> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If the <em>JoinColumn</em> annotation itself is
defaulted, a single join column is assumed and the default values
described in <a href="#a14945">Table 24</a> apply.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> annotation element defines the
name of the foreign key column. The remaining annotation elements (other
than <em>referencedColumnName</em>) refer to this column and have the same
semantics as for the <em>Column</em> annotation.</p>
</div>
<div class="paragraph">
<p>If the <em>referencedColumnName</em> element is
missing, the foreign key is assumed to refer to the primary key of the
referenced table.</p>
</div>
<div class="paragraph">
<p>Support for referenced columns that are not
primary key columns of the referenced table is optional. Applications
that use such mappings will not be portable.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> annotation element is used
to specify or control the generation of a foreign key constraint when
schema generation is in effect. If this element is not specified, the
persistence provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="paragraph">
<p>If more than one <em>JoinColumn</em> annotation is
applied to a field or property, both the <em>name</em> and the
<em>referencedColumnName</em> elements must be specified in each such
<em>JoinColumn</em> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(JoinColumns.class)
<span class="directive">public</span> <span class="annotation">@interface</span> JoinColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> referencedColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<table id="a14945" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. JoinColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the foreign key
column. The table in which it is found depends upon the context. If the
join is for a OneToOne or ManyToOne mapping using a foreign key mapping
strategy, the foreign key column is in the table of the source entity or
embeddable. If the join is for a unidirectional OneToMany mapping using
a foreign key mapping strategy, the foreign key is in the table of the
target entity. If the join is for a ManyToMany mapping or for a OneToOne
or bidirectional ManyToOne/OneToMany mapping using a join table, the
foreign key is in a join table. If the join is for an element
collection, the foreign key is in a collection table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default only applies if a single join
column is used.) The concatenation of the following: the name of the
referencing relationship property or field of the referencing entity or
embeddable class; "<em>"; the name of the referenced primary key column. If
there is no such referencing relationship property or field in the
entity, or if the join is for an element collection, the join column
name is formed as the concatenation of the following: the name of the
entity; "</em>"; the name of the referenced primary key column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencedColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the column referenced
by this foreign key column. When used with entity relationship mappings
other than the cases described below, the referenced column is in the
table of the target entity. When used with a unidirectional OneToMany
foreign key mapping, the referenced column is in the table of the source
entity. When used inside a JoinTable annotation, the referenced key
column is in the entity table of the owning entity, or inverse entity if
the join is part of the inverse join definition. When used in a
collection table mapping, the referenced column is in the table of the
entity containing the collection.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default
only applies if single join column is being used.) The same name as the
primary key column of the referenced table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the property is a unique
key. This is a shortcut for the UniqueConstraint annotation at the table
level and is useful for when the unique key constraint is only a single
field. It is not necessary to explicitly specify this for a join column
that corresponds to a primary key that is part of a foreign key.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the foreign key column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL for the column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table that contains the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the join is for a
OneToOne or ManyToOne mapping using a foreign key mapping strategy, the
name of the table of the source entity or embeddable. If the join is for
a unidirectional OneToMany mapping using a foreign key mapping strategy,
the name of the table of the target entity. If the join is for a
ManyToMany mapping or for a OneToOne or bidirectional ManyToOne/
OneToMany mapping using a join table, the name of the join table. If the
join is for an element collection, the name of the collection table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint for
the join column. This is used only if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> Address getAddress() { <span class="keyword">return</span> address; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Unidirectional One-to-Many association using a foreign key mapping.</p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>) <span class="comment">// join column is in table for Order</span>
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Order&gt; getOrders() { <span class="keyword">return</span> orders; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="joincolumns-annotation"><a class="anchor" href="#joincolumns-annotation"></a>11.1.26. JoinColumns Annotation</h4>
<div class="paragraph">
<p>Composite foreign keys are supported by means
of the <em>JoinColumns</em> annotation. The <em>JoinColumns</em> annotation groups
<em>JoinColumn</em> annotations for the same relationship.</p>
</div>
<div class="paragraph">
<p>When the <em>JoinColumns</em> annotation is used,
both the <em>name</em> and the <em>referencedColumnName</em> elements must be
specified in each of the grouped <em>JoinColumn</em> annotations.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> annotation element is used
to specify or control the generation of a foreign key constraint when
schema generation is in effect. If both this element and the
<em>foreignKey</em> element of any of the <em>JoinColumn</em> elements referenced by
the <em>value</em> element are specified, the behavior is undefined. If no
<em>foreignKey</em> annotation element is specified in either location, the
persistence provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> JoinColumns {
    JoinColumn<span class="type">[]</span> value();
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15003">Table 25</a> lists the annotation elements that may
be specified for the <em>JoinColumns</em> annotation.</p>
</div>
<table id="a15003" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. JoinColumns Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The join columns that map the relationship.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>
<span class="annotation">@JoinColumns</span>({
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ZIP</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ZIP</span><span class="delimiter">&quot;</span></span>)
})
<span class="directive">public</span> Address getAddress() { <span class="keyword">return</span> address; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15022"><a class="anchor" href="#a15022"></a>11.1.27. JoinTable Annotation</h4>
<div class="paragraph">
<p>The <em>JoinTable</em> annotation is used in the
mapping of entity associations. A <em>JoinTable</em> annotation is specified on
the owning side of the association. A join table is typically used in
the mapping of many-to-many and unidirectional one-to-many associations.
It may also be used to map bidirectional many-to-one/one-to-many
associations, unidirectional many-to-one relationships, and one-to-one
associations (both bidirectional and unidirectional).</p>
</div>
<div class="paragraph">
<p><a href="#a15043">Table 26</a> lists the annotation elements that may be specified
for the <em>JoinTable</em> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If the <em>JoinTable</em> annotation is not
explicitly specified for the mapping of a many-to-many or unidirectional
one-to-many relationship, the default values of the annotation elements
apply.</p>
</div>
<div class="paragraph">
<p>The name of the join table is assumed to be
the table names of the associated primary tables concatenated together
(owning side first) using an underscore.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <em>joinColumns</em> element when table generation is in
effect. If both this element and the <em>foreignKey</em> element of any of the
<em>joinColumns</em> elements are specified, the behavior is undefined. If no
<em>foreignKey</em> annotation element is specified in either location, the
persistence provider&#8217;s default foreign key strategy will apply. The
<em>inverseForeignKey</em> element applies to the generation of a foreign key
constraint for the columns corresponding to the <em>inverseJoinColumns</em>
element, and similar rules apply.</p>
</div>
<div class="paragraph">
<p>When a join table is used in mapping a
relationship with an embeddable class on the owning side of the
relationship, the containing entity rather than the embeddable class is
considered the owner of the relationship.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> JoinTable {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    JoinColumn<span class="type">[]</span> joinColumns() <span class="keyword">default</span> {};
    JoinColumn<span class="type">[]</span> inverseJoinColumns() <span class="keyword">default</span> {};
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    ForeignKey inverseForeignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
<table id="a15043" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. JoinTable Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the join table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concatenated names of the two associated
primary entity tables (owning side first), separated by an underscore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">joinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key columns of the
join table which reference the primary table of the entity owning the
association (i.e. the owning side of the association).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The same defaults as for JoinColumn.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inverseJoinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key columns of the
join table which reference the primary table of the entity that does not
own the association (i.e. the inverse side of the association).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The same defaults as for JoinColumn.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inverseForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the inverse join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are only used if table generation is in
effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@JoinTable</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_PHONE</span><span class="delimiter">&quot;</span></span>,
    joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
    inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PHONE_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15087"><a class="anchor" href="#a15087"></a>11.1.28. Lob Annotation</h4>
<div class="paragraph">
<p>A <em>Lob</em> annotation specifies that a
persistent property or field should be persisted as a large object to a
database-supported large object type. Portable applications should use
the <em>Lob</em> annotation when mapping to a database Lob type. The <em>Lob</em>
annotation may be used in conjunction with the <em>Basic</em> annotation or
with the _ElementCollection_<sup class="footnote">[<a id="_footnoteref_110" class="footnote" href="#_footnotedef_110" title="View footnote.">110</a>]</sup> annotation when the
element collection value is of basic type. A Lob may be either a binary
or character type. The Lob type is inferred from the type of the
persistent field or property and, except for string and character types,
defaults to Blob.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Lob {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Lob</span>
<span class="annotation">@Basic</span>(fetch=EAGER)
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">REPORT</span><span class="delimiter">&quot;</span></span>)
<span class="directive">protected</span> <span class="predefined-type">String</span> report;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Lob</span> <span class="annotation">@Basic</span>(fetch=LAZY)
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_PIC</span><span class="delimiter">&quot;</span></span>, columnDefinition=<span class="string"><span class="delimiter">&quot;</span><span class="content">BLOB NOT NULL</span><span class="delimiter">&quot;</span></span>)
<span class="directive">protected</span> <span class="type">byte</span><span class="type">[]</span> pic;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15100"><a class="anchor" href="#a15100"></a>11.1.29. ManyToMany Annotation</h4>
<div class="paragraph">
<p>A <em>ManyToMany</em> annotation defines a
many-valued association with many-to-many multiplicity. If the
collection is defined using generics to specify the element type, the
associated target entity class does not need to be specified; otherwise
it must be specified.</p>
</div>
<div class="paragraph">
<p>Every many-to-many association has two sides,
the owning side and the non-owning, or inverse, side. If the association
is bidirectional, either side may be designated as the owning side. If
the relationship is bidirectional, the non-owning side must use the
<em>mappedBy</em> element of the <em>ManyToMany</em> annotation to specify the
relationship field or property of the owning side.</p>
</div>
<div class="paragraph">
<p>The join table for the relationship, if not
defaulted, is specified on the owning side.</p>
</div>
<div class="paragraph">
<p>The <em>ManyToMany</em> annotation may be used
within an embeddable class contained within an entity class to specify a
relationship to a collection of entities<sup class="footnote">[<a id="_footnoteref_111" class="footnote" href="#_footnotedef_111" title="View footnote.">111</a>]</sup>. If the
relationship is bidirectional and the entity containing the embeddable
class is the owner of the relationship, the non-owning side must use the
<em>mappedBy</em> element of the <em>ManyToMany</em> annotation to specify the
relationship field or property of the embeddable class. The dot (<em>"."</em>
) notation syntax must be used in the <em>mappedBy</em> element to indicate the
relationship attribute within the embedded attribute. The value of each
identifier used with the dot notation is the name of the respective
embedded field or property.</p>
</div>
<div class="paragraph">
<p><a href="#a15119">Table 27</a> lists these annotation elements that may be
specified for the <em>ManyToMany</em> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>The <em>cascade</em> element specifies the set of
cascadable operations that are propagated to the associated entity. The
operations that are cascadable are defined by the <em>CascadeType</em> enum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> CascadeType {ALL, PERSIST, MERGE, REMOVE, REFRESH, DETACH};</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value <em>cascade=ALL</em> is equivalent to
<em>cascade=\{PERSIST,</em> <em>MERGE,</em> <em>REMOVE,</em> <em>REFRESH, DETACH}</em>.</p>
</div>
<div class="paragraph">
<p>When the collection is a <em>java.util.Map</em>,
the <em>cascade</em> element applies to the map <em>value</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ManyToMany {
    <span class="predefined-type">Class</span> targetEntity() <span class="keyword">default</span> <span class="type">void</span>.class;
    CascadeType<span class="type">[]</span> cascade() <span class="keyword">default</span> {};
    FetchType fetch() <span class="keyword">default</span> LAZY;
    <span class="predefined-type">String</span> mappedBy() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>EAGER</em> strategy is a requirement on the
persistence provider runtime that the associated entity must be eagerly
fetched. The <em>LAZY</em> strategy is a <em>hint</em> to the persistence provider
runtime that the associated entity should be fetched lazily when it is
first accessed. The implementation is permitted to eagerly fetch
associations for which the <em>LAZY</em> strategy hint has been specified.</p>
</div>
<table id="a15119" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. ManyToMany Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The entity class that is the
target of the association. Optional only if the collection-valued
relationship property is defined using Java generics. Must be specified
otherwise.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The parameterized type of the collection when defined using generics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CascadeType[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The operations that must be
cascaded to the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No operations are cascaded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the associated
entities must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAZY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mappedBy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field or property that owns the
relationship. Required unless the relationship is unidirectional.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>
<span class="annotation">@JoinTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_PHONES</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;PhoneNumber&gt; getPhones() { <span class="keyword">return</span> phones; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In PhoneNumber class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Customer&gt; getCustomers() { <span class="keyword">return</span> customers; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>(targetEntity=com.acme.PhoneNumber.class)
<span class="directive">public</span> <span class="predefined-type">Set</span> getPhones() { <span class="keyword">return</span> phones; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In PhoneNumber class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>(targetEntity=com.acme.Customer.class, mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Set</span> getCustomers() { <span class="keyword">return</span> customers; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>
<span class="annotation">@JoinTable</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_PHONE</span><span class="delimiter">&quot;</span></span>,
    joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
    inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">PHONE_ID</span><span class="delimiter">&quot;</span></span>,referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;PhoneNumber&gt; getPhones() { <span class="keyword">return</span> phones; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In PhoneNumberClass:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">phones</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Customer&gt; getCustomers() { <span class="keyword">return</span> customers; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="paragraph">
<p>Embeddable class used by the Employee entity
specifies a many-to-many relationship.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@Embedded</span>
    ContactInfo contactInfo;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContactInfo</span> {
    <span class="annotation">@ManyToOne</span>
    Address address; <span class="comment">// Unidirectional</span>

    <span class="annotation">@ManyToMany</span>
    <span class="predefined-type">List</span>&lt;PhoneNumber&gt; phoneNumbers; <span class="comment">// Bidirectional</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneNumber</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> phNumber;

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">contactInfo.phoneNumbers</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Employee&gt; employees;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="manytoone-annotation"><a class="anchor" href="#manytoone-annotation"></a>11.1.30. ManyToOne Annotation</h4>
<div class="paragraph">
<p>The <em>ManyToOne</em> annotation defines a
single-valued association to another entity class that has many-to-one
multiplicity. It is not normally necessary to specify the target entity
explicitly since it can usually be inferred from the type of the object
being referenced.</p>
</div>
<div class="paragraph">
<p>The <em>ManyToOne</em> annotation may be used within
an embeddable class to specify a relationship from the embeddable class
to an entity class. If the relationship is bidirectional, the non-owning
<em>OneToMany</em> entity side must use the <em>mappedBy</em> element of the
<em>OneToMany</em> annotation to specify the relationship field or property of
the embeddable field or property on the owning side of the relationship.
The dot (<em>"."</em>) notation syntax must be used in the <em>mappedBy</em> element
to indicate the relationship attribute within the embedded attribute.
The value of each identifier used with the dot notation is the name of
the respective embedded field or property.</p>
</div>
<div class="paragraph">
<p><a href="#a15202">Table 28</a> lists the annotation elements that may be specified
for the <em>ManyToOne</em> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ManyToOne {
    <span class="predefined-type">Class</span> targetEntity() <span class="keyword">default</span> <span class="type">void</span>.class;
    CascadeType<span class="type">[]</span> cascade() <span class="keyword">default</span> {};
    FetchType fetch() <span class="keyword">default</span> EAGER;
    <span class="type">boolean</span> optional() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The operations that can be cascaded are
defined by the <em>CascadeType</em> enum, defined in <a href="#a15100">Section 11.1.29</a>.</p>
</div>
<div class="paragraph">
<p>The <em>EAGER</em> strategy is a requirement on the
persistence provider runtime that the associated entity must be eagerly
fetched. The <em>LAZY</em> strategy is a <em>hint</em> to the persistence provider
runtime that the associated entity should be fetched lazily when it is
first accessed. The implementation is permitted to eagerly fetch
associations for which the <em>LAZY</em> strategy hint has been specified.</p>
</div>
<table id="a15202" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. ManyToOne Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The entity class that is the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the field or property that stores the association.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CascadeType[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The operations that must be
cascaded to the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No operations are cascaded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the associated
entity must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAGER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association is
optional. If set to false then a non-null relationship must always
exist.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>(optional=<span class="predefined-constant">false</span>)
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, nullable=<span class="predefined-constant">false</span>, updatable=<span class="predefined-constant">false</span>)
<span class="directive">public</span> Customer getCustomer() { <span class="keyword">return</span> customer; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@Embedded</span>
    JobInfo jobInfo;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">JobInfo</span> {
    <span class="predefined-type">String</span> jobDescription;

    <span class="annotation">@ManyToOne</span>
    ProgramManager pm; <span class="comment">// Bidirectional</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ProgramManager</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@OneToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">jobInfo.pm</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Employee&gt; manages;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapkey-annotation"><a class="anchor" href="#mapkey-annotation"></a>11.1.31. MapKey Annotation</h4>
<div class="paragraph">
<p>The <em>MapKey</em> annotation is used to specify
the map key for associations of type <em>java.util.Map</em> when the map key is
itself the primary key or a persistent field or property of the entity
that is the value of the map.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKey {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>name</em> element designates the name of the
persistent field or property of the associated entity that is used as
the map key. If the <em>name</em> element is not specified, the primary key of
the associated entity is used as the map key. If the primary key is a
composite primary key and is mapped as <em>IdClass</em>, an instance of the
primary key class is used as the key.</p>
</div>
<div class="paragraph">
<p>If a persistent field or property other than
the primary key is used as a map key, it is expected to be unique within
the context of the relationship.</p>
</div>
<div class="paragraph">
<p>The <em>MapKeyClass</em> annotation is not used when
<em>MapKey</em> is specified and vice versa.</p>
</div>
<div class="paragraph">
<p><a href="#a15256">Table 29</a> lists the annotation elements that may be specified
for the <em>MapKey</em> annotation.</p>
</div>
<table id="a15256" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. MapKey Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the persistent field or property that is used as the map key.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The primary key is used as the map key.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">department</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@MapKey</span> <span class="comment">// map key is primary key</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">Integer</span>, Employee&gt; getEmployees() { ... }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {

    <span class="comment">// ...</span>

    <span class="annotation">@Id</span> <span class="directive">public</span> <span class="predefined-type">Integer</span> getEmpId() { ... }
    <span class="annotation">@ManyToOne</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dept_id</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Department getDepartment() { ... }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">department</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@MapKey</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Employee&gt; getEmployees() { ... }

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getEmpId() { ... }

    <span class="comment">// ...</span>

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() { ... }

    <span class="comment">// ...</span>

    <span class="annotation">@ManyToOne</span>
    <span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dept_id</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Department getDepartment() { ... }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapkeyclass-annotation"><a class="anchor" href="#mapkeyclass-annotation"></a>11.1.32. MapKeyClass Annotation</h4>
<div class="paragraph">
<p>The <em>MapKeyClass</em> annotation is used to
specify the type of the map key for associations of type <em>java.util.Map</em>
. The map key can be a basic type, an embeddable class, or an entity. If
the map is specified using Java generics, the <em>MapKeyClass</em> annotation
and associated type need not be specified; otherwise they must be
specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyClass {
    <span class="predefined-type">Class</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>MapKeyClass</em> annotation is used in
conjunction with <em>ElementCollection</em> or one of the collection-valued
relationship annotations (<em>OneToMany</em> or <em>ManyToMany</em>).</p>
</div>
<div class="paragraph">
<p>The <em>MapKey</em> annotation is not used when
<em>MapKeyClass</em> is specified and vice versa.</p>
</div>
<div class="paragraph">
<p><a href="#a15316">Table 30</a> lists the annotation elements that may
be specified for the <em>MapKeyClass</em> annotation.</p>
</div>
<table id="a15316" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. MapKeyClass Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The type of the map key.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Item</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>(targetClass=<span class="predefined-type">String</span>.class)
    <span class="annotation">@MapKeyClass</span>(<span class="predefined-type">String</span>.class)
    <span class="predefined-type">Map</span> images; <span class="comment">// map from image name to image filename</span>

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MapKeyClass and target type of relationship can be defaulted</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Item</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; images;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Company</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>(targetEntity=com.example.VicePresident.class)
    <span class="annotation">@MapKeyClass</span>(com.example.Division.class)
    <span class="predefined-type">Map</span> organization;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MapKeyClass and target type of relationship are defaulted</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Company</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span>
    <span class="predefined-type">Map</span>&lt;Division, VicePresident&gt; organization;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15367"><a class="anchor" href="#a15367"></a>11.1.33. MapKeyColumn Annotation</h4>
<div class="paragraph">
<p>The <em>MapKeyColumn</em> annotation is used to
specify the mapping for the key column of a map whose map key is a basic
type. If the <em>name</em> element is not specified, it defaults to the
concatenation of the following: the name of the referencing relationship
field or property; "<em>_</em>"; "<em>KEY</em>".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> length() <span class="keyword">default</span> <span class="integer">255</span>;
    <span class="type">int</span> precision() <span class="keyword">default</span> <span class="integer">0</span>; <span class="comment">// decimal precision</span>
    <span class="type">int</span> scale() <span class="keyword">default</span> <span class="integer">0</span>; <span class="comment">// decimal scale</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no <em>MapKeyColumn</em> annotation is specified,
the default values in <a href="#a15384">Table 31</a> apply.</p>
</div>
<table id="a15384" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. MapKeyColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the map key column.
The table in which it is found depends upon the context. If the map key
is for an element collection, the map key column is in the collection
table for the map value. If the map key is for a ManyToMany entity
relationship or for a OneToMany entity relationship using a join table,
the map key column is in a join table. If the map key is for a OneToMany
entity relationship using a foreign key mapping strategy, the map key
column is in the table of the entity that is the value of the map.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concatenation of the following: the name
of the referencing property or field name; " <em>_</em> "; " <em>KEY</em> ".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is a unique
key. This is a shortcut for the UniqueConstraint annotation at the table
level and is useful for when the unique key constraint corresponds to
only a single column. This constraint applies in addition to any
constraint entailed by primary key mapping and to constraints specified
at the table level.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the database column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL to create a column of the inferred type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table that contains the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the map key is for
an element collection, the name of the collection table for the map
value. If the map key is for a OneToMany or ManyToMany entity
relationship using a join table, the name of the join table for the map.
If the map key is for a OneToMany entity relationship using a foreign
key mapping strategy, the name of the primary table of the entity that
is the value of the map.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The column length. (Applies only if a string-valued column is used.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">255</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">precision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The precision for a decimal
(exact numeric) column. (Applies only if a decimal column is used.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 (Value must be set by developer.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The scale for a decimal (exact
numeric) column. (Applies only if a decimal column is used.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Item</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>
    <span class="annotation">@MapKeyColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">IMAGE_NAME</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">IMAGE_FILENAME</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@CollectionTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">IMAGE_MAPPING</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; images; <span class="comment">// map from image name to filename</span>

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15433"><a class="anchor" href="#a15433"></a>11.1.34. MapKeyEnumerated Annotation</h4>
<div class="paragraph">
<p>The <em>MapKeyEnumerated</em> annotation is used to
specify the enum type for a map key whose basic type is an enumerated
type.</p>
</div>
<div class="paragraph">
<p>The <em>MapKeyEnumerated</em> annotation can be
applied to an element collection or relationship of type <em>java.util.Map</em>
, in conjunction with the <em>ElementCollection</em>, <em>OneToMany</em>, or
<em>ManyToMany</em> annotation. If the map is specified using Java generics,
the <em>MapKeyClass</em> annotation and associated type need not be specified;
otherwise they must be specified.</p>
</div>
<div class="paragraph">
<p>If the enumerated type is not specified or
the <em>MapKeyEnumerated</em> annotation is not used, the enumerated type is
assumed to be <em>ORDINAL</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyEnumerated {
    EnumType value() <span class="keyword">default</span> ORDINAL;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15443">Table 32</a> lists the annotation elements that
may be specified for the <em>MapKeyEnumerated</em> annotation and their default
values. The <em>EnumType</em> enum is defined in <a href="#a14719">Section 11.1.18</a>.</p>
</div>
<table id="a15443" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. MapKeyEnumerated Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnumType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The type used in mapping an enum type.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ORDINAL</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a15450"><a class="anchor" href="#a15450"></a>11.1.35. MapKeyJoinColumn Annotation</h4>
<div class="paragraph">
<p>The <em>MapKeyJoinColumn</em> annotation is used to
specify a mapping to an entity that is a map key. The map key join
column is in the collection table, join table, or table of the target
entity that is used to represent the map.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(MapKeyJoinColumns.class)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyJoinColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> referencedColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> unique() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15474">Table 33</a> lists the annotation elements that
may be specified for the <em>MapKeyJoinColumn</em> annotation and their default
values.</p>
</div>
<div class="paragraph">
<p>If no <em>MapKeyJoinColumn</em> annotation is
specified, a single join column is assumed and the default values
described below (and in <a href="#a15474">Table 33</a>) apply.</p>
</div>
<div class="paragraph">
<p>The <em>name</em> annotation element defines the
name of the foreign key column. The remaining annotation elements (other
than <em>referencedColumnName</em>) refer to this column.</p>
</div>
<div class="paragraph">
<p>If there is a single map key join column, and
if the name annotation member is missing, the map key join column name
is formed as the concatenation of the following: the name of the
referencing relationship property or field of the referencing entity or
embeddable; " <em>_</em> "; " <em>KEY</em> ".</p>
</div>
<div class="paragraph">
<p>If the <em>referencedColumnName</em> element is
missing, the foreign key is assumed to refer to the primary key of the
referenced table. Support for referenced columns that are not primary
key columns of the referenced table is optional. Applications that use
such mappings will not be portable.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> element is used to specify
or control the generation of a foreign key constraint for the map key
join column when table generation is in effect. If the <em>foreignKey</em>
element is not specified, the persistence provider&#8217;s default foreign key
strategy will be used.</p>
</div>
<div class="paragraph">
<p>If more than one <em>MapKeyJoinColumn</em>
annotation is applied to a field or property, both the <em>name</em> and the
<em>referencedColumnName</em> elements must be specified in each such
<em>MapKeyJoinColumn</em> annotation.</p>
</div>
<table id="a15474" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. MapKeyJoinColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the foreign key
column for the map key. The table in which it is found depends upon the
context. If the join is for a map key for an element collection, the
foreign key column is in the collection table for the map value. If the
join is for a map key for a ManyToMany entity relationship or for a
OneToMany entity relationship using a join table, the foreign key column
is in a join table. If the join is for a OneToMany entity relationship
using a foreign key mapping strategy, the foreign key column for the map
key is in the table of the entity that is the value of the map.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default only applies if a single join
column is used.) The concatenation of the following: the name of the
referencing relationship property or field of the referencing entity or
embeddable class; "_"; "KEY".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencedColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the column referenced
by this foreign key column. The referenced column is in the table of the
target entity.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default only applies if
single join column is being used.) The same name as the primary key
column of the referenced table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the property is a unique
key. This is a shortcut for the UniqueConstraint annotation at the table
level and is useful for when the unique key constraint is only a single
field.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the foreign key column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL for the column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table that
contains the foreign key column. If the join is for a map key for an
element collection, the foreign key column is in the collection table
for the map value. If the join is for a map key for a ManyToMany entity
relationship or for a OneToMany entity relationship using a join table,
the foreign key column is in a join table. If the join is for a
OneToMany entity relationship using a foreign key mapping strategy, the
foreign key column for the map key is in the table of the entity that is
the value of the map.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the map is for an
element collection, the name of the collection table for the map value.
If the map is for a OneToMany or ManyToMany entity relationship using a
join table, the name of the join table for the map. If the map is for a
OneToMany entity relationship using a foreign key mapping strategy, the
name of the primary table of the entity that is the value of the map.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join column. This is used only if table generation
is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Company</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="comment">// ...</span>

    <span class="annotation">@OneToMany</span> <span class="comment">// unidirectional</span>
    <span class="annotation">@JoinTable</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COMPANY_ORGANIZATION</span><span class="delimiter">&quot;</span></span>,
        joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COMPANY</span><span class="delimiter">&quot;</span></span>),
        inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">VICEPRESIDENT</span><span class="delimiter">&quot;</span></span>)
    )
    <span class="annotation">@MapKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DIVISION</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Map</span>&lt;Division, VicePresident&gt; organization;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">VideoStore</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="predefined-type">String</span> name;

    Address location;

    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>
    <span class="annotation">@CollectionTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">INVENTORY</span><span class="delimiter">&quot;</span></span>, joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">STORE</span><span class="delimiter">&quot;</span></span>))
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COPIES_IN_STOCK</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@MapKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">MOVIE</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Map</span>&lt;Movie, <span class="predefined-type">Integer</span>&gt; videoInventory;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Movie</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> id;

    <span class="predefined-type">String</span> title;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Student</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> studentId;

    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span> <span class="comment">// students and courses are also many-many</span>
    <span class="annotation">@JoinTable</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ENROLLMENTS</span><span class="delimiter">&quot;</span></span>,
        joinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">STUDENT</span><span class="delimiter">&quot;</span></span>),
        inverseJoinColumns=<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">SEMESTER</span><span class="delimiter">&quot;</span></span>)
    )
    <span class="annotation">@MapKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COURSE</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Map</span>&lt;Course, Semester&gt; enrollment;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapkeyjoincolumns-annotation"><a class="anchor" href="#mapkeyjoincolumns-annotation"></a>11.1.36. MapKeyJoinColumns Annotation</h4>
<div class="paragraph">
<p>Composite map keys referencing entities are
supported by means of the <em>MapKeyJoinColumns</em> annotation. The
<em>MapKeyJoinColumns</em> annotation groups <em>MapKeyJoinColumn</em> annotations.</p>
</div>
<div class="paragraph">
<p>When the <em>MapKeyJoinColumns</em> annotation is
used, both the <em>name</em> and the <em>referencedColumnName</em> elements must be
specified in each of the grouped <em>MapKeyJoinColumn</em> annotations.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <em>MapKeyJoinColumn</em> elements referenced by the
<em>value</em> element when table generation is in effect. If both this element
and the <em>foreignKey</em> element of any of the <em>MapKeyJoinColumn</em> elements
are specified, the behavior is undefined. If no <em>foreignKey</em> annotation
element is specified in either location, the persistence provider&#8217;s
default foreign key strategy will apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyJoinColumns {
    MapKeyJoinColumn<span class="type">[]</span> value();
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15572">Table 34</a> lists the annotation elements
that may be specified for the <em>MapKeyJoinColumns</em> annotation.</p>
</div>
<table id="a15572" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 34. MapKeyJoinColumns Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MapKeyJoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The map key join columns that are used to map to the entity that is the map key.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a15583"><a class="anchor" href="#a15583"></a>11.1.37. MapKeyTemporal Annotation</h4>
<div class="paragraph">
<p>The <em>MapKeyTemporal</em> annotation is used to
specify the temporal type for a map key whose basic type is a temporal
type.</p>
</div>
<div class="paragraph">
<p>The <em>MapKeyTemporal</em> annotation can be
applied to an element collection or relationship of type <em>java.util.Map</em>
, in conjunction with the <em>ElementCollection</em>, <em>OneToMany</em>, or
<em>ManyToMany</em> annotation. If the map is specified using Java generics,
the <em>MapKeyClass</em> annotation and associated type need not be specified;
otherwise they must be specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapKeyTemporal {
    TemporalType value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15593">Table 35</a> lists the annotation elements that
may be specified for the <em>MapKeyTemporal</em> annotation and their default
values. The <em>TemporalType</em> enum is defined in <a href="#a16361">Section 11.1.53</a>.</p>
</div>
<table id="a15593" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 35. MapKeyTemporal Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TemporalType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The type used in mapping java.util.Date or java.util.Calendar.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="mappedsuperclass-annotation"><a class="anchor" href="#mappedsuperclass-annotation"></a>11.1.38. MappedSuperclass Annotation</h4>
<div class="paragraph">
<p>The <em>MappedSuperclass</em> annotation designates
a class whose mapping information is applied to the entities that
inherit from it. A mapped superclass has no separate table defined for
it.</p>
</div>
<div class="paragraph">
<p>A class designated with the
<em>MappedSuperclass</em> annotation can be mapped in the same way as an entity
except that the mappings will apply only to its subclasses since no
table exists for the mapped superclass itself. When applied to the
subclasses the inherited mappings will apply in the context of the
subclass tables. Mapping information may be overridden in such
subclasses by using the <em>AttributeOverride</em>, <em>AttributeOverrides</em>,
<em>AssociationOverride</em>, and <em>AssociationOverrides</em> annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Documented</span>
<span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MappedSuperclass {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mapsid-annotation"><a class="anchor" href="#mapsid-annotation"></a>11.1.39. MapsId Annotation</h4>
<div class="paragraph">
<p>The <em>MapsId</em> annotation is used to designate
a <em>ManyToOne</em> or <em>OneToOne</em> relationship attribute that provides the
mapping for an <em>EmbeddedId</em> primary key, an attribute within an
<em>EmbeddedId</em> primary key, or a simple primary key of the parent entity.</p>
</div>
<div class="paragraph">
<p>The <em>value</em> element specifies the attribute
within a composite key to which the relationship attribute corresponds.
If the entity&#8217;s primary key is of the same Java type as the primary key
of the entity referenced by the relationship, the <em>value</em> attribute is
not specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> MapsId {
    <span class="predefined-type">String</span> value() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a15615">Table 36</a> lists the annotation elements that may be specified
for the <em>MapsId</em> annotation.</p>
</div>
<table id="a15615" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 36. MapsId Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the attribute within
the composite key to which the relationship attribute corresponds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The relationship maps the entity&#8217;s primary key.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// parent entity has simple primary key</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> empId;

    <span class="predefined-type">String</span> name;

    <span class="comment">// ...</span>
}

<span class="comment">// dependent entity uses EmbeddedId for composite key</span>
<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DependentId</span> {
    <span class="predefined-type">String</span> name;
    <span class="type">long</span> empid; <span class="comment">// corresponds to PK type of Employee</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Dependent</span> {
    <span class="annotation">@EmbeddedId</span>
    DependentId id;

    <span class="comment">// ...</span>

    <span class="annotation">@MapsId</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">empid</span><span class="delimiter">&quot;</span></span>) <span class="comment">// maps the empid attribute of embedded id</span>
    <span class="annotation">@ManyToOne</span>
    Employee emp;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="onetomany-annotation"><a class="anchor" href="#onetomany-annotation"></a>11.1.40. OneToMany Annotation</h4>
<div class="paragraph">
<p>A <em>OneToMany</em> annotation defines a
many-valued association with one-to-many multiplicity.</p>
</div>
<div class="paragraph">
<p><a href="#a15667">Table 37</a> lists the annotation elements that may be specified
for the <em>OneToMany</em> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If the collection is defined using generics
to specify the element type, the associated target entity class need not
be specified; otherwise it must be specified.</p>
</div>
<div class="paragraph">
<p>The <em>OneToMany</em> annotation may be used within
an embeddable class contained within an entity class to specify a
relationship to a collection of entities<sup class="footnote">[<a id="_footnoteref_112" class="footnote" href="#_footnotedef_112" title="View footnote.">112</a>]</sup>. If the
relationship is bidirectional, the <em>mappedBy</em> element must be used to
specify the relationship field or property of the entity that is the
owner of the relationship.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OneToMany {
    <span class="predefined-type">Class</span> targetEntity() <span class="keyword">default</span> <span class="type">void</span>.class;
    CascadeType<span class="type">[]</span> cascade() <span class="keyword">default</span> {};
    FetchType fetch() <span class="keyword">default</span> LAZY;
    <span class="predefined-type">String</span> mappedBy() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> orphanRemoval() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The operations that can be cascaded are
defined by the <em>CascadeType</em> enum, defined in <a href="#a15100">Section 11.1.29</a>.</p>
</div>
<div class="paragraph">
<p>When the collection is a <em>java.util.Map</em>,
the <em>cascade</em> element and the <em>orphanRemoval</em> element apply to the map
<em>value</em>.</p>
</div>
<div class="paragraph">
<p>If <em>orphanRemoval</em> is <em>true</em> and an entity
that is the target of the relationship is removed from the relationship
(either by removal from the collection or by setting the relationship to
null), the remove operation will be applied to the entity being
orphaned. If the entity being orphaned is a detached, new, or removed
entity, the semantics of <em>orphanRemoval</em> do not apply.</p>
</div>
<div class="paragraph">
<p>If <em>orphanRemoval</em> is <em>true</em> and the remove
operation is applied to the source entity, the remove operation will be
cascaded to the relationship target in accordance with the rules of
<a href="#a1946">Section 3.2.3</a>, (and hence it is not
necessary to specify <em>cascade=REMOVE</em> for the
relationship)<sup class="footnote">[<a id="_footnoteref_113" class="footnote" href="#_footnotedef_113" title="View footnote.">113</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>The remove operation is applied at the time
of the flush operation. The <em>orphanRemoval</em> functionality is intended
for entities that are privately "owned" by their parent entity. Portable
applications must otherwise not depend upon a specific order of removal,
and must not reassign an entity that has been orphaned to another
relationship or otherwise attempt to persist it.</p>
</div>
<div class="paragraph">
<p>The default mapping for unidirectional
one-to-many relationships uses a join table as is described in
<a href="#a758">Section 2.10.5</a>. Unidirectional one-to-many relationships may be
implemented using one-to-many foreign key mappings, using the
<em>JoinColumn</em> and <em>JoinColumns</em> annotations.</p>
</div>
<table id="a15667" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 37. OneToMany Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The entity class that is the
target of the association. Optional only if the collection-valued
relationship property is defined using Java generics. Must be specified
otherwise.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The parameterized type of the collection when defined using generics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CascadeType[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The operations that must be cascaded to the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No operations are cascaded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the associated
entities must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAZY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mappedBy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field or property that owns the
relationship. Required unless the relationship is unidirectional.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">orphanRemoval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether to apply the remove
operation to entities that have been removed from the relationship and
to cascade the remove operation to those entities.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> One-to-Many association using generics</p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>(cascade=ALL, mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>, orphanRemoval=<span class="predefined-constant">true</span>)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Order&gt; getOrders() { <span class="keyword">return</span> orders; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Order class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, nullable=<span class="predefined-constant">false</span>)
<span class="directive">public</span> Customer getCustomer() { <span class="keyword">return</span> customer; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> One-to-Many association without using generics</p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>(
    targetEntity=com.acme.Order.class,
    cascade=ALL,
    mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>,
    orphanRemoval=<span class="predefined-constant">true</span>
)
<span class="directive">public</span> <span class="predefined-type">Set</span> getOrders() { <span class="keyword">return</span> orders; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Order class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ManyToOne</span>
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, nullable=<span class="predefined-constant">false</span>)
<span class="directive">protected</span> Customer customer;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong> Unidirectional One-to-Many association using a foreign key mapping</p>
</div>
<div class="paragraph">
<p>In Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToMany</span>(orphanRemoval=<span class="predefined-constant">true</span>)
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>) <span class="comment">// join column is in table for Order</span>
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Order&gt; getOrders() { <span class="keyword">return</span> orders; }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="onetoone-annotation"><a class="anchor" href="#onetoone-annotation"></a>11.1.41. OneToOne Annotation</h4>
<div class="paragraph">
<p>The <em>OneToOne</em> annotation defines a
single-valued association to another entity that has one-to-one
multiplicity. It is not normally necessary to specify the associated
target entity explicitly since it can usually be inferred from the type
of the object being referenced.</p>
</div>
<div class="paragraph">
<p>If the relationship is bidirectional, the
<em>mappedBy</em> element must be used to specify the relationship field or
property of the entity that is the owner of the relationship.</p>
</div>
<div class="paragraph">
<p>The <em>OneToOne</em> annotation may be used within
an embeddable class to specify a relationship from the embeddable class
to an entity class. If the relationship is bidirectional and the entity
containing the embeddable class is on the owning side of the
relationship, the non-owning side must use the <em>mappedBy</em> element of the
<em>OneToOne</em> annotation to specify the relationship field or property of
the embeddable class. The dot (<em>"."</em>) notation syntax must be used in
the <em>mappedBy</em> element to indicate the relationship attribute within the
embedded attribute. The value of each identifier used with the dot
notation is the name of the respective embedded field or property.</p>
</div>
<div class="paragraph">
<p><a href="#a15735">Table 38</a> lists the annotation elements that may be specified
for the <em>OneToOne</em> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OneToOne {
    <span class="predefined-type">Class</span> targetEntity() <span class="keyword">default</span> <span class="type">void</span>.class;
    CascadeType<span class="type">[]</span> cascade() <span class="keyword">default</span> {};
    FetchType fetch() <span class="keyword">default</span> EAGER;
    <span class="type">boolean</span> optional() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> mappedBy() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> orphanRemoval() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The operations that can be cascaded are
defined by the <em>CascadeType</em> enum, defined in <a href="#a15100">Section 11.1.29</a>.</p>
</div>
<div class="paragraph">
<p>If <em>orphanRemoval</em> is <em>true</em> and an entity
that is the target of the relationship is removed from the relationship
(by setting the relationship to null), the remove operation will be
applied to the entity being orphaned. If the entity being orphaned is a
detached, new, or removed entity, the semantics of <em>orphanRemoval</em> do
not apply.</p>
</div>
<div class="paragraph">
<p>If <em>orphanRemoval</em> is <em>true</em> and the remove
operation is applied to the source entity, the remove operation will be
cascaded to the relationship target in accordance with the rules of
<a href="#a1946">Section 3.2.3</a>, (and hence it is not
necessary to specify <em>cascade=REMOVE</em> for the
relationship)<sup class="footnote">[<a id="_footnoteref_114" class="footnote" href="#_footnotedef_114" title="View footnote.">114</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>The remove operation is applied at the time
of the flush operation. The <em>orphanRemoval</em> functionality is intended
for entities that are privately "owned" by their parent entity. Portable
applications must otherwise not depend upon a specific order of removal,
and must not reassign an entity that has been orphaned to another
relationship or otherwise attempt to persist it.</p>
</div>
<table id="a15735" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 38. OneToOne Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The entity class that is the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the field or property that stores the association.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CascadeType[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The operations that must be cascaded to the target of the association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No operations are cascaded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FetchType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association should be
lazily loaded or must be eagerly fetched. The EAGER strategy is a
requirement on the persistence provider runtime that the associated
entity must be eagerly fetched. The LAZY strategy is a hint to the
persistence provider runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAGER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the association is
optional. If set to false then a non-null relationship must always
exist.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mappedBy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The field or property that owns
the relationship. The mappedBy element is only specified on the inverse
(non-owning) side of the association.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">orphanRemoval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether to apply the remove
operation to entities that have been removed from the relationship and
to cascade the remove operation to those entities.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> One-to-one association that maps a foreign key column.</p>
</div>
<div class="paragraph">
<p>On Customer class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToOne</span>(optional=<span class="predefined-constant">false</span>)
<span class="annotation">@JoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTREC_ID</span><span class="delimiter">&quot;</span></span>, unique=<span class="predefined-constant">true</span>, nullable=<span class="predefined-constant">false</span>, updatable=<span class="predefined-constant">false</span>)
<span class="directive">public</span> CustomerRecord getCustomerRecord() { <span class="keyword">return</span> customerRecord; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>On CustomerRecord class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@OneToOne</span>(optional=<span class="predefined-constant">false</span>, mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">customerRecord</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> Customer getCustomer() { <span class="keyword">return</span> customer; }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> One-to-one association where
both source and target share the same primary key values.</p>
</div>
<div class="paragraph">
<p>On Employee class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">Integer</span> id;

    <span class="annotation">@OneToOne</span>(orphanRemoval=<span class="predefined-constant">true</span>)
    <span class="annotation">@MapsId</span>
    EmployeeInfo info;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On EmployeeInfo class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeInfo</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">Integer</span> id;

    <span class="comment">//...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong> One-to-one association from an embeddable class to another entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@Embedded</span>
    LocationDetails location;

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LocationDetails</span> {
    <span class="type">int</span> officeNumber;

    <span class="annotation">@OneToOne</span>
    ParkingSpot parkingSpot;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ParkingSpot</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="predefined-type">String</span> garage;

    <span class="annotation">@OneToOne</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">location.parkingSpot</span><span class="delimiter">&quot;</span></span>)
    Employee assignedTo;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="orderby-annotation"><a class="anchor" href="#orderby-annotation"></a>11.1.42. OrderBy Annotation</h4>
<div class="paragraph">
<p>The <em>OrderBy</em> annotation specifies the
ordering the elements of a collection-valued association or element
collection are to have when the association or collection is retrieved.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OrderBy {
    <span class="predefined-type">String</span> value() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax of the <em>value</em> ordering element is
an orderby_list, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>orderby_list ::= orderby_item [,orderby_item]*
orderby_item ::= [property_or_field_name] [ASC | DESC]</pre>
</div>
</div>
<div class="paragraph">
<p>If orderby_list is not specified or if <em>ASC</em>
or <em>DESC</em> is not specified, <em>ASC</em> (ascending order) is assumed.</p>
</div>
<div class="paragraph">
<p>If the ordering element is not
specified for an entity association, ordering by the primary key of the
associated entity is assumed.<sup class="footnote">[<a id="_footnoteref_115" class="footnote" href="#_footnotedef_115" title="View footnote.">115</a>]</sup></p>
</div>
<div class="paragraph">
<p>A property or field name specified as an
<em>orderby_item</em> must correspond to a basic persistent property or field
of the associated class or embedded class within it. The properties or
fields used in the ordering must correspond to columns for which
comparison operators are supported.</p>
</div>
<div class="paragraph">
<p>The dot (".") notation is used to refer to an
attribute within an embedded attribute. The value of each identifier
used with the dot notation is the name of the respective embedded field
or property.</p>
</div>
<div class="paragraph">
<p>The <em>OrderBy</em> annotation may be applied to an
element collection. When <em>OrderBy</em> is applied to an element collection
of basic type, the ordering will be by value of the basic objects and
the <em>property_or_field_name</em> is not used.<sup class="footnote">[<a id="_footnoteref_116" class="footnote" href="#_footnotedef_116" title="View footnote.">116</a>]</sup> When
specifying an ordering over an element collection of embeddable type,
the dot notation must be used to specify the attribute or attributes
that determine the ordering.</p>
</div>
<div class="paragraph">
<p>The <em>OrderBy</em> annotation is not used when an
order column is specified. See <a href="#a15873">Section 11.1.43</a>.</p>
</div>
<div class="paragraph">
<p><a href="#a15828">Table 39</a> lists the annotation elements that may be specified
for the <em>OrderBy</em> annotation.</p>
</div>
<table id="a15828" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 39. OrderBy Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The list of attributes
(optionally qualified with ASC or DESC) whose values are used in the
ordering.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ascending ordering by the primary key.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Course</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span>
    <span class="annotation">@OrderBy</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">lastname ASC</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Student&gt; getStudents() { ... };

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Student</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">students</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@OrderBy</span> <span class="comment">// PK is assumed</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Course&gt; getCourses() { ... };

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ElementCollection</span>
    <span class="annotation">@OrderBy</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">zipcode.zip, zipcode.plusFour</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Address&gt; getResidences() { ... };

    <span class="comment">// ...</span>
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> street;
    <span class="directive">protected</span> <span class="predefined-type">String</span> city;
    <span class="directive">protected</span> <span class="predefined-type">String</span> state;

    <span class="annotation">@Embedded</span>
    <span class="directive">protected</span> Zipcode zipcode;
}

<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Zipcode</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> zip;
    <span class="directive">protected</span> <span class="predefined-type">String</span> plusFour;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15873"><a class="anchor" href="#a15873"></a>11.1.43. OrderColumn Annotation</h4>
<div class="paragraph">
<p>The <em>OrderColumn</em> annotation specifies
a column that is used to maintain the persistent order of a list. The
persistence provider is responsible for maintaining the order upon
retrieval and in the database. The persistence provider is responsible
for updating the ordering upon flushing to the database to reflect any
insertion, deletion, or reordering affecting the list. The <em>OrderColumn</em>
annotation may be specified on a one-to-many or many-to-many
relationship or on an element collection. The <em>OrderColumn</em> annotation
is specified on the side of the relationship that references the
collection that is to be ordered. The order column is not visible as
part of the state of the entity or embeddable
class.<sup class="footnote">[<a id="_footnoteref_117" class="footnote" href="#_footnotedef_117" title="View footnote.">117</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <em>OrderBy</em> annotation is not used when
<em>OrderColumn</em> is specified.</p>
</div>
<div class="paragraph">
<p><a href="#a15888">Table 40</a> lists the annotation elements that may be specified
for the <em>OrderColumn</em> annotation and their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OrderColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">boolean</span> nullable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> insertable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="type">boolean</span> updatable() <span class="keyword">default</span> <span class="predefined-constant">true</span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <em>name</em> is not specified, the column name
is the concatenation of the following: the name of the referencing
relationship property or field of the referencing entity or embeddable
class; " <em>_</em> "; " <em>ORDER</em> ".</p>
</div>
<div class="paragraph">
<p>The order column must be of integral type.
The persistence provider must maintain a contiguous (non-sparse)
ordering of the values of the order column when updating the association
or element collection. The order column value for the first element of
the list must be 0.</p>
</div>
<table id="a15888" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 40. OrderColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the ordering column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concatenation of the name of the referencing property or field; " <em>_</em> "; " <em>ORDER</em> ".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nullable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the database column is nullable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insertable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL INSERT statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updatable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Whether the column is included in
SQL UPDATE statements generated by the persistence provider.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used when generating the DDL for the column.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL to create a column of the inferred type.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">CreditCard</span> {
    <span class="annotation">@Id</span>
    <span class="type">long</span> ccNumber;

    <span class="annotation">@OneToMany</span> <span class="comment">// unidirectional</span>
    <span class="annotation">@OrderColumn</span>
    <span class="predefined-type">List</span>&lt;CardTransaction&gt; transactionHistory;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Course</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span>
    <span class="annotation">@JoinTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">COURSE_ENROLLMENT</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Student&gt; getStudents() { ... };

    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span> <span class="comment">// unidirectional</span>
    <span class="annotation">@JoinTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WAIT_LIST</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@OrderColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">WAITLIST_ORDER</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Student&gt; getWaitList()  { ... }
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Student</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@ManyToMany</span>(mappedBy=<span class="string"><span class="delimiter">&quot;</span><span class="content">students</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Course&gt; getCourses() { ... };

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example of querying the ordered list:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> w
<span class="keyword">FROM</span> course c <span class="keyword">JOIN</span> c.waitlist w
<span class="keyword">WHERE</span> c.name = <span class="string"><span class="delimiter">&quot;</span><span class="content">geometry</span><span class="delimiter">&quot;</span></span> <span class="keyword">AND</span> <span class="type">INDEX</span>(w) = <span class="integer">0</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a15947"><a class="anchor" href="#a15947"></a>11.1.44. PrimaryKeyJoinColumn Annotation</h4>
<div class="paragraph">
<p>The <em>PrimaryKeyJoinColumn</em> annotation
specifies a primary key column that is used as a foreign key to join to
another table.</p>
</div>
<div class="paragraph">
<p>The <em>PrimaryKeyJoinColumn</em> annotation is used
to join the primary table of an entity subclass in the JOINED mapping
strategy to the primary table of its superclass; it is used within a
<em>SecondaryTable</em> annotation to join a secondary table to a primary
table; and it may be used in a <em>OneToOne</em> mapping in which the primary
key of the referencing entity is used as a foreign
key<sup class="footnote">[<a id="_footnoteref_118" class="footnote" href="#_footnotedef_118" title="View footnote.">118</a>]</sup> to the referenced
entity<sup class="footnote">[<a id="_footnoteref_119" class="footnote" href="#_footnotedef_119" title="View footnote.">119</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> element is used to specify
or control the generation of a foreign key constraint for the primary
key join column when table generation is in effect. If the <em>foreignKey</em>
element is not specified, the persistence provider&#8217;s default foreign key
strategy will apply.</p>
</div>
<div class="paragraph">
<p><a href="#a15962">Table 41</a> lists the annotation elements
that may be specified for the <em>PrimaryKeyJoinColumn</em> annotation and
their default values.</p>
</div>
<div class="paragraph">
<p>If no <em>PrimaryKeyJoinColumn</em> annotation is
specified for a subclass in the JOINED mapping strategy, the foreign key
columns are assumed to have the same names as the primary key columns of
the primary table of the superclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(PrimaryKeyJoinColumns.class)
<span class="directive">public</span> <span class="annotation">@interface</span> PrimaryKeyJoinColumn {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> referencedColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> columnDefinition() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<table id="a15962" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 41. PrimaryKeyJoinColumn Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the primary key column of the current table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The same name
as the primary key column of the primary table of the superclass (JOINED
mapping strategy); the same name as the primary key column of the
primary table (SecondaryTable mapping); or the same name as the primary
key column for the table for the referencing entity (OneToOne mapping).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencedColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the primary key column of the table being joined to.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
same name as the primary key column of the primary table of the
superclass (JOINED mapping strategy); the same name as the primary key
column of the primary table (SecondaryTable mapping); or the same name
as the primary key column of the table for the referenced entity
(OneToOne mapping).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnDefinition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The SQL fragment that is used
when generating the DDL for the column. This should not be specified for
a OneToOne primary key association.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated SQL to create a column of the inferred type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join column. This is used only if table generation
is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong> Customer and ValuedCustomer subclass</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Inheritance</span>(strategy=JOINED)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="primarykeyjoincolumns-annotation"><a class="anchor" href="#primarykeyjoincolumns-annotation"></a>11.1.45. PrimaryKeyJoinColumns Annotation</h4>
<div class="paragraph">
<p>Composite foreign keys are supported by means
of the <em>PrimaryKeyJoinColumns</em> annotation. The <em>PrimaryKeyJoinColumns</em>
annotation groups <em>PrimaryKeyJoinColumn</em> annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> PrimaryKeyJoinColumns {
    PrimaryKeyJoinColumn<span class="type">[]</span> value();
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <em>PrimaryKeyJoinColumn</em> elements referenced by the
<em>value</em> element when table generation is in effect. If both this element
and the <em>foreignKey</em> element of any of the <em>PrimaryKeyJoinColumn</em>
elements are specified, the behavior is undefined. If no <em>foreignKey</em>
annotation element is specified in either location, the persistence
provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="paragraph">
<p><a href="#a16004">Table 42</a> lists the annotation elements
that may be specified for the <em>PrimaryKeyJoinColumns</em> annotation.</p>
</div>
<table id="a16004" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 42. PrimaryKeyJoinColumns Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PrimaryKeyJoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The primary key join columns.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint
specification for the join columns. This is used only if table
generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> ValuedCustomer subclass</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">VCUST</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumns</span>({
    <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_TYPE</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">TYPE</span><span class="delimiter">&quot;</span></span>)
})
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValuedCustomer</span> <span class="directive">extends</span> Customer { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> OneToOne relationship
between Employee and EmployeeInfo classes.<sup class="footnote">[<a id="_footnoteref_120" class="footnote" href="#_footnotedef_120" title="View footnote.">120</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">EmpPK</span> {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> id;
    <span class="directive">public</span> <span class="predefined-type">String</span> name;
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(com.acme.EmpPK.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Id</span>
    <span class="predefined-type">String</span> name;

    <span class="annotation">@OneToOne</span>
    <span class="annotation">@PrimaryKeyJoinColumns</span>({
        <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">NAME</span><span class="delimiter">&quot;</span></span>, referencedColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_NAME</span><span class="delimiter">&quot;</span></span>)
    })
    EmployeeInfo info;

    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="annotation">@IdClass</span>(com.acme.EmpPK.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmployeeInfo</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Integer</span> id;

    <span class="annotation">@Id</span>
    <span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_NAME</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> name;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16062"><a class="anchor" href="#a16062"></a>11.1.46. SecondaryTable Annotation</h4>
<div class="paragraph">
<p>The <em>SecondaryTable</em> annotation is used to
specify a secondary table for the annotated entity class.</p>
</div>
<div class="paragraph">
<p>If no <em>SecondaryTable</em> annotation is
specified, it is assumed that all persistent fields or properties of the
entity are mapped to the primary table. Specifying one or more secondary
tables indicates that the data for the entity class is stored across
multiple tables.</p>
</div>
<div class="paragraph">
<p><a href="#a16082">Table 43</a> lists the annotation elements that
may be specified for the <em>SecondaryTable</em> annotation and their default
values.</p>
</div>
<div class="paragraph">
<p>If no primary key join columns are specified,
the join columns are assumed to reference the primary key columns of the
primary table, and have the same names and types as the referenced
primary key columns of the primary table.</p>
</div>
<div class="paragraph">
<p>The <em>foreignKey</em> element is used to specify
or control the generation of a foreign key constraint for the columns
corresponding to the <em>pkJoinColumns</em> element when table generation is in
effect. If both this element and the <em>foreignKey</em> element of any of the
<em>pkJoinColumns</em> elements are specified, the behavior is undefined. If no
<em>foreignKey</em> annotation element is specified in either location, the
persistence provider&#8217;s default foreign key strategy will apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(SecondaryTables.class)
<span class="directive">public</span> <span class="annotation">@interface</span> SecondaryTable {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    PrimaryKeyJoinColumn<span class="type">[]</span> pkJoinColumns() <span class="keyword">default</span> {};
    ForeignKey foreignKey() <span class="keyword">default</span> <span class="annotation">@ForeignKey</span>(PROVIDER_DEFAULT);
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
<table id="a16082" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 43. SecondaryTable Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The name of the table.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PrimaryKeyJoinColumn[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkJoinColumns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The columns that are used to join with the primary table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column(s) of the same name(s) as the primary key column(s) in the primary table</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForeignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreignKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The foreign key constraint for
the join column. This is used only if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider&#8217;s default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are typically only used if table generation
is in effect. These constraints apply in addition to any constraints
specified by the Column and JoinColumn annotations and constraints
entailed by primary key mappings.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> Single secondary table with a single primary key column.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTable</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_DETAIL</span><span class="delimiter">&quot;</span></span>,
    pkJoinColumns=<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>)
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Single secondary table with multiple primary key columns.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOMER</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTable</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_DETAIL</span><span class="delimiter">&quot;</span></span>,
    pkJoinColumns={
        <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_ID</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_TYPE</span><span class="delimiter">&quot;</span></span>)
    })
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="secondarytables-annotation"><a class="anchor" href="#secondarytables-annotation"></a>11.1.47. SecondaryTables Annotation</h4>
<div class="paragraph">
<p>The <em>SecondaryTables</em> annotation can be used
to specify multiple secondary tables for an entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> SecondaryTables {
    SecondaryTable<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a16136">Table 44</a> lists the annotation elements that
may be specified for the <em>SecondaryTables</em> annotation.</p>
</div>
<table id="a16136" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 44. SecondaryTables Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SecondaryTable[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The secondary tables that are used to map the entity class.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong> Multiple secondary tables
assuming primary key columns are named the same in all tables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPLOYEE</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTables</span>({
    <span class="annotation">@SecondaryTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_DETAIL</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@SecondaryTable</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_HIST</span><span class="delimiter">&quot;</span></span>)
})
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Multiple secondary tables with differently named primary key columns.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPLOYEE</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTables</span>({
    <span class="annotation">@SecondaryTable</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_DETAIL</span><span class="delimiter">&quot;</span></span>,
        pkJoinColumns=<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPL_ID</span><span class="delimiter">&quot;</span></span>)),
    <span class="annotation">@SecondaryTable</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_HIST</span><span class="delimiter">&quot;</span></span>,
        pkJoinColumns=<span class="annotation">@PrimaryKeyJoinColumn</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPLOYEE_ID</span><span class="delimiter">&quot;</span></span>))
})
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16164"><a class="anchor" href="#a16164"></a>11.1.48. SequenceGenerator Annotation</h4>
<div class="paragraph">
<p>The <em>SequenceGenerator</em> annotation defines a
primary key generator that may be referenced by name when a generator
element is specified for the <em>GeneratedValue</em> annotation. A sequence
generator may be specified on the entity class or on the primary key
field or property. The scope of the generator name is global to the
persistence unit (across all generator types).</p>
</div>
<div class="paragraph">
<p><a href="#a16179">Table 45</a> lists the annotation elements
that may be specified for the <em>SequenceGenerator</em> annotation and their
default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(SequenceGenerators.class)
<span class="directive">public</span> <span class="annotation">@interface</span> SequenceGenerator {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> sequenceName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> initialValue() <span class="keyword">default</span> <span class="integer">1</span>;
    <span class="type">int</span> allocationSize() <span class="keyword">default</span> <span class="integer">50</span>;
}</code></pre>
</div>
</div>
<table id="a16179" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 45. SequenceGenerator Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) A unique generator name that can
be referenced by one or more classes to be the generator for primary key
values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sequenceName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the database sequence
object from which to obtain primary key values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider- chosen value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the sequence generator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the sequence generator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">initialValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The value from which the sequence
object is to start generating.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">allocationSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The amount to increment by when
allocating sequence numbers from the sequence.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SequenceGenerator</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_SEQ</span><span class="delimiter">&quot;</span></span>, allocationSize=<span class="integer">25</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16205"><a class="anchor" href="#a16205"></a>11.1.49. SequenceGenerators Annotation</h4>
<div class="paragraph">
<p>The SequenceGenerators annotation can be used
to specify multiple sequence generators.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> SequenceGenerators {
    SequenceGenerator<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 46. SequenceGenerators Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SequenceGenerator[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The sequence generator mappings</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="table-annotation"><a class="anchor" href="#table-annotation"></a>11.1.50. Table Annotation</h4>
<div class="paragraph">
<p>The <em>Table</em> annotation specifies the
primary table for the annotated entity. Additional tables may be
specified by using the <em>SecondaryTable</em> or <em>SecondaryTables</em>
annotation.<sup class="footnote">[<a id="_footnoteref_121" class="footnote" href="#_footnotedef_121" title="View footnote.">121</a>]</sup></p>
</div>
<div class="paragraph">
<p><a href="#a16232">Table 47</a> lists the annotation elements that may be specified
for the <em>Table</em> annotation and their default values.</p>
</div>
<div class="paragraph">
<p>If no <em>Table</em> annotation is specified for an
entity class, the default values defined in
<a href="#a16232">Table 47</a> apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Table {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
<table id="a16232" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 47. Table Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The name of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entity name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are only used if table generation is in
effect. These constraints apply in addition to any constraints specified
by the Column and JoinColumn annotations and constraints entailed by
primary key mappings.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional
constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CUST</span><span class="delimiter">&quot;</span></span>, schema=<span class="string"><span class="delimiter">&quot;</span><span class="content">RECORDS</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16256"><a class="anchor" href="#a16256"></a>11.1.51. TableGenerator Annotation</h4>
<div class="paragraph">
<p>The <em>TableGenerator</em> annotation defines a
primary key generator that may be referenced by name when a generator
element is specified for the <em>GeneratedValue</em> annotation. A table
generator may be specified on the entity class or on the primary key
field or property. The scope of the generator name is global to the
persistence unit (across all generator types).</p>
</div>
<div class="paragraph">
<p><a href="#a162771">Table 48</a> lists the annotation elements that
may be specified for the <em>TableGenerator</em> annotation and their default
values.</p>
</div>
<div class="paragraph">
<p>The <em>table</em> element specifies the name of the
table that is used by the persistence provider to store generated
primary key values for entities. An entity type will typically use its
own row in the table for the generation of primary key values. The
primary key values are normally positive integers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(TableGenerators.class)
<span class="directive">public</span> <span class="annotation">@interface</span> TableGenerator {
    <span class="predefined-type">String</span> name();
    <span class="predefined-type">String</span> table() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> catalog() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> schema() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> pkColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> valueColumnName() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span> pkColumnValue() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="type">int</span> initialValue() <span class="keyword">default</span> <span class="integer">0</span>;
    <span class="type">int</span> allocationSize() <span class="keyword">default</span> <span class="integer">50</span>;
    UniqueConstraint<span class="type">[]</span> uniqueConstraints() <span class="keyword">default</span> {};
    Index<span class="type">[]</span> indexes() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
<table id="a162771" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 48. TableGenerator Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) A unique generator name that can be referenced by one or more classes
to be the generator for primary key values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Name of table that stores the
generated primary key values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name is chosen by persistence provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The catalog of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The schema of the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default schema for user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Name of the primary key column in the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">valueColumnName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Name of the column that stores the last value generated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkColumnValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The primary key value in the
generator table that distinguishes this set of generated values from
others that may be stored in the table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen value to store in the primary key column of the
generator table</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">initialValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The value used to initialize the
column that stores the last value generated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">allocationSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The amount to increment by when
allocating numbers from the generator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UniqueConstraint[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueConstraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Unique constraints that are to be
placed on the table. These are only used if table generation is in
effect. These constraints apply in addition to primary key constraints.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional constraints</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Indexes for the table. These are
only used if table generation is in effect.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No additional indexes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@TableGenerator</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">empGen</span><span class="delimiter">&quot;</span></span>,
        table=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID_GEN</span><span class="delimiter">&quot;</span></span>,
        pkColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">GEN_KEY</span><span class="delimiter">&quot;</span></span>,
        valueColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">GEN_VALUE</span><span class="delimiter">&quot;</span></span>,
        pkColumnValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>,
        allocationSize=<span class="integer">1</span>)
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy=TABLE, generator=<span class="string"><span class="delimiter">&quot;</span><span class="content">empGen</span><span class="delimiter">&quot;</span></span>)
    <span class="type">int</span> id;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="comment">// ...</span>

    <span class="annotation">@TableGenerator</span>(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">addressGen</span><span class="delimiter">&quot;</span></span>,
        table=<span class="string"><span class="delimiter">&quot;</span><span class="content">ID_GEN</span><span class="delimiter">&quot;</span></span>,
        pkColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">GEN_KEY</span><span class="delimiter">&quot;</span></span>,
        valueColumnName=<span class="string"><span class="delimiter">&quot;</span><span class="content">GEN_VALUE</span><span class="delimiter">&quot;</span></span>,
        pkColumnValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy=TABLE, generator=<span class="string"><span class="delimiter">&quot;</span><span class="content">addressGen</span><span class="delimiter">&quot;</span></span>)
    <span class="type">int</span> id;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tablegenerators-annotation"><a class="anchor" href="#tablegenerators-annotation"></a>11.1.52. TableGenerators Annotation</h4>
<div class="paragraph">
<p>The TableGenerators annotation can be used to
specify multiple table generators.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> TableGenerators {
    TableGenerator<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 49. TableGenerators Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TableGenerator[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The table generator mappings</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="a16361"><a class="anchor" href="#a16361"></a>11.1.53. Temporal Annotation</h4>
<div class="paragraph">
<p>The <em>Temporal</em> annotation must be specified
for persistent fields or properties of type <em>java.util.Date</em> and
<em>java.util.Calendar</em> unless a converter is being applied. It may only be
specified for fields or properties of these types.</p>
</div>
<div class="paragraph">
<p>The <em>Temporal</em> annotation may be used in
conjunction with the <em>Basic</em> annotation, the <em>Id</em> annotation, or the
_ElementCollection_<sup class="footnote">[<a id="_footnoteref_122" class="footnote" href="#_footnotedef_122" title="View footnote.">122</a>]</sup> annotation (when the element
collection value is of such a temporal type).</p>
</div>
<div class="paragraph">
<p>The <em>TemporalType</em> enum defines the mapping for these temporal types.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> TemporalType {
    DATE, <span class="comment">//java.sql.Date</span>
    TIME, <span class="comment">//java.sql.Time</span>
    TIMESTAMP <span class="comment">//java.sql.Timestamp</span>
}

<span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Temporal {
    TemporalType value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#a16378">Table 50</a> lists the annotation elements that may be specified
for the <em>Temporal</em> annotation and their default values.</p>
</div>
<table id="a16378" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 50. Temporal Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TemporalType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) The type used in mapping java.util.Date or java.util.Calendar.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmploymentPeriod</span> {
    <span class="annotation">@Temporal</span>(DATE)
    java.util.Date startDate;

    <span class="annotation">@Temporal</span>(DATE)
    java.util.Date endDate;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="transient-annotation"><a class="anchor" href="#transient-annotation"></a>11.1.54. Transient Annotation</h4>
<div class="paragraph">
<p>The <em>Transient</em> annotation is used to
annotate a property or field of an entity class, mapped superclass, or
embeddable class. It specifies that the property or field is not
persistent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Transient {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> {
    <span class="annotation">@Id</span>
    <span class="type">int</span> id;

    <span class="annotation">@Transient</span>
    User currentUser;

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16403"><a class="anchor" href="#a16403"></a>11.1.55. UniqueConstraint Annotation</h4>
<div class="paragraph">
<p>The <em>UniqueConstraint</em> annotation is used to
specify that a unique constraint is to be included in the generated DDL
for a primary or secondary table.</p>
</div>
<div class="paragraph">
<p><a href="#a16413">Table 51</a> lists the annotation elements that
may be specified for the <em>UniqueConstraint</em> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> UniqueConstraint {
    <span class="predefined-type">String</span> name() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">String</span><span class="type">[]</span> columnNames();
}</code></pre>
</div>
</div>
<table id="a16413" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 51. UniqueConstraint Annotation Elements</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Constraint name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A provider-chosen name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">columnNames</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Required) An array of the column names that make up the constraint.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(
    name=<span class="string"><span class="delimiter">&quot;</span><span class="content">EMPLOYEE</span><span class="delimiter">&quot;</span></span>,
    uniqueConstraints=<span class="annotation">@UniqueConstraint</span>(columnNames={<span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_NAME</span><span class="delimiter">&quot;</span></span>})
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a16432"><a class="anchor" href="#a16432"></a>11.1.56. Version Annotation</h4>
<div class="paragraph">
<p>The <em>Version</em> annotation specifies the
version field or property of an entity class that serves as its
optimistic lock value. The version is used to ensure integrity when
performing the merge operation and for optimistic concurrency control.</p>
</div>
<div class="paragraph">
<p>Only a single <em>Version</em> property or field
should be used per class; applications that use more than one <em>Version</em>
property or field will not be portable.</p>
</div>
<div class="paragraph">
<p>The <em>Version</em> property should be mapped to
the primary table for the entity class; applications that map the
<em>Version</em> property to a table other than the primary table will not be
portable.</p>
</div>
<div class="paragraph">
<p>In general, fields or properties that
are specified with the <em>Version</em> annotation should not be updated by the
application.<sup class="footnote">[<a id="_footnoteref_123" class="footnote" href="#_footnotedef_123" title="View footnote.">123</a>]</sup></p>
</div>
<div class="paragraph">
<p>The following types are supported for version
properties: <em>int</em>, <em>Integer</em>, <em>short</em>, <em>Short</em>, <em>long</em>, <em>Long</em>,
<em>Timestamp</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Version {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Version</span>
<span class="annotation">@Column</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">OPTLOCK</span><span class="delimiter">&quot;</span></span>)
<span class="directive">protected</span> <span class="type">int</span> getVersionNum() { <span class="keyword">return</span> versionNum; }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a16444"><a class="anchor" href="#a16444"></a>11.2. Object/Relational Metadata Used in Schema Generation</h3>
<div class="paragraph">
<p>The following annotations and XML elements
define or control the generation of database objects. If schema
generation is in effect, the persistence provider must observe the
mapping information specified by these annotations and their
corresponding XML elements. Unless otherwise specified, all elements of
these annotations are observed in the schema generation process.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>CollectionTable</em></p>
</li>
<li>
<p><em>Column</em></p>
</li>
<li>
<p><em>DiscriminatorColumn</em></p>
</li>
<li>
<p><em>EmbeddedId</em></p>
</li>
<li>
<p><em>Enumerated, MapKeyEnumerated</em></p>
</li>
<li>
<p><em>ForeignKey</em></p>
</li>
<li>
<p><em>GeneratedValue</em></p>
</li>
<li>
<p><em>Id</em></p>
</li>
<li>
<p><em>Index</em></p>
</li>
<li>
<p><em>Inheritance</em></p>
</li>
<li>
<p><em>JoinColumn</em></p>
</li>
<li>
<p><em>JoinTable</em></p>
</li>
<li>
<p><em>Lob</em></p>
</li>
<li>
<p><em>MapKeyColumn</em></p>
</li>
<li>
<p><em>MapKeyJoinColumn</em></p>
</li>
<li>
<p><em>OrderColumn</em></p>
</li>
<li>
<p><em>PrimaryKeyJoinColumn</em></p>
</li>
<li>
<p><em>SecondaryTable</em></p>
</li>
<li>
<p><em>SequenceGenerator</em></p>
</li>
<li>
<p><em>Table</em></p>
</li>
<li>
<p><em>TableGenerator</em></p>
</li>
<li>
<p><em>Temporal, MapKeyTemporal</em></p>
</li>
<li>
<p><em>UniqueConstraint</em></p>
</li>
<li>
<p><em>Version</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In some cases, these annotations and elements
may be specified explicitly, while in other cases they may be implied by
the default values of other annotations or elements. For example, by
default a table is generated corresponding to an entity and bears the
same name as that assigned to the entity (which in turn may have been
defaulted from the name of the entity class).</p>
</div>
<div class="paragraph">
<p>The naming of database objects is determined
by the defaulting rules and the explicit names used in annotations
and/or XML. The names of database objects must be treated in conformance
with the requirements of <a href="#a988">Section 2.13</a>.</p>
</div>
<div class="paragraph">
<p>The metadata annotations and corresponding
XML elements that result in generated objects are as follows.</p>
</div>
<div class="sect3">
<h4 id="table-level-elements"><a class="anchor" href="#table-level-elements"></a>11.2.1. Table-level elements</h4>
<div class="paragraph">
<p>The following annotations (and corresponding
XML elements) specify the creation of tables. The rules for their
naming, columns, and other properties are defined in the referenced
sections of this specification:</p>
</div>
<div class="sect4">
<h5 id="table"><a class="anchor" href="#table"></a>11.2.1.1. Table</h5>
<div class="paragraph">
<p>By default, a table is created for every
top-level entity and, by default, includes columns corresponding to the
basic and embedded attributes of the entity and the foreign keys to the
tables of related entities. These columns include columns that result
from the use of mapped superclasses, if any. The <em>SecondaryTable</em>
annotation, in conjunction with the use of the <em>table</em> element of the
<em>Column</em> and <em>JoinColumn</em> annotations, is used to override this mapping
to partition the state of an entity across multiple tables.</p>
</div>
<div class="paragraph">
<p>The mapping of the columns of a table is
controlled by the <em>Column</em> and <em>JoinColumn</em> annotations. When entity
state is inherited from a mapped superclass, the <em>AttributeOverride</em> and
<em>AssociationOverride</em> annotations may be used to further control the
column-level mapping of inherited state. The ordering of the columns is
not defined by this specification. When it is desirable to control the
ordering of columns, DDL scripts should be provided.</p>
</div>
<div class="paragraph">
<p>See <a href="#a16205">Section 11.1.49</a> for additional rules that apply to the
generation of tables. For the treatment of column-level mappings, see
further below.</p>
</div>
</div>
<div class="sect4">
<h5 id="inheritance-2"><a class="anchor" href="#inheritance-2"></a>11.2.1.2. Inheritance</h5>
<div class="paragraph">
<p>The <em>Inheritance</em> annotation defines the
inheritance strategy for an entity hierarchy. The inheritance strategy
determines whether the table for a top-level entity includes columns for
entities that inherit from the entity and whether it includes a
discriminator column, or whether separate tables are created for each
entity type that inherits from the top-level entity. See <a href="#a966">Section 2.12</a> and
<a href="#a14891">Section 11.1.24</a> for rules
pertaining to the treatment of entity inheritance.</p>
</div>
</div>
<div class="sect4">
<h5 id="secondarytable"><a class="anchor" href="#secondarytable"></a>11.2.1.3. SecondaryTable</h5>
<div class="paragraph">
<p>A secondary table is created to partition the
mapping of entity state across multiple tables. See <a href="#a16062">Section 11.1.46</a> for the rules
that apply to the generation of secondary tables.</p>
</div>
</div>
<div class="sect4">
<h5 id="collectiontable"><a class="anchor" href="#collectiontable"></a>11.2.1.4. CollectionTable</h5>
<div class="paragraph">
<p>A collection table is created for the mapping
of an element collection. See <a href="#a14250">Section 11.1.8</a> for the rules that apply to the generation
of collection tables. The <em>Column</em>, <em>AttributeOverride</em>, and
<em>AssociationOverride</em> annotations may be used to override
<em>CollectionTable</em> mappings, as described in <a href="#a14330">Section 11.1.9</a>,
<a href="#a14084">Section 11.1.4</a>, and <a href="#a13942">Section 11.1.2</a> respectively.</p>
</div>
</div>
<div class="sect4">
<h5 id="jointable"><a class="anchor" href="#jointable"></a>11.2.1.5. JoinTable</h5>
<div class="paragraph">
<p>By default, join tables are created for the
mapping of many-to-many relationships and unidirectional one-to-many
relationships. See <a href="#a708">Section 2.10.4</a>, <a href="#a764">Section 2.10.5.1</a>, and
<a href="#a800">Section 2.10.5.2</a> for the defaults that apply in such cases. Join tables may also be used
to map bidirectional many-to-one/one-to-many associations,
unidirectional many-to-one relationships, and one-to-one relationships
(both bidirectional and unidirectional). See <a href="#a15022">Section 11.1.27</a> for the rules that
apply to the generation of join tables. The <em>AssociationOverride</em>
annotation may be used to override join table mappings.</p>
</div>
</div>
<div class="sect4">
<h5 id="tablegenerator"><a class="anchor" href="#tablegenerator"></a>11.2.1.6. TableGenerator</h5>
<div class="paragraph">
<p>Table generator tables are used to store
generated primary key values. See <a href="#a16256">Section 11.1.51</a> for the rules
pertaining to table generators.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="column-level-elements"><a class="anchor" href="#column-level-elements"></a>11.2.2. Column-level elements</h4>
<div class="paragraph">
<p>The following annotations and corresponding
XML elements control the mapping of columns in generated tables.</p>
</div>
<div class="paragraph">
<p>The exact mapping of Java language types to
database-specific types is not defined by this specification, as
databases vary in the specific types that they support. In general,
however, an implementation of this specification should conform to the
“Standard Mapping from Java Types to JDBC Types” as defined by the JDBC
specification <a href="#a19496">[3]</a>. Unless otherwise explicitly
specified, however, VARCHAR and VARBINARY mappings should be used in
preference to CHAR and BINARY mappings. Applications that are sensitive
to the exact database mappings that are generated should use the
<em>columnDefinition</em> element of the <em>Column</em> annotation or include DDL
files that specify how the database schema is to be generated.</p>
</div>
<div class="sect4">
<h5 id="column"><a class="anchor" href="#column"></a>11.2.2.1. Column</h5>
<div class="paragraph">
<p>The following elements of the <em>Column</em>
annotation are used in schema generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>name</em></p>
</li>
<li>
<p><em>unique</em></p>
</li>
<li>
<p><em>nullable</em></p>
</li>
<li>
<p><em>columnDefinition</em></p>
</li>
<li>
<p><em>table</em></p>
</li>
<li>
<p><em>length</em> (string-valued columns only)</p>
</li>
<li>
<p><em>precision</em> (exact numeric (decimal/numeric) columns only)</p>
</li>
<li>
<p><em>scale</em> (exact numeric (decimal/numeric) columns only)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a14330">Section 11.1.9</a> for the rules that apply to these elements and column
creation. The <em>AttributeOverride</em> annotation may be used to override
column mappings.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapkeycolumn"><a class="anchor" href="#mapkeycolumn"></a>11.2.2.2. MapKeyColumn</h5>
<div class="paragraph">
<p>The <em>MapKeyColumn</em> annotation specifies the
mapping for a key column of a map when the key is of basic type. The
following elements of the <em>MapKeyColumn</em> annotation are used in schema
generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>name</em></p>
</li>
<li>
<p><em>unique</em></p>
</li>
<li>
<p><em>nullable</em></p>
</li>
<li>
<p><em>columnDefinition</em></p>
</li>
<li>
<p><em>table</em></p>
</li>
<li>
<p><em>length</em> (string-valued columns only)</p>
</li>
<li>
<p><em>precision</em> (exact numeric (decimal/numeric) columns only)</p>
</li>
<li>
<p><em>scale</em> (exact numeric (decimal/numeric) columns only)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a15367">Section 11.1.33</a> for the rules that apply to these elements and
map key column creation. The <em>AttributeOverride</em> annotation may be used
to override map key column mappings.</p>
</div>
</div>
<div class="sect4">
<h5 id="enumerated-mapkeyenumerated"><a class="anchor" href="#enumerated-mapkeyenumerated"></a>11.2.2.3. Enumerated, MapKeyEnumerated</h5>
<div class="paragraph">
<p>The <em>Enumerated</em> and <em>MapKeyEnumerated</em>
annotations control whether string- or integer-valued columns are
generated for basic attributes of enumerated types and therefore impact
the default column mappings for these types. See <a href="#a14719">Section 11.1.18</a> and
<a href="#a15433">Section 11.1.34</a>. The
<em>Column</em> and <em>MapKeyColumn</em> annotations may be used to further control
the column mappings for attributes of enumerated types.</p>
</div>
</div>
<div class="sect4">
<h5 id="temporal-mapkeytemporal"><a class="anchor" href="#temporal-mapkeytemporal"></a>11.2.2.4. Temporal, MapKeyTemporal</h5>
<div class="paragraph">
<p>The <em>Temporal</em> and <em>MapKeyTemporal</em>
annotations control whether date-, time-, or timestamp-value columns are
generated for basic attributes of temporal types, and therefore impact
the default column mappings for these types. See <a href="#a16361">Section 11.1.53</a> and
<a href="#a15583">Section 11.1.37</a>. The <em>Column</em>
and <em>MapKeyColumn</em> annotations may be used to further control the column
mappings for attributes of temporal types.</p>
</div>
</div>
<div class="sect4">
<h5 id="lob"><a class="anchor" href="#lob"></a>11.2.2.5. Lob</h5>
<div class="paragraph">
<p>The <em>Lob</em> annotation specifies that a
persistent attribute is to be persisted to a database large object type.
See <a href="#a15087">Section 11.1.28</a>. In general,
however, the treatment of the <em>Lob</em> annotation is provider-dependent.
Applications that are sensitive to the exact mapping that is used should
use the <em>columnDefinition</em> element of the <em>Column</em> annotation or include
DDL files that specify how the database schema is to be generated.</p>
</div>
</div>
<div class="sect4">
<h5 id="ordercolumn"><a class="anchor" href="#ordercolumn"></a>11.2.2.6. OrderColumn</h5>
<div class="paragraph">
<p>The <em>OrderColumn</em> annotation specifies the
generation of a column that is used to maintain the persistent ordering
of a list that is represented in an element collection, one-to-many, or
many-to-many relationship.</p>
</div>
<div class="paragraph">
<p>The following elements of the <em>OrderColumn</em>
annotation are used in schema generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>name</em></p>
</li>
<li>
<p><em>nullable</em></p>
</li>
<li>
<p><em>columnDefinition</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a15873">Section 11.1.43</a> for the rules that pertain to the generation of order columns.</p>
</div>
</div>
<div class="sect4">
<h5 id="discriminatorcolumn"><a class="anchor" href="#discriminatorcolumn"></a>11.2.2.7. DiscriminatorColumn</h5>
<div class="paragraph">
<p>A discriminator column is generated for the
SINGLE_TABLE mapping strategy and may optionally be generated by the
provider for use with the JOINED inheritance strategy. The
<em>DiscriminatorColumn</em> annotation may be used to control the mapping of
the discriminator column. See <a href="#a14530">Section 11.1.12</a> for the rules that pertain to
discriminator columns.</p>
</div>
</div>
<div class="sect4">
<h5 id="version"><a class="anchor" href="#version"></a>11.2.2.8. Version</h5>
<div class="paragraph">
<p>The <em>Version</em> annotation specifies the
generation of a column to serve as an entity&#8217;s optimistic lock. See
<a href="#a16432">Section 11.1.56</a> for rules
that pertain to the version column. The <em>Column</em> annotation may be used
to further control the column mapping for a version attribute.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="primary-key-mappings"><a class="anchor" href="#primary-key-mappings"></a>11.2.3. Primary Key mappings</h4>
<div class="paragraph">
<p>Primary keys may be represented by basic or
embedded attributes and/or may correspond to foreign key attributes. The
<em>Id</em> and <em>EmbeddedId</em> annotations define attributes whose corresponding
columns are the constituents of database primary keys.</p>
</div>
<div class="sect4">
<h5 id="id"><a class="anchor" href="#id"></a>11.2.3.1. Id</h5>
<div class="paragraph">
<p>The <em>Id</em> annotation (which may be used used
in conjunction with the <em>IdClass</em> annotation) is used to specify
attributes whose database columns correspond to a primary key. Use of
the <em>Id</em> annotation results in the creation of a primary key consisting
of the corresponding column or columns. Rules for the <em>Id</em> annotation
are described in <a href="#a14827">Section 11.1.21</a> and <a href="#a132">Section 2.4</a>.</p>
</div>
<div class="paragraph">
<p>The <em>Column</em> annotation may be used to
further control the column mapping for an <em>Id</em> attribute that is applied
to a basic type. If the <em>Id</em> column was defined in a mapped superclass,
the <em>AttributeOverride</em> annotation may be used to control the column
mapping.</p>
</div>
<div class="paragraph">
<p>The <em>JoinColumn</em> annotation may be used to
further control the column mappings for an <em>Id</em> attribute that is
applied to a relationship that corresponds to a foreign key. If the <em>Id</em>
attribute was defined in a mapped superclass, the <em>AssociationOverride</em>
annotation may be used to control the column mapping.</p>
</div>
</div>
<div class="sect4">
<h5 id="embeddedid"><a class="anchor" href="#embeddedid"></a>11.2.3.2. EmbeddedId</h5>
<div class="paragraph">
<p>The <em>EmbeddedId</em> annotation specifies an
embedded attribute whose corresponding columns correspond to a database
primary key. Use of the <em>EmbeddedId</em> annotation results in the creation
of a primary key consisting of the corresponding columns. Rules for the
<em>EmbeddedId</em> annotation are described in <a href="#a14687">Section 11.1.17</a> and <a href="#a132">Section 2.4</a>.</p>
</div>
<div class="paragraph">
<p>The <em>Column</em> annotation may be used to
control the column mapping for an embeddable class. If the <em>EmbeddedId</em>
attribute is defined in a mapped superclass, the <em>AttributeOverride</em>
annotation may be used to control the column mappings.</p>
</div>
<div class="paragraph">
<p>If an <em>EmbeddedId</em> attribute corresponds to a
relationship attribute, the <em>MapsId</em> annotation must be used, and the
column mapping is determined by the join column for the relationship.
See <a href="#a149">Section 2.4.1</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="generatedvalue"><a class="anchor" href="#generatedvalue"></a>11.2.3.3. GeneratedValue</h5>
<div class="paragraph">
<p>The <em>GeneratedValue</em> annotation indicates a
primary key whose value is to be generated by the provider. If a
strategy is indicated, the provider must use it if it is supported by
the target database. Note that specification of the AUTO strategy may
result in the provider creating a database object for Id generation
(e.g., a database sequence). Rules for the <em>GeneratedValue</em> annotation
are described in <a href="#a14790">Section 11.1.20</a>. The <em>GeneratedValue</em> annotation may only be portably used
for simple (i.e., non-composite) primary keys.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="foreign-key-column-mappings"><a class="anchor" href="#foreign-key-column-mappings"></a>11.2.4. Foreign Key Column Mappings</h4>
<div class="sect4">
<h5 id="joincolumn"><a class="anchor" href="#joincolumn"></a>11.2.4.1. JoinColumn</h5>
<div class="paragraph">
<p>The <em>JoinColumn</em> annotation is typically used
in specifying a foreign key mapping. In general, the foreign key
definitions created will be provider-dependent and database-dependent.
Applications that are sensitive to the exact mapping that is used should
use the <em>foreignKey</em> element of the <em>JoinColumn</em> annotation or include
DDL files that specify how the database schemas are to be generated.</p>
</div>
<div class="paragraph">
<p>The following elements of the <em>JoinColumn</em>
annotation are used in schema generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>name</em></p>
</li>
<li>
<p><em>referencedColumnName</em></p>
</li>
<li>
<p><em>unique</em></p>
</li>
<li>
<p><em>nullable</em></p>
</li>
<li>
<p><em>columnDefinition</em></p>
</li>
<li>
<p><em>table</em></p>
</li>
<li>
<p><em>foreignKey</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a14922">Section 11.1.25</a> for rules that apply to these elements and join
column creation, and sections <a href="#a538">Section 2.10</a> and <a href="#a14250">Section 11.1.8</a> for the rules that apply for the default
mappings of foreign keys for relationships and element collections. The
<em>AssociationOverride</em> annotation may be used to override relationship
mappings. The <em>PrimaryKeyJoinColumn</em> annotation is used to join
secondary tables and may be used in the mapping of one-to-one
relationships. See <a href="#a16567">Section 11.2.4.3</a> below.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapkeyjoincolumn"><a class="anchor" href="#mapkeyjoincolumn"></a>11.2.4.2. MapKeyJoinColumn</h5>
<div class="paragraph">
<p>The <em>MapKeyJoinColumn</em> annotation is to
specify foreign key mappings to entities that are map keys in map-valued
element collections or relationships. In general, the foreign key
definitions created should be expected to be provider-dependent and
database-dependent. Applications that are sensitive to the exact mapping
that is used should use the <em>foreignKey</em> element of the
<em>MapKeyJoinColumn</em> annotation or include DDL files that specify how the
database schemas are to be generated.</p>
</div>
<div class="paragraph">
<p>The following elements of the
<em>MapKeyJoinColumn</em> annotation are used in schema generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>name</em></p>
</li>
<li>
<p><em>referencedColumnName</em></p>
</li>
<li>
<p><em>unique</em></p>
</li>
<li>
<p><em>nullable</em></p>
</li>
<li>
<p><em>columnDefinition</em></p>
</li>
<li>
<p><em>table</em></p>
</li>
<li>
<p><em>foreignKey</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#a15450">Section 11.1.35</a> for rules that apply to these elements and
map key join column creation. The <em>AssociationOverride</em> annotation may
be used to override such mappings.</p>
</div>
</div>
<div class="sect4">
<h5 id="a16567"><a class="anchor" href="#a16567"></a>11.2.4.3. PrimaryKeyJoinColumn</h5>
<div class="paragraph">
<p>The <em>PrimaryKeyJoinColumn</em> annotation
specifies that a primary key column is to be used as a foreign key. This
annotation is used in the specification of the JOINED mapping strategy
and for joining a secondary table to a primary table in a OneToOne
relationship mapping. In general, the foreign key definitions created
should be expected to be provider-dependent and database-dependent.
Applications that are sensitive to the exact mapping that is used should
use the <em>foreignKey</em> element of the <em>PrimaryKeyJoinColumn</em> annotation or
include DDL files that specify how the database schemas are to be
generated. See <a href="#a15947">Section 11.1.44</a> for rules pertaining to the
<em>PrimaryKeyJoinColumn</em> annotation.</p>
</div>
</div>
<div class="sect4">
<h5 id="foreignkey"><a class="anchor" href="#foreignkey"></a>11.2.4.4. ForeignKey</h5>
<div class="paragraph">
<p>The <em>ForeignKey</em> annotation may be used
within the <em>JoinColumn</em>, <em>JoinColumns</em>, <em>MapKeyJoinColumn</em>,
<em>MapKeyJoinColumns</em>, <em>PrimaryKeyJoinColumn</em>, <em>PrimaryKeyJoinColumns</em>,
<em>CollectionTable</em>, <em>JoinTable</em>, <em>SecondaryTable</em>, and
<em>AssociationOverride</em> annotations to specify or override a foreign key
constraint. See <a href="#a14754">Section 11.1.19</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="other-elements"><a class="anchor" href="#other-elements"></a>11.2.5. Other Elements</h4>
<div class="sect4">
<h5 id="sequencegenerator"><a class="anchor" href="#sequencegenerator"></a>11.2.5.1. SequenceGenerator</h5>
<div class="paragraph">
<p>The <em>SequenceGenerator</em> annotation creates a
database sequence to be used for Id generation. The use of generators is
limited to those databases that support them. See <a href="#a16164">Section 11.1.48</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="index"><a class="anchor" href="#index"></a>11.2.5.2. Index</h5>
<div class="paragraph">
<p>The <em>Index</em> annotation generates an index
consisting of the specified columns. The ordering of the names in the
<em>columnList</em> element specified in the <em>Index</em> annotation must be
observed by the provider when creating the index. See <a href="#a14862">Section 11.1.23</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="uniqueconstraint"><a class="anchor" href="#uniqueconstraint"></a>11.2.5.3. UniqueConstraint</h5>
<div class="paragraph">
<p>The <em>UniqueConstraint</em> annotation generates a
unique constraint for the given table. Databases typically implement
unique constraints by creating unique indexes. The ordering of the
<em>columnNames</em> specified in the <em>UniqueConstraint</em> annotation must be
observed by the provider when creating the constraint. See <a href="#a16403">Section 11.1.55</a>. The
<em>unique</em> element of the <em>Column</em>, <em>JoinColumn</em>, <em>MapKeyColumn</em>, and
<em>MapKeyJoinColumn</em> annotations is equivalent to the use of the
<em>UniqueConstraint</em> annotation when only one column is to be included in
the constraint.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-of-the-application-of-annotations-for-objectrelational-mapping"><a class="anchor" href="#examples-of-the-application-of-annotations-for-objectrelational-mapping"></a>11.3. Examples of the Application of Annotations for Object/Relational Mapping</h3>
<div class="sect3">
<h4 id="examples-of-simple-mappings"><a class="anchor" href="#examples-of-simple-mappings"></a>11.3.1. Examples of Simple Mappings</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = AUTO)
    <span class="predefined-type">Long</span> id;

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="type">int</span> version;

    <span class="annotation">@ManyToOne</span>
    Address address;

    <span class="annotation">@Basic</span>
    <span class="predefined-type">String</span> description;

    <span class="annotation">@OneToMany</span>(targetEntity = com.acme.Order.class,
               mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span> orders = <span class="keyword">new</span> <span class="predefined-type">Vector</span>();

    <span class="annotation">@ManyToMany</span>(mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">customers</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Set</span>&lt;DeliveryService&gt; serviceOptions = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>();

    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> Address getAddress() {
        <span class="keyword">return</span> address;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address addr) {
        <span class="local-variable">this</span>.address = addr;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getDescription() {
        <span class="keyword">return</span> description;
    }

    <span class="directive">public</span> <span class="type">void</span> setDescription(<span class="predefined-type">String</span> desc) {
        <span class="local-variable">this</span>.description = desc;
    }

    <span class="directive">public</span> <span class="predefined-type">Collection</span> getOrders() {
        <span class="keyword">return</span> orders;
    }

    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;DeliveryService&gt; getServiceOptions() {
        <span class="keyword">return</span> serviceOptions;
    }
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> street;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = AUTO)
    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">protected</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Version</span>
    <span class="directive">public</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getStreet() {
        <span class="keyword">return</span> street;
    }

    <span class="directive">public</span> <span class="type">void</span> setStreet(<span class="predefined-type">String</span> street) {
        <span class="local-variable">this</span>.street = street;
    }
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> itemName;
    <span class="directive">private</span> <span class="type">int</span> quantity;
    <span class="directive">private</span> Customer cust;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = AUTO)
    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Version</span>
    <span class="directive">protected</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getItemName() {
        <span class="keyword">return</span> itemName;
    }

    <span class="directive">public</span> <span class="type">void</span> setItemName(<span class="predefined-type">String</span> itemName) {
        <span class="local-variable">this</span>.itemName = itemName;
    }

    <span class="directive">public</span> <span class="type">int</span> getQuantity() {
        <span class="keyword">return</span> quantity;
    }

    <span class="directive">public</span> <span class="type">void</span> setQuantity(<span class="type">int</span> quantity) {
        <span class="local-variable">this</span>.quantity = quantity;
    }

    <span class="annotation">@ManyToOne</span>
    <span class="directive">public</span> Customer getCustomer() {
        <span class="keyword">return</span> cust;
    }

    <span class="directive">public</span> <span class="type">void</span> setCustomer(Customer cust) {
        <span class="local-variable">this</span>.cust = cust;
    }
}

<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">DLVY_SVC</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">DeliveryService</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> serviceName;
    <span class="directive">private</span> <span class="type">int</span> priceCategory;
    <span class="directive">private</span> <span class="predefined-type">Collection</span> customers;

    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getServiceName() {
        <span class="keyword">return</span> serviceName;
    }

    <span class="directive">public</span> <span class="type">void</span> setServiceName(<span class="predefined-type">String</span> serviceName) {
        <span class="local-variable">this</span>.serviceName = serviceName;
    }

    <span class="directive">public</span> <span class="type">int</span> getPriceCategory() {
        <span class="keyword">return</span> priceCategory;
    }

    <span class="directive">public</span> <span class="type">void</span> setPriceCategory(<span class="type">int</span> priceCategory) {
        <span class="local-variable">this</span>.priceCategory = priceCategory;
    }

    <span class="annotation">@ManyToMany</span>(targetEntity = com.acme.Customer.class)
    <span class="annotation">@JoinTable</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">CUST_DLVRY</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Collection</span> getCustomers() {
        <span class="keyword">return</span> customers;
    }

    <span class="directive">public</span> setCustomers(<span class="predefined-type">Collection</span> customers) {
        <span class="local-variable">this</span>.customers = customers;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a-more-complex-example"><a class="anchor" href="#a-more-complex-example"></a>11.3.2. A More Complex Example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/***** Employee class *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMPL</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SecondaryTable</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_SALARY</span><span class="delimiter">&quot;</span></span>,
                pkJoinColumns = <span class="annotation">@PrimaryKeyJoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="directive">private</span> Address address;
    <span class="directive">private</span> <span class="predefined-type">Collection</span> phoneNumbers;
    <span class="directive">private</span> <span class="predefined-type">Collection</span>&lt;Project&gt; projects;
    <span class="directive">private</span> <span class="predefined-type">Long</span> salary;
    <span class="directive">private</span> EmploymentPeriod period;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = TABLE)
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">protected</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Version</span>
    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_VERSION</span><span class="delimiter">&quot;</span></span>, nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_NAME</span><span class="delimiter">&quot;</span></span>, length = <span class="integer">80</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="annotation">@ManyToOne</span>(cascade = PERSIST, optional = <span class="predefined-constant">false</span>)
    <span class="annotation">@JoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">ADDR_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>, nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> Address getAddress() {
        <span class="keyword">return</span> address;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) {
        <span class="local-variable">this</span>.address = address;
    }

    <span class="annotation">@OneToMany</span>(targetEntity = com.acme.PhoneNumber.class,
               cascade = ALL,
               mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">employee</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Collection</span> getPhoneNumbers() {
        <span class="keyword">return</span> phoneNumbers;
    }

    <span class="directive">public</span> <span class="type">void</span> setPhoneNumbers(<span class="predefined-type">Collection</span> phoneNumbers) {
        <span class="local-variable">this</span>.phoneNumbers = phoneNumbers;
    }

    <span class="annotation">@ManyToMany</span>(cascade = PERSIST, mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">employees</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@JoinTable</span>(
        name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_PROJ</span><span class="delimiter">&quot;</span></span>,
        joinColumns = <span class="annotation">@JoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>),
        inverseJoinColumns = <span class="annotation">@JoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">PROJ_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>))
    <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;Project&gt; getProjects() {
        <span class="keyword">return</span> projects;
    }

    <span class="directive">public</span> <span class="type">void</span> setProjects(<span class="predefined-type">Collection</span>&lt;Project&gt; projects) {
        <span class="local-variable">this</span>.projects = projects;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_SAL</span><span class="delimiter">&quot;</span></span>, table = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_SALARY</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Long</span> getSalary() {
        <span class="keyword">return</span> salary;
    }

    <span class="directive">public</span> <span class="type">void</span> setSalary(<span class="predefined-type">Long</span> salary) {
        <span class="local-variable">this</span>.salary = salary;
    }

    <span class="annotation">@Embedded</span>
    <span class="annotation">@AttributeOverrides</span>({
        <span class="annotation">@AttributeOverride</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>,
                           column = <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_START</span><span class="delimiter">&quot;</span></span>)),
        <span class="annotation">@AttributeOverride</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>,
                           column = <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_END</span><span class="delimiter">&quot;</span></span>))
    })
    <span class="directive">public</span> EmploymentPeriod getEmploymentPeriod() {
        <span class="keyword">return</span> period;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmploymentPeriod(EmploymentPeriod period) {
        <span class="local-variable">this</span>.period = period;
    }
}

<span class="comment">/***** Address class *****/</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Integer</span> id;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> street;
    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = IDENTITY)
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">protected</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="annotation">@Version</span>
    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">VERS</span><span class="delimiter">&quot;</span></span>, nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">RUE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getStreet() {
        <span class="keyword">return</span> street;
    }

    <span class="directive">public</span> <span class="type">void</span> setStreet(<span class="predefined-type">String</span> street) {
        <span class="local-variable">this</span>.street = street;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">VILLE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getCity() {
        <span class="keyword">return</span> city;
    }

    <span class="directive">public</span> <span class="type">void</span> setCity(<span class="predefined-type">String</span> city) {
        <span class="local-variable">this</span>.city = city;
    }
}

<span class="comment">/***** PhoneNumber class *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">PHONE</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">PhoneNumber</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> number;
    <span class="directive">private</span> <span class="type">int</span> phoneType;
    <span class="directive">private</span> Employee employee;

    <span class="annotation">@Id</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getNumber() {
        <span class="keyword">return</span> number;
    }

    <span class="directive">public</span> <span class="type">void</span> setNumber(<span class="predefined-type">String</span> number) {
        <span class="local-variable">this</span>.number = number;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">PTYPE</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">int</span> getPhonetype() {
        <span class="keyword">return</span> phonetype;
    }

    <span class="directive">public</span> <span class="type">void</span> setPhoneType(<span class="type">int</span> phoneType) {
        <span class="local-variable">this</span>.phoneType = phoneType;
    }

    <span class="annotation">@ManyToOne</span>(optional = <span class="predefined-constant">false</span>)
    <span class="annotation">@JoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">EMP_ID</span><span class="delimiter">&quot;</span></span>, nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> Employee getEmployee() {
        <span class="keyword">return</span> employee;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmployee(Employee employee) {
        <span class="local-variable">this</span>.employee = employee;
    }
}

<span class="comment">/***** Project class *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Inheritance</span>(strategy = JOINED)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Proj</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">DISC</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Project</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Integer</span> projId;
    <span class="directive">private</span> <span class="type">int</span> version;
    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;Employee&gt; employees;

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = TABLE)
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getId() {
        <span class="keyword">return</span> projId;
    }

    <span class="directive">protected</span> <span class="type">void</span> setId(<span class="predefined-type">Integer</span> id) {
        <span class="local-variable">this</span>.projId = id;
    }

    <span class="annotation">@Version</span>
    <span class="directive">public</span> <span class="type">int</span> getVersion() {
        <span class="keyword">return</span> version;
    }

    <span class="directive">protected</span> <span class="type">void</span> setVersion(<span class="type">int</span> version) {
        <span class="local-variable">this</span>.version = version;
    }

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">PROJ_NAME</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="annotation">@ManyToMany</span>(mappedBy = <span class="string"><span class="delimiter">&quot;</span><span class="content">projects</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Set</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }
}

<span class="comment">/***** GovernmentProject subclass *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">GOVT_PROJECT</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">GovtProj</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">GOV_PROJ_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">GovernmentProject</span> <span class="directive">extends</span> Project {
    <span class="directive">private</span> <span class="predefined-type">String</span> fileInfo;

    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getFileInfo() {
        <span class="keyword">return</span> fileInfo;
    }

    <span class="directive">public</span> <span class="type">void</span> setFileInfo(<span class="predefined-type">String</span> fileInfo) {
        <span class="local-variable">this</span>.fileInfo = fileInfo;
    }
}

<span class="comment">/***** CovertProject subclass *****/</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">C_PROJECT</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@DiscriminatorValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">CovProj</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PrimaryKeyJoinColumn</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">COV_PROJ_ID</span><span class="delimiter">&quot;</span></span>, referencedColumnName = <span class="string"><span class="delimiter">&quot;</span><span class="content">ID</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">CovertProject</span> <span class="directive">extends</span> Project {
    <span class="directive">private</span> <span class="predefined-type">String</span> classified;

    <span class="directive">public</span> CovertProject() {
        <span class="local-variable">super</span>();
    }

    <span class="directive">public</span> CovertProject(<span class="predefined-type">String</span> classified) {
        <span class="local-variable">this</span>();
        <span class="local-variable">this</span>.classified = classified;
    }

    <span class="annotation">@Column</span>(updatable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getClassified() {
        <span class="keyword">return</span> classified;
    }

    <span class="directive">protected</span> <span class="type">void</span> setClassified(<span class="predefined-type">String</span> classified) {
        <span class="local-variable">this</span>.classified = classified;
    }
}

<span class="comment">/***** EmploymentPeriod class *****/</span>
<span class="annotation">@Embeddable</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EmploymentPeriod</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {
    <span class="directive">private</span> <span class="predefined-type">Date</span> start;
    <span class="directive">private</span> <span class="predefined-type">Date</span> end;

    <span class="annotation">@Column</span>(nullable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="predefined-type">Date</span> getStartDate() {
        <span class="keyword">return</span> start;
    }

    <span class="directive">public</span> <span class="type">void</span> setStartDate(<span class="predefined-type">Date</span> start) {
        <span class="local-variable">this</span>.start = start;
    }

    <span class="directive">public</span> <span class="predefined-type">Date</span> getEndDate() {
        <span class="keyword">return</span> end;
    }

    <span class="directive">public</span> <span class="type">void</span> setEndDate(<span class="predefined-type">Date</span> end) {
        <span class="local-variable">this</span>.end = end;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a16944"><a class="anchor" href="#a16944"></a>12. XML Object/Relational Mapping Descriptor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The XML object/relational mapping descriptor
serves as both an alternative to and an overriding mechanism for Java
language metadata annotations.</p>
</div>
<div class="sect2">
<h3 id="use-of-the-xml-descriptor"><a class="anchor" href="#use-of-the-xml-descriptor"></a>12.1. Use of the XML Descriptor</h3>
<div class="paragraph">
<p>The XML schema for the object
relational/mapping descriptor is contained in <a href="#a17175">Section 12.3</a>. The root element of this
schema is the <em>entity-mappings</em> element. The absence or present of the
<em>xml-mapping-metadata-complete</em> subelement contained in the
<em>persistence-unit-defaults</em> subelement of the <em>entity-mappings</em> element
controls whether the XML object/relational mapping descriptor is used to
selectively override annotation values or whether it serves as a
complete alternative to Java language metadata annotations.</p>
</div>
<div class="paragraph">
<p>If the <em>xml-mapping-metadata-complete</em>
subelement is specified, the complete set of mapping metadata for the
persistence unit is contained in the XML mapping files for the
persistence unit, and any persistence annotations on the classes are
ignored.</p>
</div>
<div class="paragraph">
<p>If <em>xml-mapping-metadata-complete</em> is
specified and XML elements are omitted, the default values apply. These
default values are the same as the corresponding defaults when
annotations are used, except in the cases specified in <a href="#a16953">Section 12.2</a> below. When the
<em>xml-mapping-metadata-complete</em> element is specified, any
<em>metadata-complete</em> attributes specified within the <em>entity</em>,
<em>mapped-superclass</em>, and <em>embeddable</em> elements are ignored.</p>
</div>
<div class="paragraph">
<p>If the <em>xml-mapping-metadata-complete</em>
subelement is not specified, the XML descriptor overrides the values set
or defaulted by the use of annotations, as described below.</p>
</div>
<div class="paragraph">
<p>The mapping files used by the application
developer must conform to the XML schema defined in <a href="#a17175">Section 12.3</a>
or to the previous version of the XML schema, <em>orm_2_2.xsd</em>,
defined in a previous version of this specification <a href="#a19493">[1]</a>
in accordance with the version specified by the <em>orm.xml</em> file.</p>
</div>
<div class="paragraph">
<p>The Jakarta Persistence persistence provider
may support use of older versions of the object/relational mapping
schema as well as the object/relational mapping schema defined in
<a href="#a17175">Section 12.3</a>, whether singly or
in combination when multiple mapping files are used.</p>
</div>
</div>
<div class="sect2">
<h3 id="a16953"><a class="anchor" href="#a16953"></a>12.2. XML Overriding Rules</h3>
<div class="paragraph">
<p>This section defines the rules that apply
when the XML descriptor is used to override annotations, and the rules
pertaining to the interaction of XML elements specified as subelements
of the <em>persistence-unit-defaults</em>, <em>entity-mappings</em>, <em>entity</em>,
<em>mapped-superclass</em>, and <em>embeddable</em> elements.</p>
</div>
<div class="sect3">
<h4 id="persistence-unit-defaults-subelements"><a class="anchor" href="#persistence-unit-defaults-subelements"></a>12.2.1. persistence-unit-defaults Subelements</h4>
<div class="sect4">
<h5 id="schema"><a class="anchor" href="#schema"></a>12.2.1.1. schema</h5>
<div class="paragraph">
<p>The <em>schema</em> subelement applies to all
entities, tables, secondary tables, join tables, collection tables,
table generators, and sequence generators in the persistence unit.</p>
</div>
<div class="paragraph">
<p>The <em>schema</em> subelement is overridden by any
<em>schema</em> subelement of the <em>entity-mappings</em> element; any <em>schema</em>
element explicitly specified in the <em>Table</em> or <em>SecondaryTable</em>
annotation on an entity or any <em>schema</em> attribute on any <em>table</em> or
<em>secondary-table</em> subelement defined within an <em>entity</em> element; any
<em>schema</em> element explicitly specified in a <em>TableGenerator</em> annotation
or <em>table-generator</em> subelement; any <em>schema</em> element explicitly
specified in a <em>SequenceGenerator</em> annotation or <em>sequence-generator</em>
subelement; any <em>schema</em> element explicitly specified in a <em>JoinTable</em>
annotation or <em>join-table</em> subelement; and any <em>schema</em> element
explicitly specified in a <em>CollectionTable</em> annotation or
<em>collection-table</em> subelement.</p>
</div>
</div>
<div class="sect4">
<h5 id="catalog"><a class="anchor" href="#catalog"></a>12.2.1.2. catalog</h5>
<div class="paragraph">
<p>The <em>catalog</em> subelement applies to all
entities, tables, secondary tables, join tables, collection tables,
table generators, and sequence generators in the persistence unit.</p>
</div>
<div class="paragraph">
<p>The <em>catalog</em> subelement is overridden by any
<em>catalog</em> subelement of the <em>entity-mappings</em> element; any <em>catalog</em>
element explicitly specified in the <em>Table</em> or <em>SecondaryTable</em>
annotation on an entity or any <em>catalog</em> attribute on any <em>table</em> or
<em>secondary-table</em> subelement defined within an <em>entity</em> XML element; any
<em>catalog</em> element explicitly specified in a <em>TableGenerator</em> annotation
or <em>table-generator</em> subelement; any <em>catalog</em> element explicitly
specified in a <em>SequenceGenerator</em> annotation or <em>sequence-generator</em>
subelement; any <em>catalog</em> element explicitly specified in a <em>JoinTable</em>
annotation or <em>join-table</em> subelement; and any <em>catalog</em> element
explicitly specified in a <em>CollectionTable</em> annotation or
<em>collection-table</em> subelement.</p>
</div>
</div>
<div class="sect4">
<h5 id="delimited-identifiers"><a class="anchor" href="#delimited-identifiers"></a>12.2.1.3. delimited-identifiers</h5>
<div class="paragraph">
<p>The <em>delimited-identifiers</em> subelement
applies to the naming of database objects, as described in <a href="#a988">Section 2.13</a>. It
specifies that all database table-, schema-, and column-level
identifiers in use for the persistence unit be treated as delimited
identifiers.</p>
</div>
<div class="paragraph">
<p>The <em>delimited-identifiers</em> subelement cannot
be overridden in this release.</p>
</div>
</div>
<div class="sect4">
<h5 id="access"><a class="anchor" href="#access"></a>12.2.1.4. access</h5>
<div class="paragraph">
<p>The <em>access</em> subelement applies to all
managed classes in the persistence unit.</p>
</div>
<div class="paragraph">
<p>The <em>access</em> subelement is overridden by the
use of any annotations specifying mapping information on the fields or
properties of the entity class; by any <em>Access</em> annotation on the entity
class, mapped superclass, or embeddable class; by any <em>access</em>
subelement of the <em>entity-mappings</em> element; by any <em>Access</em> annotation
on a field or property of an entity class, mapped superclass, or
embeddable class; by any <em>access</em> attribute defined within an <em>entity</em>,
<em>mapped-superclass</em>, or <em>embeddable</em> XML element, or by any <em>access</em>
attribute defined within an <em>id</em>, <em>embedded-id</em>, <em>version</em>, <em>basic</em>,
<em>embedded</em>, <em>many-to-one</em>, <em>one-to-one</em>, <em>one-to-many</em>,
<em>many-to-many</em>, or <em>element-collection</em> element.</p>
</div>
</div>
<div class="sect4">
<h5 id="cascade-persist"><a class="anchor" href="#cascade-persist"></a>12.2.1.5. cascade-persist</h5>
<div class="paragraph">
<p>The <em>cascade-persist</em> subelement applies to
all relationships in the persistence unit.</p>
</div>
<div class="paragraph">
<p>Specifying this subelement adds the cascade
persist option to all relationships in addition to any settings
specified in annotations or XML.</p>
</div>
<div class="paragraph">
<p>The <em>cascade-persist</em> subelement cannot be
overridden in this release.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The ability to override the <em>cascade-persist</em>
of the <em>persistence-unit-defaults</em> element will be added in a future
release of this specification.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="entity-listeners-2"><a class="anchor" href="#entity-listeners-2"></a>12.2.1.6. entity-listeners</h5>
<div class="paragraph">
<p>The <em>entity-listeners</em> subelement defines
default entity listeners for the persistence unit. These entity
listeners are called before any other entity listeners for an entity
unless the entity listener order is overridden within a
<em>mapped-superclass</em> or <em>entity</em> element, or the
<em>ExcludeDefaultListeners</em> annotation is present on the entity or mapped
superclass or the <em>exclude-default-listeners</em> subelement is specified
within the corresponding <em>entity</em> or <em>mapped-superclass</em> XML element.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="other-subelements-of-the-entity-mappings-element"><a class="anchor" href="#other-subelements-of-the-entity-mappings-element"></a>12.2.2. Other Subelements of the entity-mappings element</h4>
<div class="sect4">
<h5 id="package"><a class="anchor" href="#package"></a>12.2.2.1. package</h5>
<div class="paragraph">
<p>The <em>package</em> subelement specifies the
package of the classes listed within the subelements and attributes of
the same mapping file only. The <em>package</em> subelement is overridden if
the fully qualified class name is specified for a class and the two
disagree.</p>
</div>
</div>
<div class="sect4">
<h5 id="schema-2"><a class="anchor" href="#schema-2"></a>12.2.2.2. schema</h5>
<div class="paragraph">
<p>The <em>schema</em> subelement applies only to the
entities, tables, secondary tables, join tables, collection tables,
table generators, and sequence generators listed within the same mapping
file.</p>
</div>
<div class="paragraph">
<p>The <em>schema</em> subelement is overridden by any
<em>schema</em> element explicitly specified in the <em>Table</em>, <em>SecondaryTable</em>
, <em>JoinTable</em>, or <em>CollectionTable</em> annotation on an entity listed
within the mapping file or any <em>schema</em> attribute on any <em>table</em> or
<em>secondary-table</em> subelement defined within the <em>entity</em> element for
such an entity, or by any <em>schema</em> attribute on any <em>join-table</em> or
<em>collection-table</em> subelement of an attribute defined within the
<em>attributes</em> subelement of the <em>entity</em> element for such an entity, or
by the <em>schema</em> attribute of any <em>table-generator</em> or
<em>sequence-generator</em> element within the mapping file.</p>
</div>
</div>
<div class="sect4">
<h5 id="catalog-2"><a class="anchor" href="#catalog-2"></a>12.2.2.3. catalog</h5>
<div class="paragraph">
<p>The <em>catalog</em> subelement applies only to the
entities, tables, secondary tables, join tables, collection tables,
table generators, and sequence generators listed within the same mapping
file.</p>
</div>
<div class="paragraph">
<p>The <em>catalog</em> subelement is overridden by any
<em>catalog</em> element explicitly specified in the <em>Table</em>, <em>SecondaryTable</em>
, <em>JoinTable</em>, or <em>CollectionTable</em> annotation on an entity listed
within the mapping file or any <em>catalog</em> attribute on any <em>table</em> or
<em>secondary-table</em> subelement defined within the <em>entity</em> element for
such an entity, or by any <em>catalog</em> attribute on any <em>join-table</em> or
<em>collection-table</em> subelement of an attribute defined within the
<em>attributes</em> subelement of the <em>entity</em> element for such an entity, or
by the <em>catalog</em> attribute of any <em>table-generator</em> or
<em>sequence-generator</em> element within the mapping file.</p>
</div>
</div>
<div class="sect4">
<h5 id="access-2"><a class="anchor" href="#access-2"></a>12.2.2.4. access</h5>
<div class="paragraph">
<p>The <em>access</em> subelement applies to the
managed classes listed within the same mapping file.</p>
</div>
<div class="paragraph">
<p>The <em>access</em> subelement is overridden by the
use of any annotations specifying mapping information on the fields or
properties of the entity class; by any <em>Access</em> annotation on the entity
class, mapped superclass, or embeddable class; by any <em>Access</em>
annotation on a field or property of an entity class, mapped superclass,
or embeddable class; by any <em>access</em> attribute defined within an
<em>entity</em>, <em>mapped-superclass</em>, or <em>embeddable</em> XML element, or by any
<em>access</em> attribute defined within an <em>id</em>, <em>embedded-id</em>, <em>version</em>,
<em>basic</em>, <em>embedded</em>, <em>many-to-one</em>, <em>one-to-one</em>, <em>one-to-many</em>,
<em>many-to-many</em>, or <em>element-collection</em> element.</p>
</div>
</div>
<div class="sect4">
<h5 id="sequence-generator"><a class="anchor" href="#sequence-generator"></a>12.2.2.5. sequence-generator</h5>
<div class="paragraph">
<p>The generator defined by the
<em>sequence-generator</em> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
generators of the same name.</p>
</div>
<div class="paragraph">
<p>The generator defined is added to any
generators defined in annotations. If a generator of the same name is
defined in annotations, the generator defined by this subelement
overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="table-generator"><a class="anchor" href="#table-generator"></a>12.2.2.6. table-generator</h5>
<div class="paragraph">
<p>The generator defined by the
<em>table-generator</em> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
generators of the same name.</p>
</div>
<div class="paragraph">
<p>The generator defined is added to any
generators defined in annotations. If a generator of the same name is
defined in annotations, the generator defined by this subelement
overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-query"><a class="anchor" href="#named-query"></a>12.2.2.7. named-query</h5>
<div class="paragraph">
<p>The named query defined by the <em>named-query</em>
subelement applies to the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain named queries of the same
name.</p>
</div>
<div class="paragraph">
<p>The named query defined is added to the named
queries defined in annotations. If a named query of the same name is
defined in annotations, the named query defined by this subelement
overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-native-query"><a class="anchor" href="#named-native-query"></a>12.2.2.8. named-native-query</h5>
<div class="paragraph">
<p>The named native query defined by the
<em>named-native-query</em> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
named queries of the same name.</p>
</div>
<div class="paragraph">
<p>The named native query defined is added to
the named native queries defined in annotations. If a named query of the
same name is defined in annotations, the named query defined by this
subelement overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-stored-procedure-query"><a class="anchor" href="#named-stored-procedure-query"></a>12.2.2.9. named-stored-procedure-query</h5>
<div class="paragraph">
<p>The named stored procedure query defined by
the <em>named-stored-procedure-query</em> subelement applies to the persistence
unit. It is undefined if multiple mapping files for the persistence unit
contain named stored procedure queries of the same name.</p>
</div>
<div class="paragraph">
<p>The named stored procedure query defined is
added to the named stored procedure queries defined in annotations. If a
named stored procedure query of the same name is defined in annotations,
the named stored procedure query defined by this subelement overrides
that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="sql-result-set-mapping"><a class="anchor" href="#sql-result-set-mapping"></a>12.2.2.10. sql-result-set-mapping</h5>
<div class="paragraph">
<p>The SQL result set mapping defined by the
<em>sql-result-set-mapping</em> subelement applies to the persistence unit. It
is undefined if multiple mapping files for the persistence unit contain
SQL result set mappings of the same name.</p>
</div>
<div class="paragraph">
<p>The SQL result set mapping defined is added
to the SQL result set mappings defined in annotations. If a SQL result
set mapping of the same name is defined in annotations, the SQL result
set mapping defined by this subelement overrides that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="entity-2"><a class="anchor" href="#entity-2"></a>12.2.2.11. entity</h5>
<div class="paragraph">
<p>The <em>entity</em> subelement defines an entity of
the persistence unit. It is undefined if multiple mapping files for the
persistence unit contain entries for the same entity.</p>
</div>
<div class="paragraph">
<p>The entity class may or may not have been
annotated as <em>Entity</em>. The subelements and attributes of the <em>entity</em>
element override as specified in <a href="#a17017">Section 12.2.3</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapped-superclass"><a class="anchor" href="#mapped-superclass"></a>12.2.2.12. mapped-superclass</h5>
<div class="paragraph">
<p>The <em>mapped-superclass</em> subelement defines a
mapped superclass of the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain entries for the same
mapped superclass.</p>
</div>
<div class="paragraph">
<p>The mapped superclass may or may not have
been annotated as <em>MappedSuperclass</em>. The subelements and attributes of
the <em>mapped-superclass</em> element override as specified in <a href="#a17106">Section 12.2.4</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="embeddable"><a class="anchor" href="#embeddable"></a>12.2.2.13. embeddable</h5>
<div class="paragraph">
<p>The <em>embeddable</em> subelement defines an
embeddable class of the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain entries for the same
embeddable class.</p>
</div>
<div class="paragraph">
<p>The <em>embeddable</em> class may or may not have
been annotated as <em>Embeddable</em>. The subelements and attributes of the
<em>embeddable</em> element override as specified in <a href="#a17150">Section 12.2.5</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="converter"><a class="anchor" href="#converter"></a>12.2.2.14. converter</h5>
<div class="paragraph">
<p>The converter defined by the <em>converter</em>
subelement applies to the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain converters for the same
target type.</p>
</div>
<div class="paragraph">
<p>The converter defined is added to the
converters defined in annotations. If a converter for the same target
type is defined in annotations, the converter defined by this subelement
overrides that definition.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a17017"><a class="anchor" href="#a17017"></a>12.2.3. entity Subelements and Attributes</h4>
<div class="paragraph">
<p>These apply only to the entity for which they
are subelements or attributes, unless otherwise specified below.</p>
</div>
<div class="sect4">
<h5 id="metadata-complete"><a class="anchor" href="#metadata-complete"></a>12.2.3.1. metadata-complete</h5>
<div class="paragraph">
<p>If the <em>metadata-complete</em> attribute of the
<em>entity</em> element is specified as <em>true</em>, any annotations on the entity
class (and its fields and properties) are ignored. When
<em>metadata-complete</em> is specified as <em>true</em> and XML attributes or
sub-elements of the <em>entity</em> element are omitted, the default values for
those attributes and elements are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="access-3"><a class="anchor" href="#access-3"></a>12.2.3.2. access</h5>
<div class="paragraph">
<p>The <em>access</em> attribute defines the access
type for the entity. The <em>access</em> attribute overrides any access type
specified by the <em>persistence-unit-defaults</em> element or
<em>entity-mappings</em> element for the given entity. The access type for a
field or property of the entity may be overridden by specifying by
overriding the mapping for that field or property using the appropriate
XML subelement, as described in <a href="#a17082">Section 12.2.3.26</a> below.</p>
</div>
<div class="paragraph">
<p>Caution must be exercised in overriding an
access type that was specified or defaulted using annotations, as doing
so may cause applications to break.</p>
</div>
</div>
<div class="sect4">
<h5 id="cacheable"><a class="anchor" href="#cacheable"></a>12.2.3.3. cacheable</h5>
<div class="paragraph">
<p>The <em>cacheable</em> attribute defines whether the
entity should be cached or must not be cached when the
<em>shared-cache-mode</em> element of the <em>persistence.xml</em> file is specified
as <em>ENABLE_SELECTIVE</em> or <em>DISABLE_SELECTIVE</em>. If the <em>Cacheable</em>
annotation was specified for the entity, its value is overridden by this
attribute. The value of the <em>cacheable</em> attribute is inherited by
subclasses (unless otherwise overridden for a subclass by the
<em>Cacheable</em> annotation or <em>cacheable</em> XML attribute).</p>
</div>
</div>
<div class="sect4">
<h5 id="name-2"><a class="anchor" href="#name-2"></a>12.2.3.4. name</h5>
<div class="paragraph">
<p>The name attribute defines the entity name.
The <em>name</em> attribute overrides the value of the entity name defined by
the <em>name</em> element of the <em>Entity</em> annotation (whether explicitly
specified or defaulted). Caution must be exercised in overriding the
entity name, as doing so may cause applications to break.</p>
</div>
</div>
<div class="sect4">
<h5 id="table-2"><a class="anchor" href="#table-2"></a>12.2.3.5. table</h5>
<div class="paragraph">
<p>The <em>table</em> subelement overrides any <em>Table</em>
annotation (including defaulted <em>Table</em> values) on the entity. If a
<em>table</em> subelement is present, and attributes or subelements of that
<em>table</em> subelement are not explicitly specified, their default values
are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="secondary-table"><a class="anchor" href="#secondary-table"></a>12.2.3.6. secondary-table</h5>
<div class="paragraph">
<p>The <em>secondary-table</em> subelement overrides
all <em>SecondaryTable</em> and <em>SecondaryTables</em> annotations (including
defaulted <em>SecondaryTable</em> values) on the entity. If a <em>secondary-table</em>
subelement is present, and attributes or subelements of that <em>secondary</em>
- <em>table</em> subelement are not explicitly specified, their default values
are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="primary-key-join-column"><a class="anchor" href="#primary-key-join-column"></a>12.2.3.7. primary-key-join-column</h5>
<div class="paragraph">
<p>The <em>primary-key-join-column</em> subelement of
the entity element specifies a primary key column that is used to join
the table of an entity subclass to the primary table for the entity when
the joined strategy is used. The <em>primary-key-join-column</em> subelement
overrides all <em>PrimaryKeyJoinColumn</em> and <em>PrimaryKeyJoinColumns</em>
annotations (including defaulted <em>PrimaryKeyJoinColumn</em> values) on the
entity. If a <em>primary-key-join-column</em> subelement is present, and
attributes or subelements of that <em>primary-key-join-column</em> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="id-class"><a class="anchor" href="#id-class"></a>12.2.3.8. id-class</h5>
<div class="paragraph">
<p>The <em>id-class</em> subelement overrides any
<em>IdClass</em> annotation specified on the entity.</p>
</div>
</div>
<div class="sect4">
<h5 id="inheritance-3"><a class="anchor" href="#inheritance-3"></a>12.2.3.9. inheritance</h5>
<div class="paragraph">
<p>The <em>inheritance</em> subelement overrides any
<em>Inheritance</em> annotation (including defaulted <em>Inheritance</em> values) on
the entity. If an <em>inheritance</em> subelement is present, and the
<em>strategy</em> attribute is not explicitly specified, its default value is
applied.</p>
</div>
<div class="paragraph">
<p>This element applies to the entity and its
subclasses (unless otherwise overridden for a subclass by an annotation
or XML element).</p>
</div>
<div class="paragraph">
<p>Support for the combination of inheritance
strategies is not required by this specification. Portable applications
should use only a single inheritance strategy within an entity
hierarchy.</p>
</div>
</div>
<div class="sect4">
<h5 id="discriminator-value"><a class="anchor" href="#discriminator-value"></a>12.2.3.10. discriminator-value</h5>
<div class="paragraph">
<p>The <em>discriminator-value</em> subelement
overrides any <em>DiscriminatorValue</em> annotations (including defaulted
<em>DiscriminatorValue</em> values) on the entity.</p>
</div>
</div>
<div class="sect4">
<h5 id="discriminator-column"><a class="anchor" href="#discriminator-column"></a>12.2.3.11. discriminator-column</h5>
<div class="paragraph">
<p>The <em>discriminator-column</em> subelement
overrides any <em>DiscriminatorColumn</em> annotation (including defaulted
<em>DiscriminatorColumn</em> values) on the entity. If a <em>discriminator-column</em>
subelement is present, and attributes of that <em>discriminator-column</em>
subelement are not explicitly specified, their default values are
applied.</p>
</div>
<div class="paragraph">
<p>This element applies to the entity and its
subclasses (unless otherwise overridden for a subclass by an annotation
or XML element).</p>
</div>
</div>
<div class="sect4">
<h5 id="sequence-generator-2"><a class="anchor" href="#sequence-generator-2"></a>12.2.3.12. sequence-generator</h5>
<div class="paragraph">
<p>The generator defined by the
<em>sequence-generator</em> subelement is added to any generators defined in
annotations and any other generators defined in XML. If a generator of
the same name is defined in annotations, the generator defined by this
subelement overrides that definition. If a <em>sequence-generator</em>
subelement is present, and attributes or subelements of that
<em>sequence-generator</em> subelement are not explicitly specified, their
default values are applied.</p>
</div>
<div class="paragraph">
<p>The generator defined by the
<em>sequence-generator</em> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
generators of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="table-generator-2"><a class="anchor" href="#table-generator-2"></a>12.2.3.13. table-generator</h5>
<div class="paragraph">
<p>The generator defined by the
<em>table-generator</em> subelement is added to any generators defined in
annotations and any other generators defined in XML. If a generator of
the same name is defined in annotations, the generator defined by this
subelement overrides that definition. If a <em>table-generator</em> subelement
is present, and attributes or subelements of that <em>table-generator</em>
subelement are not explicitly specified, their default values are
applied.</p>
</div>
<div class="paragraph">
<p>The generator defined by the
<em>table-generator</em> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
generators of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="attribute-override"><a class="anchor" href="#attribute-override"></a>12.2.3.14. attribute-override</h5>
<div class="paragraph">
<p>The <em>attribute-override</em> subelement is
additive to any <em>AttributeOverride</em> or <em>AttributeOverrides</em> annotations
on the entity. It overrides any <em>AttributeOverride</em> elements for the
same attribute name. If an <em>attribute-override</em> subelement is present,
and attributes or subelements of that <em>attribute-override</em> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="association-override"><a class="anchor" href="#association-override"></a>12.2.3.15. association-override</h5>
<div class="paragraph">
<p>The <em>association-override</em> subelement is
additive to any <em>AssociationOverride</em> or <em>AssociationOverrides a</em>
nnotations on the entity. It overrides any <em>AssociationOverride</em>
elements for the same attribute name. If an <em>association-override</em>
subelement is present, and attributes or subelements of that
<em>association-override</em> subelement are not explicitly specified, their
default values are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="convert"><a class="anchor" href="#convert"></a>12.2.3.16. convert</h5>
<div class="paragraph">
<p>The <em>convert</em> subelement is additive to any
<em>Convert</em> or <em>Converts</em> annotations on the entity. It overrides any
<em>Convert</em> annotation for the same attribute name. If a <em>convert</em>
subelement is present, and attributes or subelements of that <em>convert</em>
subelement are not explicitly specified, their default values are
applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-entity-graph"><a class="anchor" href="#named-entity-graph"></a>12.2.3.17. named-entity-graph</h5>
<div class="paragraph">
<p>The <em>named-entity-graph</em> subelement is
additive to any <em>NamedEntityGraph</em> annotations on the entity. It
overrides any <em>NamedEntityGraph</em> annotation with the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-query-2"><a class="anchor" href="#named-query-2"></a>12.2.3.18. named-query</h5>
<div class="paragraph">
<p>The named query defined by the <em>named-query</em>
subelement is added to any named queries defined in annotations, and any
other named queries defined in XML. If a named query of the same name is
defined in annotations, the named query defined by this subelement
overrides that definition. If a <em>named-query</em> subelement is present, and
attributes or subelements of that <em>named-query</em> subelement are not
explicitly specified, their default values are applied.</p>
</div>
<div class="paragraph">
<p>The named query defined by the <em>named-query</em>
subelement applies to the persistence unit. It is undefined if multiple
mapping files for the persistence unit contain named queries of the same
name.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-native-query-2"><a class="anchor" href="#named-native-query-2"></a>12.2.3.19. named-native-query</h5>
<div class="paragraph">
<p>The named query defined by the
<em>named-native-query</em> subelement is added to any named queries defined in
annotations, and any other named queries defined in XML. If a named
query of the same name is defined in annotations, the named query
defined by this subelement overrides that definition. If a
<em>named-native-query</em> subelement is present, and attributes or
subelements of that <em>named-native-query</em> subelement are not explicitly
specified, their default values are applied.</p>
</div>
<div class="paragraph">
<p>The named native query defined by the
<em>named-native-query</em> subelement applies to the persistence unit. It is
undefined if multiple mapping files for the persistence unit contain
named queries of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="named-stored-procedure-query-2"><a class="anchor" href="#named-stored-procedure-query-2"></a>12.2.3.20. named-stored-procedure-query</h5>
<div class="paragraph">
<p>The named stored procedure query defined by
the <em>named-stored-procedure-query</em> subelement is added to any named
stored procedure queries defined in annotations, and any other named
stored procedure queries defined in XML. If a named stored procedure
query of the same name is defined in annotations, the named stored
procedure query defined by this subelement overrides that definition. If
a <em>named-stored-procedure-query</em> subelement is present, and attributes
or subelements of that <em>named-stored-procedure-query</em> subelement are not
explicitly specified, their default values are applied.</p>
</div>
<div class="paragraph">
<p>The named stored procedure query defined by
the <em>named-stored-procedure-query</em> subelement applies to the persistence
unit. It is undefined if multiple mapping files for the persistence unit
contain named stored procedure queries of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="sql-result-set-mapping-2"><a class="anchor" href="#sql-result-set-mapping-2"></a>12.2.3.21. sql-result-set-mapping</h5>
<div class="paragraph">
<p>The SQL result set mapping defined by the
<em>sql-result-set-mapping</em> is added to the SQL result set mappings defined
in annotations, and any other SQL result set mappings defined in XML. If
a SQL result set mapping of the same name is defined in annotations, the
SQL result set mapping defined by this subelement overrides that
definition. If a <em>sql-result-set-mapping</em> subelement is present, and
attributes or subelements of that <em>sql-result-set-mapping</em> subelement
are not explicitly specified, their default values are applied.</p>
</div>
<div class="paragraph">
<p>The SQL result set mapping defined by the
<em>sql-result-set-mapping</em> subelement applies to the persistence unit. It
is undefined if multiple mapping files for the persistence unit contain
SQL result set mappings of the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="exclude-default-listeners"><a class="anchor" href="#exclude-default-listeners"></a>12.2.3.22. exclude-default-listeners</h5>
<div class="paragraph">
<p>The <em>exclude-default-listeners</em> subelement
applies whether or not the <em>ExcludeDefaultListeners</em> annotation was
specified on the entity.</p>
</div>
<div class="paragraph">
<p>This element causes the default entity
listeners to be excluded for the entity and its subclasses.</p>
</div>
</div>
<div class="sect4">
<h5 id="exclude-superclass-listeners"><a class="anchor" href="#exclude-superclass-listeners"></a>12.2.3.23. exclude-superclass-listeners</h5>
<div class="paragraph">
<p>The <em>exclude-superclass-listeners</em> subelement
applies whether or not the <em>ExcludeSuperclassListeners</em> annotation was
specified on the entity.</p>
</div>
<div class="paragraph">
<p>This element causes any superclass listeners
to be excluded for the entity and its subclasses.</p>
</div>
</div>
<div class="sect4">
<h5 id="entity-listeners-3"><a class="anchor" href="#entity-listeners-3"></a>12.2.3.24. entity-listeners</h5>
<div class="paragraph">
<p>The <em>entity-listeners</em> subelement overrides
any <em>EntityListeners</em> annotation on the entity.</p>
</div>
<div class="paragraph">
<p>These listeners apply to the entity and its
subclasses unless otherwise excluded.</p>
</div>
</div>
<div class="sect4">
<h5 id="pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load"><a class="anchor" href="#pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load"></a>12.2.3.25. pre-persist, post-persist, pre-remove, post-remove, pre-update, post-update, post-load</h5>
<div class="paragraph">
<p>These subelements override any lifecycle
callback methods defined by the corresponding annotations on the entity.</p>
</div>
</div>
<div class="sect4">
<h5 id="a17082"><a class="anchor" href="#a17082"></a>12.2.3.26. attributes</h5>
<div class="paragraph">
<p>The <em>attributes</em> element groups the mapping
subelements for the fields and properties of the entity. It may be
sparsely populated to include only a subset of the fields and
properties. If the value of <em>metadata-complete</em> is <em>true</em>, the
remainder of the attributes will be defaulted according to the default
rules. If <em>metadata-complete</em> is not specified, or is <em>false</em>, the
mappings for only those properties and fields that are explicitly
specified will be overridden.</p>
</div>
<div class="sect5">
<h6 id="id-2"><a class="anchor" href="#id-2"></a>id</h6>
<div class="paragraph">
<p>The <em>id</em> subelement overrides the mapping for
the specified field or property. If an <em>id</em> subelement is present, and
attributes or subelements of that <em>id</em> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded-id"><a class="anchor" href="#embedded-id"></a>embedded-id</h6>
<div class="paragraph">
<p>The <em>embedded-id</em> subelement overrides the
mapping for the specified field or property. If an <em>embedded-id</em>
subelement is present, and attributes or subelements of that
<em>embedded-id</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="basic"><a class="anchor" href="#basic"></a>basic</h6>
<div class="paragraph">
<p>The <em>basic</em> subelement overrides the mapping
for the specified field or property. If a <em>basic</em> subelement is present,
and attributes or subelements of that <em>basic</em> subelement are not
explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="version-2"><a class="anchor" href="#version-2"></a>version</h6>
<div class="paragraph">
<p>The <em>version</em> subelement overrides the
mapping for the specified field or property. If a <em>version</em> subelement
is present, and attributes or subelements of that <em>version</em> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-one"><a class="anchor" href="#many-to-one"></a>many-to-one</h6>
<div class="paragraph">
<p>The <em>many-to-one</em> subelement overrides the
mapping for the specified field or property. If a <em>many-to-one</em>
subelement is present, and attributes or subelements of that
<em>many-to-one</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-many"><a class="anchor" href="#one-to-many"></a>one-to-many</h6>
<div class="paragraph">
<p>The <em>one-to-many</em> subelement overrides the
mapping for the specified field or property. If a <em>one-to-many</em>
subelement is present, and attributes or subelements of that
<em>one-to-many</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-one"><a class="anchor" href="#one-to-one"></a>one-to-one</h6>
<div class="paragraph">
<p>The <em>one-to-one</em> subelement overrides the
mapping for the specified field or property. If a <em>one-to-one</em>
subelement is present, and attributes or subelements of that
<em>one-to-one</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-many"><a class="anchor" href="#many-to-many"></a>many-to-many</h6>
<div class="paragraph">
<p>The <em>many-to-many</em> subelement overrides the
mapping for the specified field or property. If a <em>many-to-many</em>
subelement is present, and attributes or subelements of that
<em>many-to-many</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="element-collection"><a class="anchor" href="#element-collection"></a>element-collection</h6>
<div class="paragraph">
<p>The <em>element-collection</em> subelement overrides
the mapping for the specified field or property. If an
<em>element-collection</em> subelement is present, and attributes or
subelements of that <em>element-collection</em> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded"><a class="anchor" href="#embedded"></a>embedded</h6>
<div class="paragraph">
<p>The <em>embedded</em> subelement overrides the
mapping for the specified field or property. If an <em>embedded</em> subelement
is present, and attributes or subelements of that <em>embedded</em> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="transient"><a class="anchor" href="#transient"></a>transient</h6>
<div class="paragraph">
<p>The <em>transient</em> subelement overrides the
mapping for the specified field or property.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a17106"><a class="anchor" href="#a17106"></a>12.2.4. mapped-superclass Subelements and Attributes</h4>
<div class="paragraph">
<p>These apply only to the mapped-superclass for
which they are subelements or attributes, unless otherwise specified
below.</p>
</div>
<div class="sect4">
<h5 id="metadata-complete-2"><a class="anchor" href="#metadata-complete-2"></a>12.2.4.1. metadata-complete</h5>
<div class="paragraph">
<p>If the <em>metadata-complete</em> attribute of the
<em>mapped-superclass</em> element is specified as <em>true</em>, any annotations on
the mapped superclass (and its fields and properties) are ignored. When
<em>metadata-complete</em> is specified as <em>true</em> and attributes or
sub-elements of the <em>mapped-superclass</em> element are omitted, the default
values for those attributes and elements are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="access-4"><a class="anchor" href="#access-4"></a>12.2.4.2. access</h5>
<div class="paragraph">
<p>The <em>access</em> attribute defines the access
type for the mapped superclass. The <em>access</em> attribute overrides any
access type specified by the <em>persistence-unit-defaults</em> element or
<em>entity-mappings</em> element for the given mapped superclass. The access
type for a field or property of the mapped superclass may be overridden
by specifying by overriding the mapping for that field or property using
the appropriate XML subelement, as described in <a href="#a17126">[a17126]</a> below.</p>
</div>
<div class="paragraph">
<p>Caution must be exercised in overriding an
access type that was specified or defaulted using annotations, as doing
so may cause applications to break.</p>
</div>
</div>
<div class="sect4">
<h5 id="id-class-2"><a class="anchor" href="#id-class-2"></a>12.2.4.3. id-class</h5>
<div class="paragraph">
<p>The <em>id-class</em> subelement overrides any
<em>IdClass</em> annotation specified on the mapped superclass.</p>
</div>
</div>
<div class="sect4">
<h5 id="exclude-default-listeners-2"><a class="anchor" href="#exclude-default-listeners-2"></a>12.2.4.4. exclude-default-listeners</h5>
<div class="paragraph">
<p>The <em>exclude-default-listeners</em> subelement
applies whether or not the <em>ExcludeDefaultListeners</em> annotation was
specified on the mapped superclass.</p>
</div>
<div class="paragraph">
<p>This element causes the default entity
listeners to be excluded for the mapped superclass and its subclasses.</p>
</div>
</div>
<div class="sect4">
<h5 id="exclude-superclass-listeners-2"><a class="anchor" href="#exclude-superclass-listeners-2"></a>12.2.4.5. exclude-superclass-listeners</h5>
<div class="paragraph">
<p>The <em>exclude-superclass-listeners</em> subelement
applies whether or not the <em>ExcludeSuperclassListeners</em> annotation was
specified on the mapped superclass.</p>
</div>
<div class="paragraph">
<p>This element causes any superclass listeners
to be excluded for the mapped superclass and its subclasses.</p>
</div>
</div>
<div class="sect4">
<h5 id="entity-listeners-4"><a class="anchor" href="#entity-listeners-4"></a>12.2.4.6. entity-listeners</h5>
<div class="paragraph">
<p>The <em>entity-listeners</em> subelement overrides
any <em>EntityListeners</em> annotation on the mapped superclass.</p>
</div>
<div class="paragraph">
<p>These listeners apply to the mapped
superclass and its subclasses unless otherwise excluded.</p>
</div>
</div>
<div class="sect4">
<h5 id="pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load-2"><a class="anchor" href="#pre-persist-post-persist-pre-remove-post-remove-pre-update-post-update-post-load-2"></a>12.2.4.7. pre-persist, post-persist, pre-remove, post-remove, pre-update, post-update, post-load</h5>
<div class="paragraph">
<p>These subelements override any lifecycle
callback methods defined by the corresponding annotations on the mapped
superclass.</p>
</div>
</div>
<div class="sect4">
<h5 id="attributes"><a class="anchor" href="#attributes"></a>12.2.4.8. <a id="a17126"></a>attributes</h5>
<div class="paragraph">
<p>The <em>attributes</em> element groups the mapping
subelements for the fields and properties defined by the mapped
superclass. It may be sparsely populated to include only a subset of the
fields and properties. If the value of <em>metadata-complete</em> is <em>true</em>,
the remainder of the attributes will be defaulted according to the
default rules. If <em>metadata-complete</em> is not specified, or is <em>false</em>,
the mappings for only those properties and fields that are explicitly
specified will be overridden.</p>
</div>
<div class="sect5">
<h6 id="id-3"><a class="anchor" href="#id-3"></a>id</h6>
<div class="paragraph">
<p>The <em>id</em> subelement overrides the mapping for
the specified field or property. If an <em>id</em> subelement is present, and
attributes or subelements of that <em>id</em> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded-id-2"><a class="anchor" href="#embedded-id-2"></a>embedded-id</h6>
<div class="paragraph">
<p>The <em>embedded-id</em> subelement overrides the
mapping for the specified field or property. If an <em>embedded-id</em>
subelement is present, and attributes or subelements of that
<em>embedded-id</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="basic-2"><a class="anchor" href="#basic-2"></a>basic</h6>
<div class="paragraph">
<p>The <em>basic</em> subelement overrides the mapping
for the specified field or property. If a <em>basic</em> subelement is present,
and attributes or subelements of that <em>basic</em> subelement are not
explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="version-3"><a class="anchor" href="#version-3"></a>version</h6>
<div class="paragraph">
<p>The <em>version</em> subelement overrides the
mapping for the specified field or property. If a <em>version</em> subelement
is present, and attributes or subelements of that <em>version</em> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-one-2"><a class="anchor" href="#many-to-one-2"></a>many-to-one</h6>
<div class="paragraph">
<p>The <em>many-to-one</em> subelement overrides the
mapping for the specified field or property. If a <em>many-to-one</em>
subelement is present, and attributes or subelements of that
<em>many-to-one</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-many-2"><a class="anchor" href="#one-to-many-2"></a>one-to-many</h6>
<div class="paragraph">
<p>The <em>one-to-many</em> subelement overrides the
mapping for the specified field or property. If a <em>one-to-many</em>
subelement is present, and attributes or subelements of that
<em>one-to-many</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-one-2"><a class="anchor" href="#one-to-one-2"></a>one-to-one</h6>
<div class="paragraph">
<p>The <em>one-to-one</em> subelement overrides the
mapping for the specified field or property. If a <em>one-to-one</em>
subelement is present, and attributes or subelements of that
<em>one-to-one</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-many-2"><a class="anchor" href="#many-to-many-2"></a>many-to-many</h6>
<div class="paragraph">
<p>The <em>many-to-many</em> subelement overrides the
mapping for the specified field or property. If a <em>many-to-many</em>
subelement is present, and attributes or subelements of that
<em>many-to-many</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="element-collection-2"><a class="anchor" href="#element-collection-2"></a>element-collection</h6>
<div class="paragraph">
<p>The <em>element-collection</em> subelement overrides
the mapping for the specified field or property. If an
<em>element-collection</em> subelement is present, and attributes or
subelements of that <em>element-collection</em> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded-2"><a class="anchor" href="#embedded-2"></a>embedded</h6>
<div class="paragraph">
<p>The <em>embedded</em> subelement overrides the
mapping for the specified field or property. If an <em>embedded</em> subelement
is present, and attributes or subelements of that <em>embedded</em> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="transient-2"><a class="anchor" href="#transient-2"></a>transient</h6>
<div class="paragraph">
<p>The <em>transient</em> subelement overrides the
mapping for the specified field or property.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a17150"><a class="anchor" href="#a17150"></a>12.2.5. embeddable Subelements and Attributes</h4>
<div class="paragraph">
<p>These apply only to the embeddable for which
they are subelements or attributes.</p>
</div>
<div class="sect4">
<h5 id="metadata-complete-3"><a class="anchor" href="#metadata-complete-3"></a>12.2.5.1. metadata-complete</h5>
<div class="paragraph">
<p>If the <em>metadata-complete</em> attribute of the
<em>embeddable</em> element is specified as <em>true</em>, any annotations on the
embeddable class (and its fields and properties) are ignored. When
<em>metadata-complete</em> is specified as <em>true</em> and attributes and
sub-elements of the <em>embeddable</em> element are omitted, the default values
for those attributes and elements are applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="access-5"><a class="anchor" href="#access-5"></a>12.2.5.2. access</h5>
<div class="paragraph">
<p>The <em>access</em> attribute defines the access
type for the embeddable class. The <em>access</em> attribute overrides any
access type specified by the <em>persistence-unit-defaults</em> element or
<em>entity-mappings</em> element for the given embeddable class. The access
type for a field or property of the embeddable class may be overridden
by specifying by overriding the mapping for that field or property using
the appropriate XML subelement, as described in <a href="#a17157">Section 12.2.5.3</a> below.</p>
</div>
<div class="paragraph">
<p>Caution must be exercised in overriding an
access type that was specified or defaulted using annotations, as doing
so may cause applications to break.</p>
</div>
</div>
<div class="sect4">
<h5 id="a17157"><a class="anchor" href="#a17157"></a>12.2.5.3. attributes</h5>
<div class="paragraph">
<p>The <em>attributes</em> element groups the mapping
subelements for the fields and properties defined by the embeddable
class. It may be sparsely populated to include only a subset of the
fields and properties. If the value of <em>metadata-complete</em> is <em>true</em>,
the remainder of the attributes will be defaulted according to the
default rules. If <em>metadata-complete</em> is not specified, or is <em>false</em>,
the mappings for only those properties and fields that are explicitly
specified will be overridden.</p>
</div>
<div class="sect5">
<h6 id="basic-3"><a class="anchor" href="#basic-3"></a>basic</h6>
<div class="paragraph">
<p>The <em>basic</em> subelement overrides the mapping
for the specified field or property. If a <em>basic</em> subelement is present,
and attributes or subelements of that <em>basic</em> subelement are not
explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-one-3"><a class="anchor" href="#many-to-one-3"></a>many-to-one</h6>
<div class="paragraph">
<p>The <em>many-to-one</em> subelement overrides the
mapping for the specified field or property. If a <em>many-to-one</em>
subelement is present, and attributes or subelements of that
<em>many-to-one</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-many-3"><a class="anchor" href="#one-to-many-3"></a>one-to-many</h6>
<div class="paragraph">
<p>The <em>one-to-many</em> subelement overrides the
mapping for the specified field or property. If a <em>one-to-many</em>
subelement is present, and attributes or subelements of that
<em>one-to-many</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="one-to-one-3"><a class="anchor" href="#one-to-one-3"></a>one-to-one</h6>
<div class="paragraph">
<p>The <em>one-to-one</em> subelement overrides the
mapping for the specified field or property. If a <em>one-to-one</em>
subelement is present, and attributes or subelements of that
<em>one-to-one</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="many-to-many-3"><a class="anchor" href="#many-to-many-3"></a>many-to-many</h6>
<div class="paragraph">
<p>The <em>many-to-many</em> subelement overrides the
mapping for the specified field or property. If a <em>many-to-many</em>
subelement is present, and attributes or subelements of that
<em>many-to-many</em> subelement are not explicitly specified, their default
values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="element-collection-3"><a class="anchor" href="#element-collection-3"></a>element-collection</h6>
<div class="paragraph">
<p>The <em>element-collection</em> subelement overrides
the mapping for the specified field or property. If an
<em>element-collection</em> subelement is present, and attributes or
subelements of that <em>element-collection</em> subelement are not explicitly
specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="embedded-3"><a class="anchor" href="#embedded-3"></a>embedded</h6>
<div class="paragraph">
<p>The <em>embedded</em> subelement overrides the
mapping for the specified field or property. If an <em>embedded</em> subelement
is present, and attributes or subelements of that <em>embedded</em> subelement
are not explicitly specified, their default values are applied.</p>
</div>
</div>
<div class="sect5">
<h6 id="transient-3"><a class="anchor" href="#transient-3"></a>transient</h6>
<div class="paragraph">
<p>The <em>transient</em> subelement overrides the
mapping for the specified field or property.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a17175"><a class="anchor" href="#a17175"></a>12.3. XML Schema</h3>
<div class="paragraph">
<p>This section provides the XML
object/relational mapping schema for use with the persistence API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="comment">&lt;!-- Jakarta Persistence API object/relational mapping file schema --&gt;</span>
<span class="tag">&lt;xsd:schema</span> <span class="attribute-name">targetNamespace</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/persistence/orm</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:orm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/persistence/orm</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:xsd</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">elementFormDefault</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">qualified</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">attributeFormDefault</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unqualified</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

  <span class="tag">&lt;xsd:annotation&gt;</span>
     <span class="tag">&lt;xsd:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>

       This is the XML Schema for the persistence object/relational
       mapping file.
       The file may be named &quot;META-INF/orm.xml&quot; in the persistence
       archive or it may be named some other name which would be
       used to locate the file as resource on the classpath.

       Object/relational mapping files must indicate the object/relational
       mapping file schema by using the persistence namespace:

       https://jakarta.ee/xml/ns/persistence/orm

       and indicate the version of the schema by
       using the version element as shown below:

      &lt;entity-mappings xmlns=&quot;https://jakarta.ee/xml/ns/persistence/orm&quot;
        xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
        xsi:schemaLocation=&quot;https://jakarta.ee/xml/ns/persistence/orm
          https://jakarta.ee/xml/ns/persistence/orm/orm_3_0.xsd&quot;
        version=&quot;3.0&quot;&gt;
          ...
      &lt;/entity-mappings&gt;


     <span class="inline-delimiter">]]&gt;</span><span class="tag">&lt;/xsd:documentation&gt;</span>
  <span class="tag">&lt;/xsd:annotation&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">emptyType</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">versionType</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:pattern</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">[0-9]+(\.[0-9]+)*</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-mappings</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:complexType&gt;</span>
      <span class="tag">&lt;xsd:annotation&gt;</span>
        <span class="tag">&lt;xsd:documentation&gt;</span>

        The entity-mappings element is the root element of a mapping
        file. It contains the following four types of elements:

        1. The persistence-unit-metadata element contains metadata
        for the entire persistence unit. It is undefined if this element
        occurs in multiple mapping files within the same persistence unit.

        2. The package, schema, catalog and access elements apply to all of
        the entity, mapped-superclass and embeddable elements defined in
        the same file in which they occur.

        3. The sequence-generator, table-generator, converter, named-query,
        named-native-query, named-stored-procedure-query, and
        sql-result-set-mapping elements are global to the persistence
        unit. It is undefined to have more than one sequence-generator
        or table-generator of the same name in the same or different
        mapping files in a persistence unit. It is undefined to have
        more than one named-query, named-native-query, sql-result-set-mapping,
        or named-stored-procedure-query of the same name in the same
        or different mapping files in a persistence unit.  It is also
        undefined to have more than one converter for the same target
        type in the same or different mapping files in a persistence unit.

        4. The entity, mapped-superclass and embeddable elements each define
        the mapping information for a managed persistent class. The mapping
        information contained in these elements may be complete or it may
        be partial.

        <span class="tag">&lt;/xsd:documentation&gt;</span>
      <span class="tag">&lt;/xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-metadata</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:persistence-unit-metadata</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">package</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sequence-generator</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:table-generator</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-query</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-native-query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-native-query</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-stored-procedure-query</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-stored-procedure-query</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sql-result-set-mapping</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sql-result-set-mapping</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-superclass</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:mapped-superclass</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embeddable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embeddable</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">converter</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:converter</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:versionType</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:complexType&gt;</span>
  <span class="tag">&lt;/xsd:element&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-metadata</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Metadata that applies to the persistence unit and not just to
        the mapping file in which it is contained.

        If the xml-mapping-metadata-complete element is specified,
        the complete set of mapping metadata for the persistence unit
        is contained in the XML mapping files for the persistence unit.

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xml-mapping-metadata-complete</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-defaults</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:persistence-unit-defaults</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistence-unit-defaults</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        These defaults are applied to the persistence unit as a whole
        unless they are overridden by local annotation or XML
        element settings.

        schema - Used as the schema for all tables, secondary tables, join
            tables, collection tables, sequence generators, and table
            generators that apply to the persistence unit
        catalog - Used as the catalog for all tables, secondary tables, join
            tables, collection tables, sequence generators, and table
            generators that apply to the persistence unit
        delimited-identifiers - Used to treat database identifiers as
            delimited identifiers.
        access - Used as the access type for all managed classes in
            the persistence unit
        cascade-persist - Adds cascade-persist to the set of cascade options
            in all entity relationships of the persistence unit
        entity-listeners - List of default entity listeners to be invoked
            on each entity in the persistence unit.
      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">delimited-identifiers</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-listeners</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Defines the settings and mappings for an entity. Is allowed to be
        sparsely populated and used in conjunction with the annotations.
        Alternatively, the metadata-complete attribute can be used to
        indicate that no annotations on the entity class (and its fields
        or properties) are to be processed. If this is the case then
        the defaulting rules for the entity and its subelements will
        be recursively applied.

        @Target(TYPE) @Retention(RUNTIME)
          public @interface Entity {
          String name() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:table</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secondary-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:secondary-table</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:id-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inheritance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:inheritance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:discriminator-value</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:discriminator-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sequence-generator</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:table-generator</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-query</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-native-query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-native-query</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-stored-procedure-query</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-stored-procedure-query</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sql-result-set-mapping</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sql-result-set-mapping</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-default-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-superclass-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-listeners</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-persist</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">association-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:association-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-entity-graph</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-entity-graph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cacheable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">metadata-complete</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        This element determines how the persistence provider accesses the
        state of an entity or embedded object.

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PROPERTY</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FIELD</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">association-override</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface AssociationOverride {
          String name();
          JoinColumn[] joinColumns() default{};
          JoinTable joinTable() default @JoinTable;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface AttributeOverride {
          String name();
          Column column();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        This element contains the entity field or property mappings.
        It may be sparsely populated to include only a subset of the
        fields or properties. If metadata-complete for the entity is true
        then the remainder of the attributes will be defaulted according
        to the default rules.

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:id</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embedded-id</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:basic</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:version</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-one</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:many-to-one</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-many</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:one-to-many</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-one</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:one-to-one</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-many</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:many-to-many</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">element-collection</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:element-collection</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embedded</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transient</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:transient</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Basic {
          FetchType fetch() default EAGER;
          boolean optional() default true;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lob</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:lob</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">enumerated</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">optional</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum CascadeType { ALL, PERSIST, MERGE, REMOVE, REFRESH, DETACH};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-all</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-merge</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-refresh</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade-detach</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">collection-table</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface CollectionTable {
          String name() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          JoinColumn[] joinColumns() default {};
          UniqueConstraint[] uniqueConstraints() default {};
          Index[] indexes() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>


<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Column {
          String name() default &quot;&quot;;
          boolean unique() default false;
          boolean nullable() default true;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String table() default &quot;&quot;;
          int length() default 255;
          int precision() default 0; // decimal precision
          int scale() default 0; // decimal scale
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">length</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">precision</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scale</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface ColumnResult {
          String name();
          Class type() default void.class;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constraint-mode</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

       public enum ConstraintMode {CONSTRAINT, NO_CONSTRAINT, PROVIDER_DEFAULT};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CONSTRAINT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">NO_CONSTRAINT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PROVIDER_DEFAULT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>


  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constructor-result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface ConstructorResult {
          Class targetClass();
          ColumnResult[] columns();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Convert {
          Class converter() default void.class;
          String attributeName() default &quot;&quot;;
          boolean disableConversion() default false;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">converter</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">disable-conversion</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">converter</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Converter {
          boolean autoApply() default false;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">auto-apply</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface DiscriminatorColumn {
          String name() default &quot;DTYPE&quot;;
          DiscriminatorType discriminatorType() default STRING;
          String columnDefinition() default &quot;&quot;;
          int length() default 31;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:discriminator-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">length</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum DiscriminatorType { STRING, CHAR, INTEGER };

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">STRING</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CHAR</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INTEGER</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-value</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface DiscriminatorValue {
          String value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

 <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">element-collection</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface ElementCollection {
          Class targetClass() default void.class;
          FetchType fetch() default LAZY;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-by</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-class</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-column</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-column</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-join-column</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-join-column</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lob</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:lob</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">association-override</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:association-override</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">collection-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:collection-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embeddable</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Defines the settings and mappings for embeddable objects. Is
        allowed to be sparsely populated and used in conjunction with
        the annotations. Alternatively, the metadata-complete attribute
        can be used to indicate that no annotations are to be processed
        in the class. If this is the case then the defaulting rules will
        be recursively applied.

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface Embeddable {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embeddable-attributes</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">metadata-complete</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embeddable-attributes</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:basic</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-one</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:many-to-one</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-many</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:one-to-many</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-one</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:one-to-one</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-many</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:many-to-many</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">element-collection</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:element-collection</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:embedded</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transient</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:transient</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Embedded {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">association-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:association-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">embedded-id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface EmbeddedId {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attribute-override</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listener</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Defines an entity listener to be invoked at lifecycle events
        for the entities that list this listener.

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-persist</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listeners</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface EntityListeners {
          Class[] value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listener</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-listener</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface EntityResult {
          Class entityClass();
          FieldResult[] fields() default {};
          String discriminatorColumn() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">field-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:field-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">discriminator-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">enum-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum EnumType {
          ORDINAL,
          STRING
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ORDINAL</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">STRING</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">enumerated</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Enumerated {
          EnumType value() default ORDINAL;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enum-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum FetchType { LAZY, EAGER };

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">LAZY</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EAGER</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">field-result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface FieldResult {
          String name();
          String column();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface ForeignKey {
          String name() default &quot;&quot;;
          ConstraintMode value() default CONSTRAINT;
          String foreign-key-definition() default &quot;&quot;;

        Note that the elements that embed the use of the annotation
        default this use as @ForeignKey(PROVIDER_DEFAULT).

        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constraint-mode</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:constraint-mode</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generated-value</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface GeneratedValue {
          GenerationType strategy() default AUTO;
          String generator() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strategy</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:generation-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generation-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum GenerationType { TABLE, SEQUENCE, IDENTITY, AUTO };

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TABLE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SEQUENCE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">IDENTITY</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">AUTO</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Id {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generated-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:generated-value</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:table-generator</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-generator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:sequence-generator</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-class</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface IdClass {
          Class value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface Index {
          String name() default &quot;&quot;;
          String columnList();
          boolean unique() default false;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-list</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inheritance</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface Inheritance {
          InheritanceType strategy() default SINGLE_TABLE;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strategy</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:inheritance-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inheritance-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum InheritanceType
          { SINGLE_TABLE, JOINED, TABLE_PER_CLASS};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SINGLE_TABLE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">JOINED</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TABLE_PER_CLASS</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface JoinColumn {
          String name() default &quot;&quot;;
          String referencedColumnName() default &quot;&quot;;
          boolean unique() default false;
          boolean nullable() default true;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String table() default &quot;&quot;;
          ForeignKey foreignKey() default @ForeignKey();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">referenced-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface JoinTable {
          String name() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          JoinColumn[] joinColumns() default {};
          JoinColumn[] inverseJoinColumns() default {};
          UniqueConstraint[] uniqueConstraints() default {};
          Index[] indexes() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inverse-join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inverse-foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lob</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Lob {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lock-mode-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum LockModeType { READ, WRITE, OPTIMISTIC, OPTIMISTIC_FORCE_INCREMENT, PESSIMISTIC_READ, PESSIMISTIC_WRITE, PESSIMISTIC_FORCE_INCREMENT, NONE};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OPTIMISTIC</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OPTIMISTIC_FORCE_INCREMENT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PESSIMISTIC_READ</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PESSIMISTIC_WRITE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PESSIMISTIC_FORCE_INCREMENT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

<span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-many</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface ManyToMany {
          Class targetEntity() default void.class;
          CascadeType[] cascade() default {};
          FetchType fetch() default LAZY;
          String mappedBy() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-by</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-class</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-join-column</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:cascade-type</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">many-to-one</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface ManyToOne {
          Class targetEntity() default void.class;
          CascadeType[] cascade() default {};
          FetchType fetch() default EAGER;
          boolean optional() default true;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:cascade-type</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">optional</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">maps-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface MapKey {
          String name() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-class</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface MapKeyClass {
          Class value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface MapKeyColumn {
          String name() default &quot;&quot;;
          boolean unique() default false;
          boolean nullable() default false;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String table() default &quot;&quot;;
          int length() default 255;
          int precision() default 0; // decimal precision
          int scale() default 0; // decimal scale
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">length</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">precision</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scale</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-join-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface MapKeyJoinColumn {
          String name() default &quot;&quot;;
          String referencedColumnName() default &quot;&quot;;
          boolean unique() default false;
          boolean nullable() default false;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
          String table() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">referenced-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>


<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-superclass</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        Defines the settings and mappings for a mapped superclass. Is
        allowed to be sparsely populated and used in conjunction with
        the annotations. Alternatively, the metadata-complete attribute
        can be used to indicate that no annotations are to be processed
        If this is the case then the defaulting rules will be recursively
        applied.

        @Target(TYPE) @Retention(RUNTIME)
        public @interface MappedSuperclass{}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:id-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-default-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">exclude-superclass-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:emptyType</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-listeners</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-listeners</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-persist</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-persist</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-remove</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:pre-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-update</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:post-load</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">metadata-complete</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-attribute-node</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface NamedAttributeNode {
          String value();
          String subgraph() default &quot;&quot;;
          String keySubgraph() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">subgraph</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">key-subgraph</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-entity-graph</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface NamedEntityGraph {
          String name() default &quot;&quot;;
          NamedAttributeNode[] attributeNodes() default {};
          boolean includeAllAttributes() default false;
          NamedSubgraph[] subgraphs() default {};
          NamedSubGraph[] subclassSubgraphs() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-attribute-node</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-attribute-node</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">subgraph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-subgraph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">subclass-subgraph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-subgraph</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">include-all-attributes</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>


<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-native-query</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface NamedNativeQuery {
          String name();
          String query();
          QueryHint[] hints() default {};
          Class resultClass() default void.class;
          String resultSetMapping() default &quot;&quot;; //named SqlResultSetMapping
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:query-hint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result-set-mapping</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-query</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface NamedQuery {
          String name();
          String query();
          LockModeType lockMode() default NONE;
          QueryHint[] hints() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lock-mode</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:lock-mode-type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:query-hint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-stored-procedure-query</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface NamedStoredProcedureQuery {
          String name();
          String procedureName();
          StoredProcedureParameter[] parameters() default {};
          Class[] resultClasses() default {};
          String[] resultSetMappings() default{};
          QueryHint[] hints() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">parameter</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:stored-procedure-parameter</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result-set-mapping</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:query-hint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">procedure-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-subgraph</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface NamedSubgraph {
          String name();
          Class type() default void.class;
          NamedAttributeNode[] attributeNodes();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">named-attribute-node</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:named-attribute-node</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

<span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-many</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface OneToMany {
          Class targetEntity() default void.class;
          CascadeType[] cascade() default {};
          FetchType fetch() default LAZY;
          String mappedBy() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-by</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:order-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-class</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:enumerated</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:attribute-override</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-convert</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:convert</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
          <span class="tag">&lt;xsd:choice&gt;</span>
            <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-column</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xsd:sequence&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-join-column</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:map-key-join-column</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">map-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xsd:sequence&gt;</span>
          <span class="tag">&lt;/xsd:choice&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:cascade-type</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orphan-removal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">one-to-one</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface OneToOne {
          Class targetEntity() default void.class;
          CascadeType[] cascade() default {};
          FetchType fetch() default EAGER;
          boolean optional() default true;
          String mappedBy() default &quot;&quot;;
          boolean orphanRemoval() default false;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:choice&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:sequence&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-column</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreign-key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xsd:sequence&gt;</span>
        <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">join-table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:join-table</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/xsd:choice&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cascade</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:cascade-type</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">target-entity</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fetch</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:fetch-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">optional</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mapped-by</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orphan-removal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">maps-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-by</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface OrderBy {
          String value() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">order-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface OrderColumn {
          String name() default &quot;&quot;;
          boolean nullable() default true;
          boolean insertable() default true;
          boolean updatable() default true;
          String columnDefinition() default &quot;&quot;;
         }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nullable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">insertable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">updatable</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:boolean</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">parameter-mode</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum ParameterMode { IN, INOUT, OUT, REF_CURSOR};

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">IN</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INOUT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">OUT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">REF_CURSOR</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-load</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PostLoad {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-persist</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PostPersist {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-remove</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PostRemove {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post-update</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PostUpdate {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-persist</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PrePersist {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-remove</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PreRemove {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pre-update</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD}) @Retention(RUNTIME)
        public @interface PreUpdate {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">method-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-join-column</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface PrimaryKeyJoinColumn {
          String name() default &quot;&quot;;
          String referencedColumnName() default &quot;&quot;;
          String columnDefinition() default &quot;&quot;;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">referenced-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-definition</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">query-hint</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface QueryHint {
          String name();
          String value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secondary-table</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface SecondaryTable {
          String name();
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          PrimaryKeyJoinColumn[] pkJoinColumns() default {};
          UniqueConstraint[] uniqueConstraints() default {};
          Index[] indexes() default {};
         }

       <span class="tag">&lt;/xsd:documentation&gt;</span>
     <span class="tag">&lt;/xsd:annotation&gt;</span>
     <span class="tag">&lt;xsd:sequence&gt;</span>
       <span class="tag">&lt;xsd:sequence&gt;</span>
         <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:primary-key-join-column</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
         <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary-key-foreign-key</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:foreign-key</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
       <span class="tag">&lt;/xsd:sequence&gt;</span>
       <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
       <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-generator</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface SequenceGenerator {
          String name();
          String sequenceName() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          int initialValue() default 1;
          int allocationSize() default 50;
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">initial-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">allocation-size</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sql-result-set-mapping</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface SqlResultSetMapping {
          String name();
          EntityResult[] entities() default {};
          ConstructorResult[] classes() default{};
          ColumnResult[] columns() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">entity-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:entity-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">constructor-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:constructor-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column-result</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">stored-procedure-parameter</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface StoredProcedureParameter {
          String name() default &quot;&quot;;
          ParameterMode mode() default ParameterMode.IN;
          Class type();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:parameter-mode</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE}) @Retention(RUNTIME)
        public @interface Table {
          String name() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          UniqueConstraint[] uniqueConstraints() default {};
          Index[] indexes() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table-generator</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)
        public @interface TableGenerator {
          String name();
          String table() default &quot;&quot;;
          String catalog() default &quot;&quot;;
          String schema() default &quot;&quot;;
          String pkColumnName() default &quot;&quot;;
          String valueColumnName() default &quot;&quot;;
          String pkColumnValue() default &quot;&quot;;
          int initialValue() default 0;
          int allocationSize() default 50;
          UniqueConstraint[] uniqueConstraints() default {};
          Indexes[] indexes() default {};
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:unique-constraint</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:index</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">catalog</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">schema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pk-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">value-column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pk-column-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">initial-value</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">allocation-size</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:int</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Temporal {
          TemporalType value();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

  <span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        public enum TemporalType {
          DATE, // java.sql.Date
          TIME, // java.sql.Time
          TIMESTAMP // java.sql.Timestamp
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:token</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DATE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TIME</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xsd:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TIMESTAMP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
     <span class="tag">&lt;/xsd:restriction&gt;</span>
  <span class="tag">&lt;/xsd:simpleType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transient</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Transient {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unique-constraint</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({}) @Retention(RUNTIME)
        public @interface UniqueConstraint {
          String name() default &quot;&quot;;
          String[] columnNames();
        }

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unbounded</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="comment">&lt;!-- **************************************************** --&gt;</span>

  <span class="tag">&lt;xsd:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;xsd:annotation&gt;</span>
      <span class="tag">&lt;xsd:documentation&gt;</span>

        @Target({METHOD, FIELD}) @Retention(RUNTIME)
        public @interface Version {}

      <span class="tag">&lt;/xsd:documentation&gt;</span>
    <span class="tag">&lt;/xsd:annotation&gt;</span>
    <span class="tag">&lt;xsd:sequence&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:column</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;xsd:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:temporal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xsd:sequence&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xsd:string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xsd:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">orm:access-type</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/xsd:complexType&gt;</span>

<span class="tag">&lt;/xsd:schema&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-documents"><a class="anchor" href="#related-documents"></a>Related Documents</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="a19493"></a>[1] Jakarta Persistence, v. 2.2. <em><a href="https://jakarta.ee/specifications/persistence/2.2/" class="bare">https://jakarta.ee/specifications/persistence/2.2/</a></em>.</p>
</li>
<li>
<p><a id="a19494"></a>[2] SQL 2003, Part 2, Foundation (SQL/Foundation). ISO/IEC 9075-2:2003.</p>
</li>
<li>
<p><a id="a19496"></a>[3] JDBC 4.2 Specification. <a href="http://jcp.org/en/jsr/detail?id=221" class="bare">http://jcp.org/en/jsr/detail?id=221</a>.</p>
</li>
<li>
<p><a id="a19497"></a>[4] Enterprise JavaBeans, v. 2.1.</p>
</li>
<li>
<p><a id="a19498"></a>[5] Jakarta Bean Validation, v. 3.0. <em><a href="https://jakarta.ee/specifications/bean-validation/3.0/" class="bare">https://jakarta.ee/specifications/bean-validation/3.0/</a></em>.</p>
</li>
<li>
<p><a id="a19499"></a>[6] Jakarta EE Platform, v. 9.0. <em><a href="https://jakarta.ee/specifications/platform/9/" class="bare">https://jakarta.ee/specifications/platform/9/</a></em>.</p>
</li>
<li>
<p><a id="a19500"></a>[7] Jakarta Contexts and Dependency Injection, v 3.0. <em><a href="https://jakarta.ee/specifications/cdi/3.0/" class="bare">https://jakarta.ee/specifications/cdi/3.0/</a></em>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="revision-history"><a class="anchor" href="#revision-history"></a>Appendix A: Revision History</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix lists the significant changes
that have been made during the development of the Java Persistence 2.2
specification.</p>
</div>
<div class="sect2">
<h3 id="maintenance-release-draft"><a class="anchor" href="#maintenance-release-draft"></a>A.1. Maintenance Release Draft</h3>
<div class="paragraph">
<p>Created document from Java Persistence 2.1
Final Release specification.</p>
</div>
<div class="paragraph">
<p>The following annotations have been marked <em>@Repeatable</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AssociationOverride</p>
</li>
<li>
<p>AttributeOverride</p>
</li>
<li>
<p>Convert</p>
</li>
<li>
<p>JoinColumn</p>
</li>
<li>
<p>MapKeyJoinColumn</p>
</li>
<li>
<p>NamedEntityGraph</p>
</li>
<li>
<p>NamedNativeQuery</p>
</li>
<li>
<p>NamedQuery</p>
</li>
<li>
<p>NamedStoredProcedureQuery</p>
</li>
<li>
<p>PersistenceContext</p>
</li>
<li>
<p>PersistenceUnit</p>
</li>
<li>
<p>PrimaryKeyJoinColumn</p>
</li>
<li>
<p>SecondaryTable</p>
</li>
<li>
<p>SqlResultSetMapping</p>
</li>
<li>
<p>SequenceGenerator</p>
</li>
<li>
<p>TableGenerator</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Added SequenceGenerators and TableGenerators annotations.</p>
</div>
<div class="paragraph">
<p>Added support for CDI injection into
AttributeConverter classes.</p>
</div>
<div class="paragraph">
<p>Added support for the mapping of the following java.time types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>java.time.LocalDate</p>
</li>
<li>
<p>java.time.LocalTime</p>
</li>
<li>
<p>java.time.LocalDateTime</p>
</li>
<li>
<p>java.time.OffsetTime</p>
</li>
<li>
<p>java.time.OffsetDateTime</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Added default Stream getResultStream() method
to Query interface.</p>
</div>
<div class="paragraph">
<p>Added default Stream&lt;X&gt; getResultStream()
method to TypedQuery interface.</p>
</div>
<div class="paragraph">
<p>Replaced reference to JAR file specification
in persistence provider bootstrapping section with more general
reference to Java SE service provider requirements.</p>
</div>
<div class="paragraph">
<p>Updated persistence.xml and orm.xml schemas to 2.2 versions.</p>
</div>
<div class="paragraph">
<p>Updated Related Documents.</p>
</div>
</div>
<div class="sect2">
<h3 id="jakarta-persistence-3-0"><a class="anchor" href="#jakarta-persistence-3-0"></a>A.2. Jakarta Persistence 3.0</h3>
<div class="paragraph">
<p>Created document from Java Persistence 2.2 Final Release specification.</p>
</div>
<div class="paragraph">
<p>The document was converted to <em>Asciidoc</em> format.</p>
</div>
<div class="paragraph">
<p>Packages of all API classes were changed to <em>jakarta.persistence</em>. These changes are reflected in the specification document.</p>
</div>
<div class="paragraph">
<p>Schema namespaces were changed from <a href="http://xmlns.jcp.org/xml/ns/persistence" class="bare">http://xmlns.jcp.org/xml/ns/persistence</a> and <a href="http://xmlns.jcp.org/xml/ns/persistence/orm" class="bare">http://xmlns.jcp.org/xml/ns/persistence/orm</a>
to <a href="https://jakarta.ee/xml/ns/persistence" class="bare">https://jakarta.ee/xml/ns/persistence</a> and <a href="https://jakarta.ee/xml/ns/persistence/orm" class="bare">https://jakarta.ee/xml/ns/persistence/orm</a></p>
</div>
<div class="paragraph">
<p>References to schema versions lower than 2.2 were removed.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. The term "persistence provider runtime" refers to the runtime environment of the persistence implementation. In Jakarta EE environments, this may be the Jakarta EE container or a third-party persistence provider implementation integrated with it.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. Specifically, if get <em>X</em> is the name of the getter method and set <em>X</em> is the name of the setter method, where <em>X</em> is a string, the name of the persistent property is defined by the result of java.beans.Introspector.decapitalize(<em>X</em>).
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. Portable applications should not expect the order of a list to be maintained across persistence contexts unless the <em>OrderColumn</em> construct is used or unless the <em>OrderBy</em> construct is used and the modifications to the list observe the specified ordering.
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. Lazy fetching is a hint to the persistence provider and can be specified by means of the <em>Basic</em>, <em>OneToOne</em>, <em>OneToMany</em>, <em>ManyToOne</em>, <em>ManyToMany</em>, and <em>ElementCollection</em> annotations and their XML equivalents. See <a href="#a13915">Chapter 11</a>.
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. Note that an instance of Calendar must be fully initialized for the type that it is mapped to.
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. The use of XML as an alternative and the interaction between Java language annotations and XML elements in defining default and explicit access types is described in <a href="#a16944">Chapter 12</a>.
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. These annotations must not be applied to the setter methods.
</div>
<div class="footnote" id="_footnotedef_8">
<a href="#_footnoteref_8">8</a>. It is permitted (but redundant) to place Access(FIELD) on a persistent field whose class has field access type or Access(PROPERTY) on a persistent property whose class has property access type. It is not permitted to specify a field as Access(PROPERTY) or a property as Access(FIELD). Note that Access(PROPERTY) must not be placed on the setter methods.
</div>
<div class="footnote" id="_footnotedef_9">
<a href="#_footnoteref_9">9</a>. In general, however, approximate numeric types (e.g., floating point types) should never be used in primary keys.
</div>
<div class="footnote" id="_footnotedef_10">
<a href="#_footnoteref_10">10</a>. This includes not changing the value of a mutable type that is primary key or an attribute of a composite primary key.
</div>
<div class="footnote" id="_footnotedef_11">
<a href="#_footnoteref_11">11</a>. The implementation may, but is not required to, throw an exception. Portable applications must not rely on any such specific behavior.
</div>
<div class="footnote" id="_footnotedef_12">
<a href="#_footnoteref_12">12</a>. If the application does not set the primary key attribute corresponding to the relationship, the value of that attribute may not be available until after the entity has been flushed to the database.
</div>
<div class="footnote" id="_footnotedef_13">
<a href="#_footnoteref_13">13</a>. Note that it is correct to observe the first rule as an alternative in this case.
</div>
<div class="footnote" id="_footnotedef_14">
<a href="#_footnoteref_14">14</a>. Note that the parent&#8217;s primary key might be represented as either an embedded id or as an id class.
</div>
<div class="footnote" id="_footnotedef_15">
<a href="#_footnoteref_15">15</a>. Note that the use of PrimaryKeyJoinColumn instead of MapsId would result in the same mapping in this example. Use of MapsId is preferred for the mapping of derived identities.
</div>
<div class="footnote" id="_footnotedef_16">
<a href="#_footnoteref_16">16</a>. Direct or indirect circular containment dependencies among embeddable classes are not permitted.
</div>
<div class="footnote" id="_footnotedef_17">
<a href="#_footnoteref_17">17</a>. An entity cannot have a unidirectional relationship to the embeddable class of another entity (or itself).
</div>
<div class="footnote" id="_footnotedef_18">
<a href="#_footnoteref_18">18</a>. Note that when an embeddable instance is used as a map key, these attributes represent its identity. Changes to embeddable instances used as map keys have undefined behaviour and should be avoided.
</div>
<div class="footnote" id="_footnotedef_19">
<a href="#_footnoteref_19">19</a>. For associations of type <em>java.util.Map</em>, <em>target type</em> refers to the type that is the Map <em>value</em>.
</div>
<div class="footnote" id="_footnotedef_20">
<a href="#_footnoteref_20">20</a>. If the parent is detached or new or was previously removed before the orphan was associated with it, the remove operation is not applied to the entity being orphaned.
</div>
<div class="footnote" id="_footnotedef_21">
<a href="#_footnoteref_21">21</a>. When the relationship is modeled as a <em>java.util.Map</em>, “Entity B references a collection of Entity A” means that Entity B references a map collection in which the type of the Map <em>value</em> is Entity A. The map key may be a basic type, embeddable class, or an entity.
</div>
<div class="footnote" id="_footnotedef_22">
<a href="#_footnoteref_22">22</a>. The superclass must not be an embeddable class or id class.
</div>
<div class="footnote" id="_footnotedef_23">
<a href="#_footnoteref_23">23</a>. If a transaction-scoped persistence context is used, it is not required to be retained across transactions.
</div>
<div class="footnote" id="_footnotedef_24">
<a href="#_footnoteref_24">24</a>. This includes instances of a non-entity class that extends an entity class.
</div>
<div class="footnote" id="_footnotedef_25">
<a href="#_footnoteref_25">25</a>. If &lt;delimited-identifiers&gt; is specified and individual annotations or XML elements or attributes use escaped double quotes, the double-quotes appear in the name of the database identifier.
</div>
<div class="footnote" id="_footnotedef_26">
<a href="#_footnoteref_26">26</a>. This includes, for example. modifications to persistent attributes of type char[] and byte[].
</div>
<div class="footnote" id="_footnotedef_27">
<a href="#_footnoteref_27">27</a>. This might be an issue if unique constraints (such as those described for the default mappings in <a href="#a640">Section 2.10.3.1</a> and <a href="#a764">Section 2.10.5.1</a>) were not applied in the definition of the object/relational mapping.
</div>
<div class="footnote" id="_footnotedef_28">
<a href="#_footnoteref_28">28</a>. Note that when a new transaction is begun, the managed objects in an extended persistence context are <em>not</em> reloaded from the database.
</div>
<div class="footnote" id="_footnotedef_29">
<a href="#_footnoteref_29">29</a>. These are instances that were persistent in the database at the start of the transaction.
</div>
<div class="footnote" id="_footnotedef_30">
<a href="#_footnoteref_30">30</a>. It is unspecified as to whether instances that were not persistent in the database behave as new instances or detached instances after rollback. This may be implementation-dependent.
</div>
<div class="footnote" id="_footnotedef_31">
<a href="#_footnoteref_31">31</a>. Applications may require that database isolation levels higher than read-committed be in effect. The configuration of the setting database isolation levels, however, is outside the scope of this specification.
</div>
<div class="footnote" id="_footnotedef_32">
<a href="#_footnoteref_32">32</a>. Bulk update statements, however, are permitted to set the value of version attributes. See <a href="#a5636">Section 4.10</a>.
</div>
<div class="footnote" id="_footnotedef_33">
<a href="#_footnoteref_33">33</a>. This includes owned relationships maintained in join tables.
</div>
<div class="footnote" id="_footnotedef_34">
<a href="#_footnoteref_34">34</a>. Such additional mechanisms may be standardized by a future release of this specification.
</div>
<div class="footnote" id="_footnotedef_35">
<a href="#_footnoteref_35">35</a>. Implementations are permitted to use database mechanisms other than locking to achieve the semantic effects described here, for example, multiversion concurrency control mechanisms.
</div>
<div class="footnote" id="_footnotedef_36">
<a href="#_footnoteref_36">36</a>. This is achieved by using a lock with LockModeType.PESSIMISTIC_WRITE or LockModeType.PESSIMISTIC_FORCE_INCREMENT as described in <a href="#a2084">Section 3.4.4</a>.
</div>
<div class="footnote" id="_footnotedef_37">
<a href="#_footnoteref_37">37</a>. For example, a persistence provider may use an underlying database platform&#8217;s SELECT FOR UPDATE statements to implement pessimistic locking if that construct provides appropriate semantics, or the provider may use an isolation level of repeatable read.
</div>
<div class="footnote" id="_footnotedef_38">
<a href="#_footnoteref_38">38</a>. The lock mode type NONE may be specified as a value of lock mode arguments and also provides a default value for annotations.
</div>
<div class="footnote" id="_footnotedef_39">
<a href="#_footnoteref_39">39</a>. Databases concurrency control mechanisms that provide comparable semantics, e.g., multiversion concurrency control, can be used by the provider.
</div>
<div class="footnote" id="_footnotedef_40">
<a href="#_footnoteref_40">40</a>. The persistence provider is not required to flush the entity to the database immediately.
</div>
<div class="footnote" id="_footnotedef_41">
<a href="#_footnoteref_41">41</a>. CDI is enabled by default in Jakarta EE. See the Jakarta EE specification <a href="#a19499">[6
</div>
<div class="footnote" id="_footnotedef_42">
<a href="#_footnoteref_42">42</a>. The persistence provider may support CDI injection into entity listeners in other environments in which the BeanManager is available.
</div>
<div class="footnote" id="_footnotedef_43">
<a href="#_footnoteref_43">43</a>. For example, if a transaction commit occurs as a result of the normal termination of a session bean business method with transaction attribute <em>RequiresNew</em>, the <em>PostPersist</em> and <em>PostRemove</em> callbacks are executed in the naming context, the transaction context, and the security context of that component.
</div>
<div class="footnote" id="_footnotedef_44">
<a href="#_footnoteref_44">44</a>. Note that this caution applies also to the actions of objects that might be injected into an entity listener
</div>
<div class="footnote" id="_footnotedef_45">
<a href="#_footnoteref_45">45</a>. The semantics of such operations may be standardized in a future release of this specification.
</div>
<div class="footnote" id="_footnotedef_46">
<a href="#_footnoteref_46">46</a>. Excluded listeners may be reintroduced on an entity class by listing them explicitly in the <em>EntityListeners</em> annotation or XML <em>entity-listeners</em> element.
</div>
<div class="footnote" id="_footnotedef_47">
<a href="#_footnoteref_47">47</a>. If a method overrides an inherited callback method but specifies a different lifecycle event or is not a lifecycle callback method, the overridden method will not be invoked.
</div>
<div class="footnote" id="_footnotedef_48">
<a href="#_footnoteref_48">48</a>. We plan to provide a facility for more complex attribute conversions in a future release of this specification.
</div>
<div class="footnote" id="_footnotedef_49">
<a href="#_footnoteref_49">49</a>. CDI is enabled by default in Jakarta EE. See the Jakarta EE specification <a href="#a19499">[6
</div>
<div class="footnote" id="_footnotedef_50">
<a href="#_footnoteref_50">50</a>. The persistence provider may support CDI injection into attribute converters in other environments in which the BeanManager is available.
</div>
<div class="footnote" id="_footnotedef_51">
<a href="#_footnoteref_51">51</a>. A lock mode is specified for a query by means of the <em>setLockMode</em> method or by specifying the lock mode in the <em>NamedQuery</em> annotation.
</div>
<div class="footnote" id="_footnotedef_52">
<a href="#_footnoteref_52">52</a>. Note that the setLockMode method may be called more than once (with different values) on a Query or TypedQuery object.
</div>
<div class="footnote" id="_footnotedef_53">
<a href="#_footnoteref_53">53</a>. Note that locking will not occur for data passed to aggregate functions. Further, queries involving aggregates with pessimistic locking may not be supported on all database platforms.
</div>
<div class="footnote" id="_footnotedef_54">
<a href="#_footnoteref_54">54</a>. Support for joins is currently limited to single-valued relationships that are mapped directly—i.e., not via join tables.
</div>
<div class="footnote" id="_footnotedef_55">
<a href="#_footnoteref_55">55</a>. Note that REF_CURSOR parameters are used by some databases to return result sets from stored procedures.
</div>
<div class="footnote" id="_footnotedef_56">
<a href="#_footnoteref_56">56</a>. This chapter uses the convention that reserved identifiers appear in upper case in the examples and BNF for the language.
</div>
<div class="footnote" id="_footnotedef_57">
<a href="#_footnoteref_57">57</a>. BIT_LENGTH, CHAR_LENGTH, CHARACTER_LENGTH, POSITION, and UNKNOWN are not currently used: they are reserved for future use.
</div>
<div class="footnote" id="_footnotedef_58">
<a href="#_footnoteref_58">58</a>. A range variable must not designate an embeddable class abstract schema type.
</div>
<div class="footnote" id="_footnotedef_59">
<a href="#_footnoteref_59">59</a>. Note that use of VALUE is optional, as an identification variable referring to an association of type <em>java.util.Map</em> is of the abstract schema type of the map value. (See <a href="#a4765">Section 4.4.2</a>.)
</div>
<div class="footnote" id="_footnotedef_60">
<a href="#_footnoteref_60">60</a>. The implementation is not expected to perform such query operations involving such fields in memory rather than in the database.
</div>
<div class="footnote" id="_footnotedef_61">
<a href="#_footnoteref_61">61</a>. Note that queries that contain subqueries on both sides of a comparison operation will not be portable across all databases.
</div>
<div class="footnote" id="_footnotedef_62">
<a href="#_footnoteref_62">62</a>. Refer to <a href="#a19494">[2
</div>
<div class="footnote" id="_footnotedef_63">
<a href="#_footnoteref_63">63</a>. The use of the reserved word OF is optional in this expression.
</div>
<div class="footnote" id="_footnotedef_64">
<a href="#_footnoteref_64">64</a>. Subqueries are restricted to the WHERE and HAVING clauses in this release. Support for subqueries in the FROM clause will be considered in a later release of this specification.
</div>
<div class="footnote" id="_footnotedef_65">
<a href="#_footnoteref_65">65</a>. Note that expressions involving aggregate operators must not be used in the WHERE clause.
</div>
<div class="footnote" id="_footnotedef_66">
<a href="#_footnoteref_66">66</a>. Note that not all databases support the use of a trim character other than the space character; use of this argument may result in queries that are not portable.
</div>
<div class="footnote" id="_footnotedef_67">
<a href="#_footnoteref_67">67</a>. Note that not all databases support the use of the third argument to LOCATE; use of this argument may result in queries that are not portable.
</div>
<div class="footnote" id="_footnotedef_68">
<a href="#_footnoteref_68">68</a>. Note that not all databases support the use of SQL case expressions. The use of case expressions may result in queries that are not portable to such databases.
</div>
<div class="footnote" id="_footnotedef_69">
<a href="#_footnoteref_69">69</a>. Note that the keyword OBJECT is not required. It is preferred that it be omitted for new queries.
</div>
<div class="footnote" id="_footnotedef_70">
<a href="#_footnoteref_70">70</a>. This can be used, for example, to refer to a select expression in the ORDER BY clause.
</div>
<div class="footnote" id="_footnotedef_71">
<a href="#_footnoteref_71">71</a>. It is legal to specify DISTINCT with MAX or MIN, but it does not affect the result.
</div>
<div class="footnote" id="_footnotedef_72">
<a href="#_footnoteref_72">72</a>. In the case of a general or simple case expression, these are the scalar expressions of the THEN and ELSE clauses.
</div>
<div class="footnote" id="_footnotedef_73">
<a href="#_footnoteref_73">73</a>. We expect that the option of different packages will be provided in a future release of this specification.
</div>
<div class="footnote" id="_footnotedef_74">
<a href="#_footnoteref_74">74</a>. If the class was generated, the <em>jakarta.annotation.Generated</em> annotation should be used to annotate the class. The use of any annotations other than <em>StaticMetamodel</em> and <em>Generated</em> on static metamodel classes is undefined.
</div>
<div class="footnote" id="_footnotedef_75">
<a href="#_footnoteref_75">75</a>. The attributes of these metamodel objects play a role analogous to that which would be played by member literals.
</div>
<div class="footnote" id="_footnotedef_76">
<a href="#_footnoteref_76">76</a>. Metamodel objects are used to specify typesafe nagivation through joins and through path expressions. These metamodel objects capture both the source and target types of the attribute through which navigation occurs, and are thus the mechanism by which typesafe navigation is achieved.
</div>
<div class="footnote" id="_footnotedef_77">
<a href="#_footnoteref_77">77</a>. Attribute names serve this role for string-based queries. See <a href="#a11349">Section 6.7</a>.
</div>
<div class="footnote" id="_footnotedef_78">
<a href="#_footnoteref_78">78</a>. Attribute names serve this role for string-based queries. See <a href="#a11349">Section 6.7</a>.
</div>
<div class="footnote" id="_footnotedef_79">
<a href="#_footnoteref_79">79</a>. Note that the use of JTA is not required to be supported in application client containers.
</div>
<div class="footnote" id="_footnotedef_80">
<a href="#_footnoteref_80">80</a>. It may also be used internally by the Jakarta EE container. See <a href="#a12100">Section 7.9</a>.
</div>
<div class="footnote" id="_footnotedef_81">
<a href="#_footnoteref_81">81</a>. This may be the case when using multiple databases, since in a typical configuration a single entity manager only communicates with a single database. There is only one entity manager factory per persistence unit, however.
</div>
<div class="footnote" id="_footnotedef_82">
<a href="#_footnoteref_82">82</a>. Specifically, when one of the methods of the EntityManager interface is invoked.
</div>
<div class="footnote" id="_footnotedef_83">
<a href="#_footnoteref_83">83</a>. Note that this applies to a transaction-scoped persistence context of type SynchronizationType.UNSYNCHRONIZED that has not been joined to the transaction as well.
</div>
<div class="footnote" id="_footnotedef_84">
<a href="#_footnoteref_84">84</a>. Entity manager instances obtained from different entity manager factories never share the same persistence context.
</div>
<div class="footnote" id="_footnotedef_85">
<a href="#_footnoteref_85">85</a>. It is not required that these contracts be used when a third-party persistence provider is not used: the container might use these same APIs or its might use its own internal APIs.
</div>
<div class="footnote" id="_footnotedef_86">
<a href="#_footnoteref_86">86</a>. The container may choose to pool EntityManagers: it instead of creating and closing in each case, it may acquire one from its pool and call <em>clear()</em> on it.
</div>
<div class="footnote" id="_footnotedef_87">
<a href="#_footnoteref_87">87</a>. The root of the persistence unit is the <em>WEB-INF/classes</em> directory; the <em>persistence.xml</em> file is therefore contained in the <em>WEB-INF/classes/META-INF</em> directory.
</div>
<div class="footnote" id="_footnotedef_88">
<a href="#_footnoteref_88">88</a>. Note that an individual class may be used in more than one persistence unit.
</div>
<div class="footnote" id="_footnotedef_89">
<a href="#_footnoteref_89">89</a>. Persistence providers are encouraged to support this syntax for use in Java SE environments.
</div>
<div class="footnote" id="_footnotedef_90">
<a href="#_footnoteref_90">90</a>. Note that in this example a META-INF/orm.xml file is assumed not to exist.
</div>
<div class="footnote" id="_footnotedef_91">
<a href="#_footnoteref_91">91</a>. Use of these Java SE bootstrapping APIs may be supported in Jakarta EE containers; however, support for such use is not required.
</div>
<div class="footnote" id="_footnotedef_92">
<a href="#_footnoteref_92">92</a>. In dynamic environments (e.g., OSGi-based environments, containers based on dynamic kernels, etc.), the list of persistence providers may change.
</div>
<div class="footnote" id="_footnotedef_93">
<a href="#_footnoteref_93">93</a>. If a custom PersistenceProviderResolver is needed in a JavaSE environment, it must be set before Persistence.createEntityManagerFactory is called. Note, however, that the setPersistenceProviderResolver method is not intended for general use, but rather is aimed at containers maintaining a dynamic environment.
</div>
<div class="footnote" id="_footnotedef_94">
<a href="#_footnoteref_94">94</a>. The determining of the persistence providers that are available is discussed in <a href="#a12837">Section 9.3</a>.
</div>
<div class="footnote" id="_footnotedef_95">
<a href="#_footnoteref_95">95</a>. A dependency on ultiple persistence contexts may be needed, for example, when multiple persistence units are used.
</div>
<div class="footnote" id="_footnotedef_96">
<a href="#_footnoteref_96">96</a>. Multiple persistence units may be needed, for example, when mapping to multiple databases.
</div>
<div class="footnote" id="_footnotedef_97">
<a href="#_footnoteref_97">97</a>. The use of map keys that contain embeddables that reference entities is not permitted.
</div>
<div class="footnote" id="_footnotedef_98">
<a href="#_footnoteref_98">98</a>. Note that <em>either</em> the <em>joinColumns</em> element <em>or</em> the <em>joinTable</em> element of the <em>AssociationOverride</em> annotation is specified for overriding a given relationship (but never both).
</div>
<div class="footnote" id="_footnotedef_99">
<a href="#_footnoteref_99">99</a>. Mapping of java.time.LocalDate, java.time.LocalTime, java.time.LocalDateTime, java.time.OffsetTime, and java.time.OffsetDateTime types to columns other than those supported by the mappings defined by Appendix B of the JDBC 4.2 specification is not required to be supported by the persistence provider beyond the support required for other serializable types. See <a href="#a19496">[3
</div>
<div class="footnote" id="_footnotedef_100">
<a href="#_footnoteref_100">100</a>. The combination of inheritance strategies within a single entity inheritance hierarchy is not defined by this specification.
</div>
<div class="footnote" id="_footnotedef_101">
<a href="#_footnoteref_101">101</a>. If it is not specified, the rules of <a href="#a511">Section 2.8</a> apply.
</div>
<div class="footnote" id="_footnotedef_102">
<a href="#_footnoteref_102">102</a>. If the embeddable class is used as a primary key, the <em>EmbeddedId</em> rather than the <em>Embedded</em> annotation is used.
</div>
<div class="footnote" id="_footnotedef_103">
<a href="#_footnoteref_103">103</a>. Use of the <em>Embedded</em> annotation is not required. See <a href="#a511">Section 2.8</a>.
</div>
<div class="footnote" id="_footnotedef_104">
<a href="#_footnoteref_104">104</a>. Note that the <em>Id</em> annotation is not used in the embeddable class.
</div>
<div class="footnote" id="_footnotedef_105">
<a href="#_footnoteref_105">105</a>. If the element collection is a Map, this applies to the map value.
</div>
<div class="footnote" id="_footnotedef_106">
<a href="#_footnoteref_106">106</a>. Mapping of enum values that contain state is not supported.
</div>
<div class="footnote" id="_footnotedef_107">
<a href="#_footnoteref_107">107</a>. Portable applications should not use the <em>GeneratedValue</em> annotation on other persistent fields or properties.
</div>
<div class="footnote" id="_footnotedef_108">
<a href="#_footnoteref_108">108</a>. Note that SEQUENCE and IDENTITY are not portable across all databases.
</div>
<div class="footnote" id="_footnotedef_109">
<a href="#_footnoteref_109">109</a>. Primary keys using types other than these will not be portable. In general, floating point types should never be used in primary keys.
</div>
<div class="footnote" id="_footnotedef_110">
<a href="#_footnoteref_110">110</a>. If the element collection is a Map, this applies to the map value.
</div>
<div class="footnote" id="_footnotedef_111">
<a href="#_footnoteref_111">111</a>. The <em>ManyToMany</em> annotation must not be used within an embeddable class used in an element collection.
</div>
<div class="footnote" id="_footnotedef_112">
<a href="#_footnoteref_112">112</a>. The <em>OneToMany</em> annotation must not be used within an embeddable class used in an element collection.
</div>
<div class="footnote" id="_footnotedef_113">
<a href="#_footnoteref_113">113</a>. If the parent is detached or new or was previously removed before the orphan was associated with it, the remove operation is not applied to the entity being orphaned.
</div>
<div class="footnote" id="_footnotedef_114">
<a href="#_footnoteref_114">114</a>. If the parent is detached or new or was previously removed before the orphan was associated with it, the remove operation is not applied to the entity being orphaned.
</div>
<div class="footnote" id="_footnotedef_115">
<a href="#_footnoteref_115">115</a>. If the primary key is a composite primary key, the precedence of ordering among the attributes within the primary key is not futher defined. To assign such a precedence within these attributes, each of the individual attributes must be specified as an orderby_item.
</div>
<div class="footnote" id="_footnotedef_116">
<a href="#_footnoteref_116">116</a>. In all other cases when OrderBy is applied to an element collection, the <em>property_or_field_name</em> must be specified.
</div>
<div class="footnote" id="_footnotedef_117">
<a href="#_footnoteref_117">117</a>. The <em>OrderBy</em> annotation should be used for ordering that is visible as persistent state and maintained by the application.
</div>
<div class="footnote" id="_footnotedef_118">
<a href="#_footnoteref_118">118</a>. It is not expected that a database foreign key be defined for the OneToOne mapping, as the OneToOne relationship may be defined as “optional=true”.
</div>
<div class="footnote" id="_footnotedef_119">
<a href="#_footnoteref_119">119</a>. The derived id mechanisms described in <a href="#a155">Section 2.4.1.1</a> are now to be preferred over PrimaryKeyJoinColumn for the OneToOne mapping case.
</div>
<div class="footnote" id="_footnotedef_120">
<a href="#_footnoteref_120">120</a>. Note that the derived identity mechanisms described in <a href="#a155">Section 2.4.1.1</a> is now preferred to the use of PrimaryKeyJoinColumn for this case.
</div>
<div class="footnote" id="_footnotedef_121">
<a href="#_footnoteref_121">121</a>. When a joined inheritance strategy is used, the Table annotation is used to specify a primary table for the subclass-specific state if the default is not used.
</div>
<div class="footnote" id="_footnotedef_122">
<a href="#_footnoteref_122">122</a>. If the element collection is a Map, this applies to the map value.
</div>
<div class="footnote" id="_footnotedef_123">
<a href="#_footnoteref_123">123</a>. See, however, <a href="#a5636">Section 4.10</a>.
</div>
</div>
<div id="footer">
<div id="footer-text">
 3.0<br>
Last updated 2020-08-31 17:33:43 +0200
</div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</body>
</html>