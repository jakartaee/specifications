<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) on Tue Apr 30 14:12:26 UTC 2024 -->
<title>Asynchronous (Jakarta EE Web Profile API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2024-04-30">
<meta name="description" content="declaration: package: jakarta.enterprise.concurrent, annotation type: Asynchronous">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language"><br>Jakarta EE Web Profile API v11.0.0-M3</div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Asynchronous.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation-interface-optional-element-summary">Optional</a>&nbsp;|&nbsp;</li>
<li>Required</li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation-interface-element-detail">Element</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">jakarta.enterprise.concurrent</a></div>
<h1 title="Annotation Interface Asynchronous" class="title">Annotation Interface Asynchronous</h1>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/annotation/Documented.html" title="class or interface in java.lang.annotation" class="external-link">@Documented</a>
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/annotation/Inherited.html" title="class or interface in java.lang.annotation" class="external-link">@Inherited</a>
<a href="../../interceptor/InterceptorBinding.html" title="annotation interface in jakarta.interceptor">@InterceptorBinding</a>
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/annotation/Retention.html" title="class or interface in java.lang.annotation" class="external-link">@Retention</a>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/annotation/RetentionPolicy.html#RUNTIME" title="class or interface in java.lang.annotation" class="external-link">RUNTIME</a>)
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/annotation/Target.html" title="class or interface in java.lang.annotation" class="external-link">@Target</a>({<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/annotation/ElementType.html#METHOD" title="class or interface in java.lang.annotation" class="external-link">METHOD</a>,<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/annotation/ElementType.html#TYPE" title="class or interface in java.lang.annotation" class="external-link">TYPE</a>})
</span><span class="modifiers">public @interface </span><span class="element-name type-name-label">Asynchronous</span></div>
<div class="block">Annotates a CDI managed bean method to run asynchronously.
 The CDI managed bean must not be a Jakarta Enterprise Bean,
 and neither the method nor its class can be annotated with
 the MicroProfile Asynchronous annotation.
 <p>
 The Jakarta EE Product Provider runs the method on a <a href="ManagedExecutorService.html" title="interface in jakarta.enterprise.concurrent"><code>ManagedExecutorService</code></a>
 and returns to the caller a <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link"><code>CompletableFuture</code></a>
 that is backed by the same <code>ManagedExecutorService</code>
 to represent the execution of the method. The <code>ManagedExecutorService</code>
 is the default asynchronous execution facility for the <code>CompletableFuture</code>
 and and all dependent stages that are created from those, and so on,
 as defined by the <code>ManagedExecutorService</code> JavaDoc API.
 The Jakarta EE Product Provider makes this <code>CompletableFuture</code> available
 to the asynchronous method implementation via the
 <a href="Asynchronous.Result.html#getFuture()"><code>Asynchronous.Result.getFuture</code></a> and
 <a href="Asynchronous.Result.html#complete(T)"><code>Asynchronous.Result.complete</code></a> methods.
 <p>
 For example,

 <pre>
 @Asynchronous
 public CompletableFuture&lt;Double&gt; hoursWorked(LocalDate from, LocalDate to) {
     // Application component's context is made available to the async method,
     try (Connection con = ((DataSource) InitialContext.doLookup(
         "java:comp/env/jdbc/timesheetDB")).getConnection()) {
         ...
         return Asynchronous.Result.complete(total);
     } catch (NamingException | SQLException x) {
         throw new CompletionException(x);
     }
 }
 </pre>

 with usage,

 <pre>
 hoursWorked(mon, fri).thenAccept(total -&gt; {
     // Application component's context is made available to dependent stage actions,
     DataSource ds = InitialContext.doLookup(
         "java:comp/env/jdbc/payrollDB");
     ...
 });
 </pre>

 When the asynchronous method implementation returns a different
 <code>CompletableFuture</code> instance, the Jakarta EE Product Provider
 uses the completion of that instance to complete the <code>CompletableFuture</code>
 that the Jakarta EE Product Provider returns to the caller,
 completing it with the same result or exception.
 <p>
 For example,

 <pre>
 @Asynchronous
 public CompletableFuture&lt;List&lt;Itinerary&gt;&gt; findSingleLayoverFlights(Location source, Location dest) {
     try {
         ManagedExecutorService executor = InitialContext.doLookup(
             "java:comp/DefaultManagedExecutorService");

         return executor.supplyAsync(source::flightsFrom)
                        .thenCombine(executor.completedFuture(dest.flightsTo()),
                                     Itinerary::sourceMatchingDest);
     } catch (NamingException x) {
         throw new CompletionException(x);
     }
 }
 </pre>

 with usage,

 <pre>
 findSingleLayoverFlights(RST, DEN).thenApply(Itinerary::sortByPrice);
 </pre>

 <p>
 Methods with the following return types can be annotated to be
 asynchronous methods:
 <ul>
 <li><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link"><code>CompletableFuture</code></a></li>
 <li><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletionStage.html" title="class or interface in java.util.concurrent" class="external-link"><code>CompletionStage</code></a></li>
 <li><code>void</code></li>
 </ul>
 <p>
 The Jakarta EE Product Provider raises
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link"><code>UnsupportedOperationException</code></a>
 if other return types are used or if the annotation is placed at the class
 level. The injection target of <code>ElementType.TYPE</code> is to be used only
 by the CDI extension that is implemented by the Jakarta EE Product Provider to
 register the asynchronous method interceptor. Applications must only use the
 asynchronous method annotation at method level.
 <p>
 Exceptions that are raised by asynchronous methods are not raised directly
 to the caller because the method runs asynchronously to the caller.
 Instead, the <code>CompletableFuture</code> that represents the result
 is completed with the raised exception. Asynchronous methods are
 discouraged from raising checked exceptions because checked exceptions
 force the caller to write exception handling code that is unreachable.
 When a checked exception occurs, the asynchronous method implementation
 can flow the exception back to the resulting <code>CompletableFuture</code>
 either by raising a
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletionException.html" title="class or interface in java.util.concurrent" class="external-link"><code>CompletionException</code></a>
 with the original exception as the cause, or it can take the equivalent
 approach of exceptionally completing the <code>CompletableFuture</code>, using
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html#completeExceptionally(java.lang.Throwable)" title="class or interface in java.util.concurrent" class="external-link"><code>completeExceptionally</code></a>
 to supply the original exception as the cause.
 <p>
 Except where otherwise stated, the Jakarta EE Product Provider raises
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/RejectedExecutionException.html" title="class or interface in java.util.concurrent" class="external-link"><code>RejectedExecutionException</code></a>
 upon invocation of the asynchronous method if evident upfront that it cannot
 be accepted, for example if the JNDI name is not valid or points to something
 other than a managed executor resource. If determined at a later point that the
 asynchronous method cannot run (for example, if unable to establish thread context),
 then the Jakarta EE Product Provider completes the <code>CompletableFuture</code>
 exceptionally with <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CancellationException.html" title="class or interface in java.util.concurrent" class="external-link"><code>CancellationException</code></a>,
 and chains a cause exception if there is any.
 <p>
 The Jakarta EE Product Provider must assign the interceptor for asynchronous methods
 to have priority of <code>Interceptor.Priority.PLATFORM_BEFORE + 5</code>.
 Interceptors with a lower priority, such as <code>Transactional</code>, must run on
 the thread where the asynchronous method executes, rather than on the submitting thread.
 When an asynchronous method is annotated as <code>Transactional</code>,
 the transactional types which can be used are:
 <code>TxType.REQUIRES_NEW</code>, which causes the method to run in a new transaction, and
 <code>TxType.NOT_SUPPORTED</code>, which causes the method to run with no transaction.
 All other transaction attributes must result in
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link"><code>UnsupportedOperationException</code></a>
 upon invocation of the asynchronous method.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>3.0</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="Asynchronous.Result.html" class="type-name-link" title="class in jakarta.enterprise.concurrent">Asynchronous.Result</a></code></div>
<div class="col-last even-row-color">
<div class="block">Mechanism by which the Jakarta EE Product Provider makes available
 to the asynchronous method implementation the same
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link"><code>CompletableFuture</code></a>
 instance that the Jakarta EE Product Provider supplies to the caller
 of the asynchronous method.</div>
</div>
</div>
</section>
</li>
<!-- =========== ANNOTATION INTERFACE OPTIONAL MEMBER SUMMARY =========== -->
<li>
<section class="member-summary" id="annotation-interface-optional-element-summary">
<h2>Optional Element Summary</h2>
<div class="caption"><span>Optional Elements</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Optional Element</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#executor()" class="member-name-link">executor</a></code></div>
<div class="col-last even-row-color">
<div class="block">JNDI name of a <a href="ManagedExecutorService.html" title="interface in jakarta.enterprise.concurrent"><code>ManagedExecutorService</code></a> or <a href="ManagedScheduledExecutorService.html" title="interface in jakarta.enterprise.concurrent"><code>ManagedScheduledExecutorService</code></a>
 upon which to run the asynchronous method.</div>
</div>
<div class="col-first odd-row-color"><code><a href="Schedule.html" title="annotation interface in jakarta.enterprise.concurrent">Schedule</a>[]</code></div>
<div class="col-second odd-row-color"><code><a href="#runAt()" class="member-name-link">runAt</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Establishes a schedule for repeated execution of the method.</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details" id="annotation-interface-element-detail">
<ul class="details-list">
<!-- ============ ANNOTATION INTERFACE MEMBER DETAIL =========== -->
<li>
<section class="member-details">
<h2>Element Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="executor()">
<h3>executor</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">executor</span></div>
<div class="block">JNDI name of a <a href="ManagedExecutorService.html" title="interface in jakarta.enterprise.concurrent"><code>ManagedExecutorService</code></a> or <a href="ManagedScheduledExecutorService.html" title="interface in jakarta.enterprise.concurrent"><code>ManagedScheduledExecutorService</code></a>
 upon which to run the asynchronous method.
 <p>
 The default value is the JNDI name of the built-in <code>ManagedExecutorService</code>
 that is provided by the Jakarta EE platform provider:<br>
 <code>java:comp/DefaultManagedExecutorService</code></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>managed executor service JNDI name.</dd>
</dl>
<dl class="notes">
<dt>Default:</dt>
<dd>"java:comp/DefaultManagedExecutorService"</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="runAt()">
<h3>runAt</h3>
<div class="member-signature"><span class="return-type"><a href="Schedule.html" title="annotation interface in jakarta.enterprise.concurrent">Schedule</a>[]</span>&nbsp;<span class="element-name">runAt</span></div>
<div class="block"><p>Establishes a schedule for repeated execution of the method.
 A single future represents the completion of all executions in the schedule.
 The Jakarta EE product attempts to run the method at the scheduled times
 until its future is completed or the method returns a non-null result value
 or raises an exception. The future is always accessible from within the method via
 <code>Asynchronous.Result</code> which returns a typed <code>CompletableFuture</code> which matches the return
 type of the method. If the method return type is <code>void</code> then <code>Asynchronous.Result</code>
 will return a <code>CompletableFuture&lt;Void&gt;</code>.</p>

 <p>Computation of the start time for the next execution occurs
 after the completion of the current execution. This prevents overlap
 of executions from the same asynchronous method request. Scheduled
 execution times that overlap a prior execution that is still running
 are skipped. For example, if an asynchronous method is scheduled to
 run every minute on the minute and execution of the method starts at
 8:00 AM, lasting for 2 minutes and 10 seconds, then the Jakarta EE product
 attempts to start the next execution of the method at 8:03 AM.</p>

 <p>Scheduled asynchronous methods are treated similar to other scheduled
 tasks in that they are not subject to <code>max-async</code> constraints of
 <code>managed-scheduled-executor-definition</code> and
 <code>managed-executor-definition</code> and the corresponding
 <a href="ManagedScheduledExecutorDefinition.html#maxAsync()"><code>ManagedScheduledExecutorDefinition.maxAsync()</code></a> and
 <a href="ManagedExecutorDefinition.html#maxAsync()"><code>ManagedExecutorDefinition.maxAsync()</code></a>.</p>

 <p>When a list of multiple <a href="Schedule.html" title="annotation interface in jakarta.enterprise.concurrent"><code>Schedule</code></a> annotations is specified,
 the next execution time is computed according to each, choosing the
 closest future time after the current time. This allows composite
 schedules such as,
 </p>

 <pre>
 @Asynchronous(runAt = {
     @Schedule(daysOfWeek = { DayOfWeek.TUESDAY, DayOfWeek.THURSDAY }, hours = 8),
     @Schedule(daysOfweek = DayOfWeek.WEDNESDAY, hours = 10, minutes = 30)
 })
 public CompletableFuture&lt;String&gt; attendLectureAndLab(String course) {
     ...
     if (endOfSemester)
         return Asynchronous.Result.complete(courseRecord);
     else
         return null; // continue at next scheduled time
 }

 ...

 student.attendLectureAndLab(courseName).thenApply(this::assignGrade);
 </pre>

 <p>The default value of empty array indicates that the task does not
 run on a schedule and instead runs one time.</p></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a schedule for the task or an empty array, where the latter indicates
         to run once without a schedule.</dd>
</dl>
<dl class="notes">
<dt>Default:</dt>
<dd>{}</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><p align="left">Copyright &#169; 2018, 2024 Eclipse Foundation.<br>Use is subject to <a href="../../../doc-files/speclicense.html" target="_top">license terms</a>.</small></p>
</footer>
</div>
</div>
</body>
</html>
